/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["fleet_bundle_jsonpfunction"]=window["fleet_bundle_jsonpfunction"]||[]).push([[2],Array(108).concat([function(module,exports,__webpack_require__){"use strict";module.exports=whitespace;var fromCode=String.fromCharCode;var re=/\s/;function whitespace(character){return re.test(typeof character==="number"?fromCode(character):character.charAt(0))}},,function(module,exports){module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){var target={};for(var i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target}},,function(module,exports){exports=module.exports=trim;function trim(str){if(str.trim)return str.trim();return exports.right(exports.left(str))}exports.left=function(str){if(str.trimLeft)return str.trimLeft();return str.replace(/^\s\s*/,"")};exports.right=function(str){if(str.trimRight)return str.trimRight();var whitespace_pattern=/\s/,i=str.length;while(whitespace_pattern.test(str.charAt(--i)));return str.slice(0,i+1)}},,function(module,exports,__webpack_require__){"use strict";module.exports=decimal;function decimal(character){var code=typeof character==="string"?character.charCodeAt(0):character;return code>=48&&code<=57}},function(module,exports,__webpack_require__){"use strict";module.exports=visit;var visitParents=__webpack_require__(208);var CONTINUE=visitParents.CONTINUE;var SKIP=visitParents.SKIP;var EXIT=visitParents.EXIT;visit.CONTINUE=CONTINUE;visit.SKIP=SKIP;visit.EXIT=EXIT;function visit(tree,test,visitor,reverse){if(typeof test==="function"&&typeof visitor!=="function"){reverse=visitor;visitor=test;test=null}visitParents(tree,test,overload,reverse);function overload(node,parents){var parent=parents[parents.length-1];var index=parent?parent.children.indexOf(node):null;return visitor(node,index,parent)}}},function(module,exports,__webpack_require__){"use strict";var isOldIE=function isOldIE(){var memo;return function memorize(){if(typeof memo==="undefined"){memo=Boolean(window&&document&&document.all&&!window.atob)}return memo}}();var getTarget=function getTarget(){var memo={};return function memorize(target){if(typeof memo[target]==="undefined"){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement){try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}}memo[target]=styleTarget}return memo[target]}}();var stylesInDom=[];function getIndexByIdentifier(identifier){var result=-1;for(var i=0;i<stylesInDom.length;i++){if(stylesInDom[i].identifier===identifier){result=i;break}}return result}function modulesToDom(list,options){var idCountMap={};var identifiers=[];for(var i=0;i<list.length;i++){var item=list[i];var id=options.base?item[0]+options.base:item[0];var count=idCountMap[id]||0;var identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier);var obj={css:item[1],media:item[2],sourceMap:item[3]};if(index!==-1){stylesInDom[index].references++;stylesInDom[index].updater(obj)}else{stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1})}identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style");var attributes=options.attributes||{};if(typeof attributes.nonce==="undefined"){var nonce=true?__webpack_require__.nc:undefined;if(nonce){attributes.nonce=nonce}}Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])}));if(typeof options.insert==="function"){options.insert(style)}else{var target=getTarget(options.insert||"head");if(!target){throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.")}target.appendChild(style)}return style}function removeStyleElement(style){if(style.parentNode===null){return false}style.parentNode.removeChild(style)}var replaceText=function replaceText(){var textStore=[];return function replace(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet){style.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=style.childNodes;if(childNodes[index]){style.removeChild(childNodes[index])}if(childNodes.length){style.insertBefore(cssNode,childNodes[index])}else{style.appendChild(cssNode)}}}function applyToTag(style,options,obj){var css=obj.css;var media=obj.media;var sourceMap=obj.sourceMap;if(media){style.setAttribute("media",media)}else{style.removeAttribute("media")}if(sourceMap&&btoa){css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")}if(style.styleSheet){style.styleSheet.cssText=css}else{while(style.firstChild){style.removeChild(style.firstChild)}style.appendChild(document.createTextNode(css))}}var singleton=null;var singletonCounter=0;function addStyle(obj,options){var style;var update;var remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options));update=applyToSingletonTag.bind(null,style,styleIndex,false);remove=applyToSingletonTag.bind(null,style,styleIndex,true)}else{style=insertStyleElement(options);update=applyToTag.bind(null,style,options);remove=function remove(){removeStyleElement(style)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap){return}update(obj=newObj)}else{remove()}}}module.exports=function(list,options){options=options||{};if(!options.singleton&&typeof options.singleton!=="boolean"){options.singleton=isOldIE()}list=list||[];var lastIdentifiers=modulesToDom(list,options);return function update(newList){newList=newList||[];if(Object.prototype.toString.call(newList)!=="[object Array]"){return}for(var i=0;i<lastIdentifiers.length;i++){var identifier=lastIdentifiers[i];var index=getIndexByIdentifier(identifier);stylesInDom[index].references--}var newLastIdentifiers=modulesToDom(newList,options);for(var _i=0;_i<lastIdentifiers.length;_i++){var _identifier=lastIdentifiers[_i];var _index=getIndexByIdentifier(_identifier);if(stylesInDom[_index].references===0){stylesInDom[_index].updater();stylesInDom.splice(_index,1)}}lastIdentifiers=newLastIdentifiers}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(useSourceMap){var list=[];list.toString=function toString(){return this.map((function(item){var content=cssWithMappingToString(item,useSourceMap);if(item[2]){return"@media ".concat(item[2]," {").concat(content,"}")}return content})).join("")};list.i=function(modules,mediaQuery,dedupe){if(typeof modules==="string"){modules=[[null,modules,""]]}var alreadyImportedModules={};if(dedupe){for(var i=0;i<this.length;i++){var id=this[i][0];if(id!=null){alreadyImportedModules[id]=true}}}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);if(dedupe&&alreadyImportedModules[item[0]]){continue}if(mediaQuery){if(!item[2]){item[2]=mediaQuery}else{item[2]="".concat(mediaQuery," and ").concat(item[2])}}list.push(item)}};return list};function cssWithMappingToString(item,useSourceMap){var content=item[1]||"";var cssMapping=item[3];if(!cssMapping){return content}if(useSourceMap&&typeof btoa==="function"){var sourceMapping=toComment(cssMapping);var sourceURLs=cssMapping.sources.map((function(source){return"/*# sourceURL=".concat(cssMapping.sourceRoot||"").concat(source," */")}));return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}return[content].join("\n")}function toComment(sourceMap){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));var data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64);return"/*# ".concat(data," */")}},,,,,function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var xtend=__webpack_require__(110);var unified=__webpack_require__(176);var parse=__webpack_require__(189);var PropTypes=__webpack_require__(245);var addListMetadata=__webpack_require__(248);var naiveHtml=__webpack_require__(250);var disallowNode=__webpack_require__(251);var astToReact=__webpack_require__(252);var wrapTableRows=__webpack_require__(255);var getDefinitions=__webpack_require__(256);var uriTransformer=__webpack_require__(257);var defaultRenderers=__webpack_require__(258);var symbols=__webpack_require__(259);var allTypes=Object.keys(defaultRenderers);var ReactMarkdown=function ReactMarkdown(props){var src=props.source||props.children||"";var parserOptions=props.parserOptions;if(props.allowedTypes&&props.disallowedTypes){throw new Error("Only one of `allowedTypes` and `disallowedTypes` should be defined")}var renderers=xtend(defaultRenderers,props.renderers);var plugins=[[parse,parserOptions]].concat(props.plugins||[]);var parser=plugins.reduce(applyParserPlugin,unified());var rawAst=parser.parse(src);var renderProps=xtend(props,{renderers:renderers,definitions:getDefinitions(rawAst)});var astPlugins=determineAstPlugins(props);var transformedAst=parser.runSync(rawAst);var ast=astPlugins.reduce((function(node,plugin){return plugin(node,renderProps)}),transformedAst);return astToReact(ast,renderProps)};function applyParserPlugin(parser,plugin){return Array.isArray(plugin)?parser.use.apply(parser,_toConsumableArray(plugin)):parser.use(plugin)}function determineAstPlugins(props){var plugins=[wrapTableRows,addListMetadata()];var disallowedTypes=props.disallowedTypes;if(props.allowedTypes){disallowedTypes=allTypes.filter((function(type){return type!=="root"&&props.allowedTypes.indexOf(type)===-1}))}var removalMethod=props.unwrapDisallowed?"unwrap":"remove";if(disallowedTypes&&disallowedTypes.length>0){plugins.push(disallowNode.ofType(disallowedTypes,removalMethod))}if(props.allowNode){plugins.push(disallowNode.ifNotMatch(props.allowNode,removalMethod))}var renderHtml=!props.escapeHtml&&!props.skipHtml;var hasHtmlParser=(props.astPlugins||[]).some((function(item){var plugin=Array.isArray(item)?item[0]:item;return plugin.identity===symbols.HtmlParser}));if(renderHtml&&!hasHtmlParser){plugins.push(naiveHtml)}return props.astPlugins?plugins.concat(props.astPlugins):plugins}ReactMarkdown.defaultProps={renderers:{},escapeHtml:true,skipHtml:false,sourcePos:false,rawSourcePos:false,transformLinkUri:uriTransformer,astPlugins:[],plugins:[],parserOptions:{}};ReactMarkdown.propTypes={className:PropTypes.string,source:PropTypes.string,children:PropTypes.string,sourcePos:PropTypes.bool,rawSourcePos:PropTypes.bool,escapeHtml:PropTypes.bool,skipHtml:PropTypes.bool,allowNode:PropTypes.func,allowedTypes:PropTypes.arrayOf(PropTypes.oneOf(allTypes)),disallowedTypes:PropTypes.arrayOf(PropTypes.oneOf(allTypes)),transformLinkUri:PropTypes.oneOfType([PropTypes.func,PropTypes.bool]),linkTarget:PropTypes.oneOfType([PropTypes.func,PropTypes.string]),transformImageUri:PropTypes.func,astPlugins:PropTypes.arrayOf(PropTypes.func),unwrapDisallowed:PropTypes.bool,renderers:PropTypes.object,plugins:PropTypes.array,parserOptions:PropTypes.object};ReactMarkdown.types=allTypes;ReactMarkdown.renderers=defaultRenderers;ReactMarkdown.uriTransformer=uriTransformer;module.exports=ReactMarkdown},function(module,exports,__webpack_require__){"use strict";var legacy=__webpack_require__(197);var invalid=__webpack_require__(198);var decimal=__webpack_require__(114);var hexadecimal=__webpack_require__(199);var alphanumerical=__webpack_require__(200);var decodeEntity=__webpack_require__(201);module.exports=parseEntities;var own={}.hasOwnProperty;var fromCharCode=String.fromCharCode;var noop=Function.prototype;var defaults={warning:null,reference:null,text:null,warningContext:null,referenceContext:null,textContext:null,position:{},additional:null,attribute:false,nonTerminated:true};var NAMED="named";var HEXADECIMAL="hexadecimal";var DECIMAL="decimal";var BASE={};BASE[HEXADECIMAL]=16;BASE[DECIMAL]=10;var TESTS={};TESTS[NAMED]=alphanumerical;TESTS[DECIMAL]=decimal;TESTS[HEXADECIMAL]=hexadecimal;var NAMED_NOT_TERMINATED=1;var NUMERIC_NOT_TERMINATED=2;var NAMED_EMPTY=3;var NUMERIC_EMPTY=4;var NAMED_UNKNOWN=5;var NUMERIC_DISALLOWED=6;var NUMERIC_PROHIBITED=7;var MESSAGES={};MESSAGES[NAMED_NOT_TERMINATED]="Named character references must be terminated by a semicolon";MESSAGES[NUMERIC_NOT_TERMINATED]="Numeric character references must be terminated by a semicolon";MESSAGES[NAMED_EMPTY]="Named character references cannot be empty";MESSAGES[NUMERIC_EMPTY]="Numeric character references cannot be empty";MESSAGES[NAMED_UNKNOWN]="Named character references must be known";MESSAGES[NUMERIC_DISALLOWED]="Numeric character references cannot be disallowed";MESSAGES[NUMERIC_PROHIBITED]="Numeric character references cannot be outside the permissible Unicode range";function parseEntities(value,options){var settings={};var option;var key;if(!options){options={}}for(key in defaults){option=options[key];settings[key]=option===null||option===undefined?defaults[key]:option}if(settings.position.indent||settings.position.start){settings.indent=settings.position.indent||[];settings.position=settings.position.start}return parse(value,settings)}function parse(value,settings){var additional=settings.additional;var nonTerminated=settings.nonTerminated;var handleText=settings.text;var handleReference=settings.reference;var handleWarning=settings.warning;var textContext=settings.textContext;var referenceContext=settings.referenceContext;var warningContext=settings.warningContext;var pos=settings.position;var indent=settings.indent||[];var length=value.length;var index=0;var lines=-1;var column=pos.column||1;var line=pos.line||1;var queue="";var result=[];var entityCharacters;var namedEntity;var terminated;var characters;var character;var reference;var following;var warning;var reason;var output;var entity;var begin;var start;var type;var test;var prev;var next;var diff;var end;prev=now();warning=handleWarning?parseError:noop;index--;length++;while(++index<length){if(character==="\n"){column=indent[lines]||1}character=at(index);if(character!=="&"){if(character==="\n"){line++;lines++;column=0}if(character){queue+=character;column++}else{flush()}}else{following=at(index+1);if(following==="\t"||following==="\n"||following==="\f"||following===" "||following==="<"||following==="&"||following===""||additional&&following===additional){queue+=character;column++;continue}start=index+1;begin=start;end=start;if(following!=="#"){type=NAMED}else{end=++begin;following=at(end);if(following==="x"||following==="X"){type=HEXADECIMAL;end=++begin}else{type=DECIMAL}}entityCharacters="";entity="";characters="";test=TESTS[type];end--;while(++end<length){following=at(end);if(!test(following)){break}characters+=following;if(type===NAMED&&own.call(legacy,characters)){entityCharacters=characters;entity=legacy[characters]}}terminated=at(end)===";";if(terminated){end++;namedEntity=type===NAMED?decodeEntity(characters):false;if(namedEntity){entityCharacters=characters;entity=namedEntity}}diff=1+end-start;if(!terminated&&!nonTerminated){}else if(!characters){if(type!==NAMED){warning(NUMERIC_EMPTY,diff)}}else if(type===NAMED){if(terminated&&!entity){warning(NAMED_UNKNOWN,1)}else{if(entityCharacters!==characters){end=begin+entityCharacters.length;diff=1+end-begin;terminated=false}if(!terminated){reason=entityCharacters?NAMED_NOT_TERMINATED:NAMED_EMPTY;if(!settings.attribute){warning(reason,diff)}else{following=at(end);if(following==="="){warning(reason,diff);entity=null}else if(alphanumerical(following)){entity=null}else{warning(reason,diff)}}}}reference=entity}else{if(!terminated){warning(NUMERIC_NOT_TERMINATED,diff)}reference=parseInt(characters,BASE[type]);if(prohibited(reference)){warning(NUMERIC_PROHIBITED,diff);reference="�"}else if(reference in invalid){warning(NUMERIC_DISALLOWED,diff);reference=invalid[reference]}else{output="";if(disallowed(reference)){warning(NUMERIC_DISALLOWED,diff)}if(reference>65535){reference-=65536;output+=fromCharCode(reference>>>(10&1023)|55296);reference=56320|reference&1023}reference=output+fromCharCode(reference)}}if(!reference){characters=value.slice(start-1,end);queue+=characters;column+=characters.length;index=end-1}else{flush();prev=now();index=end-1;column+=end-start+1;result.push(reference);next=now();next.offset++;if(handleReference){handleReference.call(referenceContext,reference,{start:prev,end:next},value.slice(start-1,end))}prev=next}}}return result.join("");function now(){return{line:line,column:column,offset:index+(pos.offset||0)}}function parseError(code,offset){var position=now();position.column+=offset;position.offset+=offset;handleWarning.call(warningContext,MESSAGES[code],position,code)}function at(position){return value.charAt(position)}function flush(){if(queue){result.push(queue);if(handleText){handleText.call(textContext,queue,{start:prev,end:now()})}queue=""}}}function prohibited(code){return code>=55296&&code<=57343||code>1114111}function disallowed(code){return code>=1&&code<=8||code===11||code>=13&&code<=31||code>=127&&code<=159||code>=64976&&code<=65007||(code&65535)===65535||(code&65535)===65534}},function(module,exports,__webpack_require__){"use strict";
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var res="";var cache;module.exports=repeat;function repeat(str,num){if(typeof str!=="string"){throw new TypeError("expected a string")}if(num===1)return str;if(num===2)return str+str;var max=str.length*num;if(cache!==str||typeof cache==="undefined"){cache=str;res=""}else if(res.length>=max){return res.substr(0,max)}while(max>res.length&&num>1){if(num&1){res+=str}num>>=1;str+=str}res+=str;res=res.substr(0,max);return res}},function(module,exports,__webpack_require__){"use strict";module.exports=trimTrailingLines;var line="\n";function trimTrailingLines(value){var val=String(value);var index=val.length;while(val.charAt(--index)===line){}return val.slice(0,index+1)}},function(module,exports,__webpack_require__){"use strict";module.exports=interrupt;function interrupt(interruptors,tokenizers,ctx,params){var bools=["pedantic","commonmark"];var count=bools.length;var length=interruptors.length;var index=-1;var interruptor;var config;var fn;var offset;var bool;var ignore;while(++index<length){interruptor=interruptors[index];config=interruptor[1]||{};fn=interruptor[0];offset=-1;ignore=false;while(++offset<count){bool=bools[offset];if(config[bool]!==undefined&&config[bool]!==ctx.options[bool]){ignore=true;break}}if(ignore){continue}if(tokenizers[fn].apply(ctx,params)){return true}}return false}},function(module,exports,__webpack_require__){"use strict";var collapseWhiteSpace=__webpack_require__(221);module.exports=normalize;function normalize(value){return collapseWhiteSpace(value).toLowerCase()}},,,,,,,,,function(module,exports,__webpack_require__){(function(process){function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),(function(p){return!!p})),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=substr(path,-1)==="/";path=normalizeArray(filter(path.split("/"),(function(p){return!!p})),!isAbsolute).join("/");if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path};exports.isAbsolute=function(path){return path.charAt(0)==="/"};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,(function(p,index){if(typeof p!=="string"){throw new TypeError("Arguments to path.join must be strings")}return p})).join("/"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!=="")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!=="")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){if(typeof path!=="string")path=path+"";if(path.length===0)return".";var code=path.charCodeAt(0);var hasRoot=code===47;var end=-1;var matchedSlash=true;for(var i=path.length-1;i>=1;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){end=i;break}}else{matchedSlash=false}}if(end===-1)return hasRoot?"/":".";if(hasRoot&&end===1){return"/"}return path.slice(0,end)};function basename(path){if(typeof path!=="string")path=path+"";var start=0;var end=-1;var matchedSlash=true;var i;for(i=path.length-1;i>=0;--i){if(path.charCodeAt(i)===47){if(!matchedSlash){start=i+1;break}}else if(end===-1){matchedSlash=false;end=i+1}}if(end===-1)return"";return path.slice(start,end)}exports.basename=function(path,ext){var f=basename(path);if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){if(typeof path!=="string")path=path+"";var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var preDotState=0;for(var i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break}continue}if(end===-1){matchedSlash=false;end=i+1}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1}else if(startDot!==-1){preDotState=-1}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){return""}return path.slice(startDot,end)};function filter(xs,f){if(xs.filter)return xs.filter(f);var res=[];for(var i=0;i<xs.length;i++){if(f(xs[i],i,xs))res.push(xs[i])}return res}var substr="ab".substr(-1)==="b"?function(str,start,len){return str.substr(start,len)}:function(str,start,len){if(start<0)start=str.length+start;return str.substr(start,len)}}).call(this,__webpack_require__(60))},function(module,exports,__webpack_require__){"use strict";module.exports=alphabetical;function alphabetical(character){var code=typeof character==="string"?character.charCodeAt(0):character;return code>=97&&code<=122||code>=65&&code<=90}},function(module,exports,__webpack_require__){"use strict";module.exports={position:true,gfm:true,commonmark:false,footnotes:false,pedantic:false,blocks:__webpack_require__(205)}},function(module,exports,__webpack_require__){"use strict";module.exports=indentation;var characters={" ":1,"\t":4};function indentation(value){var index=0;var indent=0;var character=value.charAt(index);var stops={};var size;while(character in characters){size=characters[character];indent+=size;if(size>1){indent=Math.floor(indent/size)*size}stops[indent]=index;character=value.charAt(++index)}return{indent:indent,stops:stops}}},function(module,exports,__webpack_require__){"use strict";var attributeName="[a-zA-Z_:][a-zA-Z0-9:._-]*";var unquoted="[^\"'=<>`\\u0000-\\u0020]+";var singleQuoted="'[^']*'";var doubleQuoted='"[^"]*"';var attributeValue="(?:"+unquoted+"|"+singleQuoted+"|"+doubleQuoted+")";var attribute="(?:\\s+"+attributeName+"(?:\\s*=\\s*"+attributeValue+")?)";var openTag="<[A-Za-z][A-Za-z0-9\\-]*"+attribute+"*\\s*\\/?>";var closeTag="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>";var comment="\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e";var processing="<[?].*?[?]>";var declaration="<![A-Za-z]+\\s+[^>]*>";var cdata="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>";exports.openCloseTag=new RegExp("^(?:"+openTag+"|"+closeTag+")");exports.tag=new RegExp("^(?:"+openTag+"|"+closeTag+"|"+comment+"|"+processing+"|"+declaration+"|"+cdata+")")},function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("<",fromIndex)}},function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var link=value.indexOf("[",fromIndex);var image=value.indexOf("![",fromIndex);if(image===-1){return link}return link<image?link:image}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";var extend=__webpack_require__(177);var bail=__webpack_require__(178);var vfile=__webpack_require__(179);var trough=__webpack_require__(185);var string=__webpack_require__(186);var func=__webpack_require__(187);var plain=__webpack_require__(188);module.exports=unified().freeze();var slice=[].slice;var own={}.hasOwnProperty;var pipeline=trough().use(pipelineParse).use(pipelineRun).use(pipelineStringify);function pipelineParse(p,ctx){ctx.tree=p.parse(ctx.file)}function pipelineRun(p,ctx,next){p.run(ctx.tree,ctx.file,done);function done(err,tree,file){if(err){next(err)}else{ctx.tree=tree;ctx.file=file;next()}}}function pipelineStringify(p,ctx){ctx.file.contents=p.stringify(ctx.tree,ctx.file)}function unified(){var attachers=[];var transformers=trough();var namespace={};var frozen=false;var freezeIndex=-1;processor.data=data;processor.freeze=freeze;processor.attachers=attachers;processor.use=use;processor.parse=parse;processor.stringify=stringify;processor.run=run;processor.runSync=runSync;processor.process=process;processor.processSync=processSync;return processor;function processor(){var destination=unified();var length=attachers.length;var index=-1;while(++index<length){destination.use.apply(null,attachers[index])}destination.data(extend(true,{},namespace));return destination}function freeze(){var values;var plugin;var options;var transformer;if(frozen){return processor}while(++freezeIndex<attachers.length){values=attachers[freezeIndex];plugin=values[0];options=values[1];transformer=null;if(options===false){continue}if(options===true){values[1]=undefined}transformer=plugin.apply(processor,values.slice(1));if(func(transformer)){transformers.use(transformer)}}frozen=true;freezeIndex=Infinity;return processor}function data(key,value){if(string(key)){if(arguments.length===2){assertUnfrozen("data",frozen);namespace[key]=value;return processor}return own.call(namespace,key)&&namespace[key]||null}if(key){assertUnfrozen("data",frozen);namespace=key;return processor}return namespace}function use(value){var settings;assertUnfrozen("use",frozen);if(value===null||value===undefined){}else if(func(value)){addPlugin.apply(null,arguments)}else if(typeof value==="object"){if("length"in value){addList(value)}else{addPreset(value)}}else{throw new Error("Expected usable value, not `"+value+"`")}if(settings){namespace.settings=extend(namespace.settings||{},settings)}return processor;function addPreset(result){addList(result.plugins);if(result.settings){settings=extend(settings||{},result.settings)}}function add(value){if(func(value)){addPlugin(value)}else if(typeof value==="object"){if("length"in value){addPlugin.apply(null,value)}else{addPreset(value)}}else{throw new Error("Expected usable value, not `"+value+"`")}}function addList(plugins){var length;var index;if(plugins===null||plugins===undefined){}else if(typeof plugins==="object"&&"length"in plugins){length=plugins.length;index=-1;while(++index<length){add(plugins[index])}}else{throw new Error("Expected a list of plugins, not `"+plugins+"`")}}function addPlugin(plugin,value){var entry=find(plugin);if(entry){if(plain(entry[1])&&plain(value)){value=extend(entry[1],value)}entry[1]=value}else{attachers.push(slice.call(arguments))}}}function find(plugin){var length=attachers.length;var index=-1;var entry;while(++index<length){entry=attachers[index];if(entry[0]===plugin){return entry}}}function parse(doc){var file=vfile(doc);var Parser;freeze();Parser=processor.Parser;assertParser("parse",Parser);if(newable(Parser)){return new Parser(String(file),file).parse()}return Parser(String(file),file)}function run(node,file,cb){assertNode(node);freeze();if(!cb&&func(file)){cb=file;file=null}if(!cb){return new Promise(executor)}executor(null,cb);function executor(resolve,reject){transformers.run(node,vfile(file),done);function done(err,tree,file){tree=tree||node;if(err){reject(err)}else if(resolve){resolve(tree)}else{cb(null,tree,file)}}}}function runSync(node,file){var complete=false;var result;run(node,file,done);assertDone("runSync","run",complete);return result;function done(err,tree){complete=true;bail(err);result=tree}}function stringify(node,doc){var file=vfile(doc);var Compiler;freeze();Compiler=processor.Compiler;assertCompiler("stringify",Compiler);assertNode(node);if(newable(Compiler)){return new Compiler(node,file).compile()}return Compiler(node,file)}function process(doc,cb){freeze();assertParser("process",processor.Parser);assertCompiler("process",processor.Compiler);if(!cb){return new Promise(executor)}executor(null,cb);function executor(resolve,reject){var file=vfile(doc);pipeline.run(processor,{file:file},done);function done(err){if(err){reject(err)}else if(resolve){resolve(file)}else{cb(null,file)}}}}function processSync(doc){var complete=false;var file;freeze();assertParser("processSync",processor.Parser);assertCompiler("processSync",processor.Compiler);file=vfile(doc);process(file,done);assertDone("processSync","process",complete);return file;function done(err){complete=true;bail(err)}}}function newable(value){return func(value)&&keys(value.prototype)}function keys(value){var key;for(key in value){return true}return false}function assertParser(name,Parser){if(!func(Parser)){throw new Error("Cannot `"+name+"` without `Parser`")}}function assertCompiler(name,Compiler){if(!func(Compiler)){throw new Error("Cannot `"+name+"` without `Compiler`")}}function assertUnfrozen(name,frozen){if(frozen){throw new Error("Cannot invoke `"+name+"` on a frozen processor.\n"+"Create a new processor first, by invoking it: "+"use `processor()` instead of `processor`.")}}function assertNode(node){if(!node||!string(node.type)){throw new Error("Expected node, got `"+node+"`")}}function assertDone(name,asyncName,complete){if(!complete){throw new Error("`"+name+"` finished async. Use `"+asyncName+"` instead")}}},function(module,exports,__webpack_require__){"use strict";var hasOwn=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var defineProperty=Object.defineProperty;var gOPD=Object.getOwnPropertyDescriptor;var isArray=function isArray(arr){if(typeof Array.isArray==="function"){return Array.isArray(arr)}return toStr.call(arr)==="[object Array]"};var isPlainObject=function isPlainObject(obj){if(!obj||toStr.call(obj)!=="[object Object]"){return false}var hasOwnConstructor=hasOwn.call(obj,"constructor");var hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf){return false}var key;for(key in obj){}return typeof key==="undefined"||hasOwn.call(obj,key)};var setProperty=function setProperty(target,options){if(defineProperty&&options.name==="__proto__"){defineProperty(target,options.name,{enumerable:true,configurable:true,value:options.newValue,writable:true})}else{target[options.name]=options.newValue}};var getProperty=function getProperty(obj,name){if(name==="__proto__"){if(!hasOwn.call(obj,name)){return void 0}else if(gOPD){return gOPD(obj,name).value}}return obj[name]};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone;var target=arguments[0];var i=1;var length=arguments.length;var deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(target==null||typeof target!=="object"&&typeof target!=="function"){target={}}for(;i<length;++i){options=arguments[i];if(options!=null){for(name in options){src=getProperty(target,name);copy=getProperty(options,name);if(target!==copy){if(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&isArray(src)?src:[]}else{clone=src&&isPlainObject(src)?src:{}}setProperty(target,{name:name,newValue:extend(deep,clone,copy)})}else if(typeof copy!=="undefined"){setProperty(target,{name:name,newValue:copy})}}}}}return target}},function(module,exports,__webpack_require__){"use strict";module.exports=bail;function bail(err){if(err){throw err}}},function(module,exports,__webpack_require__){"use strict";var VMessage=__webpack_require__(180);var VFile=__webpack_require__(182);module.exports=VFile;var proto=VFile.prototype;proto.message=message;proto.info=info;proto.fail=fail;proto.warn=message;function message(reason,position,origin){var filePath=this.path;var message=new VMessage(reason,position,origin);if(filePath){message.name=filePath+":"+message.name;message.file=filePath}message.fatal=false;this.messages.push(message);return message}function fail(){var message=this.message.apply(this,arguments);message.fatal=true;throw message}function info(){var message=this.message.apply(this,arguments);message.fatal=null;return message}},function(module,exports,__webpack_require__){"use strict";var stringify=__webpack_require__(181);module.exports=VMessage;function VMessagePrototype(){}VMessagePrototype.prototype=Error.prototype;VMessage.prototype=new VMessagePrototype;var proto=VMessage.prototype;proto.file="";proto.name="";proto.reason="";proto.message="";proto.stack="";proto.fatal=null;proto.column=null;proto.line=null;function VMessage(reason,position,origin){var parts;var range;var location;if(typeof position==="string"){origin=position;position=null}parts=parseOrigin(origin);range=stringify(position)||"1:1";location={start:{line:null,column:null},end:{line:null,column:null}};if(position&&position.position){position=position.position}if(position){if(position.start){location=position;position=position.start}else{location.start=position}}if(reason.stack){this.stack=reason.stack;reason=reason.message}this.message=reason;this.name=range;this.reason=reason;this.line=position?position.line:null;this.column=position?position.column:null;this.location=location;this.source=parts[0];this.ruleId=parts[1]}function parseOrigin(origin){var result=[null,null];var index;if(typeof origin==="string"){index=origin.indexOf(":");if(index===-1){result[1]=origin}else{result[0]=origin.slice(0,index);result[1]=origin.slice(index+1)}}return result}},function(module,exports,__webpack_require__){"use strict";var own={}.hasOwnProperty;module.exports=stringify;function stringify(value){if(!value||typeof value!=="object"){return null}if(own.call(value,"position")||own.call(value,"type")){return location(value.position)}if(own.call(value,"start")||own.call(value,"end")){return location(value)}if(own.call(value,"line")||own.call(value,"column")){return position(value)}return null}function position(pos){if(!pos||typeof pos!=="object"){pos={}}return index(pos.line)+":"+index(pos.column)}function location(loc){if(!loc||typeof loc!=="object"){loc={}}return position(loc.start)+"-"+position(loc.end)}function index(value){return value&&typeof value==="number"?value:1}},function(module,exports,__webpack_require__){"use strict";(function(process){var path=__webpack_require__(136);var replace=__webpack_require__(183);var buffer=__webpack_require__(184);module.exports=VFile;var own={}.hasOwnProperty;var proto=VFile.prototype;proto.toString=toString;var order=["history","path","basename","stem","extname","dirname"];function VFile(options){var prop;var index;var length;if(!options){options={}}else if(typeof options==="string"||buffer(options)){options={contents:options}}else if("message"in options&&"messages"in options){return options}if(!(this instanceof VFile)){return new VFile(options)}this.data={};this.messages=[];this.history=[];this.cwd=process.cwd();index=-1;length=order.length;while(++index<length){prop=order[index];if(own.call(options,prop)){this[prop]=options[prop]}}for(prop in options){if(order.indexOf(prop)===-1){this[prop]=options[prop]}}}Object.defineProperty(proto,"path",{get:function(){return this.history[this.history.length-1]},set:function(path){assertNonEmpty(path,"path");if(path!==this.path){this.history.push(path)}}});Object.defineProperty(proto,"dirname",{get:function(){return typeof this.path==="string"?path.dirname(this.path):undefined},set:function(dirname){assertPath(this.path,"dirname");this.path=path.join(dirname||"",this.basename)}});Object.defineProperty(proto,"basename",{get:function(){return typeof this.path==="string"?path.basename(this.path):undefined},set:function(basename){assertNonEmpty(basename,"basename");assertPart(basename,"basename");this.path=path.join(this.dirname||"",basename)}});Object.defineProperty(proto,"extname",{get:function(){return typeof this.path==="string"?path.extname(this.path):undefined},set:function(extname){var ext=extname||"";assertPart(ext,"extname");assertPath(this.path,"extname");if(ext){if(ext.charAt(0)!=="."){throw new Error("`extname` must start with `.`")}if(ext.indexOf(".",1)!==-1){throw new Error("`extname` cannot contain multiple dots")}}this.path=replace(this.path,ext)}});Object.defineProperty(proto,"stem",{get:function(){return typeof this.path==="string"?path.basename(this.path,this.extname):undefined},set:function(stem){assertNonEmpty(stem,"stem");assertPart(stem,"stem");this.path=path.join(this.dirname||"",stem+(this.extname||""))}});function toString(encoding){var value=this.contents||"";return buffer(value)?value.toString(encoding):String(value)}function assertPart(part,name){if(part.indexOf(path.sep)!==-1){throw new Error("`"+name+"` cannot be a path: did not expect `"+path.sep+"`")}}function assertNonEmpty(part,name){if(!part){throw new Error("`"+name+"` cannot be empty")}}function assertPath(path,name){if(!path){throw new Error("Setting `"+name+"` requires `path` to be set too")}}}).call(this,__webpack_require__(60))},function(module,exports,__webpack_require__){"use strict";var path=__webpack_require__(136);function replaceExt(npath,ext){if(typeof npath!=="string"){return npath}if(npath.length===0){return npath}var nFileName=path.basename(npath,path.extname(npath))+ext;return path.join(path.dirname(npath),nFileName)}module.exports=replaceExt},function(module,exports){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
module.exports=function(obj){return obj!=null&&(isBuffer(obj)||isSlowBuffer(obj)||!!obj._isBuffer)};function isBuffer(obj){return!!obj.constructor&&typeof obj.constructor.isBuffer==="function"&&obj.constructor.isBuffer(obj)}function isSlowBuffer(obj){return typeof obj.readFloatLE==="function"&&typeof obj.slice==="function"&&isBuffer(obj.slice(0,0))}},function(module,exports,__webpack_require__){"use strict";module.exports=trough;var slice=[].slice;function trough(){var fns=[];var middleware={};middleware.run=run;middleware.use=use;return middleware;function run(){var index=-1;var input=slice.call(arguments,0,-1);var done=arguments[arguments.length-1];if(typeof done!=="function"){throw new Error("Expected function as last argument, not "+done)}next.apply(null,[null].concat(input));function next(err){var fn=fns[++index];var params=slice.call(arguments,0);var values=params.slice(1);var length=input.length;var pos=-1;if(err){done(err);return}while(++pos<length){if(values[pos]===null||values[pos]===undefined){values[pos]=input[pos]}}input=values;if(fn){wrap(fn,next).apply(null,input)}else{done.apply(null,[null].concat(input))}}}function use(fn){if(typeof fn!=="function"){throw new Error("Expected `fn` to be a function, not "+fn)}fns.push(fn);return middleware}}function wrap(fn,next){var invoked;return wrapped;function wrapped(){var params=slice.call(arguments,0);var callback=fn.length>params.length;var result;if(callback){params.push(done)}try{result=fn.apply(null,params)}catch(err){if(callback&&invoked){throw err}return done(err)}if(!callback){if(result&&typeof result.then==="function"){result.then(then,done)}else if(result instanceof Error){done(result)}else{then(result)}}}function done(){if(!invoked){invoked=true;next.apply(null,arguments)}}function then(value){done(null,value)}}},function(module,exports){var toString=Object.prototype.toString;module.exports=isString;function isString(obj){return toString.call(obj)==="[object String]"}},function(module,exports){module.exports=function isFunction(fn){return Object.prototype.toString.call(fn)==="[object Function]"}},function(module,exports,__webpack_require__){"use strict";var toString=Object.prototype.toString;module.exports=function(x){var prototype;return toString.call(x)==="[object Object]"&&(prototype=Object.getPrototypeOf(x),prototype===null||prototype===Object.getPrototypeOf({}))}},function(module,exports,__webpack_require__){"use strict";var unherit=__webpack_require__(190);var xtend=__webpack_require__(110);var Parser=__webpack_require__(192);module.exports=parse;parse.Parser=Parser;function parse(options){var Local=unherit(Parser);Local.prototype.options=xtend(Local.prototype.options,this.data("settings"),options);this.Parser=Local}},function(module,exports,__webpack_require__){"use strict";
/**
 * @author Titus Wormer
 * @copyright 2015 Titus Wormer
 * @license MIT
 * @module unherit
 * @fileoverview Create a custom constructor which can be modified
 *   without affecting the original class.
 */var xtend=__webpack_require__(110);var inherits=__webpack_require__(191);module.exports=unherit;function unherit(Super){var result;var key;var value;inherits(Of,Super);inherits(From,Of);result=Of.prototype;for(key in result){value=result[key];if(value&&typeof value==="object"){result[key]="concat"in value?value.concat():xtend(value)}}return Of;function From(parameters){return Super.apply(this,parameters)}function Of(){if(!(this instanceof Of)){return new From(arguments)}return Super.apply(this,arguments)}}},function(module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}}else{module.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}}},function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(110);var toggle=__webpack_require__(193);var vfileLocation=__webpack_require__(194);var unescape=__webpack_require__(195);var decode=__webpack_require__(196);var tokenizer=__webpack_require__(202);module.exports=Parser;function Parser(doc,file){this.file=file;this.offset={};this.options=xtend(this.options);this.setOptions({});this.inList=false;this.inBlock=false;this.inLink=false;this.atStart=true;this.toOffset=vfileLocation(file).toOffset;this.unescape=unescape(this,"escape");this.decode=decode(this)}var proto=Parser.prototype;proto.setOptions=__webpack_require__(203);proto.parse=__webpack_require__(206);proto.options=__webpack_require__(138);proto.exitStart=toggle("atStart",true);proto.enterList=toggle("inList",false);proto.enterLink=toggle("inLink",false);proto.enterBlock=toggle("inBlock",false);proto.interruptParagraph=[["thematicBreak"],["atxHeading"],["fencedCode"],["blockquote"],["html"],["setextHeading",{commonmark:false}],["definition",{commonmark:false}],["footnote",{commonmark:false}]];proto.interruptList=[["atxHeading",{pedantic:false}],["fencedCode",{pedantic:false}],["thematicBreak",{pedantic:false}],["definition",{commonmark:false}],["footnote",{commonmark:false}]];proto.interruptBlockquote=[["indentedCode",{commonmark:true}],["fencedCode",{commonmark:true}],["atxHeading",{commonmark:true}],["setextHeading",{commonmark:true}],["thematicBreak",{commonmark:true}],["html",{commonmark:true}],["list",{commonmark:true}],["definition",{commonmark:false}],["footnote",{commonmark:false}]];proto.blockTokenizers={newline:__webpack_require__(210),indentedCode:__webpack_require__(211),fencedCode:__webpack_require__(212),blockquote:__webpack_require__(213),atxHeading:__webpack_require__(214),thematicBreak:__webpack_require__(215),list:__webpack_require__(216),setextHeading:__webpack_require__(218),html:__webpack_require__(219),footnote:__webpack_require__(220),definition:__webpack_require__(222),table:__webpack_require__(223),paragraph:__webpack_require__(224)};proto.inlineTokenizers={escape:__webpack_require__(225),autoLink:__webpack_require__(227),url:__webpack_require__(228),html:__webpack_require__(230),link:__webpack_require__(231),reference:__webpack_require__(232),strong:__webpack_require__(233),emphasis:__webpack_require__(235),deletion:__webpack_require__(238),code:__webpack_require__(240),break:__webpack_require__(242),text:__webpack_require__(244)};proto.blockMethods=keys(proto.blockTokenizers);proto.inlineMethods=keys(proto.inlineTokenizers);proto.tokenizeBlock=tokenizer("block");proto.tokenizeInline=tokenizer("inline");proto.tokenizeFactory=tokenizer;function keys(value){var result=[];var key;for(key in value){result.push(key)}return result}},function(module,exports,__webpack_require__){"use strict";
/**
 * @author Titus Wormer
 * @copyright 2016 Titus Wormer
 * @license MIT
 * @module state-toggle
 * @fileoverview Enter/exit a state.
 */module.exports=factory;function factory(key,state,ctx){return function(){var context=ctx||this;var current=context[key];context[key]=!state;return function(){context[key]=current}}}},function(module,exports,__webpack_require__){"use strict";module.exports=factory;function factory(file){var contents=indices(String(file));return{toPosition:offsetToPositionFactory(contents),toOffset:positionToOffsetFactory(contents)}}function offsetToPositionFactory(indices){return offsetToPosition;function offsetToPosition(offset){var index=-1;var length=indices.length;if(offset<0){return{}}while(++index<length){if(indices[index]>offset){return{line:index+1,column:offset-(indices[index-1]||0)+1,offset:offset}}}return{}}}function positionToOffsetFactory(indices){return positionToOffset;function positionToOffset(position){var line=position&&position.line;var column=position&&position.column;if(!isNaN(line)&&!isNaN(column)&&line-1 in indices){return(indices[line-2]||0)+column-1||0}return-1}}function indices(value){var result=[];var index=value.indexOf("\n");while(index!==-1){result.push(index+1);index=value.indexOf("\n",index+1)}result.push(value.length+1);return result}},function(module,exports,__webpack_require__){"use strict";module.exports=factory;function factory(ctx,key){return unescape;function unescape(value){var prev=0;var index=value.indexOf("\\");var escape=ctx[key];var queue=[];var character;while(index!==-1){queue.push(value.slice(prev,index));prev=index+1;character=value.charAt(prev);if(!character||escape.indexOf(character)===-1){queue.push("\\")}index=value.indexOf("\\",prev)}queue.push(value.slice(prev));return queue.join("")}}},function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(110);var entities=__webpack_require__(123);module.exports=factory;function factory(ctx){decoder.raw=decodeRaw;return decoder;function normalize(position){var offsets=ctx.offset;var line=position.line;var result=[];while(++line){if(!(line in offsets)){break}result.push((offsets[line]||0)+1)}return{start:position,indent:result}}function handleWarning(reason,position,code){if(code===3){return}ctx.file.message(reason,position)}function decoder(value,position,handler){entities(value,{position:normalize(position),warning:handleWarning,text:handler,reference:handler,textContext:ctx,referenceContext:ctx})}function decodeRaw(value,position,options){return entities(value,xtend(options,{position:normalize(position),warning:handleWarning}))}}},function(module){module.exports=JSON.parse('{"AElig":"Æ","AMP":"&","Aacute":"Á","Acirc":"Â","Agrave":"À","Aring":"Å","Atilde":"Ã","Auml":"Ä","COPY":"©","Ccedil":"Ç","ETH":"Ð","Eacute":"É","Ecirc":"Ê","Egrave":"È","Euml":"Ë","GT":">","Iacute":"Í","Icirc":"Î","Igrave":"Ì","Iuml":"Ï","LT":"<","Ntilde":"Ñ","Oacute":"Ó","Ocirc":"Ô","Ograve":"Ò","Oslash":"Ø","Otilde":"Õ","Ouml":"Ö","QUOT":"\\"","REG":"®","THORN":"Þ","Uacute":"Ú","Ucirc":"Û","Ugrave":"Ù","Uuml":"Ü","Yacute":"Ý","aacute":"á","acirc":"â","acute":"´","aelig":"æ","agrave":"à","amp":"&","aring":"å","atilde":"ã","auml":"ä","brvbar":"¦","ccedil":"ç","cedil":"¸","cent":"¢","copy":"©","curren":"¤","deg":"°","divide":"÷","eacute":"é","ecirc":"ê","egrave":"è","eth":"ð","euml":"ë","frac12":"½","frac14":"¼","frac34":"¾","gt":">","iacute":"í","icirc":"î","iexcl":"¡","igrave":"ì","iquest":"¿","iuml":"ï","laquo":"«","lt":"<","macr":"¯","micro":"µ","middot":"·","nbsp":" ","not":"¬","ntilde":"ñ","oacute":"ó","ocirc":"ô","ograve":"ò","ordf":"ª","ordm":"º","oslash":"ø","otilde":"õ","ouml":"ö","para":"¶","plusmn":"±","pound":"£","quot":"\\"","raquo":"»","reg":"®","sect":"§","shy":"­","sup1":"¹","sup2":"²","sup3":"³","szlig":"ß","thorn":"þ","times":"×","uacute":"ú","ucirc":"û","ugrave":"ù","uml":"¨","uuml":"ü","yacute":"ý","yen":"¥","yuml":"ÿ"}')},function(module){module.exports=JSON.parse('{"0":"�","128":"€","130":"‚","131":"ƒ","132":"„","133":"…","134":"†","135":"‡","136":"ˆ","137":"‰","138":"Š","139":"‹","140":"Œ","142":"Ž","145":"‘","146":"’","147":"“","148":"”","149":"•","150":"–","151":"—","152":"˜","153":"™","154":"š","155":"›","156":"œ","158":"ž","159":"Ÿ"}')},function(module,exports,__webpack_require__){"use strict";module.exports=hexadecimal;function hexadecimal(character){var code=typeof character==="string"?character.charCodeAt(0):character;return code>=97&&code<=102||code>=65&&code<=70||code>=48&&code<=57}},function(module,exports,__webpack_require__){"use strict";var alphabetical=__webpack_require__(137);var decimal=__webpack_require__(114);module.exports=alphanumerical;function alphanumerical(character){return alphabetical(character)||decimal(character)}},function(module,exports,__webpack_require__){"use strict";var el;module.exports=decodeEntity;function decodeEntity(characters){var entity="&"+characters+";";var char;el=el||document.createElement("i");el.innerHTML=entity;char=el.textContent;if(char.slice(-1)===";"&&characters!=="semi"){return false}return char===entity?false:char}},function(module,exports,__webpack_require__){"use strict";module.exports=factory;var MERGEABLE_NODES={text:mergeText,blockquote:mergeBlockquote};function mergeable(node){var start;var end;if(node.type!=="text"||!node.position){return true}start=node.position.start;end=node.position.end;return start.line!==end.line||end.column-start.column===node.value.length}function mergeText(prev,node){prev.value+=node.value;return prev}function mergeBlockquote(prev,node){if(this.options.commonmark){return node}prev.children=prev.children.concat(node.children);return prev}function factory(type){return tokenize;function tokenize(value,location){var self=this;var offset=self.offset;var tokens=[];var methods=self[type+"Methods"];var tokenizers=self[type+"Tokenizers"];var line=location.line;var column=location.column;var index;var length;var method;var name;var matched;var valueLength;if(!value){return tokens}eat.now=now;eat.file=self.file;updatePosition("");while(value){index=-1;length=methods.length;matched=false;while(++index<length){name=methods[index];method=tokenizers[name];if(method&&(!method.onlyAtStart||self.atStart)&&(!method.notInList||!self.inList)&&(!method.notInBlock||!self.inBlock)&&(!method.notInLink||!self.inLink)){valueLength=value.length;method.apply(self,[eat,value]);matched=valueLength!==value.length;if(matched){break}}}if(!matched){self.file.fail(new Error("Infinite loop"),eat.now())}}self.eof=now();return tokens;function updatePosition(subvalue){var lastIndex=-1;var index=subvalue.indexOf("\n");while(index!==-1){line++;lastIndex=index;index=subvalue.indexOf("\n",index+1)}if(lastIndex===-1){column+=subvalue.length}else{column=subvalue.length-lastIndex}if(line in offset){if(lastIndex!==-1){column+=offset[line]}else if(column<=offset[line]){column=offset[line]+1}}}function getOffset(){var indentation=[];var pos=line+1;return function(){var last=line+1;while(pos<last){indentation.push((offset[pos]||0)+1);pos++}return indentation}}function now(){var pos={line:line,column:column};pos.offset=self.toOffset(pos);return pos}function Position(start){this.start=start;this.end=now()}function validateEat(subvalue){if(value.substring(0,subvalue.length)!==subvalue){self.file.fail(new Error("Incorrectly eaten value: please report this "+"warning on http://git.io/vg5Ft"),now())}}function position(){var before=now();return update;function update(node,indent){var prev=node.position;var start=prev?prev.start:before;var combined=[];var n=prev&&prev.end.line;var l=before.line;node.position=new Position(start);if(prev&&indent&&prev.indent){combined=prev.indent;if(n<l){while(++n<l){combined.push((offset[n]||0)+1)}combined.push(before.column)}indent=combined.concat(indent)}node.position.indent=indent||[];return node}}function add(node,parent){var children=parent?parent.children:tokens;var prev=children[children.length-1];if(prev&&node.type===prev.type&&node.type in MERGEABLE_NODES&&mergeable(prev)&&mergeable(node)){node=MERGEABLE_NODES[node.type].call(self,prev,node)}if(node!==prev){children.push(node)}if(self.atStart&&tokens.length!==0){self.exitStart()}return node}function eat(subvalue){var indent=getOffset();var pos=position();var current=now();validateEat(subvalue);apply.reset=reset;reset.test=test;apply.test=test;value=value.substring(subvalue.length);updatePosition(subvalue);indent=indent();return apply;function apply(node,parent){return pos(add(pos(node),parent),indent)}function reset(){var node=apply.apply(null,arguments);line=current.line;column=current.column;value=subvalue+value;return node}function test(){var result=pos({});line=current.line;column=current.column;value=subvalue+value;return result.position}}}}},function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(110);var escapes=__webpack_require__(204);var defaults=__webpack_require__(138);module.exports=setOptions;function setOptions(options){var self=this;var current=self.options;var key;var value;if(options==null){options={}}else if(typeof options==="object"){options=xtend(options)}else{throw new Error("Invalid value `"+options+"` "+"for setting `options`")}for(key in defaults){value=options[key];if(value==null){value=current[key]}if(key!=="blocks"&&typeof value!=="boolean"||key==="blocks"&&typeof value!=="object"){throw new Error("Invalid value `"+value+"` for setting `options."+key+"`")}options[key]=value}self.options=options;self.escape=escapes(options);return self}},function(module,exports,__webpack_require__){"use strict";module.exports=escapes;var defaults=["\\","`","*","{","}","[","]","(",")","#","+","-",".","!","_",">"];var gfm=defaults.concat(["~","|"]);var commonmark=gfm.concat(["\n",'"',"$","%","&","'",",","/",":",";","<","=","?","@","^"]);escapes.default=defaults;escapes.gfm=gfm;escapes.commonmark=commonmark;function escapes(options){var settings=options||{};if(settings.commonmark){return commonmark}return settings.gfm?gfm:defaults}},function(module){module.exports=JSON.parse('["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","legend","li","link","main","menu","menuitem","meta","nav","noframes","ol","optgroup","option","p","param","pre","section","source","title","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]')},function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(110);var removePosition=__webpack_require__(207);module.exports=parse;var C_NEWLINE="\n";var EXPRESSION_LINE_BREAKS=/\r\n|\r/g;function parse(){var self=this;var value=String(self.file);var start={line:1,column:1,offset:0};var content=xtend(start);var node;value=value.replace(EXPRESSION_LINE_BREAKS,C_NEWLINE);if(value.charCodeAt(0)===65279){value=value.slice(1);content.column++;content.offset++}node={type:"root",children:self.tokenizeBlock(value,content),position:{start:start,end:self.eof||xtend(start)}};if(!self.options.position){removePosition(node,true)}return node}},function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(115);module.exports=removePosition;function removePosition(node,force){visit(node,force?hard:soft);return node}function hard(node){delete node.position}function soft(node){node.position=undefined}},function(module,exports,__webpack_require__){"use strict";module.exports=visitParents;var convert=__webpack_require__(209);var CONTINUE=true;var SKIP="skip";var EXIT=false;visitParents.CONTINUE=CONTINUE;visitParents.SKIP=SKIP;visitParents.EXIT=EXIT;function visitParents(tree,test,visitor,reverse){var is;if(typeof test==="function"&&typeof visitor!=="function"){reverse=visitor;visitor=test;test=null}is=convert(test);one(tree,null,[]);function one(node,index,parents){var result=[];var subresult;if(!test||is(node,index,parents[parents.length-1]||null)){result=toResult(visitor(node,parents));if(result[0]===EXIT){return result}}if(node.children&&result[0]!==SKIP){subresult=toResult(all(node.children,parents.concat(node)));return subresult[0]===EXIT?subresult:result}return result}function all(children,parents){var min=-1;var step=reverse?-1:1;var index=(reverse?children.length:min)+step;var result;while(index>min&&index<children.length){result=one(children[index],index,parents);if(result[0]===EXIT){return result}index=typeof result[1]==="number"?result[1]:index+step}}}function toResult(value){if(value!==null&&typeof value==="object"&&"length"in value){return value}if(typeof value==="number"){return[CONTINUE,value]}return[value]}},function(module,exports,__webpack_require__){"use strict";module.exports=convert;function convert(test){if(typeof test==="string"){return typeFactory(test)}if(test===null||test===undefined){return ok}if(typeof test==="object"){return("length"in test?anyFactory:matchesFactory)(test)}if(typeof test==="function"){return test}throw new Error("Expected function, string, or object as test")}function convertAll(tests){var results=[];var length=tests.length;var index=-1;while(++index<length){results[index]=convert(tests[index])}return results}function matchesFactory(test){return matches;function matches(node){var key;for(key in test){if(node[key]!==test[key]){return false}}return true}}function anyFactory(tests){var checks=convertAll(tests);var length=checks.length;return matches;function matches(){var index=-1;while(++index<length){if(checks[index].apply(this,arguments)){return true}}return false}}function typeFactory(test){return type;function type(node){return Boolean(node&&node.type===test)}}function ok(){return true}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(108);module.exports=newline;function newline(eat,value,silent){var character=value.charAt(0);var length;var subvalue;var queue;var index;if(character!=="\n"){return}if(silent){return true}index=1;length=value.length;subvalue=character;queue="";while(index<length){character=value.charAt(index);if(!whitespace(character)){break}queue+=character;if(character==="\n"){subvalue+=queue;queue=""}index++}eat(subvalue)}},function(module,exports,__webpack_require__){"use strict";var repeat=__webpack_require__(124);var trim=__webpack_require__(125);module.exports=indentedCode;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var CODE_INDENT_COUNT=4;var CODE_INDENT=repeat(C_SPACE,CODE_INDENT_COUNT);function indentedCode(eat,value,silent){var index=-1;var length=value.length;var subvalue="";var content="";var subvalueQueue="";var contentQueue="";var character;var blankQueue;var indent;while(++index<length){character=value.charAt(index);if(indent){indent=false;subvalue+=subvalueQueue;content+=contentQueue;subvalueQueue="";contentQueue="";if(character===C_NEWLINE){subvalueQueue=character;contentQueue=character}else{subvalue+=character;content+=character;while(++index<length){character=value.charAt(index);if(!character||character===C_NEWLINE){contentQueue=character;subvalueQueue=character;break}subvalue+=character;content+=character}}}else if(character===C_SPACE&&value.charAt(index+1)===character&&value.charAt(index+2)===character&&value.charAt(index+3)===character){subvalueQueue+=CODE_INDENT;index+=3;indent=true}else if(character===C_TAB){subvalueQueue+=character;indent=true}else{blankQueue="";while(character===C_TAB||character===C_SPACE){blankQueue+=character;character=value.charAt(++index)}if(character!==C_NEWLINE){break}subvalueQueue+=blankQueue+character;contentQueue+=character}}if(content){if(silent){return true}return eat(subvalue)({type:"code",lang:null,value:trim(content)})}}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(125);module.exports=fencedCode;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_TILDE="~";var C_TICK="`";var MIN_FENCE_COUNT=3;var CODE_INDENT_COUNT=4;function fencedCode(eat,value,silent){var self=this;var settings=self.options;var length=value.length+1;var index=0;var subvalue="";var fenceCount;var marker;var character;var flag;var queue;var content;var exdentedContent;var closing;var exdentedClosing;var indent;var now;if(!settings.gfm){return}while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}subvalue+=character;index++}indent=index;character=value.charAt(index);if(character!==C_TILDE&&character!==C_TICK){return}index++;marker=character;fenceCount=1;subvalue+=character;while(index<length){character=value.charAt(index);if(character!==marker){break}subvalue+=character;fenceCount++;index++}if(fenceCount<MIN_FENCE_COUNT){return}while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}subvalue+=character;index++}flag="";queue="";while(index<length){character=value.charAt(index);if(character===C_NEWLINE||character===C_TILDE||character===C_TICK){break}if(character===C_SPACE||character===C_TAB){queue+=character}else{flag+=queue+character;queue=""}index++}character=value.charAt(index);if(character&&character!==C_NEWLINE){return}if(silent){return true}now=eat.now();now.column+=subvalue.length;now.offset+=subvalue.length;subvalue+=flag;flag=self.decode.raw(self.unescape(flag),now);if(queue){subvalue+=queue}queue="";closing="";exdentedClosing="";content="";exdentedContent="";while(index<length){character=value.charAt(index);content+=closing;exdentedContent+=exdentedClosing;closing="";exdentedClosing="";if(character!==C_NEWLINE){content+=character;exdentedClosing+=character;index++;continue}if(content){closing+=character;exdentedClosing+=character}else{subvalue+=character}queue="";index++;while(index<length){character=value.charAt(index);if(character!==C_SPACE){break}queue+=character;index++}closing+=queue;exdentedClosing+=queue.slice(indent);if(queue.length>=CODE_INDENT_COUNT){continue}queue="";while(index<length){character=value.charAt(index);if(character!==marker){break}queue+=character;index++}closing+=queue;exdentedClosing+=queue;if(queue.length<fenceCount){continue}queue="";while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}closing+=character;exdentedClosing+=character;index++}if(!character||character===C_NEWLINE){break}}subvalue+=content+closing;return eat(subvalue)({type:"code",lang:flag||null,value:trim(exdentedContent)})}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(112);var interrupt=__webpack_require__(126);module.exports=blockquote;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_GT=">";function blockquote(eat,value,silent){var self=this;var offsets=self.offset;var tokenizers=self.blockTokenizers;var interruptors=self.interruptBlockquote;var now=eat.now();var currentLine=now.line;var length=value.length;var values=[];var contents=[];var indents=[];var add;var index=0;var character;var rest;var nextIndex;var content;var line;var startIndex;var prefixed;var exit;while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}index++}if(value.charAt(index)!==C_GT){return}if(silent){return true}index=0;while(index<length){nextIndex=value.indexOf(C_NEWLINE,index);startIndex=index;prefixed=false;if(nextIndex===-1){nextIndex=length}while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}index++}if(value.charAt(index)===C_GT){index++;prefixed=true;if(value.charAt(index)===C_SPACE){index++}}else{index=startIndex}content=value.slice(index,nextIndex);if(!prefixed&&!trim(content)){index=startIndex;break}if(!prefixed){rest=value.slice(index);if(interrupt(interruptors,tokenizers,self,[eat,rest,true])){break}}line=startIndex===index?content:value.slice(startIndex,nextIndex);indents.push(index-startIndex);values.push(line);contents.push(content);index=nextIndex+1}index=-1;length=indents.length;add=eat(values.join(C_NEWLINE));while(++index<length){offsets[currentLine]=(offsets[currentLine]||0)+indents[index];currentLine++}exit=self.enterBlock();contents=self.tokenizeBlock(contents.join(C_NEWLINE),now);exit();return add({type:"blockquote",children:contents})}},function(module,exports,__webpack_require__){"use strict";module.exports=atxHeading;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_HASH="#";var MAX_ATX_COUNT=6;function atxHeading(eat,value,silent){var self=this;var settings=self.options;var length=value.length+1;var index=-1;var now=eat.now();var subvalue="";var content="";var character;var queue;var depth;while(++index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){index--;break}subvalue+=character}depth=0;while(++index<=length){character=value.charAt(index);if(character!==C_HASH){index--;break}subvalue+=character;depth++}if(depth>MAX_ATX_COUNT){return}if(!depth||!settings.pedantic&&value.charAt(index+1)===C_HASH){return}length=value.length+1;queue="";while(++index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){index--;break}queue+=character}if(!settings.pedantic&&queue.length===0&&character&&character!==C_NEWLINE){return}if(silent){return true}subvalue+=queue;queue="";content="";while(++index<length){character=value.charAt(index);if(!character||character===C_NEWLINE){break}if(character!==C_SPACE&&character!==C_TAB&&character!==C_HASH){content+=queue+character;queue="";continue}while(character===C_SPACE||character===C_TAB){queue+=character;character=value.charAt(++index)}while(character===C_HASH){queue+=character;character=value.charAt(++index)}while(character===C_SPACE||character===C_TAB){queue+=character;character=value.charAt(++index)}index--}now.column+=subvalue.length;now.offset+=subvalue.length;subvalue+=content+queue;return eat(subvalue)({type:"heading",depth:depth,children:self.tokenizeInline(content,now)})}},function(module,exports,__webpack_require__){"use strict";module.exports=thematicBreak;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_ASTERISK="*";var C_UNDERSCORE="_";var C_DASH="-";var THEMATIC_BREAK_MARKER_COUNT=3;function thematicBreak(eat,value,silent){var index=-1;var length=value.length+1;var subvalue="";var character;var marker;var markerCount;var queue;while(++index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}subvalue+=character}if(character!==C_ASTERISK&&character!==C_DASH&&character!==C_UNDERSCORE){return}marker=character;subvalue+=character;markerCount=1;queue="";while(++index<length){character=value.charAt(index);if(character===marker){markerCount++;subvalue+=queue+marker;queue=""}else if(character===C_SPACE){queue+=character}else if(markerCount>=THEMATIC_BREAK_MARKER_COUNT&&(!character||character===C_NEWLINE)){subvalue+=queue;if(silent){return true}return eat(subvalue)({type:"thematicBreak"})}else{return}}}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(112);var repeat=__webpack_require__(124);var decimal=__webpack_require__(114);var getIndent=__webpack_require__(139);var removeIndent=__webpack_require__(217);var interrupt=__webpack_require__(126);module.exports=list;var C_ASTERISK="*";var C_UNDERSCORE="_";var C_PLUS="+";var C_DASH="-";var C_DOT=".";var C_SPACE=" ";var C_NEWLINE="\n";var C_TAB="\t";var C_PAREN_CLOSE=")";var C_X_LOWER="x";var TAB_SIZE=4;var EXPRESSION_LOOSE_LIST_ITEM=/\n\n(?!\s*$)/;var EXPRESSION_TASK_ITEM=/^\[([ \t]|x|X)][ \t]/;var EXPRESSION_BULLET=/^([ \t]*)([*+-]|\d+[.)])( {1,4}(?! )| |\t|$|(?=\n))([^\n]*)/;var EXPRESSION_PEDANTIC_BULLET=/^([ \t]*)([*+-]|\d+[.)])([ \t]+)/;var EXPRESSION_INITIAL_INDENT=/^( {1,4}|\t)?/gm;var LIST_UNORDERED_MARKERS={};LIST_UNORDERED_MARKERS[C_ASTERISK]=true;LIST_UNORDERED_MARKERS[C_PLUS]=true;LIST_UNORDERED_MARKERS[C_DASH]=true;var LIST_ORDERED_MARKERS={};LIST_ORDERED_MARKERS[C_DOT]=true;var LIST_ORDERED_COMMONMARK_MARKERS={};LIST_ORDERED_COMMONMARK_MARKERS[C_DOT]=true;LIST_ORDERED_COMMONMARK_MARKERS[C_PAREN_CLOSE]=true;function list(eat,value,silent){var self=this;var commonmark=self.options.commonmark;var pedantic=self.options.pedantic;var tokenizers=self.blockTokenizers;var interuptors=self.interruptList;var markers;var index=0;var length=value.length;var start=null;var size=0;var queue;var ordered;var character;var marker;var nextIndex;var startIndex;var prefixed;var currentMarker;var content;var line;var prevEmpty;var empty;var items;var allLines;var emptyLines;var item;var enterTop;var exitBlockquote;var isLoose;var node;var now;var end;var indented;while(index<length){character=value.charAt(index);if(character===C_TAB){size+=TAB_SIZE-size%TAB_SIZE}else if(character===C_SPACE){size++}else{break}index++}if(size>=TAB_SIZE){return}character=value.charAt(index);markers=commonmark?LIST_ORDERED_COMMONMARK_MARKERS:LIST_ORDERED_MARKERS;if(LIST_UNORDERED_MARKERS[character]===true){marker=character;ordered=false}else{ordered=true;queue="";while(index<length){character=value.charAt(index);if(!decimal(character)){break}queue+=character;index++}character=value.charAt(index);if(!queue||markers[character]!==true){return}start=parseInt(queue,10);marker=character}character=value.charAt(++index);if(character!==C_SPACE&&character!==C_TAB){return}if(silent){return true}index=0;items=[];allLines=[];emptyLines=[];while(index<length){nextIndex=value.indexOf(C_NEWLINE,index);startIndex=index;prefixed=false;indented=false;if(nextIndex===-1){nextIndex=length}end=index+TAB_SIZE;size=0;while(index<length){character=value.charAt(index);if(character===C_TAB){size+=TAB_SIZE-size%TAB_SIZE}else if(character===C_SPACE){size++}else{break}index++}if(size>=TAB_SIZE){indented=true}if(item&&size>=item.indent){indented=true}character=value.charAt(index);currentMarker=null;if(!indented){if(LIST_UNORDERED_MARKERS[character]===true){currentMarker=character;index++;size++}else{queue="";while(index<length){character=value.charAt(index);if(!decimal(character)){break}queue+=character;index++}character=value.charAt(index);index++;if(queue&&markers[character]===true){currentMarker=character;size+=queue.length+1}}if(currentMarker){character=value.charAt(index);if(character===C_TAB){size+=TAB_SIZE-size%TAB_SIZE;index++}else if(character===C_SPACE){end=index+TAB_SIZE;while(index<end){if(value.charAt(index)!==C_SPACE){break}index++;size++}if(index===end&&value.charAt(index)===C_SPACE){index-=TAB_SIZE-1;size-=TAB_SIZE-1}}else if(character!==C_NEWLINE&&character!==""){currentMarker=null}}}if(currentMarker){if(!pedantic&&marker!==currentMarker){break}prefixed=true}else{if(!commonmark&&!indented&&value.charAt(startIndex)===C_SPACE){indented=true}else if(commonmark&&item){indented=size>=item.indent||size>TAB_SIZE}prefixed=false;index=startIndex}line=value.slice(startIndex,nextIndex);content=startIndex===index?line:value.slice(index,nextIndex);if(currentMarker===C_ASTERISK||currentMarker===C_UNDERSCORE||currentMarker===C_DASH){if(tokenizers.thematicBreak.call(self,eat,line,true)){break}}prevEmpty=empty;empty=!trim(content).length;if(indented&&item){item.value=item.value.concat(emptyLines,line);allLines=allLines.concat(emptyLines,line);emptyLines=[]}else if(prefixed){if(emptyLines.length!==0){item.value.push("");item.trail=emptyLines.concat()}item={value:[line],indent:size,trail:[]};items.push(item);allLines=allLines.concat(emptyLines,line);emptyLines=[]}else if(empty){if(prevEmpty){break}emptyLines.push(line)}else{if(prevEmpty){break}if(interrupt(interuptors,tokenizers,self,[eat,line,true])){break}item.value=item.value.concat(emptyLines,line);allLines=allLines.concat(emptyLines,line);emptyLines=[]}index=nextIndex+1}node=eat(allLines.join(C_NEWLINE)).reset({type:"list",ordered:ordered,start:start,loose:null,children:[]});enterTop=self.enterList();exitBlockquote=self.enterBlock();isLoose=false;index=-1;length=items.length;while(++index<length){item=items[index].value.join(C_NEWLINE);now=eat.now();item=eat(item)(listItem(self,item,now),node);if(item.loose){isLoose=true}item=items[index].trail.join(C_NEWLINE);if(index!==length-1){item+=C_NEWLINE}eat(item)}enterTop();exitBlockquote();node.loose=isLoose;return node}function listItem(ctx,value,position){var offsets=ctx.offset;var fn=ctx.options.pedantic?pedanticListItem:normalListItem;var checked=null;var task;var indent;value=fn.apply(null,arguments);if(ctx.options.gfm){task=value.match(EXPRESSION_TASK_ITEM);if(task){indent=task[0].length;checked=task[1].toLowerCase()===C_X_LOWER;offsets[position.line]+=indent;value=value.slice(indent)}}return{type:"listItem",loose:EXPRESSION_LOOSE_LIST_ITEM.test(value)||value.charAt(value.length-1)===C_NEWLINE,checked:checked,children:ctx.tokenizeBlock(value,position)}}function pedanticListItem(ctx,value,position){var offsets=ctx.offset;var line=position.line;value=value.replace(EXPRESSION_PEDANTIC_BULLET,replacer);line=position.line;return value.replace(EXPRESSION_INITIAL_INDENT,replacer);function replacer($0){offsets[line]=(offsets[line]||0)+$0.length;line++;return""}}function normalListItem(ctx,value,position){var offsets=ctx.offset;var line=position.line;var max;var bullet;var rest;var lines;var trimmedLines;var index;var length;value=value.replace(EXPRESSION_BULLET,replacer);lines=value.split(C_NEWLINE);trimmedLines=removeIndent(value,getIndent(max).indent).split(C_NEWLINE);trimmedLines[0]=rest;offsets[line]=(offsets[line]||0)+bullet.length;line++;index=0;length=lines.length;while(++index<length){offsets[line]=(offsets[line]||0)+lines[index].length-trimmedLines[index].length;line++}return trimmedLines.join(C_NEWLINE);function replacer($0,$1,$2,$3,$4){bullet=$1+$2+$3;rest=$4;if(Number($2)<10&&bullet.length%2===1){$2=C_SPACE+$2}max=$1+repeat(C_SPACE,$2.length)+$3;return max+rest}}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(112);var repeat=__webpack_require__(124);var getIndent=__webpack_require__(139);module.exports=indentation;var C_SPACE=" ";var C_NEWLINE="\n";var C_TAB="\t";function indentation(value,maximum){var values=value.split(C_NEWLINE);var position=values.length+1;var minIndent=Infinity;var matrix=[];var index;var indentation;var stops;var padding;values.unshift(repeat(C_SPACE,maximum)+"!");while(position--){indentation=getIndent(values[position]);matrix[position]=indentation.stops;if(trim(values[position]).length===0){continue}if(indentation.indent){if(indentation.indent>0&&indentation.indent<minIndent){minIndent=indentation.indent}}else{minIndent=Infinity;break}}if(minIndent!==Infinity){position=values.length;while(position--){stops=matrix[position];index=minIndent;while(index&&!(index in stops)){index--}if(trim(values[position]).length!==0&&minIndent&&index!==minIndent){padding=C_TAB}else{padding=""}values[position]=padding+values[position].slice(index in stops?stops[index]+1:0)}}values.shift();return values.join(C_NEWLINE)}},function(module,exports,__webpack_require__){"use strict";module.exports=setextHeading;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_EQUALS="=";var C_DASH="-";var MAX_HEADING_INDENT=3;var SETEXT_MARKERS={};SETEXT_MARKERS[C_EQUALS]=1;SETEXT_MARKERS[C_DASH]=2;function setextHeading(eat,value,silent){var self=this;var now=eat.now();var length=value.length;var index=-1;var subvalue="";var content;var queue;var character;var marker;var depth;while(++index<length){character=value.charAt(index);if(character!==C_SPACE||index>=MAX_HEADING_INDENT){index--;break}subvalue+=character}content="";queue="";while(++index<length){character=value.charAt(index);if(character===C_NEWLINE){index--;break}if(character===C_SPACE||character===C_TAB){queue+=character}else{content+=queue+character;queue=""}}now.column+=subvalue.length;now.offset+=subvalue.length;subvalue+=content+queue;character=value.charAt(++index);marker=value.charAt(++index);if(character!==C_NEWLINE||!SETEXT_MARKERS[marker]){return}subvalue+=character;queue=marker;depth=SETEXT_MARKERS[marker];while(++index<length){character=value.charAt(index);if(character!==marker){if(character!==C_NEWLINE){return}index--;break}queue+=character}if(silent){return true}return eat(subvalue+queue)({type:"heading",depth:depth,children:self.tokenizeInline(content,now)})}},function(module,exports,__webpack_require__){"use strict";var openCloseTag=__webpack_require__(140).openCloseTag;module.exports=blockHTML;var C_TAB="\t";var C_SPACE=" ";var C_NEWLINE="\n";var C_LT="<";function blockHTML(eat,value,silent){var self=this;var blocks=self.options.blocks;var length=value.length;var index=0;var next;var line;var offset;var character;var count;var sequence;var subvalue;var sequences=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,true],[/^<!--/,/-->/,true],[/^<\?/,/\?>/,true],[/^<![A-Za-z]/,/>/,true],[/^<!\[CDATA\[/,/\]\]>/,true],[new RegExp("^</?("+blocks.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,true],[new RegExp(openCloseTag.source+"\\s*$"),/^$/,false]];while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}index++}if(value.charAt(index)!==C_LT){return}next=value.indexOf(C_NEWLINE,index+1);next=next===-1?length:next;line=value.slice(index,next);offset=-1;count=sequences.length;while(++offset<count){if(sequences[offset][0].test(line)){sequence=sequences[offset];break}}if(!sequence){return}if(silent){return sequence[2]}index=next;if(!sequence[1].test(line)){while(index<length){next=value.indexOf(C_NEWLINE,index+1);next=next===-1?length:next;line=value.slice(index+1,next);if(sequence[1].test(line)){if(line){index=next}break}index=next}}subvalue=value.slice(0,index);return eat(subvalue)({type:"html",value:subvalue})}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(108);var normalize=__webpack_require__(127);module.exports=footnoteDefinition;footnoteDefinition.notInList=true;footnoteDefinition.notInBlock=true;var C_BACKSLASH="\\";var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_CARET="^";var C_COLON=":";var EXPRESSION_INITIAL_TAB=/^( {4}|\t)?/gm;function footnoteDefinition(eat,value,silent){var self=this;var offsets=self.offset;var index;var length;var subvalue;var now;var currentLine;var content;var queue;var subqueue;var character;var identifier;var add;var exit;if(!self.options.footnotes){return}index=0;length=value.length;subvalue="";now=eat.now();currentLine=now.line;while(index<length){character=value.charAt(index);if(!whitespace(character)){break}subvalue+=character;index++}if(value.charAt(index)!==C_BRACKET_OPEN||value.charAt(index+1)!==C_CARET){return}subvalue+=C_BRACKET_OPEN+C_CARET;index=subvalue.length;queue="";while(index<length){character=value.charAt(index);if(character===C_BRACKET_CLOSE){break}else if(character===C_BACKSLASH){queue+=character;index++;character=value.charAt(index)}queue+=character;index++}if(!queue||value.charAt(index)!==C_BRACKET_CLOSE||value.charAt(index+1)!==C_COLON){return}if(silent){return true}identifier=normalize(queue);subvalue+=queue+C_BRACKET_CLOSE+C_COLON;index=subvalue.length;while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}subvalue+=character;index++}now.column+=subvalue.length;now.offset+=subvalue.length;queue="";content="";subqueue="";while(index<length){character=value.charAt(index);if(character===C_NEWLINE){subqueue=character;index++;while(index<length){character=value.charAt(index);if(character!==C_NEWLINE){break}subqueue+=character;index++}queue+=subqueue;subqueue="";while(index<length){character=value.charAt(index);if(character!==C_SPACE){break}subqueue+=character;index++}if(subqueue.length===0){break}queue+=subqueue}if(queue){content+=queue;queue=""}content+=character;index++}subvalue+=content;content=content.replace(EXPRESSION_INITIAL_TAB,(function(line){offsets[currentLine]=(offsets[currentLine]||0)+line.length;currentLine++;return""}));add=eat(subvalue);exit=self.enterBlock();content=self.tokenizeBlock(content,now);exit();return add({type:"footnoteDefinition",identifier:identifier,children:content})}},function(module,exports,__webpack_require__){"use strict";module.exports=collapse;function collapse(value){return String(value).replace(/\s+/g," ")}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(108);var normalize=__webpack_require__(127);module.exports=definition;definition.notInList=true;definition.notInBlock=true;var C_DOUBLE_QUOTE='"';var C_SINGLE_QUOTE="'";var C_BACKSLASH="\\";var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_PAREN_OPEN="(";var C_PAREN_CLOSE=")";var C_COLON=":";var C_LT="<";var C_GT=">";function definition(eat,value,silent){var self=this;var commonmark=self.options.commonmark;var index=0;var length=value.length;var subvalue="";var beforeURL;var beforeTitle;var queue;var character;var test;var identifier;var url;var title;while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}subvalue+=character;index++}character=value.charAt(index);if(character!==C_BRACKET_OPEN){return}index++;subvalue+=character;queue="";while(index<length){character=value.charAt(index);if(character===C_BRACKET_CLOSE){break}else if(character===C_BACKSLASH){queue+=character;index++;character=value.charAt(index)}queue+=character;index++}if(!queue||value.charAt(index)!==C_BRACKET_CLOSE||value.charAt(index+1)!==C_COLON){return}identifier=queue;subvalue+=queue+C_BRACKET_CLOSE+C_COLON;index=subvalue.length;queue="";while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE&&character!==C_NEWLINE){break}subvalue+=character;index++}character=value.charAt(index);queue="";beforeURL=subvalue;if(character===C_LT){index++;while(index<length){character=value.charAt(index);if(!isEnclosedURLCharacter(character)){break}queue+=character;index++}character=value.charAt(index);if(character===isEnclosedURLCharacter.delimiter){subvalue+=C_LT+queue+character;index++}else{if(commonmark){return}index-=queue.length+1;queue=""}}if(!queue){while(index<length){character=value.charAt(index);if(!isUnclosedURLCharacter(character)){break}queue+=character;index++}subvalue+=queue}if(!queue){return}url=queue;queue="";while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE&&character!==C_NEWLINE){break}queue+=character;index++}character=value.charAt(index);test=null;if(character===C_DOUBLE_QUOTE){test=C_DOUBLE_QUOTE}else if(character===C_SINGLE_QUOTE){test=C_SINGLE_QUOTE}else if(character===C_PAREN_OPEN){test=C_PAREN_CLOSE}if(!test){queue="";index=subvalue.length}else if(queue){subvalue+=queue+character;index=subvalue.length;queue="";while(index<length){character=value.charAt(index);if(character===test){break}if(character===C_NEWLINE){index++;character=value.charAt(index);if(character===C_NEWLINE||character===test){return}queue+=C_NEWLINE}queue+=character;index++}character=value.charAt(index);if(character!==test){return}beforeTitle=subvalue;subvalue+=queue+character;index++;title=queue;queue=""}else{return}while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}subvalue+=character;index++}character=value.charAt(index);if(!character||character===C_NEWLINE){if(silent){return true}beforeURL=eat(beforeURL).test().end;url=self.decode.raw(self.unescape(url),beforeURL,{nonTerminated:false});if(title){beforeTitle=eat(beforeTitle).test().end;title=self.decode.raw(self.unescape(title),beforeTitle)}return eat(subvalue)({type:"definition",identifier:normalize(identifier),title:title||null,url:url})}}function isEnclosedURLCharacter(character){return character!==C_GT&&character!==C_BRACKET_OPEN&&character!==C_BRACKET_CLOSE}isEnclosedURLCharacter.delimiter=C_GT;function isUnclosedURLCharacter(character){return character!==C_BRACKET_OPEN&&character!==C_BRACKET_CLOSE&&!whitespace(character)}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(108);module.exports=table;var C_BACKSLASH="\\";var C_TICK="`";var C_DASH="-";var C_PIPE="|";var C_COLON=":";var C_SPACE=" ";var C_NEWLINE="\n";var C_TAB="\t";var MIN_TABLE_COLUMNS=1;var MIN_TABLE_ROWS=2;var TABLE_ALIGN_LEFT="left";var TABLE_ALIGN_CENTER="center";var TABLE_ALIGN_RIGHT="right";var TABLE_ALIGN_NONE=null;function table(eat,value,silent){var self=this;var index;var alignments;var alignment;var subvalue;var row;var length;var lines;var queue;var character;var hasDash;var align;var cell;var preamble;var count;var opening;var now;var position;var lineCount;var line;var rows;var table;var lineIndex;var pipeIndex;var first;if(!self.options.gfm){return}index=0;lineCount=0;length=value.length+1;lines=[];while(index<length){lineIndex=value.indexOf(C_NEWLINE,index);pipeIndex=value.indexOf(C_PIPE,index+1);if(lineIndex===-1){lineIndex=value.length}if(pipeIndex===-1||pipeIndex>lineIndex){if(lineCount<MIN_TABLE_ROWS){return}break}lines.push(value.slice(index,lineIndex));lineCount++;index=lineIndex+1}subvalue=lines.join(C_NEWLINE);alignments=lines.splice(1,1)[0]||[];index=0;length=alignments.length;lineCount--;alignment=false;align=[];while(index<length){character=alignments.charAt(index);if(character===C_PIPE){hasDash=null;if(alignment===false){if(first===false){return}}else{align.push(alignment);alignment=false}first=false}else if(character===C_DASH){hasDash=true;alignment=alignment||TABLE_ALIGN_NONE}else if(character===C_COLON){if(alignment===TABLE_ALIGN_LEFT){alignment=TABLE_ALIGN_CENTER}else if(hasDash&&alignment===TABLE_ALIGN_NONE){alignment=TABLE_ALIGN_RIGHT}else{alignment=TABLE_ALIGN_LEFT}}else if(!whitespace(character)){return}index++}if(alignment!==false){align.push(alignment)}if(align.length<MIN_TABLE_COLUMNS){return}if(silent){return true}position=-1;rows=[];table=eat(subvalue).reset({type:"table",align:align,children:rows});while(++position<lineCount){line=lines[position];row={type:"tableRow",children:[]};if(position){eat(C_NEWLINE)}eat(line).reset(row,table);length=line.length+1;index=0;queue="";cell="";preamble=true;count=null;opening=null;while(index<length){character=line.charAt(index);if(character===C_TAB||character===C_SPACE){if(cell){queue+=character}else{eat(character)}index++;continue}if(character===""||character===C_PIPE){if(preamble){eat(character)}else{if(character&&opening){queue+=character;index++;continue}if((cell||character)&&!preamble){subvalue=cell;if(queue.length>1){if(character){subvalue+=queue.slice(0,queue.length-1);queue=queue.charAt(queue.length-1)}else{subvalue+=queue;queue=""}}now=eat.now();eat(subvalue)({type:"tableCell",children:self.tokenizeInline(cell,now)},row)}eat(queue+character);queue="";cell=""}}else{if(queue){cell+=queue;queue=""}cell+=character;if(character===C_BACKSLASH&&index!==length-2){cell+=line.charAt(index+1);index++}if(character===C_TICK){count=1;while(line.charAt(index+1)===character){cell+=character;index++;count++}if(!opening){opening=count}else if(count>=opening){opening=0}}}preamble=false;index++}if(!position){eat(C_NEWLINE+alignments)}}return table}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(112);var decimal=__webpack_require__(114);var trimTrailingLines=__webpack_require__(125);var interrupt=__webpack_require__(126);module.exports=paragraph;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var TAB_SIZE=4;function paragraph(eat,value,silent){var self=this;var settings=self.options;var commonmark=settings.commonmark;var gfm=settings.gfm;var tokenizers=self.blockTokenizers;var interruptors=self.interruptParagraph;var index=value.indexOf(C_NEWLINE);var length=value.length;var position;var subvalue;var character;var size;var now;while(index<length){if(index===-1){index=length;break}if(value.charAt(index+1)===C_NEWLINE){break}if(commonmark){size=0;position=index+1;while(position<length){character=value.charAt(position);if(character===C_TAB){size=TAB_SIZE;break}else if(character===C_SPACE){size++}else{break}position++}if(size>=TAB_SIZE){index=value.indexOf(C_NEWLINE,index+1);continue}}subvalue=value.slice(index+1);if(interrupt(interruptors,tokenizers,self,[eat,subvalue,true])){break}if(tokenizers.list.call(self,eat,subvalue,true)&&(self.inList||commonmark||gfm&&!decimal(trim.left(subvalue).charAt(0)))){break}position=index;index=value.indexOf(C_NEWLINE,index+1);if(index!==-1&&trim(value.slice(position,index))===""){index=position;break}}subvalue=value.slice(0,index);if(trim(subvalue)===""){eat(subvalue);return null}if(silent){return true}now=eat.now();subvalue=trimTrailingLines(subvalue);return eat(subvalue)({type:"paragraph",children:self.tokenizeInline(subvalue,now)})}},function(module,exports,__webpack_require__){"use strict";var locate=__webpack_require__(226);module.exports=escape;escape.locator=locate;function escape(eat,value,silent){var self=this;var character;var node;if(value.charAt(0)==="\\"){character=value.charAt(1);if(self.escape.indexOf(character)!==-1){if(silent){return true}if(character==="\n"){node={type:"break"}}else{node={type:"text",value:character}}return eat("\\"+character)(node)}}}},function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("\\",fromIndex)}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(108);var decode=__webpack_require__(123);var locate=__webpack_require__(141);module.exports=autoLink;autoLink.locator=locate;autoLink.notInLink=true;var C_LT="<";var C_GT=">";var C_AT_SIGN="@";var C_SLASH="/";var MAILTO="mailto:";var MAILTO_LENGTH=MAILTO.length;function autoLink(eat,value,silent){var self;var subvalue;var length;var index;var queue;var character;var hasAtCharacter;var link;var now;var content;var tokenizers;var exit;if(value.charAt(0)!==C_LT){return}self=this;subvalue="";length=value.length;index=0;queue="";hasAtCharacter=false;link="";index++;subvalue=C_LT;while(index<length){character=value.charAt(index);if(whitespace(character)||character===C_GT||character===C_AT_SIGN||character===":"&&value.charAt(index+1)===C_SLASH){break}queue+=character;index++}if(!queue){return}link+=queue;queue="";character=value.charAt(index);link+=character;index++;if(character===C_AT_SIGN){hasAtCharacter=true}else{if(character!==":"||value.charAt(index+1)!==C_SLASH){return}link+=C_SLASH;index++}while(index<length){character=value.charAt(index);if(whitespace(character)||character===C_GT){break}queue+=character;index++}character=value.charAt(index);if(!queue||character!==C_GT){return}if(silent){return true}link+=queue;content=link;subvalue+=link+character;now=eat.now();now.column++;now.offset++;if(hasAtCharacter){if(link.slice(0,MAILTO_LENGTH).toLowerCase()===MAILTO){content=content.substr(MAILTO_LENGTH);now.column+=MAILTO_LENGTH;now.offset+=MAILTO_LENGTH}else{link=MAILTO+link}}tokenizers=self.inlineTokenizers;self.inlineTokenizers={text:tokenizers.text};exit=self.enterLink();content=self.tokenizeInline(content,now);self.inlineTokenizers=tokenizers;exit();return eat(subvalue)({type:"link",title:null,url:decode(link,{nonTerminated:false}),children:content})}},function(module,exports,__webpack_require__){"use strict";var decode=__webpack_require__(123);var whitespace=__webpack_require__(108);var locate=__webpack_require__(229);module.exports=url;url.locator=locate;url.notInLink=true;var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_PAREN_OPEN="(";var C_PAREN_CLOSE=")";var C_LT="<";var C_AT_SIGN="@";var HTTP_PROTOCOL="http://";var HTTPS_PROTOCOL="https://";var MAILTO_PROTOCOL="mailto:";var PROTOCOLS=[HTTP_PROTOCOL,HTTPS_PROTOCOL,MAILTO_PROTOCOL];var PROTOCOLS_LENGTH=PROTOCOLS.length;function url(eat,value,silent){var self=this;var subvalue;var content;var character;var index;var position;var protocol;var match;var length;var queue;var parenCount;var nextCharacter;var exit;if(!self.options.gfm){return}subvalue="";index=-1;length=PROTOCOLS_LENGTH;while(++index<length){protocol=PROTOCOLS[index];match=value.slice(0,protocol.length);if(match.toLowerCase()===protocol){subvalue=match;break}}if(!subvalue){return}index=subvalue.length;length=value.length;queue="";parenCount=0;while(index<length){character=value.charAt(index);if(whitespace(character)||character===C_LT){break}if(character==="."||character===","||character===":"||character===";"||character==='"'||character==="'"||character===")"||character==="]"){nextCharacter=value.charAt(index+1);if(!nextCharacter||whitespace(nextCharacter)){break}}if(character===C_PAREN_OPEN||character===C_BRACKET_OPEN){parenCount++}if(character===C_PAREN_CLOSE||character===C_BRACKET_CLOSE){parenCount--;if(parenCount<0){break}}queue+=character;index++}if(!queue){return}subvalue+=queue;content=subvalue;if(protocol===MAILTO_PROTOCOL){position=queue.indexOf(C_AT_SIGN);if(position===-1||position===length-1){return}content=content.substr(MAILTO_PROTOCOL.length)}if(silent){return true}exit=self.enterLink();content=self.tokenizeInline(content,eat.now());exit();return eat(subvalue)({type:"link",title:null,url:decode(subvalue,{nonTerminated:false}),children:content})}},function(module,exports,__webpack_require__){"use strict";module.exports=locate;var PROTOCOLS=["https://","http://","mailto:"];function locate(value,fromIndex){var length=PROTOCOLS.length;var index=-1;var min=-1;var position;if(!this.options.gfm){return-1}while(++index<length){position=value.indexOf(PROTOCOLS[index],fromIndex);if(position!==-1&&(position<min||min===-1)){min=position}}return min}},function(module,exports,__webpack_require__){"use strict";var alphabetical=__webpack_require__(137);var locate=__webpack_require__(141);var tag=__webpack_require__(140).tag;module.exports=inlineHTML;inlineHTML.locator=locate;var EXPRESSION_HTML_LINK_OPEN=/^<a /i;var EXPRESSION_HTML_LINK_CLOSE=/^<\/a>/i;function inlineHTML(eat,value,silent){var self=this;var length=value.length;var character;var subvalue;if(value.charAt(0)!=="<"||length<3){return}character=value.charAt(1);if(!alphabetical(character)&&character!=="?"&&character!=="!"&&character!=="/"){return}subvalue=value.match(tag);if(!subvalue){return}if(silent){return true}subvalue=subvalue[0];if(!self.inLink&&EXPRESSION_HTML_LINK_OPEN.test(subvalue)){self.inLink=true}else if(self.inLink&&EXPRESSION_HTML_LINK_CLOSE.test(subvalue)){self.inLink=false}return eat(subvalue)({type:"html",value:subvalue})}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(108);var locate=__webpack_require__(142);module.exports=link;link.locator=locate;var own={}.hasOwnProperty;var C_BACKSLASH="\\";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_PAREN_OPEN="(";var C_PAREN_CLOSE=")";var C_LT="<";var C_GT=">";var C_TICK="`";var C_DOUBLE_QUOTE='"';var C_SINGLE_QUOTE="'";var LINK_MARKERS={};LINK_MARKERS[C_DOUBLE_QUOTE]=C_DOUBLE_QUOTE;LINK_MARKERS[C_SINGLE_QUOTE]=C_SINGLE_QUOTE;var COMMONMARK_LINK_MARKERS={};COMMONMARK_LINK_MARKERS[C_DOUBLE_QUOTE]=C_DOUBLE_QUOTE;COMMONMARK_LINK_MARKERS[C_SINGLE_QUOTE]=C_SINGLE_QUOTE;COMMONMARK_LINK_MARKERS[C_PAREN_OPEN]=C_PAREN_CLOSE;function link(eat,value,silent){var self=this;var subvalue="";var index=0;var character=value.charAt(0);var pedantic=self.options.pedantic;var commonmark=self.options.commonmark;var gfm=self.options.gfm;var closed;var count;var opening;var beforeURL;var beforeTitle;var subqueue;var hasMarker;var markers;var isImage;var content;var marker;var length;var title;var depth;var queue;var url;var now;var exit;var node;if(character==="!"){isImage=true;subvalue=character;character=value.charAt(++index)}if(character!==C_BRACKET_OPEN){return}if(!isImage&&self.inLink){return}subvalue+=character;queue="";index++;length=value.length;now=eat.now();depth=0;now.column+=index;now.offset+=index;while(index<length){character=value.charAt(index);subqueue=character;if(character===C_TICK){count=1;while(value.charAt(index+1)===C_TICK){subqueue+=character;index++;count++}if(!opening){opening=count}else if(count>=opening){opening=0}}else if(character===C_BACKSLASH){index++;subqueue+=value.charAt(index)}else if((!opening||gfm)&&character===C_BRACKET_OPEN){depth++}else if((!opening||gfm)&&character===C_BRACKET_CLOSE){if(depth){depth--}else{if(!pedantic){while(index<length){character=value.charAt(index+1);if(!whitespace(character)){break}subqueue+=character;index++}}if(value.charAt(index+1)!==C_PAREN_OPEN){return}subqueue+=C_PAREN_OPEN;closed=true;index++;break}}queue+=subqueue;subqueue="";index++}if(!closed){return}content=queue;subvalue+=queue+subqueue;index++;while(index<length){character=value.charAt(index);if(!whitespace(character)){break}subvalue+=character;index++}character=value.charAt(index);markers=commonmark?COMMONMARK_LINK_MARKERS:LINK_MARKERS;queue="";beforeURL=subvalue;if(character===C_LT){index++;beforeURL+=C_LT;while(index<length){character=value.charAt(index);if(character===C_GT){break}if(commonmark&&character==="\n"){return}queue+=character;index++}if(value.charAt(index)!==C_GT){return}subvalue+=C_LT+queue+C_GT;url=queue;index++}else{character=null;subqueue="";while(index<length){character=value.charAt(index);if(subqueue&&own.call(markers,character)){break}if(whitespace(character)){if(!pedantic){break}subqueue+=character}else{if(character===C_PAREN_OPEN){depth++}else if(character===C_PAREN_CLOSE){if(depth===0){break}depth--}queue+=subqueue;subqueue="";if(character===C_BACKSLASH){queue+=C_BACKSLASH;character=value.charAt(++index)}queue+=character}index++}subvalue+=queue;url=queue;index=subvalue.length}queue="";while(index<length){character=value.charAt(index);if(!whitespace(character)){break}queue+=character;index++}character=value.charAt(index);subvalue+=queue;if(queue&&own.call(markers,character)){index++;subvalue+=character;queue="";marker=markers[character];beforeTitle=subvalue;if(commonmark){while(index<length){character=value.charAt(index);if(character===marker){break}if(character===C_BACKSLASH){queue+=C_BACKSLASH;character=value.charAt(++index)}index++;queue+=character}character=value.charAt(index);if(character!==marker){return}title=queue;subvalue+=queue+character;index++;while(index<length){character=value.charAt(index);if(!whitespace(character)){break}subvalue+=character;index++}}else{subqueue="";while(index<length){character=value.charAt(index);if(character===marker){if(hasMarker){queue+=marker+subqueue;subqueue=""}hasMarker=true}else if(!hasMarker){queue+=character}else if(character===C_PAREN_CLOSE){subvalue+=queue+marker+subqueue;title=queue;break}else if(whitespace(character)){subqueue+=character}else{queue+=marker+subqueue+character;subqueue="";hasMarker=false}index++}}}if(value.charAt(index)!==C_PAREN_CLOSE){return}if(silent){return true}subvalue+=C_PAREN_CLOSE;url=self.decode.raw(self.unescape(url),eat(beforeURL).test().end,{nonTerminated:false});if(title){beforeTitle=eat(beforeTitle).test().end;title=self.decode.raw(self.unescape(title),beforeTitle)}node={type:isImage?"image":"link",title:title||null,url:url};if(isImage){node.alt=self.decode.raw(self.unescape(content),now)||null}else{exit=self.enterLink();node.children=self.tokenizeInline(content,now);exit()}return eat(subvalue)(node)}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(108);var locate=__webpack_require__(142);var normalize=__webpack_require__(127);module.exports=reference;reference.locator=locate;var T_LINK="link";var T_IMAGE="image";var T_FOOTNOTE="footnote";var REFERENCE_TYPE_SHORTCUT="shortcut";var REFERENCE_TYPE_COLLAPSED="collapsed";var REFERENCE_TYPE_FULL="full";var C_CARET="^";var C_BACKSLASH="\\";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";function reference(eat,value,silent){var self=this;var character=value.charAt(0);var index=0;var length=value.length;var subvalue="";var intro="";var type=T_LINK;var referenceType=REFERENCE_TYPE_SHORTCUT;var content;var identifier;var now;var node;var exit;var queue;var bracketed;var depth;if(character==="!"){type=T_IMAGE;intro=character;character=value.charAt(++index)}if(character!==C_BRACKET_OPEN){return}index++;intro+=character;queue="";if(self.options.footnotes&&value.charAt(index)===C_CARET){if(type===T_IMAGE){return}intro+=C_CARET;index++;type=T_FOOTNOTE}depth=0;while(index<length){character=value.charAt(index);if(character===C_BRACKET_OPEN){bracketed=true;depth++}else if(character===C_BRACKET_CLOSE){if(!depth){break}depth--}if(character===C_BACKSLASH){queue+=C_BACKSLASH;character=value.charAt(++index)}queue+=character;index++}subvalue=queue;content=queue;character=value.charAt(index);if(character!==C_BRACKET_CLOSE){return}index++;subvalue+=character;queue="";while(index<length){character=value.charAt(index);if(!whitespace(character)){break}queue+=character;index++}character=value.charAt(index);if(type!==T_FOOTNOTE&&character===C_BRACKET_OPEN){identifier="";queue+=character;index++;while(index<length){character=value.charAt(index);if(character===C_BRACKET_OPEN||character===C_BRACKET_CLOSE){break}if(character===C_BACKSLASH){identifier+=C_BACKSLASH;character=value.charAt(++index)}identifier+=character;index++}character=value.charAt(index);if(character===C_BRACKET_CLOSE){referenceType=identifier?REFERENCE_TYPE_FULL:REFERENCE_TYPE_COLLAPSED;queue+=identifier+character;index++}else{identifier=""}subvalue+=queue;queue=""}else{if(!content){return}identifier=content}if(referenceType!==REFERENCE_TYPE_FULL&&bracketed){return}subvalue=intro+subvalue;if(type===T_LINK&&self.inLink){return null}if(silent){return true}if(type===T_FOOTNOTE&&content.indexOf(" ")!==-1){return eat(subvalue)({type:"footnote",children:this.tokenizeInline(content,eat.now())})}now=eat.now();now.column+=intro.length;now.offset+=intro.length;identifier=referenceType===REFERENCE_TYPE_FULL?identifier:content;node={type:type+"Reference",identifier:normalize(identifier)};if(type===T_LINK||type===T_IMAGE){node.referenceType=referenceType}if(type===T_LINK){exit=self.enterLink();node.children=self.tokenizeInline(content,now);exit()}else if(type===T_IMAGE){node.alt=self.decode.raw(self.unescape(content),now)||null}return eat(subvalue)(node)}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(112);var whitespace=__webpack_require__(108);var locate=__webpack_require__(234);module.exports=strong;strong.locator=locate;var C_ASTERISK="*";var C_UNDERSCORE="_";function strong(eat,value,silent){var self=this;var index=0;var character=value.charAt(index);var now;var pedantic;var marker;var queue;var subvalue;var length;var prev;if(character!==C_ASTERISK&&character!==C_UNDERSCORE||value.charAt(++index)!==character){return}pedantic=self.options.pedantic;marker=character;subvalue=marker+marker;length=value.length;index++;queue="";character="";if(pedantic&&whitespace(value.charAt(index))){return}while(index<length){prev=character;character=value.charAt(index);if(character===marker&&value.charAt(index+1)===marker&&(!pedantic||!whitespace(prev))){character=value.charAt(index+2);if(character!==marker){if(!trim(queue)){return}if(silent){return true}now=eat.now();now.column+=2;now.offset+=2;return eat(subvalue+queue+subvalue)({type:"strong",children:self.tokenizeInline(queue,now)})}}if(!pedantic&&character==="\\"){queue+=character;character=value.charAt(++index)}queue+=character;index++}}},function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var asterisk=value.indexOf("**",fromIndex);var underscore=value.indexOf("__",fromIndex);if(underscore===-1){return asterisk}if(asterisk===-1){return underscore}return underscore<asterisk?underscore:asterisk}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(112);var word=__webpack_require__(236);var whitespace=__webpack_require__(108);var locate=__webpack_require__(237);module.exports=emphasis;emphasis.locator=locate;var C_ASTERISK="*";var C_UNDERSCORE="_";function emphasis(eat,value,silent){var self=this;var index=0;var character=value.charAt(index);var now;var pedantic;var marker;var queue;var subvalue;var length;var prev;if(character!==C_ASTERISK&&character!==C_UNDERSCORE){return}pedantic=self.options.pedantic;subvalue=character;marker=character;length=value.length;index++;queue="";character="";if(pedantic&&whitespace(value.charAt(index))){return}while(index<length){prev=character;character=value.charAt(index);if(character===marker&&(!pedantic||!whitespace(prev))){character=value.charAt(++index);if(character!==marker){if(!trim(queue)||prev===marker){return}if(!pedantic&&marker===C_UNDERSCORE&&word(character)){queue+=marker;continue}if(silent){return true}now=eat.now();now.column++;now.offset++;return eat(subvalue+queue+marker)({type:"emphasis",children:self.tokenizeInline(queue,now)})}queue+=marker}if(!pedantic&&character==="\\"){queue+=character;character=value.charAt(++index)}queue+=character;index++}}},function(module,exports,__webpack_require__){"use strict";module.exports=wordCharacter;var fromCode=String.fromCharCode;var re=/\w/;function wordCharacter(character){return re.test(typeof character==="number"?fromCode(character):character.charAt(0))}},function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var asterisk=value.indexOf("*",fromIndex);var underscore=value.indexOf("_",fromIndex);if(underscore===-1){return asterisk}if(asterisk===-1){return underscore}return underscore<asterisk?underscore:asterisk}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(108);var locate=__webpack_require__(239);module.exports=strikethrough;strikethrough.locator=locate;var C_TILDE="~";var DOUBLE="~~";function strikethrough(eat,value,silent){var self=this;var character="";var previous="";var preceding="";var subvalue="";var index;var length;var now;if(!self.options.gfm||value.charAt(0)!==C_TILDE||value.charAt(1)!==C_TILDE||whitespace(value.charAt(2))){return}index=1;length=value.length;now=eat.now();now.column+=2;now.offset+=2;while(++index<length){character=value.charAt(index);if(character===C_TILDE&&previous===C_TILDE&&(!preceding||!whitespace(preceding))){if(silent){return true}return eat(DOUBLE+subvalue+DOUBLE)({type:"delete",children:self.tokenizeInline(subvalue,now)})}subvalue+=previous;preceding=previous;previous=character}}},function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("~~",fromIndex)}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(108);var locate=__webpack_require__(241);module.exports=inlineCode;inlineCode.locator=locate;var C_TICK="`";function inlineCode(eat,value,silent){var length=value.length;var index=0;var queue="";var tickQueue="";var contentQueue;var subqueue;var count;var openingCount;var subvalue;var character;var found;var next;while(index<length){if(value.charAt(index)!==C_TICK){break}queue+=C_TICK;index++}if(!queue){return}subvalue=queue;openingCount=index;queue="";next=value.charAt(index);count=0;while(index<length){character=next;next=value.charAt(index+1);if(character===C_TICK){count++;tickQueue+=character}else{count=0;queue+=character}if(count&&next!==C_TICK){if(count===openingCount){subvalue+=queue+tickQueue;found=true;break}queue+=tickQueue;tickQueue=""}index++}if(!found){if(openingCount%2!==0){return}queue=""}if(silent){return true}contentQueue="";subqueue="";length=queue.length;index=-1;while(++index<length){character=queue.charAt(index);if(whitespace(character)){subqueue+=character;continue}if(subqueue){if(contentQueue){contentQueue+=subqueue}subqueue=""}contentQueue+=character}return eat(subvalue)({type:"inlineCode",value:contentQueue})}},function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("`",fromIndex)}},function(module,exports,__webpack_require__){"use strict";var locate=__webpack_require__(243);module.exports=hardBreak;hardBreak.locator=locate;var MIN_BREAK_LENGTH=2;function hardBreak(eat,value,silent){var length=value.length;var index=-1;var queue="";var character;while(++index<length){character=value.charAt(index);if(character==="\n"){if(index<MIN_BREAK_LENGTH){return}if(silent){return true}queue+=character;return eat(queue)({type:"break"})}if(character!==" "){return}queue+=character}}},function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var index=value.indexOf("\n",fromIndex);while(index>fromIndex){if(value.charAt(index-1)!==" "){break}index--}return index}},function(module,exports,__webpack_require__){"use strict";module.exports=text;function text(eat,value,silent){var self=this;var methods;var tokenizers;var index;var length;var subvalue;var position;var tokenizer;var name;var min;var now;if(silent){return true}methods=self.inlineMethods;length=methods.length;tokenizers=self.inlineTokenizers;index=-1;min=value.length;while(++index<length){name=methods[index];if(name==="text"||!tokenizers[name]){continue}tokenizer=tokenizers[name].locator;if(!tokenizer){eat.file.fail("Missing locator: `"+name+"`")}position=tokenizer.call(self,value,1);if(position!==-1&&position<min){min=position}}subvalue=value.slice(0,min);now=eat.now();self.decode(subvalue,now,(function(content,position,source){eat(source||content)({type:"text",value:content})}))}},function(module,exports,__webpack_require__){if(false){var throwOnDirectAccess,ReactIs}else{module.exports=__webpack_require__(246)()}},function(module,exports,__webpack_require__){"use strict";var ReactPropTypesSecret=__webpack_require__(247);function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;module.exports=function(){function shim(props,propName,componentName,location,propFullName,secret){if(secret===ReactPropTypesSecret){return}var err=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. "+"Use PropTypes.checkPropTypes() to call them. "+"Read more at http://fb.me/use-check-prop-types");err.name="Invariant Violation";throw err}shim.isRequired=shim;function getShim(){return shim}var ReactPropTypes={array:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,elementType:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};ReactPropTypes.PropTypes=ReactPropTypes;return ReactPropTypes}},function(module,exports,__webpack_require__){"use strict";var ReactPropTypesSecret="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";module.exports=ReactPropTypesSecret},function(module,exports,__webpack_require__){var visitWithParents=__webpack_require__(249);function addListMetadata(){return function(ast){visitWithParents(ast,"list",(function(listNode,parents){var depth=0,i,n;for(i=0,n=parents.length;i<n;i++){if(parents[i].type==="list")depth+=1}for(i=0,n=listNode.children.length;i<n;i++){var child=listNode.children[i];child.index=i;child.ordered=listNode.ordered}listNode.depth=depth}));return ast}}module.exports=addListMetadata},function(module,exports,__webpack_require__){"use strict";module.exports=visitParents;function visitParents(tree,type,visitor){var stack=[];if(typeof type==="function"){visitor=type;type=null}one(tree);function one(node){var result;if(!type||node.type===type){result=visitor(node,stack.concat())}if(node.children&&result!==false){return all(node.children,node)}return result}function all(children,parent){var length=children.length;var index=-1;var child;stack.push(parent);while(++index<length){child=children[index];if(child&&one(child)===false){return false}}stack.pop();return true}}},function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(115);var type="virtualHtml";var selfClosingRe=/^<(area|base|br|col|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)\s*\/?>$/i;var simpleTagRe=/^<(\/?)([a-z]+)\s*>$/;module.exports=function(tree){var open;var currentParent;visit(tree,"html",(function(node,index,parent){if(currentParent!==parent){open=[];currentParent=parent}var selfClosing=getSelfClosing(node);if(selfClosing){parent.children.splice(index,1,{type:type,tag:selfClosing,position:node.position});return true}var current=getSimpleTag(node,parent);if(!current){return true}var matching=findAndPull(open,current.tag);if(matching){parent.children.splice(index,0,virtual(current,matching,parent))}else if(!current.opening){open.push(current)}return true}),true);return tree};function findAndPull(open,matchingTag){var i=open.length;while(i--){if(open[i].tag===matchingTag){return open.splice(i,1)[0]}}return false}function getSimpleTag(node,parent){var match=node.value.match(simpleTagRe);return match?{tag:match[2],opening:!match[1],node:node}:false}function getSelfClosing(node){var match=node.value.match(selfClosingRe);return match?match[1]:false}function virtual(fromNode,toNode,parent){var fromIndex=parent.children.indexOf(fromNode.node);var toIndex=parent.children.indexOf(toNode.node);var extracted=parent.children.splice(fromIndex,toIndex-fromIndex+1);var children=extracted.slice(1,-1);return{type:type,children:children,tag:fromNode.tag,position:{start:fromNode.node.position.start,end:toNode.node.position.end,indent:[]}}}},function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(115);exports.ofType=function(types,mode){return function(node){types.forEach((function(type){return visit(node,type,disallow,true)}));return node};function disallow(node,index,parent){if(parent){untangle(node,index,parent,mode)}}};exports.ifNotMatch=function(allowNode,mode){return function(node){visit(node,disallow,true);return node};function disallow(node,index,parent){if(parent&&!allowNode(node,index,parent)){untangle(node,index,parent,mode)}}};function untangle(node,index,parent,mode){if(mode==="remove"){parent.children.splice(index,1)}else if(mode==="unwrap"){var args=[index,1];if(node.children){args=args.concat(node.children)}Array.prototype.splice.apply(parent.children,args)}}},function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(2);var xtend=__webpack_require__(110);var ReactIs=__webpack_require__(253);var defaultNodePosition={start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}};function astToReact(node,options){var parent=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var index=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var renderer=options.renderers[node.type];if(node.position===undefined){node.position=parent.node&&parent.node.position||defaultNodePosition}var pos=node.position.start;var key=[node.type,pos.line,pos.column,index].join("-");if(!ReactIs.isValidElementType(renderer)){throw new Error("Renderer for type `".concat(node.type,"` not defined or is not renderable"))}var nodeProps=getNodeProps(node,key,options,renderer,parent,index);return React.createElement(renderer,nodeProps,nodeProps.children||resolveChildren()||undefined);function resolveChildren(){return node.children&&node.children.map((function(childNode,i){return astToReact(childNode,options,{node:node,props:nodeProps},i)}))}}function getNodeProps(node,key,opts,renderer,parent,index){var props={key:key};var isTagRenderer=typeof renderer==="string";if(opts.sourcePos&&node.position){props["data-sourcepos"]=flattenPosition(node.position)}if(opts.rawSourcePos&&!isTagRenderer){props.sourcePosition=node.position}if(opts.includeNodeIndex&&parent.node&&parent.node.children&&!isTagRenderer){props.index=parent.node.children.indexOf(node);props.parentChildCount=parent.node.children.length}var ref=node.identifier!==null&&node.identifier!==undefined?opts.definitions[node.identifier]||{}:null;switch(node.type){case"root":assignDefined(props,{className:opts.className});break;case"text":props.nodeKey=key;props.children=node.value;break;case"heading":props.level=node.depth;break;case"list":props.start=node.start;props.ordered=node.ordered;props.tight=!node.loose;props.depth=node.depth;break;case"listItem":props.checked=node.checked;props.tight=!node.loose;props.ordered=node.ordered;props.index=node.index;props.children=getListItemChildren(node,parent).map((function(childNode,i){return astToReact(childNode,opts,{node:node,props:props},i)}));break;case"definition":assignDefined(props,{identifier:node.identifier,title:node.title,url:node.url});break;case"code":assignDefined(props,{language:node.lang&&node.lang.split(/\s/,1)[0]});break;case"inlineCode":props.children=node.value;props.inline=true;break;case"link":assignDefined(props,{title:node.title||undefined,target:typeof opts.linkTarget==="function"?opts.linkTarget(node.url,node.children,node.title):opts.linkTarget,href:opts.transformLinkUri?opts.transformLinkUri(node.url,node.children,node.title):node.url});break;case"image":assignDefined(props,{alt:node.alt||undefined,title:node.title||undefined,src:opts.transformImageUri?opts.transformImageUri(node.url,node.children,node.title,node.alt):node.url});break;case"linkReference":assignDefined(props,xtend(ref,{href:opts.transformLinkUri?opts.transformLinkUri(ref.href):ref.href}));break;case"imageReference":assignDefined(props,{src:opts.transformImageUri&&ref.href?opts.transformImageUri(ref.href,node.children,ref.title,node.alt):ref.href,title:ref.title||undefined,alt:node.alt||undefined});break;case"table":case"tableHead":case"tableBody":props.columnAlignment=node.align;break;case"tableRow":props.isHeader=parent.node.type==="tableHead";props.columnAlignment=parent.props.columnAlignment;break;case"tableCell":assignDefined(props,{isHeader:parent.props.isHeader,align:parent.props.columnAlignment[index]});break;case"virtualHtml":props.tag=node.tag;break;case"html":props.isBlock=node.position.start.line!==node.position.end.line;props.escapeHtml=opts.escapeHtml;props.skipHtml=opts.skipHtml;break;case"parsedHtml":{var parsedChildren;if(node.children){parsedChildren=node.children.map((function(child,i){return astToReact(child,opts,{node:node,props:props},i)}))}props.escapeHtml=opts.escapeHtml;props.skipHtml=opts.skipHtml;props.element=mergeNodeChildren(node,parsedChildren);break}default:assignDefined(props,xtend(node,{type:undefined,position:undefined,children:undefined}))}if(!isTagRenderer&&node.value){props.value=node.value}return props}function assignDefined(target,attrs){for(var key in attrs){if(typeof attrs[key]!=="undefined"){target[key]=attrs[key]}}}function mergeNodeChildren(node,parsedChildren){var el=node.element;if(Array.isArray(el)){var Fragment=React.Fragment||"div";return React.createElement(Fragment,null,el)}if(el.props.children||parsedChildren){var children=React.Children.toArray(el.props.children).concat(parsedChildren);return React.cloneElement(el,null,children)}return React.cloneElement(el,null)}function flattenPosition(pos){return[pos.start.line,":",pos.start.column,"-",pos.end.line,":",pos.end.column].map(String).join("")}function getListItemChildren(node,parent){if(node.loose){return node.children}if(parent.node&&node.index>0&&parent.node.children[node.index-1].loose){return node.children}return unwrapParagraphs(node)}function unwrapParagraphs(node){return node.children.reduce((function(array,child){return array.concat(child.type==="paragraph"?child.children||[]:[child])}),[])}module.exports=astToReact},function(module,exports,__webpack_require__){"use strict";if(true){module.exports=__webpack_require__(254)}else{}},function(module,exports,__webpack_require__){"use strict";
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b="function"===typeof Symbol&&Symbol.for,c=b?Symbol.for("react.element"):60103,d=b?Symbol.for("react.portal"):60106,e=b?Symbol.for("react.fragment"):60107,f=b?Symbol.for("react.strict_mode"):60108,g=b?Symbol.for("react.profiler"):60114,h=b?Symbol.for("react.provider"):60109,k=b?Symbol.for("react.context"):60110,l=b?Symbol.for("react.async_mode"):60111,m=b?Symbol.for("react.concurrent_mode"):60111,n=b?Symbol.for("react.forward_ref"):60112,p=b?Symbol.for("react.suspense"):60113,q=b?Symbol.for("react.suspense_list"):60120,r=b?Symbol.for("react.memo"):60115,t=b?Symbol.for("react.lazy"):60116,v=b?Symbol.for("react.block"):60121,w=b?Symbol.for("react.fundamental"):60117,x=b?Symbol.for("react.responder"):60118,y=b?Symbol.for("react.scope"):60119;function z(a){if("object"===typeof a&&null!==a){var u=a.$$typeof;switch(u){case c:switch(a=a.type,a){case l:case m:case e:case g:case f:case p:return a;default:switch(a=a&&a.$$typeof,a){case k:case n:case t:case r:case h:return a;default:return u}}case d:return u}}}function A(a){return z(a)===m}exports.AsyncMode=l;exports.ConcurrentMode=m;exports.ContextConsumer=k;exports.ContextProvider=h;exports.Element=c;exports.ForwardRef=n;exports.Fragment=e;exports.Lazy=t;exports.Memo=r;exports.Portal=d;exports.Profiler=g;exports.StrictMode=f;exports.Suspense=p;exports.isAsyncMode=function(a){return A(a)||z(a)===l};exports.isConcurrentMode=A;exports.isContextConsumer=function(a){return z(a)===k};exports.isContextProvider=function(a){return z(a)===h};exports.isElement=function(a){return"object"===typeof a&&null!==a&&a.$$typeof===c};exports.isForwardRef=function(a){return z(a)===n};exports.isFragment=function(a){return z(a)===e};exports.isLazy=function(a){return z(a)===t};exports.isMemo=function(a){return z(a)===r};exports.isPortal=function(a){return z(a)===d};exports.isProfiler=function(a){return z(a)===g};exports.isStrictMode=function(a){return z(a)===f};exports.isSuspense=function(a){return z(a)===p};exports.isValidElementType=function(a){return"string"===typeof a||"function"===typeof a||a===e||a===m||a===g||a===f||a===p||a===q||"object"===typeof a&&null!==a&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w||a.$$typeof===x||a.$$typeof===y||a.$$typeof===v)};exports.typeOf=z},function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(115);module.exports=function(node){visit(node,"table",wrap);return node};function wrap(table){var children=table.children;table.children=[{type:"tableHead",align:table.align,children:[children[0]],position:children[0].position}];if(children.length>1){table.children.push({type:"tableBody",align:table.align,children:children.slice(1),position:{start:children[1].position.start,end:children[children.length-1].position.end}})}}},function(module,exports,__webpack_require__){"use strict";module.exports=function getDefinitions(node){var defs=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return(node.children||[]).reduce((function(definitions,child){if(child.type==="definition"){definitions[child.identifier]={href:child.url,title:child.title}}return getDefinitions(child,definitions)}),defs)}},function(module,exports,__webpack_require__){"use strict";var protocols=["http","https","mailto","tel"];module.exports=function uriTransformer(uri){var url=(uri||"").trim();var first=url.charAt(0);if(first==="#"||first==="/"){return url}var colon=url.indexOf(":");if(colon===-1){return url}var length=protocols.length;var index=-1;while(++index<length){var protocol=protocols[index];if(colon===protocol.length&&url.slice(0,protocol.length).toLowerCase()===protocol){return url}}index=url.indexOf("?");if(index!==-1&&colon>index){return url}index=url.indexOf("#");if(index!==-1&&colon>index){return url}return"javascript:void(0)"}},function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(110);var React=__webpack_require__(2);var supportsStringRender=parseInt((React.version||"16").slice(0,2),10)>=16;var createElement=React.createElement;module.exports={break:"br",paragraph:"p",emphasis:"em",strong:"strong",thematicBreak:"hr",blockquote:"blockquote",delete:"del",link:"a",image:"img",linkReference:"a",imageReference:"img",table:SimpleRenderer.bind(null,"table"),tableHead:SimpleRenderer.bind(null,"thead"),tableBody:SimpleRenderer.bind(null,"tbody"),tableRow:SimpleRenderer.bind(null,"tr"),tableCell:TableCell,root:Root,text:TextRenderer,list:List,listItem:ListItem,definition:NullRenderer,heading:Heading,inlineCode:InlineCode,code:CodeBlock,html:Html,virtualHtml:VirtualHtml,parsedHtml:ParsedHtml};function TextRenderer(props){return supportsStringRender?props.children:createElement("span",null,props.children)}function Root(props){var useFragment=!props.className;var root=useFragment?React.Fragment||"div":"div";return createElement(root,useFragment?null:props,props.children)}function SimpleRenderer(tag,props){return createElement(tag,getCoreProps(props),props.children)}function TableCell(props){var style=props.align?{textAlign:props.align}:undefined;var coreProps=getCoreProps(props);return createElement(props.isHeader?"th":"td",style?xtend({style:style},coreProps):coreProps,props.children)}function Heading(props){return createElement("h".concat(props.level),getCoreProps(props),props.children)}function List(props){var attrs=getCoreProps(props);if(props.start!==null&&props.start!==1&&props.start!==undefined){attrs.start=props.start.toString()}return createElement(props.ordered?"ol":"ul",attrs,props.children)}function ListItem(props){var checkbox=null;if(props.checked!==null&&props.checked!==undefined){var checked=props.checked;checkbox=createElement("input",{type:"checkbox",checked:checked,readOnly:true})}return createElement("li",getCoreProps(props),checkbox,props.children)}function CodeBlock(props){var className=props.language&&"language-".concat(props.language);var code=createElement("code",className?{className:className}:null,props.value);return createElement("pre",getCoreProps(props),code)}function InlineCode(props){return createElement("code",getCoreProps(props),props.children)}function Html(props){if(props.skipHtml){return null}var tag=props.isBlock?"div":"span";if(props.escapeHtml){var comp=React.Fragment||tag;return createElement(comp,null,props.value)}var nodeProps={dangerouslySetInnerHTML:{__html:props.value}};return createElement(tag,nodeProps)}function ParsedHtml(props){return props["data-sourcepos"]?React.cloneElement(props.element,{"data-sourcepos":props["data-sourcepos"]}):props.element}function VirtualHtml(props){return createElement(props.tag,getCoreProps(props),props.children)}function NullRenderer(){return null}function getCoreProps(props){return props["data-sourcepos"]?{"data-sourcepos":props["data-sourcepos"]}:{}}},function(module,exports,__webpack_require__){"use strict";var HtmlParser="__RMD_HTML_PARSER__";exports.HtmlParser=typeof Symbol==="undefined"?HtmlParser:Symbol(HtmlParser)},function(module,exports){ace.define("ace/mode/yaml_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop");var TextHighlightRules=acequire("./text_highlight_rules").TextHighlightRules;var YamlHighlightRules=function(){this.$rules={start:[{token:"comment",regex:"#.*$"},{token:"list.markup",regex:/^(?:-{3}|\.{3})\s*(?=#|$)/},{token:"list.markup",regex:/^\s*[\-?](?:$|\s)/},{token:"constant",regex:"!![\\w//]+"},{token:"constant.language",regex:"[&\\*][a-zA-Z0-9-_]+"},{token:["meta.tag","keyword"],regex:/^(\s*\w.*?)(:(?=\s|$))/},{token:["meta.tag","keyword"],regex:/(\w+?)(\s*:(?=\s|$))/},{token:"keyword.operator",regex:"<<\\w*:\\w*"},{token:"keyword.operator",regex:"-\\s*(?=[{])"},{token:"string",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]'},{token:"string",regex:/[|>][-+\d\s]*$/,onMatch:function(val,state,stack,line){var indent=/^\s*/.exec(line)[0];if(stack.length<1){stack.push(this.next)}else{stack[0]="mlString"}if(stack.length<2){stack.push(indent.length)}else{stack[1]=indent.length}return this.token},next:"mlString"},{token:"string",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"constant.numeric",regex:/(\b|[+\-\.])[\d_]+(?:(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)(?=[^\d-\w]|$)/},{token:"constant.numeric",regex:/[+\-]?\.inf\b|NaN\b|0x[\dA-Fa-f_]+|0b[10_]+/},{token:"constant.language.boolean",regex:"\\b(?:true|false|TRUE|FALSE|True|False|yes|no)\\b"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:/[^\s,:\[\]\{\}]+/}],mlString:[{token:"indent",regex:/^\s*$/},{token:"indent",regex:/^\s*/,onMatch:function(val,state,stack){var curIndent=stack[1];if(curIndent>=val.length){this.next="start";stack.splice(0)}else{this.next="mlString"}return this.token},next:"mlString"},{token:"string",regex:".+"}]};this.normalizeRules()};oop.inherits(YamlHighlightRules,TextHighlightRules);exports.YamlHighlightRules=YamlHighlightRules}));ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(acequire,exports,module){"use strict";var Range=acequire("../range").Range;var MatchingBraceOutdent=function(){};(function(){this.checkOutdent=function(line,input){if(!/^\s+$/.test(line))return false;return/^\s*\}/.test(input)};this.autoOutdent=function(doc,row){var line=doc.getLine(row);var match=line.match(/^(\s*\})/);if(!match)return 0;var column=match[1].length;var openBracePos=doc.findMatchingBracket({row:row,column:column});if(!openBracePos||openBracePos.row==row)return 0;var indent=this.$getIndent(doc.getLine(openBracePos.row));doc.replace(new Range(row,0,row,column-1),indent)};this.$getIndent=function(line){return line.match(/^\s*/)[0]}}).call(MatchingBraceOutdent.prototype);exports.MatchingBraceOutdent=MatchingBraceOutdent}));ace.define("ace/mode/folding/coffee",["require","exports","module","ace/lib/oop","ace/mode/folding/fold_mode","ace/range"],(function(acequire,exports,module){"use strict";var oop=acequire("../../lib/oop");var BaseFoldMode=acequire("./fold_mode").FoldMode;var Range=acequire("../../range").Range;var FoldMode=exports.FoldMode=function(){};oop.inherits(FoldMode,BaseFoldMode);(function(){this.getFoldWidgetRange=function(session,foldStyle,row){var range=this.indentationBlock(session,row);if(range)return range;var re=/\S/;var line=session.getLine(row);var startLevel=line.search(re);if(startLevel==-1||line[startLevel]!="#")return;var startColumn=line.length;var maxRow=session.getLength();var startRow=row;var endRow=row;while(++row<maxRow){line=session.getLine(row);var level=line.search(re);if(level==-1)continue;if(line[level]!="#")break;endRow=row}if(endRow>startRow){var endColumn=session.getLine(endRow).length;return new Range(startRow,startColumn,endRow,endColumn)}};this.getFoldWidget=function(session,foldStyle,row){var line=session.getLine(row);var indent=line.search(/\S/);var next=session.getLine(row+1);var prev=session.getLine(row-1);var prevIndent=prev.search(/\S/);var nextIndent=next.search(/\S/);if(indent==-1){session.foldWidgets[row-1]=prevIndent!=-1&&prevIndent<nextIndent?"start":"";return""}if(prevIndent==-1){if(indent==nextIndent&&line[indent]=="#"&&next[indent]=="#"){session.foldWidgets[row-1]="";session.foldWidgets[row+1]="";return"start"}}else if(prevIndent==indent&&line[indent]=="#"&&prev[indent]=="#"){if(session.getLine(row-2).search(/\S/)==-1){session.foldWidgets[row-1]="start";session.foldWidgets[row+1]="";return""}}if(prevIndent!=-1&&prevIndent<indent)session.foldWidgets[row-1]="start";else session.foldWidgets[row-1]="";if(indent<nextIndent)return"start";else return""}}).call(FoldMode.prototype)}));ace.define("ace/mode/yaml",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/yaml_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/folding/coffee"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop");var TextMode=acequire("./text").Mode;var YamlHighlightRules=acequire("./yaml_highlight_rules").YamlHighlightRules;var MatchingBraceOutdent=acequire("./matching_brace_outdent").MatchingBraceOutdent;var FoldMode=acequire("./folding/coffee").FoldMode;var Mode=function(){this.HighlightRules=YamlHighlightRules;this.$outdent=new MatchingBraceOutdent;this.foldingRules=new FoldMode;this.$behaviour=this.$defaultBehaviour};oop.inherits(Mode,TextMode);(function(){this.lineCommentStart=["#","//"];this.getNextLineIndent=function(state,line,tab){var indent=this.$getIndent(line);if(state=="start"){var match=line.match(/^.*[\{\(\[]\s*$/);if(match){indent+=tab}}return indent};this.checkOutdent=function(state,line,input){return this.$outdent.checkOutdent(line,input)};this.autoOutdent=function(state,doc,row){this.$outdent.autoOutdent(doc,row)};this.$id="ace/mode/yaml"}).call(Mode.prototype);exports.Mode=Mode}))},function(module,exports){ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],(function(acequire,exports,module){"use strict";exports.isDark=false;exports.cssClass="ace-tm";exports.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}';var dom=acequire("../lib/dom");dom.importCssString(exports.cssText,exports.cssClass)}))},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(263);case"v7light":return __webpack_require__(265);case"v8dark":return __webpack_require__(267);case"v8light":return __webpack_require__(269)}},function(module,exports,__webpack_require__){var api=__webpack_require__(116);var content=__webpack_require__(264);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(117);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".fleet__epm__shiftNavTabs {\n  margin-left: 184px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(116);var content=__webpack_require__(266);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(117);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".fleet__epm__shiftNavTabs {\n  margin-left: 184px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(116);var content=__webpack_require__(268);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(117);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".fleet__epm__shiftNavTabs {\n  margin-left: 184px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(116);var content=__webpack_require__(270);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(117);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".fleet__epm__shiftNavTabs {\n  margin-left: 184px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){(function(root,factory){if(true){module.exports=factory()}else{}})(typeof self!=="undefined"?self:this,(function(){var rison={};rison.uri_ok={"~":true,"!":true,"*":true,"(":true,")":true,"-":true,_:true,".":true,",":true,":":true,"@":true,$:true,"'":true,"/":true};(function(){var l=[];for(var hi=0;hi<16;hi++){for(var lo=0;lo<16;lo++){if(hi+lo===0)continue;var c=String.fromCharCode(hi*16+lo);if(!/\w|[-_./~]/.test(c))l.push("\\u00"+hi.toString(16)+lo.toString(16))}}rison.not_idchar=l.join("")})();rison.not_idchar=" '!:(),*@$";rison.not_idstart="-0123456789";(function(){var idrx="[^"+rison.not_idstart+rison.not_idchar+"][^"+rison.not_idchar+"]*";rison.id_ok=new RegExp("^"+idrx+"$");rison.next_id=new RegExp(idrx,"g")})();rison.quote=function(x){if(/^[-A-Za-z0-9~!*()_.',:@$/]*$/.test(x))return x;return encodeURIComponent(x).replace(/%2C/g,",").replace(/%3A/g,":").replace(/%40/g,"@").replace(/%24/g,"$").replace(/%2F/g,"/").replace(/%20/g,"+")};(function(){var sq={"'":true,"!":true},enc=function(v){if(v&&typeof v.toJSON==="function")v=v.toJSON();var fn=s[typeof v];if(fn)return fn(v)},s={array:function(x){var a=["!("],b,i,l=x.length,v;for(i=0;i<l;i+=1){v=enc(x[i]);if(typeof v=="string"){if(b){a[a.length]=","}a[a.length]=v;b=true}}a[a.length]=")";return a.join("")},boolean:function(x){if(x)return"!t";return"!f"},null:function(){return"!n"},number:function(x){if(!isFinite(x))return"!n";return String(x).replace(/\+/,"")},object:function(x){if(x){if(x instanceof Array){return s.array(x)}if(typeof x.__prototype__==="object"&&typeof x.__prototype__.encode_rison!=="undefined")return x.encode_rison();var a=["("],b,i,v,ki,ks=[];for(i in x)ks[ks.length]=i;ks.sort();for(ki=0;ki<ks.length;ki++){i=ks[ki];v=enc(x[i]);if(typeof v=="string"){if(b){a[a.length]=","}a.push(s.string(i),":",v);b=true}}a[a.length]=")";return a.join("")}return"!n"},string:function(x){if(x==="")return"''";if(rison.id_ok.test(x))return x;x=x.replace(/(['!])/g,(function(a,b){if(sq[b])return"!"+b;return b}));return"'"+x+"'"},undefined:function(){return}};rison.encode=function(v){return enc(v)};rison.encode_object=function(v){if(typeof v!="object"||v===null||v instanceof Array)throw new Error("rison.encode_object expects an object argument");var r=s[typeof v](v);return r.substring(1,r.length-1)};rison.encode_array=function(v){if(!(v instanceof Array))throw new Error("rison.encode_array expects an array argument");var r=s[typeof v](v);return r.substring(2,r.length-1)};rison.encode_uri=function(v){return rison.quote(s[typeof v](v))}})();rison.decode=function(r){var errcb=function(e){throw Error("rison decoder error: "+e)};if(typeof r!=="string")return errcb("decode input must be a string");var p=new rison.parser(errcb);return p.parse(r)};rison.decode_object=function(r){return rison.decode("("+r+")")};rison.decode_array=function(r){return rison.decode("!("+r+")")};rison.parser=function(errcb){this.errorHandler=errcb};rison.parser.WHITESPACE="";rison.parser.prototype.setOptions=function(options){if(options["errorHandler"])this.errorHandler=options.errorHandler};rison.parser.prototype.parse=function(str){this.string=str;this.index=0;this.message=null;var value=this.readValue();if(!this.message&&this.next())value=this.error("unable to parse string as rison: '"+rison.encode(str)+"'");if(this.message&&this.errorHandler)this.errorHandler(this.message,this.index);return value};rison.parser.prototype.error=function(message){if(typeof console!=="undefined")console.log("rison parser error: ",message);this.message=message;return undefined};rison.parser.prototype.readValue=function(){var c=this.next();var fn=c&&this.table[c];if(fn)return fn.apply(this);var s=this.string;var i=this.index-1;rison.next_id.lastIndex=i;var m=rison.next_id.exec(s);if(m.length>0){var id=m[0];this.index=i+id.length;return id}if(c)return this.error("invalid character: '"+c+"'");return this.error("empty expression")};rison.parser.parse_array=function(parser){var ar=[];var c;while((c=parser.next())!==")"){if(!c)return parser.error("unmatched '!('");if(ar.length){if(c!==",")parser.error("missing ','")}else if(c===","){return parser.error("extra ','")}else--parser.index;var n=parser.readValue();if(typeof n=="undefined")return undefined;ar.push(n)}return ar};rison.parser.bangs={t:true,f:false,n:null,"(":rison.parser.parse_array};rison.parser.prototype.table={"!":function(){var s=this.string;var c=s.charAt(this.index++);if(!c)return this.error('"!" at end of input');var x=rison.parser.bangs[c];if(typeof x=="function"){return x.call(null,this)}else if(typeof x=="undefined"){return this.error('unknown literal: "!'+c+'"')}return x},"(":function(){var o={};var c;var count=0;while((c=this.next())!==")"){if(count){if(c!==",")this.error("missing ','")}else if(c===","){return this.error("extra ','")}else--this.index;var k=this.readValue();if(typeof k==="undefined")return undefined;if(this.next()!==":")return this.error("missing ':'");var v=this.readValue();if(typeof v==="undefined")return undefined;o[k]=v;count++}return o},"'":function(){var s=this.string;var i=this.index;var start=i;var segments=[];var c;while((c=s.charAt(i++))!=="'"){if(!c)return this.error('unmatched "\'"');if(c==="!"){if(start<i-1)segments.push(s.slice(start,i-1));c=s.charAt(i++);if("!'".indexOf(c)>=0){segments.push(c)}else{return this.error('invalid string escape: "!'+c+'"')}start=i}}if(start<i-1)segments.push(s.slice(start,i-1));this.index=i;return segments.length===1?segments[0]:segments.join("")},"-":function(){var s=this.string;var i=this.index;var start=i-1;var state="int";var permittedSigns="-";var transitions={"int+.":"frac","int+e":"exp","frac+e":"exp"};do{var c=s.charAt(i++);if(!c)break;if("0"<=c&&c<="9")continue;if(permittedSigns.indexOf(c)>=0){permittedSigns="";continue}state=transitions[state+"+"+c.toLowerCase()];if(state==="exp")permittedSigns="-"}while(state);this.index=--i;s=s.slice(start,i);if(s==="-")return this.error("invalid number");return Number(s)}};(function(table){for(var i=0;i<=9;i++)table[String(i)]=table["-"]})(rison.parser.prototype.table);rison.parser.prototype.next=function(){var c;var s=this.string;var i=this.index;do{if(i===s.length)return undefined;c=s.charAt(i++)}while(rison.parser.WHITESPACE.indexOf(c)>=0);this.index=i;return c};return rison}))},function(module,exports,__webpack_require__){const compare=__webpack_require__(62);const gte=(a,b,loose)=>compare(a,b,loose)>=0;module.exports=gte},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(){var d3={version:"3.5.17"};var d3_arraySlice=[].slice,d3_array=function(list){return d3_arraySlice.call(list)};var d3_document=this.document;function d3_documentElement(node){return node&&(node.ownerDocument||node.document||node).documentElement}function d3_window(node){return node&&(node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView)}if(d3_document){try{d3_array(d3_document.documentElement.childNodes)[0].nodeType}catch(e){d3_array=function(list){var i=list.length,array=new Array(i);while(i--)array[i]=list[i];return array}}}if(!Date.now)Date.now=function(){return+new Date};if(d3_document){try{d3_document.createElement("DIV").style.setProperty("opacity",0,"")}catch(error){var d3_element_prototype=this.Element.prototype,d3_element_setAttribute=d3_element_prototype.setAttribute,d3_element_setAttributeNS=d3_element_prototype.setAttributeNS,d3_style_prototype=this.CSSStyleDeclaration.prototype,d3_style_setProperty=d3_style_prototype.setProperty;d3_element_prototype.setAttribute=function(name,value){d3_element_setAttribute.call(this,name,value+"")};d3_element_prototype.setAttributeNS=function(space,local,value){d3_element_setAttributeNS.call(this,space,local,value+"")};d3_style_prototype.setProperty=function(name,value,priority){d3_style_setProperty.call(this,name,value+"",priority)}}}d3.ascending=d3_ascending;function d3_ascending(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}d3.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN};d3.min=function(array,f){var i=-1,n=array.length,a,b;if(arguments.length===1){while(++i<n)if((b=array[i])!=null&&b>=b){a=b;break}while(++i<n)if((b=array[i])!=null&&a>b)a=b}else{while(++i<n)if((b=f.call(array,array[i],i))!=null&&b>=b){a=b;break}while(++i<n)if((b=f.call(array,array[i],i))!=null&&a>b)a=b}return a};d3.max=function(array,f){var i=-1,n=array.length,a,b;if(arguments.length===1){while(++i<n)if((b=array[i])!=null&&b>=b){a=b;break}while(++i<n)if((b=array[i])!=null&&b>a)a=b}else{while(++i<n)if((b=f.call(array,array[i],i))!=null&&b>=b){a=b;break}while(++i<n)if((b=f.call(array,array[i],i))!=null&&b>a)a=b}return a};d3.extent=function(array,f){var i=-1,n=array.length,a,b,c;if(arguments.length===1){while(++i<n)if((b=array[i])!=null&&b>=b){a=c=b;break}while(++i<n)if((b=array[i])!=null){if(a>b)a=b;if(c<b)c=b}}else{while(++i<n)if((b=f.call(array,array[i],i))!=null&&b>=b){a=c=b;break}while(++i<n)if((b=f.call(array,array[i],i))!=null){if(a>b)a=b;if(c<b)c=b}}return[a,c]};function d3_number(x){return x===null?NaN:+x}function d3_numeric(x){return!isNaN(x)}d3.sum=function(array,f){var s=0,n=array.length,a,i=-1;if(arguments.length===1){while(++i<n)if(d3_numeric(a=+array[i]))s+=a}else{while(++i<n)if(d3_numeric(a=+f.call(array,array[i],i)))s+=a}return s};d3.mean=function(array,f){var s=0,n=array.length,a,i=-1,j=n;if(arguments.length===1){while(++i<n)if(d3_numeric(a=d3_number(array[i])))s+=a;else--j}else{while(++i<n)if(d3_numeric(a=d3_number(f.call(array,array[i],i))))s+=a;else--j}if(j)return s/j};d3.quantile=function(values,p){var H=(values.length-1)*p+1,h=Math.floor(H),v=+values[h-1],e=H-h;return e?v+e*(values[h]-v):v};d3.median=function(array,f){var numbers=[],n=array.length,a,i=-1;if(arguments.length===1){while(++i<n)if(d3_numeric(a=d3_number(array[i])))numbers.push(a)}else{while(++i<n)if(d3_numeric(a=d3_number(f.call(array,array[i],i))))numbers.push(a)}if(numbers.length)return d3.quantile(numbers.sort(d3_ascending),.5)};d3.variance=function(array,f){var n=array.length,m=0,a,d,s=0,i=-1,j=0;if(arguments.length===1){while(++i<n){if(d3_numeric(a=d3_number(array[i]))){d=a-m;m+=d/++j;s+=d*(a-m)}}}else{while(++i<n){if(d3_numeric(a=d3_number(f.call(array,array[i],i)))){d=a-m;m+=d/++j;s+=d*(a-m)}}}if(j>1)return s/(j-1)};d3.deviation=function(){var v=d3.variance.apply(this,arguments);return v?Math.sqrt(v):v};function d3_bisector(compare){return{left:function(a,x,lo,hi){if(arguments.length<3)lo=0;if(arguments.length<4)hi=a.length;while(lo<hi){var mid=lo+hi>>>1;if(compare(a[mid],x)<0)lo=mid+1;else hi=mid}return lo},right:function(a,x,lo,hi){if(arguments.length<3)lo=0;if(arguments.length<4)hi=a.length;while(lo<hi){var mid=lo+hi>>>1;if(compare(a[mid],x)>0)hi=mid;else lo=mid+1}return lo}}}var d3_bisect=d3_bisector(d3_ascending);d3.bisectLeft=d3_bisect.left;d3.bisect=d3.bisectRight=d3_bisect.right;d3.bisector=function(f){return d3_bisector(f.length===1?function(d,x){return d3_ascending(f(d),x)}:f)};d3.shuffle=function(array,i0,i1){if((m=arguments.length)<3){i1=array.length;if(m<2)i0=0}var m=i1-i0,t,i;while(m){i=Math.random()*m--|0;t=array[m+i0],array[m+i0]=array[i+i0],array[i+i0]=t}return array};d3.permute=function(array,indexes){var i=indexes.length,permutes=new Array(i);while(i--)permutes[i]=array[indexes[i]];return permutes};d3.pairs=function(array){var i=0,n=array.length-1,p0,p1=array[0],pairs=new Array(n<0?0:n);while(i<n)pairs[i]=[p0=p1,p1=array[++i]];return pairs};d3.transpose=function(matrix){if(!(n=matrix.length))return[];for(var i=-1,m=d3.min(matrix,d3_transposeLength),transpose=new Array(m);++i<m;){for(var j=-1,n,row=transpose[i]=new Array(n);++j<n;){row[j]=matrix[j][i]}}return transpose};function d3_transposeLength(d){return d.length}d3.zip=function(){return d3.transpose(arguments)};d3.keys=function(map){var keys=[];for(var key in map)keys.push(key);return keys};d3.values=function(map){var values=[];for(var key in map)values.push(map[key]);return values};d3.entries=function(map){var entries=[];for(var key in map)entries.push({key:key,value:map[key]});return entries};d3.merge=function(arrays){var n=arrays.length,m,i=-1,j=0,merged,array;while(++i<n)j+=arrays[i].length;merged=new Array(j);while(--n>=0){array=arrays[n];m=array.length;while(--m>=0){merged[--j]=array[m]}}return merged};var abs=Math.abs;d3.range=function(start,stop,step){if(arguments.length<3){step=1;if(arguments.length<2){stop=start;start=0}}if((stop-start)/step===Infinity)throw new Error("infinite range");var range=[],k=d3_range_integerScale(abs(step)),i=-1,j;start*=k,stop*=k,step*=k;if(step<0)while((j=start+step*++i)>stop)range.push(j/k);else while((j=start+step*++i)<stop)range.push(j/k);return range};function d3_range_integerScale(x){var k=1;while(x*k%1)k*=10;return k}function d3_class(ctor,properties){for(var key in properties){Object.defineProperty(ctor.prototype,key,{value:properties[key],enumerable:false})}}d3.map=function(object,f){var map=new d3_Map;if(object instanceof d3_Map){object.forEach((function(key,value){map.set(key,value)}))}else if(Array.isArray(object)){var i=-1,n=object.length,o;if(arguments.length===1)while(++i<n)map.set(i,object[i]);else while(++i<n)map.set(f.call(object,o=object[i],i),o)}else{for(var key in object)map.set(key,object[key])}return map};function d3_Map(){this._=Object.create(null)}var d3_map_proto="__proto__",d3_map_zero="\0";d3_class(d3_Map,{has:d3_map_has,get:function(key){return this._[d3_map_escape(key)]},set:function(key,value){return this._[d3_map_escape(key)]=value},remove:d3_map_remove,keys:d3_map_keys,values:function(){var values=[];for(var key in this._)values.push(this._[key]);return values},entries:function(){var entries=[];for(var key in this._)entries.push({key:d3_map_unescape(key),value:this._[key]});return entries},size:d3_map_size,empty:d3_map_empty,forEach:function(f){for(var key in this._)f.call(this,d3_map_unescape(key),this._[key])}});function d3_map_escape(key){return(key+="")===d3_map_proto||key[0]===d3_map_zero?d3_map_zero+key:key}function d3_map_unescape(key){return(key+="")[0]===d3_map_zero?key.slice(1):key}function d3_map_has(key){return d3_map_escape(key)in this._}function d3_map_remove(key){return(key=d3_map_escape(key))in this._&&delete this._[key]}function d3_map_keys(){var keys=[];for(var key in this._)keys.push(d3_map_unescape(key));return keys}function d3_map_size(){var size=0;for(var key in this._)++size;return size}function d3_map_empty(){for(var key in this._)return false;return true}d3.nest=function(){var nest={},keys=[],sortKeys=[],sortValues,rollup;function map(mapType,array,depth){if(depth>=keys.length)return rollup?rollup.call(nest,array):sortValues?array.sort(sortValues):array;var i=-1,n=array.length,key=keys[depth++],keyValue,object,setter,valuesByKey=new d3_Map,values;while(++i<n){if(values=valuesByKey.get(keyValue=key(object=array[i]))){values.push(object)}else{valuesByKey.set(keyValue,[object])}}if(mapType){object=mapType();setter=function(keyValue,values){object.set(keyValue,map(mapType,values,depth))}}else{object={};setter=function(keyValue,values){object[keyValue]=map(mapType,values,depth)}}valuesByKey.forEach(setter);return object}function entries(map,depth){if(depth>=keys.length)return map;var array=[],sortKey=sortKeys[depth++];map.forEach((function(key,keyMap){array.push({key:key,values:entries(keyMap,depth)})}));return sortKey?array.sort((function(a,b){return sortKey(a.key,b.key)})):array}nest.map=function(array,mapType){return map(mapType,array,0)};nest.entries=function(array){return entries(map(d3.map,array,0),0)};nest.key=function(d){keys.push(d);return nest};nest.sortKeys=function(order){sortKeys[keys.length-1]=order;return nest};nest.sortValues=function(order){sortValues=order;return nest};nest.rollup=function(f){rollup=f;return nest};return nest};d3.set=function(array){var set=new d3_Set;if(array)for(var i=0,n=array.length;i<n;++i)set.add(array[i]);return set};function d3_Set(){this._=Object.create(null)}d3_class(d3_Set,{has:d3_map_has,add:function(key){this._[d3_map_escape(key+="")]=true;return key},remove:d3_map_remove,values:d3_map_keys,size:d3_map_size,empty:d3_map_empty,forEach:function(f){for(var key in this._)f.call(this,d3_map_unescape(key))}});d3.behavior={};function d3_identity(d){return d}d3.rebind=function(target,source){var i=1,n=arguments.length,method;while(++i<n)target[method=arguments[i]]=d3_rebind(target,source,source[method]);return target};function d3_rebind(target,source,method){return function(){var value=method.apply(source,arguments);return value===source?target:value}}function d3_vendorSymbol(object,name){if(name in object)return name;name=name.charAt(0).toUpperCase()+name.slice(1);for(var i=0,n=d3_vendorPrefixes.length;i<n;++i){var prefixName=d3_vendorPrefixes[i]+name;if(prefixName in object)return prefixName}}var d3_vendorPrefixes=["webkit","ms","moz","Moz","o","O"];function d3_noop(){}d3.dispatch=function(){var dispatch=new d3_dispatch,i=-1,n=arguments.length;while(++i<n)dispatch[arguments[i]]=d3_dispatch_event(dispatch);return dispatch};function d3_dispatch(){}d3_dispatch.prototype.on=function(type,listener){var i=type.indexOf("."),name="";if(i>=0){name=type.slice(i+1);type=type.slice(0,i)}if(type)return arguments.length<2?this[type].on(name):this[type].on(name,listener);if(arguments.length===2){if(listener==null)for(type in this){if(this.hasOwnProperty(type))this[type].on(name,null)}return this}};function d3_dispatch_event(dispatch){var listeners=[],listenerByName=new d3_Map;function event(){var z=listeners,i=-1,n=z.length,l;while(++i<n)if(l=z[i].on)l.apply(this,arguments);return dispatch}event.on=function(name,listener){var l=listenerByName.get(name),i;if(arguments.length<2)return l&&l.on;if(l){l.on=null;listeners=listeners.slice(0,i=listeners.indexOf(l)).concat(listeners.slice(i+1));listenerByName.remove(name)}if(listener)listeners.push(listenerByName.set(name,{on:listener}));return dispatch};return event}d3.event=null;function d3_eventPreventDefault(){d3.event.preventDefault()}function d3_eventSource(){var e=d3.event,s;while(s=e.sourceEvent)e=s;return e}function d3_eventDispatch(target){var dispatch=new d3_dispatch,i=0,n=arguments.length;while(++i<n)dispatch[arguments[i]]=d3_dispatch_event(dispatch);dispatch.of=function(thiz,argumentz){return function(e1){try{var e0=e1.sourceEvent=d3.event;e1.target=target;d3.event=e1;dispatch[e1.type].apply(thiz,argumentz)}finally{d3.event=e0}}};return dispatch}d3.requote=function(s){return s.replace(d3_requote_re,"\\$&")};var d3_requote_re=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;var d3_subclass={}.__proto__?function(object,prototype){object.__proto__=prototype}:function(object,prototype){for(var property in prototype)object[property]=prototype[property]};function d3_selection(groups){d3_subclass(groups,d3_selectionPrototype);return groups}var d3_select=function(s,n){return n.querySelector(s)},d3_selectAll=function(s,n){return n.querySelectorAll(s)},d3_selectMatches=function(n,s){var d3_selectMatcher=n.matches||n[d3_vendorSymbol(n,"matchesSelector")];d3_selectMatches=function(n,s){return d3_selectMatcher.call(n,s)};return d3_selectMatches(n,s)};if(typeof Sizzle==="function"){d3_select=function(s,n){return Sizzle(s,n)[0]||null};d3_selectAll=Sizzle;d3_selectMatches=Sizzle.matchesSelector}d3.selection=function(){return d3.select(d3_document.documentElement)};var d3_selectionPrototype=d3.selection.prototype=[];d3_selectionPrototype.select=function(selector){var subgroups=[],subgroup,subnode,group,node;selector=d3_selection_selector(selector);for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);subgroup.parentNode=(group=this[j]).parentNode;for(var i=-1,n=group.length;++i<n;){if(node=group[i]){subgroup.push(subnode=selector.call(node,node.__data__,i,j));if(subnode&&"__data__"in node)subnode.__data__=node.__data__}else{subgroup.push(null)}}}return d3_selection(subgroups)};function d3_selection_selector(selector){return typeof selector==="function"?selector:function(){return d3_select(selector,this)}}d3_selectionPrototype.selectAll=function(selector){var subgroups=[],subgroup,node;selector=d3_selection_selectorAll(selector);for(var j=-1,m=this.length;++j<m;){for(var group=this[j],i=-1,n=group.length;++i<n;){if(node=group[i]){subgroups.push(subgroup=d3_array(selector.call(node,node.__data__,i,j)));subgroup.parentNode=node}}}return d3_selection(subgroups)};function d3_selection_selectorAll(selector){return typeof selector==="function"?selector:function(){return d3_selectAll(selector,this)}}var d3_nsXhtml="http://www.w3.org/1999/xhtml";var d3_nsPrefix={svg:"http://www.w3.org/2000/svg",xhtml:d3_nsXhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:d3_nsPrefix,qualify:function(name){var i=name.indexOf(":"),prefix=name;if(i>=0&&(prefix=name.slice(0,i))!=="xmlns")name=name.slice(i+1);return d3_nsPrefix.hasOwnProperty(prefix)?{space:d3_nsPrefix[prefix],local:name}:name}};d3_selectionPrototype.attr=function(name,value){if(arguments.length<2){if(typeof name==="string"){var node=this.node();name=d3.ns.qualify(name);return name.local?node.getAttributeNS(name.space,name.local):node.getAttribute(name)}for(value in name)this.each(d3_selection_attr(value,name[value]));return this}return this.each(d3_selection_attr(name,value))};function d3_selection_attr(name,value){name=d3.ns.qualify(name);function attrNull(){this.removeAttribute(name)}function attrNullNS(){this.removeAttributeNS(name.space,name.local)}function attrConstant(){this.setAttribute(name,value)}function attrConstantNS(){this.setAttributeNS(name.space,name.local,value)}function attrFunction(){var x=value.apply(this,arguments);if(x==null)this.removeAttribute(name);else this.setAttribute(name,x)}function attrFunctionNS(){var x=value.apply(this,arguments);if(x==null)this.removeAttributeNS(name.space,name.local);else this.setAttributeNS(name.space,name.local,x)}return value==null?name.local?attrNullNS:attrNull:typeof value==="function"?name.local?attrFunctionNS:attrFunction:name.local?attrConstantNS:attrConstant}function d3_collapse(s){return s.trim().replace(/\s+/g," ")}d3_selectionPrototype.classed=function(name,value){if(arguments.length<2){if(typeof name==="string"){var node=this.node(),n=(name=d3_selection_classes(name)).length,i=-1;if(value=node.classList){while(++i<n)if(!value.contains(name[i]))return false}else{value=node.getAttribute("class");while(++i<n)if(!d3_selection_classedRe(name[i]).test(value))return false}return true}for(value in name)this.each(d3_selection_classed(value,name[value]));return this}return this.each(d3_selection_classed(name,value))};function d3_selection_classedRe(name){return new RegExp("(?:^|\\s+)"+d3.requote(name)+"(?:\\s+|$)","g")}function d3_selection_classes(name){return(name+"").trim().split(/^|\s+/)}function d3_selection_classed(name,value){name=d3_selection_classes(name).map(d3_selection_classedName);var n=name.length;function classedConstant(){var i=-1;while(++i<n)name[i](this,value)}function classedFunction(){var i=-1,x=value.apply(this,arguments);while(++i<n)name[i](this,x)}return typeof value==="function"?classedFunction:classedConstant}function d3_selection_classedName(name){var re=d3_selection_classedRe(name);return function(node,value){if(c=node.classList)return value?c.add(name):c.remove(name);var c=node.getAttribute("class")||"";if(value){re.lastIndex=0;if(!re.test(c))node.setAttribute("class",d3_collapse(c+" "+name))}else{node.setAttribute("class",d3_collapse(c.replace(re," ")))}}}d3_selectionPrototype.style=function(name,value,priority){var n=arguments.length;if(n<3){if(typeof name!=="string"){if(n<2)value="";for(priority in name)this.each(d3_selection_style(priority,name[priority],value));return this}if(n<2){var node=this.node();return d3_window(node).getComputedStyle(node,null).getPropertyValue(name)}priority=""}return this.each(d3_selection_style(name,value,priority))};function d3_selection_style(name,value,priority){function styleNull(){this.style.removeProperty(name)}function styleConstant(){this.style.setProperty(name,value,priority)}function styleFunction(){var x=value.apply(this,arguments);if(x==null)this.style.removeProperty(name);else this.style.setProperty(name,x,priority)}return value==null?styleNull:typeof value==="function"?styleFunction:styleConstant}d3_selectionPrototype.property=function(name,value){if(arguments.length<2){if(typeof name==="string")return this.node()[name];for(value in name)this.each(d3_selection_property(value,name[value]));return this}return this.each(d3_selection_property(name,value))};function d3_selection_property(name,value){function propertyNull(){delete this[name]}function propertyConstant(){this[name]=value}function propertyFunction(){var x=value.apply(this,arguments);if(x==null)delete this[name];else this[name]=x}return value==null?propertyNull:typeof value==="function"?propertyFunction:propertyConstant}d3_selectionPrototype.text=function(value){return arguments.length?this.each(typeof value==="function"?function(){var v=value.apply(this,arguments);this.textContent=v==null?"":v}:value==null?function(){this.textContent=""}:function(){this.textContent=value}):this.node().textContent};d3_selectionPrototype.html=function(value){return arguments.length?this.each(typeof value==="function"?function(){var v=value.apply(this,arguments);this.innerHTML=v==null?"":v}:value==null?function(){this.innerHTML=""}:function(){this.innerHTML=value}):this.node().innerHTML};d3_selectionPrototype.append=function(name){name=d3_selection_creator(name);return this.select((function(){return this.appendChild(name.apply(this,arguments))}))};function d3_selection_creator(name){function create(){var document=this.ownerDocument,namespace=this.namespaceURI;return namespace===d3_nsXhtml&&document.documentElement.namespaceURI===d3_nsXhtml?document.createElement(name):document.createElementNS(namespace,name)}function createNS(){return this.ownerDocument.createElementNS(name.space,name.local)}return typeof name==="function"?name:(name=d3.ns.qualify(name)).local?createNS:create}d3_selectionPrototype.insert=function(name,before){name=d3_selection_creator(name);before=d3_selection_selector(before);return this.select((function(){return this.insertBefore(name.apply(this,arguments),before.apply(this,arguments)||null)}))};d3_selectionPrototype.remove=function(){return this.each(d3_selectionRemove)};function d3_selectionRemove(){var parent=this.parentNode;if(parent)parent.removeChild(this)}d3_selectionPrototype.data=function(value,key){var i=-1,n=this.length,group,node;if(!arguments.length){value=new Array(n=(group=this[0]).length);while(++i<n){if(node=group[i]){value[i]=node.__data__}}return value}function bind(group,groupData){var i,n=group.length,m=groupData.length,n0=Math.min(n,m),updateNodes=new Array(m),enterNodes=new Array(m),exitNodes=new Array(n),node,nodeData;if(key){var nodeByKeyValue=new d3_Map,keyValues=new Array(n),keyValue;for(i=-1;++i<n;){if(node=group[i]){if(nodeByKeyValue.has(keyValue=key.call(node,node.__data__,i))){exitNodes[i]=node}else{nodeByKeyValue.set(keyValue,node)}keyValues[i]=keyValue}}for(i=-1;++i<m;){if(!(node=nodeByKeyValue.get(keyValue=key.call(groupData,nodeData=groupData[i],i)))){enterNodes[i]=d3_selection_dataNode(nodeData)}else if(node!==true){updateNodes[i]=node;node.__data__=nodeData}nodeByKeyValue.set(keyValue,true)}for(i=-1;++i<n;){if(i in keyValues&&nodeByKeyValue.get(keyValues[i])!==true){exitNodes[i]=group[i]}}}else{for(i=-1;++i<n0;){node=group[i];nodeData=groupData[i];if(node){node.__data__=nodeData;updateNodes[i]=node}else{enterNodes[i]=d3_selection_dataNode(nodeData)}}for(;i<m;++i){enterNodes[i]=d3_selection_dataNode(groupData[i])}for(;i<n;++i){exitNodes[i]=group[i]}}enterNodes.update=updateNodes;enterNodes.parentNode=updateNodes.parentNode=exitNodes.parentNode=group.parentNode;enter.push(enterNodes);update.push(updateNodes);exit.push(exitNodes)}var enter=d3_selection_enter([]),update=d3_selection([]),exit=d3_selection([]);if(typeof value==="function"){while(++i<n){bind(group=this[i],value.call(group,group.parentNode.__data__,i))}}else{while(++i<n){bind(group=this[i],value)}}update.enter=function(){return enter};update.exit=function(){return exit};return update};function d3_selection_dataNode(data){return{__data__:data}}d3_selectionPrototype.datum=function(value){return arguments.length?this.property("__data__",value):this.property("__data__")};d3_selectionPrototype.filter=function(filter){var subgroups=[],subgroup,group,node;if(typeof filter!=="function")filter=d3_selection_filter(filter);for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);subgroup.parentNode=(group=this[j]).parentNode;for(var i=0,n=group.length;i<n;i++){if((node=group[i])&&filter.call(node,node.__data__,i,j)){subgroup.push(node)}}}return d3_selection(subgroups)};function d3_selection_filter(selector){return function(){return d3_selectMatches(this,selector)}}d3_selectionPrototype.order=function(){for(var j=-1,m=this.length;++j<m;){for(var group=this[j],i=group.length-1,next=group[i],node;--i>=0;){if(node=group[i]){if(next&&next!==node.nextSibling)next.parentNode.insertBefore(node,next);next=node}}}return this};d3_selectionPrototype.sort=function(comparator){comparator=d3_selection_sortComparator.apply(this,arguments);for(var j=-1,m=this.length;++j<m;)this[j].sort(comparator);return this.order()};function d3_selection_sortComparator(comparator){if(!arguments.length)comparator=d3_ascending;return function(a,b){return a&&b?comparator(a.__data__,b.__data__):!a-!b}}d3_selectionPrototype.each=function(callback){return d3_selection_each(this,(function(node,i,j){callback.call(node,node.__data__,i,j)}))};function d3_selection_each(groups,callback){for(var j=0,m=groups.length;j<m;j++){for(var group=groups[j],i=0,n=group.length,node;i<n;i++){if(node=group[i])callback(node,i,j)}}return groups}d3_selectionPrototype.call=function(callback){var args=d3_array(arguments);callback.apply(args[0]=this,args);return this};d3_selectionPrototype.empty=function(){return!this.node()};d3_selectionPrototype.node=function(){for(var j=0,m=this.length;j<m;j++){for(var group=this[j],i=0,n=group.length;i<n;i++){var node=group[i];if(node)return node}}return null};d3_selectionPrototype.size=function(){var n=0;d3_selection_each(this,(function(){++n}));return n};function d3_selection_enter(selection){d3_subclass(selection,d3_selection_enterPrototype);return selection}var d3_selection_enterPrototype=[];d3.selection.enter=d3_selection_enter;d3.selection.enter.prototype=d3_selection_enterPrototype;d3_selection_enterPrototype.append=d3_selectionPrototype.append;d3_selection_enterPrototype.empty=d3_selectionPrototype.empty;d3_selection_enterPrototype.node=d3_selectionPrototype.node;d3_selection_enterPrototype.call=d3_selectionPrototype.call;d3_selection_enterPrototype.size=d3_selectionPrototype.size;d3_selection_enterPrototype.select=function(selector){var subgroups=[],subgroup,subnode,upgroup,group,node;for(var j=-1,m=this.length;++j<m;){upgroup=(group=this[j]).update;subgroups.push(subgroup=[]);subgroup.parentNode=group.parentNode;for(var i=-1,n=group.length;++i<n;){if(node=group[i]){subgroup.push(upgroup[i]=subnode=selector.call(group.parentNode,node.__data__,i,j));subnode.__data__=node.__data__}else{subgroup.push(null)}}}return d3_selection(subgroups)};d3_selection_enterPrototype.insert=function(name,before){if(arguments.length<2)before=d3_selection_enterInsertBefore(this);return d3_selectionPrototype.insert.call(this,name,before)};function d3_selection_enterInsertBefore(enter){var i0,j0;return function(d,i,j){var group=enter[j].update,n=group.length,node;if(j!=j0)j0=j,i0=0;if(i>=i0)i0=i+1;while(!(node=group[i0])&&++i0<n);return node}}d3.select=function(node){var group;if(typeof node==="string"){group=[d3_select(node,d3_document)];group.parentNode=d3_document.documentElement}else{group=[node];group.parentNode=d3_documentElement(node)}return d3_selection([group])};d3.selectAll=function(nodes){var group;if(typeof nodes==="string"){group=d3_array(d3_selectAll(nodes,d3_document));group.parentNode=d3_document.documentElement}else{group=d3_array(nodes);group.parentNode=null}return d3_selection([group])};d3_selectionPrototype.on=function(type,listener,capture){var n=arguments.length;if(n<3){if(typeof type!=="string"){if(n<2)listener=false;for(capture in type)this.each(d3_selection_on(capture,type[capture],listener));return this}if(n<2)return(n=this.node()["__on"+type])&&n._;capture=false}return this.each(d3_selection_on(type,listener,capture))};function d3_selection_on(type,listener,capture){var name="__on"+type,i=type.indexOf("."),wrap=d3_selection_onListener;if(i>0)type=type.slice(0,i);var filter=d3_selection_onFilters.get(type);if(filter)type=filter,wrap=d3_selection_onFilter;function onRemove(){var l=this[name];if(l){this.removeEventListener(type,l,l.$);delete this[name]}}function onAdd(){var l=wrap(listener,d3_array(arguments));onRemove.call(this);this.addEventListener(type,this[name]=l,l.$=capture);l._=listener}function removeAll(){var re=new RegExp("^__on([^.]+)"+d3.requote(type)+"$"),match;for(var name in this){if(match=name.match(re)){var l=this[name];this.removeEventListener(match[1],l,l.$);delete this[name]}}}return i?listener?onAdd:onRemove:listener?d3_noop:removeAll}var d3_selection_onFilters=d3.map({mouseenter:"mouseover",mouseleave:"mouseout"});if(d3_document){d3_selection_onFilters.forEach((function(k){if("on"+k in d3_document)d3_selection_onFilters.remove(k)}))}function d3_selection_onListener(listener,argumentz){return function(e){var o=d3.event;d3.event=e;argumentz[0]=this.__data__;try{listener.apply(this,argumentz)}finally{d3.event=o}}}function d3_selection_onFilter(listener,argumentz){var l=d3_selection_onListener(listener,argumentz);return function(e){var target=this,related=e.relatedTarget;if(!related||related!==target&&!(related.compareDocumentPosition(target)&8)){l.call(target,e)}}}var d3_event_dragSelect,d3_event_dragId=0;function d3_event_dragSuppress(node){var name=".dragsuppress-"+ ++d3_event_dragId,click="click"+name,w=d3.select(d3_window(node)).on("touchmove"+name,d3_eventPreventDefault).on("dragstart"+name,d3_eventPreventDefault).on("selectstart"+name,d3_eventPreventDefault);if(d3_event_dragSelect==null){d3_event_dragSelect="onselectstart"in node?false:d3_vendorSymbol(node.style,"userSelect")}if(d3_event_dragSelect){var style=d3_documentElement(node).style,select=style[d3_event_dragSelect];style[d3_event_dragSelect]="none"}return function(suppressClick){w.on(name,null);if(d3_event_dragSelect)style[d3_event_dragSelect]=select;if(suppressClick){var off=function(){w.on(click,null)};w.on(click,(function(){d3_eventPreventDefault();off()}),true);setTimeout(off,0)}}}d3.mouse=function(container){return d3_mousePoint(container,d3_eventSource())};var d3_mouse_bug44083=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function d3_mousePoint(container,e){if(e.changedTouches)e=e.changedTouches[0];var svg=container.ownerSVGElement||container;if(svg.createSVGPoint){var point=svg.createSVGPoint();if(d3_mouse_bug44083<0){var window=d3_window(container);if(window.scrollX||window.scrollY){svg=d3.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var ctm=svg[0][0].getScreenCTM();d3_mouse_bug44083=!(ctm.f||ctm.e);svg.remove()}}if(d3_mouse_bug44083)point.x=e.pageX,point.y=e.pageY;else point.x=e.clientX,point.y=e.clientY;point=point.matrixTransform(container.getScreenCTM().inverse());return[point.x,point.y]}var rect=container.getBoundingClientRect();return[e.clientX-rect.left-container.clientLeft,e.clientY-rect.top-container.clientTop]}d3.touch=function(container,touches,identifier){if(arguments.length<3)identifier=touches,touches=d3_eventSource().changedTouches;if(touches)for(var i=0,n=touches.length,touch;i<n;++i){if((touch=touches[i]).identifier===identifier){return d3_mousePoint(container,touch)}}};d3.behavior.drag=function(){var event=d3_eventDispatch(drag,"drag","dragstart","dragend"),origin=null,mousedown=dragstart(d3_noop,d3.mouse,d3_window,"mousemove","mouseup"),touchstart=dragstart(d3_behavior_dragTouchId,d3.touch,d3_identity,"touchmove","touchend");function drag(){this.on("mousedown.drag",mousedown).on("touchstart.drag",touchstart)}function dragstart(id,position,subject,move,end){return function(){var that=this,target=d3.event.target.correspondingElement||d3.event.target,parent=that.parentNode,dispatch=event.of(that,arguments),dragged=0,dragId=id(),dragName=".drag"+(dragId==null?"":"-"+dragId),dragOffset,dragSubject=d3.select(subject(target)).on(move+dragName,moved).on(end+dragName,ended),dragRestore=d3_event_dragSuppress(target),position0=position(parent,dragId);if(origin){dragOffset=origin.apply(that,arguments);dragOffset=[dragOffset.x-position0[0],dragOffset.y-position0[1]]}else{dragOffset=[0,0]}dispatch({type:"dragstart"});function moved(){var position1=position(parent,dragId),dx,dy;if(!position1)return;dx=position1[0]-position0[0];dy=position1[1]-position0[1];dragged|=dx|dy;position0=position1;dispatch({type:"drag",x:position1[0]+dragOffset[0],y:position1[1]+dragOffset[1],dx:dx,dy:dy})}function ended(){if(!position(parent,dragId))return;dragSubject.on(move+dragName,null).on(end+dragName,null);dragRestore(dragged);dispatch({type:"dragend"})}}}drag.origin=function(x){if(!arguments.length)return origin;origin=x;return drag};return d3.rebind(drag,event,"on")};function d3_behavior_dragTouchId(){return d3.event.changedTouches[0].identifier}d3.touches=function(container,touches){if(arguments.length<2)touches=d3_eventSource().touches;return touches?d3_array(touches).map((function(touch){var point=d3_mousePoint(container,touch);point.identifier=touch.identifier;return point})):[]};var ε=1e-6,ε2=ε*ε,π=Math.PI,τ=2*π,τε=τ-ε,halfπ=π/2,d3_radians=π/180,d3_degrees=180/π;function d3_sgn(x){return x>0?1:x<0?-1:0}function d3_cross2d(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function d3_acos(x){return x>1?0:x<-1?π:Math.acos(x)}function d3_asin(x){return x>1?halfπ:x<-1?-halfπ:Math.asin(x)}function d3_sinh(x){return((x=Math.exp(x))-1/x)/2}function d3_cosh(x){return((x=Math.exp(x))+1/x)/2}function d3_tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}function d3_haversin(x){return(x=Math.sin(x/2))*x}var ρ=Math.SQRT2,ρ2=2,ρ4=4;d3.interpolateZoom=function(p0,p1){var ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy,i,S;if(d2<ε2){S=Math.log(w1/w0)/ρ;i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(ρ*t*S)]}}else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+ρ4*d2)/(2*w0*ρ2*d1),b1=(w1*w1-w0*w0-ρ4*d2)/(2*w1*ρ2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/ρ;i=function(t){var s=t*S,coshr0=d3_cosh(r0),u=w0/(ρ2*d1)*(coshr0*d3_tanh(ρ*s+r0)-d3_sinh(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/d3_cosh(ρ*s+r0)]}}i.duration=S*1e3;return i};d3.behavior.zoom=function(){var view={x:0,y:0,k:1},translate0,center0,center,size=[960,500],scaleExtent=d3_behavior_zoomInfinity,duration=250,zooming=0,mousedown="mousedown.zoom",mousemove="mousemove.zoom",mouseup="mouseup.zoom",mousewheelTimer,touchstart="touchstart.zoom",touchtime,event=d3_eventDispatch(zoom,"zoomstart","zoom","zoomend"),x0,x1,y0,y1;if(!d3_behavior_zoomWheel){d3_behavior_zoomWheel="onwheel"in d3_document?(d3_behavior_zoomDelta=function(){return-d3.event.deltaY*(d3.event.deltaMode?120:1)},"wheel"):"onmousewheel"in d3_document?(d3_behavior_zoomDelta=function(){return d3.event.wheelDelta},"mousewheel"):(d3_behavior_zoomDelta=function(){return-d3.event.detail},"MozMousePixelScroll")}function zoom(g){g.on(mousedown,mousedowned).on(d3_behavior_zoomWheel+".zoom",mousewheeled).on("dblclick.zoom",dblclicked).on(touchstart,touchstarted)}zoom.event=function(g){g.each((function(){var dispatch=event.of(this,arguments),view1=view;if(d3_transitionInheritId){d3.select(this).transition().each("start.zoom",(function(){view=this.__chart__||{x:0,y:0,k:1};zoomstarted(dispatch)})).tween("zoom:zoom",(function(){var dx=size[0],dy=size[1],cx=center0?center0[0]:dx/2,cy=center0?center0[1]:dy/2,i=d3.interpolateZoom([(cx-view.x)/view.k,(cy-view.y)/view.k,dx/view.k],[(cx-view1.x)/view1.k,(cy-view1.y)/view1.k,dx/view1.k]);return function(t){var l=i(t),k=dx/l[2];this.__chart__=view={x:cx-l[0]*k,y:cy-l[1]*k,k:k};zoomed(dispatch)}})).each("interrupt.zoom",(function(){zoomended(dispatch)})).each("end.zoom",(function(){zoomended(dispatch)}))}else{this.__chart__=view;zoomstarted(dispatch);zoomed(dispatch);zoomended(dispatch)}}))};zoom.translate=function(_){if(!arguments.length)return[view.x,view.y];view={x:+_[0],y:+_[1],k:view.k};rescale();return zoom};zoom.scale=function(_){if(!arguments.length)return view.k;view={x:view.x,y:view.y,k:null};scaleTo(+_);rescale();return zoom};zoom.scaleExtent=function(_){if(!arguments.length)return scaleExtent;scaleExtent=_==null?d3_behavior_zoomInfinity:[+_[0],+_[1]];return zoom};zoom.center=function(_){if(!arguments.length)return center;center=_&&[+_[0],+_[1]];return zoom};zoom.size=function(_){if(!arguments.length)return size;size=_&&[+_[0],+_[1]];return zoom};zoom.duration=function(_){if(!arguments.length)return duration;duration=+_;return zoom};zoom.x=function(z){if(!arguments.length)return x1;x1=z;x0=z.copy();view={x:0,y:0,k:1};return zoom};zoom.y=function(z){if(!arguments.length)return y1;y1=z;y0=z.copy();view={x:0,y:0,k:1};return zoom};function location(p){return[(p[0]-view.x)/view.k,(p[1]-view.y)/view.k]}function point(l){return[l[0]*view.k+view.x,l[1]*view.k+view.y]}function scaleTo(s){view.k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],s))}function translateTo(p,l){l=point(l);view.x+=p[0]-l[0];view.y+=p[1]-l[1]}function zoomTo(that,p,l,k){that.__chart__={x:view.x,y:view.y,k:view.k};scaleTo(Math.pow(2,k));translateTo(center0=p,l);that=d3.select(that);if(duration>0)that=that.transition().duration(duration);that.call(zoom.event)}function rescale(){if(x1)x1.domain(x0.range().map((function(x){return(x-view.x)/view.k})).map(x0.invert));if(y1)y1.domain(y0.range().map((function(y){return(y-view.y)/view.k})).map(y0.invert))}function zoomstarted(dispatch){if(!zooming++)dispatch({type:"zoomstart"})}function zoomed(dispatch){rescale();dispatch({type:"zoom",scale:view.k,translate:[view.x,view.y]})}function zoomended(dispatch){if(!--zooming)dispatch({type:"zoomend"}),center0=null}function mousedowned(){var that=this,dispatch=event.of(that,arguments),dragged=0,subject=d3.select(d3_window(that)).on(mousemove,moved).on(mouseup,ended),location0=location(d3.mouse(that)),dragRestore=d3_event_dragSuppress(that);d3_selection_interrupt.call(that);zoomstarted(dispatch);function moved(){dragged=1;translateTo(d3.mouse(that),location0);zoomed(dispatch)}function ended(){subject.on(mousemove,null).on(mouseup,null);dragRestore(dragged);zoomended(dispatch)}}function touchstarted(){var that=this,dispatch=event.of(that,arguments),locations0={},distance0=0,scale0,zoomName=".zoom-"+d3.event.changedTouches[0].identifier,touchmove="touchmove"+zoomName,touchend="touchend"+zoomName,targets=[],subject=d3.select(that),dragRestore=d3_event_dragSuppress(that);started();zoomstarted(dispatch);subject.on(mousedown,null).on(touchstart,started);function relocate(){var touches=d3.touches(that);scale0=view.k;touches.forEach((function(t){if(t.identifier in locations0)locations0[t.identifier]=location(t)}));return touches}function started(){var target=d3.event.target;d3.select(target).on(touchmove,moved).on(touchend,ended);targets.push(target);var changed=d3.event.changedTouches;for(var i=0,n=changed.length;i<n;++i){locations0[changed[i].identifier]=null}var touches=relocate(),now=Date.now();if(touches.length===1){if(now-touchtime<500){var p=touches[0];zoomTo(that,p,locations0[p.identifier],Math.floor(Math.log(view.k)/Math.LN2)+1);d3_eventPreventDefault()}touchtime=now}else if(touches.length>1){var p=touches[0],q=touches[1],dx=p[0]-q[0],dy=p[1]-q[1];distance0=dx*dx+dy*dy}}function moved(){var touches=d3.touches(that),p0,l0,p1,l1;d3_selection_interrupt.call(that);for(var i=0,n=touches.length;i<n;++i,l1=null){p1=touches[i];if(l1=locations0[p1.identifier]){if(l0)break;p0=p1,l0=l1}}if(l1){var distance1=(distance1=p1[0]-p0[0])*distance1+(distance1=p1[1]-p0[1])*distance1,scale1=distance0&&Math.sqrt(distance1/distance0);p0=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2];l0=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2];scaleTo(scale1*scale0)}touchtime=null;translateTo(p0,l0);zoomed(dispatch)}function ended(){if(d3.event.touches.length){var changed=d3.event.changedTouches;for(var i=0,n=changed.length;i<n;++i){delete locations0[changed[i].identifier]}for(var identifier in locations0){return void relocate()}}d3.selectAll(targets).on(zoomName,null);subject.on(mousedown,mousedowned).on(touchstart,touchstarted);dragRestore();zoomended(dispatch)}}function mousewheeled(){var dispatch=event.of(this,arguments);if(mousewheelTimer)clearTimeout(mousewheelTimer);else d3_selection_interrupt.call(this),translate0=location(center0=center||d3.mouse(this)),zoomstarted(dispatch);mousewheelTimer=setTimeout((function(){mousewheelTimer=null;zoomended(dispatch)}),50);d3_eventPreventDefault();scaleTo(Math.pow(2,d3_behavior_zoomDelta()*.002)*view.k);translateTo(center0,translate0);zoomed(dispatch)}function dblclicked(){var p=d3.mouse(this),k=Math.log(view.k)/Math.LN2;zoomTo(this,p,location(p),d3.event.shiftKey?Math.ceil(k)-1:Math.floor(k)+1)}return d3.rebind(zoom,event,"on")};var d3_behavior_zoomInfinity=[0,Infinity],d3_behavior_zoomDelta,d3_behavior_zoomWheel;d3.color=d3_color;function d3_color(){}d3_color.prototype.toString=function(){return this.rgb()+""};d3.hsl=d3_hsl;function d3_hsl(h,s,l){return this instanceof d3_hsl?void(this.h=+h,this.s=+s,this.l=+l):arguments.length<2?h instanceof d3_hsl?new d3_hsl(h.h,h.s,h.l):d3_rgb_parse(""+h,d3_rgb_hsl,d3_hsl):new d3_hsl(h,s,l)}var d3_hslPrototype=d3_hsl.prototype=new d3_color;d3_hslPrototype.brighter=function(k){k=Math.pow(.7,arguments.length?k:1);return new d3_hsl(this.h,this.s,this.l/k)};d3_hslPrototype.darker=function(k){k=Math.pow(.7,arguments.length?k:1);return new d3_hsl(this.h,this.s,k*this.l)};d3_hslPrototype.rgb=function(){return d3_hsl_rgb(this.h,this.s,this.l)};function d3_hsl_rgb(h,s,l){var m1,m2;h=isNaN(h)?0:(h%=360)<0?h+360:h;s=isNaN(s)?0:s<0?0:s>1?1:s;l=l<0?0:l>1?1:l;m2=l<=.5?l*(1+s):l+s-l*s;m1=2*l-m2;function v(h){if(h>360)h-=360;else if(h<0)h+=360;if(h<60)return m1+(m2-m1)*h/60;if(h<180)return m2;if(h<240)return m1+(m2-m1)*(240-h)/60;return m1}function vv(h){return Math.round(v(h)*255)}return new d3_rgb(vv(h+120),vv(h),vv(h-120))}d3.hcl=d3_hcl;function d3_hcl(h,c,l){return this instanceof d3_hcl?void(this.h=+h,this.c=+c,this.l=+l):arguments.length<2?h instanceof d3_hcl?new d3_hcl(h.h,h.c,h.l):h instanceof d3_lab?d3_lab_hcl(h.l,h.a,h.b):d3_lab_hcl((h=d3_rgb_lab((h=d3.rgb(h)).r,h.g,h.b)).l,h.a,h.b):new d3_hcl(h,c,l)}var d3_hclPrototype=d3_hcl.prototype=new d3_color;d3_hclPrototype.brighter=function(k){return new d3_hcl(this.h,this.c,Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)))};d3_hclPrototype.darker=function(k){return new d3_hcl(this.h,this.c,Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)))};d3_hclPrototype.rgb=function(){return d3_hcl_lab(this.h,this.c,this.l).rgb()};function d3_hcl_lab(h,c,l){if(isNaN(h))h=0;if(isNaN(c))c=0;return new d3_lab(l,Math.cos(h*=d3_radians)*c,Math.sin(h)*c)}d3.lab=d3_lab;function d3_lab(l,a,b){return this instanceof d3_lab?void(this.l=+l,this.a=+a,this.b=+b):arguments.length<2?l instanceof d3_lab?new d3_lab(l.l,l.a,l.b):l instanceof d3_hcl?d3_hcl_lab(l.h,l.c,l.l):d3_rgb_lab((l=d3_rgb(l)).r,l.g,l.b):new d3_lab(l,a,b)}var d3_lab_K=18;var d3_lab_X=.95047,d3_lab_Y=1,d3_lab_Z=1.08883;var d3_labPrototype=d3_lab.prototype=new d3_color;d3_labPrototype.brighter=function(k){return new d3_lab(Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)),this.a,this.b)};d3_labPrototype.darker=function(k){return new d3_lab(Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)),this.a,this.b)};d3_labPrototype.rgb=function(){return d3_lab_rgb(this.l,this.a,this.b)};function d3_lab_rgb(l,a,b){var y=(l+16)/116,x=y+a/500,z=y-b/200;x=d3_lab_xyz(x)*d3_lab_X;y=d3_lab_xyz(y)*d3_lab_Y;z=d3_lab_xyz(z)*d3_lab_Z;return new d3_rgb(d3_xyz_rgb(3.2404542*x-1.5371385*y-.4985314*z),d3_xyz_rgb(-.969266*x+1.8760108*y+.041556*z),d3_xyz_rgb(.0556434*x-.2040259*y+1.0572252*z))}function d3_lab_hcl(l,a,b){return l>0?new d3_hcl(Math.atan2(b,a)*d3_degrees,Math.sqrt(a*a+b*b),l):new d3_hcl(NaN,NaN,l)}function d3_lab_xyz(x){return x>.206893034?x*x*x:(x-4/29)/7.787037}function d3_xyz_lab(x){return x>.008856?Math.pow(x,1/3):7.787037*x+4/29}function d3_xyz_rgb(r){return Math.round(255*(r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055))}d3.rgb=d3_rgb;function d3_rgb(r,g,b){return this instanceof d3_rgb?void(this.r=~~r,this.g=~~g,this.b=~~b):arguments.length<2?r instanceof d3_rgb?new d3_rgb(r.r,r.g,r.b):d3_rgb_parse(""+r,d3_rgb,d3_hsl_rgb):new d3_rgb(r,g,b)}function d3_rgbNumber(value){return new d3_rgb(value>>16,value>>8&255,value&255)}function d3_rgbString(value){return d3_rgbNumber(value)+""}var d3_rgbPrototype=d3_rgb.prototype=new d3_color;d3_rgbPrototype.brighter=function(k){k=Math.pow(.7,arguments.length?k:1);var r=this.r,g=this.g,b=this.b,i=30;if(!r&&!g&&!b)return new d3_rgb(i,i,i);if(r&&r<i)r=i;if(g&&g<i)g=i;if(b&&b<i)b=i;return new d3_rgb(Math.min(255,r/k),Math.min(255,g/k),Math.min(255,b/k))};d3_rgbPrototype.darker=function(k){k=Math.pow(.7,arguments.length?k:1);return new d3_rgb(k*this.r,k*this.g,k*this.b)};d3_rgbPrototype.hsl=function(){return d3_rgb_hsl(this.r,this.g,this.b)};d3_rgbPrototype.toString=function(){return"#"+d3_rgb_hex(this.r)+d3_rgb_hex(this.g)+d3_rgb_hex(this.b)};function d3_rgb_hex(v){return v<16?"0"+Math.max(0,v).toString(16):Math.min(255,v).toString(16)}function d3_rgb_parse(format,rgb,hsl){var r=0,g=0,b=0,m1,m2,color;m1=/([a-z]+)\((.*)\)/.exec(format=format.toLowerCase());if(m1){m2=m1[2].split(",");switch(m1[1]){case"hsl":{return hsl(parseFloat(m2[0]),parseFloat(m2[1])/100,parseFloat(m2[2])/100)}case"rgb":{return rgb(d3_rgb_parseNumber(m2[0]),d3_rgb_parseNumber(m2[1]),d3_rgb_parseNumber(m2[2]))}}}if(color=d3_rgb_names.get(format)){return rgb(color.r,color.g,color.b)}if(format!=null&&format.charAt(0)==="#"&&!isNaN(color=parseInt(format.slice(1),16))){if(format.length===4){r=(color&3840)>>4;r=r>>4|r;g=color&240;g=g>>4|g;b=color&15;b=b<<4|b}else if(format.length===7){r=(color&16711680)>>16;g=(color&65280)>>8;b=color&255}}return rgb(r,g,b)}function d3_rgb_hsl(r,g,b){var min=Math.min(r/=255,g/=255,b/=255),max=Math.max(r,g,b),d=max-min,h,s,l=(max+min)/2;if(d){s=l<.5?d/(max+min):d/(2-max-min);if(r==max)h=(g-b)/d+(g<b?6:0);else if(g==max)h=(b-r)/d+2;else h=(r-g)/d+4;h*=60}else{h=NaN;s=l>0&&l<1?0:h}return new d3_hsl(h,s,l)}function d3_rgb_lab(r,g,b){r=d3_rgb_xyz(r);g=d3_rgb_xyz(g);b=d3_rgb_xyz(b);var x=d3_xyz_lab((.4124564*r+.3575761*g+.1804375*b)/d3_lab_X),y=d3_xyz_lab((.2126729*r+.7151522*g+.072175*b)/d3_lab_Y),z=d3_xyz_lab((.0193339*r+.119192*g+.9503041*b)/d3_lab_Z);return d3_lab(116*y-16,500*(x-y),200*(y-z))}function d3_rgb_xyz(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function d3_rgb_parseNumber(c){var f=parseFloat(c);return c.charAt(c.length-1)==="%"?Math.round(f*2.55):f}var d3_rgb_names=d3.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});d3_rgb_names.forEach((function(key,value){d3_rgb_names.set(key,d3_rgbNumber(value))}));function d3_functor(v){return typeof v==="function"?v:function(){return v}}d3.functor=d3_functor;d3.xhr=d3_xhrType(d3_identity);function d3_xhrType(response){return function(url,mimeType,callback){if(arguments.length===2&&typeof mimeType==="function")callback=mimeType,mimeType=null;return d3_xhr(url,mimeType,response,callback)}}function d3_xhr(url,mimeType,response,callback){var xhr={},dispatch=d3.dispatch("beforesend","progress","load","error"),headers={},request=new XMLHttpRequest,responseType=null;if(this.XDomainRequest&&!("withCredentials"in request)&&/^(http(s)?:)?\/\//.test(url))request=new XDomainRequest;"onload"in request?request.onload=request.onerror=respond:request.onreadystatechange=function(){request.readyState>3&&respond()};function respond(){var status=request.status,result;if(!status&&d3_xhrHasResponse(request)||status>=200&&status<300||status===304){try{result=response.call(xhr,request)}catch(e){dispatch.error.call(xhr,e);return}dispatch.load.call(xhr,result)}else{dispatch.error.call(xhr,request)}}request.onprogress=function(event){var o=d3.event;d3.event=event;try{dispatch.progress.call(xhr,request)}finally{d3.event=o}};xhr.header=function(name,value){name=(name+"").toLowerCase();if(arguments.length<2)return headers[name];if(value==null)delete headers[name];else headers[name]=value+"";return xhr};xhr.mimeType=function(value){if(!arguments.length)return mimeType;mimeType=value==null?null:value+"";return xhr};xhr.responseType=function(value){if(!arguments.length)return responseType;responseType=value;return xhr};xhr.response=function(value){response=value;return xhr};["get","post"].forEach((function(method){xhr[method]=function(){return xhr.send.apply(xhr,[method].concat(d3_array(arguments)))}}));xhr.send=function(method,data,callback){if(arguments.length===2&&typeof data==="function")callback=data,data=null;request.open(method,url,true);if(mimeType!=null&&!("accept"in headers))headers["accept"]=mimeType+",*/*";if(request.setRequestHeader)for(var name in headers)request.setRequestHeader(name,headers[name]);if(mimeType!=null&&request.overrideMimeType)request.overrideMimeType(mimeType);if(responseType!=null)request.responseType=responseType;if(callback!=null)xhr.on("error",callback).on("load",(function(request){callback(null,request)}));dispatch.beforesend.call(xhr,request);request.send(data==null?null:data);return xhr};xhr.abort=function(){request.abort();return xhr};d3.rebind(xhr,dispatch,"on");return callback==null?xhr:xhr.get(d3_xhr_fixCallback(callback))}function d3_xhr_fixCallback(callback){return callback.length===1?function(error,request){callback(error==null?request:null)}:callback}function d3_xhrHasResponse(request){var type=request.responseType;return type&&type!=="text"?request.response:request.responseText}d3.dsv=function(delimiter,mimeType){var reFormat=new RegExp('["'+delimiter+"\n]"),delimiterCode=delimiter.charCodeAt(0);function dsv(url,row,callback){if(arguments.length<3)callback=row,row=null;var xhr=d3_xhr(url,mimeType,row==null?response:typedResponse(row),callback);xhr.row=function(_){return arguments.length?xhr.response((row=_)==null?response:typedResponse(_)):row};return xhr}function response(request){return dsv.parse(request.responseText)}function typedResponse(f){return function(request){return dsv.parse(request.responseText,f)}}dsv.parse=function(text,f){var o;return dsv.parseRows(text,(function(row,i){if(o)return o(row,i-1);var a=new Function("d","return {"+row.map((function(name,i){return JSON.stringify(name)+": d["+i+"]"})).join(",")+"}");o=f?function(row,i){return f(a(row),i)}:a}))};dsv.parseRows=function(text,f){var EOL={},EOF={},rows=[],N=text.length,I=0,n=0,t,eol;function token(){if(I>=N)return EOF;if(eol)return eol=false,EOL;var j=I;if(text.charCodeAt(j)===34){var i=j;while(i++<N){if(text.charCodeAt(i)===34){if(text.charCodeAt(i+1)!==34)break;++i}}I=i+2;var c=text.charCodeAt(i+1);if(c===13){eol=true;if(text.charCodeAt(i+2)===10)++I}else if(c===10){eol=true}return text.slice(j+1,i).replace(/""/g,'"')}while(I<N){var c=text.charCodeAt(I++),k=1;if(c===10)eol=true;else if(c===13){eol=true;if(text.charCodeAt(I)===10)++I,++k}else if(c!==delimiterCode)continue;return text.slice(j,I-k)}return text.slice(j)}while((t=token())!==EOF){var a=[];while(t!==EOL&&t!==EOF){a.push(t);t=token()}if(f&&(a=f(a,n++))==null)continue;rows.push(a)}return rows};dsv.format=function(rows){if(Array.isArray(rows[0]))return dsv.formatRows(rows);var fieldSet=new d3_Set,fields=[];rows.forEach((function(row){for(var field in row){if(!fieldSet.has(field)){fields.push(fieldSet.add(field))}}}));return[fields.map(formatValue).join(delimiter)].concat(rows.map((function(row){return fields.map((function(field){return formatValue(row[field])})).join(delimiter)}))).join("\n")};dsv.formatRows=function(rows){return rows.map(formatRow).join("\n")};function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(text){return reFormat.test(text)?'"'+text.replace(/\"/g,'""')+'"':text}return dsv};d3.csv=d3.dsv(",","text/csv");d3.tsv=d3.dsv("\t","text/tab-separated-values");var d3_timer_queueHead,d3_timer_queueTail,d3_timer_interval,d3_timer_timeout,d3_timer_frame=this[d3_vendorSymbol(this,"requestAnimationFrame")]||function(callback){setTimeout(callback,17)};d3.timer=function(){d3_timer.apply(this,arguments)};function d3_timer(callback,delay,then){var n=arguments.length;if(n<2)delay=0;if(n<3)then=Date.now();var time=then+delay,timer={c:callback,t:time,n:null};if(d3_timer_queueTail)d3_timer_queueTail.n=timer;else d3_timer_queueHead=timer;d3_timer_queueTail=timer;if(!d3_timer_interval){d3_timer_timeout=clearTimeout(d3_timer_timeout);d3_timer_interval=1;d3_timer_frame(d3_timer_step)}return timer}function d3_timer_step(){var now=d3_timer_mark(),delay=d3_timer_sweep()-now;if(delay>24){if(isFinite(delay)){clearTimeout(d3_timer_timeout);d3_timer_timeout=setTimeout(d3_timer_step,delay)}d3_timer_interval=0}else{d3_timer_interval=1;d3_timer_frame(d3_timer_step)}}d3.timer.flush=function(){d3_timer_mark();d3_timer_sweep()};function d3_timer_mark(){var now=Date.now(),timer=d3_timer_queueHead;while(timer){if(now>=timer.t&&timer.c(now-timer.t))timer.c=null;timer=timer.n}return now}function d3_timer_sweep(){var t0,t1=d3_timer_queueHead,time=Infinity;while(t1){if(t1.c){if(t1.t<time)time=t1.t;t1=(t0=t1).n}else{t1=t0?t0.n=t1.n:d3_timer_queueHead=t1.n}}d3_timer_queueTail=t0;return time}function d3_format_precision(x,p){return p-(x?Math.ceil(Math.log(x)/Math.LN10):1)}d3.round=function(x,n){return n?Math.round(x*(n=Math.pow(10,n)))/n:Math.round(x)};var d3_formatPrefixes=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(d3_formatPrefix);d3.formatPrefix=function(value,precision){var i=0;if(value=+value){if(value<0)value*=-1;if(precision)value=d3.round(value,d3_format_precision(value,precision));i=1+Math.floor(1e-12+Math.log(value)/Math.LN10);i=Math.max(-24,Math.min(24,Math.floor((i-1)/3)*3))}return d3_formatPrefixes[8+i/3]};function d3_formatPrefix(d,i){var k=Math.pow(10,abs(8-i)*3);return{scale:i>8?function(d){return d/k}:function(d){return d*k},symbol:d}}function d3_locale_numberFormat(locale){var locale_decimal=locale.decimal,locale_thousands=locale.thousands,locale_grouping=locale.grouping,locale_currency=locale.currency,formatGroup=locale_grouping&&locale_thousands?function(value,width){var i=value.length,t=[],j=0,g=locale_grouping[0],length=0;while(i>0&&g>0){if(length+g+1>width)g=Math.max(1,width-length);t.push(value.substring(i-=g,i+g));if((length+=g+1)>width)break;g=locale_grouping[j=(j+1)%locale_grouping.length]}return t.reverse().join(locale_thousands)}:d3_identity;return function(specifier){var match=d3_format_re.exec(specifier),fill=match[1]||" ",align=match[2]||">",sign=match[3]||"-",symbol=match[4]||"",zfill=match[5],width=+match[6],comma=match[7],precision=match[8],type=match[9],scale=1,prefix="",suffix="",integer=false,exponent=true;if(precision)precision=+precision.substring(1);if(zfill||fill==="0"&&align==="="){zfill=fill="0";align="="}switch(type){case"n":comma=true;type="g";break;case"%":scale=100;suffix="%";type="f";break;case"p":scale=100;suffix="%";type="r";break;case"b":case"o":case"x":case"X":if(symbol==="#")prefix="0"+type.toLowerCase();case"c":exponent=false;case"d":integer=true;precision=0;break;case"s":scale=-1;type="r";break}if(symbol==="$")prefix=locale_currency[0],suffix=locale_currency[1];if(type=="r"&&!precision)type="g";if(precision!=null){if(type=="g")precision=Math.max(1,Math.min(21,precision));else if(type=="e"||type=="f")precision=Math.max(0,Math.min(20,precision))}type=d3_format_types.get(type)||d3_format_typeDefault;var zcomma=zfill&&comma;return function(value){var fullSuffix=suffix;if(integer&&value%1)return"";var negative=value<0||value===0&&1/value<0?(value=-value,"-"):sign==="-"?"":sign;if(scale<0){var unit=d3.formatPrefix(value,precision);value=unit.scale(value);fullSuffix=unit.symbol+suffix}else{value*=scale}value=type(value,precision);var i=value.lastIndexOf("."),before,after;if(i<0){var j=exponent?value.lastIndexOf("e"):-1;if(j<0)before=value,after="";else before=value.substring(0,j),after=value.substring(j)}else{before=value.substring(0,i);after=locale_decimal+value.substring(i+1)}if(!zfill&&comma)before=formatGroup(before,Infinity);var length=prefix.length+before.length+after.length+(zcomma?0:negative.length),padding=length<width?new Array(length=width-length+1).join(fill):"";if(zcomma)before=formatGroup(padding+before,padding.length?width-after.length:Infinity);negative+=prefix;value=before+after;return(align==="<"?negative+value+padding:align===">"?padding+negative+value:align==="^"?padding.substring(0,length>>=1)+negative+value+padding.substring(length):negative+(zcomma?value:padding+value))+fullSuffix}}}var d3_format_re=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;var d3_format_types=d3.map({b:function(x){return x.toString(2)},c:function(x){return String.fromCharCode(x)},o:function(x){return x.toString(8)},x:function(x){return x.toString(16)},X:function(x){return x.toString(16).toUpperCase()},g:function(x,p){return x.toPrecision(p)},e:function(x,p){return x.toExponential(p)},f:function(x,p){return x.toFixed(p)},r:function(x,p){return(x=d3.round(x,d3_format_precision(x,p))).toFixed(Math.max(0,Math.min(20,d3_format_precision(x*(1+1e-15),p))))}});function d3_format_typeDefault(x){return x+""}var d3_time=d3.time={},d3_date=Date;function d3_date_utc(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}d3_date_utc.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){d3_time_prototype.setUTCDate.apply(this._,arguments)},setDay:function(){d3_time_prototype.setUTCDay.apply(this._,arguments)},setFullYear:function(){d3_time_prototype.setUTCFullYear.apply(this._,arguments)},setHours:function(){d3_time_prototype.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){d3_time_prototype.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){d3_time_prototype.setUTCMinutes.apply(this._,arguments)},setMonth:function(){d3_time_prototype.setUTCMonth.apply(this._,arguments)},setSeconds:function(){d3_time_prototype.setUTCSeconds.apply(this._,arguments)},setTime:function(){d3_time_prototype.setTime.apply(this._,arguments)}};var d3_time_prototype=Date.prototype;function d3_time_interval(local,step,number){function round(date){var d0=local(date),d1=offset(d0,1);return date-d0<d1-date?d0:d1}function ceil(date){step(date=local(new d3_date(date-1)),1);return date}function offset(date,k){step(date=new d3_date(+date),k);return date}function range(t0,t1,dt){var time=ceil(t0),times=[];if(dt>1){while(time<t1){if(!(number(time)%dt))times.push(new Date(+time));step(time,1)}}else{while(time<t1)times.push(new Date(+time)),step(time,1)}return times}function range_utc(t0,t1,dt){try{d3_date=d3_date_utc;var utc=new d3_date_utc;utc._=t0;return range(utc,t1,dt)}finally{d3_date=Date}}local.floor=local;local.round=round;local.ceil=ceil;local.offset=offset;local.range=range;var utc=local.utc=d3_time_interval_utc(local);utc.floor=utc;utc.round=d3_time_interval_utc(round);utc.ceil=d3_time_interval_utc(ceil);utc.offset=d3_time_interval_utc(offset);utc.range=range_utc;return local}function d3_time_interval_utc(method){return function(date,k){try{d3_date=d3_date_utc;var utc=new d3_date_utc;utc._=date;return method(utc,k)._}finally{d3_date=Date}}}d3_time.year=d3_time_interval((function(date){date=d3_time.day(date);date.setMonth(0,1);return date}),(function(date,offset){date.setFullYear(date.getFullYear()+offset)}),(function(date){return date.getFullYear()}));d3_time.years=d3_time.year.range;d3_time.years.utc=d3_time.year.utc.range;d3_time.day=d3_time_interval((function(date){var day=new d3_date(2e3,0);day.setFullYear(date.getFullYear(),date.getMonth(),date.getDate());return day}),(function(date,offset){date.setDate(date.getDate()+offset)}),(function(date){return date.getDate()-1}));d3_time.days=d3_time.day.range;d3_time.days.utc=d3_time.day.utc.range;d3_time.dayOfYear=function(date){var year=d3_time.year(date);return Math.floor((date-year-(date.getTimezoneOffset()-year.getTimezoneOffset())*6e4)/864e5)};["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach((function(day,i){i=7-i;var interval=d3_time[day]=d3_time_interval((function(date){(date=d3_time.day(date)).setDate(date.getDate()-(date.getDay()+i)%7);return date}),(function(date,offset){date.setDate(date.getDate()+Math.floor(offset)*7)}),(function(date){var day=d3_time.year(date).getDay();return Math.floor((d3_time.dayOfYear(date)+(day+i)%7)/7)-(day!==i)}));d3_time[day+"s"]=interval.range;d3_time[day+"s"].utc=interval.utc.range;d3_time[day+"OfYear"]=function(date){var day=d3_time.year(date).getDay();return Math.floor((d3_time.dayOfYear(date)+(day+i)%7)/7)}}));d3_time.week=d3_time.sunday;d3_time.weeks=d3_time.sunday.range;d3_time.weeks.utc=d3_time.sunday.utc.range;d3_time.weekOfYear=d3_time.sundayOfYear;function d3_locale_timeFormat(locale){var locale_dateTime=locale.dateTime,locale_date=locale.date,locale_time=locale.time,locale_periods=locale.periods,locale_days=locale.days,locale_shortDays=locale.shortDays,locale_months=locale.months,locale_shortMonths=locale.shortMonths;function d3_time_format(template){var n=template.length;function format(date){var string=[],i=-1,j=0,c,p,f;while(++i<n){if(template.charCodeAt(i)===37){string.push(template.slice(j,i));if((p=d3_time_formatPads[c=template.charAt(++i)])!=null)c=template.charAt(++i);if(f=d3_time_formats[c])c=f(date,p==null?c==="e"?" ":"0":p);string.push(c);j=i+1}}string.push(template.slice(j,i));return string.join("")}format.parse=function(string){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=d3_time_parse(d,template,string,0);if(i!=string.length)return null;if("p"in d)d.H=d.H%12+d.p*12;var localZ=d.Z!=null&&d3_date!==d3_date_utc,date=new(localZ?d3_date_utc:d3_date);if("j"in d)date.setFullYear(d.y,0,d.j);else if("W"in d||"U"in d){if(!("w"in d))d.w="W"in d?1:0;date.setFullYear(d.y,0,1);date.setFullYear(d.y,0,"W"in d?(d.w+6)%7+d.W*7-(date.getDay()+5)%7:d.w+d.U*7-(date.getDay()+6)%7)}else date.setFullYear(d.y,d.m,d.d);date.setHours(d.H+(d.Z/100|0),d.M+d.Z%100,d.S,d.L);return localZ?date._:date};format.toString=function(){return template};return format}function d3_time_parse(date,template,string,j){var c,p,t,i=0,n=template.length,m=string.length;while(i<n){if(j>=m)return-1;c=template.charCodeAt(i++);if(c===37){t=template.charAt(i++);p=d3_time_parsers[t in d3_time_formatPads?template.charAt(i++):t];if(!p||(j=p(date,string,j))<0)return-1}else if(c!=string.charCodeAt(j++)){return-1}}return j}d3_time_format.utc=function(template){var local=d3_time_format(template);function format(date){try{d3_date=d3_date_utc;var utc=new d3_date;utc._=date;return local(utc)}finally{d3_date=Date}}format.parse=function(string){try{d3_date=d3_date_utc;var date=local.parse(string);return date&&date._}finally{d3_date=Date}};format.toString=local.toString;return format};d3_time_format.multi=d3_time_format.utc.multi=d3_time_formatMulti;var d3_time_periodLookup=d3.map(),d3_time_dayRe=d3_time_formatRe(locale_days),d3_time_dayLookup=d3_time_formatLookup(locale_days),d3_time_dayAbbrevRe=d3_time_formatRe(locale_shortDays),d3_time_dayAbbrevLookup=d3_time_formatLookup(locale_shortDays),d3_time_monthRe=d3_time_formatRe(locale_months),d3_time_monthLookup=d3_time_formatLookup(locale_months),d3_time_monthAbbrevRe=d3_time_formatRe(locale_shortMonths),d3_time_monthAbbrevLookup=d3_time_formatLookup(locale_shortMonths);locale_periods.forEach((function(p,i){d3_time_periodLookup.set(p.toLowerCase(),i)}));var d3_time_formats={a:function(d){return locale_shortDays[d.getDay()]},A:function(d){return locale_days[d.getDay()]},b:function(d){return locale_shortMonths[d.getMonth()]},B:function(d){return locale_months[d.getMonth()]},c:d3_time_format(locale_dateTime),d:function(d,p){return d3_time_formatPad(d.getDate(),p,2)},e:function(d,p){return d3_time_formatPad(d.getDate(),p,2)},H:function(d,p){return d3_time_formatPad(d.getHours(),p,2)},I:function(d,p){return d3_time_formatPad(d.getHours()%12||12,p,2)},j:function(d,p){return d3_time_formatPad(1+d3_time.dayOfYear(d),p,3)},L:function(d,p){return d3_time_formatPad(d.getMilliseconds(),p,3)},m:function(d,p){return d3_time_formatPad(d.getMonth()+1,p,2)},M:function(d,p){return d3_time_formatPad(d.getMinutes(),p,2)},p:function(d){return locale_periods[+(d.getHours()>=12)]},S:function(d,p){return d3_time_formatPad(d.getSeconds(),p,2)},U:function(d,p){return d3_time_formatPad(d3_time.sundayOfYear(d),p,2)},w:function(d){return d.getDay()},W:function(d,p){return d3_time_formatPad(d3_time.mondayOfYear(d),p,2)},x:d3_time_format(locale_date),X:d3_time_format(locale_time),y:function(d,p){return d3_time_formatPad(d.getFullYear()%100,p,2)},Y:function(d,p){return d3_time_formatPad(d.getFullYear()%1e4,p,4)},Z:d3_time_zone,"%":function(){return"%"}};var d3_time_parsers={a:d3_time_parseWeekdayAbbrev,A:d3_time_parseWeekday,b:d3_time_parseMonthAbbrev,B:d3_time_parseMonth,c:d3_time_parseLocaleFull,d:d3_time_parseDay,e:d3_time_parseDay,H:d3_time_parseHour24,I:d3_time_parseHour24,j:d3_time_parseDayOfYear,L:d3_time_parseMilliseconds,m:d3_time_parseMonthNumber,M:d3_time_parseMinutes,p:d3_time_parseAmPm,S:d3_time_parseSeconds,U:d3_time_parseWeekNumberSunday,w:d3_time_parseWeekdayNumber,W:d3_time_parseWeekNumberMonday,x:d3_time_parseLocaleDate,X:d3_time_parseLocaleTime,y:d3_time_parseYear,Y:d3_time_parseFullYear,Z:d3_time_parseZone,"%":d3_time_parseLiteralPercent};function d3_time_parseWeekdayAbbrev(date,string,i){d3_time_dayAbbrevRe.lastIndex=0;var n=d3_time_dayAbbrevRe.exec(string.slice(i));return n?(date.w=d3_time_dayAbbrevLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseWeekday(date,string,i){d3_time_dayRe.lastIndex=0;var n=d3_time_dayRe.exec(string.slice(i));return n?(date.w=d3_time_dayLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseMonthAbbrev(date,string,i){d3_time_monthAbbrevRe.lastIndex=0;var n=d3_time_monthAbbrevRe.exec(string.slice(i));return n?(date.m=d3_time_monthAbbrevLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseMonth(date,string,i){d3_time_monthRe.lastIndex=0;var n=d3_time_monthRe.exec(string.slice(i));return n?(date.m=d3_time_monthLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseLocaleFull(date,string,i){return d3_time_parse(date,d3_time_formats.c.toString(),string,i)}function d3_time_parseLocaleDate(date,string,i){return d3_time_parse(date,d3_time_formats.x.toString(),string,i)}function d3_time_parseLocaleTime(date,string,i){return d3_time_parse(date,d3_time_formats.X.toString(),string,i)}function d3_time_parseAmPm(date,string,i){var n=d3_time_periodLookup.get(string.slice(i,i+=2).toLowerCase());return n==null?-1:(date.p=n,i)}return d3_time_format}var d3_time_formatPads={"-":"",_:" ",0:"0"},d3_time_numberRe=/^\s*\d+/,d3_time_percentRe=/^%/;function d3_time_formatPad(value,fill,width){var sign=value<0?"-":"",string=(sign?-value:value)+"",length=string.length;return sign+(length<width?new Array(width-length+1).join(fill)+string:string)}function d3_time_formatRe(names){return new RegExp("^(?:"+names.map(d3.requote).join("|")+")","i")}function d3_time_formatLookup(names){var map=new d3_Map,i=-1,n=names.length;while(++i<n)map.set(names[i].toLowerCase(),i);return map}function d3_time_parseWeekdayNumber(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+1));return n?(date.w=+n[0],i+n[0].length):-1}function d3_time_parseWeekNumberSunday(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i));return n?(date.U=+n[0],i+n[0].length):-1}function d3_time_parseWeekNumberMonday(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i));return n?(date.W=+n[0],i+n[0].length):-1}function d3_time_parseFullYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+4));return n?(date.y=+n[0],i+n[0].length):-1}function d3_time_parseYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.y=d3_time_expandYear(+n[0]),i+n[0].length):-1}function d3_time_parseZone(date,string,i){return/^[+-]\d{4}$/.test(string=string.slice(i,i+5))?(date.Z=-string,i+5):-1}function d3_time_expandYear(d){return d+(d>68?1900:2e3)}function d3_time_parseMonthNumber(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.m=n[0]-1,i+n[0].length):-1}function d3_time_parseDay(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.d=+n[0],i+n[0].length):-1}function d3_time_parseDayOfYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+3));return n?(date.j=+n[0],i+n[0].length):-1}function d3_time_parseHour24(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.H=+n[0],i+n[0].length):-1}function d3_time_parseMinutes(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.M=+n[0],i+n[0].length):-1}function d3_time_parseSeconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.S=+n[0],i+n[0].length):-1}function d3_time_parseMilliseconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+3));return n?(date.L=+n[0],i+n[0].length):-1}function d3_time_zone(d){var z=d.getTimezoneOffset(),zs=z>0?"-":"+",zh=abs(z)/60|0,zm=abs(z)%60;return zs+d3_time_formatPad(zh,"0",2)+d3_time_formatPad(zm,"0",2)}function d3_time_parseLiteralPercent(date,string,i){d3_time_percentRe.lastIndex=0;var n=d3_time_percentRe.exec(string.slice(i,i+1));return n?i+n[0].length:-1}function d3_time_formatMulti(formats){var n=formats.length,i=-1;while(++i<n)formats[i][0]=this(formats[i][0]);return function(date){var i=0,f=formats[i];while(!f[1](date))f=formats[++i];return f[0](date)}}d3.locale=function(locale){return{numberFormat:d3_locale_numberFormat(locale),timeFormat:d3_locale_timeFormat(locale)}};var d3_locale_enUS=d3.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});d3.format=d3_locale_enUS.numberFormat;d3.geo={};function d3_adder(){}d3_adder.prototype={s:0,t:0,add:function(y){d3_adderSum(y,this.t,d3_adderTemp);d3_adderSum(d3_adderTemp.s,this.s,this);if(this.s)this.t+=d3_adderTemp.t;else this.s=d3_adderTemp.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var d3_adderTemp=new d3_adder;function d3_adderSum(a,b,o){var x=o.s=a+b,bv=x-a,av=x-bv;o.t=a-av+(b-bv)}d3.geo.stream=function(object,listener){if(object&&d3_geo_streamObjectType.hasOwnProperty(object.type)){d3_geo_streamObjectType[object.type](object,listener)}else{d3_geo_streamGeometry(object,listener)}};function d3_geo_streamGeometry(geometry,listener){if(geometry&&d3_geo_streamGeometryType.hasOwnProperty(geometry.type)){d3_geo_streamGeometryType[geometry.type](geometry,listener)}}var d3_geo_streamObjectType={Feature:function(feature,listener){d3_geo_streamGeometry(feature.geometry,listener)},FeatureCollection:function(object,listener){var features=object.features,i=-1,n=features.length;while(++i<n)d3_geo_streamGeometry(features[i].geometry,listener)}};var d3_geo_streamGeometryType={Sphere:function(object,listener){listener.sphere()},Point:function(object,listener){object=object.coordinates;listener.point(object[0],object[1],object[2])},MultiPoint:function(object,listener){var coordinates=object.coordinates,i=-1,n=coordinates.length;while(++i<n)object=coordinates[i],listener.point(object[0],object[1],object[2])},LineString:function(object,listener){d3_geo_streamLine(object.coordinates,listener,0)},MultiLineString:function(object,listener){var coordinates=object.coordinates,i=-1,n=coordinates.length;while(++i<n)d3_geo_streamLine(coordinates[i],listener,0)},Polygon:function(object,listener){d3_geo_streamPolygon(object.coordinates,listener)},MultiPolygon:function(object,listener){var coordinates=object.coordinates,i=-1,n=coordinates.length;while(++i<n)d3_geo_streamPolygon(coordinates[i],listener)},GeometryCollection:function(object,listener){var geometries=object.geometries,i=-1,n=geometries.length;while(++i<n)d3_geo_streamGeometry(geometries[i],listener)}};function d3_geo_streamLine(coordinates,listener,closed){var i=-1,n=coordinates.length-closed,coordinate;listener.lineStart();while(++i<n)coordinate=coordinates[i],listener.point(coordinate[0],coordinate[1],coordinate[2]);listener.lineEnd()}function d3_geo_streamPolygon(coordinates,listener){var i=-1,n=coordinates.length;listener.polygonStart();while(++i<n)d3_geo_streamLine(coordinates[i],listener,1);listener.polygonEnd()}d3.geo.area=function(object){d3_geo_areaSum=0;d3.geo.stream(object,d3_geo_area);return d3_geo_areaSum};var d3_geo_areaSum,d3_geo_areaRingSum=new d3_adder;var d3_geo_area={sphere:function(){d3_geo_areaSum+=4*π},point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){d3_geo_areaRingSum.reset();d3_geo_area.lineStart=d3_geo_areaRingStart},polygonEnd:function(){var area=2*d3_geo_areaRingSum;d3_geo_areaSum+=area<0?4*π+area:area;d3_geo_area.lineStart=d3_geo_area.lineEnd=d3_geo_area.point=d3_noop}};function d3_geo_areaRingStart(){var λ00,φ00,λ0,cosφ0,sinφ0;d3_geo_area.point=function(λ,φ){d3_geo_area.point=nextPoint;λ0=(λ00=λ)*d3_radians,cosφ0=Math.cos(φ=(φ00=φ)*d3_radians/2+π/4),sinφ0=Math.sin(φ)};function nextPoint(λ,φ){λ*=d3_radians;φ=φ*d3_radians/2+π/4;var dλ=λ-λ0,sdλ=dλ>=0?1:-1,adλ=sdλ*dλ,cosφ=Math.cos(φ),sinφ=Math.sin(φ),k=sinφ0*sinφ,u=cosφ0*cosφ+k*Math.cos(adλ),v=k*sdλ*Math.sin(adλ);d3_geo_areaRingSum.add(Math.atan2(v,u));λ0=λ,cosφ0=cosφ,sinφ0=sinφ}d3_geo_area.lineEnd=function(){nextPoint(λ00,φ00)}}function d3_geo_cartesian(spherical){var λ=spherical[0],φ=spherical[1],cosφ=Math.cos(φ);return[cosφ*Math.cos(λ),cosφ*Math.sin(λ),Math.sin(φ)]}function d3_geo_cartesianDot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function d3_geo_cartesianCross(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function d3_geo_cartesianAdd(a,b){a[0]+=b[0];a[1]+=b[1];a[2]+=b[2]}function d3_geo_cartesianScale(vector,k){return[vector[0]*k,vector[1]*k,vector[2]*k]}function d3_geo_cartesianNormalize(d){var l=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);d[0]/=l;d[1]/=l;d[2]/=l}function d3_geo_spherical(cartesian){return[Math.atan2(cartesian[1],cartesian[0]),d3_asin(cartesian[2])]}function d3_geo_sphericalEqual(a,b){return abs(a[0]-b[0])<ε&&abs(a[1]-b[1])<ε}d3.geo.bounds=function(){var λ0,φ0,λ1,φ1,λ_,λ__,φ__,p0,dλSum,ranges,range;var bound={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){bound.point=ringPoint;bound.lineStart=ringStart;bound.lineEnd=ringEnd;dλSum=0;d3_geo_area.polygonStart()},polygonEnd:function(){d3_geo_area.polygonEnd();bound.point=point;bound.lineStart=lineStart;bound.lineEnd=lineEnd;if(d3_geo_areaRingSum<0)λ0=-(λ1=180),φ0=-(φ1=90);else if(dλSum>ε)φ1=90;else if(dλSum<-ε)φ0=-90;range[0]=λ0,range[1]=λ1}};function point(λ,φ){ranges.push(range=[λ0=λ,λ1=λ]);if(φ<φ0)φ0=φ;if(φ>φ1)φ1=φ}function linePoint(λ,φ){var p=d3_geo_cartesian([λ*d3_radians,φ*d3_radians]);if(p0){var normal=d3_geo_cartesianCross(p0,p),equatorial=[normal[1],-normal[0],0],inflection=d3_geo_cartesianCross(equatorial,normal);d3_geo_cartesianNormalize(inflection);inflection=d3_geo_spherical(inflection);var dλ=λ-λ_,s=dλ>0?1:-1,λi=inflection[0]*d3_degrees*s,antimeridian=abs(dλ)>180;if(antimeridian^(s*λ_<λi&&λi<s*λ)){var φi=inflection[1]*d3_degrees;if(φi>φ1)φ1=φi}else if(λi=(λi+360)%360-180,antimeridian^(s*λ_<λi&&λi<s*λ)){var φi=-inflection[1]*d3_degrees;if(φi<φ0)φ0=φi}else{if(φ<φ0)φ0=φ;if(φ>φ1)φ1=φ}if(antimeridian){if(λ<λ_){if(angle(λ0,λ)>angle(λ0,λ1))λ1=λ}else{if(angle(λ,λ1)>angle(λ0,λ1))λ0=λ}}else{if(λ1>=λ0){if(λ<λ0)λ0=λ;if(λ>λ1)λ1=λ}else{if(λ>λ_){if(angle(λ0,λ)>angle(λ0,λ1))λ1=λ}else{if(angle(λ,λ1)>angle(λ0,λ1))λ0=λ}}}}else{point(λ,φ)}p0=p,λ_=λ}function lineStart(){bound.point=linePoint}function lineEnd(){range[0]=λ0,range[1]=λ1;bound.point=point;p0=null}function ringPoint(λ,φ){if(p0){var dλ=λ-λ_;dλSum+=abs(dλ)>180?dλ+(dλ>0?360:-360):dλ}else λ__=λ,φ__=φ;d3_geo_area.point(λ,φ);linePoint(λ,φ)}function ringStart(){d3_geo_area.lineStart()}function ringEnd(){ringPoint(λ__,φ__);d3_geo_area.lineEnd();if(abs(dλSum)>ε)λ0=-(λ1=180);range[0]=λ0,range[1]=λ1;p0=null}function angle(λ0,λ1){return(λ1-=λ0)<0?λ1+360:λ1}function compareRanges(a,b){return a[0]-b[0]}function withinRange(x,range){return range[0]<=range[1]?range[0]<=x&&x<=range[1]:x<range[0]||range[1]<x}return function(feature){φ1=λ1=-(λ0=φ0=Infinity);ranges=[];d3.geo.stream(feature,bound);var n=ranges.length;if(n){ranges.sort(compareRanges);for(var i=1,a=ranges[0],b,merged=[a];i<n;++i){b=ranges[i];if(withinRange(b[0],a)||withinRange(b[1],a)){if(angle(a[0],b[1])>angle(a[0],a[1]))a[1]=b[1];if(angle(b[0],a[1])>angle(a[0],a[1]))a[0]=b[0]}else{merged.push(a=b)}}var best=-Infinity,dλ;for(var n=merged.length-1,i=0,a=merged[n],b;i<=n;a=b,++i){b=merged[i];if((dλ=angle(a[1],b[0]))>best)best=dλ,λ0=b[0],λ1=a[1]}}ranges=range=null;return λ0===Infinity||φ0===Infinity?[[NaN,NaN],[NaN,NaN]]:[[λ0,φ0],[λ1,φ1]]}}();d3.geo.centroid=function(object){d3_geo_centroidW0=d3_geo_centroidW1=d3_geo_centroidX0=d3_geo_centroidY0=d3_geo_centroidZ0=d3_geo_centroidX1=d3_geo_centroidY1=d3_geo_centroidZ1=d3_geo_centroidX2=d3_geo_centroidY2=d3_geo_centroidZ2=0;d3.geo.stream(object,d3_geo_centroid);var x=d3_geo_centroidX2,y=d3_geo_centroidY2,z=d3_geo_centroidZ2,m=x*x+y*y+z*z;if(m<ε2){x=d3_geo_centroidX1,y=d3_geo_centroidY1,z=d3_geo_centroidZ1;if(d3_geo_centroidW1<ε)x=d3_geo_centroidX0,y=d3_geo_centroidY0,z=d3_geo_centroidZ0;m=x*x+y*y+z*z;if(m<ε2)return[NaN,NaN]}return[Math.atan2(y,x)*d3_degrees,d3_asin(z/Math.sqrt(m))*d3_degrees]};var d3_geo_centroidW0,d3_geo_centroidW1,d3_geo_centroidX0,d3_geo_centroidY0,d3_geo_centroidZ0,d3_geo_centroidX1,d3_geo_centroidY1,d3_geo_centroidZ1,d3_geo_centroidX2,d3_geo_centroidY2,d3_geo_centroidZ2;var d3_geo_centroid={sphere:d3_noop,point:d3_geo_centroidPoint,lineStart:d3_geo_centroidLineStart,lineEnd:d3_geo_centroidLineEnd,polygonStart:function(){d3_geo_centroid.lineStart=d3_geo_centroidRingStart},polygonEnd:function(){d3_geo_centroid.lineStart=d3_geo_centroidLineStart}};function d3_geo_centroidPoint(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);d3_geo_centroidPointXYZ(cosφ*Math.cos(λ),cosφ*Math.sin(λ),Math.sin(φ))}function d3_geo_centroidPointXYZ(x,y,z){++d3_geo_centroidW0;d3_geo_centroidX0+=(x-d3_geo_centroidX0)/d3_geo_centroidW0;d3_geo_centroidY0+=(y-d3_geo_centroidY0)/d3_geo_centroidW0;d3_geo_centroidZ0+=(z-d3_geo_centroidZ0)/d3_geo_centroidW0}function d3_geo_centroidLineStart(){var x0,y0,z0;d3_geo_centroid.point=function(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);x0=cosφ*Math.cos(λ);y0=cosφ*Math.sin(λ);z0=Math.sin(φ);d3_geo_centroid.point=nextPoint;d3_geo_centroidPointXYZ(x0,y0,z0)};function nextPoint(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians),x=cosφ*Math.cos(λ),y=cosφ*Math.sin(λ),z=Math.sin(φ),w=Math.atan2(Math.sqrt((w=y0*z-z0*y)*w+(w=z0*x-x0*z)*w+(w=x0*y-y0*x)*w),x0*x+y0*y+z0*z);d3_geo_centroidW1+=w;d3_geo_centroidX1+=w*(x0+(x0=x));d3_geo_centroidY1+=w*(y0+(y0=y));d3_geo_centroidZ1+=w*(z0+(z0=z));d3_geo_centroidPointXYZ(x0,y0,z0)}}function d3_geo_centroidLineEnd(){d3_geo_centroid.point=d3_geo_centroidPoint}function d3_geo_centroidRingStart(){var λ00,φ00,x0,y0,z0;d3_geo_centroid.point=function(λ,φ){λ00=λ,φ00=φ;d3_geo_centroid.point=nextPoint;λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);x0=cosφ*Math.cos(λ);y0=cosφ*Math.sin(λ);z0=Math.sin(φ);d3_geo_centroidPointXYZ(x0,y0,z0)};d3_geo_centroid.lineEnd=function(){nextPoint(λ00,φ00);d3_geo_centroid.lineEnd=d3_geo_centroidLineEnd;d3_geo_centroid.point=d3_geo_centroidPoint};function nextPoint(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians),x=cosφ*Math.cos(λ),y=cosφ*Math.sin(λ),z=Math.sin(φ),cx=y0*z-z0*y,cy=z0*x-x0*z,cz=x0*y-y0*x,m=Math.sqrt(cx*cx+cy*cy+cz*cz),u=x0*x+y0*y+z0*z,v=m&&-d3_acos(u)/m,w=Math.atan2(m,u);d3_geo_centroidX2+=v*cx;d3_geo_centroidY2+=v*cy;d3_geo_centroidZ2+=v*cz;d3_geo_centroidW1+=w;d3_geo_centroidX1+=w*(x0+(x0=x));d3_geo_centroidY1+=w*(y0+(y0=y));d3_geo_centroidZ1+=w*(z0+(z0=z));d3_geo_centroidPointXYZ(x0,y0,z0)}}function d3_geo_compose(a,b){function compose(x,y){return x=a(x,y),b(x[0],x[1])}if(a.invert&&b.invert)compose.invert=function(x,y){return x=b.invert(x,y),x&&a.invert(x[0],x[1])};return compose}function d3_true(){return true}function d3_geo_clipPolygon(segments,compare,clipStartInside,interpolate,listener){var subject=[],clip=[];segments.forEach((function(segment){if((n=segment.length-1)<=0)return;var n,p0=segment[0],p1=segment[n];if(d3_geo_sphericalEqual(p0,p1)){listener.lineStart();for(var i=0;i<n;++i)listener.point((p0=segment[i])[0],p0[1]);listener.lineEnd();return}var a=new d3_geo_clipPolygonIntersection(p0,segment,null,true),b=new d3_geo_clipPolygonIntersection(p0,null,a,false);a.o=b;subject.push(a);clip.push(b);a=new d3_geo_clipPolygonIntersection(p1,segment,null,false);b=new d3_geo_clipPolygonIntersection(p1,null,a,true);a.o=b;subject.push(a);clip.push(b)}));clip.sort(compare);d3_geo_clipPolygonLinkCircular(subject);d3_geo_clipPolygonLinkCircular(clip);if(!subject.length)return;for(var i=0,entry=clipStartInside,n=clip.length;i<n;++i){clip[i].e=entry=!entry}var start=subject[0],points,point;while(1){var current=start,isSubject=true;while(current.v)if((current=current.n)===start)return;points=current.z;listener.lineStart();do{current.v=current.o.v=true;if(current.e){if(isSubject){for(var i=0,n=points.length;i<n;++i)listener.point((point=points[i])[0],point[1])}else{interpolate(current.x,current.n.x,1,listener)}current=current.n}else{if(isSubject){points=current.p.z;for(var i=points.length-1;i>=0;--i)listener.point((point=points[i])[0],point[1])}else{interpolate(current.x,current.p.x,-1,listener)}current=current.p}current=current.o;points=current.z;isSubject=!isSubject}while(!current.v);listener.lineEnd()}}function d3_geo_clipPolygonLinkCircular(array){if(!(n=array.length))return;var n,i=0,a=array[0],b;while(++i<n){a.n=b=array[i];b.p=a;a=b}a.n=b=array[0];b.p=a}function d3_geo_clipPolygonIntersection(point,points,other,entry){this.x=point;this.z=points;this.o=other;this.e=entry;this.v=false;this.n=this.p=null}function d3_geo_clip(pointVisible,clipLine,interpolate,clipStart){return function(rotate,listener){var line=clipLine(listener),rotatedClipStart=rotate.invert(clipStart[0],clipStart[1]);var clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){clip.point=pointRing;clip.lineStart=ringStart;clip.lineEnd=ringEnd;segments=[];polygon=[]},polygonEnd:function(){clip.point=point;clip.lineStart=lineStart;clip.lineEnd=lineEnd;segments=d3.merge(segments);var clipStartInside=d3_geo_pointInPolygon(rotatedClipStart,polygon);if(segments.length){if(!polygonStarted)listener.polygonStart(),polygonStarted=true;d3_geo_clipPolygon(segments,d3_geo_clipSort,clipStartInside,interpolate,listener)}else if(clipStartInside){if(!polygonStarted)listener.polygonStart(),polygonStarted=true;listener.lineStart();interpolate(null,null,1,listener);listener.lineEnd()}if(polygonStarted)listener.polygonEnd(),polygonStarted=false;segments=polygon=null},sphere:function(){listener.polygonStart();listener.lineStart();interpolate(null,null,1,listener);listener.lineEnd();listener.polygonEnd()}};function point(λ,φ){var point=rotate(λ,φ);if(pointVisible(λ=point[0],φ=point[1]))listener.point(λ,φ)}function pointLine(λ,φ){var point=rotate(λ,φ);line.point(point[0],point[1])}function lineStart(){clip.point=pointLine;line.lineStart()}function lineEnd(){clip.point=point;line.lineEnd()}var segments;var buffer=d3_geo_clipBufferListener(),ringListener=clipLine(buffer),polygonStarted=false,polygon,ring;function pointRing(λ,φ){ring.push([λ,φ]);var point=rotate(λ,φ);ringListener.point(point[0],point[1])}function ringStart(){ringListener.lineStart();ring=[]}function ringEnd(){pointRing(ring[0][0],ring[0][1]);ringListener.lineEnd();var clean=ringListener.clean(),ringSegments=buffer.buffer(),segment,n=ringSegments.length;ring.pop();polygon.push(ring);ring=null;if(!n)return;if(clean&1){segment=ringSegments[0];var n=segment.length-1,i=-1,point;if(n>0){if(!polygonStarted)listener.polygonStart(),polygonStarted=true;listener.lineStart();while(++i<n)listener.point((point=segment[i])[0],point[1]);listener.lineEnd()}return}if(n>1&&clean&2)ringSegments.push(ringSegments.pop().concat(ringSegments.shift()));segments.push(ringSegments.filter(d3_geo_clipSegmentLength1))}return clip}}function d3_geo_clipSegmentLength1(segment){return segment.length>1}function d3_geo_clipBufferListener(){var lines=[],line;return{lineStart:function(){lines.push(line=[])},point:function(λ,φ){line.push([λ,φ])},lineEnd:d3_noop,buffer:function(){var buffer=lines;lines=[];line=null;return buffer},rejoin:function(){if(lines.length>1)lines.push(lines.pop().concat(lines.shift()))}}}function d3_geo_clipSort(a,b){return((a=a.x)[0]<0?a[1]-halfπ-ε:halfπ-a[1])-((b=b.x)[0]<0?b[1]-halfπ-ε:halfπ-b[1])}var d3_geo_clipAntimeridian=d3_geo_clip(d3_true,d3_geo_clipAntimeridianLine,d3_geo_clipAntimeridianInterpolate,[-π,-π/2]);function d3_geo_clipAntimeridianLine(listener){var λ0=NaN,φ0=NaN,sλ0=NaN,clean;return{lineStart:function(){listener.lineStart();clean=1},point:function(λ1,φ1){var sλ1=λ1>0?π:-π,dλ=abs(λ1-λ0);if(abs(dλ-π)<ε){listener.point(λ0,φ0=(φ0+φ1)/2>0?halfπ:-halfπ);listener.point(sλ0,φ0);listener.lineEnd();listener.lineStart();listener.point(sλ1,φ0);listener.point(λ1,φ0);clean=0}else if(sλ0!==sλ1&&dλ>=π){if(abs(λ0-sλ0)<ε)λ0-=sλ0*ε;if(abs(λ1-sλ1)<ε)λ1-=sλ1*ε;φ0=d3_geo_clipAntimeridianIntersect(λ0,φ0,λ1,φ1);listener.point(sλ0,φ0);listener.lineEnd();listener.lineStart();listener.point(sλ1,φ0);clean=0}listener.point(λ0=λ1,φ0=φ1);sλ0=sλ1},lineEnd:function(){listener.lineEnd();λ0=φ0=NaN},clean:function(){return 2-clean}}}function d3_geo_clipAntimeridianIntersect(λ0,φ0,λ1,φ1){var cosφ0,cosφ1,sinλ0_λ1=Math.sin(λ0-λ1);return abs(sinλ0_λ1)>ε?Math.atan((Math.sin(φ0)*(cosφ1=Math.cos(φ1))*Math.sin(λ1)-Math.sin(φ1)*(cosφ0=Math.cos(φ0))*Math.sin(λ0))/(cosφ0*cosφ1*sinλ0_λ1)):(φ0+φ1)/2}function d3_geo_clipAntimeridianInterpolate(from,to,direction,listener){var φ;if(from==null){φ=direction*halfπ;listener.point(-π,φ);listener.point(0,φ);listener.point(π,φ);listener.point(π,0);listener.point(π,-φ);listener.point(0,-φ);listener.point(-π,-φ);listener.point(-π,0);listener.point(-π,φ)}else if(abs(from[0]-to[0])>ε){var s=from[0]<to[0]?π:-π;φ=direction*s/2;listener.point(-s,φ);listener.point(0,φ);listener.point(s,φ)}else{listener.point(to[0],to[1])}}function d3_geo_pointInPolygon(point,polygon){var meridian=point[0],parallel=point[1],meridianNormal=[Math.sin(meridian),-Math.cos(meridian),0],polarAngle=0,winding=0;d3_geo_areaRingSum.reset();for(var i=0,n=polygon.length;i<n;++i){var ring=polygon[i],m=ring.length;if(!m)continue;var point0=ring[0],λ0=point0[0],φ0=point0[1]/2+π/4,sinφ0=Math.sin(φ0),cosφ0=Math.cos(φ0),j=1;while(true){if(j===m)j=0;point=ring[j];var λ=point[0],φ=point[1]/2+π/4,sinφ=Math.sin(φ),cosφ=Math.cos(φ),dλ=λ-λ0,sdλ=dλ>=0?1:-1,adλ=sdλ*dλ,antimeridian=adλ>π,k=sinφ0*sinφ;d3_geo_areaRingSum.add(Math.atan2(k*sdλ*Math.sin(adλ),cosφ0*cosφ+k*Math.cos(adλ)));polarAngle+=antimeridian?dλ+sdλ*τ:dλ;if(antimeridian^λ0>=meridian^λ>=meridian){var arc=d3_geo_cartesianCross(d3_geo_cartesian(point0),d3_geo_cartesian(point));d3_geo_cartesianNormalize(arc);var intersection=d3_geo_cartesianCross(meridianNormal,arc);d3_geo_cartesianNormalize(intersection);var φarc=(antimeridian^dλ>=0?-1:1)*d3_asin(intersection[2]);if(parallel>φarc||parallel===φarc&&(arc[0]||arc[1])){winding+=antimeridian^dλ>=0?1:-1}}if(!j++)break;λ0=λ,sinφ0=sinφ,cosφ0=cosφ,point0=point}}return(polarAngle<-ε||polarAngle<ε&&d3_geo_areaRingSum<-ε)^winding&1}function d3_geo_clipCircle(radius){var cr=Math.cos(radius),smallRadius=cr>0,notHemisphere=abs(cr)>ε,interpolate=d3_geo_circleInterpolate(radius,6*d3_radians);return d3_geo_clip(visible,clipLine,interpolate,smallRadius?[0,-radius]:[-π,radius-π]);function visible(λ,φ){return Math.cos(λ)*Math.cos(φ)>cr}function clipLine(listener){var point0,c0,v0,v00,clean;return{lineStart:function(){v00=v0=false;clean=1},point:function(λ,φ){var point1=[λ,φ],point2,v=visible(λ,φ),c=smallRadius?v?0:code(λ,φ):v?code(λ+(λ<0?π:-π),φ):0;if(!point0&&(v00=v0=v))listener.lineStart();if(v!==v0){point2=intersect(point0,point1);if(d3_geo_sphericalEqual(point0,point2)||d3_geo_sphericalEqual(point1,point2)){point1[0]+=ε;point1[1]+=ε;v=visible(point1[0],point1[1])}}if(v!==v0){clean=0;if(v){listener.lineStart();point2=intersect(point1,point0);listener.point(point2[0],point2[1])}else{point2=intersect(point0,point1);listener.point(point2[0],point2[1]);listener.lineEnd()}point0=point2}else if(notHemisphere&&point0&&smallRadius^v){var t;if(!(c&c0)&&(t=intersect(point1,point0,true))){clean=0;if(smallRadius){listener.lineStart();listener.point(t[0][0],t[0][1]);listener.point(t[1][0],t[1][1]);listener.lineEnd()}else{listener.point(t[1][0],t[1][1]);listener.lineEnd();listener.lineStart();listener.point(t[0][0],t[0][1])}}}if(v&&(!point0||!d3_geo_sphericalEqual(point0,point1))){listener.point(point1[0],point1[1])}point0=point1,v0=v,c0=c},lineEnd:function(){if(v0)listener.lineEnd();point0=null},clean:function(){return clean|(v00&&v0)<<1}}}function intersect(a,b,two){var pa=d3_geo_cartesian(a),pb=d3_geo_cartesian(b);var n1=[1,0,0],n2=d3_geo_cartesianCross(pa,pb),n2n2=d3_geo_cartesianDot(n2,n2),n1n2=n2[0],determinant=n2n2-n1n2*n1n2;if(!determinant)return!two&&a;var c1=cr*n2n2/determinant,c2=-cr*n1n2/determinant,n1xn2=d3_geo_cartesianCross(n1,n2),A=d3_geo_cartesianScale(n1,c1),B=d3_geo_cartesianScale(n2,c2);d3_geo_cartesianAdd(A,B);var u=n1xn2,w=d3_geo_cartesianDot(A,u),uu=d3_geo_cartesianDot(u,u),t2=w*w-uu*(d3_geo_cartesianDot(A,A)-1);if(t2<0)return;var t=Math.sqrt(t2),q=d3_geo_cartesianScale(u,(-w-t)/uu);d3_geo_cartesianAdd(q,A);q=d3_geo_spherical(q);if(!two)return q;var λ0=a[0],λ1=b[0],φ0=a[1],φ1=b[1],z;if(λ1<λ0)z=λ0,λ0=λ1,λ1=z;var δλ=λ1-λ0,polar=abs(δλ-π)<ε,meridian=polar||δλ<ε;if(!polar&&φ1<φ0)z=φ0,φ0=φ1,φ1=z;if(meridian?polar?φ0+φ1>0^q[1]<(abs(q[0]-λ0)<ε?φ0:φ1):φ0<=q[1]&&q[1]<=φ1:δλ>π^(λ0<=q[0]&&q[0]<=λ1)){var q1=d3_geo_cartesianScale(u,(-w+t)/uu);d3_geo_cartesianAdd(q1,A);return[q,d3_geo_spherical(q1)]}}function code(λ,φ){var r=smallRadius?radius:π-radius,code=0;if(λ<-r)code|=1;else if(λ>r)code|=2;if(φ<-r)code|=4;else if(φ>r)code|=8;return code}}function d3_geom_clipLine(x0,y0,x1,y1){return function(line){var a=line.a,b=line.b,ax=a.x,ay=a.y,bx=b.x,by=b.y,t0=0,t1=1,dx=bx-ax,dy=by-ay,r;r=x0-ax;if(!dx&&r>0)return;r/=dx;if(dx<0){if(r<t0)return;if(r<t1)t1=r}else if(dx>0){if(r>t1)return;if(r>t0)t0=r}r=x1-ax;if(!dx&&r<0)return;r/=dx;if(dx<0){if(r>t1)return;if(r>t0)t0=r}else if(dx>0){if(r<t0)return;if(r<t1)t1=r}r=y0-ay;if(!dy&&r>0)return;r/=dy;if(dy<0){if(r<t0)return;if(r<t1)t1=r}else if(dy>0){if(r>t1)return;if(r>t0)t0=r}r=y1-ay;if(!dy&&r<0)return;r/=dy;if(dy<0){if(r>t1)return;if(r>t0)t0=r}else if(dy>0){if(r<t0)return;if(r<t1)t1=r}if(t0>0)line.a={x:ax+t0*dx,y:ay+t0*dy};if(t1<1)line.b={x:ax+t1*dx,y:ay+t1*dy};return line}}var d3_geo_clipExtentMAX=1e9;d3.geo.clipExtent=function(){var x0,y0,x1,y1,stream,clip,clipExtent={stream:function(output){if(stream)stream.valid=false;stream=clip(output);stream.valid=true;return stream},extent:function(_){if(!arguments.length)return[[x0,y0],[x1,y1]];clip=d3_geo_clipExtent(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]);if(stream)stream.valid=false,stream=null;return clipExtent}};return clipExtent.extent([[0,0],[960,500]])};function d3_geo_clipExtent(x0,y0,x1,y1){return function(listener){var listener_=listener,bufferListener=d3_geo_clipBufferListener(),clipLine=d3_geom_clipLine(x0,y0,x1,y1),segments,polygon,ring;var clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){listener=bufferListener;segments=[];polygon=[];clean=true},polygonEnd:function(){listener=listener_;segments=d3.merge(segments);var clipStartInside=insidePolygon([x0,y1]),inside=clean&&clipStartInside,visible=segments.length;if(inside||visible){listener.polygonStart();if(inside){listener.lineStart();interpolate(null,null,1,listener);listener.lineEnd()}if(visible){d3_geo_clipPolygon(segments,compare,clipStartInside,interpolate,listener)}listener.polygonEnd()}segments=polygon=ring=null}};function insidePolygon(p){var wn=0,n=polygon.length,y=p[1];for(var i=0;i<n;++i){for(var j=1,v=polygon[i],m=v.length,a=v[0],b;j<m;++j){b=v[j];if(a[1]<=y){if(b[1]>y&&d3_cross2d(a,b,p)>0)++wn}else{if(b[1]<=y&&d3_cross2d(a,b,p)<0)--wn}a=b}}return wn!==0}function interpolate(from,to,direction,listener){var a=0,a1=0;if(from==null||(a=corner(from,direction))!==(a1=corner(to,direction))||comparePoints(from,to)<0^direction>0){do{listener.point(a===0||a===3?x0:x1,a>1?y1:y0)}while((a=(a+direction+4)%4)!==a1)}else{listener.point(to[0],to[1])}}function pointVisible(x,y){return x0<=x&&x<=x1&&y0<=y&&y<=y1}function point(x,y){if(pointVisible(x,y))listener.point(x,y)}var x__,y__,v__,x_,y_,v_,first,clean;function lineStart(){clip.point=linePoint;if(polygon)polygon.push(ring=[]);first=true;v_=false;x_=y_=NaN}function lineEnd(){if(segments){linePoint(x__,y__);if(v__&&v_)bufferListener.rejoin();segments.push(bufferListener.buffer())}clip.point=point;if(v_)listener.lineEnd()}function linePoint(x,y){x=Math.max(-d3_geo_clipExtentMAX,Math.min(d3_geo_clipExtentMAX,x));y=Math.max(-d3_geo_clipExtentMAX,Math.min(d3_geo_clipExtentMAX,y));var v=pointVisible(x,y);if(polygon)ring.push([x,y]);if(first){x__=x,y__=y,v__=v;first=false;if(v){listener.lineStart();listener.point(x,y)}}else{if(v&&v_)listener.point(x,y);else{var l={a:{x:x_,y:y_},b:{x:x,y:y}};if(clipLine(l)){if(!v_){listener.lineStart();listener.point(l.a.x,l.a.y)}listener.point(l.b.x,l.b.y);if(!v)listener.lineEnd();clean=false}else if(v){listener.lineStart();listener.point(x,y);clean=false}}}x_=x,y_=y,v_=v}return clip};function corner(p,direction){return abs(p[0]-x0)<ε?direction>0?0:3:abs(p[0]-x1)<ε?direction>0?2:1:abs(p[1]-y0)<ε?direction>0?1:0:direction>0?3:2}function compare(a,b){return comparePoints(a.x,b.x)}function comparePoints(a,b){var ca=corner(a,1),cb=corner(b,1);return ca!==cb?ca-cb:ca===0?b[1]-a[1]:ca===1?a[0]-b[0]:ca===2?a[1]-b[1]:b[0]-a[0]}}function d3_geo_conic(projectAt){var φ0=0,φ1=π/3,m=d3_geo_projectionMutator(projectAt),p=m(φ0,φ1);p.parallels=function(_){if(!arguments.length)return[φ0/π*180,φ1/π*180];return m(φ0=_[0]*π/180,φ1=_[1]*π/180)};return p}function d3_geo_conicEqualArea(φ0,φ1){var sinφ0=Math.sin(φ0),n=(sinφ0+Math.sin(φ1))/2,C=1+sinφ0*(2*n-sinφ0),ρ0=Math.sqrt(C)/n;function forward(λ,φ){var ρ=Math.sqrt(C-2*n*Math.sin(φ))/n;return[ρ*Math.sin(λ*=n),ρ0-ρ*Math.cos(λ)]}forward.invert=function(x,y){var ρ0_y=ρ0-y;return[Math.atan2(x,ρ0_y)/n,d3_asin((C-(x*x+ρ0_y*ρ0_y)*n*n)/(2*n))]};return forward}(d3.geo.conicEqualArea=function(){return d3_geo_conic(d3_geo_conicEqualArea)}).raw=d3_geo_conicEqualArea;d3.geo.albers=function(){return d3.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};d3.geo.albersUsa=function(){var lower48=d3.geo.albers();var alaska=d3.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]);var hawaii=d3.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]);var point,pointStream={point:function(x,y){point=[x,y]}},lower48Point,alaskaPoint,hawaiiPoint;function albersUsa(coordinates){var x=coordinates[0],y=coordinates[1];point=null;(lower48Point(x,y),point)||(alaskaPoint(x,y),point)||hawaiiPoint(x,y);return point}albersUsa.invert=function(coordinates){var k=lower48.scale(),t=lower48.translate(),x=(coordinates[0]-t[0])/k,y=(coordinates[1]-t[1])/k;return(y>=.12&&y<.234&&x>=-.425&&x<-.214?alaska:y>=.166&&y<.234&&x>=-.214&&x<-.115?hawaii:lower48).invert(coordinates)};albersUsa.stream=function(stream){var lower48Stream=lower48.stream(stream),alaskaStream=alaska.stream(stream),hawaiiStream=hawaii.stream(stream);return{point:function(x,y){lower48Stream.point(x,y);alaskaStream.point(x,y);hawaiiStream.point(x,y)},sphere:function(){lower48Stream.sphere();alaskaStream.sphere();hawaiiStream.sphere()},lineStart:function(){lower48Stream.lineStart();alaskaStream.lineStart();hawaiiStream.lineStart()},lineEnd:function(){lower48Stream.lineEnd();alaskaStream.lineEnd();hawaiiStream.lineEnd()},polygonStart:function(){lower48Stream.polygonStart();alaskaStream.polygonStart();hawaiiStream.polygonStart()},polygonEnd:function(){lower48Stream.polygonEnd();alaskaStream.polygonEnd();hawaiiStream.polygonEnd()}}};albersUsa.precision=function(_){if(!arguments.length)return lower48.precision();lower48.precision(_);alaska.precision(_);hawaii.precision(_);return albersUsa};albersUsa.scale=function(_){if(!arguments.length)return lower48.scale();lower48.scale(_);alaska.scale(_*.35);hawaii.scale(_);return albersUsa.translate(lower48.translate())};albersUsa.translate=function(_){if(!arguments.length)return lower48.translate();var k=lower48.scale(),x=+_[0],y=+_[1];lower48Point=lower48.translate(_).clipExtent([[x-.455*k,y-.238*k],[x+.455*k,y+.238*k]]).stream(pointStream).point;alaskaPoint=alaska.translate([x-.307*k,y+.201*k]).clipExtent([[x-.425*k+ε,y+.12*k+ε],[x-.214*k-ε,y+.234*k-ε]]).stream(pointStream).point;hawaiiPoint=hawaii.translate([x-.205*k,y+.212*k]).clipExtent([[x-.214*k+ε,y+.166*k+ε],[x-.115*k-ε,y+.234*k-ε]]).stream(pointStream).point;return albersUsa};return albersUsa.scale(1070)};var d3_geo_pathAreaSum,d3_geo_pathAreaPolygon,d3_geo_pathArea={point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){d3_geo_pathAreaPolygon=0;d3_geo_pathArea.lineStart=d3_geo_pathAreaRingStart},polygonEnd:function(){d3_geo_pathArea.lineStart=d3_geo_pathArea.lineEnd=d3_geo_pathArea.point=d3_noop;d3_geo_pathAreaSum+=abs(d3_geo_pathAreaPolygon/2)}};function d3_geo_pathAreaRingStart(){var x00,y00,x0,y0;d3_geo_pathArea.point=function(x,y){d3_geo_pathArea.point=nextPoint;x00=x0=x,y00=y0=y};function nextPoint(x,y){d3_geo_pathAreaPolygon+=y0*x-x0*y;x0=x,y0=y}d3_geo_pathArea.lineEnd=function(){nextPoint(x00,y00)}}var d3_geo_pathBoundsX0,d3_geo_pathBoundsY0,d3_geo_pathBoundsX1,d3_geo_pathBoundsY1;var d3_geo_pathBounds={point:d3_geo_pathBoundsPoint,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop};function d3_geo_pathBoundsPoint(x,y){if(x<d3_geo_pathBoundsX0)d3_geo_pathBoundsX0=x;if(x>d3_geo_pathBoundsX1)d3_geo_pathBoundsX1=x;if(y<d3_geo_pathBoundsY0)d3_geo_pathBoundsY0=y;if(y>d3_geo_pathBoundsY1)d3_geo_pathBoundsY1=y}function d3_geo_pathBuffer(){var pointCircle=d3_geo_pathBufferCircle(4.5),buffer=[];var stream={point:point,lineStart:function(){stream.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){stream.lineEnd=lineEndPolygon},polygonEnd:function(){stream.lineEnd=lineEnd;stream.point=point},pointRadius:function(_){pointCircle=d3_geo_pathBufferCircle(_);return stream},result:function(){if(buffer.length){var result=buffer.join("");buffer=[];return result}}};function point(x,y){buffer.push("M",x,",",y,pointCircle)}function pointLineStart(x,y){buffer.push("M",x,",",y);stream.point=pointLine}function pointLine(x,y){buffer.push("L",x,",",y)}function lineEnd(){stream.point=point}function lineEndPolygon(){buffer.push("Z")}return stream}function d3_geo_pathBufferCircle(radius){return"m0,"+radius+"a"+radius+","+radius+" 0 1,1 0,"+-2*radius+"a"+radius+","+radius+" 0 1,1 0,"+2*radius+"z"}var d3_geo_pathCentroid={point:d3_geo_pathCentroidPoint,lineStart:d3_geo_pathCentroidLineStart,lineEnd:d3_geo_pathCentroidLineEnd,polygonStart:function(){d3_geo_pathCentroid.lineStart=d3_geo_pathCentroidRingStart},polygonEnd:function(){d3_geo_pathCentroid.point=d3_geo_pathCentroidPoint;d3_geo_pathCentroid.lineStart=d3_geo_pathCentroidLineStart;d3_geo_pathCentroid.lineEnd=d3_geo_pathCentroidLineEnd}};function d3_geo_pathCentroidPoint(x,y){d3_geo_centroidX0+=x;d3_geo_centroidY0+=y;++d3_geo_centroidZ0}function d3_geo_pathCentroidLineStart(){var x0,y0;d3_geo_pathCentroid.point=function(x,y){d3_geo_pathCentroid.point=nextPoint;d3_geo_pathCentroidPoint(x0=x,y0=y)};function nextPoint(x,y){var dx=x-x0,dy=y-y0,z=Math.sqrt(dx*dx+dy*dy);d3_geo_centroidX1+=z*(x0+x)/2;d3_geo_centroidY1+=z*(y0+y)/2;d3_geo_centroidZ1+=z;d3_geo_pathCentroidPoint(x0=x,y0=y)}}function d3_geo_pathCentroidLineEnd(){d3_geo_pathCentroid.point=d3_geo_pathCentroidPoint}function d3_geo_pathCentroidRingStart(){var x00,y00,x0,y0;d3_geo_pathCentroid.point=function(x,y){d3_geo_pathCentroid.point=nextPoint;d3_geo_pathCentroidPoint(x00=x0=x,y00=y0=y)};function nextPoint(x,y){var dx=x-x0,dy=y-y0,z=Math.sqrt(dx*dx+dy*dy);d3_geo_centroidX1+=z*(x0+x)/2;d3_geo_centroidY1+=z*(y0+y)/2;d3_geo_centroidZ1+=z;z=y0*x-x0*y;d3_geo_centroidX2+=z*(x0+x);d3_geo_centroidY2+=z*(y0+y);d3_geo_centroidZ2+=z*3;d3_geo_pathCentroidPoint(x0=x,y0=y)}d3_geo_pathCentroid.lineEnd=function(){nextPoint(x00,y00)}}function d3_geo_pathContext(context){var pointRadius=4.5;var stream={point:point,lineStart:function(){stream.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){stream.lineEnd=lineEndPolygon},polygonEnd:function(){stream.lineEnd=lineEnd;stream.point=point},pointRadius:function(_){pointRadius=_;return stream},result:d3_noop};function point(x,y){context.moveTo(x+pointRadius,y);context.arc(x,y,pointRadius,0,τ)}function pointLineStart(x,y){context.moveTo(x,y);stream.point=pointLine}function pointLine(x,y){context.lineTo(x,y)}function lineEnd(){stream.point=point}function lineEndPolygon(){context.closePath()}return stream}function d3_geo_resample(project){var δ2=.5,cosMinDistance=Math.cos(30*d3_radians),maxDepth=16;function resample(stream){return(maxDepth?resampleRecursive:resampleNone)(stream)}function resampleNone(stream){return d3_geo_transformPoint(stream,(function(x,y){x=project(x,y);stream.point(x[0],x[1])}))}function resampleRecursive(stream){var λ00,φ00,x00,y00,a00,b00,c00,λ0,x0,y0,a0,b0,c0;var resample={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){stream.polygonStart();resample.lineStart=ringStart},polygonEnd:function(){stream.polygonEnd();resample.lineStart=lineStart}};function point(x,y){x=project(x,y);stream.point(x[0],x[1])}function lineStart(){x0=NaN;resample.point=linePoint;stream.lineStart()}function linePoint(λ,φ){var c=d3_geo_cartesian([λ,φ]),p=project(λ,φ);resampleLineTo(x0,y0,λ0,a0,b0,c0,x0=p[0],y0=p[1],λ0=λ,a0=c[0],b0=c[1],c0=c[2],maxDepth,stream);stream.point(x0,y0)}function lineEnd(){resample.point=point;stream.lineEnd()}function ringStart(){lineStart();resample.point=ringPoint;resample.lineEnd=ringEnd}function ringPoint(λ,φ){linePoint(λ00=λ,φ00=φ),x00=x0,y00=y0,a00=a0,b00=b0,c00=c0;resample.point=linePoint}function ringEnd(){resampleLineTo(x0,y0,λ0,a0,b0,c0,x00,y00,λ00,a00,b00,c00,maxDepth,stream);resample.lineEnd=lineEnd;lineEnd()}return resample}function resampleLineTo(x0,y0,λ0,a0,b0,c0,x1,y1,λ1,a1,b1,c1,depth,stream){var dx=x1-x0,dy=y1-y0,d2=dx*dx+dy*dy;if(d2>4*δ2&&depth--){var a=a0+a1,b=b0+b1,c=c0+c1,m=Math.sqrt(a*a+b*b+c*c),φ2=Math.asin(c/=m),λ2=abs(abs(c)-1)<ε||abs(λ0-λ1)<ε?(λ0+λ1)/2:Math.atan2(b,a),p=project(λ2,φ2),x2=p[0],y2=p[1],dx2=x2-x0,dy2=y2-y0,dz=dy*dx2-dx*dy2;if(dz*dz/d2>δ2||abs((dx*dx2+dy*dy2)/d2-.5)>.3||a0*a1+b0*b1+c0*c1<cosMinDistance){resampleLineTo(x0,y0,λ0,a0,b0,c0,x2,y2,λ2,a/=m,b/=m,c,depth,stream);stream.point(x2,y2);resampleLineTo(x2,y2,λ2,a,b,c,x1,y1,λ1,a1,b1,c1,depth,stream)}}}resample.precision=function(_){if(!arguments.length)return Math.sqrt(δ2);maxDepth=(δ2=_*_)>0&&16;return resample};return resample}d3.geo.path=function(){var pointRadius=4.5,projection,context,projectStream,contextStream,cacheStream;function path(object){if(object){if(typeof pointRadius==="function")contextStream.pointRadius(+pointRadius.apply(this,arguments));if(!cacheStream||!cacheStream.valid)cacheStream=projectStream(contextStream);d3.geo.stream(object,cacheStream)}return contextStream.result()}path.area=function(object){d3_geo_pathAreaSum=0;d3.geo.stream(object,projectStream(d3_geo_pathArea));return d3_geo_pathAreaSum};path.centroid=function(object){d3_geo_centroidX0=d3_geo_centroidY0=d3_geo_centroidZ0=d3_geo_centroidX1=d3_geo_centroidY1=d3_geo_centroidZ1=d3_geo_centroidX2=d3_geo_centroidY2=d3_geo_centroidZ2=0;d3.geo.stream(object,projectStream(d3_geo_pathCentroid));return d3_geo_centroidZ2?[d3_geo_centroidX2/d3_geo_centroidZ2,d3_geo_centroidY2/d3_geo_centroidZ2]:d3_geo_centroidZ1?[d3_geo_centroidX1/d3_geo_centroidZ1,d3_geo_centroidY1/d3_geo_centroidZ1]:d3_geo_centroidZ0?[d3_geo_centroidX0/d3_geo_centroidZ0,d3_geo_centroidY0/d3_geo_centroidZ0]:[NaN,NaN]};path.bounds=function(object){d3_geo_pathBoundsX1=d3_geo_pathBoundsY1=-(d3_geo_pathBoundsX0=d3_geo_pathBoundsY0=Infinity);d3.geo.stream(object,projectStream(d3_geo_pathBounds));return[[d3_geo_pathBoundsX0,d3_geo_pathBoundsY0],[d3_geo_pathBoundsX1,d3_geo_pathBoundsY1]]};path.projection=function(_){if(!arguments.length)return projection;projectStream=(projection=_)?_.stream||d3_geo_pathProjectStream(_):d3_identity;return reset()};path.context=function(_){if(!arguments.length)return context;contextStream=(context=_)==null?new d3_geo_pathBuffer:new d3_geo_pathContext(_);if(typeof pointRadius!=="function")contextStream.pointRadius(pointRadius);return reset()};path.pointRadius=function(_){if(!arguments.length)return pointRadius;pointRadius=typeof _==="function"?_:(contextStream.pointRadius(+_),+_);return path};function reset(){cacheStream=null;return path}return path.projection(d3.geo.albersUsa()).context(null)};function d3_geo_pathProjectStream(project){var resample=d3_geo_resample((function(x,y){return project([x*d3_degrees,y*d3_degrees])}));return function(stream){return d3_geo_projectionRadians(resample(stream))}}d3.geo.transform=function(methods){return{stream:function(stream){var transform=new d3_geo_transform(stream);for(var k in methods)transform[k]=methods[k];return transform}}};function d3_geo_transform(stream){this.stream=stream}d3_geo_transform.prototype={point:function(x,y){this.stream.point(x,y)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function d3_geo_transformPoint(stream,point){return{point:point,sphere:function(){stream.sphere()},lineStart:function(){stream.lineStart()},lineEnd:function(){stream.lineEnd()},polygonStart:function(){stream.polygonStart()},polygonEnd:function(){stream.polygonEnd()}}}d3.geo.projection=d3_geo_projection;d3.geo.projectionMutator=d3_geo_projectionMutator;function d3_geo_projection(project){return d3_geo_projectionMutator((function(){return project}))()}function d3_geo_projectionMutator(projectAt){var project,rotate,projectRotate,projectResample=d3_geo_resample((function(x,y){x=project(x,y);return[x[0]*k+δx,δy-x[1]*k]})),k=150,x=480,y=250,λ=0,φ=0,δλ=0,δφ=0,δγ=0,δx,δy,preclip=d3_geo_clipAntimeridian,postclip=d3_identity,clipAngle=null,clipExtent=null,stream;function projection(point){point=projectRotate(point[0]*d3_radians,point[1]*d3_radians);return[point[0]*k+δx,δy-point[1]*k]}function invert(point){point=projectRotate.invert((point[0]-δx)/k,(δy-point[1])/k);return point&&[point[0]*d3_degrees,point[1]*d3_degrees]}projection.stream=function(output){if(stream)stream.valid=false;stream=d3_geo_projectionRadians(preclip(rotate,projectResample(postclip(output))));stream.valid=true;return stream};projection.clipAngle=function(_){if(!arguments.length)return clipAngle;preclip=_==null?(clipAngle=_,d3_geo_clipAntimeridian):d3_geo_clipCircle((clipAngle=+_)*d3_radians);return invalidate()};projection.clipExtent=function(_){if(!arguments.length)return clipExtent;clipExtent=_;postclip=_?d3_geo_clipExtent(_[0][0],_[0][1],_[1][0],_[1][1]):d3_identity;return invalidate()};projection.scale=function(_){if(!arguments.length)return k;k=+_;return reset()};projection.translate=function(_){if(!arguments.length)return[x,y];x=+_[0];y=+_[1];return reset()};projection.center=function(_){if(!arguments.length)return[λ*d3_degrees,φ*d3_degrees];λ=_[0]%360*d3_radians;φ=_[1]%360*d3_radians;return reset()};projection.rotate=function(_){if(!arguments.length)return[δλ*d3_degrees,δφ*d3_degrees,δγ*d3_degrees];δλ=_[0]%360*d3_radians;δφ=_[1]%360*d3_radians;δγ=_.length>2?_[2]%360*d3_radians:0;return reset()};d3.rebind(projection,projectResample,"precision");function reset(){projectRotate=d3_geo_compose(rotate=d3_geo_rotation(δλ,δφ,δγ),project);var center=project(λ,φ);δx=x-center[0]*k;δy=y+center[1]*k;return invalidate()}function invalidate(){if(stream)stream.valid=false,stream=null;return projection}return function(){project=projectAt.apply(this,arguments);projection.invert=project.invert&&invert;return reset()}}function d3_geo_projectionRadians(stream){return d3_geo_transformPoint(stream,(function(x,y){stream.point(x*d3_radians,y*d3_radians)}))}function d3_geo_equirectangular(λ,φ){return[λ,φ]}(d3.geo.equirectangular=function(){return d3_geo_projection(d3_geo_equirectangular)}).raw=d3_geo_equirectangular.invert=d3_geo_equirectangular;d3.geo.rotation=function(rotate){rotate=d3_geo_rotation(rotate[0]%360*d3_radians,rotate[1]*d3_radians,rotate.length>2?rotate[2]*d3_radians:0);function forward(coordinates){coordinates=rotate(coordinates[0]*d3_radians,coordinates[1]*d3_radians);return coordinates[0]*=d3_degrees,coordinates[1]*=d3_degrees,coordinates}forward.invert=function(coordinates){coordinates=rotate.invert(coordinates[0]*d3_radians,coordinates[1]*d3_radians);return coordinates[0]*=d3_degrees,coordinates[1]*=d3_degrees,coordinates};return forward};function d3_geo_identityRotation(λ,φ){return[λ>π?λ-τ:λ<-π?λ+τ:λ,φ]}d3_geo_identityRotation.invert=d3_geo_equirectangular;function d3_geo_rotation(δλ,δφ,δγ){return δλ?δφ||δγ?d3_geo_compose(d3_geo_rotationλ(δλ),d3_geo_rotationφγ(δφ,δγ)):d3_geo_rotationλ(δλ):δφ||δγ?d3_geo_rotationφγ(δφ,δγ):d3_geo_identityRotation}function d3_geo_forwardRotationλ(δλ){return function(λ,φ){return λ+=δλ,[λ>π?λ-τ:λ<-π?λ+τ:λ,φ]}}function d3_geo_rotationλ(δλ){var rotation=d3_geo_forwardRotationλ(δλ);rotation.invert=d3_geo_forwardRotationλ(-δλ);return rotation}function d3_geo_rotationφγ(δφ,δγ){var cosδφ=Math.cos(δφ),sinδφ=Math.sin(δφ),cosδγ=Math.cos(δγ),sinδγ=Math.sin(δγ);function rotation(λ,φ){var cosφ=Math.cos(φ),x=Math.cos(λ)*cosφ,y=Math.sin(λ)*cosφ,z=Math.sin(φ),k=z*cosδφ+x*sinδφ;return[Math.atan2(y*cosδγ-k*sinδγ,x*cosδφ-z*sinδφ),d3_asin(k*cosδγ+y*sinδγ)]}rotation.invert=function(λ,φ){var cosφ=Math.cos(φ),x=Math.cos(λ)*cosφ,y=Math.sin(λ)*cosφ,z=Math.sin(φ),k=z*cosδγ-y*sinδγ;return[Math.atan2(y*cosδγ+z*sinδγ,x*cosδφ+k*sinδφ),d3_asin(k*cosδφ-x*sinδφ)]};return rotation}d3.geo.circle=function(){var origin=[0,0],angle,precision=6,interpolate;function circle(){var center=typeof origin==="function"?origin.apply(this,arguments):origin,rotate=d3_geo_rotation(-center[0]*d3_radians,-center[1]*d3_radians,0).invert,ring=[];interpolate(null,null,1,{point:function(x,y){ring.push(x=rotate(x,y));x[0]*=d3_degrees,x[1]*=d3_degrees}});return{type:"Polygon",coordinates:[ring]}}circle.origin=function(x){if(!arguments.length)return origin;origin=x;return circle};circle.angle=function(x){if(!arguments.length)return angle;interpolate=d3_geo_circleInterpolate((angle=+x)*d3_radians,precision*d3_radians);return circle};circle.precision=function(_){if(!arguments.length)return precision;interpolate=d3_geo_circleInterpolate(angle*d3_radians,(precision=+_)*d3_radians);return circle};return circle.angle(90)};function d3_geo_circleInterpolate(radius,precision){var cr=Math.cos(radius),sr=Math.sin(radius);return function(from,to,direction,listener){var step=direction*precision;if(from!=null){from=d3_geo_circleAngle(cr,from);to=d3_geo_circleAngle(cr,to);if(direction>0?from<to:from>to)from+=direction*τ}else{from=radius+direction*τ;to=radius-.5*step}for(var point,t=from;direction>0?t>to:t<to;t-=step){listener.point((point=d3_geo_spherical([cr,-sr*Math.cos(t),-sr*Math.sin(t)]))[0],point[1])}}}function d3_geo_circleAngle(cr,point){var a=d3_geo_cartesian(point);a[0]-=cr;d3_geo_cartesianNormalize(a);var angle=d3_acos(-a[1]);return((-a[2]<0?-angle:angle)+2*Math.PI-ε)%(2*Math.PI)}d3.geo.distance=function(a,b){var Δλ=(b[0]-a[0])*d3_radians,φ0=a[1]*d3_radians,φ1=b[1]*d3_radians,sinΔλ=Math.sin(Δλ),cosΔλ=Math.cos(Δλ),sinφ0=Math.sin(φ0),cosφ0=Math.cos(φ0),sinφ1=Math.sin(φ1),cosφ1=Math.cos(φ1),t;return Math.atan2(Math.sqrt((t=cosφ1*sinΔλ)*t+(t=cosφ0*sinφ1-sinφ0*cosφ1*cosΔλ)*t),sinφ0*sinφ1+cosφ0*cosφ1*cosΔλ)};d3.geo.graticule=function(){var x1,x0,X1,X0,y1,y0,Y1,Y0,dx=10,dy=dx,DX=90,DY=360,x,y,X,Y,precision=2.5;function graticule(){return{type:"MultiLineString",coordinates:lines()}}function lines(){return d3.range(Math.ceil(X0/DX)*DX,X1,DX).map(X).concat(d3.range(Math.ceil(Y0/DY)*DY,Y1,DY).map(Y)).concat(d3.range(Math.ceil(x0/dx)*dx,x1,dx).filter((function(x){return abs(x%DX)>ε})).map(x)).concat(d3.range(Math.ceil(y0/dy)*dy,y1,dy).filter((function(y){return abs(y%DY)>ε})).map(y))}graticule.lines=function(){return lines().map((function(coordinates){return{type:"LineString",coordinates:coordinates}}))};graticule.outline=function(){return{type:"Polygon",coordinates:[X(X0).concat(Y(Y1).slice(1),X(X1).reverse().slice(1),Y(Y0).reverse().slice(1))]}};graticule.extent=function(_){if(!arguments.length)return graticule.minorExtent();return graticule.majorExtent(_).minorExtent(_)};graticule.majorExtent=function(_){if(!arguments.length)return[[X0,Y0],[X1,Y1]];X0=+_[0][0],X1=+_[1][0];Y0=+_[0][1],Y1=+_[1][1];if(X0>X1)_=X0,X0=X1,X1=_;if(Y0>Y1)_=Y0,Y0=Y1,Y1=_;return graticule.precision(precision)};graticule.minorExtent=function(_){if(!arguments.length)return[[x0,y0],[x1,y1]];x0=+_[0][0],x1=+_[1][0];y0=+_[0][1],y1=+_[1][1];if(x0>x1)_=x0,x0=x1,x1=_;if(y0>y1)_=y0,y0=y1,y1=_;return graticule.precision(precision)};graticule.step=function(_){if(!arguments.length)return graticule.minorStep();return graticule.majorStep(_).minorStep(_)};graticule.majorStep=function(_){if(!arguments.length)return[DX,DY];DX=+_[0],DY=+_[1];return graticule};graticule.minorStep=function(_){if(!arguments.length)return[dx,dy];dx=+_[0],dy=+_[1];return graticule};graticule.precision=function(_){if(!arguments.length)return precision;precision=+_;x=d3_geo_graticuleX(y0,y1,90);y=d3_geo_graticuleY(x0,x1,precision);X=d3_geo_graticuleX(Y0,Y1,90);Y=d3_geo_graticuleY(X0,X1,precision);return graticule};return graticule.majorExtent([[-180,-90+ε],[180,90-ε]]).minorExtent([[-180,-80-ε],[180,80+ε]])};function d3_geo_graticuleX(y0,y1,dy){var y=d3.range(y0,y1-ε,dy).concat(y1);return function(x){return y.map((function(y){return[x,y]}))}}function d3_geo_graticuleY(x0,x1,dx){var x=d3.range(x0,x1-ε,dx).concat(x1);return function(y){return x.map((function(x){return[x,y]}))}}function d3_source(d){return d.source}function d3_target(d){return d.target}d3.geo.greatArc=function(){var source=d3_source,source_,target=d3_target,target_;function greatArc(){return{type:"LineString",coordinates:[source_||source.apply(this,arguments),target_||target.apply(this,arguments)]}}greatArc.distance=function(){return d3.geo.distance(source_||source.apply(this,arguments),target_||target.apply(this,arguments))};greatArc.source=function(_){if(!arguments.length)return source;source=_,source_=typeof _==="function"?null:_;return greatArc};greatArc.target=function(_){if(!arguments.length)return target;target=_,target_=typeof _==="function"?null:_;return greatArc};greatArc.precision=function(){return arguments.length?greatArc:0};return greatArc};d3.geo.interpolate=function(source,target){return d3_geo_interpolate(source[0]*d3_radians,source[1]*d3_radians,target[0]*d3_radians,target[1]*d3_radians)};function d3_geo_interpolate(x0,y0,x1,y1){var cy0=Math.cos(y0),sy0=Math.sin(y0),cy1=Math.cos(y1),sy1=Math.sin(y1),kx0=cy0*Math.cos(x0),ky0=cy0*Math.sin(x0),kx1=cy1*Math.cos(x1),ky1=cy1*Math.sin(x1),d=2*Math.asin(Math.sqrt(d3_haversin(y1-y0)+cy0*cy1*d3_haversin(x1-x0))),k=1/Math.sin(d);var interpolate=d?function(t){var B=Math.sin(t*=d)*k,A=Math.sin(d-t)*k,x=A*kx0+B*kx1,y=A*ky0+B*ky1,z=A*sy0+B*sy1;return[Math.atan2(y,x)*d3_degrees,Math.atan2(z,Math.sqrt(x*x+y*y))*d3_degrees]}:function(){return[x0*d3_degrees,y0*d3_degrees]};interpolate.distance=d;return interpolate}d3.geo.length=function(object){d3_geo_lengthSum=0;d3.geo.stream(object,d3_geo_length);return d3_geo_lengthSum};var d3_geo_lengthSum;var d3_geo_length={sphere:d3_noop,point:d3_noop,lineStart:d3_geo_lengthLineStart,lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop};function d3_geo_lengthLineStart(){var λ0,sinφ0,cosφ0;d3_geo_length.point=function(λ,φ){λ0=λ*d3_radians,sinφ0=Math.sin(φ*=d3_radians),cosφ0=Math.cos(φ);d3_geo_length.point=nextPoint};d3_geo_length.lineEnd=function(){d3_geo_length.point=d3_geo_length.lineEnd=d3_noop};function nextPoint(λ,φ){var sinφ=Math.sin(φ*=d3_radians),cosφ=Math.cos(φ),t=abs((λ*=d3_radians)-λ0),cosΔλ=Math.cos(t);d3_geo_lengthSum+=Math.atan2(Math.sqrt((t=cosφ*Math.sin(t))*t+(t=cosφ0*sinφ-sinφ0*cosφ*cosΔλ)*t),sinφ0*sinφ+cosφ0*cosφ*cosΔλ);λ0=λ,sinφ0=sinφ,cosφ0=cosφ}}function d3_geo_azimuthal(scale,angle){function azimuthal(λ,φ){var cosλ=Math.cos(λ),cosφ=Math.cos(φ),k=scale(cosλ*cosφ);return[k*cosφ*Math.sin(λ),k*Math.sin(φ)]}azimuthal.invert=function(x,y){var ρ=Math.sqrt(x*x+y*y),c=angle(ρ),sinc=Math.sin(c),cosc=Math.cos(c);return[Math.atan2(x*sinc,ρ*cosc),Math.asin(ρ&&y*sinc/ρ)]};return azimuthal}var d3_geo_azimuthalEqualArea=d3_geo_azimuthal((function(cosλcosφ){return Math.sqrt(2/(1+cosλcosφ))}),(function(ρ){return 2*Math.asin(ρ/2)}));(d3.geo.azimuthalEqualArea=function(){return d3_geo_projection(d3_geo_azimuthalEqualArea)}).raw=d3_geo_azimuthalEqualArea;var d3_geo_azimuthalEquidistant=d3_geo_azimuthal((function(cosλcosφ){var c=Math.acos(cosλcosφ);return c&&c/Math.sin(c)}),d3_identity);(d3.geo.azimuthalEquidistant=function(){return d3_geo_projection(d3_geo_azimuthalEquidistant)}).raw=d3_geo_azimuthalEquidistant;function d3_geo_conicConformal(φ0,φ1){var cosφ0=Math.cos(φ0),t=function(φ){return Math.tan(π/4+φ/2)},n=φ0===φ1?Math.sin(φ0):Math.log(cosφ0/Math.cos(φ1))/Math.log(t(φ1)/t(φ0)),F=cosφ0*Math.pow(t(φ0),n)/n;if(!n)return d3_geo_mercator;function forward(λ,φ){if(F>0){if(φ<-halfπ+ε)φ=-halfπ+ε}else{if(φ>halfπ-ε)φ=halfπ-ε}var ρ=F/Math.pow(t(φ),n);return[ρ*Math.sin(n*λ),F-ρ*Math.cos(n*λ)]}forward.invert=function(x,y){var ρ0_y=F-y,ρ=d3_sgn(n)*Math.sqrt(x*x+ρ0_y*ρ0_y);return[Math.atan2(x,ρ0_y)/n,2*Math.atan(Math.pow(F/ρ,1/n))-halfπ]};return forward}(d3.geo.conicConformal=function(){return d3_geo_conic(d3_geo_conicConformal)}).raw=d3_geo_conicConformal;function d3_geo_conicEquidistant(φ0,φ1){var cosφ0=Math.cos(φ0),n=φ0===φ1?Math.sin(φ0):(cosφ0-Math.cos(φ1))/(φ1-φ0),G=cosφ0/n+φ0;if(abs(n)<ε)return d3_geo_equirectangular;function forward(λ,φ){var ρ=G-φ;return[ρ*Math.sin(n*λ),G-ρ*Math.cos(n*λ)]}forward.invert=function(x,y){var ρ0_y=G-y;return[Math.atan2(x,ρ0_y)/n,G-d3_sgn(n)*Math.sqrt(x*x+ρ0_y*ρ0_y)]};return forward}(d3.geo.conicEquidistant=function(){return d3_geo_conic(d3_geo_conicEquidistant)}).raw=d3_geo_conicEquidistant;var d3_geo_gnomonic=d3_geo_azimuthal((function(cosλcosφ){return 1/cosλcosφ}),Math.atan);(d3.geo.gnomonic=function(){return d3_geo_projection(d3_geo_gnomonic)}).raw=d3_geo_gnomonic;function d3_geo_mercator(λ,φ){return[λ,Math.log(Math.tan(π/4+φ/2))]}d3_geo_mercator.invert=function(x,y){return[x,2*Math.atan(Math.exp(y))-halfπ]};function d3_geo_mercatorProjection(project){var m=d3_geo_projection(project),scale=m.scale,translate=m.translate,clipExtent=m.clipExtent,clipAuto;m.scale=function(){var v=scale.apply(m,arguments);return v===m?clipAuto?m.clipExtent(null):m:v};m.translate=function(){var v=translate.apply(m,arguments);return v===m?clipAuto?m.clipExtent(null):m:v};m.clipExtent=function(_){var v=clipExtent.apply(m,arguments);if(v===m){if(clipAuto=_==null){var k=π*scale(),t=translate();clipExtent([[t[0]-k,t[1]-k],[t[0]+k,t[1]+k]])}}else if(clipAuto){v=null}return v};return m.clipExtent(null)}(d3.geo.mercator=function(){return d3_geo_mercatorProjection(d3_geo_mercator)}).raw=d3_geo_mercator;var d3_geo_orthographic=d3_geo_azimuthal((function(){return 1}),Math.asin);(d3.geo.orthographic=function(){return d3_geo_projection(d3_geo_orthographic)}).raw=d3_geo_orthographic;var d3_geo_stereographic=d3_geo_azimuthal((function(cosλcosφ){return 1/(1+cosλcosφ)}),(function(ρ){return 2*Math.atan(ρ)}));(d3.geo.stereographic=function(){return d3_geo_projection(d3_geo_stereographic)}).raw=d3_geo_stereographic;function d3_geo_transverseMercator(λ,φ){return[Math.log(Math.tan(π/4+φ/2)),-λ]}d3_geo_transverseMercator.invert=function(x,y){return[-y,2*Math.atan(Math.exp(x))-halfπ]};(d3.geo.transverseMercator=function(){var projection=d3_geo_mercatorProjection(d3_geo_transverseMercator),center=projection.center,rotate=projection.rotate;projection.center=function(_){return _?center([-_[1],_[0]]):(_=center(),[_[1],-_[0]])};projection.rotate=function(_){return _?rotate([_[0],_[1],_.length>2?_[2]+90:90]):(_=rotate(),[_[0],_[1],_[2]-90])};return rotate([0,0,90])}).raw=d3_geo_transverseMercator;d3.geom={};function d3_geom_pointX(d){return d[0]}function d3_geom_pointY(d){return d[1]}d3.geom.hull=function(vertices){var x=d3_geom_pointX,y=d3_geom_pointY;if(arguments.length)return hull(vertices);function hull(data){if(data.length<3)return[];var fx=d3_functor(x),fy=d3_functor(y),i,n=data.length,points=[],flippedPoints=[];for(i=0;i<n;i++){points.push([+fx.call(this,data[i],i),+fy.call(this,data[i],i),i])}points.sort(d3_geom_hullOrder);for(i=0;i<n;i++)flippedPoints.push([points[i][0],-points[i][1]]);var upper=d3_geom_hullUpper(points),lower=d3_geom_hullUpper(flippedPoints);var skipLeft=lower[0]===upper[0],skipRight=lower[lower.length-1]===upper[upper.length-1],polygon=[];for(i=upper.length-1;i>=0;--i)polygon.push(data[points[upper[i]][2]]);for(i=+skipLeft;i<lower.length-skipRight;++i)polygon.push(data[points[lower[i]][2]]);return polygon}hull.x=function(_){return arguments.length?(x=_,hull):x};hull.y=function(_){return arguments.length?(y=_,hull):y};return hull};function d3_geom_hullUpper(points){var n=points.length,hull=[0,1],hs=2;for(var i=2;i<n;i++){while(hs>1&&d3_cross2d(points[hull[hs-2]],points[hull[hs-1]],points[i])<=0)--hs;hull[hs++]=i}return hull.slice(0,hs)}function d3_geom_hullOrder(a,b){return a[0]-b[0]||a[1]-b[1]}d3.geom.polygon=function(coordinates){d3_subclass(coordinates,d3_geom_polygonPrototype);return coordinates};var d3_geom_polygonPrototype=d3.geom.polygon.prototype=[];d3_geom_polygonPrototype.area=function(){var i=-1,n=this.length,a,b=this[n-1],area=0;while(++i<n){a=b;b=this[i];area+=a[1]*b[0]-a[0]*b[1]}return area*.5};d3_geom_polygonPrototype.centroid=function(k){var i=-1,n=this.length,x=0,y=0,a,b=this[n-1],c;if(!arguments.length)k=-1/(6*this.area());while(++i<n){a=b;b=this[i];c=a[0]*b[1]-b[0]*a[1];x+=(a[0]+b[0])*c;y+=(a[1]+b[1])*c}return[x*k,y*k]};d3_geom_polygonPrototype.clip=function(subject){var input,closed=d3_geom_polygonClosed(subject),i=-1,n=this.length-d3_geom_polygonClosed(this),j,m,a=this[n-1],b,c,d;while(++i<n){input=subject.slice();subject.length=0;b=this[i];c=input[(m=input.length-closed)-1];j=-1;while(++j<m){d=input[j];if(d3_geom_polygonInside(d,a,b)){if(!d3_geom_polygonInside(c,a,b)){subject.push(d3_geom_polygonIntersect(c,d,a,b))}subject.push(d)}else if(d3_geom_polygonInside(c,a,b)){subject.push(d3_geom_polygonIntersect(c,d,a,b))}c=d}if(closed)subject.push(subject[0]);a=b}return subject};function d3_geom_polygonInside(p,a,b){return(b[0]-a[0])*(p[1]-a[1])<(b[1]-a[1])*(p[0]-a[0])}function d3_geom_polygonIntersect(c,d,a,b){var x1=c[0],x3=a[0],x21=d[0]-x1,x43=b[0]-x3,y1=c[1],y3=a[1],y21=d[1]-y1,y43=b[1]-y3,ua=(x43*(y1-y3)-y43*(x1-x3))/(y43*x21-x43*y21);return[x1+ua*x21,y1+ua*y21]}function d3_geom_polygonClosed(coordinates){var a=coordinates[0],b=coordinates[coordinates.length-1];return!(a[0]-b[0]||a[1]-b[1])}var d3_geom_voronoiEdges,d3_geom_voronoiCells,d3_geom_voronoiBeaches,d3_geom_voronoiBeachPool=[],d3_geom_voronoiFirstCircle,d3_geom_voronoiCircles,d3_geom_voronoiCirclePool=[];function d3_geom_voronoiBeach(){d3_geom_voronoiRedBlackNode(this);this.edge=this.site=this.circle=null}function d3_geom_voronoiCreateBeach(site){var beach=d3_geom_voronoiBeachPool.pop()||new d3_geom_voronoiBeach;beach.site=site;return beach}function d3_geom_voronoiDetachBeach(beach){d3_geom_voronoiDetachCircle(beach);d3_geom_voronoiBeaches.remove(beach);d3_geom_voronoiBeachPool.push(beach);d3_geom_voronoiRedBlackNode(beach)}function d3_geom_voronoiRemoveBeach(beach){var circle=beach.circle,x=circle.x,y=circle.cy,vertex={x:x,y:y},previous=beach.P,next=beach.N,disappearing=[beach];d3_geom_voronoiDetachBeach(beach);var lArc=previous;while(lArc.circle&&abs(x-lArc.circle.x)<ε&&abs(y-lArc.circle.cy)<ε){previous=lArc.P;disappearing.unshift(lArc);d3_geom_voronoiDetachBeach(lArc);lArc=previous}disappearing.unshift(lArc);d3_geom_voronoiDetachCircle(lArc);var rArc=next;while(rArc.circle&&abs(x-rArc.circle.x)<ε&&abs(y-rArc.circle.cy)<ε){next=rArc.N;disappearing.push(rArc);d3_geom_voronoiDetachBeach(rArc);rArc=next}disappearing.push(rArc);d3_geom_voronoiDetachCircle(rArc);var nArcs=disappearing.length,iArc;for(iArc=1;iArc<nArcs;++iArc){rArc=disappearing[iArc];lArc=disappearing[iArc-1];d3_geom_voronoiSetEdgeEnd(rArc.edge,lArc.site,rArc.site,vertex)}lArc=disappearing[0];rArc=disappearing[nArcs-1];rArc.edge=d3_geom_voronoiCreateEdge(lArc.site,rArc.site,null,vertex);d3_geom_voronoiAttachCircle(lArc);d3_geom_voronoiAttachCircle(rArc)}function d3_geom_voronoiAddBeach(site){var x=site.x,directrix=site.y,lArc,rArc,dxl,dxr,node=d3_geom_voronoiBeaches._;while(node){dxl=d3_geom_voronoiLeftBreakPoint(node,directrix)-x;if(dxl>ε)node=node.L;else{dxr=x-d3_geom_voronoiRightBreakPoint(node,directrix);if(dxr>ε){if(!node.R){lArc=node;break}node=node.R}else{if(dxl>-ε){lArc=node.P;rArc=node}else if(dxr>-ε){lArc=node;rArc=node.N}else{lArc=rArc=node}break}}}var newArc=d3_geom_voronoiCreateBeach(site);d3_geom_voronoiBeaches.insert(lArc,newArc);if(!lArc&&!rArc)return;if(lArc===rArc){d3_geom_voronoiDetachCircle(lArc);rArc=d3_geom_voronoiCreateBeach(lArc.site);d3_geom_voronoiBeaches.insert(newArc,rArc);newArc.edge=rArc.edge=d3_geom_voronoiCreateEdge(lArc.site,newArc.site);d3_geom_voronoiAttachCircle(lArc);d3_geom_voronoiAttachCircle(rArc);return}if(!rArc){newArc.edge=d3_geom_voronoiCreateEdge(lArc.site,newArc.site);return}d3_geom_voronoiDetachCircle(lArc);d3_geom_voronoiDetachCircle(rArc);var lSite=lArc.site,ax=lSite.x,ay=lSite.y,bx=site.x-ax,by=site.y-ay,rSite=rArc.site,cx=rSite.x-ax,cy=rSite.y-ay,d=2*(bx*cy-by*cx),hb=bx*bx+by*by,hc=cx*cx+cy*cy,vertex={x:(cy*hb-by*hc)/d+ax,y:(bx*hc-cx*hb)/d+ay};d3_geom_voronoiSetEdgeEnd(rArc.edge,lSite,rSite,vertex);newArc.edge=d3_geom_voronoiCreateEdge(lSite,site,null,vertex);rArc.edge=d3_geom_voronoiCreateEdge(site,rSite,null,vertex);d3_geom_voronoiAttachCircle(lArc);d3_geom_voronoiAttachCircle(rArc)}function d3_geom_voronoiLeftBreakPoint(arc,directrix){var site=arc.site,rfocx=site.x,rfocy=site.y,pby2=rfocy-directrix;if(!pby2)return rfocx;var lArc=arc.P;if(!lArc)return-Infinity;site=lArc.site;var lfocx=site.x,lfocy=site.y,plby2=lfocy-directrix;if(!plby2)return lfocx;var hl=lfocx-rfocx,aby2=1/pby2-1/plby2,b=hl/plby2;if(aby2)return(-b+Math.sqrt(b*b-2*aby2*(hl*hl/(-2*plby2)-lfocy+plby2/2+rfocy-pby2/2)))/aby2+rfocx;return(rfocx+lfocx)/2}function d3_geom_voronoiRightBreakPoint(arc,directrix){var rArc=arc.N;if(rArc)return d3_geom_voronoiLeftBreakPoint(rArc,directrix);var site=arc.site;return site.y===directrix?site.x:Infinity}function d3_geom_voronoiCell(site){this.site=site;this.edges=[]}d3_geom_voronoiCell.prototype.prepare=function(){var halfEdges=this.edges,iHalfEdge=halfEdges.length,edge;while(iHalfEdge--){edge=halfEdges[iHalfEdge].edge;if(!edge.b||!edge.a)halfEdges.splice(iHalfEdge,1)}halfEdges.sort(d3_geom_voronoiHalfEdgeOrder);return halfEdges.length};function d3_geom_voronoiCloseCells(extent){var x0=extent[0][0],x1=extent[1][0],y0=extent[0][1],y1=extent[1][1],x2,y2,x3,y3,cells=d3_geom_voronoiCells,iCell=cells.length,cell,iHalfEdge,halfEdges,nHalfEdges,start,end;while(iCell--){cell=cells[iCell];if(!cell||!cell.prepare())continue;halfEdges=cell.edges;nHalfEdges=halfEdges.length;iHalfEdge=0;while(iHalfEdge<nHalfEdges){end=halfEdges[iHalfEdge].end(),x3=end.x,y3=end.y;start=halfEdges[++iHalfEdge%nHalfEdges].start(),x2=start.x,y2=start.y;if(abs(x3-x2)>ε||abs(y3-y2)>ε){halfEdges.splice(iHalfEdge,0,new d3_geom_voronoiHalfEdge(d3_geom_voronoiCreateBorderEdge(cell.site,end,abs(x3-x0)<ε&&y1-y3>ε?{x:x0,y:abs(x2-x0)<ε?y2:y1}:abs(y3-y1)<ε&&x1-x3>ε?{x:abs(y2-y1)<ε?x2:x1,y:y1}:abs(x3-x1)<ε&&y3-y0>ε?{x:x1,y:abs(x2-x1)<ε?y2:y0}:abs(y3-y0)<ε&&x3-x0>ε?{x:abs(y2-y0)<ε?x2:x0,y:y0}:null),cell.site,null));++nHalfEdges}}}}function d3_geom_voronoiHalfEdgeOrder(a,b){return b.angle-a.angle}function d3_geom_voronoiCircle(){d3_geom_voronoiRedBlackNode(this);this.x=this.y=this.arc=this.site=this.cy=null}function d3_geom_voronoiAttachCircle(arc){var lArc=arc.P,rArc=arc.N;if(!lArc||!rArc)return;var lSite=lArc.site,cSite=arc.site,rSite=rArc.site;if(lSite===rSite)return;var bx=cSite.x,by=cSite.y,ax=lSite.x-bx,ay=lSite.y-by,cx=rSite.x-bx,cy=rSite.y-by;var d=2*(ax*cy-ay*cx);if(d>=-ε2)return;var ha=ax*ax+ay*ay,hc=cx*cx+cy*cy,x=(cy*ha-ay*hc)/d,y=(ax*hc-cx*ha)/d,cy=y+by;var circle=d3_geom_voronoiCirclePool.pop()||new d3_geom_voronoiCircle;circle.arc=arc;circle.site=cSite;circle.x=x+bx;circle.y=cy+Math.sqrt(x*x+y*y);circle.cy=cy;arc.circle=circle;var before=null,node=d3_geom_voronoiCircles._;while(node){if(circle.y<node.y||circle.y===node.y&&circle.x<=node.x){if(node.L)node=node.L;else{before=node.P;break}}else{if(node.R)node=node.R;else{before=node;break}}}d3_geom_voronoiCircles.insert(before,circle);if(!before)d3_geom_voronoiFirstCircle=circle}function d3_geom_voronoiDetachCircle(arc){var circle=arc.circle;if(circle){if(!circle.P)d3_geom_voronoiFirstCircle=circle.N;d3_geom_voronoiCircles.remove(circle);d3_geom_voronoiCirclePool.push(circle);d3_geom_voronoiRedBlackNode(circle);arc.circle=null}}function d3_geom_voronoiClipEdges(extent){var edges=d3_geom_voronoiEdges,clip=d3_geom_clipLine(extent[0][0],extent[0][1],extent[1][0],extent[1][1]),i=edges.length,e;while(i--){e=edges[i];if(!d3_geom_voronoiConnectEdge(e,extent)||!clip(e)||abs(e.a.x-e.b.x)<ε&&abs(e.a.y-e.b.y)<ε){e.a=e.b=null;edges.splice(i,1)}}}function d3_geom_voronoiConnectEdge(edge,extent){var vb=edge.b;if(vb)return true;var va=edge.a,x0=extent[0][0],x1=extent[1][0],y0=extent[0][1],y1=extent[1][1],lSite=edge.l,rSite=edge.r,lx=lSite.x,ly=lSite.y,rx=rSite.x,ry=rSite.y,fx=(lx+rx)/2,fy=(ly+ry)/2,fm,fb;if(ry===ly){if(fx<x0||fx>=x1)return;if(lx>rx){if(!va)va={x:fx,y:y0};else if(va.y>=y1)return;vb={x:fx,y:y1}}else{if(!va)va={x:fx,y:y1};else if(va.y<y0)return;vb={x:fx,y:y0}}}else{fm=(lx-rx)/(ry-ly);fb=fy-fm*fx;if(fm<-1||fm>1){if(lx>rx){if(!va)va={x:(y0-fb)/fm,y:y0};else if(va.y>=y1)return;vb={x:(y1-fb)/fm,y:y1}}else{if(!va)va={x:(y1-fb)/fm,y:y1};else if(va.y<y0)return;vb={x:(y0-fb)/fm,y:y0}}}else{if(ly<ry){if(!va)va={x:x0,y:fm*x0+fb};else if(va.x>=x1)return;vb={x:x1,y:fm*x1+fb}}else{if(!va)va={x:x1,y:fm*x1+fb};else if(va.x<x0)return;vb={x:x0,y:fm*x0+fb}}}}edge.a=va;edge.b=vb;return true}function d3_geom_voronoiEdge(lSite,rSite){this.l=lSite;this.r=rSite;this.a=this.b=null}function d3_geom_voronoiCreateEdge(lSite,rSite,va,vb){var edge=new d3_geom_voronoiEdge(lSite,rSite);d3_geom_voronoiEdges.push(edge);if(va)d3_geom_voronoiSetEdgeEnd(edge,lSite,rSite,va);if(vb)d3_geom_voronoiSetEdgeEnd(edge,rSite,lSite,vb);d3_geom_voronoiCells[lSite.i].edges.push(new d3_geom_voronoiHalfEdge(edge,lSite,rSite));d3_geom_voronoiCells[rSite.i].edges.push(new d3_geom_voronoiHalfEdge(edge,rSite,lSite));return edge}function d3_geom_voronoiCreateBorderEdge(lSite,va,vb){var edge=new d3_geom_voronoiEdge(lSite,null);edge.a=va;edge.b=vb;d3_geom_voronoiEdges.push(edge);return edge}function d3_geom_voronoiSetEdgeEnd(edge,lSite,rSite,vertex){if(!edge.a&&!edge.b){edge.a=vertex;edge.l=lSite;edge.r=rSite}else if(edge.l===rSite){edge.b=vertex}else{edge.a=vertex}}function d3_geom_voronoiHalfEdge(edge,lSite,rSite){var va=edge.a,vb=edge.b;this.edge=edge;this.site=lSite;this.angle=rSite?Math.atan2(rSite.y-lSite.y,rSite.x-lSite.x):edge.l===lSite?Math.atan2(vb.x-va.x,va.y-vb.y):Math.atan2(va.x-vb.x,vb.y-va.y)}d3_geom_voronoiHalfEdge.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function d3_geom_voronoiRedBlackTree(){this._=null}function d3_geom_voronoiRedBlackNode(node){node.U=node.C=node.L=node.R=node.P=node.N=null}d3_geom_voronoiRedBlackTree.prototype={insert:function(after,node){var parent,grandpa,uncle;if(after){node.P=after;node.N=after.N;if(after.N)after.N.P=node;after.N=node;if(after.R){after=after.R;while(after.L)after=after.L;after.L=node}else{after.R=node}parent=after}else if(this._){after=d3_geom_voronoiRedBlackFirst(this._);node.P=null;node.N=after;after.P=after.L=node;parent=after}else{node.P=node.N=null;this._=node;parent=null}node.L=node.R=null;node.U=parent;node.C=true;after=node;while(parent&&parent.C){grandpa=parent.U;if(parent===grandpa.L){uncle=grandpa.R;if(uncle&&uncle.C){parent.C=uncle.C=false;grandpa.C=true;after=grandpa}else{if(after===parent.R){d3_geom_voronoiRedBlackRotateLeft(this,parent);after=parent;parent=after.U}parent.C=false;grandpa.C=true;d3_geom_voronoiRedBlackRotateRight(this,grandpa)}}else{uncle=grandpa.L;if(uncle&&uncle.C){parent.C=uncle.C=false;grandpa.C=true;after=grandpa}else{if(after===parent.L){d3_geom_voronoiRedBlackRotateRight(this,parent);after=parent;parent=after.U}parent.C=false;grandpa.C=true;d3_geom_voronoiRedBlackRotateLeft(this,grandpa)}}parent=after.U}this._.C=false},remove:function(node){if(node.N)node.N.P=node.P;if(node.P)node.P.N=node.N;node.N=node.P=null;var parent=node.U,sibling,left=node.L,right=node.R,next,red;if(!left)next=right;else if(!right)next=left;else next=d3_geom_voronoiRedBlackFirst(right);if(parent){if(parent.L===node)parent.L=next;else parent.R=next}else{this._=next}if(left&&right){red=next.C;next.C=node.C;next.L=left;left.U=next;if(next!==right){parent=next.U;next.U=node.U;node=next.R;parent.L=node;next.R=right;right.U=next}else{next.U=parent;parent=next;node=next.R}}else{red=node.C;node=next}if(node)node.U=parent;if(red)return;if(node&&node.C){node.C=false;return}do{if(node===this._)break;if(node===parent.L){sibling=parent.R;if(sibling.C){sibling.C=false;parent.C=true;d3_geom_voronoiRedBlackRotateLeft(this,parent);sibling=parent.R}if(sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){if(!sibling.R||!sibling.R.C){sibling.L.C=false;sibling.C=true;d3_geom_voronoiRedBlackRotateRight(this,sibling);sibling=parent.R}sibling.C=parent.C;parent.C=sibling.R.C=false;d3_geom_voronoiRedBlackRotateLeft(this,parent);node=this._;break}}else{sibling=parent.L;if(sibling.C){sibling.C=false;parent.C=true;d3_geom_voronoiRedBlackRotateRight(this,parent);sibling=parent.L}if(sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){if(!sibling.L||!sibling.L.C){sibling.R.C=false;sibling.C=true;d3_geom_voronoiRedBlackRotateLeft(this,sibling);sibling=parent.L}sibling.C=parent.C;parent.C=sibling.L.C=false;d3_geom_voronoiRedBlackRotateRight(this,parent);node=this._;break}}sibling.C=true;node=parent;parent=parent.U}while(!node.C);if(node)node.C=false}};function d3_geom_voronoiRedBlackRotateLeft(tree,node){var p=node,q=node.R,parent=p.U;if(parent){if(parent.L===p)parent.L=q;else parent.R=q}else{tree._=q}q.U=parent;p.U=q;p.R=q.L;if(p.R)p.R.U=p;q.L=p}function d3_geom_voronoiRedBlackRotateRight(tree,node){var p=node,q=node.L,parent=p.U;if(parent){if(parent.L===p)parent.L=q;else parent.R=q}else{tree._=q}q.U=parent;p.U=q;p.L=q.R;if(p.L)p.L.U=p;q.R=p}function d3_geom_voronoiRedBlackFirst(node){while(node.L)node=node.L;return node}function d3_geom_voronoi(sites,bbox){var site=sites.sort(d3_geom_voronoiVertexOrder).pop(),x0,y0,circle;d3_geom_voronoiEdges=[];d3_geom_voronoiCells=new Array(sites.length);d3_geom_voronoiBeaches=new d3_geom_voronoiRedBlackTree;d3_geom_voronoiCircles=new d3_geom_voronoiRedBlackTree;while(true){circle=d3_geom_voronoiFirstCircle;if(site&&(!circle||site.y<circle.y||site.y===circle.y&&site.x<circle.x)){if(site.x!==x0||site.y!==y0){d3_geom_voronoiCells[site.i]=new d3_geom_voronoiCell(site);d3_geom_voronoiAddBeach(site);x0=site.x,y0=site.y}site=sites.pop()}else if(circle){d3_geom_voronoiRemoveBeach(circle.arc)}else{break}}if(bbox)d3_geom_voronoiClipEdges(bbox),d3_geom_voronoiCloseCells(bbox);var diagram={cells:d3_geom_voronoiCells,edges:d3_geom_voronoiEdges};d3_geom_voronoiBeaches=d3_geom_voronoiCircles=d3_geom_voronoiEdges=d3_geom_voronoiCells=null;return diagram}function d3_geom_voronoiVertexOrder(a,b){return b.y-a.y||b.x-a.x}d3.geom.voronoi=function(points){var x=d3_geom_pointX,y=d3_geom_pointY,fx=x,fy=y,clipExtent=d3_geom_voronoiClipExtent;if(points)return voronoi(points);function voronoi(data){var polygons=new Array(data.length),x0=clipExtent[0][0],y0=clipExtent[0][1],x1=clipExtent[1][0],y1=clipExtent[1][1];d3_geom_voronoi(sites(data),clipExtent).cells.forEach((function(cell,i){var edges=cell.edges,site=cell.site,polygon=polygons[i]=edges.length?edges.map((function(e){var s=e.start();return[s.x,s.y]})):site.x>=x0&&site.x<=x1&&site.y>=y0&&site.y<=y1?[[x0,y1],[x1,y1],[x1,y0],[x0,y0]]:[];polygon.point=data[i]}));return polygons}function sites(data){return data.map((function(d,i){return{x:Math.round(fx(d,i)/ε)*ε,y:Math.round(fy(d,i)/ε)*ε,i:i}}))}voronoi.links=function(data){return d3_geom_voronoi(sites(data)).edges.filter((function(edge){return edge.l&&edge.r})).map((function(edge){return{source:data[edge.l.i],target:data[edge.r.i]}}))};voronoi.triangles=function(data){var triangles=[];d3_geom_voronoi(sites(data)).cells.forEach((function(cell,i){var site=cell.site,edges=cell.edges.sort(d3_geom_voronoiHalfEdgeOrder),j=-1,m=edges.length,e0,s0,e1=edges[m-1].edge,s1=e1.l===site?e1.r:e1.l;while(++j<m){e0=e1;s0=s1;e1=edges[j].edge;s1=e1.l===site?e1.r:e1.l;if(i<s0.i&&i<s1.i&&d3_geom_voronoiTriangleArea(site,s0,s1)<0){triangles.push([data[i],data[s0.i],data[s1.i]])}}}));return triangles};voronoi.x=function(_){return arguments.length?(fx=d3_functor(x=_),voronoi):x};voronoi.y=function(_){return arguments.length?(fy=d3_functor(y=_),voronoi):y};voronoi.clipExtent=function(_){if(!arguments.length)return clipExtent===d3_geom_voronoiClipExtent?null:clipExtent;clipExtent=_==null?d3_geom_voronoiClipExtent:_;return voronoi};voronoi.size=function(_){if(!arguments.length)return clipExtent===d3_geom_voronoiClipExtent?null:clipExtent&&clipExtent[1];return voronoi.clipExtent(_&&[[0,0],_])};return voronoi};var d3_geom_voronoiClipExtent=[[-1e6,-1e6],[1e6,1e6]];function d3_geom_voronoiTriangleArea(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}d3.geom.delaunay=function(vertices){return d3.geom.voronoi().triangles(vertices)};d3.geom.quadtree=function(points,x1,y1,x2,y2){var x=d3_geom_pointX,y=d3_geom_pointY,compat;if(compat=arguments.length){x=d3_geom_quadtreeCompatX;y=d3_geom_quadtreeCompatY;if(compat===3){y2=y1;x2=x1;y1=x1=0}return quadtree(points)}function quadtree(data){var d,fx=d3_functor(x),fy=d3_functor(y),xs,ys,i,n,x1_,y1_,x2_,y2_;if(x1!=null){x1_=x1,y1_=y1,x2_=x2,y2_=y2}else{x2_=y2_=-(x1_=y1_=Infinity);xs=[],ys=[];n=data.length;if(compat)for(i=0;i<n;++i){d=data[i];if(d.x<x1_)x1_=d.x;if(d.y<y1_)y1_=d.y;if(d.x>x2_)x2_=d.x;if(d.y>y2_)y2_=d.y;xs.push(d.x);ys.push(d.y)}else for(i=0;i<n;++i){var x_=+fx(d=data[i],i),y_=+fy(d,i);if(x_<x1_)x1_=x_;if(y_<y1_)y1_=y_;if(x_>x2_)x2_=x_;if(y_>y2_)y2_=y_;xs.push(x_);ys.push(y_)}}var dx=x2_-x1_,dy=y2_-y1_;if(dx>dy)y2_=y1_+dx;else x2_=x1_+dy;function insert(n,d,x,y,x1,y1,x2,y2){if(isNaN(x)||isNaN(y))return;if(n.leaf){var nx=n.x,ny=n.y;if(nx!=null){if(abs(nx-x)+abs(ny-y)<.01){insertChild(n,d,x,y,x1,y1,x2,y2)}else{var nPoint=n.point;n.x=n.y=n.point=null;insertChild(n,nPoint,nx,ny,x1,y1,x2,y2);insertChild(n,d,x,y,x1,y1,x2,y2)}}else{n.x=x,n.y=y,n.point=d}}else{insertChild(n,d,x,y,x1,y1,x2,y2)}}function insertChild(n,d,x,y,x1,y1,x2,y2){var xm=(x1+x2)*.5,ym=(y1+y2)*.5,right=x>=xm,below=y>=ym,i=below<<1|right;n.leaf=false;n=n.nodes[i]||(n.nodes[i]=d3_geom_quadtreeNode());if(right)x1=xm;else x2=xm;if(below)y1=ym;else y2=ym;insert(n,d,x,y,x1,y1,x2,y2)}var root=d3_geom_quadtreeNode();root.add=function(d){insert(root,d,+fx(d,++i),+fy(d,i),x1_,y1_,x2_,y2_)};root.visit=function(f){d3_geom_quadtreeVisit(f,root,x1_,y1_,x2_,y2_)};root.find=function(point){return d3_geom_quadtreeFind(root,point[0],point[1],x1_,y1_,x2_,y2_)};i=-1;if(x1==null){while(++i<n){insert(root,data[i],xs[i],ys[i],x1_,y1_,x2_,y2_)}--i}else data.forEach(root.add);xs=ys=data=d=null;return root}quadtree.x=function(_){return arguments.length?(x=_,quadtree):x};quadtree.y=function(_){return arguments.length?(y=_,quadtree):y};quadtree.extent=function(_){if(!arguments.length)return x1==null?null:[[x1,y1],[x2,y2]];if(_==null)x1=y1=x2=y2=null;else x1=+_[0][0],y1=+_[0][1],x2=+_[1][0],y2=+_[1][1];return quadtree};quadtree.size=function(_){if(!arguments.length)return x1==null?null:[x2-x1,y2-y1];if(_==null)x1=y1=x2=y2=null;else x1=y1=0,x2=+_[0],y2=+_[1];return quadtree};return quadtree};function d3_geom_quadtreeCompatX(d){return d.x}function d3_geom_quadtreeCompatY(d){return d.y}function d3_geom_quadtreeNode(){return{leaf:true,nodes:[],point:null,x:null,y:null}}function d3_geom_quadtreeVisit(f,node,x1,y1,x2,y2){if(!f(node,x1,y1,x2,y2)){var sx=(x1+x2)*.5,sy=(y1+y2)*.5,children=node.nodes;if(children[0])d3_geom_quadtreeVisit(f,children[0],x1,y1,sx,sy);if(children[1])d3_geom_quadtreeVisit(f,children[1],sx,y1,x2,sy);if(children[2])d3_geom_quadtreeVisit(f,children[2],x1,sy,sx,y2);if(children[3])d3_geom_quadtreeVisit(f,children[3],sx,sy,x2,y2)}}function d3_geom_quadtreeFind(root,x,y,x0,y0,x3,y3){var minDistance2=Infinity,closestPoint;(function find(node,x1,y1,x2,y2){if(x1>x3||y1>y3||x2<x0||y2<y0)return;if(point=node.point){var point,dx=x-node.x,dy=y-node.y,distance2=dx*dx+dy*dy;if(distance2<minDistance2){var distance=Math.sqrt(minDistance2=distance2);x0=x-distance,y0=y-distance;x3=x+distance,y3=y+distance;closestPoint=point}}var children=node.nodes,xm=(x1+x2)*.5,ym=(y1+y2)*.5,right=x>=xm,below=y>=ym;for(var i=below<<1|right,j=i+4;i<j;++i){if(node=children[i&3])switch(i&3){case 0:find(node,x1,y1,xm,ym);break;case 1:find(node,xm,y1,x2,ym);break;case 2:find(node,x1,ym,xm,y2);break;case 3:find(node,xm,ym,x2,y2);break}}})(root,x0,y0,x3,y3);return closestPoint}d3.interpolateRgb=d3_interpolateRgb;function d3_interpolateRgb(a,b){a=d3.rgb(a);b=d3.rgb(b);var ar=a.r,ag=a.g,ab=a.b,br=b.r-ar,bg=b.g-ag,bb=b.b-ab;return function(t){return"#"+d3_rgb_hex(Math.round(ar+br*t))+d3_rgb_hex(Math.round(ag+bg*t))+d3_rgb_hex(Math.round(ab+bb*t))}}d3.interpolateObject=d3_interpolateObject;function d3_interpolateObject(a,b){var i={},c={},k;for(k in a){if(k in b){i[k]=d3_interpolate(a[k],b[k])}else{c[k]=a[k]}}for(k in b){if(!(k in a)){c[k]=b[k]}}return function(t){for(k in i)c[k]=i[k](t);return c}}d3.interpolateNumber=d3_interpolateNumber;function d3_interpolateNumber(a,b){a=+a,b=+b;return function(t){return a*(1-t)+b*t}}d3.interpolateString=d3_interpolateString;function d3_interpolateString(a,b){var bi=d3_interpolate_numberA.lastIndex=d3_interpolate_numberB.lastIndex=0,am,bm,bs,i=-1,s=[],q=[];a=a+"",b=b+"";while((am=d3_interpolate_numberA.exec(a))&&(bm=d3_interpolate_numberB.exec(b))){if((bs=bm.index)>bi){bs=b.slice(bi,bs);if(s[i])s[i]+=bs;else s[++i]=bs}if((am=am[0])===(bm=bm[0])){if(s[i])s[i]+=bm;else s[++i]=bm}else{s[++i]=null;q.push({i:i,x:d3_interpolateNumber(am,bm)})}bi=d3_interpolate_numberB.lastIndex}if(bi<b.length){bs=b.slice(bi);if(s[i])s[i]+=bs;else s[++i]=bs}return s.length<2?q[0]?(b=q[0].x,function(t){return b(t)+""}):function(){return b}:(b=q.length,function(t){for(var i=0,o;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})}var d3_interpolate_numberA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,d3_interpolate_numberB=new RegExp(d3_interpolate_numberA.source,"g");d3.interpolate=d3_interpolate;function d3_interpolate(a,b){var i=d3.interpolators.length,f;while(--i>=0&&!(f=d3.interpolators[i](a,b)));return f}d3.interpolators=[function(a,b){var t=typeof b;return(t==="string"?d3_rgb_names.has(b.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(b)?d3_interpolateRgb:d3_interpolateString:b instanceof d3_color?d3_interpolateRgb:Array.isArray(b)?d3_interpolateArray:t==="object"&&isNaN(b)?d3_interpolateObject:d3_interpolateNumber)(a,b)}];d3.interpolateArray=d3_interpolateArray;function d3_interpolateArray(a,b){var x=[],c=[],na=a.length,nb=b.length,n0=Math.min(a.length,b.length),i;for(i=0;i<n0;++i)x.push(d3_interpolate(a[i],b[i]));for(;i<na;++i)c[i]=a[i];for(;i<nb;++i)c[i]=b[i];return function(t){for(i=0;i<n0;++i)c[i]=x[i](t);return c}}var d3_ease_default=function(){return d3_identity};var d3_ease=d3.map({linear:d3_ease_default,poly:d3_ease_poly,quad:function(){return d3_ease_quad},cubic:function(){return d3_ease_cubic},sin:function(){return d3_ease_sin},exp:function(){return d3_ease_exp},circle:function(){return d3_ease_circle},elastic:d3_ease_elastic,back:d3_ease_back,bounce:function(){return d3_ease_bounce}});var d3_ease_mode=d3.map({in:d3_identity,out:d3_ease_reverse,"in-out":d3_ease_reflect,"out-in":function(f){return d3_ease_reflect(d3_ease_reverse(f))}});d3.ease=function(name){var i=name.indexOf("-"),t=i>=0?name.slice(0,i):name,m=i>=0?name.slice(i+1):"in";t=d3_ease.get(t)||d3_ease_default;m=d3_ease_mode.get(m)||d3_identity;return d3_ease_clamp(m(t.apply(null,d3_arraySlice.call(arguments,1))))};function d3_ease_clamp(f){return function(t){return t<=0?0:t>=1?1:f(t)}}function d3_ease_reverse(f){return function(t){return 1-f(1-t)}}function d3_ease_reflect(f){return function(t){return.5*(t<.5?f(2*t):2-f(2-2*t))}}function d3_ease_quad(t){return t*t}function d3_ease_cubic(t){return t*t*t}function d3_ease_cubicInOut(t){if(t<=0)return 0;if(t>=1)return 1;var t2=t*t,t3=t2*t;return 4*(t<.5?t3:3*(t-t2)+t3-.75)}function d3_ease_poly(e){return function(t){return Math.pow(t,e)}}function d3_ease_sin(t){return 1-Math.cos(t*halfπ)}function d3_ease_exp(t){return Math.pow(2,10*(t-1))}function d3_ease_circle(t){return 1-Math.sqrt(1-t*t)}function d3_ease_elastic(a,p){var s;if(arguments.length<2)p=.45;if(arguments.length)s=p/τ*Math.asin(1/a);else a=1,s=p/4;return function(t){return 1+a*Math.pow(2,-10*t)*Math.sin((t-s)*τ/p)}}function d3_ease_back(s){if(!s)s=1.70158;return function(t){return t*t*((s+1)*t-s)}}function d3_ease_bounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}d3.interpolateHcl=d3_interpolateHcl;function d3_interpolateHcl(a,b){a=d3.hcl(a);b=d3.hcl(b);var ah=a.h,ac=a.c,al=a.l,bh=b.h-ah,bc=b.c-ac,bl=b.l-al;if(isNaN(bc))bc=0,ac=isNaN(ac)?b.c:ac;if(isNaN(bh))bh=0,ah=isNaN(ah)?b.h:ah;else if(bh>180)bh-=360;else if(bh<-180)bh+=360;return function(t){return d3_hcl_lab(ah+bh*t,ac+bc*t,al+bl*t)+""}}d3.interpolateHsl=d3_interpolateHsl;function d3_interpolateHsl(a,b){a=d3.hsl(a);b=d3.hsl(b);var ah=a.h,as=a.s,al=a.l,bh=b.h-ah,bs=b.s-as,bl=b.l-al;if(isNaN(bs))bs=0,as=isNaN(as)?b.s:as;if(isNaN(bh))bh=0,ah=isNaN(ah)?b.h:ah;else if(bh>180)bh-=360;else if(bh<-180)bh+=360;return function(t){return d3_hsl_rgb(ah+bh*t,as+bs*t,al+bl*t)+""}}d3.interpolateLab=d3_interpolateLab;function d3_interpolateLab(a,b){a=d3.lab(a);b=d3.lab(b);var al=a.l,aa=a.a,ab=a.b,bl=b.l-al,ba=b.a-aa,bb=b.b-ab;return function(t){return d3_lab_rgb(al+bl*t,aa+ba*t,ab+bb*t)+""}}d3.interpolateRound=d3_interpolateRound;function d3_interpolateRound(a,b){b-=a;return function(t){return Math.round(a+b*t)}}d3.transform=function(string){var g=d3_document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(string){if(string!=null){g.setAttribute("transform",string);var t=g.transform.baseVal.consolidate()}return new d3_transform(t?t.matrix:d3_transformIdentity)})(string)};function d3_transform(m){var r0=[m.a,m.b],r1=[m.c,m.d],kx=d3_transformNormalize(r0),kz=d3_transformDot(r0,r1),ky=d3_transformNormalize(d3_transformCombine(r1,r0,-kz))||0;if(r0[0]*r1[1]<r1[0]*r0[1]){r0[0]*=-1;r0[1]*=-1;kx*=-1;kz*=-1}this.rotate=(kx?Math.atan2(r0[1],r0[0]):Math.atan2(-r1[0],r1[1]))*d3_degrees;this.translate=[m.e,m.f];this.scale=[kx,ky];this.skew=ky?Math.atan2(kz,ky)*d3_degrees:0}d3_transform.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function d3_transformDot(a,b){return a[0]*b[0]+a[1]*b[1]}function d3_transformNormalize(a){var k=Math.sqrt(d3_transformDot(a,a));if(k){a[0]/=k;a[1]/=k}return k}function d3_transformCombine(a,b,k){a[0]+=k*b[0];a[1]+=k*b[1];return a}var d3_transformIdentity={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolateTransform=d3_interpolateTransform;function d3_interpolateTransformPop(s){return s.length?s.pop()+",":""}function d3_interpolateTranslate(ta,tb,s,q){if(ta[0]!==tb[0]||ta[1]!==tb[1]){var i=s.push("translate(",null,",",null,")");q.push({i:i-4,x:d3_interpolateNumber(ta[0],tb[0])},{i:i-2,x:d3_interpolateNumber(ta[1],tb[1])})}else if(tb[0]||tb[1]){s.push("translate("+tb+")")}}function d3_interpolateRotate(ra,rb,s,q){if(ra!==rb){if(ra-rb>180)rb+=360;else if(rb-ra>180)ra+=360;q.push({i:s.push(d3_interpolateTransformPop(s)+"rotate(",null,")")-2,x:d3_interpolateNumber(ra,rb)})}else if(rb){s.push(d3_interpolateTransformPop(s)+"rotate("+rb+")")}}function d3_interpolateSkew(wa,wb,s,q){if(wa!==wb){q.push({i:s.push(d3_interpolateTransformPop(s)+"skewX(",null,")")-2,x:d3_interpolateNumber(wa,wb)})}else if(wb){s.push(d3_interpolateTransformPop(s)+"skewX("+wb+")")}}function d3_interpolateScale(ka,kb,s,q){if(ka[0]!==kb[0]||ka[1]!==kb[1]){var i=s.push(d3_interpolateTransformPop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:d3_interpolateNumber(ka[0],kb[0])},{i:i-2,x:d3_interpolateNumber(ka[1],kb[1])})}else if(kb[0]!==1||kb[1]!==1){s.push(d3_interpolateTransformPop(s)+"scale("+kb+")")}}function d3_interpolateTransform(a,b){var s=[],q=[];a=d3.transform(a),b=d3.transform(b);d3_interpolateTranslate(a.translate,b.translate,s,q);d3_interpolateRotate(a.rotate,b.rotate,s,q);d3_interpolateSkew(a.skew,b.skew,s,q);d3_interpolateScale(a.scale,b.scale,s,q);a=b=null;return function(t){var i=-1,n=q.length,o;while(++i<n)s[(o=q[i]).i]=o.x(t);return s.join("")}}function d3_uninterpolateNumber(a,b){b=(b-=a=+a)||1/b;return function(x){return(x-a)/b}}function d3_uninterpolateClamp(a,b){b=(b-=a=+a)||1/b;return function(x){return Math.max(0,Math.min(1,(x-a)/b))}}d3.layout={};d3.layout.bundle=function(){return function(links){var paths=[],i=-1,n=links.length;while(++i<n)paths.push(d3_layout_bundlePath(links[i]));return paths}};function d3_layout_bundlePath(link){var start=link.source,end=link.target,lca=d3_layout_bundleLeastCommonAncestor(start,end),points=[start];while(start!==lca){start=start.parent;points.push(start)}var k=points.length;while(end!==lca){points.splice(k,0,end);end=end.parent}return points}function d3_layout_bundleAncestors(node){var ancestors=[],parent=node.parent;while(parent!=null){ancestors.push(node);node=parent;parent=parent.parent}ancestors.push(node);return ancestors}function d3_layout_bundleLeastCommonAncestor(a,b){if(a===b)return a;var aNodes=d3_layout_bundleAncestors(a),bNodes=d3_layout_bundleAncestors(b),aNode=aNodes.pop(),bNode=bNodes.pop(),sharedNode=null;while(aNode===bNode){sharedNode=aNode;aNode=aNodes.pop();bNode=bNodes.pop()}return sharedNode}d3.layout.chord=function(){var chord={},chords,groups,matrix,n,padding=0,sortGroups,sortSubgroups,sortChords;function relayout(){var subgroups={},groupSums=[],groupIndex=d3.range(n),subgroupIndex=[],k,x,x0,i,j;chords=[];groups=[];k=0,i=-1;while(++i<n){x=0,j=-1;while(++j<n){x+=matrix[i][j]}groupSums.push(x);subgroupIndex.push(d3.range(n));k+=x}if(sortGroups){groupIndex.sort((function(a,b){return sortGroups(groupSums[a],groupSums[b])}))}if(sortSubgroups){subgroupIndex.forEach((function(d,i){d.sort((function(a,b){return sortSubgroups(matrix[i][a],matrix[i][b])}))}))}k=(τ-padding*n)/k;x=0,i=-1;while(++i<n){x0=x,j=-1;while(++j<n){var di=groupIndex[i],dj=subgroupIndex[di][j],v=matrix[di][dj],a0=x,a1=x+=v*k;subgroups[di+"-"+dj]={index:di,subindex:dj,startAngle:a0,endAngle:a1,value:v}}groups[di]={index:di,startAngle:x0,endAngle:x,value:groupSums[di]};x+=padding}i=-1;while(++i<n){j=i-1;while(++j<n){var source=subgroups[i+"-"+j],target=subgroups[j+"-"+i];if(source.value||target.value){chords.push(source.value<target.value?{source:target,target:source}:{source:source,target:target})}}}if(sortChords)resort()}function resort(){chords.sort((function(a,b){return sortChords((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)}))}chord.matrix=function(x){if(!arguments.length)return matrix;n=(matrix=x)&&matrix.length;chords=groups=null;return chord};chord.padding=function(x){if(!arguments.length)return padding;padding=x;chords=groups=null;return chord};chord.sortGroups=function(x){if(!arguments.length)return sortGroups;sortGroups=x;chords=groups=null;return chord};chord.sortSubgroups=function(x){if(!arguments.length)return sortSubgroups;sortSubgroups=x;chords=null;return chord};chord.sortChords=function(x){if(!arguments.length)return sortChords;sortChords=x;if(chords)resort();return chord};chord.chords=function(){if(!chords)relayout();return chords};chord.groups=function(){if(!groups)relayout();return groups};return chord};d3.layout.force=function(){var force={},event=d3.dispatch("start","tick","end"),timer,size=[1,1],drag,alpha,friction=.9,linkDistance=d3_layout_forceLinkDistance,linkStrength=d3_layout_forceLinkStrength,charge=-30,chargeDistance2=d3_layout_forceChargeDistance2,gravity=.1,theta2=.64,nodes=[],links=[],distances,strengths,charges;function repulse(node){return function(quad,x1,_,x2){if(quad.point!==node){var dx=quad.cx-node.x,dy=quad.cy-node.y,dw=x2-x1,dn=dx*dx+dy*dy;if(dw*dw/theta2<dn){if(dn<chargeDistance2){var k=quad.charge/dn;node.px-=dx*k;node.py-=dy*k}return true}if(quad.point&&dn&&dn<chargeDistance2){var k=quad.pointCharge/dn;node.px-=dx*k;node.py-=dy*k}}return!quad.charge}}force.tick=function(){if((alpha*=.99)<.005){timer=null;event.end({type:"end",alpha:alpha=0});return true}var n=nodes.length,m=links.length,q,i,o,s,t,l,k,x,y;for(i=0;i<m;++i){o=links[i];s=o.source;t=o.target;x=t.x-s.x;y=t.y-s.y;if(l=x*x+y*y){l=alpha*strengths[i]*((l=Math.sqrt(l))-distances[i])/l;x*=l;y*=l;t.x-=x*(k=s.weight+t.weight?s.weight/(s.weight+t.weight):.5);t.y-=y*k;s.x+=x*(k=1-k);s.y+=y*k}}if(k=alpha*gravity){x=size[0]/2;y=size[1]/2;i=-1;if(k)while(++i<n){o=nodes[i];o.x+=(x-o.x)*k;o.y+=(y-o.y)*k}}if(charge){d3_layout_forceAccumulate(q=d3.geom.quadtree(nodes),alpha,charges);i=-1;while(++i<n){if(!(o=nodes[i]).fixed){q.visit(repulse(o))}}}i=-1;while(++i<n){o=nodes[i];if(o.fixed){o.x=o.px;o.y=o.py}else{o.x-=(o.px-(o.px=o.x))*friction;o.y-=(o.py-(o.py=o.y))*friction}}event.tick({type:"tick",alpha:alpha})};force.nodes=function(x){if(!arguments.length)return nodes;nodes=x;return force};force.links=function(x){if(!arguments.length)return links;links=x;return force};force.size=function(x){if(!arguments.length)return size;size=x;return force};force.linkDistance=function(x){if(!arguments.length)return linkDistance;linkDistance=typeof x==="function"?x:+x;return force};force.distance=force.linkDistance;force.linkStrength=function(x){if(!arguments.length)return linkStrength;linkStrength=typeof x==="function"?x:+x;return force};force.friction=function(x){if(!arguments.length)return friction;friction=+x;return force};force.charge=function(x){if(!arguments.length)return charge;charge=typeof x==="function"?x:+x;return force};force.chargeDistance=function(x){if(!arguments.length)return Math.sqrt(chargeDistance2);chargeDistance2=x*x;return force};force.gravity=function(x){if(!arguments.length)return gravity;gravity=+x;return force};force.theta=function(x){if(!arguments.length)return Math.sqrt(theta2);theta2=x*x;return force};force.alpha=function(x){if(!arguments.length)return alpha;x=+x;if(alpha){if(x>0){alpha=x}else{timer.c=null,timer.t=NaN,timer=null;event.end({type:"end",alpha:alpha=0})}}else if(x>0){event.start({type:"start",alpha:alpha=x});timer=d3_timer(force.tick)}return force};force.start=function(){var i,n=nodes.length,m=links.length,w=size[0],h=size[1],neighbors,o;for(i=0;i<n;++i){(o=nodes[i]).index=i;o.weight=0}for(i=0;i<m;++i){o=links[i];if(typeof o.source=="number")o.source=nodes[o.source];if(typeof o.target=="number")o.target=nodes[o.target];++o.source.weight;++o.target.weight}for(i=0;i<n;++i){o=nodes[i];if(isNaN(o.x))o.x=position("x",w);if(isNaN(o.y))o.y=position("y",h);if(isNaN(o.px))o.px=o.x;if(isNaN(o.py))o.py=o.y}distances=[];if(typeof linkDistance==="function")for(i=0;i<m;++i)distances[i]=+linkDistance.call(this,links[i],i);else for(i=0;i<m;++i)distances[i]=linkDistance;strengths=[];if(typeof linkStrength==="function")for(i=0;i<m;++i)strengths[i]=+linkStrength.call(this,links[i],i);else for(i=0;i<m;++i)strengths[i]=linkStrength;charges=[];if(typeof charge==="function")for(i=0;i<n;++i)charges[i]=+charge.call(this,nodes[i],i);else for(i=0;i<n;++i)charges[i]=charge;function position(dimension,size){if(!neighbors){neighbors=new Array(n);for(j=0;j<n;++j){neighbors[j]=[]}for(j=0;j<m;++j){var o=links[j];neighbors[o.source.index].push(o.target);neighbors[o.target.index].push(o.source)}}var candidates=neighbors[i],j=-1,l=candidates.length,x;while(++j<l)if(!isNaN(x=candidates[j][dimension]))return x;return Math.random()*size}return force.resume()};force.resume=function(){return force.alpha(.1)};force.stop=function(){return force.alpha(0)};force.drag=function(){if(!drag)drag=d3.behavior.drag().origin(d3_identity).on("dragstart.force",d3_layout_forceDragstart).on("drag.force",dragmove).on("dragend.force",d3_layout_forceDragend);if(!arguments.length)return drag;this.on("mouseover.force",d3_layout_forceMouseover).on("mouseout.force",d3_layout_forceMouseout).call(drag)};function dragmove(d){d.px=d3.event.x,d.py=d3.event.y;force.resume()}return d3.rebind(force,event,"on")};function d3_layout_forceDragstart(d){d.fixed|=2}function d3_layout_forceDragend(d){d.fixed&=~6}function d3_layout_forceMouseover(d){d.fixed|=4;d.px=d.x,d.py=d.y}function d3_layout_forceMouseout(d){d.fixed&=~4}function d3_layout_forceAccumulate(quad,alpha,charges){var cx=0,cy=0;quad.charge=0;if(!quad.leaf){var nodes=quad.nodes,n=nodes.length,i=-1,c;while(++i<n){c=nodes[i];if(c==null)continue;d3_layout_forceAccumulate(c,alpha,charges);quad.charge+=c.charge;cx+=c.charge*c.cx;cy+=c.charge*c.cy}}if(quad.point){if(!quad.leaf){quad.point.x+=Math.random()-.5;quad.point.y+=Math.random()-.5}var k=alpha*charges[quad.point.index];quad.charge+=quad.pointCharge=k;cx+=k*quad.point.x;cy+=k*quad.point.y}quad.cx=cx/quad.charge;quad.cy=cy/quad.charge}var d3_layout_forceLinkDistance=20,d3_layout_forceLinkStrength=1,d3_layout_forceChargeDistance2=Infinity;d3.layout.hierarchy=function(){var sort=d3_layout_hierarchySort,children=d3_layout_hierarchyChildren,value=d3_layout_hierarchyValue;function hierarchy(root){var stack=[root],nodes=[],node;root.depth=0;while((node=stack.pop())!=null){nodes.push(node);if((childs=children.call(hierarchy,node,node.depth))&&(n=childs.length)){var n,childs,child;while(--n>=0){stack.push(child=childs[n]);child.parent=node;child.depth=node.depth+1}if(value)node.value=0;node.children=childs}else{if(value)node.value=+value.call(hierarchy,node,node.depth)||0;delete node.children}}d3_layout_hierarchyVisitAfter(root,(function(node){var childs,parent;if(sort&&(childs=node.children))childs.sort(sort);if(value&&(parent=node.parent))parent.value+=node.value}));return nodes}hierarchy.sort=function(x){if(!arguments.length)return sort;sort=x;return hierarchy};hierarchy.children=function(x){if(!arguments.length)return children;children=x;return hierarchy};hierarchy.value=function(x){if(!arguments.length)return value;value=x;return hierarchy};hierarchy.revalue=function(root){if(value){d3_layout_hierarchyVisitBefore(root,(function(node){if(node.children)node.value=0}));d3_layout_hierarchyVisitAfter(root,(function(node){var parent;if(!node.children)node.value=+value.call(hierarchy,node,node.depth)||0;if(parent=node.parent)parent.value+=node.value}))}return root};return hierarchy};function d3_layout_hierarchyRebind(object,hierarchy){d3.rebind(object,hierarchy,"sort","children","value");object.nodes=object;object.links=d3_layout_hierarchyLinks;return object}function d3_layout_hierarchyVisitBefore(node,callback){var nodes=[node];while((node=nodes.pop())!=null){callback(node);if((children=node.children)&&(n=children.length)){var n,children;while(--n>=0)nodes.push(children[n])}}}function d3_layout_hierarchyVisitAfter(node,callback){var nodes=[node],nodes2=[];while((node=nodes.pop())!=null){nodes2.push(node);if((children=node.children)&&(n=children.length)){var i=-1,n,children;while(++i<n)nodes.push(children[i])}}while((node=nodes2.pop())!=null){callback(node)}}function d3_layout_hierarchyChildren(d){return d.children}function d3_layout_hierarchyValue(d){return d.value}function d3_layout_hierarchySort(a,b){return b.value-a.value}function d3_layout_hierarchyLinks(nodes){return d3.merge(nodes.map((function(parent){return(parent.children||[]).map((function(child){return{source:parent,target:child}}))})))}d3.layout.partition=function(){var hierarchy=d3.layout.hierarchy(),size=[1,1];function position(node,x,dx,dy){var children=node.children;node.x=x;node.y=node.depth*dy;node.dx=dx;node.dy=dy;if(children&&(n=children.length)){var i=-1,n,c,d;dx=node.value?dx/node.value:0;while(++i<n){position(c=children[i],x,d=c.value*dx,dy);x+=d}}}function depth(node){var children=node.children,d=0;if(children&&(n=children.length)){var i=-1,n;while(++i<n)d=Math.max(d,depth(children[i]))}return 1+d}function partition(d,i){var nodes=hierarchy.call(this,d,i);position(nodes[0],0,size[0],size[1]/depth(nodes[0]));return nodes}partition.size=function(x){if(!arguments.length)return size;size=x;return partition};return d3_layout_hierarchyRebind(partition,hierarchy)};d3.layout.pie=function(){var value=Number,sort=d3_layout_pieSortByValue,startAngle=0,endAngle=τ,padAngle=0;function pie(data){var n=data.length,values=data.map((function(d,i){return+value.call(pie,d,i)})),a=+(typeof startAngle==="function"?startAngle.apply(this,arguments):startAngle),da=(typeof endAngle==="function"?endAngle.apply(this,arguments):endAngle)-a,p=Math.min(Math.abs(da)/n,+(typeof padAngle==="function"?padAngle.apply(this,arguments):padAngle)),pa=p*(da<0?-1:1),sum=d3.sum(values),k=sum?(da-n*pa)/sum:0,index=d3.range(n),arcs=[],v;if(sort!=null)index.sort(sort===d3_layout_pieSortByValue?function(i,j){return values[j]-values[i]}:function(i,j){return sort(data[i],data[j])});index.forEach((function(i){arcs[i]={data:data[i],value:v=values[i],startAngle:a,endAngle:a+=v*k+pa,padAngle:p}}));return arcs}pie.value=function(_){if(!arguments.length)return value;value=_;return pie};pie.sort=function(_){if(!arguments.length)return sort;sort=_;return pie};pie.startAngle=function(_){if(!arguments.length)return startAngle;startAngle=_;return pie};pie.endAngle=function(_){if(!arguments.length)return endAngle;endAngle=_;return pie};pie.padAngle=function(_){if(!arguments.length)return padAngle;padAngle=_;return pie};return pie};var d3_layout_pieSortByValue={};d3.layout.stack=function(){var values=d3_identity,order=d3_layout_stackOrderDefault,offset=d3_layout_stackOffsetZero,out=d3_layout_stackOut,x=d3_layout_stackX,y=d3_layout_stackY;function stack(data,index){if(!(n=data.length))return data;var series=data.map((function(d,i){return values.call(stack,d,i)}));var points=series.map((function(d){return d.map((function(v,i){return[x.call(stack,v,i),y.call(stack,v,i)]}))}));var orders=order.call(stack,points,index);series=d3.permute(series,orders);points=d3.permute(points,orders);var offsets=offset.call(stack,points,index);var m=series[0].length,n,i,j,o;for(j=0;j<m;++j){out.call(stack,series[0][j],o=offsets[j],points[0][j][1]);for(i=1;i<n;++i){out.call(stack,series[i][j],o+=points[i-1][j][1],points[i][j][1])}}return data}stack.values=function(x){if(!arguments.length)return values;values=x;return stack};stack.order=function(x){if(!arguments.length)return order;order=typeof x==="function"?x:d3_layout_stackOrders.get(x)||d3_layout_stackOrderDefault;return stack};stack.offset=function(x){if(!arguments.length)return offset;offset=typeof x==="function"?x:d3_layout_stackOffsets.get(x)||d3_layout_stackOffsetZero;return stack};stack.x=function(z){if(!arguments.length)return x;x=z;return stack};stack.y=function(z){if(!arguments.length)return y;y=z;return stack};stack.out=function(z){if(!arguments.length)return out;out=z;return stack};return stack};function d3_layout_stackX(d){return d.x}function d3_layout_stackY(d){return d.y}function d3_layout_stackOut(d,y0,y){d.y0=y0;d.y=y}var d3_layout_stackOrders=d3.map({"inside-out":function(data){var n=data.length,i,j,max=data.map(d3_layout_stackMaxIndex),sums=data.map(d3_layout_stackReduceSum),index=d3.range(n).sort((function(a,b){return max[a]-max[b]})),top=0,bottom=0,tops=[],bottoms=[];for(i=0;i<n;++i){j=index[i];if(top<bottom){top+=sums[j];tops.push(j)}else{bottom+=sums[j];bottoms.push(j)}}return bottoms.reverse().concat(tops)},reverse:function(data){return d3.range(data.length).reverse()},default:d3_layout_stackOrderDefault});var d3_layout_stackOffsets=d3.map({silhouette:function(data){var n=data.length,m=data[0].length,sums=[],max=0,i,j,o,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<n;i++)o+=data[i][j][1];if(o>max)max=o;sums.push(o)}for(j=0;j<m;++j){y0[j]=(max-sums[j])/2}return y0},wiggle:function(data){var n=data.length,x=data[0],m=x.length,i,j,k,s1,s2,s3,dx,o,o0,y0=[];y0[0]=o=o0=0;for(j=1;j<m;++j){for(i=0,s1=0;i<n;++i)s1+=data[i][j][1];for(i=0,s2=0,dx=x[j][0]-x[j-1][0];i<n;++i){for(k=0,s3=(data[i][j][1]-data[i][j-1][1])/(2*dx);k<i;++k){s3+=(data[k][j][1]-data[k][j-1][1])/dx}s2+=s3*data[i][j][1]}y0[j]=o-=s1?s2/s1*dx:0;if(o<o0)o0=o}for(j=0;j<m;++j)y0[j]-=o0;return y0},expand:function(data){var n=data.length,m=data[0].length,k=1/n,i,j,o,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<n;i++)o+=data[i][j][1];if(o)for(i=0;i<n;i++)data[i][j][1]/=o;else for(i=0;i<n;i++)data[i][j][1]=k}for(j=0;j<m;++j)y0[j]=0;return y0},zero:d3_layout_stackOffsetZero});function d3_layout_stackOrderDefault(data){return d3.range(data.length)}function d3_layout_stackOffsetZero(data){var j=-1,m=data[0].length,y0=[];while(++j<m)y0[j]=0;return y0}function d3_layout_stackMaxIndex(array){var i=1,j=0,v=array[0][1],k,n=array.length;for(;i<n;++i){if((k=array[i][1])>v){j=i;v=k}}return j}function d3_layout_stackReduceSum(d){return d.reduce(d3_layout_stackSum,0)}function d3_layout_stackSum(p,d){return p+d[1]}d3.layout.histogram=function(){var frequency=true,valuer=Number,ranger=d3_layout_histogramRange,binner=d3_layout_histogramBinSturges;function histogram(data,i){var bins=[],values=data.map(valuer,this),range=ranger.call(this,values,i),thresholds=binner.call(this,range,values,i),bin,i=-1,n=values.length,m=thresholds.length-1,k=frequency?1:1/n,x;while(++i<m){bin=bins[i]=[];bin.dx=thresholds[i+1]-(bin.x=thresholds[i]);bin.y=0}if(m>0){i=-1;while(++i<n){x=values[i];if(x>=range[0]&&x<=range[1]){bin=bins[d3.bisect(thresholds,x,1,m)-1];bin.y+=k;bin.push(data[i])}}}return bins}histogram.value=function(x){if(!arguments.length)return valuer;valuer=x;return histogram};histogram.range=function(x){if(!arguments.length)return ranger;ranger=d3_functor(x);return histogram};histogram.bins=function(x){if(!arguments.length)return binner;binner=typeof x==="number"?function(range){return d3_layout_histogramBinFixed(range,x)}:d3_functor(x);return histogram};histogram.frequency=function(x){if(!arguments.length)return frequency;frequency=!!x;return histogram};return histogram};function d3_layout_histogramBinSturges(range,values){return d3_layout_histogramBinFixed(range,Math.ceil(Math.log(values.length)/Math.LN2+1))}function d3_layout_histogramBinFixed(range,n){var x=-1,b=+range[0],m=(range[1]-b)/n,f=[];while(++x<=n)f[x]=m*x+b;return f}function d3_layout_histogramRange(values){return[d3.min(values),d3.max(values)]}d3.layout.pack=function(){var hierarchy=d3.layout.hierarchy().sort(d3_layout_packSort),padding=0,size=[1,1],radius;function pack(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0],w=size[0],h=size[1],r=radius==null?Math.sqrt:typeof radius==="function"?radius:function(){return radius};root.x=root.y=0;d3_layout_hierarchyVisitAfter(root,(function(d){d.r=+r(d.value)}));d3_layout_hierarchyVisitAfter(root,d3_layout_packSiblings);if(padding){var dr=padding*(radius?1:Math.max(2*root.r/w,2*root.r/h))/2;d3_layout_hierarchyVisitAfter(root,(function(d){d.r+=dr}));d3_layout_hierarchyVisitAfter(root,d3_layout_packSiblings);d3_layout_hierarchyVisitAfter(root,(function(d){d.r-=dr}))}d3_layout_packTransform(root,w/2,h/2,radius?1:1/Math.max(2*root.r/w,2*root.r/h));return nodes}pack.size=function(_){if(!arguments.length)return size;size=_;return pack};pack.radius=function(_){if(!arguments.length)return radius;radius=_==null||typeof _==="function"?_:+_;return pack};pack.padding=function(_){if(!arguments.length)return padding;padding=+_;return pack};return d3_layout_hierarchyRebind(pack,hierarchy)};function d3_layout_packSort(a,b){return a.value-b.value}function d3_layout_packInsert(a,b){var c=a._pack_next;a._pack_next=b;b._pack_prev=a;b._pack_next=c;c._pack_prev=b}function d3_layout_packSplice(a,b){a._pack_next=b;b._pack_prev=a}function d3_layout_packIntersects(a,b){var dx=b.x-a.x,dy=b.y-a.y,dr=a.r+b.r;return.999*dr*dr>dx*dx+dy*dy}function d3_layout_packSiblings(node){if(!(nodes=node.children)||!(n=nodes.length))return;var nodes,xMin=Infinity,xMax=-Infinity,yMin=Infinity,yMax=-Infinity,a,b,c,i,j,k,n;function bound(node){xMin=Math.min(node.x-node.r,xMin);xMax=Math.max(node.x+node.r,xMax);yMin=Math.min(node.y-node.r,yMin);yMax=Math.max(node.y+node.r,yMax)}nodes.forEach(d3_layout_packLink);a=nodes[0];a.x=-a.r;a.y=0;bound(a);if(n>1){b=nodes[1];b.x=b.r;b.y=0;bound(b);if(n>2){c=nodes[2];d3_layout_packPlace(a,b,c);bound(c);d3_layout_packInsert(a,c);a._pack_prev=c;d3_layout_packInsert(c,b);b=a._pack_next;for(i=3;i<n;i++){d3_layout_packPlace(a,b,c=nodes[i]);var isect=0,s1=1,s2=1;for(j=b._pack_next;j!==b;j=j._pack_next,s1++){if(d3_layout_packIntersects(j,c)){isect=1;break}}if(isect==1){for(k=a._pack_prev;k!==j._pack_prev;k=k._pack_prev,s2++){if(d3_layout_packIntersects(k,c)){break}}}if(isect){if(s1<s2||s1==s2&&b.r<a.r)d3_layout_packSplice(a,b=j);else d3_layout_packSplice(a=k,b);i--}else{d3_layout_packInsert(a,c);b=c;bound(c)}}}}var cx=(xMin+xMax)/2,cy=(yMin+yMax)/2,cr=0;for(i=0;i<n;i++){c=nodes[i];c.x-=cx;c.y-=cy;cr=Math.max(cr,c.r+Math.sqrt(c.x*c.x+c.y*c.y))}node.r=cr;nodes.forEach(d3_layout_packUnlink)}function d3_layout_packLink(node){node._pack_next=node._pack_prev=node}function d3_layout_packUnlink(node){delete node._pack_next;delete node._pack_prev}function d3_layout_packTransform(node,x,y,k){var children=node.children;node.x=x+=k*node.x;node.y=y+=k*node.y;node.r*=k;if(children){var i=-1,n=children.length;while(++i<n)d3_layout_packTransform(children[i],x,y,k)}}function d3_layout_packPlace(a,b,c){var db=a.r+c.r,dx=b.x-a.x,dy=b.y-a.y;if(db&&(dx||dy)){var da=b.r+c.r,dc=dx*dx+dy*dy;da*=da;db*=db;var x=.5+(db-da)/(2*dc),y=Math.sqrt(Math.max(0,2*da*(db+dc)-(db-=dc)*db-da*da))/(2*dc);c.x=a.x+x*dx+y*dy;c.y=a.y+x*dy-y*dx}else{c.x=a.x+db;c.y=a.y}}d3.layout.tree=function(){var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1],nodeSize=null;function tree(d,i){var nodes=hierarchy.call(this,d,i),root0=nodes[0],root1=wrapTree(root0);d3_layout_hierarchyVisitAfter(root1,firstWalk),root1.parent.m=-root1.z;d3_layout_hierarchyVisitBefore(root1,secondWalk);if(nodeSize)d3_layout_hierarchyVisitBefore(root0,sizeNode);else{var left=root0,right=root0,bottom=root0;d3_layout_hierarchyVisitBefore(root0,(function(node){if(node.x<left.x)left=node;if(node.x>right.x)right=node;if(node.depth>bottom.depth)bottom=node}));var tx=separation(left,right)/2-left.x,kx=size[0]/(right.x+separation(right,left)/2+tx),ky=size[1]/(bottom.depth||1);d3_layout_hierarchyVisitBefore(root0,(function(node){node.x=(node.x+tx)*kx;node.y=node.depth*ky}))}return nodes}function wrapTree(root0){var root1={A:null,children:[root0]},queue=[root1],node1;while((node1=queue.pop())!=null){for(var children=node1.children,child,i=0,n=children.length;i<n;++i){queue.push((children[i]=child={_:children[i],parent:node1,children:(child=children[i].children)&&child.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:i}).a=child)}}return root1.children[0]}function firstWalk(v){var children=v.children,siblings=v.parent.children,w=v.i?siblings[v.i-1]:null;if(children.length){d3_layout_treeShift(v);var midpoint=(children[0].z+children[children.length-1].z)/2;if(w){v.z=w.z+separation(v._,w._);v.m=v.z-midpoint}else{v.z=midpoint}}else if(w){v.z=w.z+separation(v._,w._)}v.parent.A=apportion(v,w,v.parent.A||siblings[0])}function secondWalk(v){v._.x=v.z+v.parent.m;v.m+=v.parent.m}function apportion(v,w,ancestor){if(w){var vip=v,vop=v,vim=w,vom=vip.parent.children[0],sip=vip.m,sop=vop.m,sim=vim.m,som=vom.m,shift;while(vim=d3_layout_treeRight(vim),vip=d3_layout_treeLeft(vip),vim&&vip){vom=d3_layout_treeLeft(vom);vop=d3_layout_treeRight(vop);vop.a=v;shift=vim.z+sim-vip.z-sip+separation(vim._,vip._);if(shift>0){d3_layout_treeMove(d3_layout_treeAncestor(vim,v,ancestor),v,shift);sip+=shift;sop+=shift}sim+=vim.m;sip+=vip.m;som+=vom.m;sop+=vop.m}if(vim&&!d3_layout_treeRight(vop)){vop.t=vim;vop.m+=sim-sop}if(vip&&!d3_layout_treeLeft(vom)){vom.t=vip;vom.m+=sip-som;ancestor=v}}return ancestor}function sizeNode(node){node.x*=size[0];node.y=node.depth*size[1]}tree.separation=function(x){if(!arguments.length)return separation;separation=x;return tree};tree.size=function(x){if(!arguments.length)return nodeSize?null:size;nodeSize=(size=x)==null?sizeNode:null;return tree};tree.nodeSize=function(x){if(!arguments.length)return nodeSize?size:null;nodeSize=(size=x)==null?null:sizeNode;return tree};return d3_layout_hierarchyRebind(tree,hierarchy)};function d3_layout_treeSeparation(a,b){return a.parent==b.parent?1:2}function d3_layout_treeLeft(v){var children=v.children;return children.length?children[0]:v.t}function d3_layout_treeRight(v){var children=v.children,n;return(n=children.length)?children[n-1]:v.t}function d3_layout_treeMove(wm,wp,shift){var change=shift/(wp.i-wm.i);wp.c-=change;wp.s+=shift;wm.c+=change;wp.z+=shift;wp.m+=shift}function d3_layout_treeShift(v){var shift=0,change=0,children=v.children,i=children.length,w;while(--i>=0){w=children[i];w.z+=shift;w.m+=shift;shift+=w.s+(change+=w.c)}}function d3_layout_treeAncestor(vim,v,ancestor){return vim.a.parent===v.parent?vim.a:ancestor}d3.layout.cluster=function(){var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1],nodeSize=false;function cluster(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0],previousNode,x=0;d3_layout_hierarchyVisitAfter(root,(function(node){var children=node.children;if(children&&children.length){node.x=d3_layout_clusterX(children);node.y=d3_layout_clusterY(children)}else{node.x=previousNode?x+=separation(node,previousNode):0;node.y=0;previousNode=node}}));var left=d3_layout_clusterLeft(root),right=d3_layout_clusterRight(root),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2;d3_layout_hierarchyVisitAfter(root,nodeSize?function(node){node.x=(node.x-root.x)*size[0];node.y=(root.y-node.y)*size[1]}:function(node){node.x=(node.x-x0)/(x1-x0)*size[0];node.y=(1-(root.y?node.y/root.y:1))*size[1]});return nodes}cluster.separation=function(x){if(!arguments.length)return separation;separation=x;return cluster};cluster.size=function(x){if(!arguments.length)return nodeSize?null:size;nodeSize=(size=x)==null;return cluster};cluster.nodeSize=function(x){if(!arguments.length)return nodeSize?size:null;nodeSize=(size=x)!=null;return cluster};return d3_layout_hierarchyRebind(cluster,hierarchy)};function d3_layout_clusterY(children){return 1+d3.max(children,(function(child){return child.y}))}function d3_layout_clusterX(children){return children.reduce((function(x,child){return x+child.x}),0)/children.length}function d3_layout_clusterLeft(node){var children=node.children;return children&&children.length?d3_layout_clusterLeft(children[0]):node}function d3_layout_clusterRight(node){var children=node.children,n;return children&&(n=children.length)?d3_layout_clusterRight(children[n-1]):node}d3.layout.treemap=function(){var hierarchy=d3.layout.hierarchy(),round=Math.round,size=[1,1],padding=null,pad=d3_layout_treemapPadNull,sticky=false,stickies,mode="squarify",ratio=.5*(1+Math.sqrt(5));function scale(children,k){var i=-1,n=children.length,child,area;while(++i<n){area=(child=children[i]).value*(k<0?0:k);child.area=isNaN(area)||area<=0?0:area}}function squarify(node){var children=node.children;if(children&&children.length){var rect=pad(node),row=[],remaining=children.slice(),child,best=Infinity,score,u=mode==="slice"?rect.dx:mode==="dice"?rect.dy:mode==="slice-dice"?node.depth&1?rect.dy:rect.dx:Math.min(rect.dx,rect.dy),n;scale(remaining,rect.dx*rect.dy/node.value);row.area=0;while((n=remaining.length)>0){row.push(child=remaining[n-1]);row.area+=child.area;if(mode!=="squarify"||(score=worst(row,u))<=best){remaining.pop();best=score}else{row.area-=row.pop().area;position(row,u,rect,false);u=Math.min(rect.dx,rect.dy);row.length=row.area=0;best=Infinity}}if(row.length){position(row,u,rect,true);row.length=row.area=0}children.forEach(squarify)}}function stickify(node){var children=node.children;if(children&&children.length){var rect=pad(node),remaining=children.slice(),child,row=[];scale(remaining,rect.dx*rect.dy/node.value);row.area=0;while(child=remaining.pop()){row.push(child);row.area+=child.area;if(child.z!=null){position(row,child.z?rect.dx:rect.dy,rect,!remaining.length);row.length=row.area=0}}children.forEach(stickify)}}function worst(row,u){var s=row.area,r,rmax=0,rmin=Infinity,i=-1,n=row.length;while(++i<n){if(!(r=row[i].area))continue;if(r<rmin)rmin=r;if(r>rmax)rmax=r}s*=s;u*=u;return s?Math.max(u*rmax*ratio/s,s/(u*rmin*ratio)):Infinity}function position(row,u,rect,flush){var i=-1,n=row.length,x=rect.x,y=rect.y,v=u?round(row.area/u):0,o;if(u==rect.dx){if(flush||v>rect.dy)v=rect.dy;while(++i<n){o=row[i];o.x=x;o.y=y;o.dy=v;x+=o.dx=Math.min(rect.x+rect.dx-x,v?round(o.area/v):0)}o.z=true;o.dx+=rect.x+rect.dx-x;rect.y+=v;rect.dy-=v}else{if(flush||v>rect.dx)v=rect.dx;while(++i<n){o=row[i];o.x=x;o.y=y;o.dx=v;y+=o.dy=Math.min(rect.y+rect.dy-y,v?round(o.area/v):0)}o.z=false;o.dy+=rect.y+rect.dy-y;rect.x+=v;rect.dx-=v}}function treemap(d){var nodes=stickies||hierarchy(d),root=nodes[0];root.x=root.y=0;if(root.value)root.dx=size[0],root.dy=size[1];else root.dx=root.dy=0;if(stickies)hierarchy.revalue(root);scale([root],root.dx*root.dy/root.value);(stickies?stickify:squarify)(root);if(sticky)stickies=nodes;return nodes}treemap.size=function(x){if(!arguments.length)return size;size=x;return treemap};treemap.padding=function(x){if(!arguments.length)return padding;function padFunction(node){var p=x.call(treemap,node,node.depth);return p==null?d3_layout_treemapPadNull(node):d3_layout_treemapPad(node,typeof p==="number"?[p,p,p,p]:p)}function padConstant(node){return d3_layout_treemapPad(node,x)}var type;pad=(padding=x)==null?d3_layout_treemapPadNull:(type=typeof x)==="function"?padFunction:type==="number"?(x=[x,x,x,x],padConstant):padConstant;return treemap};treemap.round=function(x){if(!arguments.length)return round!=Number;round=x?Math.round:Number;return treemap};treemap.sticky=function(x){if(!arguments.length)return sticky;sticky=x;stickies=null;return treemap};treemap.ratio=function(x){if(!arguments.length)return ratio;ratio=x;return treemap};treemap.mode=function(x){if(!arguments.length)return mode;mode=x+"";return treemap};return d3_layout_hierarchyRebind(treemap,hierarchy)};function d3_layout_treemapPadNull(node){return{x:node.x,y:node.y,dx:node.dx,dy:node.dy}}function d3_layout_treemapPad(node,padding){var x=node.x+padding[3],y=node.y+padding[0],dx=node.dx-padding[1]-padding[3],dy=node.dy-padding[0]-padding[2];if(dx<0){x+=dx/2;dx=0}if(dy<0){y+=dy/2;dy=0}return{x:x,y:y,dx:dx,dy:dy}}d3.random={normal:function(µ,σ){var n=arguments.length;if(n<2)σ=1;if(n<1)µ=0;return function(){var x,y,r;do{x=Math.random()*2-1;y=Math.random()*2-1;r=x*x+y*y}while(!r||r>1);return µ+σ*x*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var random=d3.random.normal.apply(d3,arguments);return function(){return Math.exp(random())}},bates:function(m){var random=d3.random.irwinHall(m);return function(){return random()/m}},irwinHall:function(m){return function(){for(var s=0,j=0;j<m;j++)s+=Math.random();return s}}};d3.scale={};function d3_scaleExtent(domain){var start=domain[0],stop=domain[domain.length-1];return start<stop?[start,stop]:[stop,start]}function d3_scaleRange(scale){return scale.rangeExtent?scale.rangeExtent():d3_scaleExtent(scale.range())}function d3_scale_bilinear(domain,range,uninterpolate,interpolate){var u=uninterpolate(domain[0],domain[1]),i=interpolate(range[0],range[1]);return function(x){return i(u(x))}}function d3_scale_nice(domain,nice){var i0=0,i1=domain.length-1,x0=domain[i0],x1=domain[i1],dx;if(x1<x0){dx=i0,i0=i1,i1=dx;dx=x0,x0=x1,x1=dx}domain[i0]=nice.floor(x0);domain[i1]=nice.ceil(x1);return domain}function d3_scale_niceStep(step){return step?{floor:function(x){return Math.floor(x/step)*step},ceil:function(x){return Math.ceil(x/step)*step}}:d3_scale_niceIdentity}var d3_scale_niceIdentity={floor:d3_identity,ceil:d3_identity};function d3_scale_polylinear(domain,range,uninterpolate,interpolate){var u=[],i=[],j=0,k=Math.min(domain.length,range.length)-1;if(domain[k]<domain[0]){domain=domain.slice().reverse();range=range.slice().reverse()}while(++j<=k){u.push(uninterpolate(domain[j-1],domain[j]));i.push(interpolate(range[j-1],range[j]))}return function(x){var j=d3.bisect(domain,x,1,k)-1;return i[j](u[j](x))}}d3.scale.linear=function(){return d3_scale_linear([0,1],[0,1],d3_interpolate,false)};function d3_scale_linear(domain,range,interpolate,clamp){var output,input;function rescale(){var linear=Math.min(domain.length,range.length)>2?d3_scale_polylinear:d3_scale_bilinear,uninterpolate=clamp?d3_uninterpolateClamp:d3_uninterpolateNumber;output=linear(domain,range,uninterpolate,interpolate);input=linear(range,domain,uninterpolate,d3_interpolate);return scale}function scale(x){return output(x)}scale.invert=function(y){return input(y)};scale.domain=function(x){if(!arguments.length)return domain;domain=x.map(Number);return rescale()};scale.range=function(x){if(!arguments.length)return range;range=x;return rescale()};scale.rangeRound=function(x){return scale.range(x).interpolate(d3_interpolateRound)};scale.clamp=function(x){if(!arguments.length)return clamp;clamp=x;return rescale()};scale.interpolate=function(x){if(!arguments.length)return interpolate;interpolate=x;return rescale()};scale.ticks=function(m){return d3_scale_linearTicks(domain,m)};scale.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};scale.nice=function(m){d3_scale_linearNice(domain,m);return rescale()};scale.copy=function(){return d3_scale_linear(domain,range,interpolate,clamp)};return rescale()}function d3_scale_linearRebind(scale,linear){return d3.rebind(scale,linear,"range","rangeRound","interpolate","clamp")}function d3_scale_linearNice(domain,m){d3_scale_nice(domain,d3_scale_niceStep(d3_scale_linearTickRange(domain,m)[2]));d3_scale_nice(domain,d3_scale_niceStep(d3_scale_linearTickRange(domain,m)[2]));return domain}function d3_scale_linearTickRange(domain,m){if(m==null)m=10;var extent=d3_scaleExtent(domain),span=extent[1]-extent[0],step=Math.pow(10,Math.floor(Math.log(span/m)/Math.LN10)),err=m/span*step;if(err<=.15)step*=10;else if(err<=.35)step*=5;else if(err<=.75)step*=2;extent[0]=Math.ceil(extent[0]/step)*step;extent[1]=Math.floor(extent[1]/step)*step+step*.5;extent[2]=step;return extent}function d3_scale_linearTicks(domain,m){return d3.range.apply(d3,d3_scale_linearTickRange(domain,m))}function d3_scale_linearTickFormat(domain,m,format){var range=d3_scale_linearTickRange(domain,m);if(format){var match=d3_format_re.exec(format);match.shift();if(match[8]==="s"){var prefix=d3.formatPrefix(Math.max(abs(range[0]),abs(range[1])));if(!match[7])match[7]="."+d3_scale_linearPrecision(prefix.scale(range[2]));match[8]="f";format=d3.format(match.join(""));return function(d){return format(prefix.scale(d))+prefix.symbol}}if(!match[7])match[7]="."+d3_scale_linearFormatPrecision(match[8],range);format=match.join("")}else{format=",."+d3_scale_linearPrecision(range[2])+"f"}return d3.format(format)}var d3_scale_linearFormatSignificant={s:1,g:1,p:1,r:1,e:1};function d3_scale_linearPrecision(value){return-Math.floor(Math.log(value)/Math.LN10+.01)}function d3_scale_linearFormatPrecision(type,range){var p=d3_scale_linearPrecision(range[2]);return type in d3_scale_linearFormatSignificant?Math.abs(p-d3_scale_linearPrecision(Math.max(abs(range[0]),abs(range[1]))))+ +(type!=="e"):p-(type==="%")*2}d3.scale.log=function(){return d3_scale_log(d3.scale.linear().domain([0,1]),10,true,[1,10])};function d3_scale_log(linear,base,positive,domain){function log(x){return(positive?Math.log(x<0?0:x):-Math.log(x>0?0:-x))/Math.log(base)}function pow(x){return positive?Math.pow(base,x):-Math.pow(base,-x)}function scale(x){return linear(log(x))}scale.invert=function(x){return pow(linear.invert(x))};scale.domain=function(x){if(!arguments.length)return domain;positive=x[0]>=0;linear.domain((domain=x.map(Number)).map(log));return scale};scale.base=function(_){if(!arguments.length)return base;base=+_;linear.domain(domain.map(log));return scale};scale.nice=function(){var niced=d3_scale_nice(domain.map(log),positive?Math:d3_scale_logNiceNegative);linear.domain(niced);domain=niced.map(pow);return scale};scale.ticks=function(){var extent=d3_scaleExtent(domain),ticks=[],u=extent[0],v=extent[1],i=Math.floor(log(u)),j=Math.ceil(log(v)),n=base%1?2:base;if(isFinite(j-i)){if(positive){for(;i<j;i++)for(var k=1;k<n;k++)ticks.push(pow(i)*k);ticks.push(pow(i))}else{ticks.push(pow(i));for(;i++<j;)for(var k=n-1;k>0;k--)ticks.push(pow(i)*k)}for(i=0;ticks[i]<u;i++){}for(j=ticks.length;ticks[j-1]>v;j--){}ticks=ticks.slice(i,j)}return ticks};scale.tickFormat=function(n,format){if(!arguments.length)return d3_scale_logFormat;if(arguments.length<2)format=d3_scale_logFormat;else if(typeof format!=="function")format=d3.format(format);var k=Math.max(1,base*n/scale.ticks().length);return function(d){var i=d/pow(Math.round(log(d)));if(i*base<base-.5)i*=base;return i<=k?format(d):""}};scale.copy=function(){return d3_scale_log(linear.copy(),base,positive,domain)};return d3_scale_linearRebind(scale,linear)}var d3_scale_logFormat=d3.format(".0e"),d3_scale_logNiceNegative={floor:function(x){return-Math.ceil(-x)},ceil:function(x){return-Math.floor(-x)}};d3.scale.pow=function(){return d3_scale_pow(d3.scale.linear(),1,[0,1])};function d3_scale_pow(linear,exponent,domain){var powp=d3_scale_powPow(exponent),powb=d3_scale_powPow(1/exponent);function scale(x){return linear(powp(x))}scale.invert=function(x){return powb(linear.invert(x))};scale.domain=function(x){if(!arguments.length)return domain;linear.domain((domain=x.map(Number)).map(powp));return scale};scale.ticks=function(m){return d3_scale_linearTicks(domain,m)};scale.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};scale.nice=function(m){return scale.domain(d3_scale_linearNice(domain,m))};scale.exponent=function(x){if(!arguments.length)return exponent;powp=d3_scale_powPow(exponent=x);powb=d3_scale_powPow(1/exponent);linear.domain(domain.map(powp));return scale};scale.copy=function(){return d3_scale_pow(linear.copy(),exponent,domain)};return d3_scale_linearRebind(scale,linear)}function d3_scale_powPow(e){return function(x){return x<0?-Math.pow(-x,e):Math.pow(x,e)}}d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)};d3.scale.ordinal=function(){return d3_scale_ordinal([],{t:"range",a:[[]]})};function d3_scale_ordinal(domain,ranger){var index,range,rangeBand;function scale(x){return range[((index.get(x)||(ranger.t==="range"?index.set(x,domain.push(x)):NaN))-1)%range.length]}function steps(start,step){return d3.range(domain.length).map((function(i){return start+step*i}))}scale.domain=function(x){if(!arguments.length)return domain;domain=[];index=new d3_Map;var i=-1,n=x.length,xi;while(++i<n)if(!index.has(xi=x[i]))index.set(xi,domain.push(xi));return scale[ranger.t].apply(scale,ranger.a)};scale.range=function(x){if(!arguments.length)return range;range=x;rangeBand=0;ranger={t:"range",a:arguments};return scale};scale.rangePoints=function(x,padding){if(arguments.length<2)padding=0;var start=x[0],stop=x[1],step=domain.length<2?(start=(start+stop)/2,0):(stop-start)/(domain.length-1+padding);range=steps(start+step*padding/2,step);rangeBand=0;ranger={t:"rangePoints",a:arguments};return scale};scale.rangeRoundPoints=function(x,padding){if(arguments.length<2)padding=0;var start=x[0],stop=x[1],step=domain.length<2?(start=stop=Math.round((start+stop)/2),0):(stop-start)/(domain.length-1+padding)|0;range=steps(start+Math.round(step*padding/2+(stop-start-(domain.length-1+padding)*step)/2),step);rangeBand=0;ranger={t:"rangeRoundPoints",a:arguments};return scale};scale.rangeBands=function(x,padding,outerPadding){if(arguments.length<2)padding=0;if(arguments.length<3)outerPadding=padding;var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=(stop-start)/(domain.length-padding+2*outerPadding);range=steps(start+step*outerPadding,step);if(reverse)range.reverse();rangeBand=step*(1-padding);ranger={t:"rangeBands",a:arguments};return scale};scale.rangeRoundBands=function(x,padding,outerPadding){if(arguments.length<2)padding=0;if(arguments.length<3)outerPadding=padding;var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=Math.floor((stop-start)/(domain.length-padding+2*outerPadding));range=steps(start+Math.round((stop-start-(domain.length-padding)*step)/2),step);if(reverse)range.reverse();rangeBand=Math.round(step*(1-padding));ranger={t:"rangeRoundBands",a:arguments};return scale};scale.rangeBand=function(){return rangeBand};scale.rangeExtent=function(){return d3_scaleExtent(ranger.a[0])};scale.copy=function(){return d3_scale_ordinal(domain,ranger)};return scale.domain(domain)}d3.scale.category10=function(){return d3.scale.ordinal().range(d3_category10)};d3.scale.category20=function(){return d3.scale.ordinal().range(d3_category20)};d3.scale.category20b=function(){return d3.scale.ordinal().range(d3_category20b)};d3.scale.category20c=function(){return d3.scale.ordinal().range(d3_category20c)};var d3_category10=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(d3_rgbString);var d3_category20=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(d3_rgbString);var d3_category20b=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(d3_rgbString);var d3_category20c=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(d3_rgbString);d3.scale.quantile=function(){return d3_scale_quantile([],[])};function d3_scale_quantile(domain,range){var thresholds;function rescale(){var k=0,q=range.length;thresholds=[];while(++k<q)thresholds[k-1]=d3.quantile(domain,k/q);return scale}function scale(x){if(!isNaN(x=+x))return range[d3.bisect(thresholds,x)]}scale.domain=function(x){if(!arguments.length)return domain;domain=x.map(d3_number).filter(d3_numeric).sort(d3_ascending);return rescale()};scale.range=function(x){if(!arguments.length)return range;range=x;return rescale()};scale.quantiles=function(){return thresholds};scale.invertExtent=function(y){y=range.indexOf(y);return y<0?[NaN,NaN]:[y>0?thresholds[y-1]:domain[0],y<thresholds.length?thresholds[y]:domain[domain.length-1]]};scale.copy=function(){return d3_scale_quantile(domain,range)};return rescale()}d3.scale.quantize=function(){return d3_scale_quantize(0,1,[0,1])};function d3_scale_quantize(x0,x1,range){var kx,i;function scale(x){return range[Math.max(0,Math.min(i,Math.floor(kx*(x-x0))))]}function rescale(){kx=range.length/(x1-x0);i=range.length-1;return scale}scale.domain=function(x){if(!arguments.length)return[x0,x1];x0=+x[0];x1=+x[x.length-1];return rescale()};scale.range=function(x){if(!arguments.length)return range;range=x;return rescale()};scale.invertExtent=function(y){y=range.indexOf(y);y=y<0?NaN:y/kx+x0;return[y,y+1/kx]};scale.copy=function(){return d3_scale_quantize(x0,x1,range)};return rescale()}d3.scale.threshold=function(){return d3_scale_threshold([.5],[0,1])};function d3_scale_threshold(domain,range){function scale(x){if(x<=x)return range[d3.bisect(domain,x)]}scale.domain=function(_){if(!arguments.length)return domain;domain=_;return scale};scale.range=function(_){if(!arguments.length)return range;range=_;return scale};scale.invertExtent=function(y){y=range.indexOf(y);return[domain[y-1],domain[y]]};scale.copy=function(){return d3_scale_threshold(domain,range)};return scale}d3.scale.identity=function(){return d3_scale_identity([0,1])};function d3_scale_identity(domain){function identity(x){return+x}identity.invert=identity;identity.domain=identity.range=function(x){if(!arguments.length)return domain;domain=x.map(identity);return identity};identity.ticks=function(m){return d3_scale_linearTicks(domain,m)};identity.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};identity.copy=function(){return d3_scale_identity(domain)};return identity}d3.svg={};function d3_zero(){return 0}d3.svg.arc=function(){var innerRadius=d3_svg_arcInnerRadius,outerRadius=d3_svg_arcOuterRadius,cornerRadius=d3_zero,padRadius=d3_svg_arcAuto,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle,padAngle=d3_svg_arcPadAngle;function arc(){var r0=Math.max(0,+innerRadius.apply(this,arguments)),r1=Math.max(0,+outerRadius.apply(this,arguments)),a0=startAngle.apply(this,arguments)-halfπ,a1=endAngle.apply(this,arguments)-halfπ,da=Math.abs(a1-a0),cw=a0>a1?0:1;if(r1<r0)rc=r1,r1=r0,r0=rc;if(da>=τε)return circleSegment(r1,cw)+(r0?circleSegment(r0,1-cw):"")+"Z";var rc,cr,rp,ap,p0=0,p1=0,x0,y0,x1,y1,x2,y2,x3,y3,path=[];if(ap=(+padAngle.apply(this,arguments)||0)/2){rp=padRadius===d3_svg_arcAuto?Math.sqrt(r0*r0+r1*r1):+padRadius.apply(this,arguments);if(!cw)p1*=-1;if(r1)p1=d3_asin(rp/r1*Math.sin(ap));if(r0)p0=d3_asin(rp/r0*Math.sin(ap))}if(r1){x0=r1*Math.cos(a0+p1);y0=r1*Math.sin(a0+p1);x1=r1*Math.cos(a1-p1);y1=r1*Math.sin(a1-p1);var l1=Math.abs(a1-a0-2*p1)<=π?0:1;if(p1&&d3_svg_arcSweep(x0,y0,x1,y1)===cw^l1){var h1=(a0+a1)/2;x0=r1*Math.cos(h1);y0=r1*Math.sin(h1);x1=y1=null}}else{x0=y0=0}if(r0){x2=r0*Math.cos(a1-p0);y2=r0*Math.sin(a1-p0);x3=r0*Math.cos(a0+p0);y3=r0*Math.sin(a0+p0);var l0=Math.abs(a0-a1+2*p0)<=π?0:1;if(p0&&d3_svg_arcSweep(x2,y2,x3,y3)===1-cw^l0){var h0=(a0+a1)/2;x2=r0*Math.cos(h0);y2=r0*Math.sin(h0);x3=y3=null}}else{x2=y2=0}if(da>ε&&(rc=Math.min(Math.abs(r1-r0)/2,+cornerRadius.apply(this,arguments)))>.001){cr=r0<r1^cw?0:1;var rc1=rc,rc0=rc;if(da<π){var oc=x3==null?[x2,y2]:x1==null?[x0,y0]:d3_geom_polygonIntersect([x0,y0],[x3,y3],[x1,y1],[x2,y2]),ax=x0-oc[0],ay=y0-oc[1],bx=x1-oc[0],by=y1-oc[1],kc=1/Math.sin(Math.acos((ax*bx+ay*by)/(Math.sqrt(ax*ax+ay*ay)*Math.sqrt(bx*bx+by*by)))/2),lc=Math.sqrt(oc[0]*oc[0]+oc[1]*oc[1]);rc0=Math.min(rc,(r0-lc)/(kc-1));rc1=Math.min(rc,(r1-lc)/(kc+1))}if(x1!=null){var t30=d3_svg_arcCornerTangents(x3==null?[x2,y2]:[x3,y3],[x0,y0],r1,rc1,cw),t12=d3_svg_arcCornerTangents([x1,y1],[x2,y2],r1,rc1,cw);if(rc===rc1){path.push("M",t30[0],"A",rc1,",",rc1," 0 0,",cr," ",t30[1],"A",r1,",",r1," 0 ",1-cw^d3_svg_arcSweep(t30[1][0],t30[1][1],t12[1][0],t12[1][1]),",",cw," ",t12[1],"A",rc1,",",rc1," 0 0,",cr," ",t12[0])}else{path.push("M",t30[0],"A",rc1,",",rc1," 0 1,",cr," ",t12[0])}}else{path.push("M",x0,",",y0)}if(x3!=null){var t03=d3_svg_arcCornerTangents([x0,y0],[x3,y3],r0,-rc0,cw),t21=d3_svg_arcCornerTangents([x2,y2],x1==null?[x0,y0]:[x1,y1],r0,-rc0,cw);if(rc===rc0){path.push("L",t21[0],"A",rc0,",",rc0," 0 0,",cr," ",t21[1],"A",r0,",",r0," 0 ",cw^d3_svg_arcSweep(t21[1][0],t21[1][1],t03[1][0],t03[1][1]),",",1-cw," ",t03[1],"A",rc0,",",rc0," 0 0,",cr," ",t03[0])}else{path.push("L",t21[0],"A",rc0,",",rc0," 0 0,",cr," ",t03[0])}}else{path.push("L",x2,",",y2)}}else{path.push("M",x0,",",y0);if(x1!=null)path.push("A",r1,",",r1," 0 ",l1,",",cw," ",x1,",",y1);path.push("L",x2,",",y2);if(x3!=null)path.push("A",r0,",",r0," 0 ",l0,",",1-cw," ",x3,",",y3)}path.push("Z");return path.join("")}function circleSegment(r1,cw){return"M0,"+r1+"A"+r1+","+r1+" 0 1,"+cw+" 0,"+-r1+"A"+r1+","+r1+" 0 1,"+cw+" 0,"+r1}arc.innerRadius=function(v){if(!arguments.length)return innerRadius;innerRadius=d3_functor(v);return arc};arc.outerRadius=function(v){if(!arguments.length)return outerRadius;outerRadius=d3_functor(v);return arc};arc.cornerRadius=function(v){if(!arguments.length)return cornerRadius;cornerRadius=d3_functor(v);return arc};arc.padRadius=function(v){if(!arguments.length)return padRadius;padRadius=v==d3_svg_arcAuto?d3_svg_arcAuto:d3_functor(v);return arc};arc.startAngle=function(v){if(!arguments.length)return startAngle;startAngle=d3_functor(v);return arc};arc.endAngle=function(v){if(!arguments.length)return endAngle;endAngle=d3_functor(v);return arc};arc.padAngle=function(v){if(!arguments.length)return padAngle;padAngle=d3_functor(v);return arc};arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-halfπ;return[Math.cos(a)*r,Math.sin(a)*r]};return arc};var d3_svg_arcAuto="auto";function d3_svg_arcInnerRadius(d){return d.innerRadius}function d3_svg_arcOuterRadius(d){return d.outerRadius}function d3_svg_arcStartAngle(d){return d.startAngle}function d3_svg_arcEndAngle(d){return d.endAngle}function d3_svg_arcPadAngle(d){return d&&d.padAngle}function d3_svg_arcSweep(x0,y0,x1,y1){return(x0-x1)*y0-(y0-y1)*x0>0?0:1}function d3_svg_arcCornerTangents(p0,p1,r1,rc,cw){var x01=p0[0]-p1[0],y01=p0[1]-p1[1],lo=(cw?rc:-rc)/Math.sqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x1=p0[0]+ox,y1=p0[1]+oy,x2=p1[0]+ox,y2=p1[1]+oy,x3=(x1+x2)/2,y3=(y1+y2)/2,dx=x2-x1,dy=y2-y1,d2=dx*dx+dy*dy,r=r1-rc,D=x1*y2-x2*y1,d=(dy<0?-1:1)*Math.sqrt(Math.max(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x3,dy0=cy0-y3,dx1=cx1-x3,dy1=cy1-y3;if(dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1)cx0=cx1,cy0=cy1;return[[cx0-ox,cy0-oy],[cx0*r1/r,cy0*r1/r]]}function d3_svg_line(projection){var x=d3_geom_pointX,y=d3_geom_pointY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,tension=.7;function line(data){var segments=[],points=[],i=-1,n=data.length,d,fx=d3_functor(x),fy=d3_functor(y);function segment(){segments.push("M",interpolate(projection(points),tension))}while(++i<n){if(defined.call(this,d=data[i],i)){points.push([+fx.call(this,d,i),+fy.call(this,d,i)])}else if(points.length){segment();points=[]}}if(points.length)segment();return segments.length?segments.join(""):null}line.x=function(_){if(!arguments.length)return x;x=_;return line};line.y=function(_){if(!arguments.length)return y;y=_;return line};line.defined=function(_){if(!arguments.length)return defined;defined=_;return line};line.interpolate=function(_){if(!arguments.length)return interpolateKey;if(typeof _==="function")interpolateKey=interpolate=_;else interpolateKey=(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key;return line};line.tension=function(_){if(!arguments.length)return tension;tension=_;return line};return line}d3.svg.line=function(){return d3_svg_line(d3_identity)};var d3_svg_lineInterpolators=d3.map({linear:d3_svg_lineLinear,"linear-closed":d3_svg_lineLinearClosed,step:d3_svg_lineStep,"step-before":d3_svg_lineStepBefore,"step-after":d3_svg_lineStepAfter,basis:d3_svg_lineBasis,"basis-open":d3_svg_lineBasisOpen,"basis-closed":d3_svg_lineBasisClosed,bundle:d3_svg_lineBundle,cardinal:d3_svg_lineCardinal,"cardinal-open":d3_svg_lineCardinalOpen,"cardinal-closed":d3_svg_lineCardinalClosed,monotone:d3_svg_lineMonotone});d3_svg_lineInterpolators.forEach((function(key,value){value.key=key;value.closed=/-closed$/.test(key)}));function d3_svg_lineLinear(points){return points.length>1?points.join("L"):points+"Z"}function d3_svg_lineLinearClosed(points){return points.join("L")+"Z"}function d3_svg_lineStep(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];while(++i<n)path.push("H",(p[0]+(p=points[i])[0])/2,"V",p[1]);if(n>1)path.push("H",p[0]);return path.join("")}function d3_svg_lineStepBefore(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];while(++i<n)path.push("V",(p=points[i])[1],"H",p[0]);return path.join("")}function d3_svg_lineStepAfter(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];while(++i<n)path.push("H",(p=points[i])[0],"V",p[1]);return path.join("")}function d3_svg_lineCardinalOpen(points,tension){return points.length<4?d3_svg_lineLinear(points):points[1]+d3_svg_lineHermite(points.slice(1,-1),d3_svg_lineCardinalTangents(points,tension))}function d3_svg_lineCardinalClosed(points,tension){return points.length<3?d3_svg_lineLinearClosed(points):points[0]+d3_svg_lineHermite((points.push(points[0]),points),d3_svg_lineCardinalTangents([points[points.length-2]].concat(points,[points[1]]),tension))}function d3_svg_lineCardinal(points,tension){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineCardinalTangents(points,tension))}function d3_svg_lineHermite(points,tangents){if(tangents.length<1||points.length!=tangents.length&&points.length!=tangents.length+2){return d3_svg_lineLinear(points)}var quad=points.length!=tangents.length,path="",p0=points[0],p=points[1],t0=tangents[0],t=t0,pi=1;if(quad){path+="Q"+(p[0]-t0[0]*2/3)+","+(p[1]-t0[1]*2/3)+","+p[0]+","+p[1];p0=points[1];pi=2}if(tangents.length>1){t=tangents[1];p=points[pi];pi++;path+="C"+(p0[0]+t0[0])+","+(p0[1]+t0[1])+","+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1];for(var i=2;i<tangents.length;i++,pi++){p=points[pi];t=tangents[i];path+="S"+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1]}}if(quad){var lp=points[pi];path+="Q"+(p[0]+t[0]*2/3)+","+(p[1]+t[1]*2/3)+","+lp[0]+","+lp[1]}return path}function d3_svg_lineCardinalTangents(points,tension){var tangents=[],a=(1-tension)/2,p0,p1=points[0],p2=points[1],i=1,n=points.length;while(++i<n){p0=p1;p1=p2;p2=points[i];tangents.push([a*(p2[0]-p0[0]),a*(p2[1]-p0[1])])}return tangents}function d3_svg_lineBasis(points){if(points.length<3)return d3_svg_lineLinear(points);var i=1,n=points.length,pi=points[0],x0=pi[0],y0=pi[1],px=[x0,x0,x0,(pi=points[1])[0]],py=[y0,y0,y0,pi[1]],path=[x0,",",y0,"L",d3_svg_lineDot4(d3_svg_lineBasisBezier3,px),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)];points.push(points[n-1]);while(++i<=n){pi=points[i];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}points.pop();path.push("L",pi);return path.join("")}function d3_svg_lineBasisOpen(points){if(points.length<4)return d3_svg_lineLinear(points);var path=[],i=-1,n=points.length,pi,px=[0],py=[0];while(++i<3){pi=points[i];px.push(pi[0]);py.push(pi[1])}path.push(d3_svg_lineDot4(d3_svg_lineBasisBezier3,px)+","+d3_svg_lineDot4(d3_svg_lineBasisBezier3,py));--i;while(++i<n){pi=points[i];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}return path.join("")}function d3_svg_lineBasisClosed(points){var path,i=-1,n=points.length,m=n+4,pi,px=[],py=[];while(++i<4){pi=points[i%n];px.push(pi[0]);py.push(pi[1])}path=[d3_svg_lineDot4(d3_svg_lineBasisBezier3,px),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)];--i;while(++i<m){pi=points[i%n];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}return path.join("")}function d3_svg_lineBundle(points,tension){var n=points.length-1;if(n){var x0=points[0][0],y0=points[0][1],dx=points[n][0]-x0,dy=points[n][1]-y0,i=-1,p,t;while(++i<=n){p=points[i];t=i/n;p[0]=tension*p[0]+(1-tension)*(x0+t*dx);p[1]=tension*p[1]+(1-tension)*(y0+t*dy)}}return d3_svg_lineBasis(points)}function d3_svg_lineDot4(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}var d3_svg_lineBasisBezier1=[0,2/3,1/3,0],d3_svg_lineBasisBezier2=[0,1/3,2/3,0],d3_svg_lineBasisBezier3=[0,1/6,2/3,1/6];function d3_svg_lineBasisBezier(path,x,y){path.push("C",d3_svg_lineDot4(d3_svg_lineBasisBezier1,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier1,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,y))}function d3_svg_lineSlope(p0,p1){return(p1[1]-p0[1])/(p1[0]-p0[0])}function d3_svg_lineFiniteDifferences(points){var i=0,j=points.length-1,m=[],p0=points[0],p1=points[1],d=m[0]=d3_svg_lineSlope(p0,p1);while(++i<j){m[i]=(d+(d=d3_svg_lineSlope(p0=p1,p1=points[i+1])))/2}m[i]=d;return m}function d3_svg_lineMonotoneTangents(points){var tangents=[],d,a,b,s,m=d3_svg_lineFiniteDifferences(points),i=-1,j=points.length-1;while(++i<j){d=d3_svg_lineSlope(points[i],points[i+1]);if(abs(d)<ε){m[i]=m[i+1]=0}else{a=m[i]/d;b=m[i+1]/d;s=a*a+b*b;if(s>9){s=d*3/Math.sqrt(s);m[i]=s*a;m[i+1]=s*b}}}i=-1;while(++i<=j){s=(points[Math.min(j,i+1)][0]-points[Math.max(0,i-1)][0])/(6*(1+m[i]*m[i]));tangents.push([s||0,m[i]*s||0])}return tangents}function d3_svg_lineMonotone(points){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineMonotoneTangents(points))}d3.svg.line.radial=function(){var line=d3_svg_line(d3_svg_lineRadial);line.radius=line.x,delete line.x;line.angle=line.y,delete line.y;return line};function d3_svg_lineRadial(points){var point,i=-1,n=points.length,r,a;while(++i<n){point=points[i];r=point[0];a=point[1]-halfπ;point[0]=r*Math.cos(a);point[1]=r*Math.sin(a)}return points}function d3_svg_area(projection){var x0=d3_geom_pointX,x1=d3_geom_pointX,y0=0,y1=d3_geom_pointY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,interpolateReverse=interpolate,L="L",tension=.7;function area(data){var segments=[],points0=[],points1=[],i=-1,n=data.length,d,fx0=d3_functor(x0),fy0=d3_functor(y0),fx1=x0===x1?function(){return x}:d3_functor(x1),fy1=y0===y1?function(){return y}:d3_functor(y1),x,y;function segment(){segments.push("M",interpolate(projection(points1),tension),L,interpolateReverse(projection(points0.reverse()),tension),"Z")}while(++i<n){if(defined.call(this,d=data[i],i)){points0.push([x=+fx0.call(this,d,i),y=+fy0.call(this,d,i)]);points1.push([+fx1.call(this,d,i),+fy1.call(this,d,i)])}else if(points0.length){segment();points0=[];points1=[]}}if(points0.length)segment();return segments.length?segments.join(""):null}area.x=function(_){if(!arguments.length)return x1;x0=x1=_;return area};area.x0=function(_){if(!arguments.length)return x0;x0=_;return area};area.x1=function(_){if(!arguments.length)return x1;x1=_;return area};area.y=function(_){if(!arguments.length)return y1;y0=y1=_;return area};area.y0=function(_){if(!arguments.length)return y0;y0=_;return area};area.y1=function(_){if(!arguments.length)return y1;y1=_;return area};area.defined=function(_){if(!arguments.length)return defined;defined=_;return area};area.interpolate=function(_){if(!arguments.length)return interpolateKey;if(typeof _==="function")interpolateKey=interpolate=_;else interpolateKey=(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key;interpolateReverse=interpolate.reverse||interpolate;L=interpolate.closed?"M":"L";return area};area.tension=function(_){if(!arguments.length)return tension;tension=_;return area};return area}d3_svg_lineStepBefore.reverse=d3_svg_lineStepAfter;d3_svg_lineStepAfter.reverse=d3_svg_lineStepBefore;d3.svg.area=function(){return d3_svg_area(d3_identity)};d3.svg.area.radial=function(){var area=d3_svg_area(d3_svg_lineRadial);area.radius=area.x,delete area.x;area.innerRadius=area.x0,delete area.x0;area.outerRadius=area.x1,delete area.x1;area.angle=area.y,delete area.y;area.startAngle=area.y0,delete area.y0;area.endAngle=area.y1,delete area.y1;return area};d3.svg.chord=function(){var source=d3_source,target=d3_target,radius=d3_svg_chordRadius,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle;function chord(d,i){var s=subgroup(this,source,d,i),t=subgroup(this,target,d,i);return"M"+s.p0+arc(s.r,s.p1,s.a1-s.a0)+(equals(s,t)?curve(s.r,s.p1,s.r,s.p0):curve(s.r,s.p1,t.r,t.p0)+arc(t.r,t.p1,t.a1-t.a0)+curve(t.r,t.p1,s.r,s.p0))+"Z"}function subgroup(self,f,d,i){var subgroup=f.call(self,d,i),r=radius.call(self,subgroup,i),a0=startAngle.call(self,subgroup,i)-halfπ,a1=endAngle.call(self,subgroup,i)-halfπ;return{r:r,a0:a0,a1:a1,p0:[r*Math.cos(a0),r*Math.sin(a0)],p1:[r*Math.cos(a1),r*Math.sin(a1)]}}function equals(a,b){return a.a0==b.a0&&a.a1==b.a1}function arc(r,p,a){return"A"+r+","+r+" 0 "+ +(a>π)+",1 "+p}function curve(r0,p0,r1,p1){return"Q 0,0 "+p1}chord.radius=function(v){if(!arguments.length)return radius;radius=d3_functor(v);return chord};chord.source=function(v){if(!arguments.length)return source;source=d3_functor(v);return chord};chord.target=function(v){if(!arguments.length)return target;target=d3_functor(v);return chord};chord.startAngle=function(v){if(!arguments.length)return startAngle;startAngle=d3_functor(v);return chord};chord.endAngle=function(v){if(!arguments.length)return endAngle;endAngle=d3_functor(v);return chord};return chord};function d3_svg_chordRadius(d){return d.radius}d3.svg.diagonal=function(){var source=d3_source,target=d3_target,projection=d3_svg_diagonalProjection;function diagonal(d,i){var p0=source.call(this,d,i),p3=target.call(this,d,i),m=(p0.y+p3.y)/2,p=[p0,{x:p0.x,y:m},{x:p3.x,y:m},p3];p=p.map(projection);return"M"+p[0]+"C"+p[1]+" "+p[2]+" "+p[3]}diagonal.source=function(x){if(!arguments.length)return source;source=d3_functor(x);return diagonal};diagonal.target=function(x){if(!arguments.length)return target;target=d3_functor(x);return diagonal};diagonal.projection=function(x){if(!arguments.length)return projection;projection=x;return diagonal};return diagonal};function d3_svg_diagonalProjection(d){return[d.x,d.y]}d3.svg.diagonal.radial=function(){var diagonal=d3.svg.diagonal(),projection=d3_svg_diagonalProjection,projection_=diagonal.projection;diagonal.projection=function(x){return arguments.length?projection_(d3_svg_diagonalRadialProjection(projection=x)):projection};return diagonal};function d3_svg_diagonalRadialProjection(projection){return function(){var d=projection.apply(this,arguments),r=d[0],a=d[1]-halfπ;return[r*Math.cos(a),r*Math.sin(a)]}}d3.svg.symbol=function(){var type=d3_svg_symbolType,size=d3_svg_symbolSize;function symbol(d,i){return(d3_svg_symbols.get(type.call(this,d,i))||d3_svg_symbolCircle)(size.call(this,d,i))}symbol.type=function(x){if(!arguments.length)return type;type=d3_functor(x);return symbol};symbol.size=function(x){if(!arguments.length)return size;size=d3_functor(x);return symbol};return symbol};function d3_svg_symbolSize(){return 64}function d3_svg_symbolType(){return"circle"}function d3_svg_symbolCircle(size){var r=Math.sqrt(size/π);return"M0,"+r+"A"+r+","+r+" 0 1,1 0,"+-r+"A"+r+","+r+" 0 1,1 0,"+r+"Z"}var d3_svg_symbols=d3.map({circle:d3_svg_symbolCircle,cross:function(size){var r=Math.sqrt(size/5)/2;return"M"+-3*r+","+-r+"H"+-r+"V"+-3*r+"H"+r+"V"+-r+"H"+3*r+"V"+r+"H"+r+"V"+3*r+"H"+-r+"V"+r+"H"+-3*r+"Z"},diamond:function(size){var ry=Math.sqrt(size/(2*d3_svg_symbolTan30)),rx=ry*d3_svg_symbolTan30;return"M0,"+-ry+"L"+rx+",0"+" 0,"+ry+" "+-rx+",0"+"Z"},square:function(size){var r=Math.sqrt(size)/2;return"M"+-r+","+-r+"L"+r+","+-r+" "+r+","+r+" "+-r+","+r+"Z"},"triangle-down":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+ry+"L"+rx+","+-ry+" "+-rx+","+-ry+"Z"},"triangle-up":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+-ry+"L"+rx+","+ry+" "+-rx+","+ry+"Z"}});d3.svg.symbolTypes=d3_svg_symbols.keys();var d3_svg_symbolSqrt3=Math.sqrt(3),d3_svg_symbolTan30=Math.tan(30*d3_radians);d3_selectionPrototype.transition=function(name){var id=d3_transitionInheritId||++d3_transitionId,ns=d3_transitionNamespace(name),subgroups=[],subgroup,node,transition=d3_transitionInherit||{time:Date.now(),ease:d3_ease_cubicInOut,delay:0,duration:250};for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;){if(node=group[i])d3_transitionNode(node,i,ns,id,transition);subgroup.push(node)}}return d3_transition(subgroups,ns,id)};d3_selectionPrototype.interrupt=function(name){return this.each(name==null?d3_selection_interrupt:d3_selection_interruptNS(d3_transitionNamespace(name)))};var d3_selection_interrupt=d3_selection_interruptNS(d3_transitionNamespace());function d3_selection_interruptNS(ns){return function(){var lock,activeId,active;if((lock=this[ns])&&(active=lock[activeId=lock.active])){active.timer.c=null;active.timer.t=NaN;if(--lock.count)delete lock[activeId];else delete this[ns];lock.active+=.5;active.event&&active.event.interrupt.call(this,this.__data__,active.index)}}}function d3_transition(groups,ns,id){d3_subclass(groups,d3_transitionPrototype);groups.namespace=ns;groups.id=id;return groups}var d3_transitionPrototype=[],d3_transitionId=0,d3_transitionInheritId,d3_transitionInherit;d3_transitionPrototype.call=d3_selectionPrototype.call;d3_transitionPrototype.empty=d3_selectionPrototype.empty;d3_transitionPrototype.node=d3_selectionPrototype.node;d3_transitionPrototype.size=d3_selectionPrototype.size;d3.transition=function(selection,name){return selection&&selection.transition?d3_transitionInheritId?selection.transition(name):selection:d3.selection().transition(selection)};d3.transition.prototype=d3_transitionPrototype;d3_transitionPrototype.select=function(selector){var id=this.id,ns=this.namespace,subgroups=[],subgroup,subnode,node;selector=d3_selection_selector(selector);for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;){if((node=group[i])&&(subnode=selector.call(node,node.__data__,i,j))){if("__data__"in node)subnode.__data__=node.__data__;d3_transitionNode(subnode,i,ns,id,node[ns][id]);subgroup.push(subnode)}else{subgroup.push(null)}}}return d3_transition(subgroups,ns,id)};d3_transitionPrototype.selectAll=function(selector){var id=this.id,ns=this.namespace,subgroups=[],subgroup,subnodes,node,subnode,transition;selector=d3_selection_selectorAll(selector);for(var j=-1,m=this.length;++j<m;){for(var group=this[j],i=-1,n=group.length;++i<n;){if(node=group[i]){transition=node[ns][id];subnodes=selector.call(node,node.__data__,i,j);subgroups.push(subgroup=[]);for(var k=-1,o=subnodes.length;++k<o;){if(subnode=subnodes[k])d3_transitionNode(subnode,k,ns,id,transition);subgroup.push(subnode)}}}}return d3_transition(subgroups,ns,id)};d3_transitionPrototype.filter=function(filter){var subgroups=[],subgroup,group,node;if(typeof filter!=="function")filter=d3_selection_filter(filter);for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);for(var group=this[j],i=0,n=group.length;i<n;i++){if((node=group[i])&&filter.call(node,node.__data__,i,j)){subgroup.push(node)}}}return d3_transition(subgroups,this.namespace,this.id)};d3_transitionPrototype.tween=function(name,tween){var id=this.id,ns=this.namespace;if(arguments.length<2)return this.node()[ns][id].tween.get(name);return d3_selection_each(this,tween==null?function(node){node[ns][id].tween.remove(name)}:function(node){node[ns][id].tween.set(name,tween)})};function d3_transition_tween(groups,name,value,tween){var id=groups.id,ns=groups.namespace;return d3_selection_each(groups,typeof value==="function"?function(node,i,j){node[ns][id].tween.set(name,tween(value.call(node,node.__data__,i,j)))}:(value=tween(value),function(node){node[ns][id].tween.set(name,value)}))}d3_transitionPrototype.attr=function(nameNS,value){if(arguments.length<2){for(value in nameNS)this.attr(value,nameNS[value]);return this}var interpolate=nameNS=="transform"?d3_interpolateTransform:d3_interpolate,name=d3.ns.qualify(nameNS);function attrNull(){this.removeAttribute(name)}function attrNullNS(){this.removeAttributeNS(name.space,name.local)}function attrTween(b){return b==null?attrNull:(b+="",function(){var a=this.getAttribute(name),i;return a!==b&&(i=interpolate(a,b),function(t){this.setAttribute(name,i(t))})})}function attrTweenNS(b){return b==null?attrNullNS:(b+="",function(){var a=this.getAttributeNS(name.space,name.local),i;return a!==b&&(i=interpolate(a,b),function(t){this.setAttributeNS(name.space,name.local,i(t))})})}return d3_transition_tween(this,"attr."+nameNS,value,name.local?attrTweenNS:attrTween)};d3_transitionPrototype.attrTween=function(nameNS,tween){var name=d3.ns.qualify(nameNS);function attrTween(d,i){var f=tween.call(this,d,i,this.getAttribute(name));return f&&function(t){this.setAttribute(name,f(t))}}function attrTweenNS(d,i){var f=tween.call(this,d,i,this.getAttributeNS(name.space,name.local));return f&&function(t){this.setAttributeNS(name.space,name.local,f(t))}}return this.tween("attr."+nameNS,name.local?attrTweenNS:attrTween)};d3_transitionPrototype.style=function(name,value,priority){var n=arguments.length;if(n<3){if(typeof name!=="string"){if(n<2)value="";for(priority in name)this.style(priority,name[priority],value);return this}priority=""}function styleNull(){this.style.removeProperty(name)}function styleString(b){return b==null?styleNull:(b+="",function(){var a=d3_window(this).getComputedStyle(this,null).getPropertyValue(name),i;return a!==b&&(i=d3_interpolate(a,b),function(t){this.style.setProperty(name,i(t),priority)})})}return d3_transition_tween(this,"style."+name,value,styleString)};d3_transitionPrototype.styleTween=function(name,tween,priority){if(arguments.length<3)priority="";function styleTween(d,i){var f=tween.call(this,d,i,d3_window(this).getComputedStyle(this,null).getPropertyValue(name));return f&&function(t){this.style.setProperty(name,f(t),priority)}}return this.tween("style."+name,styleTween)};d3_transitionPrototype.text=function(value){return d3_transition_tween(this,"text",value,d3_transition_text)};function d3_transition_text(b){if(b==null)b="";return function(){this.textContent=b}}d3_transitionPrototype.remove=function(){var ns=this.namespace;return this.each("end.transition",(function(){var p;if(this[ns].count<2&&(p=this.parentNode))p.removeChild(this)}))};d3_transitionPrototype.ease=function(value){var id=this.id,ns=this.namespace;if(arguments.length<1)return this.node()[ns][id].ease;if(typeof value!=="function")value=d3.ease.apply(d3,arguments);return d3_selection_each(this,(function(node){node[ns][id].ease=value}))};d3_transitionPrototype.delay=function(value){var id=this.id,ns=this.namespace;if(arguments.length<1)return this.node()[ns][id].delay;return d3_selection_each(this,typeof value==="function"?function(node,i,j){node[ns][id].delay=+value.call(node,node.__data__,i,j)}:(value=+value,function(node){node[ns][id].delay=value}))};d3_transitionPrototype.duration=function(value){var id=this.id,ns=this.namespace;if(arguments.length<1)return this.node()[ns][id].duration;return d3_selection_each(this,typeof value==="function"?function(node,i,j){node[ns][id].duration=Math.max(1,value.call(node,node.__data__,i,j))}:(value=Math.max(1,value),function(node){node[ns][id].duration=value}))};d3_transitionPrototype.each=function(type,listener){var id=this.id,ns=this.namespace;if(arguments.length<2){var inherit=d3_transitionInherit,inheritId=d3_transitionInheritId;try{d3_transitionInheritId=id;d3_selection_each(this,(function(node,i,j){d3_transitionInherit=node[ns][id];type.call(node,node.__data__,i,j)}))}finally{d3_transitionInherit=inherit;d3_transitionInheritId=inheritId}}else{d3_selection_each(this,(function(node){var transition=node[ns][id];(transition.event||(transition.event=d3.dispatch("start","end","interrupt"))).on(type,listener)}))}return this};d3_transitionPrototype.transition=function(){var id0=this.id,id1=++d3_transitionId,ns=this.namespace,subgroups=[],subgroup,group,node,transition;for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);for(var group=this[j],i=0,n=group.length;i<n;i++){if(node=group[i]){transition=node[ns][id0];d3_transitionNode(node,i,ns,id1,{time:transition.time,ease:transition.ease,delay:transition.delay+transition.duration,duration:transition.duration})}subgroup.push(node)}}return d3_transition(subgroups,ns,id1)};function d3_transitionNamespace(name){return name==null?"__transition__":"__transition_"+name+"__"}function d3_transitionNode(node,i,ns,id,inherit){var lock=node[ns]||(node[ns]={active:0,count:0}),transition=lock[id],time,timer,duration,ease,tweens;function schedule(elapsed){var delay=transition.delay;timer.t=delay+time;if(delay<=elapsed)return start(elapsed-delay);timer.c=start}function start(elapsed){var activeId=lock.active,active=lock[activeId];if(active){active.timer.c=null;active.timer.t=NaN;--lock.count;delete lock[activeId];active.event&&active.event.interrupt.call(node,node.__data__,active.index)}for(var cancelId in lock){if(+cancelId<id){var cancel=lock[cancelId];cancel.timer.c=null;cancel.timer.t=NaN;--lock.count;delete lock[cancelId]}}timer.c=tick;d3_timer((function(){if(timer.c&&tick(elapsed||1)){timer.c=null;timer.t=NaN}return 1}),0,time);lock.active=id;transition.event&&transition.event.start.call(node,node.__data__,i);tweens=[];transition.tween.forEach((function(key,value){if(value=value.call(node,node.__data__,i)){tweens.push(value)}}));ease=transition.ease;duration=transition.duration}function tick(elapsed){var t=elapsed/duration,e=ease(t),n=tweens.length;while(n>0){tweens[--n].call(node,e)}if(t>=1){transition.event&&transition.event.end.call(node,node.__data__,i);if(--lock.count)delete lock[id];else delete node[ns];return 1}}if(!transition){time=inherit.time;timer=d3_timer(schedule,0,time);transition=lock[id]={tween:new d3_Map,time:time,timer:timer,delay:inherit.delay,duration:inherit.duration,ease:inherit.ease,index:i};inherit=null;++lock.count}}d3.svg.axis=function(){var scale=d3.scale.linear(),orient=d3_svg_axisDefaultOrient,innerTickSize=6,outerTickSize=6,tickPadding=3,tickArguments_=[10],tickValues=null,tickFormat_;function axis(g){g.each((function(){var g=d3.select(this);var scale0=this.__chart__||scale,scale1=this.__chart__=scale.copy();var ticks=tickValues==null?scale1.ticks?scale1.ticks.apply(scale1,tickArguments_):scale1.domain():tickValues,tickFormat=tickFormat_==null?scale1.tickFormat?scale1.tickFormat.apply(scale1,tickArguments_):d3_identity:tickFormat_,tick=g.selectAll(".tick").data(ticks,scale1),tickEnter=tick.enter().insert("g",".domain").attr("class","tick").style("opacity",ε),tickExit=d3.transition(tick.exit()).style("opacity",ε).remove(),tickUpdate=d3.transition(tick.order()).style("opacity",1),tickSpacing=Math.max(innerTickSize,0)+tickPadding,tickTransform;var range=d3_scaleRange(scale1),path=g.selectAll(".domain").data([0]),pathUpdate=(path.enter().append("path").attr("class","domain"),d3.transition(path));tickEnter.append("line");tickEnter.append("text");var lineEnter=tickEnter.select("line"),lineUpdate=tickUpdate.select("line"),text=tick.select("text").text(tickFormat),textEnter=tickEnter.select("text"),textUpdate=tickUpdate.select("text"),sign=orient==="top"||orient==="left"?-1:1,x1,x2,y1,y2;if(orient==="bottom"||orient==="top"){tickTransform=d3_svg_axisX,x1="x",y1="y",x2="x2",y2="y2";text.attr("dy",sign<0?"0em":".71em").style("text-anchor","middle");pathUpdate.attr("d","M"+range[0]+","+sign*outerTickSize+"V0H"+range[1]+"V"+sign*outerTickSize)}else{tickTransform=d3_svg_axisY,x1="y",y1="x",x2="y2",y2="x2";text.attr("dy",".32em").style("text-anchor",sign<0?"end":"start");pathUpdate.attr("d","M"+sign*outerTickSize+","+range[0]+"H0V"+range[1]+"H"+sign*outerTickSize)}lineEnter.attr(y2,sign*innerTickSize);textEnter.attr(y1,sign*tickSpacing);lineUpdate.attr(x2,0).attr(y2,sign*innerTickSize);textUpdate.attr(x1,0).attr(y1,sign*tickSpacing);if(scale1.rangeBand){var x=scale1,dx=x.rangeBand()/2;scale0=scale1=function(d){return x(d)+dx}}else if(scale0.rangeBand){scale0=scale1}else{tickExit.call(tickTransform,scale1,scale0)}tickEnter.call(tickTransform,scale0,scale1);tickUpdate.call(tickTransform,scale1,scale1)}))}axis.scale=function(x){if(!arguments.length)return scale;scale=x;return axis};axis.orient=function(x){if(!arguments.length)return orient;orient=x in d3_svg_axisOrients?x+"":d3_svg_axisDefaultOrient;return axis};axis.ticks=function(){if(!arguments.length)return tickArguments_;tickArguments_=d3_array(arguments);return axis};axis.tickValues=function(x){if(!arguments.length)return tickValues;tickValues=x;return axis};axis.tickFormat=function(x){if(!arguments.length)return tickFormat_;tickFormat_=x;return axis};axis.tickSize=function(x){var n=arguments.length;if(!n)return innerTickSize;innerTickSize=+x;outerTickSize=+arguments[n-1];return axis};axis.innerTickSize=function(x){if(!arguments.length)return innerTickSize;innerTickSize=+x;return axis};axis.outerTickSize=function(x){if(!arguments.length)return outerTickSize;outerTickSize=+x;return axis};axis.tickPadding=function(x){if(!arguments.length)return tickPadding;tickPadding=+x;return axis};axis.tickSubdivide=function(){return arguments.length&&axis};return axis};var d3_svg_axisDefaultOrient="bottom",d3_svg_axisOrients={top:1,right:1,bottom:1,left:1};function d3_svg_axisX(selection,x0,x1){selection.attr("transform",(function(d){var v0=x0(d);return"translate("+(isFinite(v0)?v0:x1(d))+",0)"}))}function d3_svg_axisY(selection,y0,y1){selection.attr("transform",(function(d){var v0=y0(d);return"translate(0,"+(isFinite(v0)?v0:y1(d))+")"}))}d3.svg.brush=function(){var event=d3_eventDispatch(brush,"brushstart","brush","brushend"),x=null,y=null,xExtent=[0,0],yExtent=[0,0],xExtentDomain,yExtentDomain,xClamp=true,yClamp=true,resizes=d3_svg_brushResizes[0];function brush(g){g.each((function(){var g=d3.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",brushstart).on("touchstart.brush",brushstart);var background=g.selectAll(".background").data([0]);background.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");g.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var resize=g.selectAll(".resize").data(resizes,d3_identity);resize.exit().remove();resize.enter().append("g").attr("class",(function(d){return"resize "+d})).style("cursor",(function(d){return d3_svg_brushCursor[d]})).append("rect").attr("x",(function(d){return/[ew]$/.test(d)?-3:null})).attr("y",(function(d){return/^[ns]/.test(d)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden");resize.style("display",brush.empty()?"none":null);var gUpdate=d3.transition(g),backgroundUpdate=d3.transition(background),range;if(x){range=d3_scaleRange(x);backgroundUpdate.attr("x",range[0]).attr("width",range[1]-range[0]);redrawX(gUpdate)}if(y){range=d3_scaleRange(y);backgroundUpdate.attr("y",range[0]).attr("height",range[1]-range[0]);redrawY(gUpdate)}redraw(gUpdate)}))}brush.event=function(g){g.each((function(){var event_=event.of(this,arguments),extent1={x:xExtent,y:yExtent,i:xExtentDomain,j:yExtentDomain},extent0=this.__chart__||extent1;this.__chart__=extent1;if(d3_transitionInheritId){d3.select(this).transition().each("start.brush",(function(){xExtentDomain=extent0.i;yExtentDomain=extent0.j;xExtent=extent0.x;yExtent=extent0.y;event_({type:"brushstart"})})).tween("brush:brush",(function(){var xi=d3_interpolateArray(xExtent,extent1.x),yi=d3_interpolateArray(yExtent,extent1.y);xExtentDomain=yExtentDomain=null;return function(t){xExtent=extent1.x=xi(t);yExtent=extent1.y=yi(t);event_({type:"brush",mode:"resize"})}})).each("end.brush",(function(){xExtentDomain=extent1.i;yExtentDomain=extent1.j;event_({type:"brush",mode:"resize"});event_({type:"brushend"})}))}else{event_({type:"brushstart"});event_({type:"brush",mode:"resize"});event_({type:"brushend"})}}))};function redraw(g){g.selectAll(".resize").attr("transform",(function(d){return"translate("+xExtent[+/e$/.test(d)]+","+yExtent[+/^s/.test(d)]+")"}))}function redrawX(g){g.select(".extent").attr("x",xExtent[0]);g.selectAll(".extent,.n>rect,.s>rect").attr("width",xExtent[1]-xExtent[0])}function redrawY(g){g.select(".extent").attr("y",yExtent[0]);g.selectAll(".extent,.e>rect,.w>rect").attr("height",yExtent[1]-yExtent[0])}function brushstart(){var target=this,eventTarget=d3.select(d3.event.target),event_=event.of(target,arguments),g=d3.select(target),resizing=eventTarget.datum(),resizingX=!/^(n|s)$/.test(resizing)&&x,resizingY=!/^(e|w)$/.test(resizing)&&y,dragging=eventTarget.classed("extent"),dragRestore=d3_event_dragSuppress(target),center,origin=d3.mouse(target),offset;var w=d3.select(d3_window(target)).on("keydown.brush",keydown).on("keyup.brush",keyup);if(d3.event.changedTouches){w.on("touchmove.brush",brushmove).on("touchend.brush",brushend)}else{w.on("mousemove.brush",brushmove).on("mouseup.brush",brushend)}g.interrupt().selectAll("*").interrupt();if(dragging){origin[0]=xExtent[0]-origin[0];origin[1]=yExtent[0]-origin[1]}else if(resizing){var ex=+/w$/.test(resizing),ey=+/^n/.test(resizing);offset=[xExtent[1-ex]-origin[0],yExtent[1-ey]-origin[1]];origin[0]=xExtent[ex];origin[1]=yExtent[ey]}else if(d3.event.altKey)center=origin.slice();g.style("pointer-events","none").selectAll(".resize").style("display",null);d3.select("body").style("cursor",eventTarget.style("cursor"));event_({type:"brushstart"});brushmove();function keydown(){if(d3.event.keyCode==32){if(!dragging){center=null;origin[0]-=xExtent[1];origin[1]-=yExtent[1];dragging=2}d3_eventPreventDefault()}}function keyup(){if(d3.event.keyCode==32&&dragging==2){origin[0]+=xExtent[1];origin[1]+=yExtent[1];dragging=0;d3_eventPreventDefault()}}function brushmove(){var point=d3.mouse(target),moved=false;if(offset){point[0]+=offset[0];point[1]+=offset[1]}if(!dragging){if(d3.event.altKey){if(!center)center=[(xExtent[0]+xExtent[1])/2,(yExtent[0]+yExtent[1])/2];origin[0]=xExtent[+(point[0]<center[0])];origin[1]=yExtent[+(point[1]<center[1])]}else center=null}if(resizingX&&move1(point,x,0)){redrawX(g);moved=true}if(resizingY&&move1(point,y,1)){redrawY(g);moved=true}if(moved){redraw(g);event_({type:"brush",mode:dragging?"move":"resize"})}}function move1(point,scale,i){var range=d3_scaleRange(scale),r0=range[0],r1=range[1],position=origin[i],extent=i?yExtent:xExtent,size=extent[1]-extent[0],min,max;if(dragging){r0-=position;r1-=size+position}min=(i?yClamp:xClamp)?Math.max(r0,Math.min(r1,point[i])):point[i];if(dragging){max=(min+=position)+size}else{if(center)position=Math.max(r0,Math.min(r1,2*center[i]-min));if(position<min){max=min;min=position}else{max=position}}if(extent[0]!=min||extent[1]!=max){if(i)yExtentDomain=null;else xExtentDomain=null;extent[0]=min;extent[1]=max;return true}}function brushend(){brushmove();g.style("pointer-events","all").selectAll(".resize").style("display",brush.empty()?"none":null);d3.select("body").style("cursor",null);w.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);dragRestore();event_({type:"brushend"})}}brush.x=function(z){if(!arguments.length)return x;x=z;resizes=d3_svg_brushResizes[!x<<1|!y];return brush};brush.y=function(z){if(!arguments.length)return y;y=z;resizes=d3_svg_brushResizes[!x<<1|!y];return brush};brush.clamp=function(z){if(!arguments.length)return x&&y?[xClamp,yClamp]:x?xClamp:y?yClamp:null;if(x&&y)xClamp=!!z[0],yClamp=!!z[1];else if(x)xClamp=!!z;else if(y)yClamp=!!z;return brush};brush.extent=function(z){var x0,x1,y0,y1,t;if(!arguments.length){if(x){if(xExtentDomain){x0=xExtentDomain[0],x1=xExtentDomain[1]}else{x0=xExtent[0],x1=xExtent[1];if(x.invert)x0=x.invert(x0),x1=x.invert(x1);if(x1<x0)t=x0,x0=x1,x1=t}}if(y){if(yExtentDomain){y0=yExtentDomain[0],y1=yExtentDomain[1]}else{y0=yExtent[0],y1=yExtent[1];if(y.invert)y0=y.invert(y0),y1=y.invert(y1);if(y1<y0)t=y0,y0=y1,y1=t}}return x&&y?[[x0,y0],[x1,y1]]:x?[x0,x1]:y&&[y0,y1]}if(x){x0=z[0],x1=z[1];if(y)x0=x0[0],x1=x1[0];xExtentDomain=[x0,x1];if(x.invert)x0=x(x0),x1=x(x1);if(x1<x0)t=x0,x0=x1,x1=t;if(x0!=xExtent[0]||x1!=xExtent[1])xExtent=[x0,x1]}if(y){y0=z[0],y1=z[1];if(x)y0=y0[1],y1=y1[1];yExtentDomain=[y0,y1];if(y.invert)y0=y(y0),y1=y(y1);if(y1<y0)t=y0,y0=y1,y1=t;if(y0!=yExtent[0]||y1!=yExtent[1])yExtent=[y0,y1]}return brush};brush.clear=function(){if(!brush.empty()){xExtent=[0,0],yExtent=[0,0];xExtentDomain=yExtentDomain=null}return brush};brush.empty=function(){return!!x&&xExtent[0]==xExtent[1]||!!y&&yExtent[0]==yExtent[1]};return d3.rebind(brush,event,"on")};var d3_svg_brushCursor={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var d3_svg_brushResizes=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];var d3_time_format=d3_time.format=d3_locale_enUS.timeFormat;var d3_time_formatUtc=d3_time_format.utc;var d3_time_formatIso=d3_time_formatUtc("%Y-%m-%dT%H:%M:%S.%LZ");d3_time_format.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?d3_time_formatIsoNative:d3_time_formatIso;function d3_time_formatIsoNative(date){return date.toISOString()}d3_time_formatIsoNative.parse=function(string){var date=new Date(string);return isNaN(date)?null:date};d3_time_formatIsoNative.toString=d3_time_formatIso.toString;d3_time.second=d3_time_interval((function(date){return new d3_date(Math.floor(date/1e3)*1e3)}),(function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*1e3)}),(function(date){return date.getSeconds()}));d3_time.seconds=d3_time.second.range;d3_time.seconds.utc=d3_time.second.utc.range;d3_time.minute=d3_time_interval((function(date){return new d3_date(Math.floor(date/6e4)*6e4)}),(function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*6e4)}),(function(date){return date.getMinutes()}));d3_time.minutes=d3_time.minute.range;d3_time.minutes.utc=d3_time.minute.utc.range;d3_time.hour=d3_time_interval((function(date){var timezone=date.getTimezoneOffset()/60;return new d3_date((Math.floor(date/36e5-timezone)+timezone)*36e5)}),(function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*36e5)}),(function(date){return date.getHours()}));d3_time.hours=d3_time.hour.range;d3_time.hours.utc=d3_time.hour.utc.range;d3_time.month=d3_time_interval((function(date){date=d3_time.day(date);date.setDate(1);return date}),(function(date,offset){date.setMonth(date.getMonth()+offset)}),(function(date){return date.getMonth()}));d3_time.months=d3_time.month.range;d3_time.months.utc=d3_time.month.utc.range;function d3_time_scale(linear,methods,format){function scale(x){return linear(x)}scale.invert=function(x){return d3_time_scaleDate(linear.invert(x))};scale.domain=function(x){if(!arguments.length)return linear.domain().map(d3_time_scaleDate);linear.domain(x);return scale};function tickMethod(extent,count){var span=extent[1]-extent[0],target=span/count,i=d3.bisect(d3_time_scaleSteps,target);return i==d3_time_scaleSteps.length?[methods.year,d3_scale_linearTickRange(extent.map((function(d){return d/31536e6})),count)[2]]:!i?[d3_time_scaleMilliseconds,d3_scale_linearTickRange(extent,count)[2]]:methods[target/d3_time_scaleSteps[i-1]<d3_time_scaleSteps[i]/target?i-1:i]}scale.nice=function(interval,skip){var domain=scale.domain(),extent=d3_scaleExtent(domain),method=interval==null?tickMethod(extent,10):typeof interval==="number"&&tickMethod(extent,interval);if(method)interval=method[0],skip=method[1];function skipped(date){return!isNaN(date)&&!interval.range(date,d3_time_scaleDate(+date+1),skip).length}return scale.domain(d3_scale_nice(domain,skip>1?{floor:function(date){while(skipped(date=interval.floor(date)))date=d3_time_scaleDate(date-1);return date},ceil:function(date){while(skipped(date=interval.ceil(date)))date=d3_time_scaleDate(+date+1);return date}}:interval))};scale.ticks=function(interval,skip){var extent=d3_scaleExtent(scale.domain()),method=interval==null?tickMethod(extent,10):typeof interval==="number"?tickMethod(extent,interval):!interval.range&&[{range:interval},skip];if(method)interval=method[0],skip=method[1];return interval.range(extent[0],d3_time_scaleDate(+extent[1]+1),skip<1?1:skip)};scale.tickFormat=function(){return format};scale.copy=function(){return d3_time_scale(linear.copy(),methods,format)};return d3_scale_linearRebind(scale,linear)}function d3_time_scaleDate(t){return new Date(t)}var d3_time_scaleSteps=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6];var d3_time_scaleLocalMethods=[[d3_time.second,1],[d3_time.second,5],[d3_time.second,15],[d3_time.second,30],[d3_time.minute,1],[d3_time.minute,5],[d3_time.minute,15],[d3_time.minute,30],[d3_time.hour,1],[d3_time.hour,3],[d3_time.hour,6],[d3_time.hour,12],[d3_time.day,1],[d3_time.day,2],[d3_time.week,1],[d3_time.month,1],[d3_time.month,3],[d3_time.year,1]];var d3_time_scaleLocalFormat=d3_time_format.multi([[".%L",function(d){return d.getMilliseconds()}],[":%S",function(d){return d.getSeconds()}],["%I:%M",function(d){return d.getMinutes()}],["%I %p",function(d){return d.getHours()}],["%a %d",function(d){return d.getDay()&&d.getDate()!=1}],["%b %d",function(d){return d.getDate()!=1}],["%B",function(d){return d.getMonth()}],["%Y",d3_true]]);var d3_time_scaleMilliseconds={range:function(start,stop,step){return d3.range(Math.ceil(start/step)*step,+stop,step).map(d3_time_scaleDate)},floor:d3_identity,ceil:d3_identity};d3_time_scaleLocalMethods.year=d3_time.year;d3_time.scale=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleLocalMethods,d3_time_scaleLocalFormat)};var d3_time_scaleUtcMethods=d3_time_scaleLocalMethods.map((function(m){return[m[0].utc,m[1]]}));var d3_time_scaleUtcFormat=d3_time_formatUtc.multi([[".%L",function(d){return d.getUTCMilliseconds()}],[":%S",function(d){return d.getUTCSeconds()}],["%I:%M",function(d){return d.getUTCMinutes()}],["%I %p",function(d){return d.getUTCHours()}],["%a %d",function(d){return d.getUTCDay()&&d.getUTCDate()!=1}],["%b %d",function(d){return d.getUTCDate()!=1}],["%B",function(d){return d.getUTCMonth()}],["%Y",d3_true]]);d3_time_scaleUtcMethods.year=d3_time.year.utc;d3_time.scale.utc=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleUtcMethods,d3_time_scaleUtcFormat)};d3.text=d3_xhrType((function(request){return request.responseText}));d3.json=function(url,callback){return d3_xhr(url,"application/json",d3_json,callback)};function d3_json(request){return JSON.parse(request.responseText)}d3.html=function(url,callback){return d3_xhr(url,"text/html",d3_html,callback)};function d3_html(request){var range=d3_document.createRange();range.selectNode(d3_document.body);return range.createContextualFragment(request.responseText)}d3.xml=d3_xhrType((function(request){return request.responseXML}));if(true)this.d3=d3,!(__WEBPACK_AMD_DEFINE_FACTORY__=d3,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__));else{}}()},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(97);var react_1=__webpack_require__(2);var useIsomorphicLayoutEffect_1=tslib_1.__importDefault(__webpack_require__(275));function useObservable(observable$,initialValue){var _a=react_1.useState(initialValue),value=_a[0],update=_a[1];useIsomorphicLayoutEffect_1.default((function(){var s=observable$.subscribe(update);return function(){return s.unsubscribe()}}),[observable$]);return value}exports.default=useObservable},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(2);var useIsomorphicLayoutEffect=typeof window!=="undefined"?react_1.useLayoutEffect:react_1.useEffect;exports.default=useIsomorphicLayoutEffect},,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"ProtectedRoute",(function(){return ProtectedRoute}));__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return renderApp}));__webpack_require__.d(__webpack_exports__,"teardownFleet",(function(){return teardownFleet}));var external_kbnSharedDeps_React_=__webpack_require__(2);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(100);var external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_);var useObservable=__webpack_require__(274);var useObservable_default=__webpack_require__.n(useObservable);var external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(95);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(4);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(93);var external_kbnSharedDeps_StyledComponents_=__webpack_require__(94);var external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(11);var public_=__webpack_require__(96);var external_kbnSharedDeps_Theme_euiDarkVars_=__webpack_require__(101);var external_kbnSharedDeps_Theme_euiDarkVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiDarkVars_);var external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(102);var external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_);function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const EuiThemeProvider=_ref=>{let _ref$darkMode=_ref.darkMode,darkMode=_ref$darkMode===void 0?false:_ref$darkMode,otherProps=_objectWithoutProperties(_ref,["darkMode"]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_StyledComponents_["ThemeProvider"],_extends({},otherProps,{theme:outerTheme=>_objectSpread(_objectSpread({},outerTheme),{},{eui:darkMode?external_kbnSharedDeps_Theme_euiDarkVars_default.a:external_kbnSharedDeps_Theme_euiLightVars_default.a,darkMode:darkMode})}))};const eui_styled_components_ref2=external_kbnSharedDeps_StyledComponents_,euiStyled=eui_styled_components_ref2.default,css=eui_styled_components_ref2.css,createGlobalStyle=eui_styled_components_ref2.createGlobalStyle,keyframes=eui_styled_components_ref2.keyframes,withTheme=eui_styled_components_ref2.withTheme;var constants=__webpack_require__(12);const Loading=({size:size})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:size||"xl"})));const error_Error=({title:title,error:error})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:title,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,typeof error==="string"?error:error.message));function header_extends(){header_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return header_extends.apply(this,arguments)}const Container=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Container",componentId:"h7yryh-0"})(["border-bottom:",";background-color:",";"],props=>props.theme.eui.euiBorderThin,props=>props.theme.eui.euiPageBackgroundColor);const Wrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Wrapper",componentId:"h7yryh-1"})(["max-width:","px;margin-left:auto;margin-right:auto;padding-top:",";padding-left:",";padding-right:",";"],props=>props.maxWidth||1200,props=>props.theme.eui.paddingSizes.xl,props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.paddingSizes.m);const Tabs=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiTabs"]).withConfig({displayName:"Tabs",componentId:"h7yryh-2"})(["top:1px;&:before{height:0px;}"]);const HeaderColumns=Object(external_kbnSharedDeps_React_["memo"])(({leftColumn:leftColumn,rightColumn:rightColumn,rightColumnGrow:rightColumnGrow})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},leftColumn?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,leftColumn):null,rightColumn?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:rightColumnGrow},rightColumn):null));const header_Header=({leftColumn:leftColumn,rightColumn:rightColumn,rightColumnGrow:rightColumnGrow,tabs:tabs,maxWidth:maxWidth,tabsClassName:tabsClassName,"data-test-subj":dataTestSubj})=>external_kbnSharedDeps_React_default.a.createElement(Container,{"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(Wrapper,{maxWidth:maxWidth},external_kbnSharedDeps_React_default.a.createElement(HeaderColumns,{leftColumn:leftColumn,rightColumn:rightColumn,rightColumnGrow:rightColumnGrow}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,tabs?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(Tabs,{className:tabsClassName},tabs.map(props=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],header_extends({},props,{key:props.id}),props.name)))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})))));const AlphaFlyout=({onClose:onClose})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyout"],{onClose:onClose,size:"m",maxWidth:640},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true,"aria-labelledby":"AlphaMessagingFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"AlphaMessagingFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.alphaMessaging.flyoutTitle",defaultMessage:"About this release"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutBody"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.alphaMessaging.introText",defaultMessage:"Fleet is under active development and is not intended for use in production environments. This beta release is designed for users to test and offer feedback about Fleet and the new Elastic Agent. This plugin is not subject to the support SLA."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.alphaMessaging.feedbackText",defaultMessage:"Read our {docsLink} or go to our {forumLink} for questions or feedback.",values:{docsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://www.elastic.co/guide/en/fleet/current/index.html",external:true,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.alphaMessaging.docsLink",defaultMessage:"documentation"})),forumLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://ela.st/ingest-manager-forum",external:true,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.alphaMessaging.forumLink",defaultMessage:"Discuss forum"}))}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.alphaMessging.closeFlyoutLabel",defaultMessage:"Close"}))));function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const Message=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiText"]).attrs(props=>({color:"subdued",textAlign:"center",size:"s"})).withConfig({displayName:"Message",componentId:"lt2gk4-0"})(["padding:",";margin-top:auto;"],props=>props.theme.eui.paddingSizes.m);const AlphaMessaging=()=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=_slicedToArray(_useState,2),isAlphaFlyoutOpen=_useState2[0],setIsAlphaFlyoutOpen=_useState2[1];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Message,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.alphaMessageTitle",defaultMessage:"Beta release"}))," – ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.alphaMessageDescription",defaultMessage:"Fleet is not recommended for production environments."})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{color:"subdued",onClick:()=>setIsAlphaFlyoutOpen(true)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.alphaMessageLinkText",defaultMessage:"See more details."})))),isAlphaFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(AlphaFlyout,{onClose:()=>setIsAlphaFlyoutOpen(false)}))};var hooks=__webpack_require__(106);function package_icon_extends(){package_icon_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return package_icon_extends.apply(this,arguments)}function package_icon_objectWithoutProperties(source,excluded){if(source==null)return{};var target=package_icon_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function package_icon_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const PackageIcon=_ref=>{let packageName=_ref.packageName,version=_ref.version,icons=_ref.icons,tryApi=_ref.tryApi,euiIconProps=package_icon_objectWithoutProperties(_ref,["packageName","version","icons","tryApi"]);const iconType=Object(hooks["ib"])({packageName:packageName,version:version,icons:icons,tryApi:tryApi});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],package_icon_extends({size:"s",type:iconType},euiIconProps))};function context_menu_actions_extends(){context_menu_actions_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return context_menu_actions_extends.apply(this,arguments)}function context_menu_actions_slicedToArray(arr,i){return context_menu_actions_arrayWithHoles(arr)||context_menu_actions_iterableToArrayLimit(arr,i)||context_menu_actions_unsupportedIterableToArray(arr,i)||context_menu_actions_nonIterableRest()}function context_menu_actions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function context_menu_actions_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return context_menu_actions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return context_menu_actions_arrayLikeToArray(o,minLen)}function context_menu_actions_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function context_menu_actions_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function context_menu_actions_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function context_menu_actions_objectWithoutProperties(source,excluded){if(source==null)return{};var target=context_menu_actions_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function context_menu_actions_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const ContextMenuActions=external_kbnSharedDeps_React_default.a.memo(_ref=>{let button=_ref.button,onChange=_ref.onChange,isOpen=_ref.isOpen,props=context_menu_actions_objectWithoutProperties(_ref,["button","onChange","isOpen"]);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=context_menu_actions_slicedToArray(_useState,2),isOpenState=_useState2[0],setIsOpenState=_useState2[1];const handleCloseMenu=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(onChange){onChange(false)}else{setIsOpenState(false)}},[setIsOpenState,onChange]);const handleToggleMenu=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(onChange){onChange(!isOpen)}else{setIsOpenState(!isOpenState)}},[isOpenState,onChange,isOpen]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{anchorPosition:"downRight",panelPaddingSize:"none",button:button?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],context_menu_actions_extends({},button.props,{onClick:handleToggleMenu}),button.children):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:"boxesHorizontal",onClick:handleToggleMenu,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.genericActionsMenuText",{defaultMessage:"Open"})}),isOpen:isOpen===undefined?isOpenState:isOpen,closePopover:handleCloseMenu},"items"in props?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:props.items}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenu"],{panels:props.panels,initialPanelId:0}))});function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=search_bar_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function search_bar_slicedToArray(arr,i){return search_bar_arrayWithHoles(arr)||search_bar_iterableToArrayLimit(arr,i)||search_bar_unsupportedIterableToArray(arr,i)||search_bar_nonIterableRest()}function search_bar_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function search_bar_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return search_bar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return search_bar_arrayLikeToArray(o,minLen)}function search_bar_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function search_bar_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function search_bar_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function search_bar_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function search_bar_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){search_bar_ownKeys(Object(source),true).forEach((function(key){search_bar_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{search_bar_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function search_bar_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const DEBOUNCE_SEARCH_MS=150;const HIDDEN_FIELDS=["".concat(constants["c"],".actions")];const SearchBar=({value:value,fieldPrefix:fieldPrefix,onChange:onChange,placeholder:placeholder})=>{const _useSuggestions=useSuggestions(fieldPrefix,value),suggestions=_useSuggestions.suggestions;const onAutocompleteClick=suggestion=>{onChange([value.slice(0,suggestion.start),suggestion.value,value.slice(suggestion.end,-1)].join(""))};const onChangeSearch=e=>{onChange(e.value)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuggest"],{value:value,icon:"search",placeholder:placeholder||external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.defaultSearchPlaceholderText",{defaultMessage:"Search"}),onInputChange:onChangeSearch,onItemClick:onAutocompleteClick,suggestions:suggestions.map(suggestion=>search_bar_objectSpread(search_bar_objectSpread({},suggestion),{},{onClick:()=>{},descriptionDisplay:"wrap",labelWidth:"40"}))})};function transformSuggestionType(type){switch(type){case"field":return{iconType:"kqlField",color:"tint4"};case"value":return{iconType:"kqlValue",color:"tint0"};case"conjunction":return{iconType:"kqlSelector",color:"tint3"};case"operator":return{iconType:"kqlOperand",color:"tint1"};default:return{iconType:"kqlOther",color:"tint1"}}}function useSuggestions(fieldPrefix,search){const _useStartServices=Object(hooks["mb"])(),data=_useStartServices.data;const debouncedSearch=Object(hooks["M"])(search,DEBOUNCE_SEARCH_MS);const _useState=Object(external_kbnSharedDeps_React_["useState"])([]),_useState2=search_bar_slicedToArray(_useState,2),suggestions=_useState2[0],setSuggestions=_useState2[1];const fetchSuggestions=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var res,query,esSuggestions;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return data.indexPatterns.getFieldsForWildcard({pattern:constants["f"]});case 3:res=_context.sent;if(!(!data||!data.autocomplete)){_context.next=6;break}throw new Error("Missing data plugin");case 6:query=debouncedSearch||"";_context.next=9;return data.autocomplete.getQuerySuggestions({language:"kuery",indexPatterns:[{title:constants["f"],fields:res}],boolFilter:[],query:query,selectionStart:query.length,selectionEnd:query.length});case 9:esSuggestions=_context.sent.filter(suggestion=>{if(suggestion.type==="conjunction"){return true}if(suggestion.type==="value"){return true}if(suggestion.type==="operator"){return true}if(fieldPrefix&&suggestion.text.startsWith(fieldPrefix)){var _iterator=_createForOfIteratorHelper(HIDDEN_FIELDS),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){const hiddenField=_step.value;if(suggestion.text.startsWith(hiddenField)){return false}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return true}return false}).map(suggestion=>({label:suggestion.text,description:suggestion.description||"",type:transformSuggestionType(suggestion.type),start:suggestion.start,end:suggestion.end,value:suggestion.text}));setSuggestions(esSuggestions);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context["catch"](0);setSuggestions([]);case 16:case"end":return _context.stop()}}),_callee,null,[[0,13]])})));return function fetchSuggestions(){return _ref.apply(this,arguments)}}();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{fetchSuggestions()},[debouncedSearch]);return{suggestions:suggestions}}var js_yaml=__webpack_require__(26);var outputs=__webpack_require__(121);var common=__webpack_require__(1);function settings_flyout_extends(){settings_flyout_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return settings_flyout_extends.apply(this,arguments)}function settings_flyout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function settings_flyout_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){settings_flyout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){settings_flyout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function settings_flyout_slicedToArray(arr,i){return settings_flyout_arrayWithHoles(arr)||settings_flyout_iterableToArrayLimit(arr,i)||settings_flyout_unsupportedIterableToArray(arr,i)||settings_flyout_nonIterableRest()}function settings_flyout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function settings_flyout_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return settings_flyout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return settings_flyout_arrayLikeToArray(o,minLen)}function settings_flyout_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function settings_flyout_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function settings_flyout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const URL_REGEX=/^(https?):\/\/[^\s$.?#].[^\s]*$/gm;function useSettingsForm(outputId,onSuccess){const _React$useState=external_kbnSharedDeps_React_default.a.useState(false),_React$useState2=settings_flyout_slicedToArray(_React$useState,2),isLoading=_React$useState2[0],setIsloading=_React$useState2[1];const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const kibanaUrlsInput=Object(hooks["K"])([],value=>{if(value.length===0){return[external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.kibanaUrlEmptyError",{defaultMessage:"At least one URL is required"})]}if(value.some(v=>!v.match(URL_REGEX))){return[external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.kibanaUrlError",{defaultMessage:"Invalid URL"})]}if(Object(common["isDiffPathProtocol"])(value)){return[external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.kibanaUrlDifferentPathOrProtocolError",{defaultMessage:"Protocol and path must be the same for each URL"})]}});const elasticsearchUrlInput=Object(hooks["K"])([],value=>{if(value.some(v=>!v.match(URL_REGEX))){return[external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.elasticHostError",{defaultMessage:"Invalid URL"})]}});const additionalYamlConfigInput=Object(hooks["db"])("",value=>{try{Object(js_yaml["safeLoad"])(value);return}catch(error){return[external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.invalidYamlFormatErrorMessage",{defaultMessage:"Invalid YAML: {reason}",values:{reason:error.message}})]}});return{isLoading:isLoading,onSubmit:function(){var _onSubmit=settings_flyout_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var outputResponse,settingsResponse;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(!kibanaUrlsInput.validate()||!elasticsearchUrlInput.validate()||!additionalYamlConfigInput.validate())){_context.next=2;break}return _context.abrupt("return");case 2:_context.prev=2;setIsloading(true);if(outputId){_context.next=6;break}throw new Error("Unable to load outputs");case 6:_context.next=8;return Object(outputs["a"])(outputId,{hosts:elasticsearchUrlInput.value,config_yaml:additionalYamlConfigInput.value});case 8:outputResponse=_context.sent;if(!outputResponse.error){_context.next=11;break}throw outputResponse.error;case 11:_context.next=13;return Object(hooks["C"])({kibana_urls:kibanaUrlsInput.value});case 13:settingsResponse=_context.sent;if(!settingsResponse.error){_context.next=16;break}throw settingsResponse.error;case 16:notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.success.message",{defaultMessage:"Settings saved"}));setIsloading(false);onSuccess();_context.next=25;break;case 21:_context.prev=21;_context.t0=_context["catch"](2);setIsloading(false);notifications.toasts.addError(_context.t0,{title:"Error"});case 25:case"end":return _context.stop()}}),_callee,null,[[2,21]])})));function onSubmit(){return _onSubmit.apply(this,arguments)}return onSubmit}(),inputs:{kibanaUrls:kibanaUrlsInput,elasticsearchUrl:elasticsearchUrlInput,additionalYamlConfig:additionalYamlConfigInput}}}const SettingFlyout=({onClose:onClose})=>{var _settingsRequest$data,_outputsRequest$data,_outputsRequest$data$;const settingsRequest=Object(hooks["cb"])();const settings=settingsRequest===null||settingsRequest===void 0?void 0:(_settingsRequest$data=settingsRequest.data)===null||_settingsRequest$data===void 0?void 0:_settingsRequest$data.item;const outputsRequest=Object(outputs["b"])();const output=(_outputsRequest$data=outputsRequest.data)===null||_outputsRequest$data===void 0?void 0:(_outputsRequest$data$=_outputsRequest$data.items)===null||_outputsRequest$data$===void 0?void 0:_outputsRequest$data$[0];const _useSettingsForm=useSettingsForm(output===null||output===void 0?void 0:output.id,onClose),inputs=_useSettingsForm.inputs,onSubmit=_useSettingsForm.onSubmit,isLoading=_useSettingsForm.isLoading;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(output){inputs.elasticsearchUrl.setValue(output.hosts||[]);inputs.additionalYamlConfig.setValue(output.config_yaml||"# YAML settings here will be added to the Elasticsearch output section of each policy")}},[output]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(settings){inputs.kibanaUrls.setValue(settings.kibana_urls)}},[settings]);const body=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRadioGroup"],{options:[{id:"enabled",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.autoUpgradeEnabledLabel",{defaultMessage:"Automatically update agent binaries to use the latest minor version."})},{id:"disabled",disabled:true,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.autoUpgradeDisabledLabel",{defaultMessage:"Manually manage agent binary versions. Requires a Gold subscription."})}],idSelected:"enabled",onChange:id=>{},legend:{children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.settings.autoUpgradeFieldLabel",defaultMessage:"Elastic Agent binary version"})))}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRadioGroup"],{options:[{id:"enabled",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.integrationUpgradeEnabledFieldLabel",{defaultMessage:"Automatically update integrations to the latest version to get the latest assets. You might need to update agent policies to use new features."})},{id:"disabled",disabled:true,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.integrationUpgradeDisabledFieldLabel",{defaultMessage:"Manually manage integration versions yourself."})}],idSelected:"enabled",onChange:id=>{},legend:{children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.settings.integrationUpgradeFieldLabel",defaultMessage:"Integration version"})))}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.settings.globalOutputTitle",defaultMessage:"Global output"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.settings.globalOutputDescription",defaultMessage:"Specify where to send data. These settings are applied to all Elastic Agent policies."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],settings_flyout_extends({label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.kibanaUrlLabel",{defaultMessage:"Kibana URL"})},inputs.kibanaUrls.formRowProps),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],settings_flyout_extends({noSuggestions:true},inputs.kibanaUrls.props)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],settings_flyout_extends({label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.elasticsearchUrlLabel",{defaultMessage:"Elasticsearch URL"})},inputs.elasticsearchUrl.formRowProps),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],settings_flyout_extends({noSuggestions:true},inputs.elasticsearchUrl.props)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],settings_flyout_extends({},inputs.additionalYamlConfig.formRowProps,{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.settings.additionalYamlConfig",{defaultMessage:"Elasticsearch output configuration"}),fullWidth:true}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeEditor"],settings_flyout_extends({width:"100%",mode:"yaml",theme:"textmate",setOptions:{minLines:10,maxLines:30,tabSize:2,showGutter:false}},inputs.additionalYamlConfig.props,{onChange:inputs.additionalYamlConfig.setValue})))));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyout"],{onClose:onClose,size:"l",maxWidth:640},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true,"aria-labelledby":"IngestManagerSettingsFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"IngestManagerSettingsFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.settings.flyoutTitle",defaultMessage:"Fleet settings"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutBody"],null,body),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.settings.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:onSubmit,iconType:"save",isLoading:isLoading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.settings.saveButtonLabel",defaultMessage:"Save settings"}))))))};function link_and_revision_extends(){link_and_revision_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return link_and_revision_extends.apply(this,arguments)}function link_and_revision_objectWithoutProperties(source,excluded){if(source==null)return{};var target=link_and_revision_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function link_and_revision_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const MIN_WIDTH={minWidth:0};const NO_WRAP_WHITE_SPACE={whiteSpace:"nowrap"};const LinkAndRevision=Object(external_kbnSharedDeps_React_["memo"])(_ref=>{let revision=_ref.revision,className=_ref.className,euiLinkProps=link_and_revision_objectWithoutProperties(_ref,["revision","className"]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"baseline",style:MIN_WIDTH,responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],link_and_revision_extends({className:"eui-textTruncate ".concat(className!==null&&className!==void 0?className:"")},euiLinkProps))),revision&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs",style:NO_WRAP_WHITE_SPACE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyNameLink.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:revision}}))))});function default_slicedToArray(arr,i){return default_arrayWithHoles(arr)||default_iterableToArrayLimit(arr,i)||default_unsupportedIterableToArray(arr,i)||default_nonIterableRest()}function default_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function default_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return default_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return default_arrayLikeToArray(o,minLen)}function default_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function default_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function default_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const default_Container=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Container",componentId:"sc-1ascj29-0"})(["min-height:calc( 100vh - ","px );background:",";display:flex;flex-direction:column;"],props=>parseFloat(props.theme.eui.euiHeaderHeightCompensation)*2,props=>props.theme.eui.euiColorEmptyShade);const default_Wrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1ascj29-1"})(["display:flex;flex-direction:column;flex:1;"]);const Nav=external_kbnSharedDeps_StyledComponents_default.a.nav.withConfig({displayName:"Nav",componentId:"sc-1ascj29-2"})(["background:",";border-bottom:",";padding:",";.euiTabs{padding-left:3px;margin-left:-3px;}"],props=>props.theme.eui.euiColorEmptyShade,props=>props.theme.eui.euiBorderThin,props=>"".concat(props.theme.eui.euiSize," ").concat(props.theme.eui.euiSizeL," ").concat(props.theme.eui.euiSize," ").concat(props.theme.eui.euiSizeL));const DefaultLayout=({showSettings:showSettings=true,section:section,children:children})=>{const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const _useConfig=Object(hooks["L"])(),agents=_useConfig.agents;const _React$useState=external_kbnSharedDeps_React_default.a.useState(false),_React$useState2=default_slicedToArray(_React$useState,2),isSettingsFlyoutOpen=_React$useState2[0],setIsSettingsFlyoutOpen=_React$useState2[1];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isSettingsFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(SettingFlyout,{onClose:()=>{setIsSettingsFlyoutOpen(false)}}),external_kbnSharedDeps_React_default.a.createElement(default_Container,null,external_kbnSharedDeps_React_default.a.createElement(default_Wrapper,null,external_kbnSharedDeps_React_default.a.createElement(Nav,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"l",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{display:"condensed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:section==="overview",href:getHref("overview")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.appNavigation.overviewLinkText",defaultMessage:"Overview"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:section==="epm",href:getHref("integrations_all")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.appNavigation.epmLinkText",defaultMessage:"Integrations"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:section==="agent_policy",href:getHref("policies_list")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.appNavigation.policiesLinkText",defaultMessage:"Policies"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:section==="fleet",href:getHref("fleet"),disabled:!(agents===null||agents===void 0?void 0:agents.enabled)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.appNavigation.agentsLinkText",defaultMessage:"Agents"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:section==="data_stream",href:getHref("data_streams")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.appNavigation.dataStreamsLinkText",defaultMessage:"Data streams"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"popout",href:"https://ela.st/ingest-manager-feedback",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.appNavigation.sendFeedbackButton",defaultMessage:"Send feedback"}))),showSettings?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"gear",onClick:()=>setIsSettingsFlyoutOpen(true)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.appNavigation.settingsButton",defaultMessage:"Settings"}))):null)))),children),external_kbnSharedDeps_React_default.a.createElement(AlphaMessaging,null)))};const Page=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPage"]).withConfig({displayName:"Page",componentId:"m0w1fb-0"})(["background:",";width:100%;align-self:center;margin-left:0;margin-right:0;flex:1;"],props=>props.theme.eui.euiColorEmptyShade);const ContentWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ContentWrapper",componentId:"m0w1fb-1"})(["height:100%;"]);const WithoutHeaderLayout=({restrictWidth:restrictWidth,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(Page,{restrictWidth:restrictWidth||1200},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageBody"],null,external_kbnSharedDeps_React_default.a.createElement(ContentWrapper,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),children))));function with_header_extends(){with_header_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return with_header_extends.apply(this,arguments)}function with_header_objectWithoutProperties(source,excluded){if(source==null)return{};var target=with_header_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function with_header_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const WithHeaderLayout=_ref=>{let restrictWidth=_ref.restrictWidth,restrictHeaderWidth=_ref.restrictHeaderWidth,children=_ref.children,dataTestSubj=_ref["data-test-subj"],rest=with_header_objectWithoutProperties(_ref,["restrictWidth","restrictHeaderWidth","children","data-test-subj"]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(header_Header,with_header_extends({maxWidth:restrictHeaderWidth,"data-test-subj":dataTestSubj?"".concat(dataTestSubj,"_header"):undefined},rest)),external_kbnSharedDeps_React_default.a.createElement(Page,{restrictWidth:restrictWidth||1200,"data-test-subj":dataTestSubj?"".concat(dataTestSubj,"_page"):undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageBody"],null,external_kbnSharedDeps_React_default.a.createElement(ContentWrapper,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),children))))};const loading_Loading=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"xl"})));const AgentPolicyPackageBadges=({agentPolicyId:agentPolicyId})=>{const agentPolicyRequest=Object(hooks["W"])(agentPolicyId);const agentPolicy=agentPolicyRequest.data?agentPolicyRequest.data.item:null;if(!agentPolicy){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentReassignPolicy.policyDescription",defaultMessage:"The selected agent policy will collect data for {count, plural, one {{countValue} integration} other {{countValue} integrations}}:",values:{count:agentPolicy.package_policies.length,countValue:external_kbnSharedDeps_React_default.a.createElement("b",null,agentPolicy.package_policies.length)}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),agentPolicy.package_policies.map((packagePolicy,idx)=>{if(!packagePolicy.package){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{key:idx,color:"hollow"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:packagePolicy.package.name,version:packagePolicy.package.version,size:"s",tryApi:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},packagePolicy.package.title)))}))};function agent_reassign_policy_flyout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function agent_reassign_policy_flyout_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){agent_reassign_policy_flyout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){agent_reassign_policy_flyout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function agent_reassign_policy_flyout_slicedToArray(arr,i){return agent_reassign_policy_flyout_arrayWithHoles(arr)||agent_reassign_policy_flyout_iterableToArrayLimit(arr,i)||agent_reassign_policy_flyout_unsupportedIterableToArray(arr,i)||agent_reassign_policy_flyout_nonIterableRest()}function agent_reassign_policy_flyout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function agent_reassign_policy_flyout_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return agent_reassign_policy_flyout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return agent_reassign_policy_flyout_arrayLikeToArray(o,minLen)}function agent_reassign_policy_flyout_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function agent_reassign_policy_flyout_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function agent_reassign_policy_flyout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AgentReassignAgentPolicyFlyout=({onClose:onClose,agents:agents})=>{const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const isSingleAgent=Array.isArray(agents)&&agents.length===1;const _useState=Object(external_kbnSharedDeps_React_["useState"])(isSingleAgent?agents[0].policy_id:undefined),_useState2=agent_reassign_policy_flyout_slicedToArray(_useState,2),selectedAgentPolicyId=_useState2[0],setSelectedAgentPolicyId=_useState2[1];const agentPoliciesRequest=Object(hooks["O"])({page:1,perPage:1e3});const agentPolicies=agentPoliciesRequest.data?agentPoliciesRequest.data.items:[];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!selectedAgentPolicyId&&agentPolicies[0]){setSelectedAgentPolicyId(agentPolicies[0].id)}},[agentPolicies,selectedAgentPolicyId]);const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=agent_reassign_policy_flyout_slicedToArray(_useState3,2),isSubmitting=_useState4[0],setIsSubmitting=_useState4[1];function onSubmit(){return _onSubmit.apply(this,arguments)}function _onSubmit(){_onSubmit=agent_reassign_policy_flyout_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var res,successMessage;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setIsSubmitting(true);if(selectedAgentPolicyId){_context.next=4;break}throw new Error("No selected agent policy id");case 4:if(!isSingleAgent){_context.next=10;break}_context.next=7;return Object(hooks["B"])(agents[0].id,{policy_id:selectedAgentPolicyId});case 7:_context.t0=_context.sent;_context.next=13;break;case 10:_context.next=12;return Object(hooks["x"])({policy_id:selectedAgentPolicyId,agents:Array.isArray(agents)?agents.map(agent=>agent.id):agents});case 12:_context.t0=_context.sent;case 13:res=_context.t0;if(!res.error){_context.next=16;break}throw res.error;case 16:setIsSubmitting(false);successMessage=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentReassignPolicy.successSingleNotificationTitle",{defaultMessage:"Agent policy reassigned"});notifications.toasts.addSuccess(successMessage);onClose();_context.next=26;break;case 22:_context.prev=22;_context.t1=_context["catch"](0);setIsSubmitting(false);notifications.toasts.addError(_context.t1,{title:"Unable to reassign agent policy"});case 26:case"end":return _context.stop()}}),_callee,null,[[0,22]])})));return _onSubmit.apply(this,arguments)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyout"],{onClose:onClose,size:"l",maxWidth:640},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true,"aria-labelledby":"FleetAgentReassigmentFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"FleetAgentReassigmentFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentReassignPolicy.flyoutTitle",defaultMessage:"Assign new agent policy"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentReassignPolicy.flyoutDescription",defaultMessage:"Choose a new agent policy to assign the selected {count, plural, one {agent} other {agents}} to.",values:{count:isSingleAgent?1:0}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutBody"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentReassignPolicy.selectPolicyLabel",{defaultMessage:"Agent policy"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{fullWidth:true,isLoading:agentPoliciesRequest.isLoading,options:agentPolicies.map(agentPolicy=>({value:agentPolicy.id,text:agentPolicy.name})),value:selectedAgentPolicyId,onChange:e=>setSelectedAgentPolicyId(e.target.value)})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),selectedAgentPolicyId&&external_kbnSharedDeps_React_default.a.createElement(AgentPolicyPackageBadges,{agentPolicyId:selectedAgentPolicyId})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentReassignPolicy.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{disabled:isSingleAgent&&selectedAgentPolicyId===agents[0].policy_id,fill:true,onClick:onSubmit,isLoading:isSubmitting},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentReassignPolicy.continueButtonLabel",defaultMessage:"Assign policy"}))))))};const CommandCode=external_kbnSharedDeps_StyledComponents_default.a.pre.withConfig({displayName:"CommandCode",componentId:"sc-1hf7c98-0"})({overflow:"scroll"});const ManualInstructions=({kibanaUrl:kibanaUrl,apiKey:apiKey,kibanaCASha256:kibanaCASha256})=>{const enrollArgs="--kibana-url=".concat(kibanaUrl," --enrollment-token=").concat(apiKey.api_key).concat(kibanaCASha256?" --ca_sha256=".concat(kibanaCASha256):"");const linuxMacCommand="./elastic-agent install -f ".concat(enrollArgs);const windowsCommand=".\\elastic-agent.exe install -f ".concat(enrollArgs);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollmentInstructions.descriptionText",defaultMessage:"From the agent directory, run the appropriate command to install, enroll, and start an Elastic Agent. You can reuse these commands to set up agents on more than one host. Requires administrator privileges."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollmentInstructions.linuxMacOSTitle",defaultMessage:"Linux, macOS"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{fontSize:"m",isCopyable:true,paddingSize:"m"},external_kbnSharedDeps_React_default.a.createElement(CommandCode,null,linuxMacCommand)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollmentInstructions.windowsTitle",defaultMessage:"Windows"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{fontSize:"m",isCopyable:true,paddingSize:"m"},external_kbnSharedDeps_React_default.a.createElement(CommandCode,null,windowsCommand)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollmentInstructions.moreInstructionsText",defaultMessage:"See the {link} for more instructions and options.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{target:"_blank",external:true,href:"https://www.elastic.co/guide/en/fleet/current/elastic-agent-installation-configuration.html"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollmentInstructions.moreInstructionsLink",defaultMessage:"Elastic Agent docs"}))}})))};function agent_policy_selection_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function agent_policy_selection_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){agent_policy_selection_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){agent_policy_selection_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function agent_policy_selection_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function agent_policy_selection_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){agent_policy_selection_ownKeys(Object(source),true).forEach((function(key){agent_policy_selection_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{agent_policy_selection_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function agent_policy_selection_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function agent_policy_selection_slicedToArray(arr,i){return agent_policy_selection_arrayWithHoles(arr)||agent_policy_selection_iterableToArrayLimit(arr,i)||agent_policy_selection_unsupportedIterableToArray(arr,i)||agent_policy_selection_nonIterableRest()}function agent_policy_selection_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function agent_policy_selection_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return agent_policy_selection_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return agent_policy_selection_arrayLikeToArray(o,minLen)}function agent_policy_selection_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function agent_policy_selection_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function agent_policy_selection_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const EnrollmentStepAgentPolicy=props=>{const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const withKeySelection=props.withKeySelection,agentPolicies=props.agentPolicies,onAgentPolicyChange=props.onAgentPolicyChange;const onKeyChange=props.withKeySelection&&props.onKeyChange;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=agent_policy_selection_slicedToArray(_useState,2),isAuthenticationSettingsOpen=_useState2[0],setIsAuthenticationSettingsOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])([]),_useState4=agent_policy_selection_slicedToArray(_useState3,2),enrollmentAPIKeys=_useState4[0],setEnrollmentAPIKeys=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({}),_useState6=agent_policy_selection_slicedToArray(_useState5,2),selectedState=_useState6[0],setSelectedState=_useState6[1];Object(external_kbnSharedDeps_React_["useEffect"])((function triggerOnAgentPolicyChangeEffect(){if(onAgentPolicyChange&&selectedState.agentPolicyId){onAgentPolicyChange(selectedState.agentPolicyId)}}),[selectedState.agentPolicyId,onAgentPolicyChange]);Object(external_kbnSharedDeps_React_["useEffect"])((function triggerOnKeyChangeEffect(){if(!withKeySelection||!onKeyChange){return}if(selectedState.enrollmentAPIKeyId){onKeyChange(selectedState.enrollmentAPIKeyId)}}),[withKeySelection,onKeyChange,selectedState.enrollmentAPIKeyId]);Object(external_kbnSharedDeps_React_["useEffect"])((function useDefaultAgentPolicyEffect(){if(agentPolicies&&agentPolicies.length&&!selectedState.agentPolicyId){if(agentPolicies.length===1){setSelectedState(agent_policy_selection_objectSpread(agent_policy_selection_objectSpread({},selectedState),{},{agentPolicyId:agentPolicies[0].id}));return}const defaultAgentPolicy=agentPolicies.find(agentPolicy=>agentPolicy.is_default);if(defaultAgentPolicy){setSelectedState(agent_policy_selection_objectSpread(agent_policy_selection_objectSpread({},selectedState),{},{agentPolicyId:defaultAgentPolicy.id}))}}}),[agentPolicies,selectedState]);Object(external_kbnSharedDeps_React_["useEffect"])((function useEnrollmentKeysForAgentPolicyEffect(){if(!withKeySelection){return}if(!selectedState.agentPolicyId){setEnrollmentAPIKeys([]);return}function fetchEnrollmentAPIKeys(){return _fetchEnrollmentAPIKeys.apply(this,arguments)}function _fetchEnrollmentAPIKeys(){_fetchEnrollmentAPIKeys=agent_policy_selection_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var res;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Object(hooks["l"])({page:1,perPage:constants["j"]});case 3:res=_context.sent;if(!res.error){_context.next=6;break}throw res.error;case 6:if(res.data){_context.next=8;break}throw new Error("No data while fetching enrollment API keys");case 8:setEnrollmentAPIKeys(res.data.list.filter(key=>key.policy_id===selectedState.agentPolicyId));_context.next=14;break;case 11:_context.prev=11;_context.t0=_context["catch"](0);notifications.toasts.addError(_context.t0,{title:"Error"});case 14:case"end":return _context.stop()}}),_callee,null,[[0,11]])})));return _fetchEnrollmentAPIKeys.apply(this,arguments)}fetchEnrollmentAPIKeys()}),[withKeySelection,selectedState.agentPolicyId,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])((function useDefaultEnrollmentKeyForAgentPolicyEffect(){if(!withKeySelection){return}if(!selectedState.enrollmentAPIKeyId&&enrollmentAPIKeys.length>0&&enrollmentAPIKeys[0].policy_id===selectedState.agentPolicyId){const enrollmentAPIKeyId=enrollmentAPIKeys[0].id;setSelectedState({agentPolicyId:selectedState.agentPolicyId,enrollmentAPIKeyId:enrollmentAPIKeyId})}}),[withKeySelection,enrollmentAPIKeys,selectedState.enrollmentAPIKeyId,selectedState.agentPolicyId]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{fullWidth:true,prepend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollmentStepAgentPolicy.policySelectLabel",defaultMessage:"Agent policy"})),isLoading:!agentPolicies,options:(agentPolicies||[]).map(agentPolicy=>({value:agentPolicy.id,text:agentPolicy.name})),value:selectedState.agentPolicyId||undefined,onChange:e=>setSelectedState({agentPolicyId:e.target.value,enrollmentAPIKeyId:undefined}),"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentStepAgentPolicy.policySelectAriaLabel",{defaultMessage:"Agent policy"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),selectedState.agentPolicyId&&external_kbnSharedDeps_React_default.a.createElement(AgentPolicyPackageBadges,{agentPolicyId:selectedState.agentPolicyId}),withKeySelection&&onKeyChange&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{flush:"left",iconType:isAuthenticationSettingsOpen?"arrowDown":"arrowRight",onClick:()=>setIsAuthenticationSettingsOpen(!isAuthenticationSettingsOpen)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollmentStepAgentPolicy.showAuthenticationSettingsButton",defaultMessage:"Authentication settings"})),isAuthenticationSettingsOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{fullWidth:true,options:enrollmentAPIKeys.map(key=>({value:key.id,text:key.name})),value:selectedState.enrollmentAPIKeyId||undefined,prepend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollmentStepAgentPolicy.enrollmentTokenSelectLabel",defaultMessage:"Enrollment token"})),onChange:e=>{setSelectedState(agent_policy_selection_objectSpread(agent_policy_selection_objectSpread({},selectedState),{},{enrollmentAPIKeyId:e.target.value}))}}))))};const DownloadStep=()=>({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentEnrollment.stepDownloadAgentTitle",{defaultMessage:"Download the Elastic Agent to your host"}),children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.downloadDescription",defaultMessage:"You can download the agent binaries and their verification signatures from the Elastic Agent download page."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{href:"https://ela.st/download-elastic-agent",target:"_blank",iconSide:"right",iconType:"popout"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.downloadLink",defaultMessage:"Go to download page"})))});const AgentPolicySelectionStep=({agentPolicies:agentPolicies,setSelectedAPIKeyId:setSelectedAPIKeyId,setSelectedPolicyId:setSelectedPolicyId})=>({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentEnrollment.stepChooseAgentPolicyTitle",{defaultMessage:"Choose an agent policy"}),children:external_kbnSharedDeps_React_default.a.createElement(EnrollmentStepAgentPolicy,{agentPolicies:agentPolicies,withKeySelection:setSelectedAPIKeyId?true:false,onKeyChange:setSelectedAPIKeyId,onAgentPolicyChange:setSelectedPolicyId})});function managed_instructions_slicedToArray(arr,i){return managed_instructions_arrayWithHoles(arr)||managed_instructions_iterableToArrayLimit(arr,i)||managed_instructions_unsupportedIterableToArray(arr,i)||managed_instructions_nonIterableRest()}function managed_instructions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function managed_instructions_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return managed_instructions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return managed_instructions_arrayLikeToArray(o,minLen)}function managed_instructions_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function managed_instructions_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function managed_instructions_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ManagedInstructions=external_kbnSharedDeps_React_default.a.memo(({agentPolicies:agentPolicies})=>{var _settings$data,_settings$data$item,_settings$data2,_settings$data2$item;const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const core=Object(hooks["mb"])();const fleetStatus=Object(hooks["N"])();const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=managed_instructions_slicedToArray(_useState,2),selectedAPIKeyId=_useState2[0],setSelectedAPIKeyId=_useState2[1];const settings=Object(hooks["cb"])();const apiKey=Object(hooks["Y"])(selectedAPIKeyId);const kibanaUrlsSettings=(_settings$data=settings.data)===null||_settings$data===void 0?void 0:(_settings$data$item=_settings$data.item)===null||_settings$data$item===void 0?void 0:_settings$data$item.kibana_urls;const kibanaUrl=kibanaUrlsSettings?kibanaUrlsSettings[0]:"".concat(window.location.origin).concat(core.http.basePath.get());const kibanaCASha256=(_settings$data2=settings.data)===null||_settings$data2===void 0?void 0:(_settings$data2$item=_settings$data2.item)===null||_settings$data2$item===void 0?void 0:_settings$data2$item.kibana_ca_sha256;const steps=[DownloadStep(),AgentPolicySelectionStep({agentPolicies:agentPolicies,setSelectedAPIKeyId:setSelectedAPIKeyId}),{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentEnrollment.stepEnrollAndRunAgentTitle",{defaultMessage:"Enroll and start the Elastic Agent"}),children:apiKey.data&&external_kbnSharedDeps_React_default.a.createElement(ManualInstructions,{apiKey:apiKey.data.item,kibanaUrl:kibanaUrl,kibanaCASha256:kibanaCASha256})}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.managedDescription",defaultMessage:"Enroll an Elastic Agent in Fleet to automatically deploy updates and centrally manage the agent."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),fleetStatus.isReady?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSteps"],{steps:steps})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.agentsNotInitializedText",defaultMessage:"Before enrolling agents, {link}.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:getHref("fleet")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.setUpAgentsLink",defaultMessage:"set up central management for Elastic Agents"}))}})))});var services=__webpack_require__(107);function standalone_instructions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function standalone_instructions_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){standalone_instructions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){standalone_instructions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function standalone_instructions_slicedToArray(arr,i){return standalone_instructions_arrayWithHoles(arr)||standalone_instructions_iterableToArrayLimit(arr,i)||standalone_instructions_unsupportedIterableToArray(arr,i)||standalone_instructions_nonIterableRest()}function standalone_instructions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function standalone_instructions_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return standalone_instructions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return standalone_instructions_arrayLikeToArray(o,minLen)}function standalone_instructions_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function standalone_instructions_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function standalone_instructions_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const RUN_INSTRUCTIONS="./elastic-agent install";const StandaloneInstructions=external_kbnSharedDeps_React_default.a.memo(({agentPolicies:agentPolicies})=>{const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const core=Object(hooks["mb"])();const notifications=core.notifications;const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=standalone_instructions_slicedToArray(_useState,2),selectedPolicyId=_useState2[0],setSelectedPolicyId=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=standalone_instructions_slicedToArray(_useState3,2),fullAgentPolicy=_useState4[0],setFullAgentPolicy=_useState4[1];const downloadLink=selectedPolicyId?core.http.basePath.prepend("".concat(services["b"].getInfoFullDownloadPath(selectedPolicyId),"?standalone=true")):undefined;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{function fetchFullPolicy(){return _fetchFullPolicy.apply(this,arguments)}function _fetchFullPolicy(){_fetchFullPolicy=standalone_instructions_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var res;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;if(selectedPolicyId){_context.next=3;break}return _context.abrupt("return");case 3:_context.next=5;return Object(hooks["o"])(selectedPolicyId,{standalone:true});case 5:res=_context.sent;if(!res.error){_context.next=8;break}throw res.error;case 8:if(res.data){_context.next=10;break}throw new Error("No data while fetching full agent policy");case 10:setFullAgentPolicy(res.data.item);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context["catch"](0);notifications.toasts.addError(_context.t0,{title:"Error"});case 16:case"end":return _context.stop()}}),_callee,null,[[0,13]])})));return _fetchFullPolicy.apply(this,arguments)}fetchFullPolicy()},[selectedPolicyId,notifications.toasts]);const yaml=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(services["j"])(fullAgentPolicy),[fullAgentPolicy]);const steps=[DownloadStep(),AgentPolicySelectionStep({agentPolicies:agentPolicies,setSelectedPolicyId:setSelectedPolicyId}),{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentEnrollment.stepConfigureAgentTitle",{defaultMessage:"Configure the agent"}),children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.stepConfigureAgentDescription",defaultMessage:"Copy this policy to the {fileName} on the host where the Elastic Agent is installed. Modify {ESUsernameVariable} and {ESPasswordVariable} in the {outputSection} section of {fileName} to use your Elasticsearch credentials.",values:{fileName:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"elastic-agent.yml"),ESUsernameVariable:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"ES_USERNAME"),ESPasswordVariable:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"ES_PASSWORD"),outputSection:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"outputs")}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCopy"],{textToCopy:yaml},copy=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:copy,iconType:"copyClipboard"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.copyPolicyButton",defaultMessage:"Copy to clipboard"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"download",href:downloadLink,isDisabled:!downloadLink},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.downloadPolicyButton",defaultMessage:"Download policy"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{language:"yaml",style:{maxHeight:300},fontSize:"m"},yaml)))},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentEnrollment.stepRunAgentTitle",{defaultMessage:"Start the agent"}),children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.stepRunAgentDescription",defaultMessage:"From the agent directory, run this command to install, enroll and start an Elastic Agent. You can reuse this command to set up agents on more than one host. Requires administrator privileges."}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{fontSize:"m"},RUN_INSTRUCTIONS),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCopy"],{textToCopy:RUN_INSTRUCTIONS},copy=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:copy,iconType:"copyClipboard"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.copyRunInstructionsButton",defaultMessage:"Copy to clipboard"})))))},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentEnrollment.stepCheckForDataTitle",{defaultMessage:"Check for data"}),children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.stepCheckForDataDescription",defaultMessage:"The agent should begin sending data. Go to {link} to view your data.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:getHref("data_streams")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.goToDataStreamsLink",defaultMessage:"data streams"}))}})))}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.standaloneDescription",defaultMessage:"Run an Elastic Agent standalone to configure and update the agent manually on the host where the agent is installed."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSteps"],{steps:steps}))});function agent_enrollment_flyout_slicedToArray(arr,i){return agent_enrollment_flyout_arrayWithHoles(arr)||agent_enrollment_flyout_iterableToArrayLimit(arr,i)||agent_enrollment_flyout_unsupportedIterableToArray(arr,i)||agent_enrollment_flyout_nonIterableRest()}function agent_enrollment_flyout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function agent_enrollment_flyout_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return agent_enrollment_flyout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return agent_enrollment_flyout_arrayLikeToArray(o,minLen)}function agent_enrollment_flyout_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function agent_enrollment_flyout_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function agent_enrollment_flyout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AgentEnrollmentFlyout=({onClose:onClose,agentPolicies:agentPolicies})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])("managed"),_useState2=agent_enrollment_flyout_slicedToArray(_useState,2),mode=_useState2[0],setMode=_useState2[1];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyout"],{onClose:onClose,size:"l",maxWidth:880},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true,"aria-labelledby":"FleetAgentEnrollmentFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"FleetAgentEnrollmentFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.flyoutTitle",defaultMessage:"Add agent"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.agentDescription",defaultMessage:"Add Elastic Agents to your hosts to collect data and send it to the Elastic Stack."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{style:{marginBottom:"-25px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:mode==="managed",onClick:()=>setMode("managed")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.enrollFleetTabLabel",defaultMessage:"Enroll in Fleet"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:mode==="standalone",onClick:()=>setMode("standalone")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.enrollStandaloneTabLabel",defaultMessage:"Run standalone"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutBody"],null,mode==="managed"?external_kbnSharedDeps_React_default.a.createElement(ManagedInstructions,{agentPolicies:agentPolicies}):external_kbnSharedDeps_React_default.a.createElement(StandaloneInstructions,{agentPolicies:agentPolicies})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,onClick:onClose},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentEnrollment.continueButtonLabel",defaultMessage:"Continue"}))))))};const Status={Online:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"success"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.onlineStatusText",defaultMessage:"Online"})),Offline:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.offlineStatusText",defaultMessage:"Offline"})),Inactive:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.inactiveStatusText",defaultMessage:"Inactive"})),Warning:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.warningStatusText",defaultMessage:"Error"})),Error:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.errorStatusText",defaultMessage:"Error"})),Degraded:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.degradedStatusText",defaultMessage:"Degraded"})),Enrolling:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.enrollingStatusText",defaultMessage:"Enrolling"})),Unenrolling:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.unenrollingStatusText",defaultMessage:"Unenrolling"})),Upgrading:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.updatingStatusText",defaultMessage:"Updating"}))};function getStatusComponent(agent){switch(agent.status){case"error":return Status.Error;case"degraded":return Status.Degraded;case"inactive":return Status.Inactive;case"offline":return Status.Offline;case"warning":return Status.Warning;case"unenrolling":return Status.Unenrolling;case"enrolling":return Status.Enrolling;case"updating":return Status.Upgrading;default:return Status.Online}}const AgentHealth=({agent:agent})=>{const lastCheckIn=agent.last_checkin;const msLastCheckIn=new Date(lastCheckIn||0).getTime();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:msLastCheckIn?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.checkInTooltipText",defaultMessage:"Last checked in {lastCheckIn}",values:{lastCheckIn:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{value:msLastCheckIn})}}),agent.current_error_events.map((event,idx)=>external_kbnSharedDeps_React_default.a.createElement("p",{key:idx},event.message))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentHealth.noCheckInTooltipText",defaultMessage:"Never checked in"})},getStatusComponent(agent))};function agent_unenroll_modal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function agent_unenroll_modal_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){agent_unenroll_modal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){agent_unenroll_modal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function agent_unenroll_modal_slicedToArray(arr,i){return agent_unenroll_modal_arrayWithHoles(arr)||agent_unenroll_modal_iterableToArrayLimit(arr,i)||agent_unenroll_modal_unsupportedIterableToArray(arr,i)||agent_unenroll_modal_nonIterableRest()}function agent_unenroll_modal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function agent_unenroll_modal_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return agent_unenroll_modal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return agent_unenroll_modal_arrayLikeToArray(o,minLen)}function agent_unenroll_modal_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function agent_unenroll_modal_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function agent_unenroll_modal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AgentUnenrollAgentModal=({onClose:onClose,agents:agents,agentCount:agentCount,useForceUnenroll:useForceUnenroll})=>{const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useState=Object(external_kbnSharedDeps_React_["useState"])(useForceUnenroll||false),_useState2=agent_unenroll_modal_slicedToArray(_useState,2),forceUnenroll=_useState2[0],setForceUnenroll=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=agent_unenroll_modal_slicedToArray(_useState3,2),isSubmitting=_useState4[0],setIsSubmitting=_useState4[1];const isSingleAgent=Array.isArray(agents)&&agents.length===1;function onSubmit(){return _onSubmit.apply(this,arguments)}function _onSubmit(){_onSubmit=agent_unenroll_modal_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _ref,error,successMessage;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setIsSubmitting(true);if(!isSingleAgent){_context.next=8;break}_context.next=5;return Object(hooks["v"])(agents[0].id,{force:forceUnenroll});case 5:_context.t0=_context.sent;_context.next=11;break;case 8:_context.next=10;return Object(hooks["y"])({agents:Array.isArray(agents)?agents.map(agent=>agent.id):agents,force:forceUnenroll});case 10:_context.t0=_context.sent;case 11:_ref=_context.t0;error=_ref.error;if(!error){_context.next=15;break}throw error;case 15:setIsSubmitting(false);if(forceUnenroll){successMessage=isSingleAgent?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.unenrollAgents.successForceSingleNotificationTitle",{defaultMessage:"Agent unenrolled"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.unenrollAgents.successForceMultiNotificationTitle",{defaultMessage:"Agents unenrolled"});notifications.toasts.addSuccess(successMessage)}else{successMessage=isSingleAgent?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.unenrollAgents.successSingleNotificationTitle",{defaultMessage:"Unenrolling agent"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.unenrollAgents.successMultiNotificationTitle",{defaultMessage:"Unenrolling agents"});notifications.toasts.addSuccess(successMessage)}onClose();_context.next=24;break;case 20:_context.prev=20;_context.t1=_context["catch"](0);setIsSubmitting(false);notifications.toasts.addError(_context.t1,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.unenrollAgents.fatalErrorNotificationTitle",{defaultMessage:"Error unenrolling {count, plural, one {agent} other {agents}}",values:{count:agentCount}})});case 24:case"end":return _context.stop()}}),_callee,null,[[0,20]])})));return _onSubmit.apply(this,arguments)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.unenrollAgents.deleteSingleTitle",defaultMessage:"Unenroll agent"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.unenrollAgents.forceDeleteMultipleTitle",defaultMessage:"Unenroll {count} agents",values:{count:agentCount}}),onCancel:onClose,onConfirm:onSubmit,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.unenrollAgents.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonDisabled:isSubmitting,confirmButtonText:isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.unenrollAgents.confirmSingleButtonLabel",defaultMessage:"Unenroll agent"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.unenrollAgents.confirmMultipleButtonLabel",defaultMessage:"Unenroll {count} agents",values:{count:agentCount}}),buttonColor:"danger"},external_kbnSharedDeps_React_default.a.createElement("p",null,isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.unenrollAgents.deleteSingleDescription",defaultMessage:'This action will remove the selected agent running on "{hostName}" from Fleet. Any data that was already sent by the agent will not be deleted. This action cannot be undone.',values:{hostName:agents[0].local_metadata.host.hostname}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.unenrollAgents.deleteMultipleDescription",defaultMessage:"This action will remove multiple agents from Fleet and prevent new data from being ingested. Any data that was already sent by these agents will not be affected. This action cannot be undone."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormFieldset"],{legend:{children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.unenrollAgents.forceUnenrollLegendText",defaultMessage:"Force unenroll {count, plural, one {agent} other {agents}}",values:{count:agentCount}})}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{id:"fleetForceUnenrollAgents",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.unenrollAgents.forceUnenrollCheckboxLabel",defaultMessage:"Remove {count, plural, one {agent} other {agents}} immediately. Do not wait for agent to send any last data.",values:{count:agentCount}}),checked:forceUnenroll,onChange:e=>setForceUnenroll(e.target.checked),disabled:useForceUnenroll}))))};function agent_upgrade_modal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function agent_upgrade_modal_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){agent_upgrade_modal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){agent_upgrade_modal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function agent_upgrade_modal_slicedToArray(arr,i){return agent_upgrade_modal_arrayWithHoles(arr)||agent_upgrade_modal_iterableToArrayLimit(arr,i)||agent_upgrade_modal_unsupportedIterableToArray(arr,i)||agent_upgrade_modal_nonIterableRest()}function agent_upgrade_modal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function agent_upgrade_modal_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return agent_upgrade_modal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return agent_upgrade_modal_arrayLikeToArray(o,minLen)}function agent_upgrade_modal_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function agent_upgrade_modal_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function agent_upgrade_modal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AgentUpgradeAgentModal=({onClose:onClose,agents:agents,agentCount:agentCount,version:version})=>{const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=agent_upgrade_modal_slicedToArray(_useState,2),isSubmitting=_useState2[0],setIsSubmitting=_useState2[1];const isSingleAgent=Array.isArray(agents)&&agents.length===1;function onSubmit(){return _onSubmit.apply(this,arguments)}function _onSubmit(){_onSubmit=agent_upgrade_modal_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _ref,error,successMessage;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setIsSubmitting(true);if(!isSingleAgent){_context.next=8;break}_context.next=5;return Object(hooks["w"])(agents[0].id,{version:version});case 5:_context.t0=_context.sent;_context.next=11;break;case 8:_context.next=10;return Object(hooks["z"])({agents:Array.isArray(agents)?agents.map(agent=>agent.id):agents,version:version});case 10:_context.t0=_context.sent;case 11:_ref=_context.t0;error=_ref.error;if(!error){_context.next=15;break}throw error;case 15:setIsSubmitting(false);successMessage=isSingleAgent?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.upgradeAgents.successSingleNotificationTitle",{defaultMessage:"Upgrading agent"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.upgradeAgents.successMultiNotificationTitle",{defaultMessage:"Upgrading agents"});notifications.toasts.addSuccess(successMessage);onClose();_context.next=25;break;case 21:_context.prev=21;_context.t1=_context["catch"](0);setIsSubmitting(false);notifications.toasts.addError(_context.t1,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.upgradeAgents.fatalErrorNotificationTitle",{defaultMessage:"Error upgrading {count, plural, one {agent} other {agents}}",values:{count:agentCount}})});case 25:case"end":return _context.stop()}}),_callee,null,[[0,21]])})));return _onSubmit.apply(this,arguments)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.upgradeAgents.deleteSingleTitle",defaultMessage:"Upgrade agent?"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.upgradeAgents.deleteMultipleTitle",defaultMessage:"Upgrade {count} agents?",values:{count:agentCount}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBetaBadge"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.upgradeAgents.experimentalLabel",defaultMessage:"Experimental"}),tooltipContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.upgradeAgents.experimentalLabelTooltip",defaultMessage:"Upgrade agent might change or be removed in a future release and is not subject to the support SLA."})}))),onCancel:onClose,onConfirm:onSubmit,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.upgradeAgents.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonDisabled:isSubmitting,confirmButtonText:isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.upgradeAgents.confirmSingleButtonLabel",defaultMessage:"Upgrade agent"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.upgradeAgents.confirmMultipleButtonLabel",defaultMessage:"Upgrade {count} agents",values:{count:agentCount}})},external_kbnSharedDeps_React_default.a.createElement("p",null,isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.upgradeAgents.upgradeSingleDescription",defaultMessage:"This action upgrades the agent running on '{hostName}' to version {version}. You can't undo this upgrade.",values:{hostName:agents[0].local_metadata.host.hostname,version:version}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.upgradeAgents.upgradeMultipleDescription",defaultMessage:"This action upgrades multiple agents to version {version}. You can't undo this upgrade.",values:{version:version}}))))};const StyledPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).attrs(props=>({paddingSize:"m"})).withConfig({displayName:"StyledPanel",componentId:"sc-1s2ob2x-0"})(["header{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid ",";margin:-"," -"," ",";padding:"," ",";}h2{padding:"," 0;}"],props=>props.theme.eui.euiColorLightShade,props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.paddingSizes.s,props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.paddingSizes.xs);const OverviewPanel=({title:title,tooltip:tooltip,linkToText:linkToText,linkTo:linkTo,children:children})=>external_kbnSharedDeps_React_default.a.createElement(StyledPanel,null,external_kbnSharedDeps_React_default.a.createElement("header",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h2",null,title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{content:tooltip,position:"top",type:"iInCircle",color:"subdued"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",flush:"right",href:linkTo},linkToText)),children);const OverviewStats=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"]).attrs(props=>({compressed:true,textStyle:"reverse",type:"column"})).withConfig({displayName:"OverviewStats",componentId:"pe4hxx-0"})(["& > *{margin-top:"," !important;&:first-child,&:nth-child(2){margin-top:0 !important;}}"],props=>props.theme.eui.paddingSizes.s);const OverviewAgentSection=()=>{var _agentStatusRequest$d,_agentStatusRequest$d2,_agentStatusRequest$d3,_agentStatusRequest$d4,_agentStatusRequest$d5,_agentStatusRequest$d6,_agentStatusRequest$d7,_agentStatusRequest$d8,_agentStatusRequest$d9,_agentStatusRequest$d10,_agentStatusRequest$d11,_agentStatusRequest$d12;const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const agentStatusRequest=Object(hooks["P"])({});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{component:"section"},external_kbnSharedDeps_React_default.a.createElement(OverviewPanel,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPageAgentsPanelTitle",{defaultMessage:"Agents"}),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPageFleetPanelTooltip",{defaultMessage:"Use Fleet to enroll agents and manage their policies from a central location."}),linkTo:getHref("fleet_agent_list"),linkToText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPageFleetPanelAction",{defaultMessage:"View agents"})},external_kbnSharedDeps_React_default.a.createElement(OverviewStats,null,agentStatusRequest.isLoading?external_kbnSharedDeps_React_default.a.createElement(loading_Loading,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewAgentTotalTitle",defaultMessage:"Total agents"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:(_agentStatusRequest$d=(_agentStatusRequest$d2=agentStatusRequest.data)===null||_agentStatusRequest$d2===void 0?void 0:(_agentStatusRequest$d3=_agentStatusRequest$d2.results)===null||_agentStatusRequest$d3===void 0?void 0:_agentStatusRequest$d3.total)!==null&&_agentStatusRequest$d!==void 0?_agentStatusRequest$d:0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewAgentActiveTitle",defaultMessage:"Active"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:(_agentStatusRequest$d4=(_agentStatusRequest$d5=agentStatusRequest.data)===null||_agentStatusRequest$d5===void 0?void 0:(_agentStatusRequest$d6=_agentStatusRequest$d5.results)===null||_agentStatusRequest$d6===void 0?void 0:_agentStatusRequest$d6.online)!==null&&_agentStatusRequest$d4!==void 0?_agentStatusRequest$d4:0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewAgentOfflineTitle",defaultMessage:"Offline"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:(_agentStatusRequest$d7=(_agentStatusRequest$d8=agentStatusRequest.data)===null||_agentStatusRequest$d8===void 0?void 0:(_agentStatusRequest$d9=_agentStatusRequest$d8.results)===null||_agentStatusRequest$d9===void 0?void 0:_agentStatusRequest$d9.offline)!==null&&_agentStatusRequest$d7!==void 0?_agentStatusRequest$d7:0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewAgentErrorTitle",defaultMessage:"Error"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:(_agentStatusRequest$d10=(_agentStatusRequest$d11=agentStatusRequest.data)===null||_agentStatusRequest$d11===void 0?void 0:(_agentStatusRequest$d12=_agentStatusRequest$d11.results)===null||_agentStatusRequest$d12===void 0?void 0:_agentStatusRequest$d12.error)!==null&&_agentStatusRequest$d10!==void 0?_agentStatusRequest$d10:0}))))))};const OverviewPolicySection=({agentPolicies:agentPolicies})=>{var _packagePoliciesReque,_packagePoliciesReque2;const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const packagePoliciesRequest=Object(hooks["ab"])({page:1,perPage:constants["j"]});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{component:"section"},external_kbnSharedDeps_React_default.a.createElement(OverviewPanel,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPagePoliciesPanelTitle",{defaultMessage:"Agent policies"}),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPagePoliciesPanelTooltip",{defaultMessage:"Use agent policies to control the data that your agents collect."}),linkTo:getHref("policies_list"),linkToText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPagePoliciesPanelAction",{defaultMessage:"View policies"})},external_kbnSharedDeps_React_default.a.createElement(OverviewStats,null,packagePoliciesRequest.isLoading?external_kbnSharedDeps_React_default.a.createElement(loading_Loading,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewPolicyTotalTitle",defaultMessage:"Total available"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:agentPolicies.length})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewPackagePolicyTitle",defaultMessage:"Used integrations"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:(_packagePoliciesReque=(_packagePoliciesReque2=packagePoliciesRequest.data)===null||_packagePoliciesReque2===void 0?void 0:_packagePoliciesReque2.total)!==null&&_packagePoliciesReque!==void 0?_packagePoliciesReque:0}))))))};var common_constants=__webpack_require__(0);const OverviewIntegrationSection=()=>{var _packagesRequest$data,_res$length,_res$filter$length,_res$filter,_res$filter$length2,_res$filter2;const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const packagesRequest=Object(hooks["bb"])();const res=(_packagesRequest$data=packagesRequest.data)===null||_packagesRequest$data===void 0?void 0:_packagesRequest$data.response;const total=(_res$length=res===null||res===void 0?void 0:res.length)!==null&&_res$length!==void 0?_res$length:0;const installed=(_res$filter$length=res===null||res===void 0?void 0:(_res$filter=res.filter(p=>p.status===common_constants["ab"].Installed))===null||_res$filter===void 0?void 0:_res$filter.length)!==null&&_res$filter$length!==void 0?_res$filter$length:0;const updatablePackages=(_res$filter$length2=res===null||res===void 0?void 0:(_res$filter2=res.filter(item=>"savedObject"in item&&item.version>item.savedObject.attributes.version))===null||_res$filter2===void 0?void 0:_res$filter2.length)!==null&&_res$filter$length2!==void 0?_res$filter$length2:0;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{component:"section"},external_kbnSharedDeps_React_default.a.createElement(OverviewPanel,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPageIntegrationsPanelTitle",{defaultMessage:"Integrations"}),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPageIntegrationsPanelTooltip",{defaultMessage:"Browse and install integrations for the Elastic Stack. Add integrations to your agent policies to start sending data."}),linkTo:getHref("integrations_all"),linkToText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPageIntegrationsPanelAction",{defaultMessage:"View integrations"})},external_kbnSharedDeps_React_default.a.createElement(OverviewStats,null,packagesRequest.isLoading?external_kbnSharedDeps_React_default.a.createElement(loading_Loading,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewIntegrationsTotalTitle",defaultMessage:"Total available"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:total})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewIntegrationsInstalledTitle",defaultMessage:"Installed"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:installed})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewIntegrationsUpdatesAvailableTitle",defaultMessage:"Updates available"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:updatablePackages}))))))};const OverviewDatastreamSection=()=>{var _datastreamRequest$da,_datastreamRequest$da2,_datastreamRequest$da3;const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const datastreamRequest=Object(hooks["S"])();const _useStartServices=Object(hooks["mb"])(),fieldFormats=_useStartServices.data.fieldFormats;const total=(_datastreamRequest$da=(_datastreamRequest$da2=datastreamRequest.data)===null||_datastreamRequest$da2===void 0?void 0:(_datastreamRequest$da3=_datastreamRequest$da2.data_streams)===null||_datastreamRequest$da3===void 0?void 0:_datastreamRequest$da3.length)!==null&&_datastreamRequest$da!==void 0?_datastreamRequest$da:0;let sizeBytes=0;const namespaces=new Set;if(datastreamRequest.data){datastreamRequest.data.data_streams.forEach(val=>{namespaces.add(val.namespace);sizeBytes+=val.size_in_bytes})}let size;try{const formatter=fieldFormats.getInstance("bytes");size=formatter.convert(sizeBytes)}catch(e){size="".concat(sizeBytes,"b")}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{component:"section"},external_kbnSharedDeps_React_default.a.createElement(OverviewPanel,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPageDataStreamsPanelTitle",{defaultMessage:"Data streams"}),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPageDataStreamsPanelTooltip",{defaultMessage:"Data that your agents collect are organized into various data streams."}),linkTo:getHref("data_streams"),linkToText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.overviewPageDataStreamsPanelAction",{defaultMessage:"View data streams"})},external_kbnSharedDeps_React_default.a.createElement(OverviewStats,null,datastreamRequest.isLoading?external_kbnSharedDeps_React_default.a.createElement(loading_Loading,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewDatastreamTotalTitle",defaultMessage:"Data streams"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:total})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewDatastreamNamespacesTitle",defaultMessage:"Namespaces"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:namespaces.size})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewDatastreamSizeTitle",defaultMessage:"Total size"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,size)))))};function overview_slicedToArray(arr,i){return overview_arrayWithHoles(arr)||overview_iterableToArrayLimit(arr,i)||overview_unsupportedIterableToArray(arr,i)||overview_nonIterableRest()}function overview_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function overview_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return overview_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return overview_arrayLikeToArray(o,minLen)}function overview_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function overview_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function overview_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const IngestManagerOverview=()=>{Object(hooks["I"])("overview");const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=overview_slicedToArray(_useState,2),isEnrollmentFlyoutOpen=_useState2[0],setIsEnrollmentFlyoutOpen=_useState2[1];const agentPoliciesRequest=Object(hooks["O"])({page:1,perPage:1e3});const agentPolicies=agentPoliciesRequest.data?agentPoliciesRequest.data.items:[];return external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"l"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewPageTitle",defaultMessage:"Fleet"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBetaBadge"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.betaBadge.labelText",{defaultMessage:"Beta"}),tooltipContent:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.betaBadge.tooltipText",{defaultMessage:"This plugin is not recommended for production environments. Please report bugs in our Discuss forum."})})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewPageSubtitle",defaultMessage:"Manage Elastic Agents and their policies in a central location."}))))),rightColumn:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,iconType:"plusInCircle",onClick:()=>setIsEnrollmentFlyoutOpen(true)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.overviewPageEnrollAgentButton",defaultMessage:"Add agent"}))))},isEnrollmentFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(AgentEnrollmentFlyout,{agentPolicies:agentPolicies,onClose:()=>setIsEnrollmentFlyoutOpen(false)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGrid"],{gutterSize:"l",columns:2},external_kbnSharedDeps_React_default.a.createElement(OverviewIntegrationSection,null),external_kbnSharedDeps_React_default.a.createElement(OverviewPolicySection,{agentPolicies:agentPolicies}),external_kbnSharedDeps_React_default.a.createElement(OverviewAgentSection,null),external_kbnSharedDeps_React_default.a.createElement(OverviewDatastreamSection,null)))};function agent_policy_delete_provider_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function agent_policy_delete_provider_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){agent_policy_delete_provider_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){agent_policy_delete_provider_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function agent_policy_delete_provider_slicedToArray(arr,i){return agent_policy_delete_provider_arrayWithHoles(arr)||agent_policy_delete_provider_iterableToArrayLimit(arr,i)||agent_policy_delete_provider_unsupportedIterableToArray(arr,i)||agent_policy_delete_provider_nonIterableRest()}function agent_policy_delete_provider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function agent_policy_delete_provider_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return agent_policy_delete_provider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return agent_policy_delete_provider_arrayLikeToArray(o,minLen)}function agent_policy_delete_provider_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function agent_policy_delete_provider_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function agent_policy_delete_provider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AgentPolicyDeleteProvider=({children:children})=>{const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useConfig=Object(hooks["L"])(),isFleetEnabled=_useConfig.agents.enabled;const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=agent_policy_delete_provider_slicedToArray(_useState,2),agentPolicy=_useState2[0],setAgentPolicy=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=agent_policy_delete_provider_slicedToArray(_useState3,2),isModalOpen=_useState4[0],setIsModalOpen=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=agent_policy_delete_provider_slicedToArray(_useState5,2),isLoadingAgentsCount=_useState6[0],setIsLoadingAgentsCount=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(0),_useState8=agent_policy_delete_provider_slicedToArray(_useState7,2),agentsCount=_useState8[0],setAgentsCount=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])(false),_useState10=agent_policy_delete_provider_slicedToArray(_useState9,2),isLoading=_useState10[0],setIsLoading=_useState10[1];const onSuccessCallback=Object(external_kbnSharedDeps_React_["useRef"])(null);const deleteAgentPolicyPrompt=(agentPolicyToDelete,onSuccess=(()=>undefined))=>{if(!agentPolicyToDelete){throw new Error("No agent policy specified for deletion")}setIsModalOpen(true);setAgentPolicy(agentPolicyToDelete);fetchAgentsCount(agentPolicyToDelete);onSuccessCallback.current=onSuccess};const closeModal=()=>{setAgentPolicy(undefined);setIsLoading(false);setIsLoadingAgentsCount(false);setIsModalOpen(false)};const deleteAgentPolicy=function(){var _ref=agent_policy_delete_provider_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$sendDeleteAgen,data;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.prev=1;_context.next=4;return Object(hooks["h"])({agentPolicyId:agentPolicy});case 4:_yield$sendDeleteAgen=_context.sent;data=_yield$sendDeleteAgen.data;if(data){notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.deleteAgentPolicy.successSingleNotificationTitle",{defaultMessage:"Deleted agent policy '{id}'",values:{id:data.name||data.id}}));if(onSuccessCallback.current){onSuccessCallback.current(agentPolicy)}}else{notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.deleteAgentPolicy.failureSingleNotificationTitle",{defaultMessage:"Error deleting agent policy '{id}'",values:{id:agentPolicy}}))}_context.next=12;break;case 9:_context.prev=9;_context.t0=_context["catch"](1);notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.deleteAgentPolicy.fatalErrorNotificationTitle",{defaultMessage:"Error deleting agent policy"}));case 12:closeModal();case 13:case"end":return _context.stop()}}),_callee,null,[[1,9]])})));return function deleteAgentPolicy(){return _ref.apply(this,arguments)}}();const fetchAgentsCount=function(){var _ref2=agent_policy_delete_provider_asyncToGenerator(regeneratorRuntime.mark((function _callee2(agentPolicyToCheck){var _yield$sendRequest,data;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!(!isFleetEnabled||isLoadingAgentsCount)){_context2.next=2;break}return _context2.abrupt("return");case 2:setIsLoadingAgentsCount(true);_context2.next=5;return Object(hooks["E"])({path:"/api/fleet/agents",method:"get",query:{kuery:"".concat(constants["c"],".policy_id : ").concat(agentPolicyToCheck)}});case 5:_yield$sendRequest=_context2.sent;data=_yield$sendRequest.data;setAgentsCount((data===null||data===void 0?void 0:data.total)||0);setIsLoadingAgentsCount(false);case 9:case"end":return _context2.stop()}}),_callee2)})));return function fetchAgentsCount(_x){return _ref2.apply(this,arguments)}}();const renderModal=()=>{if(!isModalOpen){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deleteAgentPolicy.confirmModal.deletePolicyTitle",defaultMessage:"Delete this agent policy?"}),onCancel:closeModal,onConfirm:deleteAgentPolicy,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deleteAgentPolicy.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:isLoading||isLoadingAgentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deleteAgentPolicy.confirmModal.loadingButtonLabel",defaultMessage:"Loading…"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deleteAgentPolicy.confirmModal.confirmButtonLabel",defaultMessage:"Delete policy"}),buttonColor:"danger",confirmButtonDisabled:isLoading||isLoadingAgentsCount||!!agentsCount},isLoadingAgentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deleteAgentPolicy.confirmModal.loadingAgentsCountMessage",defaultMessage:"Checking amount of affected agents…"}):agentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.deleteAgentPolicy.confirmModal.affectedAgentsTitle",{defaultMessage:"Policy in use"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deleteAgentPolicy.confirmModal.affectedAgentsMessage",defaultMessage:"{agentsCount, plural, one {# agent is} other {# agents are}} assigned to this agent policy. Unassign these agents before deleting this policy.",values:{agentsCount:agentsCount}})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deleteAgentPolicy.confirmModal.irreversibleMessage",defaultMessage:"This action cannot be undone."})))};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,children(deleteAgentPolicyPrompt),renderModal())};function agent_policy_form_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function agent_policy_form_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){agent_policy_form_ownKeys(Object(source),true).forEach((function(key){agent_policy_form_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{agent_policy_form_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function agent_policy_form_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function agent_policy_form_slicedToArray(arr,i){return agent_policy_form_arrayWithHoles(arr)||agent_policy_form_iterableToArrayLimit(arr,i)||agent_policy_form_unsupportedIterableToArray(arr,i)||agent_policy_form_nonIterableRest()}function agent_policy_form_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function agent_policy_form_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return agent_policy_form_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return agent_policy_form_arrayLikeToArray(o,minLen)}function agent_policy_form_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function agent_policy_form_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function agent_policy_form_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const StyledEuiAccordion=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiAccordion"]).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-1njiai8-0"})([".ingest-active-button{color:",";}"],props=>props.theme.eui.euiColorPrimary);const agentPolicyFormValidation=agentPolicy=>{var _agentPolicy$name;const errors={};const namespaceValidation=Object(services["n"])(agentPolicy.namespace||"");if(!((_agentPolicy$name=agentPolicy.name)===null||_agentPolicy$name===void 0?void 0:_agentPolicy$name.trim())){errors.name=[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.nameRequiredErrorMessage",defaultMessage:"Agent policy name is required"})]}if(!namespaceValidation.valid&&namespaceValidation.error){errors.namespace=[namespaceValidation.error]}return errors};const AgentPolicyForm=({agentPolicy:agentPolicy,updateAgentPolicy:updateAgentPolicy,withSysMonitoring:withSysMonitoring,updateSysMonitoring:updateSysMonitoring,validation:validation,isEditing:isEditing=false,onDelete:onDelete=(()=>{})})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])({}),_useState2=agent_policy_form_slicedToArray(_useState,2),touchedFields=_useState2[0],setTouchedFields=_useState2[1];const fields=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{name:"name",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.nameFieldLabel",defaultMessage:"Name"}),placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyForm.nameFieldPlaceholder",{defaultMessage:"Choose a name"})},{name:"description",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.descriptionFieldLabel",defaultMessage:"Description"}),placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyForm.descriptionFieldPlaceholder",{defaultMessage:"How will this policy be used?"})}],[]);const generalSettingsWrapper=children=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyForm.generalSettingsGroupTitle",defaultMessage:"General settings"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyForm.generalSettingsGroupDescription",defaultMessage:"Choose a name and description for your agent policy."})},children);const generalFields=fields.map(({name:name,label:label,placeholder:placeholder})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,key:name,label:label,error:touchedFields[name]&&validation[name]?validation[name]:null,isInvalid:Boolean(touchedFields[name]&&validation[name])},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,value:agentPolicy[name],onChange:e=>updateAgentPolicy({[name]:e.target.value}),isInvalid:Boolean(touchedFields[name]&&validation[name]),onBlur:()=>setTouchedFields(agent_policy_form_objectSpread(agent_policy_form_objectSpread({},touchedFields),{},{[name]:true})),placeholder:placeholder})));const advancedOptionsContent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.namespaceFieldLabel",defaultMessage:"Default namespace"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.namespaceFieldDescription",defaultMessage:"Apply a default namespace to integrations that use this policy. Integrations can specify their own namespaces."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,error:touchedFields.namespace&&validation.namespace?validation.namespace:null,isInvalid:Boolean(touchedFields.namespace&&validation.namespace)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{fullWidth:true,singleSelection:true,noSuggestions:true,selectedOptions:agentPolicy.namespace?[{label:agentPolicy.namespace}]:[],onCreateOption:value=>{updateAgentPolicy({namespace:value})},onChange:selectedOptions=>{updateAgentPolicy({namespace:selectedOptions.length?selectedOptions[0]:""})},isInvalid:Boolean(touchedFields.namespace&&validation.namespace),onBlur:()=>setTouchedFields(agent_policy_form_objectSpread(agent_policy_form_objectSpread({},touchedFields),{},{namespace:true}))}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.monitoringLabel",defaultMessage:"Agent monitoring"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.monitoringDescription",defaultMessage:"Collect data about your agents for debugging and tracking performance."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckboxGroup"],{options:[{id:common["dataTypes"].Logs,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.monitoringLogsFieldLabel",defaultMessage:"Collect agent logs"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyForm.monitoringLogsTooltipText",{defaultMessage:"Collect logs from Elastic Agents that use this policy."}),position:"right",type:"iInCircle",color:"subdued"}))},{id:common["dataTypes"].Metrics,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.monitoringMetricsFieldLabel",defaultMessage:"Collect agent metrics"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyForm.monitoringMetricsTooltipText",{defaultMessage:"Collect metrics from Elastic Agents that use this policy."}),position:"right",type:"iInCircle",color:"subdued"}))}],idToSelectedMap:(agentPolicy.monitoring_enabled||[]).reduce((acc,key)=>{acc[key]=true;return acc},{logs:false,metrics:false}),onChange:id=>{if(id!==common["dataTypes"].Logs&&id!==common["dataTypes"].Metrics){return}const hasLogs=agentPolicy.monitoring_enabled&&agentPolicy.monitoring_enabled.indexOf(id)>=0;const previousValues=agentPolicy.monitoring_enabled||[];updateAgentPolicy({monitoring_enabled:hasLogs?previousValues.filter(type=>type!==id):[...previousValues,id]})}})),isEditing&&"id"in agentPolicy?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyForm.deletePolicyGroupTitle",defaultMessage:"Delete policy"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyForm.deletePolicyGroupDescription",defaultMessage:"Existing data will not be deleted."}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(AgentPolicyDeleteProvider,null,deleteAgentPolicyPrompt=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"danger",disabled:Boolean(agentPolicy.is_default),onClick:()=>deleteAgentPolicyPrompt(agentPolicy.id,onDelete)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyForm.deletePolicyActionText",defaultMessage:"Delete policy"}))),agentPolicy.is_default?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyForm.unableToDeleteDefaultPolicyText",defaultMessage:"Default policy cannot be deleted"}))):null)}):null);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,!isEditing?generalFields:generalSettingsWrapper(generalFields),!isEditing?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.systemMonitoringFieldLabel",defaultMessage:"System monitoring"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{id:"agentPolicyFormSystemMonitoringCheckbox",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.systemMonitoringText",defaultMessage:"Collect system metrics"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyForm.systemMonitoringTooltipText",{defaultMessage:"Enable this option to bootstrap your policy with an integration that collects system metrics and information."}),position:"right",type:"iInCircle",color:"subdued"})),checked:withSysMonitoring,onChange:()=>{updateSysMonitoring(!withSysMonitoring)}})):null,!isEditing?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(StyledEuiAccordion,{id:"advancedOptions",buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyForm.advancedOptionsToggleLabel",defaultMessage:"Advanced options"}),buttonClassName:"ingest-active-button"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),advancedOptionsContent)):advancedOptionsContent)};function agent_policy_copy_provider_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function agent_policy_copy_provider_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){agent_policy_copy_provider_ownKeys(Object(source),true).forEach((function(key){agent_policy_copy_provider_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{agent_policy_copy_provider_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function agent_policy_copy_provider_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function agent_policy_copy_provider_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function agent_policy_copy_provider_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){agent_policy_copy_provider_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){agent_policy_copy_provider_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function agent_policy_copy_provider_slicedToArray(arr,i){return agent_policy_copy_provider_arrayWithHoles(arr)||agent_policy_copy_provider_iterableToArrayLimit(arr,i)||agent_policy_copy_provider_unsupportedIterableToArray(arr,i)||agent_policy_copy_provider_nonIterableRest()}function agent_policy_copy_provider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function agent_policy_copy_provider_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return agent_policy_copy_provider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return agent_policy_copy_provider_arrayLikeToArray(o,minLen)}function agent_policy_copy_provider_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function agent_policy_copy_provider_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function agent_policy_copy_provider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AgentPolicyCopyProvider=({children:children})=>{const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=agent_policy_copy_provider_slicedToArray(_useState,2),agentPolicy=_useState2[0],setAgentPolicy=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=agent_policy_copy_provider_slicedToArray(_useState3,2),newAgentPolicy=_useState4[0],setNewAgentPolicy=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=agent_policy_copy_provider_slicedToArray(_useState5,2),isModalOpen=_useState6[0],setIsModalOpen=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=agent_policy_copy_provider_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];const onSuccessCallback=Object(external_kbnSharedDeps_React_["useRef"])(null);const copyAgentPolicyPrompt=(agentPolicyToCopy,onSuccess=(()=>undefined))=>{if(!agentPolicyToCopy){throw new Error("No agent policy specified to copy")}setIsModalOpen(true);setAgentPolicy(agentPolicyToCopy);setNewAgentPolicy({name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.copyAgentPolicy.confirmModal.defaultNewPolicyName",{defaultMessage:"{name} (copy)",values:{name:agentPolicyToCopy.name}}),description:agentPolicyToCopy.description});onSuccessCallback.current=onSuccess};const closeModal=()=>{setAgentPolicy(undefined);setNewAgentPolicy(undefined);setIsLoading(false);setIsModalOpen(false)};const copyAgentPolicy=function(){var _ref=agent_policy_copy_provider_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$sendCopyAgentP,data;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.prev=1;_context.next=4;return Object(hooks["e"])(agentPolicy.id,newAgentPolicy);case 4:_yield$sendCopyAgentP=_context.sent;data=_yield$sendCopyAgentP.data;if(data){notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.copyAgentPolicy.successNotificationTitle",{defaultMessage:"Agent policy copied"}));if(onSuccessCallback.current){onSuccessCallback.current(data.item)}}else{notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.copyAgentPolicy.failureNotificationTitle",{defaultMessage:"Error copying agent policy '{id}'",values:{id:agentPolicy.id}}))}_context.next=12;break;case 9:_context.prev=9;_context.t0=_context["catch"](1);notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.copyAgentPolicy.fatalErrorNotificationTitle",{defaultMessage:"Error copying agent policy"}));case 12:closeModal();case 13:case"end":return _context.stop()}}),_callee,null,[[1,9]])})));return function copyAgentPolicy(){return _ref.apply(this,arguments)}}();const renderModal=()=>{if(!isModalOpen||!agentPolicy||!newAgentPolicy){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textBreakWord"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.copyAgentPolicy.confirmModal.copyPolicyTitle",defaultMessage:"Copy '{name}' agent policy",values:{name:agentPolicy.name}})),onCancel:closeModal,onConfirm:copyAgentPolicy,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.copyAgentPolicy.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.copyAgentPolicy.confirmModal.confirmButtonLabel",defaultMessage:"Copy policy"}),confirmButtonDisabled:isLoading||!newAgentPolicy.name.trim()},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.copyAgentPolicy.confirmModal.copyPolicyPrompt",defaultMessage:"Choose a name and description for your new agent policy."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.copyAgentPolicy.confirmModal.newNameLabel",defaultMessage:"New policy name"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,value:newAgentPolicy.name,onChange:e=>setNewAgentPolicy(agent_policy_copy_provider_objectSpread(agent_policy_copy_provider_objectSpread({},newAgentPolicy),{},{name:e.target.value}))})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.copyAgentPolicy.confirmModal.newDescriptionLabel",defaultMessage:"Description"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,value:newAgentPolicy.description,onChange:e=>setNewAgentPolicy(agent_policy_copy_provider_objectSpread(agent_policy_copy_provider_objectSpread({},newAgentPolicy),{},{description:e.target.value}))}))))};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,children(copyAgentPolicyPrompt),renderModal())};function package_policy_delete_provider_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function package_policy_delete_provider_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){package_policy_delete_provider_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){package_policy_delete_provider_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function package_policy_delete_provider_slicedToArray(arr,i){return package_policy_delete_provider_arrayWithHoles(arr)||package_policy_delete_provider_iterableToArrayLimit(arr,i)||package_policy_delete_provider_unsupportedIterableToArray(arr,i)||package_policy_delete_provider_nonIterableRest()}function package_policy_delete_provider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function package_policy_delete_provider_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return package_policy_delete_provider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return package_policy_delete_provider_arrayLikeToArray(o,minLen)}function package_policy_delete_provider_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function package_policy_delete_provider_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function package_policy_delete_provider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const PackagePolicyDeleteProvider=({agentPolicy:agentPolicy,children:children})=>{const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useConfig=Object(hooks["L"])(),isFleetEnabled=_useConfig.agents.enabled;const _useState=Object(external_kbnSharedDeps_React_["useState"])([]),_useState2=package_policy_delete_provider_slicedToArray(_useState,2),packagePolicies=_useState2[0],setPackagePolicies=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=package_policy_delete_provider_slicedToArray(_useState3,2),isModalOpen=_useState4[0],setIsModalOpen=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=package_policy_delete_provider_slicedToArray(_useState5,2),isLoadingAgentsCount=_useState6[0],setIsLoadingAgentsCount=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(0),_useState8=package_policy_delete_provider_slicedToArray(_useState7,2),agentsCount=_useState8[0],setAgentsCount=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])(false),_useState10=package_policy_delete_provider_slicedToArray(_useState9,2),isLoading=_useState10[0],setIsLoading=_useState10[1];const onSuccessCallback=Object(external_kbnSharedDeps_React_["useRef"])(null);const fetchAgentsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>package_policy_delete_provider_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$sendRequest,data;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(isLoadingAgentsCount||!isFleetEnabled)){_context.next=2;break}return _context.abrupt("return");case 2:setIsLoadingAgentsCount(true);_context.next=5;return Object(hooks["E"])({path:constants["a"].LIST_PATTERN,method:"get",query:{page:1,perPage:1,kuery:"".concat(constants["c"],".policy_id : ").concat(agentPolicy.id)}});case 5:_yield$sendRequest=_context.sent;data=_yield$sendRequest.data;setAgentsCount((data===null||data===void 0?void 0:data.total)||0);setIsLoadingAgentsCount(false);case 9:case"end":return _context.stop()}}),_callee)}))),[agentPolicy.id,isFleetEnabled,isLoadingAgentsCount]);const deletePackagePoliciesPrompt=Object(external_kbnSharedDeps_React_["useMemo"])(()=>(packagePoliciesToDelete,onSuccess=(()=>undefined))=>{if(!Array.isArray(packagePoliciesToDelete)||packagePoliciesToDelete.length===0){throw new Error("No package policies specified for deletion")}setIsModalOpen(true);setPackagePolicies(packagePoliciesToDelete);fetchAgentsCount();onSuccessCallback.current=onSuccess},[fetchAgentsCount]);const closeModal=Object(external_kbnSharedDeps_React_["useMemo"])(()=>()=>{setPackagePolicies([]);setIsLoading(false);setIsLoadingAgentsCount(false);setIsModalOpen(false)},[]);const deletePackagePolicies=Object(external_kbnSharedDeps_React_["useMemo"])(()=>package_policy_delete_provider_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _yield$sendDeletePack,data,successfulResults,failedResults,hasMultipleSuccesses,successMessage,hasMultipleFailures,failureMessage;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setIsLoading(true);_context2.prev=1;_context2.next=4;return Object(hooks["j"])({packagePolicyIds:packagePolicies});case 4:_yield$sendDeletePack=_context2.sent;data=_yield$sendDeletePack.data;successfulResults=(data===null||data===void 0?void 0:data.filter(result=>result.success))||[];failedResults=(data===null||data===void 0?void 0:data.filter(result=>!result.success))||[];if(successfulResults.length){hasMultipleSuccesses=successfulResults.length>1;successMessage=hasMultipleSuccesses?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.deletePackagePolicy.successMultipleNotificationTitle",{defaultMessage:"Deleted {count} integrations",values:{count:successfulResults.length}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.deletePackagePolicy.successSingleNotificationTitle",{defaultMessage:"Deleted integration '{id}'",values:{id:successfulResults[0].name||successfulResults[0].id}});notifications.toasts.addSuccess(successMessage)}if(failedResults.length){hasMultipleFailures=failedResults.length>1;failureMessage=hasMultipleFailures?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.deletePackagePolicy.failureMultipleNotificationTitle",{defaultMessage:"Error deleting {count} integrations",values:{count:failedResults.length}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.deletePackagePolicy.failureSingleNotificationTitle",{defaultMessage:"Error deleting integration '{id}'",values:{id:failedResults[0].id}});notifications.toasts.addDanger(failureMessage)}if(onSuccessCallback.current){onSuccessCallback.current(successfulResults.map(result=>result.id))}_context2.next=16;break;case 13:_context2.prev=13;_context2.t0=_context2["catch"](1);notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.deletePackagePolicy.fatalErrorNotificationTitle",{defaultMessage:"Error deleting integration"}));case 16:closeModal();case 17:case"end":return _context2.stop()}}),_callee2,null,[[1,13]])}))),[closeModal,packagePolicies,notifications.toasts]);const renderModal=()=>{if(!isModalOpen){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deletePackagePolicy.confirmModal.deleteMultipleTitle",defaultMessage:"Delete {count, plural, one {integration} other {# integrations}}?",values:{count:packagePolicies.length}}),onCancel:closeModal,onConfirm:deletePackagePolicies,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deletePackagePolicy.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:isLoading||isLoadingAgentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deletePackagePolicy.confirmModal.loadingButtonLabel",defaultMessage:"Loading…"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deletePackagePolicy.confirmModal.confirmButtonLabel",defaultMessage:"Delete {agentPoliciesCount, plural, one {integration} other {integrations}}",values:{agentPoliciesCount:packagePolicies.length}}),buttonColor:"danger",confirmButtonDisabled:isLoading||isLoadingAgentsCount},isLoadingAgentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deletePackagePolicy.confirmModal.loadingAgentsCountMessage",defaultMessage:"Checking affected agents…"}):agentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deletePackagePolicy.confirmModal.affectedAgentsTitle",defaultMessage:"This action will affect {agentsCount} {agentsCount, plural, one {agent} other {agents}}.",values:{agentsCount:agentsCount}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deletePackagePolicy.confirmModal.affectedAgentsMessage",defaultMessage:"Fleet has detected that {agentPolicyName} is already in use by some of your agents.",values:{agentPolicyName:external_kbnSharedDeps_React_default.a.createElement("strong",null,agentPolicy.name)}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})):null,!isLoadingAgentsCount&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.deletePackagePolicy.confirmModal.generalMessage",defaultMessage:"This action can not be undone. Are you sure you wish to continue?"})))};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,children(deletePackagePoliciesPrompt),renderModal())};const FlyoutBody=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlyoutBody"]).withConfig({displayName:"FlyoutBody",componentId:"l5rkdh-0"})([".euiFlyoutBody__overflowContent{padding:0;}"]);const AgentPolicyYamlFlyout=Object(external_kbnSharedDeps_React_["memo"])(({policyId:policyId,onClose:onClose})=>{const core=Object(hooks["mb"])();const _useGetOneAgentPolicy=Object(hooks["X"])(policyId),isLoadingYaml=_useGetOneAgentPolicy.isLoading,yamlData=_useGetOneAgentPolicy.data,error=_useGetOneAgentPolicy.error;const _useGetOneAgentPolicy2=Object(hooks["W"])(policyId),agentPolicyData=_useGetOneAgentPolicy2.data;const body=isLoadingYaml?external_kbnSharedDeps_React_default.a.createElement(Loading,null):error?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.ErrorGettingFullAgentPolicy",defaultMessage:"Error loading agent policy"}),color:"danger",iconType:"alert"},error.message):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{language:"yaml",isCopyable:true,fontSize:"m",whiteSpace:"pre"},Object(services["j"])(yamlData.item));const downloadLink=core.http.basePath.prepend(services["b"].getInfoFullDownloadPath(policyId));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyout"],{onClose:onClose,size:"l",maxWidth:640},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true,"aria-labelledby":"IngestManagerAgentPolicyYamlFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"IngestManagerAgentPolicyYamlFlyoutTitle"},(agentPolicyData===null||agentPolicyData===void 0?void 0:agentPolicyData.item)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.yamlflyoutTitleWithName",defaultMessage:"'{name}' agent policy",values:{name:agentPolicyData.item.name}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.yamlflyoutTitleWithoutName",defaultMessage:"Agent policy"})))),external_kbnSharedDeps_React_default.a.createElement(FlyoutBody,null,body),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.yamlFlyoutCloseButtonLabel",defaultMessage:"Close"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{href:downloadLink,iconType:"download",isDisabled:Boolean(isLoadingYaml&&!yamlData)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.yamlDownloadButtonLabel",defaultMessage:"Download policy"}))))))});const LinkedAgentCount=Object(external_kbnSharedDeps_React_["memo"])(({count:count,agentPolicyId:agentPolicyId})=>{const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const displayValue=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicy.linkedAgentCountText",defaultMessage:"{count, plural, one {# agent} other {# agents}}",values:{count:count}});return count>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:getHref("fleet_agent_list",{kuery:"".concat(constants["c"],".policy_id : ").concat(agentPolicyId)})},displayValue):displayValue});const ConfirmDeployAgentPolicyModal=({onConfirm:onConfirm,onCancel:onCancel,agentCount:agentCount,agentPolicy:agentPolicy})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicy.confirmModalTitle",defaultMessage:"Save and deploy changes"}),onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicy.confirmModalCancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicy.confirmModalConfirmButtonLabel",defaultMessage:"Save and deploy changes"}),buttonColor:"primary"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{iconType:"iInCircle",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicy.confirmModalCalloutTitle",{defaultMessage:"This action will update {agentCount, plural, one {# agent} other {# agents}}",values:{agentCount:agentCount}})},external_kbnSharedDeps_React_default.a.createElement("div",{className:"eui-textBreakWord"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicy.confirmModalCalloutDescription",defaultMessage:"Fleet has detected that the selected agent policy, {policyName}, is already in use by some of your agents. As a result of this action, Fleet will deploy updates to all agents that use this policy.",values:{policyName:external_kbnSharedDeps_React_default.a.createElement("b",null,agentPolicy.name)}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicy.confirmModalDescription",defaultMessage:"This action can not be undone. Are you sure you wish to continue?"})));const DangerEuiContextMenuItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"]).withConfig({displayName:"DangerEuiContextMenuItem",componentId:"sc-1kxx75b-0"})(["color:",";"],props=>props.theme.eui.textColors.danger);function actions_menu_slicedToArray(arr,i){return actions_menu_arrayWithHoles(arr)||actions_menu_iterableToArrayLimit(arr,i)||actions_menu_unsupportedIterableToArray(arr,i)||actions_menu_nonIterableRest()}function actions_menu_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function actions_menu_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return actions_menu_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return actions_menu_arrayLikeToArray(o,minLen)}function actions_menu_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function actions_menu_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function actions_menu_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AgentPolicyActionMenu=Object(external_kbnSharedDeps_React_["memo"])(({agentPolicy:agentPolicy,onCopySuccess:onCopySuccess,fullButton:fullButton=false,enrollmentFlyoutOpenByDefault:enrollmentFlyoutOpenByDefault=false,onCancelEnrollment:onCancelEnrollment})=>{const hasWriteCapabilities=Object(hooks["J"])().write;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=actions_menu_slicedToArray(_useState,2),isYamlFlyoutOpen=_useState2[0],setIsYamlFlyoutOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(enrollmentFlyoutOpenByDefault),_useState4=actions_menu_slicedToArray(_useState3,2),isEnrollmentFlyoutOpen=_useState4[0],setIsEnrollmentFlyoutOpen=_useState4[1];const onClose=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(onCancelEnrollment){return onCancelEnrollment}else{return()=>setIsEnrollmentFlyoutOpen(false)}},[onCancelEnrollment,setIsEnrollmentFlyoutOpen]);return external_kbnSharedDeps_React_default.a.createElement(AgentPolicyCopyProvider,null,copyAgentPolicyPrompt=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isYamlFlyoutOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentPolicyYamlFlyout,{policyId:agentPolicy.id,onClose:()=>setIsYamlFlyoutOpen(false)})):null,isEnrollmentFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentEnrollmentFlyout,{agentPolicies:[agentPolicy],onClose:onClose})),external_kbnSharedDeps_React_default.a.createElement(ContextMenuActions,{button:fullButton?{props:{iconType:"arrowDown",iconSide:"right"},children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyActionMenu.buttonText",defaultMessage:"Actions"})}:undefined,items:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{disabled:!hasWriteCapabilities,icon:"plusInCircle",onClick:()=>setIsEnrollmentFlyoutOpen(true),key:"enrollAgents"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyActionMenu.enrollAgentActionText",defaultMessage:"Add agent"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{icon:"inspect",onClick:()=>setIsYamlFlyoutOpen(!isYamlFlyoutOpen),key:"viewPolicy"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyActionMenu.viewPolicyText",defaultMessage:"View policy"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{disabled:!hasWriteCapabilities,icon:"copy",onClick:()=>{copyAgentPolicyPrompt(agentPolicy,onCopySuccess)},key:"copyPolicy"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyActionMenu.copyPolicyActionText",defaultMessage:"Copy policy"}))]})))});const CreatePackagePolicyPageLayout=Object(external_kbnSharedDeps_React_["memo"])(({from:from,cancelUrl:cancelUrl,onCancel:onCancel,agentPolicy:agentPolicy,packageInfo:packageInfo,children:children,"data-test-subj":dataTestSubj})=>{const pageTitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if((from==="package"||from==="edit")&&packageInfo){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:(packageInfo===null||packageInfo===void 0?void 0:packageInfo.name)||"",version:(packageInfo===null||packageInfo===void 0?void 0:packageInfo.version)||"",icons:packageInfo===null||packageInfo===void 0?void 0:packageInfo.icons,size:"xl"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,from==="edit"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.editPackagePolicy.pageTitleWithPackageName",defaultMessage:"Edit {packageName} integration",values:{packageName:packageInfo.title}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.pageTitleWithPackageName",defaultMessage:"Add {packageName} integration",values:{packageName:packageInfo.title}})))))}return from==="edit"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.editPackagePolicy.pageTitle",defaultMessage:"Edit integration"}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.pageTitle",defaultMessage:"Add integration"})))},[from,packageInfo]);const pageDescription=Object(external_kbnSharedDeps_React_["useMemo"])(()=>from==="edit"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.editPackagePolicy.pageDescription",defaultMessage:"Modify integration settings and deploy changes to the selected agent policy."}):from==="policy"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.pageDescriptionfromPolicy",defaultMessage:"Configure an integration for the selected agent policy."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.pageDescriptionfromPackage",defaultMessage:"Follow these instructions to add this integration to an agent policy."}),[from]);const leftColumn=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",iconType:"arrowLeft",flush:"left",href:cancelUrl,onClick:onCancel,"data-test-subj":"".concat(dataTestSubj,"_cancelBackLink")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.cancelLinkText",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,pageTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},pageDescription)));const rightColumn=agentPolicy&&(from==="policy"||from==="edit")?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{className:"eui-textRight",textStyle:"reverse"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.agentPolicyNameLabel",defaultMessage:"Agent policy"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],{className:"eui-textBreakWord"},(agentPolicy===null||agentPolicy===void 0?void 0:agentPolicy.name)||"-")):undefined;const maxWidth=770;return external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{restrictHeaderWidth:maxWidth,restrictWidth:maxWidth,leftColumn:leftColumn,rightColumn:rightColumn,rightColumnGrow:false,"data-test-subj":dataTestSubj},children)});const isAdvancedVar=varDef=>{if(varDef.show_user||varDef.required&&varDef.default===undefined){return false}return true};const hasInvalidButRequiredVar=(registryVars,packagePolicyVars)=>registryVars&&!packagePolicyVars||Boolean(registryVars&&registryVars.find(registryVar=>{var _validatePackagePolic;return registryVar.required&&(!packagePolicyVars||!packagePolicyVars[registryVar.name]||((_validatePackagePolic=validatePackagePolicyConfig(packagePolicyVars[registryVar.name],registryVar))===null||_validatePackagePolic===void 0?void 0:_validatePackagePolic.length))}));const validatePackagePolicy=(packagePolicy,packageInfo)=>{const validationResults={name:null,description:null,namespace:null,inputs:{}};const namespaceValidation=Object(services["n"])(packagePolicy.namespace);if(!packagePolicy.name.trim()){validationResults.name=[external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.packagePolicyValidation.nameRequiredErrorMessage",{defaultMessage:"Name is required"})]}if(!namespaceValidation.valid&&namespaceValidation.error){validationResults.namespace=[namespaceValidation.error]}if(!packageInfo.policy_templates||packageInfo.policy_templates.length===0||!packageInfo.policy_templates[0]||!packageInfo.policy_templates[0].inputs||packageInfo.policy_templates[0].inputs.length===0){validationResults.inputs=null;return validationResults}const registryInputsByType=packageInfo.policy_templates[0].inputs.reduce((inputs,registryInput)=>{inputs[registryInput.type]=registryInput;return inputs},{});const registryStreamsByDataset=(packageInfo.data_streams||[]).reduce((dataStreams,registryDataStream)=>{dataStreams[registryDataStream.dataset]=registryDataStream.streams||[];return dataStreams},{});packagePolicy.inputs.forEach(input=>{if(!input.vars&&!input.streams){return}const inputValidationResults={vars:undefined,streams:{}};const inputVarsByName=(registryInputsByType[input.type].vars||[]).reduce((vars,registryVar)=>{vars[registryVar.name]=registryVar;return vars},{});const inputConfigs=Object.entries(input.vars||{});if(inputConfigs.length){inputValidationResults.vars=inputConfigs.reduce((results,[name,configEntry])=>{results[name]=input.enabled?validatePackagePolicyConfig(configEntry,inputVarsByName[name]):null;return results},{})}else{delete inputValidationResults.vars}if(input.streams.length){input.streams.forEach(stream=>{const streamValidationResults={};if(stream.vars){const streamVarsByName=((registryStreamsByDataset[stream.data_stream.dataset].find(registryStream=>registryStream.input===input.type)||{}).vars||[]).reduce((vars,registryVar)=>{vars[registryVar.name]=registryVar;return vars},{});streamValidationResults.vars=Object.entries(stream.vars).reduce((results,[name,configEntry])=>{results[name]=input.enabled&&stream.enabled?validatePackagePolicyConfig(configEntry,streamVarsByName[name]):null;return results},{})}inputValidationResults.streams[stream.data_stream.dataset]=streamValidationResults})}else{delete inputValidationResults.streams}if(inputValidationResults.vars||inputValidationResults.streams){validationResults.inputs[input.type]=inputValidationResults}});if(Object.entries(validationResults.inputs).length===0){validationResults.inputs=null}return validationResults};const validatePackagePolicyConfig=(configEntry,varDef)=>{const errors=[];const value=configEntry.value;let parsedValue=value;if(typeof value==="string"){parsedValue=value.trim()}if(varDef.required){if(parsedValue===undefined||typeof parsedValue==="string"&&!parsedValue){errors.push(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.packagePolicyValidation.requiredErrorMessage",{defaultMessage:"{fieldName} is required",values:{fieldName:varDef.title||varDef.name}}))}}if(varDef.type==="yaml"){try{parsedValue=Object(js_yaml["safeLoad"])(value)}catch(e){errors.push(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.packagePolicyValidation.invalidYamlFormatErrorMessage",{defaultMessage:"Invalid YAML format"}))}}if(varDef.multi){if(parsedValue&&!Array.isArray(parsedValue)){errors.push(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.packagePolicyValidation.invalidArrayErrorMessage",{defaultMessage:"Invalid format"}))}if(varDef.required&&(!parsedValue||Array.isArray(parsedValue)&&parsedValue.length===0)){errors.push(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.packagePolicyValidation.requiredErrorMessage",{defaultMessage:"{fieldName} is required",values:{fieldName:varDef.title||varDef.name}}))}}return errors.length?errors:null};const countValidationErrors=validationResults=>{const flattenedValidation=Object(services["k"])(validationResults);const errors=Object.values(flattenedValidation).filter(value=>Boolean(value))||[];return errors.length};const validationHasErrors=validationResults=>countValidationErrors(validationResults)>0;var react_markdown=__webpack_require__(122);var react_markdown_default=__webpack_require__.n(react_markdown);var mode_yaml=__webpack_require__(260);var textmate=__webpack_require__(261);function package_policy_input_var_field_slicedToArray(arr,i){return package_policy_input_var_field_arrayWithHoles(arr)||package_policy_input_var_field_iterableToArrayLimit(arr,i)||package_policy_input_var_field_unsupportedIterableToArray(arr,i)||package_policy_input_var_field_nonIterableRest()}function package_policy_input_var_field_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function package_policy_input_var_field_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return package_policy_input_var_field_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return package_policy_input_var_field_arrayLikeToArray(o,minLen)}function package_policy_input_var_field_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function package_policy_input_var_field_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function package_policy_input_var_field_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const PackagePolicyInputVarField=Object(external_kbnSharedDeps_React_["memo"])(({varDef:varDef,value:value,onChange:_onChange,errors:varErrors,forceShowErrors:forceShowErrors})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=package_policy_input_var_field_slicedToArray(_useState,2),isDirty=_useState2[0],setIsDirty=_useState2[1];const multi=varDef.multi,required=varDef.required,type=varDef.type,title=varDef.title,name=varDef.name,description=varDef.description;const isInvalid=(isDirty||forceShowErrors)&&!!varErrors;const errors=isInvalid?varErrors:null;const field=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(multi){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{noSuggestions:true,isInvalid:isInvalid,selectedOptions:value.map(val=>({label:val})),onCreateOption:newVal=>{_onChange([...value,newVal])},onChange:newVals=>{_onChange(newVals.map(val=>val.label))},onBlur:()=>setIsDirty(true)})}if(type==="yaml"){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeEditor"],{width:"100%",mode:"yaml",theme:"textmate",setOptions:{minLines:10,maxLines:30,tabSize:2,showGutter:false},value:value,onChange:newVal=>_onChange(newVal),onBlur:()=>setIsDirty(true)})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{isInvalid:isInvalid,value:value===undefined?"":value,onChange:e=>_onChange(e.target.value),onBlur:()=>setIsDirty(true)})},[isInvalid,multi,_onChange,type,value]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:isInvalid,error:errors,label:title||name,labelAppend:!required?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.inputVarFieldOptionalLabel",defaultMessage:"Optional"})):null,helpText:external_kbnSharedDeps_React_default.a.createElement(react_markdown_default.a,{source:description})},field)});function package_policy_input_config_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function package_policy_input_config_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){package_policy_input_config_ownKeys(Object(source),true).forEach((function(key){package_policy_input_config_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{package_policy_input_config_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function package_policy_input_config_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function package_policy_input_config_slicedToArray(arr,i){return package_policy_input_config_arrayWithHoles(arr)||package_policy_input_config_iterableToArrayLimit(arr,i)||package_policy_input_config_unsupportedIterableToArray(arr,i)||package_policy_input_config_nonIterableRest()}function package_policy_input_config_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function package_policy_input_config_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return package_policy_input_config_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return package_policy_input_config_arrayLikeToArray(o,minLen)}function package_policy_input_config_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function package_policy_input_config_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function package_policy_input_config_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const FlexItemWithMaxWidth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItemWithMaxWidth",componentId:"sc-2lf3ki-0"})(["max-width:calc(50% - ",");"],props=>props.theme.eui.euiSizeL);const PackagePolicyInputConfig=Object(external_kbnSharedDeps_React_["memo"])(({hasInputStreams:hasInputStreams,packageInputVars:packageInputVars,packagePolicyInput:packagePolicyInput,updatePackagePolicyInput:updatePackagePolicyInput,inputVarsValidationResults:inputVarsValidationResults,forceShowErrors:forceShowErrors})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=package_policy_input_config_slicedToArray(_useState,2),isShowingAdvanced=_useState2[0],setIsShowingAdvanced=_useState2[1];const hasErrors=forceShowErrors&&validationHasErrors(inputVarsValidationResults);const requiredVars=[];const advancedVars=[];if(packageInputVars){packageInputVars.forEach(varDef=>{if(isAdvancedVar(varDef)){advancedVars.push(varDef)}else{requiredVars.push(varDef)}})}const advancedVarsWithErrorsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>advancedVars.filter(({name:varName})=>{var _inputVarsValidationR,_inputVarsValidationR2;return(_inputVarsValidationR=inputVarsValidationResults.vars)===null||_inputVarsValidationR===void 0?void 0:(_inputVarsValidationR2=_inputVarsValidationR[varName])===null||_inputVarsValidationR2===void 0?void 0:_inputVarsValidationR2.length}).length,[advancedVars,inputVarsValidationResults.vars]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGrid"],{columns:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:5},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.inputSettingsTitle",defaultMessage:"Settings"}))),hasInputStreams?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.inputSettingsDescription",defaultMessage:"The following settings are applicable to all inputs below."})))):null))),external_kbnSharedDeps_React_default.a.createElement(FlexItemWithMaxWidth,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"m"},requiredVars.map(varDef=>{const varName=varDef.name,varType=varDef.type;const value=packagePolicyInput.vars[varName].value;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:varName},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputVarField,{varDef:varDef,value:value,onChange:newValue=>{updatePackagePolicyInput({vars:package_policy_input_config_objectSpread(package_policy_input_config_objectSpread({},packagePolicyInput.vars),{},{[varName]:{type:varType,value:newValue}})})},errors:inputVarsValidationResults.vars[varName],forceShowErrors:forceShowErrors}))}),advancedVars.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",iconType:isShowingAdvanced?"arrowDown":"arrowRight",onClick:()=>setIsShowingAdvanced(!isShowingAdvanced),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.toggleAdvancedOptionsButtonText",defaultMessage:"Advanced options"}))),!isShowingAdvanced&&hasErrors&&advancedVarsWithErrorsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"danger",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.errorCountText",defaultMessage:"{count, plural, one {# error} other {# errors}}",values:{count:advancedVarsWithErrorsCount}}))):null)),isShowingAdvanced?advancedVars.map(varDef=>{const varName=varDef.name,varType=varDef.type;const value=packagePolicyInput.vars[varName].value;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:varName},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputVarField,{varDef:varDef,value:value,onChange:newValue=>{updatePackagePolicyInput({vars:package_policy_input_config_objectSpread(package_policy_input_config_objectSpread({},packagePolicyInput.vars),{},{[varName]:{type:varType,value:newValue}})})},errors:inputVarsValidationResults.vars[varName],forceShowErrors:forceShowErrors}))}):null):null)))});function package_policy_input_stream_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function package_policy_input_stream_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){package_policy_input_stream_ownKeys(Object(source),true).forEach((function(key){package_policy_input_stream_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{package_policy_input_stream_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function package_policy_input_stream_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function package_policy_input_stream_slicedToArray(arr,i){return package_policy_input_stream_arrayWithHoles(arr)||package_policy_input_stream_iterableToArrayLimit(arr,i)||package_policy_input_stream_unsupportedIterableToArray(arr,i)||package_policy_input_stream_nonIterableRest()}function package_policy_input_stream_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function package_policy_input_stream_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return package_policy_input_stream_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return package_policy_input_stream_arrayLikeToArray(o,minLen)}function package_policy_input_stream_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function package_policy_input_stream_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function package_policy_input_stream_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const package_policy_input_stream_FlexItemWithMaxWidth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItemWithMaxWidth",componentId:"d6l6ns-0"})(["max-width:calc(50% - ",");"],props=>props.theme.eui.euiSizeL);const PackagePolicyInputStreamConfig=Object(external_kbnSharedDeps_React_["memo"])(({packageInputStream:packageInputStream,packagePolicyInputStream:packagePolicyInputStream,updatePackagePolicyInputStream:updatePackagePolicyInputStream,inputStreamValidationResults:inputStreamValidationResults,forceShowErrors:forceShowErrors})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=package_policy_input_stream_slicedToArray(_useState,2),isShowingAdvanced=_useState2[0],setIsShowingAdvanced=_useState2[1];const hasErrors=forceShowErrors&&validationHasErrors(inputStreamValidationResults);const requiredVars=[];const advancedVars=[];if(packageInputStream.vars&&packageInputStream.vars.length){packageInputStream.vars.forEach(varDef=>{if(isAdvancedVar(varDef)){advancedVars.push(varDef)}else{requiredVars.push(varDef)}})}const advancedVarsWithErrorsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>advancedVars.filter(({name:varName})=>{var _inputStreamValidatio,_inputStreamValidatio2;return(_inputStreamValidatio=inputStreamValidationResults.vars)===null||_inputStreamValidatio===void 0?void 0:(_inputStreamValidatio2=_inputStreamValidatio[varName])===null||_inputStreamValidatio2===void 0?void 0:_inputStreamValidatio2.length}).length,[advancedVars,inputStreamValidationResults.vars]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGrid"],{columns:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:5},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:packageInputStream.title,checked:packagePolicyInputStream.enabled,onChange:e=>{const enabled=e.target.checked;updatePackagePolicyInputStream({enabled:enabled})}}),packageInputStream.description?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(react_markdown_default.a,{source:packageInputStream.description}))):null))),external_kbnSharedDeps_React_default.a.createElement(package_policy_input_stream_FlexItemWithMaxWidth,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"m"},requiredVars.map(varDef=>{const varName=varDef.name,varType=varDef.type;const value=packagePolicyInputStream.vars[varName].value;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:varName},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputVarField,{varDef:varDef,value:value,onChange:newValue=>{updatePackagePolicyInputStream({vars:package_policy_input_stream_objectSpread(package_policy_input_stream_objectSpread({},packagePolicyInputStream.vars),{},{[varName]:{type:varType,value:newValue}})})},errors:inputStreamValidationResults.vars[varName],forceShowErrors:forceShowErrors}))}),advancedVars.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",iconType:isShowingAdvanced?"arrowDown":"arrowRight",onClick:()=>setIsShowingAdvanced(!isShowingAdvanced),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.toggleAdvancedOptionsButtonText",defaultMessage:"Advanced options"}))),!isShowingAdvanced&&hasErrors&&advancedVarsWithErrorsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"danger",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.errorCountText",defaultMessage:"{count, plural, one {# error} other {# errors}}",values:{count:advancedVarsWithErrorsCount}}))):null)),isShowingAdvanced?advancedVars.map(varDef=>{const varName=varDef.name,varType=varDef.type;const value=packagePolicyInputStream.vars[varName].value;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:varName},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputVarField,{varDef:varDef,value:value,onChange:newValue=>{updatePackagePolicyInputStream({vars:package_policy_input_stream_objectSpread(package_policy_input_stream_objectSpread({},packagePolicyInputStream.vars),{},{[varName]:{type:varType,value:newValue}})})},errors:inputStreamValidationResults.vars[varName],forceShowErrors:forceShowErrors}))}):null):null)))});function package_policy_input_panel_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function package_policy_input_panel_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){package_policy_input_panel_ownKeys(Object(source),true).forEach((function(key){package_policy_input_panel_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{package_policy_input_panel_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function package_policy_input_panel_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function package_policy_input_panel_slicedToArray(arr,i){return package_policy_input_panel_arrayWithHoles(arr)||package_policy_input_panel_iterableToArrayLimit(arr,i)||package_policy_input_panel_unsupportedIterableToArray(arr,i)||package_policy_input_panel_nonIterableRest()}function package_policy_input_panel_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function package_policy_input_panel_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return package_policy_input_panel_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return package_policy_input_panel_arrayLikeToArray(o,minLen)}function package_policy_input_panel_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function package_policy_input_panel_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function package_policy_input_panel_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ShortenedHorizontalRule=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"]).withConfig({displayName:"ShortenedHorizontalRule",componentId:"sc-3olfkf-0"})(["&&&{width:","%;margin-left:auto;}"],11/12*100);const shouldShowStreamsByDefault=(packageInput,packageInputStreams,packagePolicyInput)=>packagePolicyInput.enabled&&(hasInvalidButRequiredVar(packageInput.vars,packagePolicyInput.vars)||Boolean(packageInputStreams.find(stream=>{var _packagePolicyInput$s;return stream.enabled&&hasInvalidButRequiredVar(stream.vars,(_packagePolicyInput$s=packagePolicyInput.streams.find(pkgStream=>stream.data_stream.dataset===pkgStream.data_stream.dataset))===null||_packagePolicyInput$s===void 0?void 0:_packagePolicyInput$s.vars)})));const PackagePolicyInputPanel=Object(external_kbnSharedDeps_React_["memo"])(({packageInput:packageInput,packageInputStreams:packageInputStreams,packagePolicyInput:packagePolicyInput,updatePackagePolicyInput:updatePackagePolicyInput,inputValidationResults:inputValidationResults,forceShowErrors:forceShowErrors})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(shouldShowStreamsByDefault(packageInput,packageInputStreams,packagePolicyInput)),_useState2=package_policy_input_panel_slicedToArray(_useState,2),isShowingStreams=_useState2[0],setIsShowingStreams=_useState2[1];const errorCount=countValidationErrors(inputValidationResults);const hasErrors=forceShowErrors&&errorCount;const hasInputStreams=Object(external_kbnSharedDeps_React_["useMemo"])(()=>packageInputStreams.length>0,[packageInputStreams.length]);const inputStreams=Object(external_kbnSharedDeps_React_["useMemo"])(()=>packageInputStreams.map(packageInputStream=>({packageInputStream:packageInputStream,packagePolicyInputStream:packagePolicyInput.streams.find(stream=>stream.data_stream.dataset===packageInputStream.data_stream.dataset)})).filter(stream=>Boolean(stream.packagePolicyInputStream)),[packageInputStreams,packagePolicyInput.streams]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h4",null,packageInput.title||packageInput.type)))),checked:packagePolicyInput.enabled,onChange:e=>{const enabled=e.target.checked;updatePackagePolicyInput({enabled:enabled,streams:packagePolicyInput.streams.map(stream=>package_policy_input_panel_objectSpread(package_policy_input_panel_objectSpread({},stream),{},{enabled:enabled}))});if(!enabled&&isShowingStreams){setIsShowingStreams(false)}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},hasErrors?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"danger",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.errorCountText",defaultMessage:"{count, plural, one {# error} other {# errors}}",values:{count:errorCount}}))):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:isShowingStreams?"arrowUp":"arrowDown",onClick:()=>setIsShowingStreams(!isShowingStreams),color:hasErrors?"danger":"text","aria-label":isShowingStreams?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createPackagePolicy.stepConfigure.hideStreamsAriaLabel",{defaultMessage:"Hide {type} inputs",values:{type:packageInput.type}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createPackagePolicy.stepConfigure.showStreamsAriaLabel",{defaultMessage:"Show {type} inputs",values:{type:packageInput.type}})}))))),isShowingStreams?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}):null,isShowingStreams&&packageInput.vars&&packageInput.vars.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputConfig,{hasInputStreams:hasInputStreams,packageInputVars:packageInput.vars,packagePolicyInput:packagePolicyInput,updatePackagePolicyInput:updatePackagePolicyInput,inputVarsValidationResults:{vars:inputValidationResults.vars},forceShowErrors:forceShowErrors}),hasInputStreams?external_kbnSharedDeps_React_default.a.createElement(ShortenedHorizontalRule,{margin:"m"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})):null,isShowingStreams?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},inputStreams.map(({packageInputStream:packageInputStream,packagePolicyInputStream:packagePolicyInputStream},index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:index},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputStreamConfig,{packageInputStream:packageInputStream,packagePolicyInputStream:packagePolicyInputStream,updatePackagePolicyInputStream:updatedStream=>{const indexOfUpdatedStream=packagePolicyInput.streams.findIndex(stream=>stream.data_stream.dataset===packageInputStream.data_stream.dataset);const newStreams=[...packagePolicyInput.streams];newStreams[indexOfUpdatedStream]=package_policy_input_panel_objectSpread(package_policy_input_panel_objectSpread({},newStreams[indexOfUpdatedStream]),updatedStream);const updatedInput={streams:newStreams};if(!packagePolicyInput.enabled&&updatedStream.enabled){updatedInput.enabled=true}else if(packagePolicyInput.enabled&&!newStreams.find(stream=>stream.enabled)){updatedInput.enabled=false}updatePackagePolicyInput(updatedInput)},inputStreamValidationResults:inputValidationResults.streams[packagePolicyInputStream.data_stream.dataset],forceShowErrors:forceShowErrors}),index!==inputStreams.length-1?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(ShortenedHorizontalRule,{margin:"none"})):null))):null)});function step_select_package_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function step_select_package_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){step_select_package_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){step_select_package_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function step_select_package_slicedToArray(arr,i){return step_select_package_arrayWithHoles(arr)||step_select_package_iterableToArrayLimit(arr,i)||step_select_package_unsupportedIterableToArray(arr,i)||step_select_package_nonIterableRest()}function step_select_package_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function step_select_package_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return step_select_package_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return step_select_package_arrayLikeToArray(o,minLen)}function step_select_package_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function step_select_package_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function step_select_package_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const StepSelectPackage=({agentPolicyId:agentPolicyId,updateAgentPolicy:updateAgentPolicy,packageInfo:packageInfo,updatePackageInfo:updatePackageInfo,setIsLoadingSecondStep:setIsLoadingSecondStep})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(packageInfo?"".concat(packageInfo.name,"-").concat(packageInfo.version):undefined),_useState2=step_select_package_slicedToArray(_useState,2),selectedPkgKey=_useState2[0],setSelectedPkgKey=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=step_select_package_slicedToArray(_useState3,2),selectedPkgError=_useState4[0],setSelectedPkgError=_useState4[1];const _useGetOneAgentPolicy=Object(hooks["W"])(agentPolicyId),agentPolicyData=_useGetOneAgentPolicy.data,agentPolicyError=_useGetOneAgentPolicy.error,isAgentPoliciesLoading=_useGetOneAgentPolicy.isLoading;const _useState5=Object(external_kbnSharedDeps_React_["useState"])([]),_useState6=step_select_package_slicedToArray(_useState5,2),packages=_useState6[0],setPackages=_useState6[1];const _useGetPackages=Object(hooks["bb"])(),packagesData=_useGetPackages.data,packagesError=_useGetPackages.error,isPackagesLoading=_useGetPackages.isLoading;const _useGetLimitedPackage=Object(hooks["U"])(),limitedPackagesData=_useGetLimitedPackage.data,isLimitedPackagesLoading=_useGetLimitedPackage.isLoading;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if((packagesData===null||packagesData===void 0?void 0:packagesData.response)&&(limitedPackagesData===null||limitedPackagesData===void 0?void 0:limitedPackagesData.response)&&(agentPolicyData===null||agentPolicyData===void 0?void 0:agentPolicyData.item)){const allPackages=packagesData.response;const limitedPackages=limitedPackagesData.response;const usedLimitedPackages=agentPolicyData.item.package_policies.map(packagePolicy=>{var _packagePolicy$packag;return((_packagePolicy$packag=packagePolicy.package)===null||_packagePolicy$packag===void 0?void 0:_packagePolicy$packag.name)||""}).filter(pkgName=>limitedPackages.includes(pkgName));setPackages(allPackages.filter(pkg=>!usedLimitedPackages.includes(pkg.name)))}},[packagesData,limitedPackagesData,agentPolicyData]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(agentPolicyData&&agentPolicyData.item){updateAgentPolicy(agentPolicyData.item)}},[agentPolicyData,updateAgentPolicy]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const fetchPackageInfo=function(){var _ref=step_select_package_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$sendGetPackage,data,error;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!selectedPkgKey){_context.next=11;break}setIsLoadingSecondStep(true);_context.next=4;return Object(hooks["r"])(selectedPkgKey);case 4:_yield$sendGetPackage=_context.sent;data=_yield$sendGetPackage.data;error=_yield$sendGetPackage.error;if(error){setSelectedPkgError(error);updatePackageInfo(undefined)}else if(data&&data.response){setSelectedPkgError(undefined);updatePackageInfo(data.response)}setIsLoadingSecondStep(false);_context.next=13;break;case 11:setSelectedPkgError(undefined);updatePackageInfo(undefined);case 13:case"end":return _context.stop()}}),_callee)})));return function fetchPackageInfo(){return _ref.apply(this,arguments)}}();if(!packageInfo||selectedPkgKey!=="".concat(packageInfo.name,"-").concat(packageInfo.version)){fetchPackageInfo()}},[selectedPkgKey,packageInfo,updatePackageInfo,setIsLoadingSecondStep]);if(agentPolicyError){return external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepSelectPackage.errorLoadingPolicyTitle",defaultMessage:"Error loading agent policy information"}),error:agentPolicyError})}if(packagesError){return external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepSelectPackage.errorLoadingPackagesTitle",defaultMessage:"Error loading integrations"}),error:packagesError})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelectable"],{searchable:true,allowExclusions:false,singleSelection:true,isLoading:isPackagesLoading||isLimitedPackagesLoading||isAgentPoliciesLoading,options:packages.map(({title:title,name:name,version:version,icons:icons})=>{const pkgkey="".concat(name,"-").concat(version);return{label:title||name,key:pkgkey,prepend:external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:name,version:version,icons:icons,size:"m",tryApi:true}),checked:selectedPkgKey===pkgkey?"on":undefined}}),listProps:{bordered:true},searchProps:{placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createPackagePolicy.stepSelectPackage.filterPackagesInputPlaceholder",{defaultMessage:"Search for integrations"})},height:240,onChange:options=>{const selectedOption=options.find(option=>option.checked==="on");if(selectedOption){if(selectedOption.key!==selectedPkgKey){setSelectedPkgKey(selectedOption.key)}}else{setSelectedPkgKey(undefined)}}},(list,search)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,search,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),list))),selectedPkgError?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepSelectPackage.errorLoadingSelectedPackageTitle",defaultMessage:"Error loading selected integration"}),error:selectedPkgError})):null)};function create_agent_policy_extends(){create_agent_policy_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return create_agent_policy_extends.apply(this,arguments)}function create_agent_policy_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function create_agent_policy_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){create_agent_policy_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){create_agent_policy_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function create_agent_policy_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function create_agent_policy_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){create_agent_policy_ownKeys(Object(source),true).forEach((function(key){create_agent_policy_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{create_agent_policy_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function create_agent_policy_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function create_agent_policy_slicedToArray(arr,i){return create_agent_policy_arrayWithHoles(arr)||create_agent_policy_iterableToArrayLimit(arr,i)||create_agent_policy_unsupportedIterableToArray(arr,i)||create_agent_policy_nonIterableRest()}function create_agent_policy_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function create_agent_policy_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return create_agent_policy_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return create_agent_policy_arrayLikeToArray(o,minLen)}function create_agent_policy_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function create_agent_policy_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function create_agent_policy_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function create_agent_policy_objectWithoutProperties(source,excluded){if(source==null)return{};var target=create_agent_policy_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function create_agent_policy_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const FlyoutWithHigherZIndex=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlyout"]).withConfig({displayName:"FlyoutWithHigherZIndex",componentId:"sc-4bxzaq-0"})(["z-index:",";"],props=>props.theme.eui.euiZLevel5);const CreateAgentPolicyFlyout=_ref=>{let _onClose=_ref.onClose,restOfProps=create_agent_policy_objectWithoutProperties(_ref,["onClose"]);const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const hasWriteCapabilites=Object(hooks["J"])().write;const _useState=Object(external_kbnSharedDeps_React_["useState"])({name:"",description:"",namespace:"default",is_default:undefined,monitoring_enabled:Object.values(common["dataTypes"])}),_useState2=create_agent_policy_slicedToArray(_useState,2),agentPolicy=_useState2[0],setAgentPolicy=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=create_agent_policy_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(true),_useState6=create_agent_policy_slicedToArray(_useState5,2),withSysMonitoring=_useState6[0],setWithSysMonitoring=_useState6[1];const validation=agentPolicyFormValidation(agentPolicy);const updateAgentPolicy=updatedFields=>{setAgentPolicy(create_agent_policy_objectSpread(create_agent_policy_objectSpread({},agentPolicy),updatedFields))};const createAgentPolicy=function(){var _ref2=create_agent_policy_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return Object(hooks["f"])(agentPolicy,{withSysMonitoring:withSysMonitoring});case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop()}}),_callee)})));return function createAgentPolicy(){return _ref2.apply(this,arguments)}}();const header=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true,"aria-labelledby":"CreateAgentPolicyFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"CreateAgentPolicyFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createAgentPolicy.flyoutTitle",defaultMessage:"Create agent policy"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createAgentPolicy.flyoutTitleDescription",defaultMessage:"Agent policies are used to manage settings across a group of agents. You can add integrations to your agent policy to specify what data your agents collect. When you edit an agent policy, you can use Fleet to deploy updates to a specified group of agents."}))));const body=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutBody"],null,external_kbnSharedDeps_React_default.a.createElement(AgentPolicyForm,{agentPolicy:agentPolicy,updateAgentPolicy:updateAgentPolicy,withSysMonitoring:withSysMonitoring,updateSysMonitoring:newValue=>setWithSysMonitoring(newValue),validation:validation}));const footer=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:()=>_onClose(),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createAgentPolicy.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,isLoading:isLoading,isDisabled:!hasWriteCapabilites||isLoading||Object.keys(validation).length>0,onClick:create_agent_policy_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _yield$createAgentPol,data,error;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setIsLoading(true);_context2.prev=1;_context2.next=4;return createAgentPolicy();case 4:_yield$createAgentPol=_context2.sent;data=_yield$createAgentPol.data;error=_yield$createAgentPol.error;setIsLoading(false);if(data){notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createAgentPolicy.successNotificationTitle",{defaultMessage:"Agent policy '{name}' created",values:{name:agentPolicy.name}}));_onClose(data.item)}else{notifications.toasts.addDanger(error?error.message:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createAgentPolicy.errorNotificationTitle",{defaultMessage:"Unable to create agent policy"}))}_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2["catch"](1);setIsLoading(false);notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createAgentPolicy.errorNotificationTitle",{defaultMessage:"Unable to create agent policy"}));case 15:case"end":return _context2.stop()}}),_callee2,null,[[1,11]])})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createAgentPolicy.submitButtonLabel",defaultMessage:"Create agent policy"})))));return external_kbnSharedDeps_React_default.a.createElement(FlyoutWithHigherZIndex,create_agent_policy_extends({onClose:()=>_onClose(),size:"l",maxWidth:400},restOfProps),header,body,footer)};function step_select_agent_policy_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function step_select_agent_policy_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){step_select_agent_policy_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){step_select_agent_policy_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function step_select_agent_policy_slicedToArray(arr,i){return step_select_agent_policy_arrayWithHoles(arr)||step_select_agent_policy_iterableToArrayLimit(arr,i)||step_select_agent_policy_unsupportedIterableToArray(arr,i)||step_select_agent_policy_nonIterableRest()}function step_select_agent_policy_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function step_select_agent_policy_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return step_select_agent_policy_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return step_select_agent_policy_arrayLikeToArray(o,minLen)}function step_select_agent_policy_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function step_select_agent_policy_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function step_select_agent_policy_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AgentPolicyWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).withConfig({displayName:"AgentPolicyWrapper",componentId:"sc-1qoukpq-0"})([".euiFormRow__label{width:100%;}"]);const AgentPolicyNameColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"AgentPolicyNameColumn",componentId:"sc-1qoukpq-1"})(["max-width:",";overflow:hidden;"],props=>"".concat(props.grow/9*100,"%"));const AgentPolicyDescriptionColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"AgentPolicyDescriptionColumn",componentId:"sc-1qoukpq-2"})(["max-width:",";overflow:hidden;"],props=>"".concat(props.grow/9*100,"%"));const StepSelectAgentPolicy=({pkgkey:pkgkey,updatePackageInfo:updatePackageInfo,agentPolicy:agentPolicy,updateAgentPolicy:updateAgentPolicy,setIsLoadingSecondStep:setIsLoadingSecondStep})=>{var _agentPoliciesById$se,_agentPoliciesById$se2;const _useFleetStatus=Object(hooks["N"])(),isFleetReady=_useFleetStatus.isReady;const _useState=Object(external_kbnSharedDeps_React_["useState"])(agentPolicy?agentPolicy.id:undefined),_useState2=step_select_agent_policy_slicedToArray(_useState,2),selectedPolicyId=_useState2[0],setSelectedPolicyId=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=step_select_agent_policy_slicedToArray(_useState3,2),selectedAgentPolicyError=_useState4[0],setSelectedAgentPolicyError=_useState4[1];const hasWriteCapabilites=Object(hooks["J"])().write;const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=step_select_agent_policy_slicedToArray(_useState5,2),isCreateAgentPolicyFlyoutOpen=_useState6[0],setIsCreateAgentPolicyFlyoutOpen=_useState6[1];const _useGetPackageInfoByK=Object(hooks["Z"])(pkgkey),packageInfoData=_useGetPackageInfoByK.data,packageInfoError=_useGetPackageInfoByK.error,isPackageInfoLoading=_useGetPackageInfoByK.isLoading;const isLimitedPackage=packageInfoData&&Object(services["m"])(packageInfoData.response)||false;const _useGetAgentPolicies=Object(hooks["O"])({page:1,perPage:1e3,sortField:"name",sortOrder:"asc",full:true}),agentPoliciesData=_useGetAgentPolicies.data,agentPoliciesError=_useGetAgentPolicies.error,isAgentPoliciesLoading=_useGetAgentPolicies.isLoading,refreshAgentPolicies=_useGetAgentPolicies.resendRequest;const agentPolicies=Object(external_kbnSharedDeps_React_["useMemo"])(()=>(agentPoliciesData===null||agentPoliciesData===void 0?void 0:agentPoliciesData.items)||[],[agentPoliciesData===null||agentPoliciesData===void 0?void 0:agentPoliciesData.items]);const agentPoliciesById=Object(external_kbnSharedDeps_React_["useMemo"])(()=>agentPolicies.reduce((acc,policy)=>{acc[policy.id]=policy;return acc},{}),[agentPolicies]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(packageInfoData&&packageInfoData.response){updatePackageInfo(packageInfoData.response)}},[packageInfoData,updatePackageInfo]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const fetchAgentPolicyInfo=function(){var _ref=step_select_agent_policy_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$sendGetOneAgen,data,error;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!selectedPolicyId){_context.next=10;break}setIsLoadingSecondStep(true);_context.next=4;return Object(hooks["n"])(selectedPolicyId);case 4:_yield$sendGetOneAgen=_context.sent;data=_yield$sendGetOneAgen.data;error=_yield$sendGetOneAgen.error;if(error){setSelectedAgentPolicyError(error);updateAgentPolicy(undefined)}else if(data&&data.item){setSelectedAgentPolicyError(undefined);updateAgentPolicy(data.item)}_context.next=12;break;case 10:setSelectedAgentPolicyError(undefined);updateAgentPolicy(undefined);case 12:setIsLoadingSecondStep(false);case 13:case"end":return _context.stop()}}),_callee)})));return function fetchAgentPolicyInfo(){return _ref.apply(this,arguments)}}();if(!agentPolicy||selectedPolicyId!==agentPolicy.id){fetchAgentPolicyInfo()}},[selectedPolicyId,agentPolicy,updateAgentPolicy,setIsLoadingSecondStep]);const agentPolicyOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>packageInfoData?agentPolicies.map(agentConf=>{const alreadyHasLimitedPackage=isLimitedPackage&&Object(services["f"])(agentConf,packageInfoData.response.name)||false;return{label:agentConf.name,value:agentConf.id,disabled:alreadyHasLimitedPackage,"data-test-subj":"agentPolicyItem"}}):[],[agentPolicies,isLimitedPackage,packageInfoData]);const selectedAgentPolicyOption=agentPolicyOptions.find(option=>option.value===selectedPolicyId);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!selectedPolicyId&&agentPolicies.length&&agentPolicyOptions.length){const defaultAgentPolicy=agentPolicies.find(policy=>policy.is_default);if(defaultAgentPolicy){const defaultAgentPolicyOption=agentPolicyOptions.find(option=>option.value===defaultAgentPolicy.id);if(defaultAgentPolicyOption&&!defaultAgentPolicyOption.disabled){setSelectedPolicyId(defaultAgentPolicy.id)}}}},[agentPolicies,agentPolicyOptions,selectedPolicyId]);if(packageInfoError){return external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.errorLoadingPackageTitle",defaultMessage:"Error loading package information"}),error:packageInfoError})}if(agentPoliciesError){return external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.errorLoadingAgentPoliciesTitle",defaultMessage:"Error loading agent policies"}),error:agentPoliciesError})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isCreateAgentPolicyFlyoutOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(CreateAgentPolicyFlyout,{onClose:newAgentPolicy=>{setIsCreateAgentPolicyFlyoutOpen(false);if(newAgentPolicy){refreshAgentPolicies();setSelectedPolicyId(newAgentPolicy.id)}},ownFocus:true})):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(AgentPolicyWrapper,{fullWidth:true,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.agentPolicyLabel",defaultMessage:"Agent policy"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{disabled:!hasWriteCapabilites,onClick:()=>setIsCreateAgentPolicyFlyoutOpen(true)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.addButton",defaultMessage:"Create agent policy"}))))),helpText:isFleetReady&&selectedPolicyId?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.agentPolicyAgentsDescriptionText",defaultMessage:"{count, plural, one {# agent} other {# agents}} are enrolled with the selected agent policy.",values:{count:(_agentPoliciesById$se=(_agentPoliciesById$se2=agentPoliciesById[selectedPolicyId])===null||_agentPoliciesById$se2===void 0?void 0:_agentPoliciesById$se2.agents)!==null&&_agentPoliciesById$se!==void 0?_agentPoliciesById$se:0}}):null},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createPackagePolicy.StepSelectPolicy.agentPolicyPlaceholderText",{defaultMessage:"Select an agent policy to add this integration to"}),singleSelection:{asPlainText:true},isClearable:false,fullWidth:true,isLoading:isAgentPoliciesLoading||isPackageInfoLoading,options:agentPolicyOptions,renderOption:option=>{var _agentPoliciesById$ag,_agentPoliciesById;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(AgentPolicyNameColumn,{grow:2},external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate"},option.label)),external_kbnSharedDeps_React_default.a.createElement(AgentPolicyDescriptionColumn,{grow:isFleetReady?5:7},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{className:"eui-textTruncate",color:"subdued"},agentPoliciesById[option.value].description)),isFleetReady?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2,className:"eui-textRight"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.agentPolicyAgentsCountText",defaultMessage:"{count, plural, one {# agent} other {# agents}} enrolled",values:{count:(_agentPoliciesById$ag=(_agentPoliciesById=agentPoliciesById[option.value])===null||_agentPoliciesById===void 0?void 0:_agentPoliciesById.agents)!==null&&_agentPoliciesById$ag!==void 0?_agentPoliciesById$ag:0}}))):null)},selectedOptions:selectedAgentPolicyOption?[selectedAgentPolicyOption]:[],onChange:options=>{const selectedOption=options[0]||undefined;if(selectedOption){if(selectedOption.value!==selectedPolicyId){setSelectedPolicyId(selectedOption.value)}}else{setSelectedPolicyId(undefined)}}}))),selectedAgentPolicyError?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.errorLoadingSelectedAgentPolicyTitle",defaultMessage:"Error loading selected agent policy"}),error:selectedAgentPolicyError})):null))};const UIExtensionsContext=external_kbnSharedDeps_React_default.a.createContext({});const useUIExtension=(packageName,view)=>{var _registeredExtensions;const registeredExtensions=Object(external_kbnSharedDeps_React_["useContext"])(UIExtensionsContext);if(!registeredExtensions){throw new Error("useUIExtension called outside of UIExtensionsContext")}const extension=registeredExtensions===null||registeredExtensions===void 0?void 0:(_registeredExtensions=registeredExtensions[packageName])===null||_registeredExtensions===void 0?void 0:_registeredExtensions[view];if(extension){return extension.component}};function step_configure_package_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function step_configure_package_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){step_configure_package_ownKeys(Object(source),true).forEach((function(key){step_configure_package_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{step_configure_package_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function step_configure_package_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const findStreamsForInputType=(inputType,packageInfo)=>{const streams=[];(packageInfo.data_streams||[]).forEach(dataStream=>{(dataStream.streams||[]).forEach(stream=>{if(stream.input===inputType){streams.push(step_configure_package_objectSpread(step_configure_package_objectSpread({},stream),{},{data_stream:{dataset:dataStream.dataset}}))}})});return streams};const StepConfigurePackagePolicy=({from:from="policy",packageInfo:packageInfo,packagePolicy:packagePolicy,packagePolicyId:packagePolicyId,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults,submitAttempted:submitAttempted})=>{const hasUiExtension=useUIExtension(packageInfo.name,from==="edit"?"package-policy-edit":"package-policy-create")!==undefined;const renderConfigureInputs=()=>packageInfo.policy_templates&&packageInfo.policy_templates[0]&&packageInfo.policy_templates[0].inputs&&packageInfo.policy_templates[0].inputs.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"none"},packageInfo.policy_templates[0].inputs.map(packageInput=>{const packagePolicyInput=packagePolicy.inputs.find(input=>input.type===packageInput.type);const packageInputStreams=findStreamsForInputType(packageInput.type,packageInfo);return packagePolicyInput?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:packageInput.type},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputPanel,{packageInput:packageInput,packageInputStreams:packageInputStreams,packagePolicyInput:packagePolicyInput,updatePackagePolicyInput:updatedInput=>{const indexOfUpdatedInput=packagePolicy.inputs.findIndex(input=>input.type===packageInput.type);const newInputs=[...packagePolicy.inputs];newInputs[indexOfUpdatedInput]=step_configure_package_objectSpread(step_configure_package_objectSpread({},newInputs[indexOfUpdatedInput]),updatedInput);updatePackagePolicy({inputs:newInputs})},inputValidationResults:validationResults.inputs[packagePolicyInput.type],forceShowErrors:submitAttempted}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"})):null}))):hasUiExtension?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"checkInCircleFilled",iconColor:"secondary",body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.noPolicyOptionsMessage",defaultMessage:"Nothing to configure"})))});return validationResults?renderConfigureInputs():external_kbnSharedDeps_React_default.a.createElement(Loading,null)};function step_define_package_policy_slicedToArray(arr,i){return step_define_package_policy_arrayWithHoles(arr)||step_define_package_policy_iterableToArrayLimit(arr,i)||step_define_package_policy_unsupportedIterableToArray(arr,i)||step_define_package_policy_nonIterableRest()}function step_define_package_policy_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function step_define_package_policy_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return step_define_package_policy_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return step_define_package_policy_arrayLikeToArray(o,minLen)}function step_define_package_policy_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function step_define_package_policy_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function step_define_package_policy_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const StepDefinePackagePolicy=({agentPolicy:agentPolicy,packageInfo:packageInfo,packagePolicy:packagePolicy,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=step_define_package_policy_slicedToArray(_useState,2),isShowingAdvanced=_useState2[0],setIsShowingAdvanced=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const pkg=packagePolicy.package;const currentPkgKey=pkg?"".concat(pkg.name,"-").concat(pkg.version):"";const pkgKey="".concat(packageInfo.name,"-").concat(packageInfo.version);if(currentPkgKey!==pkgKey){const pkgPoliciesNamePattern=new RegExp("".concat(packageInfo.name,"-(\\d+)"));const pkgPoliciesWithMatchingNames=agentPolicy.package_policies.filter(ds=>Boolean(ds.name.match(pkgPoliciesNamePattern))).map(ds=>parseInt(ds.name.match(pkgPoliciesNamePattern)[1],10)).sort();updatePackagePolicy({name:packageInfo.name!=="endpoint"?"".concat(packageInfo.name,"-").concat(pkgPoliciesWithMatchingNames.length?pkgPoliciesWithMatchingNames[pkgPoliciesWithMatchingNames.length-1]+1:1):"",package:{name:packageInfo.name,title:packageInfo.title,version:packageInfo.version},inputs:Object(services["q"])(packageInfo)})}if(packagePolicy.policy_id!==agentPolicy.id){updatePackagePolicy({policy_id:agentPolicy.id,namespace:agentPolicy.namespace})}},[packagePolicy.package,packagePolicy.policy_id,agentPolicy,packageInfo,updatePackagePolicy]);return validationResults?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.integrationSettingsSectionTitle",defaultMessage:"Integration settings"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.integrationSettingsSectionDescription",defaultMessage:"Choose a name and description to help identify how this integration will be used."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:!!validationResults.name,error:validationResults.name,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.packagePolicyNameInputLabel",defaultMessage:"Integration name"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{value:packagePolicy.name,onChange:e=>updatePackagePolicy({name:e.target.value}),"data-test-subj":"packagePolicyNameInput"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.packagePolicyDescriptionInputLabel",defaultMessage:"Description"}),labelAppend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.inputVarFieldOptionalLabel",defaultMessage:"Optional"})),isInvalid:!!validationResults.description,error:validationResults.description},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{value:packagePolicy.description,onChange:e=>updatePackagePolicy({description:e.target.value})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",iconType:isShowingAdvanced?"arrowDown":"arrowRight",onClick:()=>setIsShowingAdvanced(!isShowingAdvanced),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.advancedOptionsToggleLinkText",defaultMessage:"Advanced options"}))),!isShowingAdvanced&&!!validationResults.namespace?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"danger",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.errorCountText",defaultMessage:"{count, plural, one {# error} other {# errors}}",values:{count:1}}))):null),isShowingAdvanced?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:!!validationResults.namespace,error:validationResults.namespace,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.stepConfigure.packagePolicyNamespaceInputLabel",defaultMessage:"Namespace"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{noSuggestions:true,singleSelection:true,selectedOptions:packagePolicy.namespace?[{label:packagePolicy.namespace}]:[],onCreateOption:newNamespace=>{updatePackagePolicy({namespace:newNamespace})},onChange:newNamespaces=>{updatePackagePolicy({namespace:newNamespaces.length?newNamespaces[0].label:""})}}))):null)):external_kbnSharedDeps_React_default.a.createElement(Loading,null)};const IntraAppStateContext=external_kbnSharedDeps_React_default.a.createContext({forRoute:""});const wasHandled=new WeakSet;const IntraAppStateProvider=Object(external_kbnSharedDeps_React_["memo"])(({kibanaScopedHistory:kibanaScopedHistory,children:children})=>{const internalAppToAppState=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({forRoute:new URL("".concat(kibanaScopedHistory.location.hash.substr(1)),"http://localhost").pathname,routeState:kibanaScopedHistory.location.state}),[kibanaScopedHistory.location.state,kibanaScopedHistory.location.hash]);return external_kbnSharedDeps_React_default.a.createElement(IntraAppStateContext.Provider,{value:internalAppToAppState},children)});function useIntraAppState(){const location=Object(external_kbnSharedDeps_ReactRouterDom_["useLocation"])();const intraAppState=Object(external_kbnSharedDeps_React_["useContext"])(IntraAppStateContext);if(!intraAppState){throw new Error("Hook called outside of IntraAppStateContext")}return Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(location.pathname===intraAppState.forRoute&&!wasHandled.has(intraAppState)){wasHandled.add(intraAppState);return intraAppState.routeState}},[intraAppState,location.pathname])}const ExtensionWrapper=Object(external_kbnSharedDeps_React_["memo"])(({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiErrorBoundary"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Suspense"],{fallback:external_kbnSharedDeps_React_default.a.createElement(Loading,null)},children)));function create_package_policy_page_extends(){create_package_policy_page_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return create_package_policy_page_extends.apply(this,arguments)}function create_package_policy_page_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function create_package_policy_page_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){create_package_policy_page_ownKeys(Object(source),true).forEach((function(key){create_package_policy_page_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{create_package_policy_page_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function create_package_policy_page_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function create_package_policy_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function create_package_policy_page_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){create_package_policy_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){create_package_policy_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function create_package_policy_page_slicedToArray(arr,i){return create_package_policy_page_arrayWithHoles(arr)||create_package_policy_page_iterableToArrayLimit(arr,i)||create_package_policy_page_unsupportedIterableToArray(arr,i)||create_package_policy_page_nonIterableRest()}function create_package_policy_page_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function create_package_policy_page_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return create_package_policy_page_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return create_package_policy_page_arrayLikeToArray(o,minLen)}function create_package_policy_page_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function create_package_policy_page_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function create_package_policy_page_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const StepsWithLessPadding=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiSteps"]).withConfig({displayName:"StepsWithLessPadding",componentId:"sc-1smjujo-0"})([".euiStep__content{padding-bottom:",";}"],props=>props.theme.eui.paddingSizes.m);const CreatePackagePolicyPage=()=>{var _packagePolicy$packag,_packagePolicy$packag2;const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications,navigateToApp=_useStartServices.application.navigateToApp;const _useConfig=Object(hooks["L"])(),isFleetEnabled=_useConfig.agents.enabled;const _useRouteMatch=Object(external_kbnSharedDeps_ReactRouterDom_["useRouteMatch"])(),_useRouteMatch$params=_useRouteMatch.params,policyId=_useRouteMatch$params.policyId,pkgkey=_useRouteMatch$params.pkgkey;const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref,getPath=_useLink.getPath;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const routeState=useIntraAppState();const from=policyId?"policy":"package";const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=create_package_policy_page_slicedToArray(_useState,2),agentPolicy=_useState2[0],setAgentPolicy=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=create_package_policy_page_slicedToArray(_useState3,2),packageInfo=_useState4[0],setPackageInfo=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=create_package_policy_page_slicedToArray(_useState5,2),isLoadingSecondStep=_useState6[0],setIsLoadingSecondStep=_useState6[1];const agentPolicyId=Object(external_kbnSharedDeps_React_["useMemo"])(()=>agentPolicy===null||agentPolicy===void 0?void 0:agentPolicy.id,[agentPolicy===null||agentPolicy===void 0?void 0:agentPolicy.id]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const getAgentCount=function(){var _ref=create_package_policy_page_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$sendGetAgentSt,data;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return Object(hooks["k"])({policyId:agentPolicyId});case 2:_yield$sendGetAgentSt=_context.sent;data=_yield$sendGetAgentSt.data;if((data===null||data===void 0?void 0:data.results.total)!==undefined){setAgentCount(data.results.total)}case 5:case"end":return _context.stop()}}),_callee)})));return function getAgentCount(){return _ref.apply(this,arguments)}}();if(isFleetEnabled&&agentPolicyId){getAgentCount()}},[agentPolicyId,isFleetEnabled]);const _useState7=Object(external_kbnSharedDeps_React_["useState"])(0),_useState8=create_package_policy_page_slicedToArray(_useState7,2),agentCount=_useState8[0],setAgentCount=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])({name:"",description:"",namespace:"",policy_id:"",enabled:true,output_id:"",inputs:[]}),_useState10=create_package_policy_page_slicedToArray(_useState9,2),packagePolicy=_useState10[0],setPackagePolicy=_useState10[1];const _useState11=Object(external_kbnSharedDeps_React_["useState"])(),_useState12=create_package_policy_page_slicedToArray(_useState11,2),validationResults=_useState12[0],setValidationResults=_useState12[1];const _useState13=Object(external_kbnSharedDeps_React_["useState"])("INVALID"),_useState14=create_package_policy_page_slicedToArray(_useState13,2),formState=_useState14[0],setFormState=_useState14[1];const updatePackageInfo=Object(external_kbnSharedDeps_React_["useCallback"])(updatedPackageInfo=>{if(updatedPackageInfo){setPackageInfo(updatedPackageInfo);if(agentPolicy){setFormState("VALID")}}else{setFormState("INVALID");setPackageInfo(undefined)}console.debug("Package info updated",updatedPackageInfo)},[agentPolicy,setPackageInfo,setFormState]);const updateAgentPolicy=Object(external_kbnSharedDeps_React_["useCallback"])(updatedAgentPolicy=>{if(updatedAgentPolicy){setAgentPolicy(updatedAgentPolicy);if(packageInfo){setFormState("VALID")}}else{setFormState("INVALID");setAgentPolicy(undefined)}console.debug("Agent policy updated",updatedAgentPolicy)},[packageInfo,setAgentPolicy,setFormState]);const hasErrors=validationResults?validationHasErrors(validationResults):false;const updatePackagePolicyValidation=Object(external_kbnSharedDeps_React_["useCallback"])(newPackagePolicy=>{if(packageInfo){const newValidationResult=validatePackagePolicy(newPackagePolicy||packagePolicy,packageInfo);setValidationResults(newValidationResult);console.debug("Package policy validation results",newValidationResult);return newValidationResult}},[packagePolicy,packageInfo]);const updatePackagePolicy=Object(external_kbnSharedDeps_React_["useCallback"])(updatedFields=>{const newPackagePolicy=create_package_policy_page_objectSpread(create_package_policy_page_objectSpread({},packagePolicy),updatedFields);setPackagePolicy(newPackagePolicy);console.debug("Package policy updated",newPackagePolicy);const newValidationResults=updatePackagePolicyValidation(newPackagePolicy);const hasPackage=newPackagePolicy.package;const hasValidationErrors=newValidationResults?validationHasErrors(newValidationResults):false;const hasAgentPolicy=newPackagePolicy.policy_id&&newPackagePolicy.policy_id!=="";if(hasPackage&&hasAgentPolicy&&!hasValidationErrors){setFormState("VALID")}},[packagePolicy,updatePackagePolicyValidation]);const handleExtensionViewOnChange=Object(external_kbnSharedDeps_React_["useCallback"])(({isValid:isValid,updatedPolicy:updatedPolicy})=>{updatePackagePolicy(updatedPolicy);setFormState(prevState=>{if(prevState==="VALID"&&!isValid){return"INVALID"}return prevState})},[updatePackagePolicy]);const cancelUrl=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(routeState&&routeState.onCancelUrl){return routeState.onCancelUrl}return from==="policy"?getHref("policy_details",{policyId:agentPolicyId||policyId}):getHref("integration_details",{pkgkey:pkgkey})},[agentPolicyId,policyId,from,getHref,pkgkey,routeState]);const cancelClickHandler=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{if(routeState&&routeState.onCancelNavigateTo){ev.preventDefault();navigateToApp(...routeState.onCancelNavigateTo)}},[routeState,navigateToApp]);const savePackagePolicy=function(){var _ref2=create_package_policy_page_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var result;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setFormState("LOADING");_context2.next=3;return Object(hooks["g"])(packagePolicy);case 3:result=_context2.sent;setFormState("SUBMITTED");return _context2.abrupt("return",result);case 6:case"end":return _context2.stop()}}),_callee2)})));return function savePackagePolicy(){return _ref2.apply(this,arguments)}}();const onSubmit=function(){var _ref3=create_package_policy_page_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _yield$savePackagePol,error,data;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(!(formState==="VALID"&&hasErrors)){_context3.next=3;break}setFormState("INVALID");return _context3.abrupt("return");case 3:if(!(agentCount!==0&&formState!=="CONFIRM")){_context3.next=6;break}setFormState("CONFIRM");return _context3.abrupt("return");case 6:_context3.next=8;return savePackagePolicy();case 8:_yield$savePackagePol=_context3.sent;error=_yield$savePackagePol.error;data=_yield$savePackagePol.data;if(!error){if(routeState&&routeState.onSaveNavigateTo){navigateToApp(...typeof routeState.onSaveNavigateTo==="function"?routeState.onSaveNavigateTo(data.item):routeState.onSaveNavigateTo)}else{history.push(getPath("policy_details",{policyId:(agentPolicy===null||agentPolicy===void 0?void 0:agentPolicy.id)||policyId}))}notifications.toasts.addSuccess({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createPackagePolicy.addedNotificationTitle",{defaultMessage:"'{packagePolicyName}' integration added.",values:{packagePolicyName:packagePolicy.name}}),text:agentCount&&agentPolicy?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createPackagePolicy.addedNotificationMessage",{defaultMessage:"Fleet will deploy updates to all agents that use the '{agentPolicyName}' policy.",values:{agentPolicyName:agentPolicy.name}}):undefined,"data-test-subj":"packagePolicyCreateSuccessToast"})}else{notifications.toasts.addError(error,{title:"Error"});setFormState("VALID")}case 12:case"end":return _context3.stop()}}),_callee3)})));return function onSubmit(){return _ref3.apply(this,arguments)}}();const layoutProps={from:from,cancelUrl:cancelUrl,onCancel:cancelClickHandler,agentPolicy:agentPolicy,packageInfo:packageInfo};const stepSelectAgentPolicy=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(StepSelectAgentPolicy,{pkgkey:pkgkey,updatePackageInfo:updatePackageInfo,agentPolicy:agentPolicy,updateAgentPolicy:updateAgentPolicy,setIsLoadingSecondStep:setIsLoadingSecondStep}),[pkgkey,updatePackageInfo,agentPolicy,updateAgentPolicy]);const ExtensionView=useUIExtension((_packagePolicy$packag=(_packagePolicy$packag2=packagePolicy.package)===null||_packagePolicy$packag2===void 0?void 0:_packagePolicy$packag2.name)!==null&&_packagePolicy$packag!==void 0?_packagePolicy$packag:"","package-policy-create");const stepSelectPackage=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(StepSelectPackage,{agentPolicyId:policyId,updateAgentPolicy:updateAgentPolicy,packageInfo:packageInfo,updatePackageInfo:updatePackageInfo,setIsLoadingSecondStep:setIsLoadingSecondStep}),[policyId,updateAgentPolicy,packageInfo,updatePackageInfo]);const stepConfigurePackagePolicy=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _packagePolicy$packag3;return isLoadingSecondStep?external_kbnSharedDeps_React_default.a.createElement(Loading,null):agentPolicy&&packageInfo?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepDefinePackagePolicy,{agentPolicy:agentPolicy,packageInfo:packageInfo,packagePolicy:packagePolicy,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults}),external_kbnSharedDeps_React_default.a.createElement(StepConfigurePackagePolicy,{packageInfo:packageInfo,packagePolicy:packagePolicy,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults,submitAttempted:formState==="INVALID"}),packagePolicy.policy_id&&((_packagePolicy$packag3=packagePolicy.package)===null||_packagePolicy$packag3===void 0?void 0:_packagePolicy$packag3.name)&&ExtensionView&&external_kbnSharedDeps_React_default.a.createElement(ExtensionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(ExtensionView,{newPolicy:packagePolicy,onChange:handleExtensionViewOnChange}))):external_kbnSharedDeps_React_default.a.createElement("div",null)},[isLoadingSecondStep,agentPolicy,packageInfo,packagePolicy,updatePackagePolicy,validationResults,formState,ExtensionView,handleExtensionViewOnChange]);const steps=[from==="package"?{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createPackagePolicy.stepSelectAgentPolicyTitle",{defaultMessage:"Select an agent policy"}),children:stepSelectAgentPolicy}:{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createPackagePolicy.stepSelectPackageTitle",{defaultMessage:"Select an integration"}),children:stepSelectPackage},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.createPackagePolicy.stepConfigurePackagePolicyTitle",{defaultMessage:"Configure integration"}),status:!packageInfo||!agentPolicy||isLoadingSecondStep?"disabled":undefined,"data-test-subj":"dataCollectionSetupStep",children:stepConfigurePackagePolicy}];return external_kbnSharedDeps_React_default.a.createElement(CreatePackagePolicyPageLayout,create_package_policy_page_extends({},layoutProps,{"data-test-subj":"createPackagePolicy"}),formState==="CONFIRM"&&agentPolicy&&external_kbnSharedDeps_React_default.a.createElement(ConfirmDeployAgentPolicyModal,{agentCount:agentCount,agentPolicy:agentPolicy,onConfirm:onSubmit,onCancel:()=>setFormState("VALID")}),from==="package"?packageInfo&&external_kbnSharedDeps_React_default.a.createElement(IntegrationBreadcrumb,{pkgTitle:packageInfo.title,pkgkey:"".concat(packageInfo.name,"-").concat(packageInfo.version)}):agentPolicy&&external_kbnSharedDeps_React_default.a.createElement(PolicyBreadcrumb,{policyName:agentPolicy.name,policyId:agentPolicy.id}),external_kbnSharedDeps_React_default.a.createElement(StepsWithLessPadding,{steps:steps}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBottomBar"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},!isLoadingSecondStep&&agentPolicy&&packageInfo&&formState==="INVALID"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.errorOnSaveText",defaultMessage:"Your integration policy has errors. Please fix them before saving."}):null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{color:"ghost",href:cancelUrl,onClick:cancelClickHandler,"data-test-subj":"createPackagePolicyCancelButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.cancelButton",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:onSubmit,isLoading:formState==="LOADING",disabled:formState!=="VALID",iconType:"save",color:"primary",fill:true,"data-test-subj":"createPackagePolicySaveButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.saveButton",defaultMessage:"Save integration"}))))))))};const PolicyBreadcrumb=({policyName:policyName,policyId:policyId})=>{Object(hooks["I"])("add_integration_from_policy",{policyName:policyName,policyId:policyId});return null};const IntegrationBreadcrumb=({pkgTitle:pkgTitle,pkgkey:pkgkey})=>{Object(hooks["I"])("add_integration_to_policy",{pkgTitle:pkgTitle,pkgkey:pkgkey});return null};var epm_hooks=__webpack_require__(109);const RELEASE_BADGE_LABEL={beta:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.releaseBadge.betaLabel",{defaultMessage:"Beta"}),experimental:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.releaseBadge.experimentalLabel",{defaultMessage:"Experimental"})};const RELEASE_BADGE_DESCRIPTION={beta:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.releaseBadge.betaDescription",{defaultMessage:"This integration is not recommended for use in production environments."}),experimental:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.releaseBadge.experimentalDescription",{defaultMessage:"This integration may have breaking changes or be removed in a future release."})};function package_card_objectWithoutProperties(source,excluded){if(source==null)return{};var target=package_card_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function package_card_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const Card=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiCard"]).withConfig({displayName:"Card",componentId:"c0wp03-0"})(["color:inherit;"]);function PackageCard(_ref){let description=_ref.description,name=_ref.name,title=_ref.title,version=_ref.version,release=_ref.release,status=_ref.status,icons=_ref.icons,restProps=package_card_objectWithoutProperties(_ref,["description","name","title","version","release","status","icons"]);const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;let urlVersion=version;if("savedObject"in restProps){urlVersion=restProps.savedObject.attributes.version||version}return external_kbnSharedDeps_React_default.a.createElement(Card,{title:title||"",description:description,icon:external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{icons:icons,packageName:name,version:version,size:"xl"}),href:getHref("integration_details",{pkgkey:"".concat(name,"-").concat(urlVersion)}),betaBadgeLabel:release&&release!=="ga"?RELEASE_BADGE_LABEL[release]:undefined,betaBadgeTooltipContent:release&&release!=="ga"?RELEASE_BADGE_DESCRIPTION[release]:undefined})}function package_list_grid_slicedToArray(arr,i){return package_list_grid_arrayWithHoles(arr)||package_list_grid_iterableToArrayLimit(arr,i)||package_list_grid_unsupportedIterableToArray(arr,i)||package_list_grid_nonIterableRest()}function package_list_grid_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function package_list_grid_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return package_list_grid_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return package_list_grid_arrayLikeToArray(o,minLen)}function package_list_grid_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function package_list_grid_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function package_list_grid_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function PackageListGrid({isLoading:isLoading,controls:controls,title:title,list:list}){const initialQuery=external_kbnSharedDeps_ElasticEui_["EuiSearchBar"].Query.MATCH_ALL;const _useState=Object(external_kbnSharedDeps_React_["useState"])(initialQuery),_useState2=package_list_grid_slicedToArray(_useState,2),query=_useState2[0],setQuery=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(""),_useState4=package_list_grid_slicedToArray(_useState3,2),searchTerm=_useState4[0],setSearchTerm=_useState4[1];const localSearchRef=Object(epm_hooks["f"])(list);const onQueryChange=({query:query,queryText:userInput,error:error})=>{if(!error){setQuery(query);setSearchTerm(userInput)}};const controlsContent=external_kbnSharedDeps_React_default.a.createElement(ControlsColumn,{title:title,controls:controls});let gridContent;if(isLoading||!localSearchRef.current){gridContent=external_kbnSharedDeps_React_default.a.createElement(Loading,null)}else{const filteredList=searchTerm?list.filter(item=>localSearchRef.current.search(searchTerm).map(match=>match[epm_hooks["b"]]).includes(item[epm_hooks["b"]])):list;gridContent=external_kbnSharedDeps_React_default.a.createElement(GridColumn,{list:filteredList})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},controlsContent),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSearchBar"],{query:query||undefined,box:{placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epmList.searchPackagesPlaceholder",{defaultMessage:"Search for integrations"}),incremental:true},onChange:onQueryChange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),gridContent))}function ControlsColumn({controls:controls,title:title}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",null,title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:4},controls),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1})))}function GridColumn({list:list}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGrid"],{gutterSize:"l",columns:3},list.length?list.map(item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:"".concat(item.name,"-").concat(item.version)},external_kbnSharedDeps_React_default.a.createElement(PackageCard,item))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.epmList.noPackagesFoundPlaceholder",defaultMessage:"No packages found"})))))}function CategoryFacets({isLoading:isLoading,categories:categories,selectedCategory:selectedCategory,onCategoryChange:onCategoryChange}){const controls=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFacetGroup"],null,isLoading?external_kbnSharedDeps_React_default.a.createElement(Loading,null):categories.map(category=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFacetButton"],{isSelected:category.id===selectedCategory,key:category.id,id:category.id,quantity:category.count,onClick:()=>onCategoryChange(category)},category.title)));return controls}const HeroCopy=Object(external_kbnSharedDeps_React_["memo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s",justifyContent:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.epm.pageTitle",defaultMessage:"Integrations"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.epm.pageSubtitle",defaultMessage:"Browse integrations for popular apps and services."}))))));const Illustration=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiImage"]).withConfig({displayName:"Illustration",componentId:"jzfja-0"})(["margin-bottom:-68px;width:80%;"]);const HeroImage=Object(external_kbnSharedDeps_React_["memo"])(()=>{const _useLinks=Object(epm_hooks["e"])(),toAssets=_useLinks.toAssets;const _useStartServices=Object(hooks["mb"])(),uiSettings=_useStartServices.uiSettings;const IS_DARK_THEME=uiSettings.get("theme:darkMode");return external_kbnSharedDeps_React_default.a.createElement(Illustration,{alt:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.illustrationAltText",{defaultMessage:"Illustration of an integration"}),url:IS_DARK_THEME?toAssets("illustration_integrations_darkmode.svg"):toAssets("illustration_integrations_lightmode.svg")})});function home_slicedToArray(arr,i){return home_arrayWithHoles(arr)||home_iterableToArrayLimit(arr,i)||home_unsupportedIterableToArray(arr,i)||home_nonIterableRest()}function home_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function home_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return home_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return home_arrayLikeToArray(o,minLen)}function home_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function home_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function home_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function EPMHomePage(){const _useRouteMatch=Object(external_kbnSharedDeps_ReactRouterDom_["useRouteMatch"])(),tabId=_useRouteMatch.params.tabId;const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;return external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:external_kbnSharedDeps_React_default.a.createElement(HeroCopy,null),rightColumn:external_kbnSharedDeps_React_default.a.createElement(HeroImage,null),tabs:[{id:"all_packages",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epmList.allTabText",{defaultMessage:"All integrations"}),href:getHref("integrations_all"),isSelected:tabId!=="installed"},{id:"installed_packages",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epmList.installedTabText",{defaultMessage:"Installed integrations"}),href:getHref("integrations_installed"),isSelected:tabId==="installed"}]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].integrations_installed},external_kbnSharedDeps_React_default.a.createElement(InstalledPackages,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].integrations_all},external_kbnSharedDeps_React_default.a.createElement(AvailablePackages,null))))}function InstalledPackages(){Object(hooks["I"])("integrations_installed");const _useGetPackages=Object(hooks["bb"])({experimental:true}),allPackages=_useGetPackages.data,isLoadingPackages=_useGetPackages.isLoading;const _useState=Object(external_kbnSharedDeps_React_["useState"])(""),_useState2=home_slicedToArray(_useState,2),selectedCategory=_useState2[0],setSelectedCategory=_useState2[1];const title=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epmList.installedTitle",{defaultMessage:"Installed integrations"});const allInstalledPackages=allPackages&&allPackages.response?allPackages.response.filter(pkg=>pkg.status===common_constants["ab"].Installed):[];const updatablePackages=allInstalledPackages.filter(item=>"savedObject"in item&&item.version>item.savedObject.attributes.version);const categories=[{id:"",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epmList.allFilterLinkText",{defaultMessage:"All"}),count:allInstalledPackages.length},{id:"updates_available",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epmList.updatesAvailableFilterLinkText",{defaultMessage:"Updates available"}),count:updatablePackages.length}];const controls=external_kbnSharedDeps_React_default.a.createElement(CategoryFacets,{categories:categories,selectedCategory:selectedCategory,onCategoryChange:({id:id})=>setSelectedCategory(id)});return external_kbnSharedDeps_React_default.a.createElement(PackageListGrid,{isLoading:isLoadingPackages,controls:controls,title:title,list:selectedCategory==="updates_available"?updatablePackages:allInstalledPackages})}function AvailablePackages(){var _allPackagesRes$respo;Object(hooks["I"])("integrations_all");const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const queryParams=new URLSearchParams(Object(external_kbnSharedDeps_ReactRouterDom_["useLocation"])().search);const initialCategory=queryParams.get("category")||"";const _useState3=Object(external_kbnSharedDeps_React_["useState"])(initialCategory),_useState4=home_slicedToArray(_useState3,2),selectedCategory=_useState4[0],setSelectedCategory=_useState4[1];const _useGetPackages2=Object(hooks["bb"])(),allPackagesRes=_useGetPackages2.data,isLoadingAllPackages=_useGetPackages2.isLoading;const _useGetPackages3=Object(hooks["bb"])({category:selectedCategory}),categoryPackagesRes=_useGetPackages3.data,isLoadingCategoryPackages=_useGetPackages3.isLoading;const _useGetCategories=Object(hooks["R"])(),categoriesRes=_useGetCategories.data,isLoadingCategories=_useGetCategories.isLoading;const packages=categoryPackagesRes&&categoryPackagesRes.response?categoryPackagesRes.response:[];const title=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epmList.allTitle",{defaultMessage:"Browse by category"});const categories=[{id:"",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epmList.allPackagesFilterLinkText",{defaultMessage:"All"}),count:(allPackagesRes===null||allPackagesRes===void 0?void 0:(_allPackagesRes$respo=allPackagesRes.response)===null||_allPackagesRes$respo===void 0?void 0:_allPackagesRes$respo.length)||0},...categoriesRes?categoriesRes.response:[]];const controls=categories?external_kbnSharedDeps_React_default.a.createElement(CategoryFacets,{isLoading:isLoadingCategories||isLoadingAllPackages,categories:categories,selectedCategory:selectedCategory,onCategoryChange:({id:id})=>{if(queryParams.get("category")){history.push({})}setSelectedCategory(id)}}):null;return external_kbnSharedDeps_React_default.a.createElement(PackageListGrid,{isLoading:isLoadingCategoryPackages,title:title,controls:controls,list:packages})}var types=__webpack_require__(111);const PanelWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"PanelWrapper",componentId:"sc-1q30bo9-0"})(["width:","px;height:1px;z-index:1;"],props=>parseFloat(props.theme.eui.euiSize)*6+parseFloat(props.theme.eui.euiSizeXL)*2);const Panel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"Panel",componentId:"sc-1q30bo9-1"})(["padding:",";margin-bottom:-100%;svg,img{height:","px;width:","px;}.euiFlexItem{height:","px;justify-content:center;}"],props=>props.theme.eui.spacerSizes.xl,props=>parseFloat(props.theme.eui.euiSize)*6,props=>parseFloat(props.theme.eui.euiSize)*6,props=>parseFloat(props.theme.eui.euiSize)*6);function IconPanel({packageName:packageName,version:version,icons:icons}){const iconType=Object(hooks["ib"])({packageName:packageName,version:version,icons:icons});return external_kbnSharedDeps_React_default.a.createElement(PanelWrapper,null,external_kbnSharedDeps_React_default.a.createElement(Panel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:iconType,size:"original"})))}function LoadingIconPanel(){return external_kbnSharedDeps_React_default.a.createElement(PanelWrapper,null,external_kbnSharedDeps_React_default.a.createElement(Panel,null,external_kbnSharedDeps_React_default.a.createElement(Loading,null)))}const UpdateIcon=({size:size="m"})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.updateAvailableTooltip",{defaultMessage:"Update available"}),size:size,type:"alert",color:"warning",content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.updateAvailableTooltip",{defaultMessage:"Update available"})});const DisplayedAssets={kibana:Object.values(types["KibanaAssetType"]),elasticsearch:Object.values(types["ElasticsearchAssetType"])};const AssetTitleMap={dashboard:"Dashboard",ilm_policy:"ILM Policy",ingest_pipeline:"Ingest Pipeline",transform:"Transform",index_pattern:"Index Pattern",index_template:"Index Template",component_template:"Component Template",search:"Saved Search",visualization:"Visualization",input:"Agent input",map:"Map"};const ServiceTitleMap={elasticsearch:"Elasticsearch",kibana:"Kibana"};const AssetIcons={dashboard:"dashboardApp",index_pattern:"indexPatternApp",search:"searchProfilerApp",visualization:"visualizeApp",map:"mapApp"};const ServiceIcons={elasticsearch:"logoElasticsearch",kibana:"logoKibana"};const FirstHeaderRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FirstHeaderRow",componentId:"sc-3goe7j-0"})(["padding:0 0 "," 0;"],props=>props.theme.eui.paddingSizes.m);const HeaderRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"HeaderRow",componentId:"sc-3goe7j-1"})(["padding:"," 0;"],props=>props.theme.eui.paddingSizes.m);const FacetGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFacetGroup"]).withConfig({displayName:"FacetGroup",componentId:"sc-3goe7j-2"})(["flex-grow:0;"]);const FacetButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFacetButton"]).withConfig({displayName:"FacetButton",componentId:"sc-3goe7j-3"})(["&&&{.euiFacetButton__icon,.euiFacetButton__quantity{opacity:1;}.euiFacetButton__text{color:",";}}"],props=>props.theme.eui.euiTextColor);function AssetsFacetGroup({assets:assets}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,Object(types["entries"])(assets).map(([service,typeToParts],index)=>{const Header=index===0?FirstHeaderRow:HeaderRow;const filteredTypes=Object(types["entries"])(typeToParts).reduce((acc,[asset,value])=>{if(DisplayedAssets[service].includes(asset))acc[asset]=value;return acc},{});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:service},external_kbnSharedDeps_React_default.a.createElement(Header,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:ServiceIcons[service]})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{key:service,size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.epm.assetGroupTitle",defaultMessage:"{assetType} assets",values:{assetType:ServiceTitleMap[service]}})))))),external_kbnSharedDeps_React_default.a.createElement(FacetGroup,null,Object(types["entries"])(filteredTypes).map(([_type,parts])=>{const type=_type;const iconType=type in AssetIcons&&AssetIcons[type];const iconNode=iconType?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:iconType,size:"s"}):"";return external_kbnSharedDeps_React_default.a.createElement(FacetButton,{key:type,quantity:parts.length,icon:iconNode,isDisabled:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:"subdued"},AssetTitleMap[type]))})))}))}function layout_extends(){layout_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return layout_extends.apply(this,arguments)}function layout_objectWithoutProperties(source,excluded){if(source==null)return{};var target=layout_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function layout_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LeftColumn=_ref=>{let _ref$columnGrow=_ref.columnGrow,columnGrow=_ref$columnGrow===void 0?2:_ref$columnGrow,children=_ref.children,rest=layout_objectWithoutProperties(_ref,["columnGrow","children"]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],layout_extends({grow:columnGrow},rest),children)};const CenterColumn=_ref2=>{let _ref2$columnGrow=_ref2.columnGrow,columnGrow=_ref2$columnGrow===void 0?9:_ref2$columnGrow,children=_ref2.children,rest=layout_objectWithoutProperties(_ref2,["columnGrow","children"]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],layout_extends({grow:columnGrow},rest),children)};const RightColumn=_ref3=>{let _ref3$columnGrow=_ref3.columnGrow,columnGrow=_ref3$columnGrow===void 0?3:_ref3$columnGrow,children=_ref3.children,rest=layout_objectWithoutProperties(_ref3,["columnGrow","children"]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],layout_extends({grow:columnGrow},rest),children)};function content_collapse_slicedToArray(arr,i){return content_collapse_arrayWithHoles(arr)||content_collapse_iterableToArrayLimit(arr,i)||content_collapse_unsupportedIterableToArray(arr,i)||content_collapse_nonIterableRest()}function content_collapse_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function content_collapse_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return content_collapse_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return content_collapse_arrayLikeToArray(o,minLen)}function content_collapse_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function content_collapse_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function content_collapse_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const BottomFade=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"BottomFade",componentId:"jguib-0"})(["width:100%;background:",";margin-top:-","px;height:","px;position:absolute;"],props=>"linear-gradient(".concat(props.theme.eui.euiColorEmptyShade,"00 0%, ").concat(props.theme.eui.euiColorEmptyShade," 100%)"),props=>parseInt(props.theme.eui.spacerSizes.xl,10)*2,props=>parseInt(props.theme.eui.spacerSizes.xl,10)*2);const ContentCollapseContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ContentCollapseContainer",componentId:"jguib-1"})(["position:relative;"]);const CollapseButtonContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"CollapseButtonContainer",componentId:"jguib-2"})(["display:inline-block;background-color:",";position:absolute;left:50%;transform:translateX(-50%);top:","px;"],props=>props.theme.eui.euiColorEmptyShade,props=>parseInt(props.theme.eui.euiButtonHeight,10)/2);const CollapseButtonTop=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"]).withConfig({displayName:"CollapseButtonTop",componentId:"jguib-3"})(["float:right;"]);const CollapseButton=({open:open,toggleCollapse:toggleCollapse})=>external_kbnSharedDeps_React_default.a.createElement("div",{style:{position:"relative"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(CollapseButtonContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:toggleCollapse,iconType:"arrow".concat(open?"Up":"Down")},open?"Collapse":"Read more")));const ContentCollapse=({children:children})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=content_collapse_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])("auto"),_useState4=content_collapse_slicedToArray(_useState3,2),height=_useState4[0],setHeight=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(true),_useState6=content_collapse_slicedToArray(_useState5,2),collapsible=_useState6[0],setCollapsible=_useState6[1];const contentEl=Object(external_kbnSharedDeps_React_["useRef"])(null);const collapsedHeight=360;Object(external_kbnSharedDeps_React_["useLayoutEffect"])(()=>contentEl.current&&contentEl.current.clientHeight<collapsedHeight?setCollapsible(false):setHeight(collapsedHeight),[]);const clickOpen=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setOpen(!open)},[open]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,collapsible?external_kbnSharedDeps_React_default.a.createElement(ContentCollapseContainer,null,external_kbnSharedDeps_React_default.a.createElement("div",{ref:contentEl,style:{height:"".concat(open?"auto":"".concat(height,"px")),overflow:"hidden"}},open&&external_kbnSharedDeps_React_default.a.createElement(CollapseButtonTop,{onClick:clickOpen,iconType:"arrow".concat(open?"Up":"Down")},"Collapse"),children),!open&&external_kbnSharedDeps_React_default.a.createElement(BottomFade,null),external_kbnSharedDeps_React_default.a.createElement(CollapseButton,{open:open,toggleCollapse:clickOpen})):external_kbnSharedDeps_React_default.a.createElement("div",null,children))};const REL_NOOPENER="noopener";const REL_NOFOLLOW="nofollow";const REL_NOREFERRER="noreferrer";const markdownRenderers={root:({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{grow:true},children),table:({children:children})=>external_kbnSharedDeps_React_default.a.createElement("table",{className:"euiTable euiTable--responsive"},children),tableRow:({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTableRow"],null,children),tableCell:({isHeader:isHeader,children:children})=>isHeader?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTableHeaderCell"],null,children):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTableRowCell"],null,children),heading:({level:level,children:children})=>{switch(level){case 1:return external_kbnSharedDeps_React_default.a.createElement("h3",null,children);case 2:return external_kbnSharedDeps_React_default.a.createElement("h4",null,children);case 3:return external_kbnSharedDeps_React_default.a.createElement("h5",null,children);default:return external_kbnSharedDeps_React_default.a.createElement("h6",null,children)}},link:({children:children,href:href})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:href,target:"_blank",rel:"".concat(REL_NOOPENER," ").concat(REL_NOFOLLOW," ").concat(REL_NOREFERRER)},children),code:({language:language,value:value})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{language:language,isCopyable:true},value)};function readme_slicedToArray(arr,i){return readme_arrayWithHoles(arr)||readme_iterableToArrayLimit(arr,i)||readme_unsupportedIterableToArray(arr,i)||readme_nonIterableRest()}function readme_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function readme_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return readme_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return readme_arrayLikeToArray(o,minLen)}function readme_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function readme_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function readme_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function Readme({readmePath:readmePath,packageName:packageName,version:version}){const _useState=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState2=readme_slicedToArray(_useState,2),markdown=_useState2[0],setMarkdown=_useState2[1];const _useLinks=Object(epm_hooks["e"])(),toRelativeImage=_useLinks.toRelativeImage;const handleImageUri=external_kbnSharedDeps_React_default.a.useCallback(uri=>{const isRelative=uri.indexOf("http://")===0||uri.indexOf("https://")===0?false:true;const fullUri=isRelative?toRelativeImage({packageName:packageName,version:version,path:uri}):uri;return fullUri},[toRelativeImage,packageName,version]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{Object(hooks["m"])(readmePath).then(res=>{setMarkdown(res.data||"")})},[readmePath]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,markdown!==undefined?external_kbnSharedDeps_React_default.a.createElement(ContentCollapse,null,external_kbnSharedDeps_React_default.a.createElement(react_markdown_default.a,{transformImageUri:handleImageUri,renderers:markdownRenderers,source:markdown})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{lines:5})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{lines:6})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{lines:4}))))}function screenshots_extends(){screenshots_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return screenshots_extends.apply(this,arguments)}const getHorizontalPadding=styledProps=>parseInt(styledProps.theme.eui.paddingSizes.xl,10)*2;const getVerticalPadding=styledProps=>parseInt(styledProps.theme.eui.paddingSizes.xl,10)*1.75;const getPadding=styledProps=>styledProps.hascaption?"".concat(styledProps.theme.eui.paddingSizes.xl," ").concat(getHorizontalPadding(styledProps),"px ").concat(getVerticalPadding(styledProps),"px"):"".concat(getHorizontalPadding(styledProps),"px ").concat(getVerticalPadding(styledProps),"px");const ScreenshotsContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"ScreenshotsContainer",componentId:"sc-17p13g-0"})(["background:linear-gradient(360deg,rgba(0,0,0,0.2) 0%,rgba(0,0,0,0) 100%),",";padding:",";flex:0 0 auto;border-radius:",";"],styledProps=>styledProps.theme.eui.euiColorPrimary,styledProps=>getPadding(styledProps),styledProps=>styledProps.theme.eui.euiBorderRadius);const NestedEuiFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"NestedEuiFlexItem",componentId:"sc-17p13g-1"})(["flex:0 0 auto !important;"]);function Screenshots(props){const _useLinks=Object(epm_hooks["e"])(),toImage=_useLinks.toImage;const images=props.images;const image=images[0];const hasCaption=image.title?true:false;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.epm.screenshotsTitle",defaultMessage:"Screenshots"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(ScreenshotsContainer,screenshots_extends({gutterSize:"none",direction:"column",alignItems:"center"},hasCaption?{hascaption:"true"}:{}),hasCaption&&external_kbnSharedDeps_React_default.a.createElement(NestedEuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"ghost","aria-label":"screenshot image caption"},image.title),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),external_kbnSharedDeps_React_default.a.createElement(NestedEuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiImage"],{url:toImage(image.path||image.src),alt:"screenshot image preview",size:"l",allowFullScreen:true,style:{width:"22.5rem",maxWidth:"100%"}}))))}function overview_panel_OverviewPanel(props){const screenshots=props.screenshots,readme=props.readme,name=props.name,version=props.version;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,readme&&external_kbnSharedDeps_React_default.a.createElement(Readme,{readmePath:readme,packageName:name,version:version}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xl"}),screenshots&&external_kbnSharedDeps_React_default.a.createElement(Screenshots,{images:screenshots}))}var use_request=__webpack_require__(118);var use_request_use_request=__webpack_require__(21);var common_services=__webpack_require__(27);function use_package_policies_with_agent_policy_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_package_policies_with_agent_policy_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_package_policies_with_agent_policy_ownKeys(Object(source),true).forEach((function(key){use_package_policies_with_agent_policy_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_package_policies_with_agent_policy_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_package_policies_with_agent_policy_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_package_policies_with_agent_policy_createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=use_package_policies_with_agent_policy_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function use_package_policies_with_agent_policy_slicedToArray(arr,i){return use_package_policies_with_agent_policy_arrayWithHoles(arr)||use_package_policies_with_agent_policy_iterableToArrayLimit(arr,i)||use_package_policies_with_agent_policy_unsupportedIterableToArray(arr,i)||use_package_policies_with_agent_policy_nonIterableRest()}function use_package_policies_with_agent_policy_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_package_policies_with_agent_policy_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_package_policies_with_agent_policy_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_package_policies_with_agent_policy_arrayLikeToArray(o,minLen)}function use_package_policies_with_agent_policy_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_package_policies_with_agent_policy_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_package_policies_with_agent_policy_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const usePackagePoliciesWithAgentPolicy=query=>{const _useGetPackagePolicie=Object(use_request["R"])(query),packagePoliciesData=_useGetPackagePolicie.data,error=_useGetPackagePolicie.error,isLoadingPackagePolicies=_useGetPackagePolicie.isLoading;const agentPoliciesFilter=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(!(packagePoliciesData===null||packagePoliciesData===void 0?void 0:packagePoliciesData.items.length)){return""}const includedAgentPolicies=new Set;return"".concat(common_constants["j"],".package_policies: (").concat(packagePoliciesData.items.filter(packagePolicy=>{if(includedAgentPolicies.has(packagePolicy.policy_id)){return false}includedAgentPolicies.add(packagePolicy.policy_id);return true}).map(packagePolicy=>packagePolicy.id).join(" or "),") ")},[packagePoliciesData]);const _useConditionalReques=Object(use_request_use_request["c"])({path:common_services["c"].getListPath(),method:"get",query:{perPage:100,kuery:agentPoliciesFilter},shouldSendRequest:!!(packagePoliciesData===null||packagePoliciesData===void 0?void 0:packagePoliciesData.items.length)}),agentPoliciesData=_useConditionalReques.data,isLoadingAgentPolicies=_useConditionalReques.isLoading;const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=use_package_policies_with_agent_policy_slicedToArray(_useState,2),enrichedData=_useState2[0],setEnrichedData=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isLoadingPackagePolicies||isLoadingAgentPolicies){return}if(!(packagePoliciesData===null||packagePoliciesData===void 0?void 0:packagePoliciesData.items)){setEnrichedData(undefined);return}const agentPoliciesById={};if(agentPoliciesData===null||agentPoliciesData===void 0?void 0:agentPoliciesData.items){var _iterator=use_package_policies_with_agent_policy_createForOfIteratorHelper(agentPoliciesData.items),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){const agentPolicy=_step.value;agentPoliciesById[agentPolicy.id]=agentPolicy}}catch(err){_iterator.e(err)}finally{_iterator.f()}}const updatedPackageData=packagePoliciesData.items.map(packagePolicy=>({packagePolicy:packagePolicy,agentPolicy:agentPoliciesById[packagePolicy.policy_id]}));setEnrichedData(use_package_policies_with_agent_policy_objectSpread(use_package_policies_with_agent_policy_objectSpread({},packagePoliciesData),{},{items:updatedPackageData}))},[isLoadingAgentPolicies,isLoadingPackagePolicies,packagePoliciesData,agentPoliciesData]);return{data:enrichedData,error:error,isLoading:isLoadingPackagePolicies||isLoadingAgentPolicies}};function persona_extends(){persona_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return persona_extends.apply(this,arguments)}function persona_objectWithoutProperties(source,excluded){if(source==null)return{};var target=persona_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function persona_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const persona_MIN_WIDTH={minWidth:0};const Persona=Object(external_kbnSharedDeps_React_["memo"])(_ref=>{let name=_ref.name,className=_ref.className,dataTestSubj=_ref["data-test-subj"],title=_ref.title,otherAvatarProps=persona_objectWithoutProperties(_ref,["name","className","data-test-subj","title"]);const getTestId=Object(external_kbnSharedDeps_React_["useCallback"])(suffix=>{if(dataTestSubj){return"".concat(dataTestSubj,"-").concat(suffix)}},[dataTestSubj]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"baseline",style:persona_MIN_WIDTH,className:className,"data-test-subj":dataTestSubj,title:title,responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAvatar"],persona_extends({name:name,"data-test-subj":getTestId("avatar")},otherAvatarProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",className:"eui-textTruncate","data-test-subj":getTestId("name")},name)))});const IntegrationDetailsLink=Object(external_kbnSharedDeps_React_["memo"])(({packagePolicy:packagePolicy})=>{const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{className:"eui-textTruncate",href:getHref("edit_integration",{policyId:packagePolicy.policy_id,packagePolicyId:packagePolicy.id})},packagePolicy.name)});const AgentPolicyDetailLink=Object(external_kbnSharedDeps_React_["memo"])(({agentPolicyId:agentPolicyId,revision:revision,children:children})=>{const _useLink2=Object(hooks["hb"])(),getHref=_useLink2.getHref;return external_kbnSharedDeps_React_default.a.createElement(LinkAndRevision,{className:"eui-textTruncate",revision:revision,href:getHref("policy_details",{policyId:agentPolicyId})},children)});const PolicyAgentListLink=Object(external_kbnSharedDeps_React_["memo"])(({agentPolicyId:agentPolicyId,children:children})=>{const _useLink3=Object(hooks["hb"])(),getHref=_useLink3.getHref;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{className:"eui-textTruncate",href:getHref("fleet_agent_list",{kuery:"".concat(common_constants["o"],".policy_id:%20").concat(agentPolicyId)})},children)});const PackagePoliciesPanel=({name:name,version:version})=>{var _data$total;const _useLink4=Object(hooks["hb"])(),getPath=_useLink4.getPath;const getPackageInstallStatus=Object(epm_hooks["c"])();const packageInstallStatus=getPackageInstallStatus(name);const _useUrlPagination=Object(hooks["nb"])(),pagination=_useUrlPagination.pagination,pageSizeOptions=_useUrlPagination.pageSizeOptions,setPagination=_useUrlPagination.setPagination;const _usePackagePoliciesWi=usePackagePoliciesWithAgentPolicy({page:pagination.currentPage,perPage:pagination.pageSize,kuery:"".concat(common_constants["R"],".package.name: ").concat(name)}),data=_usePackagePoliciesWi.data;const handleTableOnChange=Object(external_kbnSharedDeps_React_["useCallback"])(({page:page})=>{setPagination({currentPage:page.index+1,pageSize:page.size})},[setPagination]);const columns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{field:"packagePolicy.name",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.packageDetails.integrationList.name",{defaultMessage:"Integration"}),render(_,{packagePolicy:packagePolicy}){return external_kbnSharedDeps_React_default.a.createElement(IntegrationDetailsLink,{packagePolicy:packagePolicy})}},{field:"packagePolicy.description",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.packageDetails.integrationList.description",{defaultMessage:"Description"}),truncateText:true},{field:"packagePolicy.policy_id",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.packageDetails.integrationList.agentPolicy",{defaultMessage:"Agent policy"}),truncateText:true,render(id,{agentPolicy:agentPolicy}){var _agentPolicy$name;return external_kbnSharedDeps_React_default.a.createElement(AgentPolicyDetailLink,{agentPolicyId:id,revision:agentPolicy.revision},(_agentPolicy$name=agentPolicy.name)!==null&&_agentPolicy$name!==void 0?_agentPolicy$name:id)}},{field:"",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.packageDetails.integrationList.agentCount",{defaultMessage:"Agents"}),truncateText:true,align:"right",width:"8ch",render({packagePolicy:packagePolicy,agentPolicy:agentPolicy}){var _agentPolicy$agents;return external_kbnSharedDeps_React_default.a.createElement(PolicyAgentListLink,{agentPolicyId:packagePolicy.policy_id},(_agentPolicy$agents=agentPolicy===null||agentPolicy===void 0?void 0:agentPolicy.agents)!==null&&_agentPolicy$agents!==void 0?_agentPolicy$agents:0)}},{field:"packagePolicy.updated_by",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.packageDetails.integrationList.updatedBy",{defaultMessage:"Last Updated By"}),truncateText:true,render(updatedBy){return external_kbnSharedDeps_React_default.a.createElement(Persona,{size:"s",name:updatedBy,title:updatedBy})}},{field:"packagePolicy.updated_at",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.packageDetails.integrationList.updatedAt",{defaultMessage:"Last Updated"}),truncateText:true,render(updatedAt){return external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{value:updatedAt}))}}],[]);if(packageInstallStatus.status!==types["InstallStatus"].installed){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:getPath("integration_details",{pkgkey:"".concat(name,"-").concat(version)})})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{items:(data===null||data===void 0?void 0:data.items)||[],columns:columns,loading:false,"data-test-subj":"integrationPolicyTable",pagination:{pageIndex:pagination.currentPage-1,pageSize:pagination.pageSize,totalItemCount:(_data$total=data===null||data===void 0?void 0:data.total)!==null&&_data$total!==void 0?_data$total:0,pageSizeOptions:pageSizeOptions},onChange:handleTableOnChange})};const ConfirmPackageUninstall=props=>{const onCancel=props.onCancel,onConfirm=props.onConfirm,packageName=props.packageName,numOfAssets=props.numOfAssets;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallTitle",defaultMessage:"Uninstall {packageName}",values:{packageName:packageName}}),onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmUninstallModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallButtonLabel",defaultMessage:"Uninstall {packageName}",values:{packageName:packageName}}),defaultFocusedButton:"confirm",buttonColor:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallCallout.title",defaultMessage:"This action will remove {numOfAssets} assets",values:{numOfAssets:numOfAssets}})},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallCallout.description",defaultMessage:"Kibana and Elasticsearch assets that were created by this integration will be removed. Agents policies and any data sent by your agents will not be effected."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallDescription",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"}))))};const ConfirmPackageInstall=props=>{const onCancel=props.onCancel,onConfirm=props.onConfirm,packageName=props.packageName,numOfAssets=props.numOfAssets;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmInstallModal.installTitle",defaultMessage:"Install {packageName}",values:{packageName:packageName}}),onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmInstallModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmInstallModal.installButtonLabel",defaultMessage:"Install {packageName}",values:{packageName:packageName}}),defaultFocusedButton:"confirm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{iconType:"iInCircle",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmInstallModal.installCalloutTitle",defaultMessage:"This action will install {numOfAssets} assets",values:{numOfAssets:numOfAssets}})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.confirmInstallModal.installDescription",defaultMessage:"Kibana assets will be installed in the current Space (Default) and will only be accessible to users who have permission to view this Space. Elasticsearch assets are installed globally and will be accessible to all Kibana users."}))))};function installation_button_slicedToArray(arr,i){return installation_button_arrayWithHoles(arr)||installation_button_iterableToArrayLimit(arr,i)||installation_button_unsupportedIterableToArray(arr,i)||installation_button_nonIterableRest()}function installation_button_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function installation_button_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return installation_button_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return installation_button_arrayLikeToArray(o,minLen)}function installation_button_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function installation_button_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function installation_button_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function InstallationButton(props){const assets=props.assets,name=props.name,title=props.title,version=props.version,_props$disabled=props.disabled,disabled=_props$disabled===void 0?true:_props$disabled,_props$isUpdate=props.isUpdate,isUpdate=_props$isUpdate===void 0?false:_props$isUpdate;const hasWriteCapabilites=Object(hooks["J"])().write;const installPackage=Object(epm_hooks["d"])();const uninstallPackage=Object(epm_hooks["h"])();const getPackageInstallStatus=Object(epm_hooks["c"])();const _getPackageInstallSta=getPackageInstallStatus(name),installationStatus=_getPackageInstallSta.status;const isInstalling=installationStatus===types["InstallStatus"].installing;const isRemoving=installationStatus===types["InstallStatus"].uninstalling;const isInstalled=installationStatus===types["InstallStatus"].installed;const showUninstallButton=isInstalled||isRemoving;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=installation_button_slicedToArray(_useState,2),isModalVisible=_useState2[0],setModalVisible=_useState2[1];const toggleModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setModalVisible(!isModalVisible)},[isModalVisible]);const handleClickInstall=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{installPackage({name:name,version:version,title:title});toggleModal()},[installPackage,name,title,toggleModal,version]);const handleClickUpdate=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{installPackage({name:name,version:version,title:title,fromUpdate:true})},[installPackage,name,title,version]);const handleClickUninstall=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{uninstallPackage({name:name,version:version,title:title});toggleModal()},[uninstallPackage,name,title,toggleModal,version]);const numOfAssets=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object.entries(assets).reduce((acc,[serviceName,serviceNameValue])=>acc+Object.entries(serviceNameValue).reduce((acc2,[assetName,assetNameValue])=>acc2+assetNameValue.length,0),0),[assets]);const installButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"importAction",isLoading:isInstalling,onClick:toggleModal},isInstalling?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.installPackage.installingPackageButtonLabel",defaultMessage:"Installing {title} assets",values:{title:title}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.installPackage.installPackageButtonLabel",defaultMessage:"Install {title} assets",values:{title:title}}));const updateButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"refresh",isLoading:isInstalling,onClick:handleClickUpdate},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.updatePackage.updatePackageButtonLabel",defaultMessage:"Update to latest version"}));const uninstallButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"trash",isLoading:isRemoving,onClick:toggleModal,color:"danger",disabled:disabled||isRemoving?true:false},isRemoving?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.uninstallPackage.uninstallingPackageButtonLabel",defaultMessage:"Uninstalling {title}",values:{title:title}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.uninstallPackage.uninstallPackageButtonLabel",defaultMessage:"Uninstall {title}",values:{title:title}}));const uninstallModal=external_kbnSharedDeps_React_default.a.createElement(ConfirmPackageUninstall,{numOfAssets:numOfAssets,packageName:title,onCancel:toggleModal,onConfirm:handleClickUninstall});const installModal=external_kbnSharedDeps_React_default.a.createElement(ConfirmPackageInstall,{numOfAssets:numOfAssets,packageName:title,onCancel:toggleModal,onConfirm:handleClickInstall});return hasWriteCapabilites?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,isUpdate?updateButton:showUninstallButton?uninstallButton:installButton,isModalVisible&&(isInstalled?uninstallModal:installModal)):null}function settings_panel_extends(){settings_panel_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return settings_panel_extends.apply(this,arguments)}const SettingsTitleCell=external_kbnSharedDeps_StyledComponents_default.a.td.withConfig({displayName:"SettingsTitleCell",componentId:"sc-12a58nm-0"})(["padding-right:",";padding-bottom:",";"],props=>props.theme.eui.spacerSizes.xl,props=>props.theme.eui.spacerSizes.m);const UpdatesAvailableMsgContainer=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"UpdatesAvailableMsgContainer",componentId:"sc-12a58nm-1"})(["padding-left:",";"],props=>props.theme.eui.spacerSizes.s);const NoteLabel=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.packageUninstallNoteDescription.packageUninstallNoteLabel",defaultMessage:"Note:"});const UpdatesAvailableMsg=()=>external_kbnSharedDeps_React_default.a.createElement(UpdatesAvailableMsgContainer,null,external_kbnSharedDeps_React_default.a.createElement(UpdateIcon,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.versionInfo.updatesAvailable",defaultMessage:"Updates are available"}));const SettingsPanel=props=>{const name=props.name,title=props.title,removable=props.removable,latestVersion=props.latestVersion,version=props.version;const getPackageInstallStatus=Object(epm_hooks["c"])();const _useGetPackagePolicie=Object(hooks["ab"])({perPage:0,page:1,kuery:"".concat(constants["g"],".package.name:").concat(props.name)}),packagePoliciesData=_useGetPackagePolicie.data;const _getPackageInstallSta=getPackageInstallStatus(name),installationStatus=_getPackageInstallSta.status,installedVersion=_getPackageInstallSta.version;const packageHasUsages=!!(packagePoliciesData===null||packagePoliciesData===void 0?void 0:packagePoliciesData.total);const updateAvailable=installedVersion&&installedVersion<latestVersion?true:false;const isViewingOldPackage=version<latestVersion;const hideInstallOptions=installationStatus===types["InstallStatus"].notInstalled&&isViewingOldPackage||installationStatus===types["InstallStatus"].installed&&installedVersion!==version;const isUpdating=installationStatus===types["InstallStatus"].installing&&installedVersion;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],null,external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.packageSettingsTitle",defaultMessage:"Settings"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),installedVersion!==null&&external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.packageVersionTitle",defaultMessage:"{title} version",values:{title:title}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("table",null,external_kbnSharedDeps_React_default.a.createElement("tbody",null,external_kbnSharedDeps_React_default.a.createElement("tr",null,external_kbnSharedDeps_React_default.a.createElement(SettingsTitleCell,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.versionInfo.installedVersion",defaultMessage:"Installed version"})),external_kbnSharedDeps_React_default.a.createElement("td",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("span",null,installedVersion)),updateAvailable&&external_kbnSharedDeps_React_default.a.createElement(UpdatesAvailableMsg,null))),external_kbnSharedDeps_React_default.a.createElement("tr",null,external_kbnSharedDeps_React_default.a.createElement(SettingsTitleCell,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.versionInfo.latestVersion",defaultMessage:"Latest version"})),external_kbnSharedDeps_React_default.a.createElement("td",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("span",null,latestVersion)))))),updateAvailable&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(InstallationButton,settings_panel_extends({},props,{version:latestVersion,disabled:false,isUpdate:true})))),!hideInstallOptions&&!isUpdating&&external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),installationStatus===types["InstallStatus"].notInstalled||installationStatus===types["InstallStatus"].installing?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.packageInstallTitle",defaultMessage:"Install {title}",values:{title:title}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.packageInstallDescription",defaultMessage:"Install this integration to setup Kibana and Elasticsearch assets designed for {title} data.",values:{title:title}}))):external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.packageUninstallTitle",defaultMessage:"Uninstall {title}",values:{title:title}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.packageUninstallDescription",defaultMessage:"Remove Kibana and Elasticsearch assets that were installed by this integration."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(InstallationButton,settings_panel_extends({},props,{disabled:!packagePoliciesData||removable===false?true:packageHasUsages}))))),packageHasUsages&&removable===true&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.packageUninstallNoteDescription.packageUninstallNoteDetail",defaultMessage:"{strongNote} {title} cannot be uninstalled because there are active agents that use this integration. To uninstall, remove all {title} integrations from your agent policies.",values:{title:title,strongNote:external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(NoteLabel,null))}})),removable===false&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.integrations.settings.packageUninstallNoteDescription.packageUninstallUninstallableNoteDetail",defaultMessage:"{strongNote} The {title} integration is installed by default and cannot be removed.",values:{title:title,strongNote:external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(NoteLabel,null))}}))))};const LeftSideColumn=external_kbnSharedDeps_StyledComponents_default()(LeftColumn).withConfig({displayName:"LeftSideColumn",componentId:"bws6xd-0"})(["&&&{margin-top:77px;}"]);const ContentFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"ContentFlexGroup",componentId:"bws6xd-1"})(["flex:0 0 auto !important;"]);function Content(props){const showRightColumn=props.panel!=="policies";return external_kbnSharedDeps_React_default.a.createElement(ContentFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(LeftSideColumn,!showRightColumn?{columnGrow:1}:undefined),external_kbnSharedDeps_React_default.a.createElement(CenterColumn,!showRightColumn?{columnGrow:6}:undefined,external_kbnSharedDeps_React_default.a.createElement(ContentPanel,props)),showRightColumn&&external_kbnSharedDeps_React_default.a.createElement(RightColumn,null,external_kbnSharedDeps_React_default.a.createElement(RightColumnContent,props)))}function ContentPanel(props){const panel=props.panel,name=props.name,version=props.version,assets=props.assets,title=props.title,removable=props.removable,latestVersion=props.latestVersion;switch(panel){case"settings":return external_kbnSharedDeps_React_default.a.createElement(SettingsPanel,{name:name,version:version,assets:assets,title:title,removable:removable,latestVersion:latestVersion});case"policies":return external_kbnSharedDeps_React_default.a.createElement(PackagePoliciesPanel,{name:name,version:version});case"overview":default:return external_kbnSharedDeps_React_default.a.createElement(overview_panel_OverviewPanel,props)}}function RightColumnContent(props){const assets=props.assets,panel=props.panel;switch(panel){case"overview":return assets?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AssetsFacetGroup,{assets:assets}))):null;default:return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)}}var detail=__webpack_require__(262);function detail_extends(){detail_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return detail_extends.apply(this,arguments)}function detail_slicedToArray(arr,i){return detail_arrayWithHoles(arr)||detail_iterableToArrayLimit(arr,i)||detail_unsupportedIterableToArray(arr,i)||detail_nonIterableRest()}function detail_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function detail_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return detail_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return detail_arrayLikeToArray(o,minLen)}function detail_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function detail_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function detail_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const DEFAULT_PANEL="overview";const PanelDisplayNames={overview:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.packageDetailsNav.overviewLinkText",{defaultMessage:"Overview"}),policies:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.packageDetailsNav.packagePoliciesLinkText",{defaultMessage:"Policies"}),settings:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.packageDetailsNav.settingsLinkText",{defaultMessage:"Settings"})};const Divider=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Divider",componentId:"sc-9vnm9c-0"})(["width:0;height:100%;border-left:",";"],props=>props.theme.eui.euiBorderThin);const FlexItemWithMinWidth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItemWithMinWidth",componentId:"sc-9vnm9c-1"})(["min-width:0px;"]);function Breadcrumbs({packageTitle:packageTitle}){Object(hooks["I"])("integration_details",{pkgTitle:packageTitle});return null}function Detail(){var _packageInfoData$resp;const _ref=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])(),pkgkey=_ref.pkgkey,_ref$panel=_ref.panel,panel=_ref$panel===void 0?DEFAULT_PANEL:_ref$panel;const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const hasWriteCapabilites=Object(hooks["J"])().write;const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=detail_slicedToArray(_useState,2),packageInfo=_useState2[0],setPackageInfo=_useState2[1];const setPackageInstallStatus=Object(epm_hooks["g"])();const updateAvailable=packageInfo&&"savedObject"in packageInfo&&packageInfo.savedObject&&packageInfo.savedObject.attributes.version<packageInfo.latestVersion;const _useGetPackageInfoByK=Object(hooks["Z"])(pkgkey),packageInfoData=_useGetPackageInfoByK.data,packageInfoError=_useGetPackageInfoByK.error,isLoading=_useGetPackageInfoByK.isLoading;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(packageInfoData===null||packageInfoData===void 0?void 0:packageInfoData.response){const packageInfoResponse=packageInfoData.response;setPackageInfo(packageInfoResponse);let installedVersion;const name=packageInfoData.response.name;if("savedObject"in packageInfoResponse){installedVersion=packageInfoResponse.savedObject.attributes.version}const status=packageInfoResponse===null||packageInfoResponse===void 0?void 0:packageInfoResponse.status;if(name){setPackageInstallStatus({name:name,status:status,version:installedVersion||null})}}},[packageInfoData,setPackageInstallStatus,setPackageInfo]);const headerLeftContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"arrowLeft",size:"xs",flush:"left",href:getHref("integrations_all")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.epm.browseAllButtonText",defaultMessage:"Browse all integrations"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},isLoading||!packageInfo?external_kbnSharedDeps_React_default.a.createElement(LoadingIconPanel,null):external_kbnSharedDeps_React_default.a.createElement(IconPanel,{packageName:packageInfo.name,version:packageInfo.version,icons:packageInfo.icons})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m",className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(FlexItemWithMinWidth,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h1",{className:"eui-textTruncate"},(packageInfo===null||packageInfo===void 0?void 0:packageInfo.title)||" "))),(packageInfo===null||packageInfo===void 0?void 0:packageInfo.release)&&packageInfo.release!=="ga"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBetaBadge"],{label:RELEASE_BADGE_LABEL[packageInfo.release],tooltipContent:RELEASE_BADGE_DESCRIPTION[packageInfo.release]})):null))))),[getHref,isLoading,packageInfo]);const headerRightContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>packageInfo?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd",direction:"row"},[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.epm.versionLabel",{defaultMessage:"Version"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,packageInfo.version),updateAvailable?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UpdateIcon,null)):null)},{isDivider:true},{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,isDisabled:!hasWriteCapabilites,iconType:"plusInCircle",href:getHref("add_integration_to_policy",{pkgkey:pkgkey})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.epm.addPackagePolicyButtonText",defaultMessage:"Add {packageName}",values:{packageName:packageInfo.title}}))}].map((item,index)=>{var _item$isDivider;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:index},((_item$isDivider=item.isDivider)!==null&&_item$isDivider!==void 0?_item$isDivider:false)?external_kbnSharedDeps_React_default.a.createElement(Divider,null):item.label?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{className:"eui-textRight",compressed:true,textStyle:"reverse"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,item.label),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,item.content)):item.content)}))):undefined,[getHref,hasWriteCapabilites,packageInfo,pkgkey,updateAvailable]);const tabs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(!packageInfo){return[]}return Object(types["entries"])(PanelDisplayNames).filter(([panelId])=>panelId!=="policies"||(packageInfoData===null||packageInfoData===void 0?void 0:packageInfoData.response.status)===types["InstallStatus"].installed).map(([panelId,display])=>({id:panelId,name:display,isSelected:panelId===panel,href:getHref("integration_details",{pkgkey:"".concat(packageInfo===null||packageInfo===void 0?void 0:packageInfo.name,"-").concat(packageInfo===null||packageInfo===void 0?void 0:packageInfo.version),panel:panelId})}))},[getHref,packageInfo,packageInfoData===null||packageInfoData===void 0?void 0:(_packageInfoData$resp=packageInfoData.response)===null||_packageInfoData$resp===void 0?void 0:_packageInfoData$resp.status,panel]);return external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:headerLeftContent,rightColumn:headerRightContent,rightColumnGrow:false,tabs:tabs,tabsClassName:"fleet__epm__shiftNavTabs"},packageInfo?external_kbnSharedDeps_React_default.a.createElement(Breadcrumbs,{packageTitle:packageInfo.title}):null,packageInfoError?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.epm.loadingIntegrationErrorTitle",defaultMessage:"Error loading integration details"}),error:packageInfoError}):isLoading||!packageInfo?external_kbnSharedDeps_React_default.a.createElement(Loading,null):external_kbnSharedDeps_React_default.a.createElement(Content,detail_extends({},packageInfo,{panel:panel})))}const EPMApp=()=>{Object(hooks["I"])("integrations");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["HashRouter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].add_integration_to_policy},external_kbnSharedDeps_React_default.a.createElement(CreatePackagePolicyPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].integration_details},external_kbnSharedDeps_React_default.a.createElement(Detail,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].integrations},external_kbnSharedDeps_React_default.a.createElement(EPMHomePage,null))))};function list_page_objectWithoutProperties(source,excluded){if(source==null)return{};var target=list_page_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function list_page_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function list_page_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function list_page_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){list_page_ownKeys(Object(source),true).forEach((function(key){list_page_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{list_page_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function list_page_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function list_page_slicedToArray(arr,i){return list_page_arrayWithHoles(arr)||list_page_iterableToArrayLimit(arr,i)||list_page_unsupportedIterableToArray(arr,i)||list_page_nonIterableRest()}function list_page_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function list_page_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return list_page_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return list_page_arrayLikeToArray(o,minLen)}function list_page_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function list_page_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function list_page_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AgentPolicyListPageLayout=({children:children})=>external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyList.pageTitle",defaultMessage:"Agent policies"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyList.pageSubtitle",defaultMessage:"Use agent policies to manage your agents and the data they collect."})))))},children);const AgentPolicyListPage=()=>{var _urlParams$kuery,_agentPolicyData$tota;Object(hooks["I"])("policies_list");const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref,getPath=_useLink.getPath;const hasWriteCapabilites=Object(hooks["J"])().write;const _useConfig=Object(hooks["L"])(),isFleetEnabled=_useConfig.agents.enabled;const _useUrlParams=Object(hooks["ob"])(),urlParams=_useUrlParams.urlParams,toUrlParams=_useUrlParams.toUrlParams;const _useState=Object(external_kbnSharedDeps_React_["useState"])(Array.isArray(urlParams.kuery)?urlParams.kuery[urlParams.kuery.length-1]:(_urlParams$kuery=urlParams.kuery)!==null&&_urlParams$kuery!==void 0?_urlParams$kuery:""),_useState2=list_page_slicedToArray(_useState,2),search=_useState2[0],setSearch=_useState2[1];const _usePagination=Object(hooks["jb"])(),pagination=_usePagination.pagination,pageSizeOptions=_usePagination.pageSizeOptions,setPagination=_usePagination.setPagination;const _useSorting=Object(hooks["lb"])({field:"updated_at",direction:"desc"}),sorting=_useSorting.sorting,setSorting=_useSorting.setSorting;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const isCreateAgentPolicyFlyoutOpen="create"in urlParams;const setIsCreateAgentPolicyFlyoutOpen=Object(external_kbnSharedDeps_React_["useCallback"])(isOpen=>{if(isOpen!==isCreateAgentPolicyFlyoutOpen){if(isOpen){history.push("".concat(getPath("policies_list"),"?").concat(toUrlParams(list_page_objectSpread(list_page_objectSpread({},urlParams),{},{create:null}))))}else{const create=urlParams.create,params=list_page_objectWithoutProperties(urlParams,["create"]);history.push("".concat(getPath("policies_list"),"?").concat(toUrlParams(params)))}}},[getPath,history,isCreateAgentPolicyFlyoutOpen,toUrlParams,urlParams]);const _useGetAgentPolicies=Object(hooks["O"])({page:pagination.currentPage,perPage:pagination.pageSize,sortField:sorting===null||sorting===void 0?void 0:sorting.field,sortOrder:sorting===null||sorting===void 0?void 0:sorting.direction,kuery:search}),isLoading=_useGetAgentPolicies.isLoading,agentPolicyData=_useGetAgentPolicies.data,resendRequest=_useGetAgentPolicies.resendRequest;const columns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const cols=[{field:"name",sortable:true,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyList.nameColumnTitle",{defaultMessage:"Name"}),width:"20%",render:(name,agentPolicy)=>external_kbnSharedDeps_React_default.a.createElement(LinkAndRevision,{href:getHref("policy_details",{policyId:agentPolicy.id}),title:name||agentPolicy.id,revision:agentPolicy.revision},name||agentPolicy.id)},{field:"description",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyList.descriptionColumnTitle",{defaultMessage:"Description"}),width:"35%",render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:"subdued",className:"eui-textTruncate",title:value},value)},{field:"updated_at",sortable:true,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyList.updatedOnColumnTitle",{defaultMessage:"Last updated on"}),render:date=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedDate"],{value:date,year:"numeric",month:"short",day:"2-digit"})},{field:"agents",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyList.agentsColumnTitle",{defaultMessage:"Agents"}),dataType:"number",render:(agents,agentPolicy)=>external_kbnSharedDeps_React_default.a.createElement(LinkedAgentCount,{count:agents,agentPolicyId:agentPolicy.id})},{field:"package_policies",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyList.packagePoliciesCountColumnTitle",{defaultMessage:"Integrations"}),dataType:"number",render:packagePolicies=>packagePolicies?packagePolicies.length:0},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentPolicyList.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:agentPolicy=>external_kbnSharedDeps_React_default.a.createElement(AgentPolicyActionMenu,{agentPolicy:agentPolicy,onCopySuccess:()=>resendRequest()})}]}];if(!isFleetEnabled){return cols.filter(col=>"field"in col?col.field!=="agents":true)}return cols},[getHref,isFleetEnabled,resendRequest]);const createAgentPolicyButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,iconType:"plusInCircle",isDisabled:!hasWriteCapabilites,onClick:()=>setIsCreateAgentPolicyFlyoutOpen(true)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyList.addButton",defaultMessage:"Create agent policy"})),[hasWriteCapabilites,setIsCreateAgentPolicyFlyoutOpen]);const emptyPrompt=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyList.noAgentPoliciesPrompt",defaultMessage:"No agent policies"})),actions:createAgentPolicyButton}),[createAgentPolicyButton]);const onTableChange=criteria=>{const newPagination=list_page_objectSpread(list_page_objectSpread({},pagination),{},{currentPage:criteria.page.index+1,pageSize:criteria.page.size});setPagination(newPagination);setSorting(criteria.sort)};return external_kbnSharedDeps_React_default.a.createElement(AgentPolicyListPageLayout,null,isCreateAgentPolicyFlyoutOpen?external_kbnSharedDeps_React_default.a.createElement(CreateAgentPolicyFlyout,{onClose:()=>{setIsCreateAgentPolicyFlyoutOpen(false);resendRequest()}}):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:4},external_kbnSharedDeps_React_default.a.createElement(SearchBar,{value:search,onChange:newSearch=>{setPagination(list_page_objectSpread(list_page_objectSpread({},pagination),{},{currentPage:1}));setSearch(newSearch)},fieldPrefix:constants["b"]})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"primary",iconType:"refresh",onClick:()=>resendRequest()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyList.reloadAgentPoliciesButtonText",defaultMessage:"Reload"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},createAgentPolicyButton)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{loading:isLoading,hasActions:true,noItemsMessage:isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyList.loadingAgentPoliciesMessage",defaultMessage:"Loading agent policies…"}):!search.trim()&&((_agentPolicyData$tota=agentPolicyData===null||agentPolicyData===void 0?void 0:agentPolicyData.total)!==null&&_agentPolicyData$tota!==void 0?_agentPolicyData$tota:0)===0?emptyPrompt:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyList.noFilteredAgentPoliciesPrompt",defaultMessage:"No agent policies found. {clearFiltersLink}",values:{clearFiltersLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{onClick:()=>setSearch("")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentPolicyList.clearFiltersLinkText",defaultMessage:"Clear filters"}))}}),items:agentPolicyData?agentPolicyData.items:[],itemId:"id",columns:columns,isSelectable:false,pagination:{pageIndex:pagination.currentPage-1,pageSize:pagination.pageSize,totalItemCount:agentPolicyData?agentPolicyData.total:0,pageSizeOptions:pageSizeOptions},sorting:{sort:sorting},onChange:onTableChange}))};function use_agent_status_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_agent_status_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_agent_status_ownKeys(Object(source),true).forEach((function(key){use_agent_status_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_agent_status_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_agent_status_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function useGetAgentStatus(policyId,options){const agentStatusRequest=Object(hooks["kb"])(use_agent_status_objectSpread({path:services["c"].getStatusPath(),query:{policyId:policyId},method:"get"},options));return{isLoading:agentStatusRequest.isLoading,data:agentStatusRequest.data,error:agentStatusRequest.error,refreshAgentStatus:()=>agentStatusRequest.resendRequest}}const AgentStatusRefreshContext=external_kbnSharedDeps_React_default.a.createContext({refresh:()=>{}});function useAgentStatusRefresh(){return external_kbnSharedDeps_React_default.a.useContext(AgentStatusRefreshContext).refresh}const AgentPolicyRefreshContext=external_kbnSharedDeps_React_default.a.createContext({refresh:()=>{}});function useAgentPolicyRefresh(){return external_kbnSharedDeps_React_default.a.useContext(AgentPolicyRefreshContext).refresh}function package_policies_table_extends(){package_policies_table_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return package_policies_table_extends.apply(this,arguments)}function package_policies_table_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function package_policies_table_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){package_policies_table_ownKeys(Object(source),true).forEach((function(key){package_policies_table_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{package_policies_table_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function package_policies_table_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function package_policies_table_slicedToArray(arr,i){return package_policies_table_arrayWithHoles(arr)||package_policies_table_iterableToArrayLimit(arr,i)||package_policies_table_unsupportedIterableToArray(arr,i)||package_policies_table_nonIterableRest()}function package_policies_table_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function package_policies_table_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return package_policies_table_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return package_policies_table_arrayLikeToArray(o,minLen)}function package_policies_table_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function package_policies_table_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function package_policies_table_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function package_policies_table_objectWithoutProperties(source,excluded){if(source==null)return{};var target=package_policies_table_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function package_policies_table_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const stringSortAscending=(a,b)=>a.localeCompare(b);const toFilterOption=value=>({name:value,value:value});const PackagePoliciesTable=_ref=>{let originalPackagePolicies=_ref.packagePolicies,agentPolicy=_ref.agentPolicy,rest=package_policies_table_objectWithoutProperties(_ref,["packagePolicies","agentPolicy"]);const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const hasWriteCapabilities=Object(hooks["J"])().write;const refreshAgentPolicy=useAgentPolicyRefresh();const _useMemo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const namespacesValues=[];const inputTypesValues=[];const mappedPackagePolicies=originalPackagePolicies.map(packagePolicy=>{var _packagePolicy$packag,_packagePolicy$packag2,_packagePolicy$packag3,_packagePolicy$packag4,_packagePolicy$packag5,_packagePolicy$packag6;if(packagePolicy.namespace&&!namespacesValues.includes(packagePolicy.namespace)){namespacesValues.push(packagePolicy.namespace)}return package_policies_table_objectSpread(package_policies_table_objectSpread({},packagePolicy),{},{packageName:(_packagePolicy$packag=(_packagePolicy$packag2=packagePolicy.package)===null||_packagePolicy$packag2===void 0?void 0:_packagePolicy$packag2.name)!==null&&_packagePolicy$packag!==void 0?_packagePolicy$packag:"",packageTitle:(_packagePolicy$packag3=(_packagePolicy$packag4=packagePolicy.package)===null||_packagePolicy$packag4===void 0?void 0:_packagePolicy$packag4.title)!==null&&_packagePolicy$packag3!==void 0?_packagePolicy$packag3:"",packageVersion:(_packagePolicy$packag5=(_packagePolicy$packag6=packagePolicy.package)===null||_packagePolicy$packag6===void 0?void 0:_packagePolicy$packag6.version)!==null&&_packagePolicy$packag5!==void 0?_packagePolicy$packag5:""})});namespacesValues.sort(stringSortAscending);inputTypesValues.sort(stringSortAscending);return[mappedPackagePolicies,namespacesValues.map(toFilterOption)]},[originalPackagePolicies]),_useMemo2=package_policies_table_slicedToArray(_useMemo,2),packagePolicies=_useMemo2[0],namespaces=_useMemo2[1];const columns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{field:"name",sortable:true,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.packagePoliciesTable.nameColumnTitle",{defaultMessage:"Name"}),render:value=>external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate",title:value},value)},{field:"description",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.packagePoliciesTable.descriptionColumnTitle",{defaultMessage:"Description"}),render:value=>external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate",title:value},value)},{field:"packageTitle",sortable:true,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.packagePoliciesTable.packageNameColumnTitle",{defaultMessage:"Integration"}),render(packageTitle,packagePolicy){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},packagePolicy.package&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:packagePolicy.package.name,version:packagePolicy.package.version,size:"m",tryApi:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},packageTitle))}},{field:"namespace",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.packagePoliciesTable.namespaceColumnTitle",{defaultMessage:"Namespace"}),render:namespace=>namespace?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow"},namespace):""},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.packagePoliciesTable.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:packagePolicy=>external_kbnSharedDeps_React_default.a.createElement(ContextMenuActions,{items:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{disabled:!hasWriteCapabilities,icon:"pencil",href:getHref("edit_integration",{policyId:agentPolicy.id,packagePolicyId:packagePolicy.id}),key:"packagePolicyEdit"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.packagePoliciesTable.editActionTitle",defaultMessage:"Edit integration"})),external_kbnSharedDeps_React_default.a.createElement(PackagePolicyDeleteProvider,{agentPolicy:agentPolicy,key:"packagePolicyDelete"},deletePackagePoliciesPrompt=>external_kbnSharedDeps_React_default.a.createElement(DangerEuiContextMenuItem,{disabled:!hasWriteCapabilities,icon:"trash",onClick:()=>{deletePackagePoliciesPrompt([packagePolicy.id],refreshAgentPolicy)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.packagePoliciesTable.deleteActionTitle",defaultMessage:"Delete integration"})))]})}]}],[agentPolicy,getHref,hasWriteCapabilities,refreshAgentPolicy]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiInMemoryTable"],package_policies_table_extends({itemId:"id",items:packagePolicies,columns:columns,sorting:{sort:{field:"name",direction:"asc"}}},rest,{search:{toolsRight:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{key:"addPackagePolicyButton",isDisabled:!hasWriteCapabilities,iconType:"plusInCircle",href:getHref("add_integration_from_policy",{policyId:agentPolicy.id})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.addPackagePolicyButtonText",defaultMessage:"Add integration"}))],box:{incremental:true,schema:true},filters:[{type:"field_value_selection",field:"namespace",name:"Namespace",options:namespaces,multiSelect:"or",operator:"exact"}]},isSelectable:false}))};const NoPackagePolicies=Object(external_kbnSharedDeps_React_["memo"])(({policyId:policyId})=>{const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const hasWriteCapabilities=Object(hooks["J"])().write;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"plusInCircle",title:external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetailsPackagePolicies.createFirstTitle",defaultMessage:"Add your first integration"})),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetailsPackagePolicies.createFirstMessage",defaultMessage:"This policy does not have any integrations yet."}),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{isDisabled:!hasWriteCapabilities,fill:true,href:getHref("add_integration_from_policy",{policyId:policyId})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetailsPackagePolicies.createFirstButtonText",defaultMessage:"Add integration"}))})});const PackagePoliciesView=Object(external_kbnSharedDeps_React_["memo"])(({agentPolicy:agentPolicy})=>{if(agentPolicy.package_policies.length===0){return external_kbnSharedDeps_React_default.a.createElement(NoPackagePolicies,{policyId:agentPolicy.id})}return external_kbnSharedDeps_React_default.a.createElement(PackagePoliciesTable,{agentPolicy:agentPolicy,packagePolicies:agentPolicy.package_policies||[]})});function settings_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function settings_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){settings_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){settings_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function settings_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function settings_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){settings_ownKeys(Object(source),true).forEach((function(key){settings_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{settings_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function settings_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function settings_slicedToArray(arr,i){return settings_arrayWithHoles(arr)||settings_iterableToArrayLimit(arr,i)||settings_unsupportedIterableToArray(arr,i)||settings_nonIterableRest()}function settings_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function settings_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return settings_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return settings_arrayLikeToArray(o,minLen)}function settings_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function settings_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function settings_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const FormWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"FormWrapper",componentId:"sc-1b9jodr-0"})(["max-width:800px;margin-right:auto;margin-left:auto;"]);const SettingsView=Object(external_kbnSharedDeps_React_["memo"])(({agentPolicy:originalAgentPolicy})=>{const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useConfig=Object(hooks["L"])(),isFleetEnabled=_useConfig.agents.enabled;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useLink=Object(hooks["hb"])(),getPath=_useLink.getPath;const hasWriteCapabilites=Object(hooks["J"])().write;const refreshAgentPolicy=useAgentPolicyRefresh();const _useState=Object(external_kbnSharedDeps_React_["useState"])(settings_objectSpread({},originalAgentPolicy)),_useState2=settings_slicedToArray(_useState,2),agentPolicy=_useState2[0],setAgentPolicy=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=settings_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=settings_slicedToArray(_useState5,2),hasChanges=_useState6[0],setHasChanges=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(0),_useState8=settings_slicedToArray(_useState7,2),agentCount=_useState8[0],setAgentCount=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])(true),_useState10=settings_slicedToArray(_useState9,2),withSysMonitoring=_useState10[0],setWithSysMonitoring=_useState10[1];const validation=agentPolicyFormValidation(agentPolicy);const updateAgentPolicy=updatedFields=>{setAgentPolicy(settings_objectSpread(settings_objectSpread({},agentPolicy),updatedFields));setHasChanges(true)};const submitUpdateAgentPolicy=function(){var _ref=settings_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var name,description,namespace,monitoring_enabled,_yield$sendUpdateAgen,data,error;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.prev=1;name=agentPolicy.name,description=agentPolicy.description,namespace=agentPolicy.namespace,monitoring_enabled=agentPolicy.monitoring_enabled;_context.next=5;return Object(hooks["G"])(agentPolicy.id,{name:name,description:description,namespace:namespace,monitoring_enabled:monitoring_enabled});case 5:_yield$sendUpdateAgen=_context.sent;data=_yield$sendUpdateAgen.data;error=_yield$sendUpdateAgen.error;if(data){notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.editAgentPolicy.successNotificationTitle",{defaultMessage:"Successfully updated '{name}' settings",values:{name:agentPolicy.name}}));refreshAgentPolicy();setHasChanges(false)}else{notifications.toasts.addDanger(error?error.message:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.editAgentPolicy.errorNotificationTitle",{defaultMessage:"Unable to update agent policy"}))}_context.next=14;break;case 11:_context.prev=11;_context.t0=_context["catch"](1);notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.editAgentPolicy.errorNotificationTitle",{defaultMessage:"Unable to update agent policy"}));case 14:setIsLoading(false);case 15:case"end":return _context.stop()}}),_callee,null,[[1,11]])})));return function submitUpdateAgentPolicy(){return _ref.apply(this,arguments)}}();const onSubmit=function(){var _ref2=settings_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _yield$sendGetAgentSt,data;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!isFleetEnabled){_context2.next=14;break}setIsLoading(true);_context2.next=4;return Object(hooks["k"])({policyId:agentPolicy.id});case 4:_yield$sendGetAgentSt=_context2.sent;data=_yield$sendGetAgentSt.data;if(!(data===null||data===void 0?void 0:data.results.total)){_context2.next=10;break}setAgentCount(data.results.total);_context2.next=12;break;case 10:_context2.next=12;return submitUpdateAgentPolicy();case 12:_context2.next=16;break;case 14:_context2.next=16;return submitUpdateAgentPolicy();case 16:case"end":return _context2.stop()}}),_callee2)})));return function onSubmit(){return _ref2.apply(this,arguments)}}();return external_kbnSharedDeps_React_default.a.createElement(FormWrapper,null,agentCount?external_kbnSharedDeps_React_default.a.createElement(ConfirmDeployAgentPolicyModal,{agentCount:agentCount,agentPolicy:agentPolicy,onConfirm:()=>{setAgentCount(0);submitUpdateAgentPolicy()},onCancel:()=>{setAgentCount(0);setIsLoading(false)}}):null,external_kbnSharedDeps_React_default.a.createElement(AgentPolicyForm,{agentPolicy:agentPolicy,updateAgentPolicy:updateAgentPolicy,withSysMonitoring:withSysMonitoring,updateSysMonitoring:newValue=>setWithSysMonitoring(newValue),validation:validation,isEditing:true,onDelete:()=>{history.push(getPath("policies_list"))}}),hasChanges?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBottomBar"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.editAgentPolicy.unsavedChangesText",defaultMessage:"You have unsaved changes"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{color:"ghost",onClick:()=>{setAgentPolicy(settings_objectSpread({},originalAgentPolicy));setHasChanges(false)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.editAgentPolicy.cancelButtonText",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:onSubmit,isLoading:isLoading,isDisabled:!hasWriteCapabilites||isLoading||Object.keys(validation).length>0,iconType:"save",color:"primary",fill:true},isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.editAgentPolicy.savingButtonText",defaultMessage:"Saving…"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.editAgentPolicy.saveButtonText",defaultMessage:"Save changes"}))))))):null)});function details_page_slicedToArray(arr,i){return details_page_arrayWithHoles(arr)||details_page_iterableToArrayLimit(arr,i)||details_page_unsupportedIterableToArray(arr,i)||details_page_nonIterableRest()}function details_page_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function details_page_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return details_page_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return details_page_arrayLikeToArray(o,minLen)}function details_page_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function details_page_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function details_page_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const details_page_Divider=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Divider",componentId:"kgzhx1-0"})(["width:0;height:100%;border-left:",";"],props=>props.theme.eui.euiBorderThin);const AgentPolicyDetailsPage=()=>{var _agentStatusRequest$d;const _useRouteMatch=Object(external_kbnSharedDeps_ReactRouterDom_["useRouteMatch"])(),_useRouteMatch$params=_useRouteMatch.params,policyId=_useRouteMatch$params.policyId,_useRouteMatch$params2=_useRouteMatch$params.tabId,tabId=_useRouteMatch$params2===void 0?"":_useRouteMatch$params2;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref,getPath=_useLink.getPath;const agentPolicyRequest=Object(hooks["W"])(policyId);const agentPolicy=agentPolicyRequest.data?agentPolicyRequest.data.item:null;const isLoading=agentPolicyRequest.isLoading,error=agentPolicyRequest.error,refreshAgentPolicy=agentPolicyRequest.sendRequest;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=details_page_slicedToArray(_useState,1),redirectToAgentPolicyList=_useState2[0];const agentStatusRequest=useGetAgentStatus(policyId);const refreshAgentStatus=agentStatusRequest.refreshAgentStatus;const _useStartServices=Object(hooks["mb"])(),navigateToApp=_useStartServices.application.navigateToApp;const routeState=useIntraAppState();const agentStatus=(_agentStatusRequest$d=agentStatusRequest.data)===null||_agentStatusRequest$d===void 0?void 0:_agentStatusRequest$d.results;const queryParams=new URLSearchParams(Object(external_kbnSharedDeps_ReactRouterDom_["useLocation"])().search);const openEnrollmentFlyoutOpenByDefault=queryParams.get("openEnrollmentFlyout")==="true";const _useFleetStatus=Object(hooks["N"])(),isFleetReady=_useFleetStatus.isReady;const headerLeftContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"arrowLeft",href:getHref("policies_list"),flush:"left",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.viewAgentListTitle",defaultMessage:"View all agent policies"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{className:"eui-textBreakWord"},external_kbnSharedDeps_React_default.a.createElement("h1",null,isLoading?external_kbnSharedDeps_React_default.a.createElement(Loading,null):agentPolicy&&agentPolicy.name||external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.policyDetailsTitle",defaultMessage:"Policy '{id}'",values:{id:policyId}})))),agentPolicy&&agentPolicy.description?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s",className:"eui-textBreakWord"},agentPolicy.description)):null),[getHref,isLoading,agentPolicy,policyId]);const headerRightContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _agentPolicy$revision;return agentPolicy?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd",direction:"row"},[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.summary.revision",{defaultMessage:"Revision"}),content:(_agentPolicy$revision=agentPolicy===null||agentPolicy===void 0?void 0:agentPolicy.revision)!==null&&_agentPolicy$revision!==void 0?_agentPolicy$revision:0},{isDivider:true},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.summary.integrations",{defaultMessage:"Integrations"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:agentPolicy&&agentPolicy.package_policies&&agentPolicy.package_policies.length||0})},{isDivider:true},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.summary.usedBy",{defaultMessage:"Used by"}),content:external_kbnSharedDeps_React_default.a.createElement(LinkedAgentCount,{count:agentStatus&&agentStatus.total||0,agentPolicyId:agentPolicy&&agentPolicy.id||""})},{isDivider:true},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.summary.lastUpdated",{defaultMessage:"Last updated on"}),content:agentPolicy&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedDate"],{value:agentPolicy===null||agentPolicy===void 0?void 0:agentPolicy.updated_at,year:"numeric",month:"short",day:"2-digit"})||""},{isDivider:true},{content:agentPolicy&&external_kbnSharedDeps_React_default.a.createElement(AgentPolicyActionMenu,{agentPolicy:agentPolicy,fullButton:true,onCopySuccess:newAgentPolicy=>{history.push(getPath("policy_details",{policyId:newAgentPolicy.id}))},enrollmentFlyoutOpenByDefault:openEnrollmentFlyoutOpenByDefault,onCancelEnrollment:routeState&&routeState.onDoneNavigateTo&&isFleetReady?()=>navigateToApp(routeState.onDoneNavigateTo[0],routeState.onDoneNavigateTo[1]):undefined})}].map((item,index)=>{var _item$isDivider;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:index},((_item$isDivider=item.isDivider)!==null&&_item$isDivider!==void 0?_item$isDivider:false)?external_kbnSharedDeps_React_default.a.createElement(details_page_Divider,null):item.label?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{compressed:true,textStyle:"reverse",style:{textAlign:"right"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],{className:"eui-textNoWrap"},item.label),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],{className:"eui-textNoWrap"},item.content)):item.content)})):undefined},[agentPolicy,policyId,agentStatus]);const headerTabs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{id:"integrations",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.subTabs.packagePoliciesTabText",{defaultMessage:"Integrations"}),href:getHref("policy_details",{policyId:policyId,tabId:"integrations"}),isSelected:tabId===""||tabId==="integrations"},{id:"settings",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.subTabs.settingsTabText",{defaultMessage:"Settings"}),href:getHref("policy_details",{policyId:policyId,tabId:"settings"}),isSelected:tabId==="settings"}],[getHref,policyId,tabId]);const content=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(redirectToAgentPolicyList){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:"/"})}if(isLoading){return external_kbnSharedDeps_React_default.a.createElement(Loading,null)}if(error){return external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.unexceptedErrorTitle",defaultMessage:"An error happened while loading the agent policy"}),error:error})}if(!agentPolicy){return external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.policyDetails.unexceptedErrorTitle",defaultMessage:"An error happened while loading the agent policy"}),error:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.policyDetails.policyNotFoundErrorTitle",{defaultMessage:"Policy '{id}' not found",values:{id:policyId}})})}return external_kbnSharedDeps_React_default.a.createElement(AgentPolicyDetailsContent,{agentPolicy:agentPolicy})},[agentPolicy,policyId,error,isLoading,redirectToAgentPolicyList]);return external_kbnSharedDeps_React_default.a.createElement(AgentPolicyRefreshContext.Provider,{value:{refresh:refreshAgentPolicy}},external_kbnSharedDeps_React_default.a.createElement(AgentStatusRefreshContext.Provider,{value:{refresh:refreshAgentStatus}},external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:headerLeftContent,rightColumn:headerRightContent,tabs:headerTabs},content)))};const AgentPolicyDetailsContent=({agentPolicy:agentPolicy})=>{Object(hooks["I"])("policy_details",{policyName:agentPolicy.name});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].policy_details_settings,render:()=>external_kbnSharedDeps_React_default.a.createElement(SettingsView,{agentPolicy:agentPolicy})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].policy_details,render:()=>external_kbnSharedDeps_React_default.a.createElement(PackagePoliciesView,{agentPolicy:agentPolicy})}))};function edit_package_policy_page_extends(){edit_package_policy_page_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return edit_package_policy_page_extends.apply(this,arguments)}function edit_package_policy_page_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function edit_package_policy_page_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){edit_package_policy_page_ownKeys(Object(source),true).forEach((function(key){edit_package_policy_page_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{edit_package_policy_page_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function edit_package_policy_page_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function edit_package_policy_page_objectWithoutProperties(source,excluded){if(source==null)return{};var target=edit_package_policy_page_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function edit_package_policy_page_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function edit_package_policy_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function edit_package_policy_page_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){edit_package_policy_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){edit_package_policy_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function edit_package_policy_page_slicedToArray(arr,i){return edit_package_policy_page_arrayWithHoles(arr)||edit_package_policy_page_iterableToArrayLimit(arr,i)||edit_package_policy_page_unsupportedIterableToArray(arr,i)||edit_package_policy_page_nonIterableRest()}function edit_package_policy_page_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function edit_package_policy_page_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return edit_package_policy_page_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return edit_package_policy_page_arrayLikeToArray(o,minLen)}function edit_package_policy_page_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function edit_package_policy_page_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function edit_package_policy_page_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const EditPackagePolicyPage=()=>{var _packagePolicy$packag,_packagePolicy$packag2;const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useConfig=Object(hooks["L"])(),isFleetEnabled=_useConfig.agents.enabled;const _useRouteMatch=Object(external_kbnSharedDeps_ReactRouterDom_["useRouteMatch"])(),_useRouteMatch$params=_useRouteMatch.params,policyId=_useRouteMatch$params.policyId,packagePolicyId=_useRouteMatch$params.packagePolicyId;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref,getPath=_useLink.getPath;const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=edit_package_policy_page_slicedToArray(_useState,2),isLoadingData=_useState2[0],setIsLoadingData=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=edit_package_policy_page_slicedToArray(_useState3,2),loadingError=_useState4[0],setLoadingError=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(),_useState6=edit_package_policy_page_slicedToArray(_useState5,2),agentPolicy=_useState6[0],setAgentPolicy=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(),_useState8=edit_package_policy_page_slicedToArray(_useState7,2),packageInfo=_useState8[0],setPackageInfo=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])({name:"",description:"",namespace:"",policy_id:"",enabled:true,output_id:"",inputs:[],version:""}),_useState10=edit_package_policy_page_slicedToArray(_useState9,2),packagePolicy=_useState10[0],setPackagePolicy=_useState10[1];const _useState11=Object(external_kbnSharedDeps_React_["useState"])(),_useState12=edit_package_policy_page_slicedToArray(_useState11,2),originalPackagePolicy=_useState12[0],setOriginalPackagePolicy=_useState12[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const getData=function(){var _ref=edit_package_policy_page_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$Promise$all,_yield$Promise$all2,agentPolicyData,packagePolicyData,_packagePolicyData$it,id,revision,inputs,created_by,created_at,updated_by,updated_at,restOfPackagePolicy,newPackagePolicy,_yield$sendGetPackage,packageData;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoadingData(true);setLoadingError(undefined);_context.prev=2;_context.next=5;return Promise.all([Object(hooks["n"])(policyId),Object(hooks["q"])(packagePolicyId)]);case 5:_yield$Promise$all=_context.sent;_yield$Promise$all2=edit_package_policy_page_slicedToArray(_yield$Promise$all,2);agentPolicyData=_yield$Promise$all2[0].data;packagePolicyData=_yield$Promise$all2[1].data;if(agentPolicyData===null||agentPolicyData===void 0?void 0:agentPolicyData.item){setAgentPolicy(agentPolicyData.item)}if(!(packagePolicyData===null||packagePolicyData===void 0?void 0:packagePolicyData.item)){_context.next=21;break}setOriginalPackagePolicy(packagePolicyData.item);_packagePolicyData$it=packagePolicyData.item,id=_packagePolicyData$it.id,revision=_packagePolicyData$it.revision,inputs=_packagePolicyData$it.inputs,created_by=_packagePolicyData$it.created_by,created_at=_packagePolicyData$it.created_at,updated_by=_packagePolicyData$it.updated_by,updated_at=_packagePolicyData$it.updated_at,restOfPackagePolicy=edit_package_policy_page_objectWithoutProperties(_packagePolicyData$it,["id","revision","inputs","created_by","created_at","updated_by","updated_at"]);newPackagePolicy=edit_package_policy_page_objectSpread(edit_package_policy_page_objectSpread({},restOfPackagePolicy),{},{inputs:inputs.map(input=>{const streams=input.streams,restOfInput=edit_package_policy_page_objectWithoutProperties(input,["streams"]);return edit_package_policy_page_objectSpread(edit_package_policy_page_objectSpread({},restOfInput),{},{streams:streams.map(stream=>{const compiled_stream=stream.compiled_stream,restOfStream=edit_package_policy_page_objectWithoutProperties(stream,["compiled_stream"]);return restOfStream})})})});setPackagePolicy(newPackagePolicy);if(!packagePolicyData.item.package){_context.next=21;break}_context.next=18;return Object(hooks["r"])("".concat(packagePolicyData.item.package.name,"-").concat(packagePolicyData.item.package.version));case 18:_yield$sendGetPackage=_context.sent;packageData=_yield$sendGetPackage.data;if(packageData===null||packageData===void 0?void 0:packageData.response){setPackageInfo(packageData.response);setValidationResults(validatePackagePolicy(newPackagePolicy,packageData.response));setFormState("VALID")}case 21:_context.next=26;break;case 23:_context.prev=23;_context.t0=_context["catch"](2);setLoadingError(_context.t0);case 26:setIsLoadingData(false);case 27:case"end":return _context.stop()}}),_callee,null,[[2,23]])})));return function getData(){return _ref.apply(this,arguments)}}();getData()},[policyId,packagePolicyId]);const _useState13=Object(external_kbnSharedDeps_React_["useState"])(0),_useState14=edit_package_policy_page_slicedToArray(_useState13,2),agentCount=_useState14[0],setAgentCount=_useState14[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const getAgentCount=function(){var _ref2=edit_package_policy_page_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _yield$sendGetAgentSt,data;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return Object(hooks["k"])({policyId:policyId});case 2:_yield$sendGetAgentSt=_context2.sent;data=_yield$sendGetAgentSt.data;if(data===null||data===void 0?void 0:data.results.total){setAgentCount(data.results.total)}case 5:case"end":return _context2.stop()}}),_callee2)})));return function getAgentCount(){return _ref2.apply(this,arguments)}}();if(isFleetEnabled){getAgentCount()}},[policyId,isFleetEnabled]);const _useState15=Object(external_kbnSharedDeps_React_["useState"])(),_useState16=edit_package_policy_page_slicedToArray(_useState15,2),validationResults=_useState16[0],setValidationResults=_useState16[1];const hasErrors=validationResults?validationHasErrors(validationResults):false;const updatePackagePolicyValidation=Object(external_kbnSharedDeps_React_["useCallback"])(newPackagePolicy=>{if(packageInfo){const newValidationResult=validatePackagePolicy(newPackagePolicy||packagePolicy,packageInfo);setValidationResults(newValidationResult);console.debug("Package policy validation results",newValidationResult);return newValidationResult}},[packagePolicy,packageInfo]);const updatePackagePolicy=Object(external_kbnSharedDeps_React_["useCallback"])(updatedFields=>{const newPackagePolicy=edit_package_policy_page_objectSpread(edit_package_policy_page_objectSpread({},packagePolicy),updatedFields);setPackagePolicy(newPackagePolicy);console.debug("Package policy updated",newPackagePolicy);const newValidationResults=updatePackagePolicyValidation(newPackagePolicy);const hasValidationErrors=newValidationResults?validationHasErrors(newValidationResults):false;if(!hasValidationErrors){setFormState("VALID")}},[packagePolicy,updatePackagePolicyValidation]);const handleExtensionViewOnChange=Object(external_kbnSharedDeps_React_["useCallback"])(({isValid:isValid,updatedPolicy:updatedPolicy})=>{updatePackagePolicy(updatedPolicy);setFormState(prevState=>{if(prevState==="VALID"&&!isValid){return"INVALID"}return prevState})},[updatePackagePolicy]);const cancelUrl=getHref("policy_details",{policyId:policyId});const _useState17=Object(external_kbnSharedDeps_React_["useState"])("INVALID"),_useState18=edit_package_policy_page_slicedToArray(_useState17,2),formState=_useState18[0],setFormState=_useState18[1];const savePackagePolicy=function(){var _ref3=edit_package_policy_page_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var result;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:setFormState("LOADING");_context3.next=3;return Object(hooks["H"])(packagePolicyId,packagePolicy);case 3:result=_context3.sent;setFormState("SUBMITTED");return _context3.abrupt("return",result);case 6:case"end":return _context3.stop()}}),_callee3)})));return function savePackagePolicy(){return _ref3.apply(this,arguments)}}();const onSubmit=function(){var _ref4=edit_package_policy_page_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var _yield$savePackagePol,error;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(!(formState==="VALID"&&hasErrors)){_context4.next=3;break}setFormState("INVALID");return _context4.abrupt("return");case 3:if(!(agentCount!==0&&formState!=="CONFIRM")){_context4.next=6;break}setFormState("CONFIRM");return _context4.abrupt("return");case 6:_context4.next=8;return savePackagePolicy();case 8:_yield$savePackagePol=_context4.sent;error=_yield$savePackagePol.error;if(!error){history.push(getPath("policy_details",{policyId:policyId}));notifications.toasts.addSuccess({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.editPackagePolicy.updatedNotificationTitle",{defaultMessage:"Successfully updated '{packagePolicyName}'",values:{packagePolicyName:packagePolicy.name}}),text:agentCount&&agentPolicy?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.editPackagePolicy.updatedNotificationMessage",{defaultMessage:"Fleet will deploy updates to all agents that use the '{agentPolicyName}' policy",values:{agentPolicyName:agentPolicy.name}}):undefined})}else{if(error.statusCode===409){notifications.toasts.addError(error,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.editPackagePolicy.failedNotificationTitle",{defaultMessage:"Error updating '{packagePolicyName}'",values:{packagePolicyName:packagePolicy.name}}),toastMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.editPackagePolicy.failedConflictNotificationMessage",{defaultMessage:"Data is out of date. Refresh the page to get the latest policy."})})}else{notifications.toasts.addError(error,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.editPackagePolicy.failedNotificationTitle",{defaultMessage:"Error updating '{packagePolicyName}'",values:{packagePolicyName:packagePolicy.name}})})}setFormState("VALID")}case 11:case"end":return _context4.stop()}}),_callee4)})));return function onSubmit(){return _ref4.apply(this,arguments)}}();const layoutProps={from:"edit",cancelUrl:cancelUrl,agentPolicy:agentPolicy,packageInfo:packageInfo};const ExtensionView=useUIExtension((_packagePolicy$packag=(_packagePolicy$packag2=packagePolicy.package)===null||_packagePolicy$packag2===void 0?void 0:_packagePolicy$packag2.name)!==null&&_packagePolicy$packag!==void 0?_packagePolicy$packag:"","package-policy-edit");const configurePackage=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _packagePolicy$packag3;return agentPolicy&&packageInfo?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepDefinePackagePolicy,{agentPolicy:agentPolicy,packageInfo:packageInfo,packagePolicy:packagePolicy,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults}),external_kbnSharedDeps_React_default.a.createElement(StepConfigurePackagePolicy,{from:"edit",packageInfo:packageInfo,packagePolicy:packagePolicy,packagePolicyId:packagePolicyId,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults,submitAttempted:formState==="INVALID"}),packagePolicy.policy_id&&((_packagePolicy$packag3=packagePolicy.package)===null||_packagePolicy$packag3===void 0?void 0:_packagePolicy$packag3.name)&&originalPackagePolicy&&ExtensionView&&external_kbnSharedDeps_React_default.a.createElement(ExtensionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(ExtensionView,{policy:originalPackagePolicy,newPolicy:packagePolicy,onChange:handleExtensionViewOnChange}))):null},[agentPolicy,packageInfo,packagePolicy,updatePackagePolicy,validationResults,packagePolicyId,formState,originalPackagePolicy,ExtensionView,handleExtensionViewOnChange]);return external_kbnSharedDeps_React_default.a.createElement(CreatePackagePolicyPageLayout,edit_package_policy_page_extends({},layoutProps,{"data-test-subj":"editPackagePolicy"}),isLoadingData?external_kbnSharedDeps_React_default.a.createElement(Loading,null):loadingError||!agentPolicy||!packageInfo?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.editPackagePolicy.errorLoadingDataTitle",defaultMessage:"Error loading data"}),error:loadingError||external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.editPackagePolicy.errorLoadingDataMessage",{defaultMessage:"There was an error loading this intergration information"})}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Breadcrumb,{policyName:agentPolicy.name,policyId:policyId}),formState==="CONFIRM"&&external_kbnSharedDeps_React_default.a.createElement(ConfirmDeployAgentPolicyModal,{agentCount:agentCount,agentPolicy:agentPolicy,onConfirm:onSubmit,onCancel:()=>setFormState("VALID")}),configurePackage,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBottomBar"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},agentPolicy&&packageInfo&&formState==="INVALID"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.createPackagePolicy.errorOnSaveText",defaultMessage:"Your integration policy has errors. Please fix them before saving."}):null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{color:"ghost",href:cancelUrl},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.editPackagePolicy.cancelButton",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:onSubmit,isLoading:formState==="LOADING",disabled:formState!=="VALID",iconType:"save",color:"primary",fill:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.editPackagePolicy.saveButton",defaultMessage:"Save integration"})))))))))};const Breadcrumb=({policyName:policyName,policyId:policyId})=>{Object(hooks["I"])("edit_integration",{policyName:policyName,policyId:policyId});return null};const AgentPolicyApp=()=>{Object(hooks["I"])("policies");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["HashRouter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].edit_integration},external_kbnSharedDeps_React_default.a.createElement(EditPackagePolicyPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].add_integration_from_policy},external_kbnSharedDeps_React_default.a.createElement(CreatePackagePolicyPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].policy_details},external_kbnSharedDeps_React_default.a.createElement(AgentPolicyDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].policies_list},external_kbnSharedDeps_React_default.a.createElement(AgentPolicyListPage,null))))};const DataStreamRowActions=Object(external_kbnSharedDeps_React_["memo"])(({datastream:datastream})=>{const dashboards=datastream.dashboards;const panels=[];const actionNameSingular=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.dataStreamList.viewDashboardActionText",defaultMessage:"View dashboard"});const actionNamePlural=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.dataStreamList.viewDashboardsActionText",defaultMessage:"View dashboards"});const panelTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.viewDashboardsPanelTitle",{defaultMessage:"View dashboards"});if(!dashboards||dashboards.length===0){panels.push({id:0,items:[{icon:"dashboardApp",disabled:true,name:actionNameSingular}]})}else if(dashboards.length===1){panels.push({id:0,items:[{icon:"dashboardApp",href:Object(hooks["eb"])("/dashboard/".concat(dashboards[0].id||"")),name:actionNameSingular}]})}else{panels.push({id:0,items:[{icon:"dashboardApp",panel:1,name:actionNamePlural}]});panels.push({id:1,title:panelTitle,items:dashboards.map(dashboard=>({icon:"dashboardApp",href:Object(hooks["eb"])("/dashboard/".concat(dashboard.id||"")),name:dashboard.title}))})}return external_kbnSharedDeps_React_default.a.createElement(ContextMenuActions,{panels:panels})});const DataStreamListPageLayout=({children:children})=>external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.dataStreamList.pageTitle",defaultMessage:"Data streams"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.dataStreamList.pageSubtitle",defaultMessage:"Manage the data created by your agents."})))))},children);const DataStreamListPage=()=>{Object(hooks["I"])("data_streams");const _useStartServices=Object(hooks["mb"])(),fieldFormats=_useStartServices.data.fieldFormats;const _usePagination=Object(hooks["jb"])(),pagination=_usePagination.pagination,pageSizeOptions=_usePagination.pageSizeOptions;const _useGetDataStreams=Object(hooks["S"])(),isLoading=_useGetDataStreams.isLoading,dataStreamsData=_useGetDataStreams.data,resendRequest=_useGetDataStreams.resendRequest;const columns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const cols=[{field:"dataset",sortable:true,width:"25%",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.datasetColumnTitle",{defaultMessage:"Dataset"})},{field:"type",sortable:true,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.typeColumnTitle",{defaultMessage:"Type"})},{field:"namespace",sortable:true,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.namespaceColumnTitle",{defaultMessage:"Namespace"}),render:namespace=>namespace?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow"},namespace):""},{field:"package",sortable:true,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.integrationColumnTitle",{defaultMessage:"Integration"}),render(pkg,datastream){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},datastream.package_version&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:pkg,version:datastream.package_version,size:"m",tryApi:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},pkg))}},{field:"last_activity",sortable:true,width:"25%",dataType:"date",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.lastActivityColumnTitle",{defaultMessage:"Last activity"}),render:date=>{try{const formatter=fieldFormats.getInstance("date");return formatter.convert(date)}catch(e){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedDate"],{value:date,year:"numeric",month:"short",day:"2-digit"})}}},{field:"size_in_bytes",sortable:true,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.sizeColumnTitle",{defaultMessage:"Size"}),render:size=>{try{const formatter=fieldFormats.getInstance("bytes");return formatter.convert(size)}catch(e){return"".concat(size,"b")}}},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:datastream=>external_kbnSharedDeps_React_default.a.createElement(DataStreamRowActions,{datastream:datastream})}]}];return cols},[fieldFormats]);const emptyPrompt=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.dataStreamList.noDataStreamsPrompt",defaultMessage:"No data streams"}))}),[]);const filterOptions={dataset:[],type:[],namespace:[],package:[]};if(dataStreamsData&&dataStreamsData.data_streams.length){const dataValues={dataset:[],type:[],namespace:[],package:[]};dataStreamsData.data_streams.forEach(stream=>{const dataset=stream.dataset,type=stream.type,namespace=stream.namespace,pkg=stream.package;if(!dataValues.dataset.includes(dataset)){dataValues.dataset.push(dataset)}if(!dataValues.type.includes(type)){dataValues.type.push(type)}if(!dataValues.namespace.includes(namespace)){dataValues.namespace.push(namespace)}if(!dataValues.package.includes(pkg)){dataValues.package.push(pkg)}});for(const field in dataValues){if(filterOptions[field]){filterOptions[field]=dataValues[field].sort().map(option=>({value:option,name:option}))}}}return external_kbnSharedDeps_React_default.a.createElement(DataStreamListPageLayout,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiInMemoryTable"],{loading:isLoading,hasActions:true,message:isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.dataStreamList.loadingDataStreamsMessage",defaultMessage:"Loading data streams…"}):dataStreamsData&&!dataStreamsData.data_streams.length?emptyPrompt:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.dataStreamList.noFilteredDataStreamsMessage",defaultMessage:"No matching data streams found"}),items:dataStreamsData?dataStreamsData.data_streams:[],itemId:"index",columns:columns,pagination:{initialPageSize:pagination.pageSize,pageSizeOptions:pageSizeOptions},sorting:true,search:{toolsRight:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{key:"reloadButton",color:"primary",iconType:"refresh",onClick:()=>resendRequest()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.dataStreamList.reloadDataStreamsButtonText",defaultMessage:"Reload"}))],box:{placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.searchPlaceholderTitle",{defaultMessage:"Filter data streams"}),incremental:true},filters:[{type:"field_value_selection",field:"dataset",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.datasetColumnTitle",{defaultMessage:"Dataset"}),multiSelect:"or",operator:"exact",options:filterOptions.dataset},{type:"field_value_selection",field:"type",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.typeColumnTitle",{defaultMessage:"Type"}),multiSelect:"or",operator:"exact",options:filterOptions.type},{type:"field_value_selection",field:"namespace",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.namespaceColumnTitle",{defaultMessage:"Namespace"}),multiSelect:"or",operator:"exact",options:filterOptions.namespace},{type:"field_value_selection",field:"package",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.dataStreamList.integrationColumnTitle",{defaultMessage:"Integration"}),multiSelect:"or",operator:"exact",options:filterOptions.package}]}}))};const DataStreamApp=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["HashRouter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].data_streams},external_kbnSharedDeps_React_default.a.createElement(DataStreamListPage,null))));function bulk_actions_slicedToArray(arr,i){return bulk_actions_arrayWithHoles(arr)||bulk_actions_iterableToArrayLimit(arr,i)||bulk_actions_unsupportedIterableToArray(arr,i)||bulk_actions_nonIterableRest()}function bulk_actions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bulk_actions_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return bulk_actions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bulk_actions_arrayLikeToArray(o,minLen)}function bulk_actions_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function bulk_actions_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function bulk_actions_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const bulk_actions_Divider=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Divider",componentId:"sc-1ynhme7-0"})(["width:0;height:",";border-left:",";"],props=>props.theme.eui.euiSizeL,props=>props.theme.eui.euiBorderThin);const FlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItem",componentId:"sc-1ynhme7-1"})(["height:",";"],props=>props.theme.eui.euiSizeL);const Button=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"]).withConfig({displayName:"Button",componentId:"sc-1ynhme7-2"})([".euiButtonEmpty__text{font-size:",";}"],props=>props.theme.eui.euiFontSizeXS);const AgentBulkActions=({totalAgents:totalAgents,totalInactiveAgents:totalInactiveAgents,selectableAgents:selectableAgents,selectionMode:selectionMode,setSelectionMode:setSelectionMode,currentQuery:currentQuery,selectedAgents:selectedAgents,setSelectedAgents:setSelectedAgents,refreshAgents:refreshAgents})=>{const kibanaVersion=Object(hooks["fb"])();const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=bulk_actions_slicedToArray(_useState,2),isMenuOpen=_useState2[0],setIsMenuOpen=_useState2[1];const closeMenu=()=>setIsMenuOpen(false);const openMenu=()=>setIsMenuOpen(true);const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=bulk_actions_slicedToArray(_useState3,2),isReassignFlyoutOpen=_useState4[0],setIsReassignFlyoutOpen=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=bulk_actions_slicedToArray(_useState5,2),isUnenrollModalOpen=_useState6[0],setIsUnenrollModalOpen=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=bulk_actions_slicedToArray(_useState7,2),isUpgradeModalOpen=_useState8[0],setIsUpgradeModalOpen=_useState8[1];const atLeastOneActiveAgentSelected=selectionMode==="manual"?!!selectedAgents.find(agent=>agent.active):totalAgents>totalInactiveAgents;const panels=[{id:0,items:[{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentBulkActions.reassignPolicy",defaultMessage:"Assign to new policy"}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"pencil",size:"m"}),disabled:!atLeastOneActiveAgentSelected,onClick:()=>{closeMenu();setIsReassignFlyoutOpen(true)}},{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentBulkActions.unenrollAgents",defaultMessage:"Unenroll agents"}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"trash",size:"m"}),disabled:!atLeastOneActiveAgentSelected,onClick:()=>{closeMenu();setIsUnenrollModalOpen(true)}},{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentBulkActions.upgradeAgents",defaultMessage:"Upgrade agents"}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"refresh",size:"m"}),disabled:!atLeastOneActiveAgentSelected,onClick:()=>{closeMenu();setIsUpgradeModalOpen(true)}},{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentBulkActions.clearSelection",defaultMessage:"Clear selection"}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"cross",size:"m"}),onClick:()=>{closeMenu();setSelectionMode("manual");setSelectedAgents([])}}]}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isReassignFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentReassignAgentPolicyFlyout,{agents:selectionMode==="manual"?selectedAgents:currentQuery,onClose:()=>{setIsReassignFlyoutOpen(false);refreshAgents()}})),isUnenrollModalOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentUnenrollAgentModal,{agents:selectionMode==="manual"?selectedAgents:currentQuery,agentCount:selectionMode==="manual"?selectedAgents.length:totalAgents-totalInactiveAgents,onClose:()=>{setIsUnenrollModalOpen(false);refreshAgents()}})),isUpgradeModalOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentUpgradeAgentModal,{version:kibanaVersion,agents:selectionMode==="manual"?selectedAgents:currentQuery,agentCount:selectionMode==="manual"?selectedAgents.length:totalAgents-totalInactiveAgents,onClose:()=>{setIsUpgradeModalOpen(false);refreshAgents()}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},totalAgents>constants["j"]?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentBulkActions.totalAgentsWithLimit",defaultMessage:"Showing {count} of {total} agents",values:{count:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedNumber"],{value:constants["j"]}),total:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedNumber"],{value:totalAgents})}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentBulkActions.totalAgents",defaultMessage:"Showing {count, plural, one {# agent} other {# agents}}",values:{count:totalAgents}}))),selectionMode==="manual"&&selectedAgents.length||selectionMode==="query"&&totalAgents>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:false},external_kbnSharedDeps_React_default.a.createElement(bulk_actions_Divider,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"agentBulkActionsMenu",button:external_kbnSharedDeps_React_default.a.createElement(Button,{size:"xs",iconType:"arrowDown",iconSide:"right",flush:"left",onClick:openMenu},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentBulkActions.agentsSelected",defaultMessage:"{count, plural, one {# agent} other {# agents}} selected",values:{count:selectionMode==="manual"?selectedAgents.length:Math.min(totalAgents-totalInactiveAgents,constants["j"])}})),isOpen:isMenuOpen,closePopover:closeMenu,panelPaddingSize:"none",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenu"],{initialPanelId:0,panels:panels}))),selectionMode==="manual"&&selectedAgents.length===selectableAgents&&selectableAgents<totalAgents?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(Button,{size:"xs",iconType:"pagesSelect",iconSide:"left",flush:"left",onClick:()=>setSelectionMode("query")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentBulkActions.selectAll",defaultMessage:"Select everything on all pages"}))):null):external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:false})))};function agent_list_page_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function agent_list_page_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){agent_list_page_ownKeys(Object(source),true).forEach((function(key){agent_list_page_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{agent_list_page_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function agent_list_page_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function agent_list_page_slicedToArray(arr,i){return agent_list_page_arrayWithHoles(arr)||agent_list_page_iterableToArrayLimit(arr,i)||agent_list_page_unsupportedIterableToArray(arr,i)||agent_list_page_nonIterableRest()}function agent_list_page_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function agent_list_page_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return agent_list_page_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return agent_list_page_arrayLikeToArray(o,minLen)}function agent_list_page_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function agent_list_page_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function agent_list_page_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const REFRESH_INTERVAL_MS=5e3;const statusFilters=[{status:"online",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentList.statusOnlineFilterText",{defaultMessage:"Online"})},{status:"offline",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentList.statusOfflineFilterText",{defaultMessage:"Offline"})},,{status:"error",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentList.statusErrorFilterText",{defaultMessage:"Error"})},{status:"updating",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentList.statusUpdatingFilterText",{defaultMessage:"Updating"})}];const RowActions=external_kbnSharedDeps_React_default.a.memo(({agent:agent,refresh:refresh,onReassignClick:onReassignClick,onUnenrollClick:onUnenrollClick,onUpgradeClick:onUpgradeClick})=>{const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const hasWriteCapabilites=Object(hooks["J"])().write;const isUnenrolling=agent.status==="unenrolling";const kibanaVersion=Object(hooks["fb"])();const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=agent_list_page_slicedToArray(_useState,2),isMenuOpen=_useState2[0],setIsMenuOpen=_useState2[1];return external_kbnSharedDeps_React_default.a.createElement(ContextMenuActions,{isOpen:isMenuOpen,onChange:isOpen=>setIsMenuOpen(isOpen),items:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{icon:"inspect",href:getHref("fleet_agent_details",{agentId:agent.id}),key:"viewAgent"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.viewActionText",defaultMessage:"View agent"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{icon:"pencil",onClick:()=>{onReassignClick()},disabled:!agent.active,key:"reassignPolicy"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.reassignActionText",defaultMessage:"Assign to new policy"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{disabled:!hasWriteCapabilites||!agent.active,icon:"trash",onClick:()=>{onUnenrollClick()}},isUnenrolling?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.forceUnenrollOneButton",defaultMessage:"Force unenroll"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.unenrollOneButton",defaultMessage:"Unenroll agent"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{icon:"refresh",disabled:!Object(services["l"])(agent,kibanaVersion),onClick:()=>{onUpgradeClick()}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.upgradeOneButton",defaultMessage:"Upgrade agent"}))]})});function safeMetadata(val){if(typeof val!=="string"){return"-"}return val}const AgentListPage=()=>{Object(hooks["I"])("fleet_agent_list");const _useLink2=Object(hooks["hb"])(),getHref=_useLink2.getHref;const defaultKuery=Object(hooks["ob"])().urlParams.kuery||"";const hasWriteCapabilites=Object(hooks["J"])().write;const isGoldPlus=Object(hooks["gb"])().isGoldPlus();const kibanaVersion=Object(hooks["fb"])();const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=agent_list_page_slicedToArray(_useState3,2),showInactive=_useState4[0],setShowInactive=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=agent_list_page_slicedToArray(_useState5,2),showUpgradeable=_useState6[0],setShowUpgradeable=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(defaultKuery),_useState8=agent_list_page_slicedToArray(_useState7,2),search=_useState8[0],setSearch=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])("manual"),_useState10=agent_list_page_slicedToArray(_useState9,2),selectionMode=_useState10[0],setSelectionMode=_useState10[1];const _useState11=Object(external_kbnSharedDeps_React_["useState"])([]),_useState12=agent_list_page_slicedToArray(_useState11,2),selectedAgents=_useState12[0],setSelectedAgents=_useState12[1];const tableRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const _usePagination=Object(hooks["jb"])(),pagination=_usePagination.pagination,pageSizeOptions=_usePagination.pageSizeOptions,setPagination=_usePagination.setPagination;const _useState13=Object(external_kbnSharedDeps_React_["useState"])(false),_useState14=agent_list_page_slicedToArray(_useState13,2),isAgentPoliciesFilterOpen=_useState14[0],setIsAgentPoliciesFilterOpen=_useState14[1];const _useState15=Object(external_kbnSharedDeps_React_["useState"])([]),_useState16=agent_list_page_slicedToArray(_useState15,2),selectedAgentPolicies=_useState16[0],setSelectedAgentPolicies=_useState16[1];const _useState17=Object(external_kbnSharedDeps_React_["useState"])(false),_useState18=agent_list_page_slicedToArray(_useState17,2),isStatusFilterOpen=_useState18[0],setIsStatutsFilterOpen=_useState18[1];const _useState19=Object(external_kbnSharedDeps_React_["useState"])([]),_useState20=agent_list_page_slicedToArray(_useState19,2),selectedStatus=_useState20[0],setSelectedStatus=_useState20[1];const isUsingFilter=search.trim()||selectedAgentPolicies.length||selectedStatus.length||showInactive||showUpgradeable;const clearFilters=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setSearch("");setSelectedAgentPolicies([]);setSelectedStatus([]);setShowInactive(false);setShowUpgradeable(false)},[setSearch,setSelectedAgentPolicies,setSelectedStatus,setShowInactive,setShowUpgradeable]);const addAgentPolicyFilter=policyId=>{setSelectedAgentPolicies([...selectedAgentPolicies,policyId])};const removeAgentPolicyFilter=policyId=>{setSelectedAgentPolicies(selectedAgentPolicies.filter(agentPolicy=>agentPolicy!==policyId))};const _useState21=Object(external_kbnSharedDeps_React_["useState"])(false),_useState22=agent_list_page_slicedToArray(_useState21,2),isEnrollmentFlyoutOpen=_useState22[0],setIsEnrollmentFlyoutOpen=_useState22[1];const _useState23=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState24=agent_list_page_slicedToArray(_useState23,2),agentToReassign=_useState24[0],setAgentToReassign=_useState24[1];const _useState25=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState26=agent_list_page_slicedToArray(_useState25,2),agentToUnenroll=_useState26[0],setAgentToUnenroll=_useState26[1];const _useState27=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState28=agent_list_page_slicedToArray(_useState27,2),agentToUpgrade=_useState28[0],setAgentToUpgrade=_useState28[1];let kuery=search.trim();if(selectedAgentPolicies.length){if(kuery){kuery="(".concat(kuery,") and")}kuery="".concat(kuery," ").concat(constants["c"],".policy_id : (").concat(selectedAgentPolicies.map(agentPolicy=>'"'.concat(agentPolicy,'"')).join(" or "),")")}if(selectedStatus.length){const kueryStatus=selectedStatus.map(status=>{switch(status){case"online":return services["a"].buildKueryForOnlineAgents();case"offline":return services["a"].buildKueryForOfflineAgents();case"updating":return services["a"].buildKueryForUpdatingAgents();case"error":return services["a"].buildKueryForErrorAgents()}return""}).join(" or ");if(kuery){kuery="(".concat(kuery,") and ").concat(kueryStatus)}else{kuery=kueryStatus}}const agentsRequest=Object(hooks["Q"])({page:pagination.currentPage,perPage:pagination.pageSize,kuery:kuery&&kuery!==""?kuery:undefined,showInactive:showInactive,showUpgradeable:showUpgradeable},{pollIntervalMs:REFRESH_INTERVAL_MS});const agents=agentsRequest.data?agentsRequest.data.list:[];const totalAgents=agentsRequest.data?agentsRequest.data.total:0;const totalInactiveAgents=agentsRequest.data?agentsRequest.data.totalInactive:0;const isLoading=agentsRequest.isLoading;const agentPoliciesRequest=Object(hooks["O"])({page:1,perPage:1e3});const agentPolicies=agentPoliciesRequest.data?agentPoliciesRequest.data.items:[];const agentPoliciesIndexedById=Object(external_kbnSharedDeps_React_["useMemo"])(()=>agentPolicies.reduce((acc,agentPolicy)=>{acc[agentPolicy.id]=agentPolicy;return acc},{}),[agentPolicies]);const isAgentPoliciesLoading=agentPoliciesRequest.isLoading;const columns=[{field:"local_metadata.host.hostname",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentList.hostColumnTitle",{defaultMessage:"Host"}),render:(host,agent)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:getHref("fleet_agent_details",{agentId:agent.id})},safeMetadata(host))},{field:"active",width:"120px",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentList.statusColumnTitle",{defaultMessage:"Status"}),render:(active,agent)=>external_kbnSharedDeps_React_default.a.createElement(AgentHealth,{agent:agent})},{field:"policy_id",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentList.policyColumnTitle",{defaultMessage:"Agent policy"}),render:(policyId,agent)=>{var _agentPolicies$find;const policyName=(_agentPolicies$find=agentPolicies.find(p=>p.id===policyId))===null||_agentPolicies$find===void 0?void 0:_agentPolicies$find.name;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center",style:{minWidth:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:getHref("policy_details",{policyId:policyId}),className:"eui-textTruncate",title:policyName||policyId},policyName||policyId)),agent.policy_revision&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"default",size:"xs",className:"eui-textNoWrap"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:agent.policy_revision}}))),agent.policy_id&&agent.policy_revision&&agentPoliciesIndexedById[agent.policy_id]&&agentPoliciesIndexedById[agent.policy_id].revision>agent.policy_revision&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs",className:"eui-textNoWrap"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"m",type:"alert",color:"warning"})," ",true&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.outOfDateLabel",defaultMessage:"Out-of-date"})))))}},{field:"local_metadata.elastic.agent.version",width:"200px",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentList.versionTitle",{defaultMessage:"Version"}),render:(version,agent)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center",style:{minWidth:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"eui-textNoWrap"},safeMetadata(version)),Object(services["l"])(agent,kibanaVersion)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs",className:"eui-textNoWrap"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"m",type:"alert",color:"warning"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.agentUpgradeLabel",defaultMessage:"Upgrade available"}))):null)},{field:"last_checkin",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentList.lastCheckinTitle",{defaultMessage:"Last activity"}),render:(lastCheckin,agent)=>lastCheckin?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{value:lastCheckin}):null},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentList.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:agent=>external_kbnSharedDeps_React_default.a.createElement(RowActions,{agent:agent,refresh:()=>agentsRequest.resendRequest(),onReassignClick:()=>setAgentToReassign(agent),onUnenrollClick:()=>setAgentToUnenroll(agent),onUpgradeClick:()=>setAgentToUpgrade(agent)})}],width:"100px"}];const emptyPrompt=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.noAgentsPrompt",defaultMessage:"No agents enrolled"})),actions:hasWriteCapabilites?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,iconType:"plusInCircle",onClick:()=>setIsEnrollmentFlyoutOpen(true)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.addButton",defaultMessage:"Add agent"})):null});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isEnrollmentFlyoutOpen?external_kbnSharedDeps_React_default.a.createElement(AgentEnrollmentFlyout,{agentPolicies:agentPolicies,onClose:()=>setIsEnrollmentFlyoutOpen(false)}):null,agentToReassign&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentReassignAgentPolicyFlyout,{agents:[agentToReassign],onClose:()=>{setAgentToReassign(undefined);agentsRequest.resendRequest()}})),agentToUnenroll&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentUnenrollAgentModal,{agents:[agentToUnenroll],agentCount:1,onClose:()=>{setAgentToUnenroll(undefined);agentsRequest.resendRequest()},useForceUnenroll:agentToUnenroll.status==="unenrolling"})),agentToUpgrade&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentUpgradeAgentModal,{agents:[agentToUpgrade],agentCount:1,onClose:()=>{setAgentToUpgrade(undefined);agentsRequest.resendRequest()},version:kibanaVersion})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:4},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:6},external_kbnSharedDeps_React_default.a.createElement(SearchBar,{value:search,onChange:newSearch=>{setPagination(agent_list_page_objectSpread(agent_list_page_objectSpread({},pagination),{},{currentPage:1}));setSearch(newSearch)},fieldPrefix:constants["c"]})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{ownFocus:true,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{iconType:"arrowDown",onClick:()=>setIsStatutsFilterOpen(!isStatusFilterOpen),isSelected:isStatusFilterOpen,hasActiveFilters:selectedStatus.length>0,numActiveFilters:selectedStatus.length,disabled:isAgentPoliciesLoading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.statusFilterText",defaultMessage:"Status"})),isOpen:isStatusFilterOpen,closePopover:()=>setIsStatutsFilterOpen(false),panelPaddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiFilterSelect__items"},statusFilters.map(({label:label,status:status},idx)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterSelectItem"],{key:idx,checked:selectedStatus.includes(status)?"on":undefined,onClick:()=>{if(selectedStatus.includes(status)){setSelectedStatus([...selectedStatus.filter(s=>s!==status)])}else{setSelectedStatus([...selectedStatus,status])}}},label)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{ownFocus:true,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{iconType:"arrowDown",onClick:()=>setIsAgentPoliciesFilterOpen(!isAgentPoliciesFilterOpen),isSelected:isAgentPoliciesFilterOpen,hasActiveFilters:selectedAgentPolicies.length>0,numActiveFilters:selectedAgentPolicies.length,numFilters:agentPolicies.length,disabled:isAgentPoliciesLoading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.policyFilterText",defaultMessage:"Agent policy"})),isOpen:isAgentPoliciesFilterOpen,closePopover:()=>setIsAgentPoliciesFilterOpen(false),panelPaddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiFilterSelect__items"},agentPolicies.map((agentPolicy,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterSelectItem"],{checked:selectedAgentPolicies.includes(agentPolicy.id)?"on":undefined,key:index,onClick:()=>{if(selectedAgentPolicies.includes(agentPolicy.id)){removeAgentPolicyFilter(agentPolicy.id)}else{addAgentPolicyFilter(agentPolicy.id)}}},agentPolicy.name)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{hasActiveFilters:showUpgradeable,onClick:()=>{setShowUpgradeable(!showUpgradeable)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.showUpgradeableFilterLabel",defaultMessage:"Upgrade available"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{hasActiveFilters:showInactive,onClick:()=>setShowInactive(!showInactive)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.showInactiveSwitchLabel",defaultMessage:"Inactive"}))))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(AgentBulkActions,{totalAgents:totalAgents,totalInactiveAgents:totalInactiveAgents,selectableAgents:(agents===null||agents===void 0?void 0:agents.filter(agent=>agent.active).length)||0,selectionMode:selectionMode,setSelectionMode:setSelectionMode,currentQuery:kuery,selectedAgents:selectedAgents,setSelectedAgents:newAgents=>{if(tableRef===null||tableRef===void 0?void 0:tableRef.current){tableRef.current.setSelection(newAgents);setSelectionMode("manual")}},refreshAgents:()=>agentsRequest.resendRequest()}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"none"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{ref:tableRef,className:"fleet__agentList__table","data-test-subj":"fleetAgentListTable",loading:isLoading,hasActions:true,noItemsMessage:isLoading&&agentsRequest.isInitialRequest?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.loadingAgentsMessage",defaultMessage:"Loading agents…"}):isUsingFilter?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.noFilteredAgentsPrompt",defaultMessage:"No agents found. {clearFiltersLink}",values:{clearFiltersLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{onClick:()=>clearFilters()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.clearFiltersLinkText",defaultMessage:"Clear filters"}))}}):emptyPrompt,items:totalAgents?agents:[],itemId:"id",columns:columns,pagination:{pageIndex:pagination.currentPage-1,pageSize:pagination.pageSize,totalItemCount:totalAgents,pageSizeOptions:pageSizeOptions},isSelectable:true,selection:isGoldPlus?{onSelectionChange:newAgents=>{setSelectedAgents(newAgents);setSelectionMode("manual")},selectable:agent=>agent.active}:undefined,onChange:({page:page})=>{const newPagination=agent_list_page_objectSpread(agent_list_page_objectSpread({},pagination),{},{currentPage:page.index+1,pageSize:page.size});setPagination(newPagination)}}))};function setup_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function setup_page_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){setup_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){setup_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function setup_page_slicedToArray(arr,i){return setup_page_arrayWithHoles(arr)||setup_page_iterableToArrayLimit(arr,i)||setup_page_unsupportedIterableToArray(arr,i)||setup_page_nonIterableRest()}function setup_page_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function setup_page_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return setup_page_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return setup_page_arrayLikeToArray(o,minLen)}function setup_page_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function setup_page_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function setup_page_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const RequirementItem=({isMissing:isMissing,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,isMissing?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"crossInACircleFilled",color:"danger"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"checkInCircleFilled",color:"success"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,children)));const SetupPage=({refresh:refresh,missingRequirements:missingRequirements})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=setup_page_slicedToArray(_useState,2),isFormLoading=_useState2[0],setIsFormLoading=_useState2[1];const core=Object(hooks["mb"])();const onSubmit=function(){var _ref=setup_page_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsFormLoading(true);_context.prev=1;_context.next=4;return Object(hooks["A"])({forceRecreate:true});case 4:_context.next=6;return refresh();case 6:_context.next=12;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);core.notifications.toasts.addDanger(_context.t0.message);setIsFormLoading(false);case 12:case"end":return _context.stop()}}),_callee,null,[[1,8]])})));return function onSubmit(){return _ref.apply(this,arguments)}}();if(!missingRequirements.includes("tls_required")&&!missingRequirements.includes("api_keys")&&!missingRequirements.includes("encrypted_saved_object_encryption_key_required")){return external_kbnSharedDeps_React_default.a.createElement(WithoutHeaderLayout,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageBody"],{restrictWidth:648},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],{verticalPosition:"center",horizontalPosition:"center",className:"eui-textCenter",paddingSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"lock",color:"subdued",size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"l"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.enableTitle",defaultMessage:"Enable central management for Elastic Agents"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.enableText",defaultMessage:"Central management requires an Elastic user who can create API keys and write to logs-* and metrics-*."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:onSubmit,fill:true,isLoading:isFormLoading,type:"submit"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.enableCentralManagement",defaultMessage:"Create user and enable central management"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}))))}return external_kbnSharedDeps_React_default.a.createElement(WithoutHeaderLayout,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageBody"],{restrictWidth:820},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.setupPage.missingRequirementsCalloutTitle",{defaultMessage:"Missing security requirements"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.missingRequirementsCalloutDescription",defaultMessage:"To use central management for Elastic Agents, enable the following Elasticsearch and Kibana security features."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.missingRequirementsElasticsearchTitle",defaultMessage:"In your Elasticsearch policy, enable:"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(RequirementItem,{isMissing:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.elasticsearchSecurityFlagText",defaultMessage:"{esSecurityLink}. Set {securityFlag} to {true} .",values:{esSecurityLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/configuring-security.html",target:"_blank",external:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.elasticsearchSecurityLink",defaultMessage:"Elasticsearch security"})),securityFlag:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"xpack.security.enabled"),true:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"true")}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(RequirementItem,{isMissing:missingRequirements.includes("api_keys")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.elasticsearchApiKeyFlagText",defaultMessage:"{apiKeyLink}. Set {apiKeyFlag} to {true} .",values:{apiKeyFlag:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"xpack.security.authc.api_key.enabled"),true:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"true"),apiKeyLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-settings.html#api-key-service-settings",target:"_blank",external:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.apiKeyServiceLink",defaultMessage:"API key service"}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{isCopyable:true},"xpack.security.enabled: true\nxpack.security.authc.api_key.enabled: true"),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.missingRequirementsKibanaTitle",defaultMessage:"In your Kibana policy, enable:"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(RequirementItem,{isMissing:missingRequirements.includes("tls_required")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.tlsFlagText",defaultMessage:"{kibanaSecurityLink}. Set {securityFlag} to {true}. For development purposes, you can disable {tlsLink} by setting {tlsFlag} to {true} as an unsafe alternative.",values:{kibanaSecurityLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://www.elastic.co/guide/en/kibana/current/using-kibana-with-security.html",target:"_blank",external:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.kibanaSecurityLink",defaultMessage:"Kibana security"})),securityFlag:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"xpack.security.enabled"),tlsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://www.elastic.co/guide/en/kibana/current/configuring-tls.html",target:"_blank",external:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.tlsLink",defaultMessage:"TLS"})),tlsFlag:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"xpack.fleet.agents.tlsCheckDisabled"),true:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"true")}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(RequirementItem,{isMissing:missingRequirements.includes("encrypted_saved_object_encryption_key_required")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.encryptionKeyFlagText",defaultMessage:"{encryptionKeyLink}. Set {keyFlag} to any alphanumeric value of at least 32 characters.",values:{encryptionKeyLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://www.elastic.co/guide/en/kibana/current/fleet-settings-kb.html",target:"_blank",external:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.kibanaEncryptionLink",defaultMessage:"Kibana encryption key"})),keyFlag:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"xpack.encryptedSavedObjects.encryptionKey")}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{isCopyable:true},'xpack.security.enabled: true\nxpack.encryptedSavedObjects.encryptionKey: "something_at_least_32_characters"'),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.gettingStartedText",defaultMessage:"For more information, read our {link} guide.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://www.elastic.co/guide/en/fleet/current/index.html",target:"_blank",external:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.setupPage.gettingStartedLink",defaultMessage:"Getting Started"}))}}))))};const AgentRefreshContext=external_kbnSharedDeps_React_default.a.createContext({refresh:()=>{}});function useAgentRefresh(){return external_kbnSharedDeps_React_default.a.useContext(AgentRefreshContext).refresh}var kibanaUtils_public_=__webpack_require__(25);const AGENT_LOG_INDEX_PATTERN="logs-elastic_agent-*,logs-elastic_agent.*-*";const AGENT_DATASET="elastic_agent";const AGENT_DATASET_PATTERN="elastic_agent.*";const AGENT_ID_FIELD={name:"elastic_agent.id",type:"string"};const DATASET_FIELD={name:"data_stream.dataset",type:"string",aggregatable:true};const LOG_LEVEL_FIELD={name:"log.level",type:"string",aggregatable:true};const DEFAULT_DATE_RANGE={start:"now-1d",end:"now"};const DEFAULT_LOGS_STATE={start:DEFAULT_DATE_RANGE.start,end:DEFAULT_DATE_RANGE.end,logLevels:[],datasets:[AGENT_DATASET],query:""};const AGENT_LOG_LEVELS={ERROR:"error",WARNING:"warning",INFO:"info",DEBUG:"debug"};const ORDERED_FILTER_LOG_LEVELS=["error","warning","warn","notice","info","debug"];const DEFAULT_LOG_LEVEL=AGENT_LOG_LEVELS.INFO;var url=__webpack_require__(130);var url_default=__webpack_require__.n(url);var rison=__webpack_require__(271);var query_string=__webpack_require__(135);var gte=__webpack_require__(272);var gte_default=__webpack_require__.n(gte);var coerce=__webpack_require__(19);var coerce_default=__webpack_require__.n(coerce);var data_public_=__webpack_require__(98);var infra_public_=__webpack_require__(105);function filter_dataset_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function filter_dataset_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){filter_dataset_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){filter_dataset_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function filter_dataset_slicedToArray(arr,i){return filter_dataset_arrayWithHoles(arr)||filter_dataset_iterableToArrayLimit(arr,i)||filter_dataset_unsupportedIterableToArray(arr,i)||filter_dataset_nonIterableRest()}function filter_dataset_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function filter_dataset_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return filter_dataset_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return filter_dataset_arrayLikeToArray(o,minLen)}function filter_dataset_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function filter_dataset_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function filter_dataset_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const DatasetFilter=Object(external_kbnSharedDeps_React_["memo"])(({selectedDatasets:selectedDatasets,onToggleDataset:onToggleDataset})=>{const _useStartServices=Object(hooks["mb"])(),data=_useStartServices.data;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=filter_dataset_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=filter_dataset_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])([AGENT_DATASET]),_useState6=filter_dataset_slicedToArray(_useState5,2),datasetValues=_useState6[0],setDatasetValues=_useState6[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const fetchValues=function(){var _ref=filter_dataset_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var values;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.prev=1;_context.next=4;return data.autocomplete.getValueSuggestions({indexPattern:{title:AGENT_LOG_INDEX_PATTERN,fields:[DATASET_FIELD]},field:DATASET_FIELD,query:""});case 4:values=_context.sent;setDatasetValues(values.sort());_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);setDatasetValues([AGENT_DATASET]);case 11:setIsLoading(false);case 12:case"end":return _context.stop()}}),_callee,null,[[1,8]])})));return function fetchValues(){return _ref.apply(this,arguments)}}();fetchValues()},[data.autocomplete]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{iconType:"arrowDown",onClick:()=>setIsOpen(true),isSelected:isOpen,isLoading:isLoading,numFilters:datasetValues.length,hasActiveFilters:selectedDatasets.length>0,numActiveFilters:selectedDatasets.length},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentLogs.datasetSelectText",{defaultMessage:"Dataset"})),isOpen:isOpen,closePopover:()=>setIsOpen(false),panelPaddingSize:"none"},datasetValues.map(dataset=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterSelectItem"],{checked:selectedDatasets.includes(dataset)?"on":undefined,key:dataset,onClick:()=>onToggleDataset(dataset)},dataset)))});function filter_log_level_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function filter_log_level_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){filter_log_level_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){filter_log_level_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function filter_log_level_slicedToArray(arr,i){return filter_log_level_arrayWithHoles(arr)||filter_log_level_iterableToArrayLimit(arr,i)||filter_log_level_unsupportedIterableToArray(arr,i)||filter_log_level_nonIterableRest()}function filter_log_level_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function filter_log_level_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return filter_log_level_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return filter_log_level_arrayLikeToArray(o,minLen)}function filter_log_level_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function filter_log_level_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function filter_log_level_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function sortLogLevels(levels){return[...new Set([...ORDERED_FILTER_LOG_LEVELS.filter(level=>levels.includes(level)),...levels.sort()])]}const LogLevelFilter=Object(external_kbnSharedDeps_React_["memo"])(({selectedLevels:selectedLevels,onToggleLevel:onToggleLevel})=>{const _useStartServices=Object(hooks["mb"])(),data=_useStartServices.data;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=filter_log_level_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=filter_log_level_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])([]),_useState6=filter_log_level_slicedToArray(_useState5,2),levelValues=_useState6[0],setLevelValues=_useState6[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const fetchValues=function(){var _ref=filter_log_level_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var values;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.prev=1;_context.next=4;return data.autocomplete.getValueSuggestions({indexPattern:{title:AGENT_LOG_INDEX_PATTERN,fields:[LOG_LEVEL_FIELD]},field:LOG_LEVEL_FIELD,query:""});case 4:values=_context.sent;setLevelValues(sortLogLevels(values));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);setLevelValues([]);case 11:setIsLoading(false);case 12:case"end":return _context.stop()}}),_callee,null,[[1,8]])})));return function fetchValues(){return _ref.apply(this,arguments)}}();fetchValues()},[data.autocomplete]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{iconType:"arrowDown",onClick:()=>setIsOpen(true),isSelected:isOpen,isLoading:isLoading,numFilters:levelValues.length,hasActiveFilters:selectedLevels.length>0,numActiveFilters:selectedLevels.length},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentLogs.logLevelSelectText",{defaultMessage:"Log level"})),isOpen:isOpen,closePopover:()=>setIsOpen(false),panelPaddingSize:"none"},levelValues.map(level=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterSelectItem"],{checked:selectedLevels.includes(level)?"on":undefined,key:level,onClick:()=>onToggleLevel(level)},level)))});function query_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function query_bar_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){query_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){query_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function query_bar_slicedToArray(arr,i){return query_bar_arrayWithHoles(arr)||query_bar_iterableToArrayLimit(arr,i)||query_bar_unsupportedIterableToArray(arr,i)||query_bar_nonIterableRest()}function query_bar_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function query_bar_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return query_bar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return query_bar_arrayLikeToArray(o,minLen)}function query_bar_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function query_bar_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function query_bar_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const EXCLUDED_FIELDS=[AGENT_ID_FIELD.name,DATASET_FIELD.name,LOG_LEVEL_FIELD.name];const LogQueryBar=Object(external_kbnSharedDeps_React_["memo"])(({query:query,isQueryValid:isQueryValid,onUpdateQuery:onUpdateQuery})=>{const _useStartServices=Object(hooks["mb"])(),data=_useStartServices.data;const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=query_bar_slicedToArray(_useState,2),indexPatternFields=_useState2[0],setIndexPatternFields=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const fetchFields=function(){var _ref=query_bar_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var fields;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return data.indexPatterns.getFieldsForWildcard({pattern:AGENT_LOG_INDEX_PATTERN});case 3:_context.t0=_context.sent;if(_context.t0){_context.next=6;break}_context.t0=[];case 6:fields=_context.t0.filter(field=>!EXCLUDED_FIELDS.includes(field.name));setIndexPatternFields(fields);_context.next=13;break;case 10:_context.prev=10;_context.t1=_context["catch"](0);setIndexPatternFields(undefined);case 13:case"end":return _context.stop()}}),_callee,null,[[0,10]])})));return function fetchFields(){return _ref.apply(this,arguments)}}();fetchFields()},[data.indexPatterns]);return external_kbnSharedDeps_React_default.a.createElement(data_public_["QueryStringInput"],{iconType:"search",disableLanguageSwitcher:true,indexPatterns:indexPatternFields?[{title:AGENT_LOG_INDEX_PATTERN,fields:indexPatternFields}]:[],query:{query:query,language:"kuery"},isInvalid:!isQueryValid,disableAutoFocus:true,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentLogs.searchPlaceholderText",{defaultMessage:"Search logs…"}),onChange:newQuery=>{onUpdateQuery(newQuery.query)},onSubmit:newQuery=>{onUpdateQuery(newQuery.query,true)}})});const buildQuery=({agentId:agentId,datasets:datasets,logLevels:logLevels,userQuery:userQuery})=>{const agentIdQuery="".concat(AGENT_ID_FIELD.name,":").concat(agentId);const datasetQuery=datasets.length?datasets.map(dataset=>"".concat(DATASET_FIELD.name,":").concat(dataset)).join(" or "):"".concat(DATASET_FIELD.name,":").concat(AGENT_DATASET," or ").concat(DATASET_FIELD.name,":").concat(AGENT_DATASET_PATTERN);const logLevelQuery=logLevels.map(level=>"".concat(LOG_LEVEL_FIELD.name,":").concat(level)).join(" or ");const agentQuery="".concat(agentIdQuery," and (").concat(datasetQuery,")");const baseQuery=logLevelQuery?"".concat(agentQuery," and (").concat(logLevelQuery,")"):agentQuery;const finalQuery=userQuery?"(".concat(baseQuery,") and (").concat(userQuery,")"):baseQuery;return finalQuery};function select_log_level_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function select_log_level_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){select_log_level_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){select_log_level_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function select_log_level_slicedToArray(arr,i){return select_log_level_arrayWithHoles(arr)||select_log_level_iterableToArrayLimit(arr,i)||select_log_level_unsupportedIterableToArray(arr,i)||select_log_level_nonIterableRest()}function select_log_level_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function select_log_level_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return select_log_level_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return select_log_level_arrayLikeToArray(o,minLen)}function select_log_level_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function select_log_level_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function select_log_level_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const LEVEL_VALUES=Object.values(AGENT_LOG_LEVELS);const SelectLogLevel=Object(external_kbnSharedDeps_React_["memo"])(({agent:agent})=>{var _agent$local_metadata,_agent$local_metadata2,_agent$local_metadata3,_agent$local_metadata4;const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=select_log_level_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])((_agent$local_metadata=(_agent$local_metadata2=agent.local_metadata)===null||_agent$local_metadata2===void 0?void 0:(_agent$local_metadata3=_agent$local_metadata2.elastic)===null||_agent$local_metadata3===void 0?void 0:(_agent$local_metadata4=_agent$local_metadata3.agent)===null||_agent$local_metadata4===void 0?void 0:_agent$local_metadata4.log_level)!==null&&_agent$local_metadata!==void 0?_agent$local_metadata:DEFAULT_LOG_LEVEL),_useState4=select_log_level_slicedToArray(_useState3,2),agentLogLevel=_useState4[0],setAgentLogLevel=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(agentLogLevel),_useState6=select_log_level_slicedToArray(_useState5,2),selectedLogLevel=_useState6[0],setSelectedLogLevel=_useState6[1];const onClickApply=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsLoading(true);function send(){return _send.apply(this,arguments)}function _send(){_send=select_log_level_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var res;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Object(hooks["u"])(agent.id,{action:{type:"SETTINGS",data:{log_level:selectedLogLevel}}});case 3:res=_context.sent;if(!res.error){_context.next=6;break}throw res.error;case 6:setAgentLogLevel(selectedLogLevel);notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentLogs.selectLogLevel.successText",{defaultMessage:"Changed agent logging level to '{logLevel}'.",values:{logLevel:selectedLogLevel}}));_context.next=13;break;case 10:_context.prev=10;_context.t0=_context["catch"](0);notifications.toasts.addError(_context.t0,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentLogs.selectLogLevel.errorTitleText",{defaultMessage:"Error updating agent logging level"})});case 13:setIsLoading(false);case 14:case"end":return _context.stop()}}),_callee,null,[[0,10]])})));return _send.apply(this,arguments)}send()},[notifications,selectedLogLevel,agent.id]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:"selectAgentLogLevel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentLogs.selectLogLevelLabelText",defaultMessage:"Agent logging level"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{disabled:isLoading,compressed:true,id:"selectAgentLogLevel",value:selectedLogLevel,onChange:event=>{setSelectedLogLevel(event.target.value)},options:LEVEL_VALUES.map(level=>({text:level,value:level}))})),agentLogLevel!==selectedLogLevel&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{flush:"left",size:"xs",isLoading:isLoading,disabled:agentLogLevel===selectedLogLevel,iconType:"refresh",onClick:onClickApply},isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentLogs.updateButtonLoadingText",defaultMessage:"Applying changes..."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentLogs.updateButtonText",defaultMessage:"Apply changes"}))))});function agent_logs_slicedToArray(arr,i){return agent_logs_arrayWithHoles(arr)||agent_logs_iterableToArrayLimit(arr,i)||agent_logs_unsupportedIterableToArray(arr,i)||agent_logs_nonIterableRest()}function agent_logs_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function agent_logs_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return agent_logs_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return agent_logs_arrayLikeToArray(o,minLen)}function agent_logs_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function agent_logs_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function agent_logs_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const WrapperFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"WrapperFlexGroup",componentId:"mjo9ba-0"})(["height:100%;"]);const DatePickerFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"DatePickerFlexItem",componentId:"mjo9ba-1"})(["max-width:312px;"]);const AgentLogsUrlStateHelper=Object(kibanaUtils_public_["createStateContainerReactHelpers"])();const AgentLogsUI=Object(external_kbnSharedDeps_React_["memo"])(({agent:agent,state:state})=>{var _agent$local_metadata,_agent$local_metadata2,_agent$local_metadata3;const _useStartServices=Object(hooks["mb"])(),data=_useStartServices.data,application=_useStartServices.application,http=_useStartServices.http;const _AgentLogsUrlStateHel=AgentLogsUrlStateHelper.useTransitions(),updateState=_AgentLogsUrlStateHel.update;const getDateRangeTimestamps=Object(external_kbnSharedDeps_React_["useCallback"])(timeRange=>{const _data$query$timefilte=data.query.timefilter.timefilter.calculateBounds(timeRange),min=_data$query$timefilte.min,max=_data$query$timefilte.max;return min&&max?{start:min.valueOf(),end:max.valueOf()}:undefined},[data.query.timefilter.timefilter]);const tryUpdateDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(timeRange=>{const timestamps=getDateRangeTimestamps(timeRange);if(timestamps){updateState({start:timeRange.from,end:timeRange.to})}},[getDateRangeTimestamps,updateState]);const _useState=Object(external_kbnSharedDeps_React_["useState"])(getDateRangeTimestamps({from:state.start,to:state.end})||getDateRangeTimestamps({from:DEFAULT_DATE_RANGE.start,to:DEFAULT_DATE_RANGE.end})),_useState2=agent_logs_slicedToArray(_useState,2),dateRangeTimestamps=_useState2[0],setDateRangeTimestamps=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const timestampsFromDateRange=getDateRangeTimestamps({from:state.start,to:state.end});if(!timestampsFromDateRange){tryUpdateDateRange({from:DEFAULT_DATE_RANGE.start,to:DEFAULT_DATE_RANGE.end})}else{setDateRangeTimestamps(timestampsFromDateRange)}},[state.start,state.end,getDateRangeTimestamps,tryUpdateDateRange]);const isQueryValid=Object(external_kbnSharedDeps_React_["useCallback"])(testQuery=>{try{data_public_["esKuery"].fromKueryExpression(testQuery);return true}catch(err){return false}},[]);const _useState3=Object(external_kbnSharedDeps_React_["useState"])(state.query),_useState4=agent_logs_slicedToArray(_useState3,2),draftQuery=_useState4[0],setDraftQuery=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(isQueryValid(state.query)),_useState6=agent_logs_slicedToArray(_useState5,2),isDraftQueryValid=_useState6[0],setIsDraftQueryValid=_useState6[1];const onUpdateDraftQuery=Object(external_kbnSharedDeps_React_["useCallback"])((newDraftQuery,runQuery)=>{setDraftQuery(newDraftQuery);if(isQueryValid(newDraftQuery)){setIsDraftQueryValid(true);if(runQuery){updateState({query:newDraftQuery})}}else{setIsDraftQueryValid(false)}},[isQueryValid,updateState]);const logStreamQuery=Object(external_kbnSharedDeps_React_["useMemo"])(()=>buildQuery({agentId:agent.id,datasets:state.datasets,logLevels:state.logLevels,userQuery:state.query}),[agent.id,state.datasets,state.logLevels,state.query]);const viewInLogsUrl=Object(external_kbnSharedDeps_React_["useMemo"])(()=>http.basePath.prepend(url_default.a.format({pathname:"/app/logs/stream",search:Object(query_string["stringify"])({logPosition:Object(rison["encode"])({start:state.start,end:state.end,streamLive:false}),logFilter:Object(rison["encode"])({expression:logStreamQuery,kind:"kuery"})},{sort:false,encode:false})})),[http.basePath,state.start,state.end,logStreamQuery]);const agentVersion=(_agent$local_metadata=agent.local_metadata)===null||_agent$local_metadata===void 0?void 0:(_agent$local_metadata2=_agent$local_metadata.elastic)===null||_agent$local_metadata2===void 0?void 0:(_agent$local_metadata3=_agent$local_metadata2.agent)===null||_agent$local_metadata3===void 0?void 0:_agent$local_metadata3.version;const isLogLevelSelectionAvailable=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _semverCoerce;if(!agentVersion){return false}const agentVersionWithPrerelease=(_semverCoerce=coerce_default()(agentVersion))===null||_semverCoerce===void 0?void 0:_semverCoerce.version;if(!agentVersionWithPrerelease){return false}return gte_default()(agentVersionWithPrerelease,"7.11.0")},[agentVersion]);return external_kbnSharedDeps_React_default.a.createElement(WrapperFlexGroup,{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(LogQueryBar,{query:draftQuery,onUpdateQuery:onUpdateDraftQuery,isQueryValid:isDraftQueryValid})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterGroup"],null,external_kbnSharedDeps_React_default.a.createElement(DatasetFilter,{selectedDatasets:state.datasets,onToggleDataset:dataset=>{const currentDatasets=[...state.datasets];const datasetPosition=currentDatasets.indexOf(dataset);if(datasetPosition>=0){currentDatasets.splice(datasetPosition,1);updateState({datasets:currentDatasets})}else{updateState({datasets:[...state.datasets,dataset]})}}}),external_kbnSharedDeps_React_default.a.createElement(LogLevelFilter,{selectedLevels:state.logLevels,onToggleLevel:level=>{const currentLevels=[...state.logLevels];const levelPosition=currentLevels.indexOf(level);if(levelPosition>=0){currentLevels.splice(levelPosition,1);updateState({logLevels:currentLevels})}else{updateState({logLevels:[...state.logLevels,level]})}}}))),external_kbnSharedDeps_React_default.a.createElement(DatePickerFlexItem,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperDatePicker"],{showUpdateButton:false,start:state.start,end:state.end,onTimeChange:({start:start,end:end})=>{tryUpdateDateRange({from:start,to:end})}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(public_["RedirectAppLinks"],{application:application},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{href:viewInLogsUrl,iconType:"popout",flush:"both"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentLogs.openInLogsUiLinkText",defaultMessage:"Open in Logs"})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement(infra_public_["LogStream"],{height:"100%",startTimestamp:dateRangeTimestamps.start,endTimestamp:dateRangeTimestamps.end,query:logStreamQuery}))),isLogLevelSelectionAvailable&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(SelectLogLevel,{agent:agent})))});function components_agent_logs_slicedToArray(arr,i){return components_agent_logs_arrayWithHoles(arr)||components_agent_logs_iterableToArrayLimit(arr,i)||components_agent_logs_unsupportedIterableToArray(arr,i)||components_agent_logs_nonIterableRest()}function components_agent_logs_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function components_agent_logs_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return components_agent_logs_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return components_agent_logs_arrayLikeToArray(o,minLen)}function components_agent_logs_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function components_agent_logs_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function components_agent_logs_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function agent_logs_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function agent_logs_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){agent_logs_ownKeys(Object(source),true).forEach((function(key){agent_logs_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{agent_logs_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function agent_logs_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const stateStorageKey="_q";const stateContainer=Object(kibanaUtils_public_["createStateContainer"])(agent_logs_objectSpread(agent_logs_objectSpread({},DEFAULT_LOGS_STATE),Object(kibanaUtils_public_["getStateFromKbnUrl"])(stateStorageKey,window.location.href)),{update:state=>updatedState=>agent_logs_objectSpread(agent_logs_objectSpread({},state),updatedState)});const AgentLogsConnected=AgentLogsUrlStateHelper.connect(state=>({state:state||DEFAULT_LOGS_STATE}))(AgentLogsUI);const AgentLogs=Object(external_kbnSharedDeps_React_["memo"])(({agent:agent})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=components_agent_logs_slicedToArray(_useState,2),isSyncReady=_useState2[0],setIsSyncReady=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const stateStorage=Object(kibanaUtils_public_["createKbnUrlStateStorage"])();const _syncState=Object(kibanaUtils_public_["syncState"])({storageKey:stateStorageKey,stateContainer:stateContainer,stateStorage:stateStorage}),start=_syncState.start,stop=_syncState.stop;start();setIsSyncReady(true);return()=>{stop();stateContainer.set(DEFAULT_LOGS_STATE)}},[]);return external_kbnSharedDeps_React_default.a.createElement(AgentLogsUrlStateHelper.Provider,{value:stateContainer},isSyncReady?external_kbnSharedDeps_React_default.a.createElement(AgentLogsConnected,{agent:agent}):null)});function components_actions_menu_slicedToArray(arr,i){return components_actions_menu_arrayWithHoles(arr)||components_actions_menu_iterableToArrayLimit(arr,i)||components_actions_menu_unsupportedIterableToArray(arr,i)||components_actions_menu_nonIterableRest()}function components_actions_menu_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function components_actions_menu_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return components_actions_menu_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return components_actions_menu_arrayLikeToArray(o,minLen)}function components_actions_menu_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function components_actions_menu_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function components_actions_menu_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AgentDetailsActionMenu=Object(external_kbnSharedDeps_React_["memo"])(({agent:agent,assignFlyoutOpenByDefault:assignFlyoutOpenByDefault=false,onCancelReassign:onCancelReassign})=>{const hasWriteCapabilites=Object(hooks["J"])().write;const kibanaVersion=Object(hooks["fb"])();const refreshAgent=useAgentRefresh();const _useState=Object(external_kbnSharedDeps_React_["useState"])(assignFlyoutOpenByDefault),_useState2=components_actions_menu_slicedToArray(_useState,2),isReassignFlyoutOpen=_useState2[0],setIsReassignFlyoutOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=components_actions_menu_slicedToArray(_useState3,2),isUnenrollModalOpen=_useState4[0],setIsUnenrollModalOpen=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=components_actions_menu_slicedToArray(_useState5,2),isUpgradeModalOpen=_useState6[0],setIsUpgradeModalOpen=_useState6[1];const isUnenrolling=agent.status==="unenrolling";const onClose=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(onCancelReassign){return onCancelReassign}else{return()=>setIsReassignFlyoutOpen(false)}},[onCancelReassign,setIsReassignFlyoutOpen]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isReassignFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentReassignAgentPolicyFlyout,{agents:[agent],onClose:onClose})),isUnenrollModalOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentUnenrollAgentModal,{agents:[agent],agentCount:1,onClose:()=>{setIsUnenrollModalOpen(false);refreshAgent()},useForceUnenroll:isUnenrolling})),isUpgradeModalOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(AgentUpgradeAgentModal,{agents:[agent],agentCount:1,version:kibanaVersion,onClose:()=>{setIsUpgradeModalOpen(false);refreshAgent()}})),external_kbnSharedDeps_React_default.a.createElement(ContextMenuActions,{button:{props:{iconType:"arrowDown",iconSide:"right"},children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentDetails.actionsButton",defaultMessage:"Actions"})},items:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{icon:"pencil",onClick:()=>{setIsReassignFlyoutOpen(true)},disabled:!agent.active,key:"reassignPolicy"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.reassignActionText",defaultMessage:"Assign to new policy"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{icon:"cross",disabled:!hasWriteCapabilites||!agent.active,onClick:()=>{setIsUnenrollModalOpen(true)}},isUnenrolling?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.forceUnenrollOneButton",defaultMessage:"Force unenroll"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.unenrollOneButton",defaultMessage:"Unenroll agent"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{icon:"refresh",disabled:!Object(services["l"])(agent,kibanaVersion),onClick:()=>{setIsUpgradeModalOpen(true)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.upgradeOneButton",defaultMessage:"Upgrade agent"}))]}))});const AgentDetailsContent=Object(external_kbnSharedDeps_React_["memo"])(({agent:agent,agentPolicy:agentPolicy})=>{const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const kibanaVersion=Object(hooks["fb"])();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],null,[{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.hostNameLabel",{defaultMessage:"Host name"}),description:typeof agent.local_metadata.host==="object"&&typeof agent.local_metadata.host.hostname==="string"?agent.local_metadata.host.hostname:"-"},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.hostIdLabel",{defaultMessage:"Agent ID"}),description:agent.id},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.statusLabel",{defaultMessage:"Status"}),description:external_kbnSharedDeps_React_default.a.createElement(AgentHealth,{agent:agent})},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.agentPolicyLabel",{defaultMessage:"Agent policy"}),description:agentPolicy?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:getHref("policy_details",{policyId:agent.policy_id}),className:"eui-textBreakWord"},agentPolicy.name||agent.policy_id):agent.policy_id||"-"},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.versionLabel",{defaultMessage:"Agent version"}),description:typeof agent.local_metadata.elastic==="object"&&typeof agent.local_metadata.elastic.agent==="object"&&typeof agent.local_metadata.elastic.agent.version==="string"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center",style:{minWidth:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"eui-textNoWrap"},agent.local_metadata.elastic.agent.version),Object(services["l"])(agent,kibanaVersion)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s",className:"eui-textNoWrap"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"m",type:"alert",color:"warning"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.agentUpgradeLabel",defaultMessage:"Upgrade available"}))):null):"-"},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.releaseLabel",{defaultMessage:"Agent release"}),description:typeof agent.local_metadata.elastic==="object"&&typeof agent.local_metadata.elastic.agent==="object"&&typeof agent.local_metadata.elastic.agent.snapshot==="boolean"?agent.local_metadata.elastic.agent.snapshot===true?"snapshot":"stable":"-"},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.logLevel",{defaultMessage:"Log level"}),description:typeof agent.local_metadata.elastic==="object"&&typeof agent.local_metadata.elastic.agent==="object"&&typeof agent.local_metadata.elastic.agent.log_level==="string"?agent.local_metadata.elastic.agent.log_level:"-"},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.platformLabel",{defaultMessage:"Platform"}),description:typeof agent.local_metadata.os==="object"&&typeof agent.local_metadata.os.platform==="string"?agent.local_metadata.os.platform:"-"}].map(({title:title,description:description})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:7},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,description)))))});const agent_details_page_Divider=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Divider",componentId:"vk6pn0-0"})(["width:0;height:100%;border-left:",";"],props=>props.theme.eui.euiBorderThin);const AgentDetailsPage=()=>{var _agentData$item,_agentData$item4,_agentData$item4$loca;const _useRouteMatch=Object(external_kbnSharedDeps_ReactRouterDom_["useRouteMatch"])(),_useRouteMatch$params=_useRouteMatch.params,agentId=_useRouteMatch$params.agentId,_useRouteMatch$params2=_useRouteMatch$params.tabId,tabId=_useRouteMatch$params2===void 0?"":_useRouteMatch$params2;const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const kibanaVersion=Object(hooks["fb"])();const _useGetOneAgent=Object(hooks["V"])(agentId,{pollIntervalMs:5e3}),isLoading=_useGetOneAgent.isLoading,isInitialRequest=_useGetOneAgent.isInitialRequest,error=_useGetOneAgent.error,agentData=_useGetOneAgent.data,sendAgentRequest=_useGetOneAgent.resendRequest;const _useGetOneAgentPolicy=Object(hooks["W"])(agentData===null||agentData===void 0?void 0:(_agentData$item=agentData.item)===null||_agentData$item===void 0?void 0:_agentData$item.policy_id),isAgentPolicyLoading=_useGetOneAgentPolicy.isLoading,agentPolicyData=_useGetOneAgentPolicy.data,sendAgentPolicyRequest=_useGetOneAgentPolicy.sendRequest;const _useStartServices=Object(hooks["mb"])(),navigateToApp=_useStartServices.application.navigateToApp;const routeState=useIntraAppState();const queryParams=new URLSearchParams(Object(external_kbnSharedDeps_ReactRouterDom_["useLocation"])().search);const openReassignFlyoutOpenByDefault=queryParams.get("openReassignFlyout")==="true";const reassignCancelClickHandler=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(routeState&&routeState.onDoneNavigateTo){navigateToApp(routeState.onDoneNavigateTo[0],routeState.onDoneNavigateTo[1])}},[routeState,navigateToApp]);const headerLeftContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _agentData$item2,_agentData$item2$loca,_agentData$item3,_agentData$item3$loca,_agentData$item3$loca2;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"arrowLeft",href:getHref("fleet_agent_list"),flush:"left",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentDetails.viewAgentListTitle",defaultMessage:"View all agents"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,isLoading&&isInitialRequest?external_kbnSharedDeps_React_default.a.createElement(Loading,null):typeof(agentData===null||agentData===void 0?void 0:(_agentData$item2=agentData.item)===null||_agentData$item2===void 0?void 0:(_agentData$item2$loca=_agentData$item2.local_metadata)===null||_agentData$item2$loca===void 0?void 0:_agentData$item2$loca.host)==="object"&&typeof(agentData===null||agentData===void 0?void 0:(_agentData$item3=agentData.item)===null||_agentData$item3===void 0?void 0:(_agentData$item3$loca=_agentData$item3.local_metadata)===null||_agentData$item3$loca===void 0?void 0:(_agentData$item3$loca2=_agentData$item3$loca.host)===null||_agentData$item3$loca2===void 0?void 0:_agentData$item3$loca2.hostname)==="string"?agentData.item.local_metadata.host.hostname:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentDetails.agentDetailsTitle",defaultMessage:"Agent '{id}'",values:{id:agentId}})))))},[agentData===null||agentData===void 0?void 0:(_agentData$item4=agentData.item)===null||_agentData$item4===void 0?void 0:(_agentData$item4$loca=_agentData$item4.local_metadata)===null||_agentData$item4$loca===void 0?void 0:_agentData$item4$loca.host,agentId,getHref,isInitialRequest,isLoading]);const headerRightContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>agentData&&agentData.item?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd",direction:"row"},[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.statusLabel",{defaultMessage:"Status"}),content:external_kbnSharedDeps_React_default.a.createElement(AgentHealth,{agent:agentData.item})},{isDivider:true},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.policyLabel",{defaultMessage:"Policy"}),content:isAgentPolicyLoading?external_kbnSharedDeps_React_default.a.createElement(Loading,{size:"m"}):(agentPolicyData===null||agentPolicyData===void 0?void 0:agentPolicyData.item)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:getHref("policy_details",{policyId:agentData.item.policy_id}),className:"eui-textBreakWord"},agentPolicyData.item.name||agentData.item.policy_id):agentData.item.policy_id||"-"},{isDivider:true},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.agentVersionLabel",{defaultMessage:"Agent version"}),content:typeof agentData.item.local_metadata.elastic==="object"&&typeof agentData.item.local_metadata.elastic.agent==="object"&&typeof agentData.item.local_metadata.elastic.agent.version==="string"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"eui-textNoWrap"},agentData.item.local_metadata.elastic.agent.version),Object(services["l"])(agentData.item,kibanaVersion)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.upgradeAvailableTooltip",{defaultMessage:"Upgrade available"}),size:"m",type:"alert",color:"warning",content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.upgradeAvailableTooltip",{defaultMessage:"Upgrade available"})})):null):"-"},{isDivider:true},{content:external_kbnSharedDeps_React_default.a.createElement(AgentDetailsActionMenu,{agent:agentData.item,assignFlyoutOpenByDefault:openReassignFlyoutOpenByDefault,onCancelReassign:routeState&&routeState.onDoneNavigateTo?reassignCancelClickHandler:undefined})}].map((item,index)=>{var _item$isDivider;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:index},((_item$isDivider=item.isDivider)!==null&&_item$isDivider!==void 0?_item$isDivider:false)?external_kbnSharedDeps_React_default.a.createElement(agent_details_page_Divider,null):item.label?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{compressed:true,textStyle:"reverse",style:{textAlign:"right"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,item.label),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,item.content)):item.content)})):undefined,[agentPolicyData,agentData,getHref,isAgentPolicyLoading]);const headerTabs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{id:"details",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.subTabs.detailsTab",{defaultMessage:"Agent details"}),href:getHref("fleet_agent_details",{agentId:agentId,tabId:"details"}),isSelected:!tabId||tabId==="details"},{id:"logs",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.subTabs.logsTab",{defaultMessage:"Logs"}),href:getHref("fleet_agent_details",{agentId:agentId,tabId:"logs"}),isSelected:tabId==="logs"}],[getHref,agentId,tabId]);return external_kbnSharedDeps_React_default.a.createElement(AgentRefreshContext.Provider,{value:{refresh:()=>{sendAgentRequest();sendAgentPolicyRequest()}}},external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:headerLeftContent,rightColumn:headerRightContent,tabs:headerTabs},isLoading&&isInitialRequest?external_kbnSharedDeps_React_default.a.createElement(Loading,null):error?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentDetails.unexceptedErrorTitle",defaultMessage:"Error loading agent"}),error:error}):agentData&&agentData.item?external_kbnSharedDeps_React_default.a.createElement(AgentDetailsPageContent,{agent:agentData.item,agentPolicy:agentPolicyData===null||agentPolicyData===void 0?void 0:agentPolicyData.item}):external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentDetails.agentNotFoundErrorTitle",defaultMessage:"Agent not found"}),error:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentDetails.agentNotFoundErrorDescription",{defaultMessage:"Cannot find agent ID {agentId}",values:{agentId:agentId}})})))};const AgentDetailsPageContent=({agent:agent,agentPolicy:agentPolicy})=>{Object(hooks["I"])("fleet_agent_details",{agentHost:typeof agent.local_metadata.host==="object"&&typeof agent.local_metadata.host.hostname==="string"?agent.local_metadata.host.hostname:"-"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].fleet_agent_details_logs,render:()=>external_kbnSharedDeps_React_default.a.createElement(AgentLogs,{agent:agent})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].fleet_agent_details,render:()=>external_kbnSharedDeps_React_default.a.createElement(AgentDetailsContent,{agent:agent,agentPolicy:agentPolicy})}))};const NoDataLayout=Object(external_kbnSharedDeps_ReactRouterDom_["withRouter"])(({actionSection:actionSection,title:title,modalClosePath:modalClosePath,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"logoBeats",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,title),body:children,actions:actionSection})))));const NoAccessPage=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(({intl:intl})=>external_kbnSharedDeps_React_default.a.createElement(NoDataLayout,{title:intl.formatMessage({id:"xpack.fleet.noAccess.accessDeniedTitle",defaultMessage:"Access denied"}),actionSection:[]},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.noAccess.accessDeniedDescription",defaultMessage:"You are not authorized to access Elastic Fleet. To use Elastic Fleet, you need a user role that contains read or all permissions for this application."}))));function new_enrollment_key_flyout_extends(){new_enrollment_key_flyout_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return new_enrollment_key_flyout_extends.apply(this,arguments)}function new_enrollment_key_flyout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function new_enrollment_key_flyout_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){new_enrollment_key_flyout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){new_enrollment_key_flyout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function new_enrollment_key_flyout_slicedToArray(arr,i){return new_enrollment_key_flyout_arrayWithHoles(arr)||new_enrollment_key_flyout_iterableToArrayLimit(arr,i)||new_enrollment_key_flyout_unsupportedIterableToArray(arr,i)||new_enrollment_key_flyout_nonIterableRest()}function new_enrollment_key_flyout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function new_enrollment_key_flyout_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return new_enrollment_key_flyout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return new_enrollment_key_flyout_arrayLikeToArray(o,minLen)}function new_enrollment_key_flyout_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function new_enrollment_key_flyout_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function new_enrollment_key_flyout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function useCreateApiKeyForm(policyIdDefaultValue,onSuccess){const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=new_enrollment_key_flyout_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];const apiKeyNameInput=Object(hooks["db"])("");const policyIdInput=Object(hooks["db"])(policyIdDefaultValue);const onSubmit=function(){var _ref=new_enrollment_key_flyout_asyncToGenerator(regeneratorRuntime.mark((function _callee(event){var res;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();setIsLoading(true);_context.prev=2;_context.next=5;return Object(hooks["E"])({method:"post",path:services["g"].getCreatePath(),body:JSON.stringify({name:apiKeyNameInput.value,policy_id:policyIdInput.value})});case 5:res=_context.sent;policyIdInput.clear();apiKeyNameInput.clear();setIsLoading(false);onSuccess(res.data.item.id);notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.newEnrollmentKey.keyCreatedToasts",{defaultMessage:"Enrollment token created."}));_context.next=17;break;case 13:_context.prev=13;_context.t0=_context["catch"](2);notifications.toasts.addError(_context.t0,{title:"Error"});setIsLoading(false);case 17:case"end":return _context.stop()}}),_callee,null,[[2,13]])})));return function onSubmit(_x){return _ref.apply(this,arguments)}}();return{isLoading:isLoading,onSubmit:onSubmit,policyIdInput:policyIdInput,apiKeyNameInput:apiKeyNameInput}}const NewEnrollmentTokenFlyout=({onClose:onClose,agentPolicies:agentPolicies=[]})=>{var _agentPolicies$find;const policyIdDefaultValue=(_agentPolicies$find=agentPolicies.find(agentPolicy=>agentPolicy.is_default))===null||_agentPolicies$find===void 0?void 0:_agentPolicies$find.id;const form=useCreateApiKeyForm(policyIdDefaultValue,()=>{onClose()});const body=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,external_kbnSharedDeps_React_default.a.createElement("form",{onSubmit:form.onSubmit},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.newEnrollmentKey.nameLabel",{defaultMessage:"Name"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],new_enrollment_key_flyout_extends({required:true,name:"name",autoComplete:"off"},form.apiKeyNameInput.props))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.newEnrollmentKey.policyLabel",{defaultMessage:"Policy"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],new_enrollment_key_flyout_extends({required:true,defaultValue:policyIdDefaultValue},form.policyIdInput.props,{options:agentPolicies.map(agentPolicy=>({value:agentPolicy.id,text:agentPolicy.name}))}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{type:"submit",fill:true,isLoading:form.isLoading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.newEnrollmentKey.submitButton",defaultMessage:"Create enrollment token"}))));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyout"],{onClose:onClose,size:"l",maxWidth:640},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true,"aria-labelledby":"FleetNewEnrollmentKeyFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"FleetNewEnrollmentKeyFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.newEnrollmentKey.flyoutTitle",defaultMessage:"Create enrollment token"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutBody"],null,body),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.newEnrollmentKey.cancelButtonLabel",defaultMessage:"Cancel"}))))))};const ConfirmEnrollmentTokenDelete=props=>{const onCancel=props.onCancel,onConfirm=props.onConfirm,enrollmentKey=props.enrollmentKey;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokenDeleteModal.title",{defaultMessage:"Revoke enrollment token"}),onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokenDeleteModal.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokenDeleteModal.deleteButton",{defaultMessage:"Revoke enrollment token"}),defaultFocusedButton:"confirm",buttonColor:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokenDeleteModal.description",{defaultMessage:"Are your sure you want to revoke {keyName}? Agents that use this token will no longer be able to access policies or send data. ",values:{keyName:enrollmentKey.name}}),color:"danger"})))};function enrollment_token_list_page_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function enrollment_token_list_page_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){enrollment_token_list_page_ownKeys(Object(source),true).forEach((function(key){enrollment_token_list_page_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{enrollment_token_list_page_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function enrollment_token_list_page_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function enrollment_token_list_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function enrollment_token_list_page_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){enrollment_token_list_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){enrollment_token_list_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function enrollment_token_list_page_slicedToArray(arr,i){return enrollment_token_list_page_arrayWithHoles(arr)||enrollment_token_list_page_iterableToArrayLimit(arr,i)||enrollment_token_list_page_unsupportedIterableToArray(arr,i)||enrollment_token_list_page_nonIterableRest()}function enrollment_token_list_page_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function enrollment_token_list_page_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return enrollment_token_list_page_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return enrollment_token_list_page_arrayLikeToArray(o,minLen)}function enrollment_token_list_page_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function enrollment_token_list_page_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function enrollment_token_list_page_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ApiKeyField=({apiKeyId:apiKeyId})=>{const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useState=Object(external_kbnSharedDeps_React_["useState"])("HIDDEN"),_useState2=enrollment_token_list_page_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=enrollment_token_list_page_slicedToArray(_useState3,2),key=_useState4[0],setKey=_useState4[1];const toggleKey=function(){var _ref=enrollment_token_list_page_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _res$data,res;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(state==="VISIBLE")){_context.next=4;break}setState("HIDDEN");_context.next=20;break;case 4:if(!(state==="HIDDEN")){_context.next=20;break}_context.prev=5;setState("LOADING");_context.next=9;return Object(hooks["p"])(apiKeyId);case 9:res=_context.sent;if(!res.error){_context.next=12;break}throw res.error;case 12:setKey((_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.item.api_key);setState("VISIBLE");_context.next=20;break;case 16:_context.prev=16;_context.t0=_context["catch"](5);notifications.toasts.addError(_context.t0,{title:"Error"});setState("HIDDEN");case 20:case"end":return _context.stop()}}),_callee,null,[[5,16]])})));return function toggleKey(){return _ref.apply(this,arguments)}}();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},state==="VISIBLE"?key:"•••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••")),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:state==="VISIBLE"?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.hideTokenButtonLabel",{defaultMessage:"Hide token"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.showTokenButtonLabel",{defaultMessage:"Show token"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":state==="VISIBLE"?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.hideTokenButtonLabel",{defaultMessage:"Hide token"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.showTokenButtonLabel",{defaultMessage:"Show token"}),color:"text",isDisabled:state==="LOADING",onClick:toggleKey,iconType:state==="VISIBLE"?"eyeClosed":"eye"}))))};const DeleteButton=({apiKey:apiKey,refresh:refresh})=>{const _useStartServices2=Object(hooks["mb"])(),notifications=_useStartServices2.notifications;const _useState5=Object(external_kbnSharedDeps_React_["useState"])("CONFIRM_HIDDEN"),_useState6=enrollment_token_list_page_slicedToArray(_useState5,2),state=_useState6[0],setState=_useState6[1];const onCancel=()=>setState("CONFIRM_HIDDEN");const onConfirm=function(){var _ref2=enrollment_token_list_page_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var res;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return Object(hooks["i"])(apiKey.id);case 3:res=_context2.sent;if(!res.error){_context2.next=6;break}throw res.error;case 6:_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2["catch"](0);notifications.toasts.addError(_context2.t0,{title:"Error"});case 11:setState("CONFIRM_HIDDEN");refresh();case 13:case"end":return _context2.stop()}}),_callee2,null,[[0,8]])})));return function onConfirm(){return _ref2.apply(this,arguments)}}();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,state==="CONFIRM_VISIBLE"&&external_kbnSharedDeps_React_default.a.createElement(ConfirmEnrollmentTokenDelete,{enrollmentKey:apiKey,onCancel:onCancel,onConfirm:onConfirm}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.revokeTokenButtonLabel",{defaultMessage:"Revoke token"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.revokeTokenButtonLabel",{defaultMessage:"Revoke token"}),onClick:()=>setState("CONFIRM_VISIBLE"),iconType:"trash",color:"danger"})))};const EnrollmentTokenListPage=()=>{var _enrollmentAPIKeysReq,_enrollmentAPIKeysReq2,_enrollmentAPIKeysReq3,_enrollmentAPIKeysReq4;Object(hooks["I"])("fleet_enrollment_tokens");const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=enrollment_token_list_page_slicedToArray(_useState7,2),flyoutOpen=_useState8[0],setFlyoutOpen=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])(""),_useState10=enrollment_token_list_page_slicedToArray(_useState9,2),search=_useState10[0],setSearch=_useState10[1];const _usePagination=Object(hooks["jb"])(),pagination=_usePagination.pagination,setPagination=_usePagination.setPagination,pageSizeOptions=_usePagination.pageSizeOptions;const enrollmentAPIKeysRequest=Object(hooks["T"])({page:pagination.currentPage,perPage:pagination.pageSize,kuery:search.trim()!==""?search:undefined});const agentPoliciesRequest=Object(hooks["O"])({page:1,perPage:1e3});const agentPolicies=agentPoliciesRequest.data?agentPoliciesRequest.data.items:[];const total=(_enrollmentAPIKeysReq=enrollmentAPIKeysRequest===null||enrollmentAPIKeysRequest===void 0?void 0:(_enrollmentAPIKeysReq2=enrollmentAPIKeysRequest.data)===null||_enrollmentAPIKeysReq2===void 0?void 0:_enrollmentAPIKeysReq2.total)!==null&&_enrollmentAPIKeysReq!==void 0?_enrollmentAPIKeysReq:0;const items=(_enrollmentAPIKeysReq3=enrollmentAPIKeysRequest===null||enrollmentAPIKeysRequest===void 0?void 0:(_enrollmentAPIKeysReq4=enrollmentAPIKeysRequest.data)===null||_enrollmentAPIKeysReq4===void 0?void 0:_enrollmentAPIKeysReq4.list)!==null&&_enrollmentAPIKeysReq3!==void 0?_enrollmentAPIKeysReq3:[];const columns=[{field:"name",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.nameTitle",{defaultMessage:"Name"}),render:value=>external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate",title:value},value)},{field:"id",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.secretTitle",{defaultMessage:"Secret"}),width:"215px",render:apiKeyId=>external_kbnSharedDeps_React_default.a.createElement(ApiKeyField,{apiKeyId:apiKeyId})},{field:"policy_id",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.policyTitle",{defaultMessage:"Agent policy"}),render:policyId=>{const agentPolicy=agentPolicies.find(c=>c.id===policyId);const value=agentPolicy?agentPolicy.name:policyId;return external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate",title:value},value)}},{field:"created_at",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.createdAtTitle",{defaultMessage:"Created on"}),width:"150px",render:createdAt=>createdAt?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedDate"],{year:"numeric",month:"short",day:"2-digit",value:createdAt}):null},{field:"active",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.activeTitle",{defaultMessage:"Active"}),width:"70px",align:"center",render:active=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"m",color:active?"success":"danger",type:"dot"})},{field:"actions",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.enrollmentTokensList.actionsTitle",{defaultMessage:"Actions"}),width:"70px",render:(_,apiKey)=>apiKey.active&&external_kbnSharedDeps_React_default.a.createElement(DeleteButton,{apiKey:apiKey,refresh:()=>enrollmentAPIKeysRequest.resendRequest()})}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,flyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(NewEnrollmentTokenFlyout,{agentPolicies:agentPolicies,onClose:()=>{setFlyoutOpen(false);enrollmentAPIKeysRequest.resendRequest()}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollmentTokensList.pageDescription",defaultMessage:"Create and revoke enrollment tokens. An enrollment token enables one or more agents to enroll in Fleet and send data."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(SearchBar,{value:search,onChange:newSearch=>{setPagination(enrollment_token_list_page_objectSpread(enrollment_token_list_page_objectSpread({},pagination),{},{currentPage:1}));setSearch(newSearch)},fieldPrefix:constants["e"]})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"plusInCircle",onClick:()=>setFlyoutOpen(true)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollmentTokensList.newKeyButton",defaultMessage:"Create enrollment token"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{loading:enrollmentAPIKeysRequest.isLoading&&enrollmentAPIKeysRequest.isInitialRequest,hasActions:true,noItemsMessage:enrollmentAPIKeysRequest.isLoading&&enrollmentAPIKeysRequest.isInitialRequest?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollemntAPIKeyList.loadingTokensMessage",defaultMessage:"Loading enrollment tokens..."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.enrollemntAPIKeyList.emptyMessage",defaultMessage:"No enrollment tokens found."}),items:total?items:[],itemId:"id",columns:columns,pagination:{pageIndex:pagination.currentPage-1,pageSize:pagination.pageSize,totalItemCount:total,pageSizeOptions:pageSizeOptions},onChange:({page:page})=>{const newPagination=enrollment_token_list_page_objectSpread(enrollment_token_list_page_objectSpread({},pagination),{},{currentPage:page.index+1,pageSize:page.size});setPagination(newPagination)}}))};var d3=__webpack_require__(273);var d3_default=__webpack_require__.n(d3);const DonutChart=({height:height,width:width,data:data})=>{const chartElement=Object(external_kbnSharedDeps_React_["useRef"])(null);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(chartElement.current!==null){d3_default.a.selectAll("g").remove();const svgElement=d3_default.a.select(chartElement.current).append("g").attr("transform","translate(".concat(width/2,", ").concat(height/2,")"));const color=d3_default.a.scale.ordinal().domain(data).range(["#017D73","#98A2B3","#BD271E","#F5A700"]);const pieGenerator=d3_default.a.layout.pie().value(({value:value})=>value).startAngle(2*Math.PI).endAngle(0);svgElement.selectAll("g").data(pieGenerator(d3_default.a.entries(data))).enter().append("path").attr("d",d3_default.a.svg.arc().innerRadius(width*.36).outerRadius(Math.min(width,height)/2)).attr("fill",d=>color(d.data.key))}},[data,height,width]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("svg",{ref:chartElement,width:width,height:height}))};function list_layout_slicedToArray(arr,i){return list_layout_arrayWithHoles(arr)||list_layout_iterableToArrayLimit(arr,i)||list_layout_unsupportedIterableToArray(arr,i)||list_layout_nonIterableRest()}function list_layout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function list_layout_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return list_layout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return list_layout_arrayLikeToArray(o,minLen)}function list_layout_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function list_layout_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function list_layout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const list_layout_REFRESH_INTERVAL_MS=5e3;const list_layout_Divider=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Divider",componentId:"sc-1brv1kj-0"})(["width:0;height:100%;border-left:",";height:45px;"],props=>props.theme.eui.euiBorderThin);const ListLayout=({children:children})=>{var _agentStatusRequest$d,_agentStatus$total,_agentStatus$online,_agentStatus$offline,_agentStatus$error;const _useLink=Object(hooks["hb"])(),getHref=_useLink.getHref;const hasWriteCapabilites=Object(hooks["J"])().write;const agentStatusRequest=useGetAgentStatus(undefined,{pollIntervalMs:list_layout_REFRESH_INTERVAL_MS});const agentStatus=(_agentStatusRequest$d=agentStatusRequest.data)===null||_agentStatusRequest$d===void 0?void 0:_agentStatusRequest$d.results;const _React$useState=external_kbnSharedDeps_React_default.a.useState(false),_React$useState2=list_layout_slicedToArray(_React$useState,2),isEnrollmentFlyoutOpen=_React$useState2[0],setIsEnrollmentFlyoutOpen=_React$useState2[1];const headerRightColumn=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiStat"],{titleSize:"xs",textAlign:"right",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:(_agentStatus$total=agentStatus===null||agentStatus===void 0?void 0:agentStatus.total)!==null&&_agentStatus$total!==void 0?_agentStatus$total:0}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentListStatus.totalLabel",{defaultMessage:"Agents"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(DonutChart,{width:40,height:40,data:{online:(agentStatus===null||agentStatus===void 0?void 0:agentStatus.online)||0,offline:(agentStatus===null||agentStatus===void 0?void 0:agentStatus.offline)||0,error:(agentStatus===null||agentStatus===void 0?void 0:agentStatus.error)||0,other:(agentStatus===null||agentStatus===void 0?void 0:agentStatus.other)||0}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiStat"],{textAlign:"right",titleSize:"xs",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"success"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:(_agentStatus$online=agentStatus===null||agentStatus===void 0?void 0:agentStatus.online)!==null&&_agentStatus$online!==void 0?_agentStatus$online:0})),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentListStatus.onlineLabel",{defaultMessage:"Online"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiStat"],{textAlign:"right",titleSize:"xs",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:(_agentStatus$offline=agentStatus===null||agentStatus===void 0?void 0:agentStatus.offline)!==null&&_agentStatus$offline!==void 0?_agentStatus$offline:0}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentListStatus.offlineLabel",{defaultMessage:"Offline"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiStat"],{textAlign:"right",titleSize:"xs",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiI18nNumber"],{value:(_agentStatus$error=agentStatus===null||agentStatus===void 0?void 0:agentStatus.error)!==null&&_agentStatus$error!==void 0?_agentStatus$error:0}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.agentListStatus.errorLabel",{defaultMessage:"Error"})})),hasWriteCapabilites&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(list_layout_Divider,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,iconType:"plusInCircle",onClick:()=>setIsEnrollmentFlyoutOpen(true)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agentList.enrollButton",defaultMessage:"Add agent"})))));const headerLeftColumn=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agents.pageTitle",defaultMessage:"Agents"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.agents.pageSubtitle",defaultMessage:"Manage and deploy policy updates to a group of agents of any size."})))));const agentPoliciesRequest=Object(hooks["O"])({page:1,perPage:1e3});const agentPolicies=agentPoliciesRequest.data?agentPoliciesRequest.data.items:[];const routeMatch=Object(external_kbnSharedDeps_ReactRouterDom_["useRouteMatch"])();return external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:headerLeftColumn,rightColumn:headerRightColumn,tabs:[{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.listTabs.agentTitle",defaultMessage:"Agents"}),isSelected:routeMatch.path===constants["h"].fleet_agent_list,href:getHref("fleet_agent_list")},{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.listTabs.enrollmentTokensTitle",defaultMessage:"Enrollment tokens"}),isSelected:routeMatch.path===constants["h"].fleet_enrollment_tokens,href:getHref("fleet_enrollment_tokens")}]},isEnrollmentFlyoutOpen?external_kbnSharedDeps_React_default.a.createElement(AgentEnrollmentFlyout,{agentPolicies:agentPolicies,onClose:()=>setIsEnrollmentFlyoutOpen(false)}):null,children)};const FleetApp=()=>{Object(hooks["I"])("fleet");const _useConfig=Object(hooks["L"])(),agents=_useConfig.agents;const capabilities=Object(hooks["J"])();const fleetStatus=Object(hooks["N"])();if(!agents.enabled)return null;if(fleetStatus.isLoading){return external_kbnSharedDeps_React_default.a.createElement(Loading,null)}if(fleetStatus.isReady===false){return external_kbnSharedDeps_React_default.a.createElement(SetupPage,{missingRequirements:fleetStatus.missingRequirements||[],refresh:fleetStatus.refresh})}if(!capabilities.read){return external_kbnSharedDeps_React_default.a.createElement(NoAccessPage,null)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["HashRouter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].fleet,exact:true,render:()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:constants["h"].fleet_agent_list})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].fleet_agent_details},external_kbnSharedDeps_React_default.a.createElement(AgentDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].fleet_agent_list},external_kbnSharedDeps_React_default.a.createElement(ListLayout,null,external_kbnSharedDeps_React_default.a.createElement(AgentListPage,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].fleet_enrollment_tokens},external_kbnSharedDeps_React_default.a.createElement(ListLayout,null,external_kbnSharedDeps_React_default.a.createElement(EnrollmentTokenListPage,null)))))};function fleet_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function fleet_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){fleet_ownKeys(Object(source),true).forEach((function(key){fleet_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{fleet_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function fleet_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function fleet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function fleet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){fleet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){fleet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function fleet_slicedToArray(arr,i){return fleet_arrayWithHoles(arr)||fleet_iterableToArrayLimit(arr,i)||fleet_unsupportedIterableToArray(arr,i)||fleet_nonIterableRest()}function fleet_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fleet_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return fleet_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fleet_arrayLikeToArray(o,minLen)}function fleet_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function fleet_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function fleet_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function fleet_objectWithoutProperties(source,excluded){if(source==null)return{};var target=fleet_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function fleet_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const ProtectedRoute=_ref=>{let _ref$isAllowed=_ref.isAllowed,isAllowed=_ref$isAllowed===void 0?false:_ref$isAllowed,_ref$restrictedPath=_ref.restrictedPath,restrictedPath=_ref$restrictedPath===void 0?"/":_ref$restrictedPath,routeProps=fleet_objectWithoutProperties(_ref,["isAllowed","restrictedPath"]);return isAllowed?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],routeProps):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:{pathname:restrictedPath}})};const fleet_Panel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"Panel",componentId:"qc0x3f-0"})(["max-width:500px;margin-right:auto;margin-left:auto;"]);const ErrorLayout=({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiErrorBoundary"],null,external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{showSettings:false},external_kbnSharedDeps_React_default.a.createElement(WithoutHeaderLayout,null,children)));const IngestManagerRoutes=Object(external_kbnSharedDeps_React_["memo"])(_ref2=>{let history=_ref2.history,rest=fleet_objectWithoutProperties(_ref2,["history"]);Object(hooks["I"])("base");const _useConfig=Object(hooks["L"])(),agents=_useConfig.agents;const _useStartServices=Object(hooks["mb"])(),notifications=_useStartServices.notifications;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=fleet_slicedToArray(_useState,2),isPermissionsLoading=_useState2[0],setIsPermissionsLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=fleet_slicedToArray(_useState3,2),permissionsError=_useState4[0],setPermissionsError=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=fleet_slicedToArray(_useState5,2),isInitialized=_useState6[0],setIsInitialized=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(null),_useState8=fleet_slicedToArray(_useState7,2),initializationError=_useState8[0],setInitializationError=_useState8[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{fleet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _permissionsResponse$,permissionsResponse,setupResponse,_permissionsResponse$2;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsPermissionsLoading(false);setPermissionsError(undefined);setIsInitialized(false);setInitializationError(null);_context.prev=4;setIsPermissionsLoading(true);_context.next=8;return Object(hooks["s"])();case 8:permissionsResponse=_context.sent;setIsPermissionsLoading(false);if(!((_permissionsResponse$=permissionsResponse.data)===null||_permissionsResponse$===void 0?void 0:_permissionsResponse$.success)){_context.next=24;break}_context.prev=11;_context.next=14;return Object(hooks["F"])();case 14:setupResponse=_context.sent;if(setupResponse.error){setInitializationError(setupResponse.error)}_context.next=21;break;case 18:_context.prev=18;_context.t0=_context["catch"](11);setInitializationError(_context.t0);case 21:setIsInitialized(true);_context.next=25;break;case 24:setPermissionsError(((_permissionsResponse$2=permissionsResponse.data)===null||_permissionsResponse$2===void 0?void 0:_permissionsResponse$2.error)||"REQUEST_ERROR");case 25:_context.next=30;break;case 27:_context.prev=27;_context.t1=_context["catch"](4);setPermissionsError("REQUEST_ERROR");case 30:case"end":return _context.stop()}}),_callee,null,[[4,27],[11,18]])})))()},[]);if(isPermissionsLoading||permissionsError){return external_kbnSharedDeps_React_default.a.createElement(ErrorLayout,null,isPermissionsLoading?external_kbnSharedDeps_React_default.a.createElement(Loading,null):permissionsError==="REQUEST_ERROR"?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.permissionsRequestErrorMessageTitle",defaultMessage:"Unable to check permissions"}),error:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.fleet.permissionsRequestErrorMessageDescription",{defaultMessage:"There was a problem checking Fleet permissions"})}):external_kbnSharedDeps_React_default.a.createElement(fleet_Panel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"securityApp",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,permissionsError==="MISSING_SUPERUSER_ROLE"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.permissionDeniedErrorTitle",defaultMessage:"Permission denied"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.securityRequiredErrorTitle",defaultMessage:"Security is not enabled"})),body:external_kbnSharedDeps_React_default.a.createElement("p",null,permissionsError==="MISSING_SUPERUSER_ROLE"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.permissionDeniedErrorMessage",defaultMessage:"You are not authorized to access Fleet. Fleet requires {roleName} privileges.",values:{roleName:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"superuser")}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.securityRequiredErrorMessage",defaultMessage:"You must enable security in Kibana and Elasticsearch to use Fleet."}))})))}if(!isInitialized||initializationError){return external_kbnSharedDeps_React_default.a.createElement(ErrorLayout,null,initializationError?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.fleet.initializationErrorMessageTitle",defaultMessage:"Unable to initialize Fleet"}),error:initializationError}):external_kbnSharedDeps_React_default.a.createElement(Loading,null))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiErrorBoundary"],null,external_kbnSharedDeps_React_default.a.createElement(hooks["b"],null,external_kbnSharedDeps_React_default.a.createElement(IntraAppStateProvider,{kibanaScopedHistory:history},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["HashRouter"],rest,external_kbnSharedDeps_React_default.a.createElement(epm_hooks["a"],{notifications:notifications},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].integrations},external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{section:"epm"},external_kbnSharedDeps_React_default.a.createElement(EPMApp,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].policies},external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{section:"agent_policy"},external_kbnSharedDeps_React_default.a.createElement(AgentPolicyApp,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:constants["h"].data_streams},external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{section:"data_stream"},external_kbnSharedDeps_React_default.a.createElement(DataStreamApp,null))),external_kbnSharedDeps_React_default.a.createElement(ProtectedRoute,{path:constants["h"].fleet,isAllowed:agents.enabled},external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{section:"fleet"},external_kbnSharedDeps_React_default.a.createElement(FleetApp,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:constants["h"].overview},external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{section:"overview"},external_kbnSharedDeps_React_default.a.createElement(IngestManagerOverview,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:"/"})))))))});const IngestManagerApp=({basepath:basepath,startServices:startServices,config:config,history:history,kibanaVersion:kibanaVersion,extensions:extensions})=>{const isDarkMode=useObservable_default()(startServices.uiSettings.get$("theme:darkMode"));return external_kbnSharedDeps_React_default.a.createElement(startServices.i18n.Context,null,external_kbnSharedDeps_React_default.a.createElement(public_["KibanaContextProvider"],{services:fleet_objectSpread({},startServices)},external_kbnSharedDeps_React_default.a.createElement(hooks["a"].Provider,{value:config},external_kbnSharedDeps_React_default.a.createElement(hooks["c"].Provider,{value:kibanaVersion},external_kbnSharedDeps_React_default.a.createElement(EuiThemeProvider,{darkMode:isDarkMode},external_kbnSharedDeps_React_default.a.createElement(UIExtensionsContext.Provider,{value:extensions},external_kbnSharedDeps_React_default.a.createElement(IngestManagerRoutes,{history:history,basepath:basepath})))))))};function renderApp(startServices,{element:element,appBasePath:appBasePath,history:history},config,kibanaVersion,extensions){external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(IngestManagerApp,{basepath:appBasePath,startServices:startServices,config:config,history:history,kibanaVersion:kibanaVersion,extensions:extensions}),element);return()=>{external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(element)}}const teardownFleet=coreStart=>{coreStart.chrome.docTitle.reset();coreStart.chrome.setBreadcrumbs([]);hooks["d"].stop()}}])]);