/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["security_bundle_jsonpfunction"]=window["security_bundle_jsonpfunction"]||[]).push([[15],{300:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"APIKeysGridPage",(function(){return api_keys_grid_page_APIKeysGridPage}));var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);var external_kbnSharedDeps_MomentTimezone_=__webpack_require__(69);var external_kbnSharedDeps_MomentTimezone_default=__webpack_require__.n(external_kbnSharedDeps_MomentTimezone_);var public_=__webpack_require__(70);const PermissionDenied=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],{horizontalPosition:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"securityApp",title:external_kbnSharedDeps_React_default.a.createElement("h2",{"data-test-subj":"apiKeysPermissionDeniedMessage"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.deniedPermissionTitle",defaultMessage:"You need permission to manage API keys"})),body:external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"permissionDeniedMessage"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.noPermissionToManageRolesDescription",defaultMessage:"Contact your system administrator."}))})));const EmptyPrompt=({isAdmin:isAdmin,docLinks:docLinks,navigateToApp:navigateToApp})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"managementApp",title:external_kbnSharedDeps_React_default.a.createElement("h1",{"data-test-subj":"noApiKeysHeader"},isAdmin?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.emptyPromptAdminTitle",defaultMessage:"No API keys"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.emptyPromptNonAdminTitle",defaultMessage:"You don't have any API keys"})),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.emptyPromptDescription",defaultMessage:"You can create an {link} from Console.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"".concat(docLinks.getCreateApiKeyDocUrl()),target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.emptyPromptDocsLinkMessage",defaultMessage:"API key"}))}}))),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{type:"primary",onClick:()=>navigateToApp("dev_tools"),"data-test-subj":"goToConsoleButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.emptyPromptConsoleButtonMessage",defaultMessage:"Go to Console"})),"data-test-subj":"emptyPrompt"});const NotEnabled=({docLinks:docLinks})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.apiKeysDisabledErrorTitle",defaultMessage:"API keys not enabled in Elasticsearch"}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.apiKeysDisabledErrorDescription",defaultMessage:"Contact your system administrator and refer to the {link} to enable API keys.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"".concat(docLinks.getApiKeyServiceSettingsDocUrl()),target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.apiKeysDisabledErrorLinkText",defaultMessage:"docs"}))}}));function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const InvalidateProvider=({isAdmin:isAdmin,children:children,notifications:notifications,apiKeysAPIClient:apiKeysAPIClient})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])([]),_useState2=_slicedToArray(_useState,2),apiKeys=_useState2[0],setApiKeys=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=_slicedToArray(_useState3,2),isModalOpen=_useState4[0],setIsModalOpen=_useState4[1];const onSuccessCallback=Object(external_kbnSharedDeps_React_["useRef"])(null);const invalidateApiKeyPrompt=(keys,onSuccess=(()=>undefined))=>{if(!keys||!keys.length){throw new Error("No API key IDs specified for invalidation")}setIsModalOpen(true);setApiKeys(keys);onSuccessCallback.current=onSuccess};const closeModal=()=>{setIsModalOpen(false);setApiKeys([])};const invalidateApiKey=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result,error,errors,_result,itemsInvalidated,_result2,hasMultipleSuccesses,successMessage,hasMultipleErrors,errorMessage;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return apiKeysAPIClient.invalidateApiKeys(apiKeys,isAdmin);case 3:result=_context.sent;_context.next=9;break;case 6:_context.prev=6;_context.t0=_context["catch"](0);error=_context.t0;case 9:closeModal();if(result){_result=result,itemsInvalidated=_result.itemsInvalidated;_result2=result;errors=_result2.errors;if(itemsInvalidated&&itemsInvalidated.length){hasMultipleSuccesses=itemsInvalidated.length>1;successMessage=hasMultipleSuccesses?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.invalidateApiKey.successMultipleNotificationTitle",{defaultMessage:"Invalidated {count} API keys",values:{count:itemsInvalidated.length}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.invalidateApiKey.successSingleNotificationTitle",{defaultMessage:"Invalidated API key '{name}'",values:{name:itemsInvalidated[0].name}});notifications.toasts.addSuccess(successMessage);if(onSuccessCallback.current){onSuccessCallback.current([...itemsInvalidated])}}}if(error||errors&&errors.length){hasMultipleErrors=errors&&errors.length>1||error&&apiKeys.length>1;errorMessage=hasMultipleErrors?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.invalidateApiKey.errorMultipleNotificationTitle",{defaultMessage:"Error deleting {count} apiKeys",values:{count:errors&&errors.length||apiKeys.length}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.invalidateApiKey.errorSingleNotificationTitle",{defaultMessage:"Error deleting API key '{name}'",values:{name:errors&&errors[0].name||apiKeys[0].name}});notifications.toasts.addDanger(errorMessage)}case 12:case"end":return _context.stop()}}),_callee,null,[[0,6]])})));return function invalidateApiKey(){return _ref.apply(this,arguments)}}();const renderModal=()=>{if(!isModalOpen){return null}const isSingle=apiKeys.length===1;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:isSingle?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.invalidateApiKey.confirmModal.invalidateSingleTitle",{defaultMessage:"Invalidate API key '{name}'?",values:{name:apiKeys[0].name}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.invalidateApiKey.confirmModal.invalidateMultipleTitle",{defaultMessage:"Invalidate {count} API keys?",values:{count:apiKeys.length}}),onCancel:closeModal,onConfirm:invalidateApiKey,cancelButtonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.invalidateApiKey.confirmModal.cancelButtonLabel",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.invalidateApiKey.confirmModal.confirmButtonLabel",{defaultMessage:"Invalidate {count, plural, one {API key} other {API keys}}",values:{count:apiKeys.length}}),buttonColor:"danger","data-test-subj":"invalidateApiKeyConfirmationModal"},!isSingle?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.invalidateApiKey.confirmModal.invalidateMultipleListDescription",{defaultMessage:"You are about to invalidate these API keys:"})),external_kbnSharedDeps_React_default.a.createElement("ul",null,apiKeys.map(({name:name,id:id})=>external_kbnSharedDeps_React_default.a.createElement("li",{key:id},name)))):null))};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,children(invalidateApiKeyPrompt),renderModal())};function api_keys_grid_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function api_keys_grid_page_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){api_keys_grid_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){api_keys_grid_page_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const DATE_FORMAT="MMMM Do YYYY HH:mm:ss";class api_keys_grid_page_APIKeysGridPage extends external_kbnSharedDeps_React_["Component"]{constructor(props){var _this;super(props);_this=this;_defineProperty(this,"renderTable",()=>{const _this$state=this.state,apiKeys=_this$state.apiKeys,selectedItems=_this$state.selectedItems,isLoadingTable=_this$state.isLoadingTable,isAdmin=_this$state.isAdmin;const message=isLoadingTable?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.apiKeysTableLoadingMessage",defaultMessage:"Loading API keys…"}):undefined;const sorting={sort:{field:"expiration",direction:"asc"}};const pagination={initialPageSize:20,pageSizeOptions:[10,20,50]};const selection={onSelectionChange:newSelectedItems=>{this.setState({selectedItems:newSelectedItems})}};const search={toolsLeft:selectedItems.length?external_kbnSharedDeps_React_default.a.createElement(InvalidateProvider,{isAdmin:isAdmin,notifications:this.props.notifications,apiKeysAPIClient:this.props.apiKeysAPIClient},invalidateApiKeyPrompt=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:()=>invalidateApiKeyPrompt(selectedItems.map(({name:name,id:id})=>({name:name,id:id})),this.onApiKeysInvalidated),color:"danger","data-test-subj":"bulkInvalidateActionButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.invalidateApiKeyButton",defaultMessage:"Invalidate {count, plural, one {API key} other {API keys}}",values:{count:selectedItems.length}}))):undefined,toolsRight:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"secondary",iconType:"refresh",onClick:()=>this.reloadApiKeys(),"data-test-subj":"reloadButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.reloadApiKeysButton",defaultMessage:"Reload"})),box:{incremental:true},filters:isAdmin?[{type:"field_value_selection",field:"username",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.userFilterLabel",{defaultMessage:"User"}),multiSelect:false,options:Object.keys(apiKeys.reduce((apiKeysMap,apiKey)=>{apiKeysMap[apiKey.username]=true;return apiKeysMap},{})).map(username=>({value:username,view:username}))},{type:"field_value_selection",field:"realm",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.realmFilterLabel",{defaultMessage:"Realm"}),multiSelect:false,options:Object.keys(apiKeys.reduce((apiKeysMap,apiKey)=>{apiKeysMap[apiKey.realm]=true;return apiKeysMap},{})).map(realm=>({value:realm,view:realm}))}]:undefined};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isAdmin?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.adminText",defaultMessage:"You are an API Key administrator."}),color:"success",iconType:"user",size:"s","data-test-subj":"apiKeyAdminDescriptionCallOut"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"})):undefined,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiInMemoryTable"],{items:apiKeys,itemId:"id",columns:this.getColumnConfig(),search:search,sorting:sorting,selection:selection,pagination:pagination,loading:isLoadingTable,message:message,isSelectable:true,rowProps:()=>({"data-test-subj":"apiKeyRow"})}))});_defineProperty(this,"getColumnConfig",()=>{const isAdmin=this.state.isAdmin;let config=[{field:"name",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.nameColumnName",{defaultMessage:"Name"}),sortable:true}];if(isAdmin){config=config.concat([{field:"username",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.userNameColumnName",{defaultMessage:"User"}),sortable:true},{field:"realm",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.realmColumnName",{defaultMessage:"Realm"}),sortable:true}])}config=config.concat([{field:"creation",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.creationDateColumnName",{defaultMessage:"Created"}),sortable:true,render:creationDateMs=>external_kbnSharedDeps_MomentTimezone_default()(creationDateMs).format(DATE_FORMAT)},{field:"expiration",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.expirationDateColumnName",{defaultMessage:"Expires"}),sortable:true,render:expirationDateMs=>{if(expirationDateMs===undefined){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.expirationDateNeverMessage",{defaultMessage:"Never"}))}return external_kbnSharedDeps_MomentTimezone_default()(expirationDateMs).format(DATE_FORMAT)}},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.statusColumnName",{defaultMessage:"Status"}),render:({expiration:expiration})=>{const now=Date.now();if(now>expiration){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow"},"Expired")}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"secondary"},"Active")}},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.actionsColumnName",{defaultMessage:"Actions"}),actions:[{render:({name:name,id:id})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(InvalidateProvider,{isAdmin:isAdmin,notifications:this.props.notifications,apiKeysAPIClient:this.props.apiKeysAPIClient},invalidateApiKeyPrompt=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.actionDeleteTooltip",{defaultMessage:"Invalidate"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.actionDeleteAriaLabel",{defaultMessage:"Invalidate '{name}'",values:{name:name}}),iconType:"minusInCircle",color:"danger","data-test-subj":"invalidateApiKeyButton",onClick:()=>invalidateApiKeyPrompt([{id:id,name:name}],this.onApiKeysInvalidated)})))))}]}]);return config});_defineProperty(this,"onApiKeysInvalidated",apiKeysInvalidated=>{if(apiKeysInvalidated.length){this.reloadApiKeys()}});_defineProperty(this,"initiallyLoadApiKeys",()=>{this.setState({isLoadingApp:true,isLoadingTable:false});this.loadApiKeys()});_defineProperty(this,"reloadApiKeys",()=>{this.setState({apiKeys:[],isLoadingApp:false,isLoadingTable:true});this.loadApiKeys()});_defineProperty(this,"loadApiKeys",api_keys_grid_page_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var isAdmin,_yield$_this$props$ap,apiKeys;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;isAdmin=_this.state.isAdmin;_context.next=4;return _this.props.apiKeysAPIClient.getApiKeys(isAdmin);case 4:_yield$_this$props$ap=_context.sent;apiKeys=_yield$_this$props$ap.apiKeys;_this.setState({apiKeys:apiKeys});_context.next=12;break;case 9:_context.prev=9;_context.t0=_context["catch"](0);_this.setState({error:_context.t0});case 12:_this.setState({isLoadingApp:false,isLoadingTable:false});case 13:case"end":return _context.stop()}}),_callee,null,[[0,9]])}))));this.state={isLoadingApp:true,isLoadingTable:false,isAdmin:false,canManage:false,areApiKeysEnabled:false,apiKeys:[],selectedItems:[],error:undefined}}componentDidMount(){this.checkPrivileges()}render(){const _this$state2=this.state,isLoadingApp=_this$state2.isLoadingApp,isLoadingTable=_this$state2.isLoadingTable,areApiKeysEnabled=_this$state2.areApiKeysEnabled,isAdmin=_this$state2.isAdmin,canManage=_this$state2.canManage,error=_this$state2.error,apiKeys=_this$state2.apiKeys;if(isLoadingApp){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,external_kbnSharedDeps_React_default.a.createElement(public_["SectionLoading"],{"data-test-subj":"apiKeysSectionLoading"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.loadingApiKeysDescription",defaultMessage:"Loading API keys…"})))}if(!canManage){return external_kbnSharedDeps_React_default.a.createElement(PermissionDenied,null)}if(error){const _error$body=error.body,errorTitle=_error$body.error,message=_error$body.message,statusCode=_error$body.statusCode;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.loadingApiKeysErrorTitle",defaultMessage:"Error loading API keys"}),color:"danger",iconType:"alert","data-test-subj":"apiKeysError"},statusCode,": ",errorTitle," - ",message))}if(!areApiKeysEnabled){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,external_kbnSharedDeps_React_default.a.createElement(NotEnabled,{docLinks:this.props.docLinks}))}if(!isLoadingTable&&apiKeys&&apiKeys.length===0){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,external_kbnSharedDeps_React_default.a.createElement(EmptyPrompt,{isAdmin:isAdmin,docLinks:this.props.docLinks,navigateToApp:this.props.navigateToApp}))}const description=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s","data-test-subj":"apiKeysDescriptionText"},external_kbnSharedDeps_React_default.a.createElement("p",null,isAdmin?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.apiKeysAllDescription",defaultMessage:"View and invalidate API keys. An API key sends requests on behalf of a user."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.apiKeysOwnDescription",defaultMessage:"View and invalidate your API keys. An API key sends requests on your behalf."})));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentHeader"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentHeaderSection"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],null,external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.apiKeys.table.apiKeysTitle",defaultMessage:"API Keys"}))),description)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentBody"],null,this.renderTable()))}checkPrivileges(){var _this2=this;return api_keys_grid_page_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _yield$_this2$props$a,isAdmin,canManage,areApiKeysEnabled,_e$body$message,_e$body;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _this2.props.apiKeysAPIClient.checkPrivileges();case 3:_yield$_this2$props$a=_context2.sent;isAdmin=_yield$_this2$props$a.isAdmin;canManage=_yield$_this2$props$a.canManage;areApiKeysEnabled=_yield$_this2$props$a.areApiKeysEnabled;_this2.setState({isAdmin:isAdmin,canManage:canManage,areApiKeysEnabled:areApiKeysEnabled});if(!canManage||!areApiKeysEnabled){_this2.setState({isLoadingApp:false})}else{_this2.initiallyLoadApiKeys()}_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2["catch"](0);_this2.props.notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.apiKeys.table.fetchingApiKeysErrorMessage",{defaultMessage:"Error checking privileges: {message}",values:{message:(_e$body$message=(_e$body=_context2.t0.body)===null||_e$body===void 0?void 0:_e$body.message)!==null&&_e$body$message!==void 0?_e$body$message:""}}));case 14:case"end":return _context2.stop()}}),_callee2,null,[[0,11]])})))()}}}}]);