/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["security_bundle_jsonpfunction"]=window["security_bundle_jsonpfunction"]||[]).push([[8],{306:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"UsersGridPage",(function(){return users_grid_page_UsersGridPage}));var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);var components=__webpack_require__(93);var user_utils=__webpack_require__(89);var management_badges=__webpack_require__(81);var role_table_display=__webpack_require__(95);var public_=__webpack_require__(15);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class users_grid_page_UsersGridPage extends external_kbnSharedDeps_React_["Component"]{constructor(props){super(props);_defineProperty(this,"handleDelete",(usernames,errors)=>{const users=this.state.users;const filteredUsers=users.filter(({username:username})=>!usernames.includes(username)||errors.includes(username));this.setState({selection:[],showDeleteConfirmation:false,users:filteredUsers,visibleUsers:this.getVisibleUsers(filteredUsers,this.state.filter,this.state.includeReservedUsers)})});_defineProperty(this,"getVisibleUsers",(users,filter,includeReservedUsers)=>users.filter(({username:username,roles:userRoles,full_name:fullName="",email:email="",metadata:metadata={}})=>{const normalized="".concat(username," ").concat(userRoles.join(" ")," ").concat(fullName," ").concat(email).toLowerCase();const normalizedQuery=filter.toLowerCase();return normalized.indexOf(normalizedQuery)!==-1&&(includeReservedUsers||!metadata._reserved)}));_defineProperty(this,"onIncludeReservedUsersChange",e=>{this.setState({includeReservedUsers:e.target.checked,visibleUsers:this.getVisibleUsers(this.state.users,this.state.filter,e.target.checked)})});_defineProperty(this,"getUserStatusBadges",user=>{const enabled=user.enabled;const reserved=Object(user_utils["c"])(user);const deprecated=Object(user_utils["b"])(user);const badges=[];if(!enabled){badges.push(external_kbnSharedDeps_React_default.a.createElement(management_badges["b"],{"data-test-subj":"userDisabled"}))}if(reserved){badges.push(external_kbnSharedDeps_React_default.a.createElement(management_badges["d"],{"data-test-subj":"userReserved",tooltipContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.reservedUserBadgeTooltip",defaultMessage:"Reserved users are built-in and cannot be edited or removed."})}))}if(deprecated){badges.push(external_kbnSharedDeps_React_default.a.createElement(management_badges["a"],{"data-test-subj":"userDeprecated",tooltipContent:Object(user_utils["a"])(user)}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",wrap:true},badges.map((badge,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:index,grow:false},badge)))});_defineProperty(this,"onCancelDelete",()=>{this.setState({showDeleteConfirmation:false})});this.state={users:[],visibleUsers:[],roles:[],selection:[],showDeleteConfirmation:false,permissionDenied:false,filter:"",includeReservedUsers:true}}componentDidMount(){this.loadUsersAndRoles()}render(){const _this$state=this.state,users=_this$state.users,roles=_this$state.roles,permissionDenied=_this$state.permissionDenied,showDeleteConfirmation=_this$state.showDeleteConfirmation,selection=_this$state.selection;if(permissionDenied){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],{horizontalPosition:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"securityApp",title:external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.deniedPermissionTitle",defaultMessage:"You need permission to manage users"})),body:external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"permissionDeniedMessage"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.permissionDeniedToManageUsersDescription",defaultMessage:"Contact your system administrator."}))})))}const columns=[{field:"username",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.userNameColumnName",{defaultMessage:"User Name"}),sortable:true,truncateText:true,render:username=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],_extends({"data-test-subj":"userRowUserName"},Object(public_["reactRouterNavigate"])(this.props.history,"/edit/".concat(encodeURIComponent(username)))),username)},{field:"full_name",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.fullNameColumnName",{defaultMessage:"Full Name"}),sortable:true,truncateText:true,render:fullName=>external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"userRowFullName"},fullName)},{field:"email",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.emailAddressColumnName",{defaultMessage:"Email Address"}),sortable:true,truncateText:true,render:email=>external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"userRowEmail"},email)},{field:"roles",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.rolesColumnName",{defaultMessage:"Roles"}),width:"30%",render:rolenames=>{const roleLinks=rolenames.map((rolename,index)=>{var _roles$find;const roleDefinition=(_roles$find=roles===null||roles===void 0?void 0:roles.find(role=>role.name===rolename))!==null&&_roles$find!==void 0?_roles$find:rolename;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:rolename},external_kbnSharedDeps_React_default.a.createElement(role_table_display["a"],{role:roleDefinition,navigateToApp:this.props.navigateToApp}))});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":"userRowRoles",gutterSize:"s",wrap:true},roleLinks)}},{field:"metadata",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.statusColumnName",{defaultMessage:"Status"}),width:"10%",sortable:({metadata:metadata})=>Boolean(metadata&&metadata._reserved),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.reservedColumnDescription",{defaultMessage:"Reserved users are built-in and cannot be removed. Only the password can be changed."}),render:(metadata,record)=>this.getUserStatusBadges(record)}];const pagination={initialPageSize:20,pageSizeOptions:[10,20,50,100]};const selectionConfig={itemId:"username",selectable:user=>!(user.metadata&&user.metadata._reserved),selectableMessage:selectable=>!selectable?"User is a system user":"",onSelectionChange:updatedSelection=>this.setState({selection:updatedSelection})};const search={toolsLeft:this.renderToolsLeft(),toolsRight:this.renderToolsRight(),box:{incremental:true,"data-test-subj":"searchUsers"},onChange:query=>{this.setState({filter:query.queryText,visibleUsers:this.getVisibleUsers(this.state.users,query.queryText,this.state.includeReservedUsers)})}};const sorting={sort:{field:"username",direction:"asc"}};const rowProps=()=>({"data-test-subj":"userRow"});return external_kbnSharedDeps_React_default.a.createElement("div",{className:"secUsersListingPage"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],{className:"secUsersListingPage__content"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentHeader"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentHeaderSection"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.usersTitle",defaultMessage:"Users"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentHeaderSection"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],_extends({"data-test-subj":"createUserButton"},Object(public_["reactRouterNavigate"])(this.props.history,"/edit/")),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.createNewUserButtonLabel",defaultMessage:"Create user"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentBody"],null,showDeleteConfirmation?external_kbnSharedDeps_React_default.a.createElement(components["b"],{onCancel:this.onCancelDelete,usersToDelete:selection.map(user=>user.username),callback:this.handleDelete,userAPIClient:this.props.userAPIClient,notifications:this.props.notifications}):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiInMemoryTable"],{itemId:"username",tableCaption:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.tableCaption",{defaultMessage:"Users"}),rowHeader:"username",columns:columns,selection:selectionConfig,pagination:pagination,items:this.state.visibleUsers,loading:users.length===0,search:search,sorting:sorting,rowProps:rowProps,isSelectable:true}))))}loadUsersAndRoles(){var _this=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$Promise$all,_yield$Promise$all2,users,roles;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all([_this.props.userAPIClient.getUsers(),_this.props.rolesAPIClient.getRoles()]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);users=_yield$Promise$all2[0];roles=_yield$Promise$all2[1];_this.setState({users:users,roles:roles,visibleUsers:_this.getVisibleUsers(users,_this.state.filter,_this.state.includeReservedUsers)});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context["catch"](0);if(_context.t0.body.statusCode===403){_this.setState({permissionDenied:true})}else{_this.props.notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.fetchingUsersErrorMessage",{defaultMessage:"Error fetching users: {message}",values:{message:_context.t0.body.message}}))}case 13:case"end":return _context.stop()}}),_callee,null,[[0,10]])})))()}renderToolsLeft(){const selection=this.state.selection;if(selection.length===0){return}const numSelected=selection.length;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"deleteUserButton",color:"danger",onClick:()=>this.setState({showDeleteConfirmation:true})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.deleteUsersButtonLabel",defaultMessage:"Delete {numSelected} user{numSelected, plural, one { } other {s}}",values:{numSelected:numSelected}}))}renderToolsRight(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{"data-test-subj":"showReservedUsersSwitch",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.showReservedUsersLabel",defaultMessage:"Show reserved users"}),checked:this.state.includeReservedUsers,onChange:this.onIncludeReservedUsersChange})}}},75:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return change_password_form_ChangePasswordForm}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var external_kbnSharedDeps_Lodash_=__webpack_require__(14);var external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getInitialState(){return{shouldValidate:false,currentPassword:"",newPassword:"",confirmPassword:"",currentPasswordError:false,changeInProgress:false}}class change_password_form_ChangePasswordForm extends external_kbnSharedDeps_React_["Component"]{constructor(props){var _this;super(props);_this=this;_defineProperty(this,"getForm",()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,this.props.isUserChangingOwnPassword&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],_extends({},this.validateCurrentPassword(),{fullWidth:true,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.account.changePasswordForm.currentPasswordLabel",defaultMessage:"Current password"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldPassword"],{autoComplete:"off","data-test-subj":"currentPassword",type:"dual",value:this.state.currentPassword,onChange:this.onCurrentPasswordChange,disabled:this.state.changeInProgress,fullWidth:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],_extends({helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.account.changePasswordForm.passwordRequirements",defaultMessage:"Use at least 6 characters."})},this.validateNewPassword(),{fullWidth:true,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.account.changePasswordForm.newPasswordLabel",defaultMessage:"New password"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldPassword"],{autoComplete:"new-password","data-test-subj":"newPassword",type:"dual",value:this.state.newPassword,onChange:this.onNewPasswordChange,disabled:this.state.changeInProgress,fullWidth:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],_extends({},this.validateConfirmPassword(),{fullWidth:true,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.account.changePasswordForm.confirmPasswordLabel",defaultMessage:"Confirm new password"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldPassword"],{autoComplete:"new-password","data-test-subj":"confirmNewPassword",type:"dual",value:this.state.confirmPassword,onChange:this.onConfirmPasswordChange,disabled:this.state.changeInProgress,fullWidth:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:this.onChangePasswordClick,fill:true,isLoading:this.state.changeInProgress,"data-test-subj":"changePasswordButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.account.changePasswordForm.saveChangesButtonLabel",defaultMessage:"Change password"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:this.onCancelClick,isDisabled:this.state.changeInProgress},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.account.changePasswordForm.cancelButtonLabel",defaultMessage:"Reset"})))))));_defineProperty(this,"onCurrentPasswordChange",e=>{this.setState({currentPassword:e.target.value,currentPasswordError:false})});_defineProperty(this,"onNewPasswordChange",e=>{this.setState({newPassword:e.target.value})});_defineProperty(this,"onConfirmPasswordChange",e=>{this.setState({confirmPassword:e.target.value})});_defineProperty(this,"onCancelClick",()=>{this.setState(getInitialState())});_defineProperty(this,"onChangePasswordClick",_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_this.setState({shouldValidate:true,currentPasswordError:false},()=>{const _this$validateForm=_this.validateForm(),isInvalid=_this$validateForm.isInvalid;if(isInvalid){return}_this.setState({changeInProgress:true},()=>_this.performPasswordChange())});case 1:case"end":return _context.stop()}}),_callee)}))));_defineProperty(this,"validateCurrentPassword",(shouldValidate=this.state.shouldValidate)=>{if(!shouldValidate||!this.props.isUserChangingOwnPassword){return{isInvalid:false}}if(this.state.currentPasswordError){return{isInvalid:true,error:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.account.changePasswordForm.invalidPassword",defaultMessage:"Current password is incorrect."})}}if(!this.state.currentPassword){return{isInvalid:true,error:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.account.currentPasswordRequired",defaultMessage:"Current password is required."})}}return{isInvalid:false}});_defineProperty(this,"validateNewPassword",(shouldValidate=this.state.shouldValidate)=>{const newPassword=this.state.newPassword;const minPasswordLength=6;if(shouldValidate&&newPassword.length<minPasswordLength){return{isInvalid:true,error:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.account.passwordLengthDescription",defaultMessage:"Password is too short."})}}return{isInvalid:false}});_defineProperty(this,"validateConfirmPassword",(shouldValidate=this.state.shouldValidate)=>{const _this$state=this.state,newPassword=_this$state.newPassword,confirmPassword=_this$state.confirmPassword;if(shouldValidate&&newPassword!==confirmPassword){return{isInvalid:true,error:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.account.passwordsDoNotMatch",defaultMessage:"Passwords do not match."})}}return{isInvalid:false}});_defineProperty(this,"validateForm",()=>{const validation=[this.validateCurrentPassword(true),this.validateNewPassword(true),this.validateConfirmPassword(true)];const firstFailure=validation.find(result=>result.isInvalid);if(firstFailure){return firstFailure}return{isInvalid:false}});_defineProperty(this,"performPasswordChange",_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _this.props.userAPIClient.changePassword(_this.props.user.username,_this.state.newPassword,_this.state.currentPassword);case 3:_this.handleChangePasswordSuccess();_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2["catch"](0);_this.handleChangePasswordFailure(_context2.t0);case 9:_context2.prev=9;_this.setState({changeInProgress:false});return _context2.finish(9);case 12:case"end":return _context2.stop()}}),_callee2,null,[[0,6,9,12]])}))));_defineProperty(this,"handleChangePasswordSuccess",()=>{this.props.notifications.toasts.addSuccess({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.account.changePasswordSuccess",{defaultMessage:"Your password has been changed."}),"data-test-subj":"passwordUpdateSuccess"});this.setState({currentPasswordError:false,shouldValidate:false,newPassword:"",currentPassword:"",confirmPassword:""});if(this.props.onChangePassword){this.props.onChangePassword()}});_defineProperty(this,"handleChangePasswordFailure",error=>{if(error.body&&error.body.statusCode===403){this.setState({currentPasswordError:true})}else{this.props.notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.editUser.settingPasswordErrorMessage",{defaultMessage:"Error setting password: {message}",values:{message:external_kbnSharedDeps_Lodash_default.a.get(error,"body.message")}}))}});this.state=getInitialState()}render(){return this.getForm()}}},81:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DeprecatedBadge}));__webpack_require__.d(__webpack_exports__,"b",(function(){return DisabledBadge}));__webpack_require__.d(__webpack_exports__,"c",(function(){return EnabledBadge}));__webpack_require__.d(__webpack_exports__,"d",(function(){return ReservedBadge}));var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);const OptionalToolTip=props=>{if(props.tooltipContent){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:props.tooltipContent},props.children)}return props.children};const DeprecatedBadge=props=>external_kbnSharedDeps_React_default.a.createElement(OptionalToolTip,{tooltipContent:props.tooltipContent},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{"data-test-subj":props["data-test-subj"],color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.deprecatedBadge",defaultMessage:"Deprecated"})));const DisabledBadge=props=>external_kbnSharedDeps_React_default.a.createElement(OptionalToolTip,{tooltipContent:props.tooltipContent},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{"data-test-subj":props["data-test-subj"],color:"hollow"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.disabledBadge",defaultMessage:"Disabled"})));const EnabledBadge=props=>external_kbnSharedDeps_React_default.a.createElement(OptionalToolTip,{tooltipContent:props.tooltipContent},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{"data-test-subj":props["data-test-subj"],color:"secondary"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.enabledBadge",defaultMessage:"Enabled"})));const ReservedBadge=props=>external_kbnSharedDeps_React_default.a.createElement(OptionalToolTip,{tooltipContent:props.tooltipContent},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{"data-test-subj":props["data-test-subj"],color:"primary"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.reservedBadge",defaultMessage:"Reserved"})))},89:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return isUserReserved}));__webpack_require__.d(__webpack_exports__,"b",(function(){return isUserDeprecated}));__webpack_require__.d(__webpack_exports__,"a",(function(){return getExtendedUserDeprecationNotice}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);const isUserReserved=user=>{var _user$metadata$_reser,_user$metadata;return(_user$metadata$_reser=(_user$metadata=user.metadata)===null||_user$metadata===void 0?void 0:_user$metadata._reserved)!==null&&_user$metadata$_reser!==void 0?_user$metadata$_reser:false};const isUserDeprecated=user=>{var _user$metadata$_depre,_user$metadata2;return(_user$metadata$_depre=(_user$metadata2=user.metadata)===null||_user$metadata2===void 0?void 0:_user$metadata2._deprecated)!==null&&_user$metadata$_depre!==void 0?_user$metadata$_depre:false};const getExtendedUserDeprecationNotice=user=>{var _user$metadata$_depre2,_user$metadata3;const reason=(_user$metadata$_depre2=(_user$metadata3=user.metadata)===null||_user$metadata3===void 0?void 0:_user$metadata3._deprecated_reason)!==null&&_user$metadata$_depre2!==void 0?_user$metadata$_depre2:"";return _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.security.management.users.extendedUserDeprecationNotice",{defaultMessage:"The {username} user is deprecated. {reason}",values:{username:user.username,reason:reason}})}},93:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return change_password_form["a"]}));__webpack_require__.d(__webpack_exports__,"b",(function(){return confirm_delete_users_ConfirmDeleteUsers}));var change_password_form=__webpack_require__(75);var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class confirm_delete_users_ConfirmDeleteUsers extends external_kbnSharedDeps_React_["Component"]{constructor(...args){super(...args);_defineProperty(this,"deleteUsers",()=>{const _this$props=this.props,usersToDelete=_this$props.usersToDelete,callback=_this$props.callback,userAPIClient=_this$props.userAPIClient,notifications=_this$props.notifications;const errors=[];usersToDelete.forEach(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(username){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return userAPIClient.deleteUser(username);case 3:notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.confirmDelete.userSuccessfullyDeletedNotificationMessage",{defaultMessage:"Deleted user {username}",values:{username:username}}));_context.next=10;break;case 6:_context.prev=6;_context.t0=_context["catch"](0);errors.push(username);notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.confirmDelete.userDeletingErrorNotificationMessage",{defaultMessage:"Error deleting user {username}",values:{username:username}}));case 10:if(callback){callback(usersToDelete,errors)}case 11:case"end":return _context.stop()}}),_callee,null,[[0,6]])})));return function(_x){return _ref.apply(this,arguments)}}())})}render(){const _this$props2=this.props,usersToDelete=_this$props2.usersToDelete,onCancel=_this$props2.onCancel;const moreThanOne=usersToDelete.length>1;const title=moreThanOne?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.confirmDelete.deleteMultipleUsersTitle",{defaultMessage:"Delete {userLength} users",values:{userLength:usersToDelete.length}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.confirmDelete.deleteOneUserTitle",{defaultMessage:"Delete user {userLength}",values:{userLength:usersToDelete[0]}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:title,onCancel:onCancel,onConfirm:this.deleteUsers,cancelButtonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.confirmDelete.cancelButtonLabel",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.confirmDelete.confirmButtonLabel",{defaultMessage:"Delete"}),buttonColor:"danger"},external_kbnSharedDeps_React_default.a.createElement("div",null,moreThanOne?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.confirmDelete.removingUsersDescription",defaultMessage:"You are about to delete these users:"})),external_kbnSharedDeps_React_default.a.createElement("ul",null,usersToDelete.map(username=>external_kbnSharedDeps_React_default.a.createElement("li",{key:username},username)))):null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.confirmDelete.removingUsersWarningMessage",defaultMessage:"This operation cannot be undone."})))))}}},95:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return RoleTableDisplay}));var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var model=__webpack_require__(13);const RoleTableDisplay=({role:role,navigateToApp:navigateToApp})=>{let content;let path;if(typeof role==="string"){content=external_kbnSharedDeps_React_default.a.createElement("div",null,role);path="security/roles/edit/".concat(encodeURIComponent(role))}else if(Object(model["f"])(role)){content=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:Object(model["d"])(role),"data-test-subj":"roleDeprecationTooltip"},external_kbnSharedDeps_React_default.a.createElement("div",null,role.name," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert",color:"warning",size:"s",className:"eui-alignTop"})));path="security/roles/edit/".concat(encodeURIComponent(role.name))}else{content=external_kbnSharedDeps_React_default.a.createElement("div",null,role.name);path="security/roles/edit/".concat(encodeURIComponent(role.name))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{onClick:()=>navigateToApp("management",{path:path})},content)}}}]);