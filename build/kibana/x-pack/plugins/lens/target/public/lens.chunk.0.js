/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["lens_bundle_jsonpfunction"]=window["lens_bundle_jsonpfunction"]||[]).push([[0],Array(33).concat([function(module,exports,__webpack_require__){"use strict";var isOldIE=function isOldIE(){var memo;return function memorize(){if(typeof memo==="undefined"){memo=Boolean(window&&document&&document.all&&!window.atob)}return memo}}();var getTarget=function getTarget(){var memo={};return function memorize(target){if(typeof memo[target]==="undefined"){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement){try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}}memo[target]=styleTarget}return memo[target]}}();var stylesInDom=[];function getIndexByIdentifier(identifier){var result=-1;for(var i=0;i<stylesInDom.length;i++){if(stylesInDom[i].identifier===identifier){result=i;break}}return result}function modulesToDom(list,options){var idCountMap={};var identifiers=[];for(var i=0;i<list.length;i++){var item=list[i];var id=options.base?item[0]+options.base:item[0];var count=idCountMap[id]||0;var identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier);var obj={css:item[1],media:item[2],sourceMap:item[3]};if(index!==-1){stylesInDom[index].references++;stylesInDom[index].updater(obj)}else{stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1})}identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style");var attributes=options.attributes||{};if(typeof attributes.nonce==="undefined"){var nonce=true?__webpack_require__.nc:undefined;if(nonce){attributes.nonce=nonce}}Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])}));if(typeof options.insert==="function"){options.insert(style)}else{var target=getTarget(options.insert||"head");if(!target){throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.")}target.appendChild(style)}return style}function removeStyleElement(style){if(style.parentNode===null){return false}style.parentNode.removeChild(style)}var replaceText=function replaceText(){var textStore=[];return function replace(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet){style.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=style.childNodes;if(childNodes[index]){style.removeChild(childNodes[index])}if(childNodes.length){style.insertBefore(cssNode,childNodes[index])}else{style.appendChild(cssNode)}}}function applyToTag(style,options,obj){var css=obj.css;var media=obj.media;var sourceMap=obj.sourceMap;if(media){style.setAttribute("media",media)}else{style.removeAttribute("media")}if(sourceMap&&btoa){css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")}if(style.styleSheet){style.styleSheet.cssText=css}else{while(style.firstChild){style.removeChild(style.firstChild)}style.appendChild(document.createTextNode(css))}}var singleton=null;var singletonCounter=0;function addStyle(obj,options){var style;var update;var remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options));update=applyToSingletonTag.bind(null,style,styleIndex,false);remove=applyToSingletonTag.bind(null,style,styleIndex,true)}else{style=insertStyleElement(options);update=applyToTag.bind(null,style,options);remove=function remove(){removeStyleElement(style)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap){return}update(obj=newObj)}else{remove()}}}module.exports=function(list,options){options=options||{};if(!options.singleton&&typeof options.singleton!=="boolean"){options.singleton=isOldIE()}list=list||[];var lastIdentifiers=modulesToDom(list,options);return function update(newList){newList=newList||[];if(Object.prototype.toString.call(newList)!=="[object Array]"){return}for(var i=0;i<lastIdentifiers.length;i++){var identifier=lastIdentifiers[i];var index=getIndexByIdentifier(identifier);stylesInDom[index].references--}var newLastIdentifiers=modulesToDom(newList,options);for(var _i=0;_i<lastIdentifiers.length;_i++){var _identifier=lastIdentifiers[_i];var _index=getIndexByIdentifier(_identifier);if(stylesInDom[_index].references===0){stylesInDom[_index].updater();stylesInDom.splice(_index,1)}}lastIdentifiers=newLastIdentifiers}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(useSourceMap){var list=[];list.toString=function toString(){return this.map((function(item){var content=cssWithMappingToString(item,useSourceMap);if(item[2]){return"@media ".concat(item[2]," {").concat(content,"}")}return content})).join("")};list.i=function(modules,mediaQuery,dedupe){if(typeof modules==="string"){modules=[[null,modules,""]]}var alreadyImportedModules={};if(dedupe){for(var i=0;i<this.length;i++){var id=this[i][0];if(id!=null){alreadyImportedModules[id]=true}}}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);if(dedupe&&alreadyImportedModules[item[0]]){continue}if(mediaQuery){if(!item[2]){item[2]=mediaQuery}else{item[2]="".concat(mediaQuery," and ").concat(item[2])}}list.push(item)}};return list};function cssWithMappingToString(item,useSourceMap){var content=item[1]||"";var cssMapping=item[3];if(!cssMapping){return content}if(useSourceMap&&typeof btoa==="function"){var sourceMapping=toComment(cssMapping);var sourceURLs=cssMapping.sources.map((function(source){return"/*# sourceURL=".concat(cssMapping.sourceRoot||"").concat(source," */")}));return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}return[content].join("\n")}function toComment(sourceMap){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));var data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64);return"/*# ".concat(data," */")}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){"use strict";var hasOwn={}.hasOwnProperty;function classNames(){var classes=[];for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(!arg)continue;var argType=typeof arg;if(argType==="string"||argType==="number"){classes.push(arg)}else if(Array.isArray(arg)&&arg.length){var inner=classNames.apply(null,arg);if(inner){classes.push(inner)}}else if(argType==="object"){for(var key in arg){if(hasOwn.call(arg,key)&&arg[key]){classes.push(key)}}}}return classes.join(" ")}if(true&&module.exports){classNames.default=classNames;module.exports=classNames}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{}})()},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(28);var react_1=__webpack_require__(4);var useTimeoutFn_1=tslib_1.__importDefault(__webpack_require__(98));function useDebounce(fn,ms,deps){if(ms===void 0){ms=0}if(deps===void 0){deps=[]}var _a=useTimeoutFn_1.default(fn,ms),isReady=_a[0],cancel=_a[1],reset=_a[2];react_1.useEffect(reset,deps);return[isReady,cancel]}exports.default=useDebounce},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"fromExpression",{enumerable:true,get:function get(){return _ast.fromExpression}});Object.defineProperty(exports,"toExpression",{enumerable:true,get:function get(){return _ast.toExpression}});Object.defineProperty(exports,"safeElementFromExpression",{enumerable:true,get:function get(){return _ast.safeElementFromExpression}});Object.defineProperty(exports,"Fn",{enumerable:true,get:function get(){return _fn.Fn}});Object.defineProperty(exports,"getType",{enumerable:true,get:function get(){return _get_type.getType}});Object.defineProperty(exports,"castProvider",{enumerable:true,get:function get(){return _cast.castProvider}});Object.defineProperty(exports,"parse",{enumerable:true,get:function get(){return _grammar.parse}});Object.defineProperty(exports,"getByAlias",{enumerable:true,get:function get(){return _get_by_alias.getByAlias}});Object.defineProperty(exports,"Registry",{enumerable:true,get:function get(){return _registry.Registry}});Object.defineProperty(exports,"addRegistries",{enumerable:true,get:function get(){return _registries.addRegistries}});Object.defineProperty(exports,"register",{enumerable:true,get:function get(){return _registries.register}});Object.defineProperty(exports,"registryFactory",{enumerable:true,get:function get(){return _registries.registryFactory}});var _ast=__webpack_require__(255);var _fn=__webpack_require__(256);var _get_type=__webpack_require__(38);var _cast=__webpack_require__(258);var _grammar=__webpack_require__(41);var _get_by_alias=__webpack_require__(259);var _registry=__webpack_require__(260);var _registries=__webpack_require__(261)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getType=getType;function getType(node){if(node==null)return"null";if(typeof node==="object"){if(!node.type)throw new Error("Objects must have a type property");return node.type}return typeof node}},function(module,exports){},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(165);case"v7light":return __webpack_require__(167);case"v8dark":return __webpack_require__(169);case"v8light":return __webpack_require__(171)}},function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(42);var _defineProperty2=_interopRequireDefault(__webpack_require__(43));function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){(0,_defineProperty2.default)(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function peg$subclass(child,parent){function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor}function peg$SyntaxError(message,expected,found,location){this.message=message;this.expected=expected;this.found=found;this.location=location;this.name="SyntaxError";if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,peg$SyntaxError)}}peg$subclass(peg$SyntaxError,Error);peg$SyntaxError.buildMessage=function(expected,found){var DESCRIBE_EXPECTATION_FNS={literal:function literal(expectation){return'"'+literalEscape(expectation.text)+'"'},class:function _class(expectation){var escapedParts="",i;for(i=0;i<expectation.parts.length;i++){escapedParts+=expectation.parts[i]instanceof Array?classEscape(expectation.parts[i][0])+"-"+classEscape(expectation.parts[i][1]):classEscape(expectation.parts[i])}return"["+(expectation.inverted?"^":"")+escapedParts+"]"},any:function any(expectation){return"any character"},end:function end(expectation){return"end of input"},other:function other(expectation){return expectation.description}};function hex(ch){return ch.charCodeAt(0).toString(16).toUpperCase()}function literalEscape(s){return s.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(ch){return"\\x0"+hex(ch)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(ch){return"\\x"+hex(ch)}))}function classEscape(s){return s.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(ch){return"\\x0"+hex(ch)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(ch){return"\\x"+hex(ch)}))}function describeExpectation(expectation){return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation)}function describeExpected(expected){var descriptions=new Array(expected.length),i,j;for(i=0;i<expected.length;i++){descriptions[i]=describeExpectation(expected[i])}descriptions.sort();if(descriptions.length>0){for(i=1,j=1;i<descriptions.length;i++){if(descriptions[i-1]!==descriptions[i]){descriptions[j]=descriptions[i];j++}}descriptions.length=j}switch(descriptions.length){case 1:return descriptions[0];case 2:return descriptions[0]+" or "+descriptions[1];default:return descriptions.slice(0,-1).join(", ")+", or "+descriptions[descriptions.length-1]}}function describeFound(found){return found?'"'+literalEscape(found)+'"':"end of input"}return"Expected "+describeExpected(expected)+" but "+describeFound(found)+" found."};function peg$parse(input,options){options=options!==void 0?options:{};var peg$FAILED={},peg$startRuleFunctions={expression:peg$parseexpression,argument:peg$parseargument},peg$startRuleFunction=peg$parseexpression,peg$c0="|",peg$c1=peg$literalExpectation("|",false),peg$c2=function peg$c2(first,fn){return fn},peg$c3=function peg$c3(first,rest){return addMeta({type:"expression",chain:first?[first].concat(rest):[]},text(),location())},peg$c4=peg$otherExpectation("function"),peg$c5=function peg$c5(name,arg_list){return addMeta({type:"function",function:name,arguments:arg_list},text(),location())},peg$c6="=",peg$c7=peg$literalExpectation("=",false),peg$c8=function peg$c8(name,value){return{name:name,value:value}},peg$c9=function peg$c9(value){return{name:"_",value:value}},peg$c10="$",peg$c11=peg$literalExpectation("$",false),peg$c12="{",peg$c13=peg$literalExpectation("{",false),peg$c14="}",peg$c15=peg$literalExpectation("}",false),peg$c16=function peg$c16(expression){return expression},peg$c17=function peg$c17(value){return addMeta(value,text(),location())},peg$c18=function peg$c18(arg){return arg},peg$c19=function peg$c19(args){return args.reduce((accumulator,{name:name,value:value})=>_objectSpread(_objectSpread({},accumulator),{},{[name]:(accumulator[name]||[]).concat(value)}),{})},peg$c20=/^[a-zA-Z0-9_\-]/,peg$c21=peg$classExpectation([["a","z"],["A","Z"],["0","9"],"_","-"],false,false),peg$c22=function peg$c22(name){return name.join("")},peg$c23=peg$otherExpectation("literal"),peg$c24='"',peg$c25=peg$literalExpectation('"',false),peg$c26=function peg$c26(chars){return chars.join("")},peg$c27="'",peg$c28=peg$literalExpectation("'",false),peg$c29=function peg$c29(string){var result=string.join("");if(result==="null")return null;if(result==="true")return true;if(result==="false")return false;if(isNaN(Number(result)))return result;return Number(result)},peg$c30=/^[ \t\r\n]/,peg$c31=peg$classExpectation([" ","\t","\r","\n"],false,false),peg$c32="\\",peg$c33=peg$literalExpectation("\\",false),peg$c34=/^["'(){}<>[\]$`|= \t\n\r]/,peg$c35=peg$classExpectation(['"',"'","(",")","{","}","<",">","[","]","$","`","|","="," ","\t","\n","\r"],false,false),peg$c36=function peg$c36(sequence){return sequence},peg$c37=/^[^"'(){}<>[\]$`|= \t\n\r]/,peg$c38=peg$classExpectation(['"',"'","(",")","{","}","<",">","[","]","$","`","|","="," ","\t","\n","\r"],true,false),peg$c39=/^[^"]/,peg$c40=peg$classExpectation(['"'],true,false),peg$c41=/^[^']/,peg$c42=peg$classExpectation(["'"],true,false),peg$currPos=0,peg$savedPos=0,peg$posDetailsCache=[{line:1,column:1}],peg$maxFailPos=0,peg$maxFailExpected=[],peg$silentFails=0,peg$result;if("startRule"in options){if(!(options.startRule in peg$startRuleFunctions)){throw new Error("Can't start parsing from rule \""+options.startRule+'".')}peg$startRuleFunction=peg$startRuleFunctions[options.startRule]}function text(){return input.substring(peg$savedPos,peg$currPos)}function location(){return peg$computeLocation(peg$savedPos,peg$currPos)}function expected(description,location){location=location!==void 0?location:peg$computeLocation(peg$savedPos,peg$currPos);throw peg$buildStructuredError([peg$otherExpectation(description)],input.substring(peg$savedPos,peg$currPos),location)}function error(message,location){location=location!==void 0?location:peg$computeLocation(peg$savedPos,peg$currPos);throw peg$buildSimpleError(message,location)}function peg$literalExpectation(text,ignoreCase){return{type:"literal",text:text,ignoreCase:ignoreCase}}function peg$classExpectation(parts,inverted,ignoreCase){return{type:"class",parts:parts,inverted:inverted,ignoreCase:ignoreCase}}function peg$anyExpectation(){return{type:"any"}}function peg$endExpectation(){return{type:"end"}}function peg$otherExpectation(description){return{type:"other",description:description}}function peg$computePosDetails(pos){var details=peg$posDetailsCache[pos],p;if(details){return details}else{p=pos-1;while(!peg$posDetailsCache[p]){p--}details=peg$posDetailsCache[p];details={line:details.line,column:details.column};while(p<pos){if(input.charCodeAt(p)===10){details.line++;details.column=1}else{details.column++}p++}peg$posDetailsCache[pos]=details;return details}}function peg$computeLocation(startPos,endPos){var startPosDetails=peg$computePosDetails(startPos),endPosDetails=peg$computePosDetails(endPos);return{start:{offset:startPos,line:startPosDetails.line,column:startPosDetails.column},end:{offset:endPos,line:endPosDetails.line,column:endPosDetails.column}}}function peg$fail(expected){if(peg$currPos<peg$maxFailPos){return}if(peg$currPos>peg$maxFailPos){peg$maxFailPos=peg$currPos;peg$maxFailExpected=[]}peg$maxFailExpected.push(expected)}function peg$buildSimpleError(message,location){return new peg$SyntaxError(message,null,null,location)}function peg$buildStructuredError(expected,found,location){return new peg$SyntaxError(peg$SyntaxError.buildMessage(expected,found),expected,found,location)}function peg$parseexpression(){var s0,s1,s2,s3,s4,s5,s6,s7;s0=peg$currPos;s1=peg$parsespace();if(s1===peg$FAILED){s1=null}if(s1!==peg$FAILED){s2=peg$parsefunction();if(s2===peg$FAILED){s2=null}if(s2!==peg$FAILED){s3=[];s4=peg$currPos;if(input.charCodeAt(peg$currPos)===124){s5=peg$c0;peg$currPos++}else{s5=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c1)}}if(s5!==peg$FAILED){s6=peg$parsespace();if(s6===peg$FAILED){s6=null}if(s6!==peg$FAILED){s7=peg$parsefunction();if(s7!==peg$FAILED){peg$savedPos=s4;s5=peg$c2(s2,s7);s4=s5}else{peg$currPos=s4;s4=peg$FAILED}}else{peg$currPos=s4;s4=peg$FAILED}}else{peg$currPos=s4;s4=peg$FAILED}while(s4!==peg$FAILED){s3.push(s4);s4=peg$currPos;if(input.charCodeAt(peg$currPos)===124){s5=peg$c0;peg$currPos++}else{s5=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c1)}}if(s5!==peg$FAILED){s6=peg$parsespace();if(s6===peg$FAILED){s6=null}if(s6!==peg$FAILED){s7=peg$parsefunction();if(s7!==peg$FAILED){peg$savedPos=s4;s5=peg$c2(s2,s7);s4=s5}else{peg$currPos=s4;s4=peg$FAILED}}else{peg$currPos=s4;s4=peg$FAILED}}else{peg$currPos=s4;s4=peg$FAILED}}if(s3!==peg$FAILED){peg$savedPos=s0;s1=peg$c3(s2,s3);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}return s0}function peg$parsefunction(){var s0,s1,s2;peg$silentFails++;s0=peg$currPos;s1=peg$parseidentifier();if(s1!==peg$FAILED){s2=peg$parsearg_list();if(s2!==peg$FAILED){peg$savedPos=s0;s1=peg$c5(s1,s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}peg$silentFails--;if(s0===peg$FAILED){s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c4)}}return s0}function peg$parseargument_assignment(){var s0,s1,s2,s3,s4,s5;s0=peg$currPos;s1=peg$parseidentifier();if(s1!==peg$FAILED){s2=peg$parsespace();if(s2===peg$FAILED){s2=null}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===61){s3=peg$c6;peg$currPos++}else{s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c7)}}if(s3!==peg$FAILED){s4=peg$parsespace();if(s4===peg$FAILED){s4=null}if(s4!==peg$FAILED){s5=peg$parseargument();if(s5!==peg$FAILED){peg$savedPos=s0;s1=peg$c8(s1,s5);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){s0=peg$currPos;s1=peg$parseargument();if(s1!==peg$FAILED){peg$savedPos=s0;s1=peg$c9(s1)}s0=s1}return s0}function peg$parseargument(){var s0,s1,s2,s3,s4;s0=peg$currPos;if(input.charCodeAt(peg$currPos)===36){s1=peg$c10;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c11)}}if(s1===peg$FAILED){s1=null}if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===123){s2=peg$c12;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c13)}}if(s2!==peg$FAILED){s3=peg$parseexpression();if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===125){s4=peg$c14;peg$currPos++}else{s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c15)}}if(s4!==peg$FAILED){peg$savedPos=s0;s1=peg$c16(s3);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){s0=peg$currPos;s1=peg$parseliteral();if(s1!==peg$FAILED){peg$savedPos=s0;s1=peg$c17(s1)}s0=s1}return s0}function peg$parsearg_list(){var s0,s1,s2,s3,s4;s0=peg$currPos;s1=[];s2=peg$currPos;s3=peg$parsespace();if(s3!==peg$FAILED){s4=peg$parseargument_assignment();if(s4!==peg$FAILED){peg$savedPos=s2;s3=peg$c18(s4);s2=s3}else{peg$currPos=s2;s2=peg$FAILED}}else{peg$currPos=s2;s2=peg$FAILED}while(s2!==peg$FAILED){s1.push(s2);s2=peg$currPos;s3=peg$parsespace();if(s3!==peg$FAILED){s4=peg$parseargument_assignment();if(s4!==peg$FAILED){peg$savedPos=s2;s3=peg$c18(s4);s2=s3}else{peg$currPos=s2;s2=peg$FAILED}}else{peg$currPos=s2;s2=peg$FAILED}}if(s1!==peg$FAILED){s2=peg$parsespace();if(s2===peg$FAILED){s2=null}if(s2!==peg$FAILED){peg$savedPos=s0;s1=peg$c19(s1);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}return s0}function peg$parseidentifier(){var s0,s1,s2;s0=peg$currPos;s1=[];if(peg$c20.test(input.charAt(peg$currPos))){s2=input.charAt(peg$currPos);peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c21)}}if(s2!==peg$FAILED){while(s2!==peg$FAILED){s1.push(s2);if(peg$c20.test(input.charAt(peg$currPos))){s2=input.charAt(peg$currPos);peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c21)}}}}else{s1=peg$FAILED}if(s1!==peg$FAILED){peg$savedPos=s0;s1=peg$c22(s1)}s0=s1;return s0}function peg$parseliteral(){var s0,s1;peg$silentFails++;s0=peg$parsephrase();if(s0===peg$FAILED){s0=peg$parseunquoted_string_or_number()}peg$silentFails--;if(s0===peg$FAILED){s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c23)}}return s0}function peg$parsephrase(){var s0,s1,s2,s3;s0=peg$currPos;if(input.charCodeAt(peg$currPos)===34){s1=peg$c24;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c25)}}if(s1!==peg$FAILED){s2=[];s3=peg$parsedq_char();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parsedq_char()}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===34){s3=peg$c24;peg$currPos++}else{s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c25)}}if(s3!==peg$FAILED){peg$savedPos=s0;s1=peg$c26(s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){s0=peg$currPos;if(input.charCodeAt(peg$currPos)===39){s1=peg$c27;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c28)}}if(s1!==peg$FAILED){s2=[];s3=peg$parsesq_char();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parsesq_char()}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===39){s3=peg$c27;peg$currPos++}else{s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c28)}}if(s3!==peg$FAILED){peg$savedPos=s0;s1=peg$c26(s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}return s0}function peg$parseunquoted_string_or_number(){var s0,s1,s2;s0=peg$currPos;s1=[];s2=peg$parseunquoted();if(s2!==peg$FAILED){while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseunquoted()}}else{s1=peg$FAILED}if(s1!==peg$FAILED){peg$savedPos=s0;s1=peg$c29(s1)}s0=s1;return s0}function peg$parsespace(){var s0,s1;s0=[];if(peg$c30.test(input.charAt(peg$currPos))){s1=input.charAt(peg$currPos);peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c31)}}if(s1!==peg$FAILED){while(s1!==peg$FAILED){s0.push(s1);if(peg$c30.test(input.charAt(peg$currPos))){s1=input.charAt(peg$currPos);peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c31)}}}}else{s0=peg$FAILED}return s0}function peg$parseunquoted(){var s0,s1,s2;s0=peg$currPos;if(input.charCodeAt(peg$currPos)===92){s1=peg$c32;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}if(s1!==peg$FAILED){if(peg$c34.test(input.charAt(peg$currPos))){s2=input.charAt(peg$currPos);peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c35)}}if(s2===peg$FAILED){if(input.charCodeAt(peg$currPos)===92){s2=peg$c32;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}}if(s2!==peg$FAILED){peg$savedPos=s0;s1=peg$c36(s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){if(peg$c37.test(input.charAt(peg$currPos))){s0=input.charAt(peg$currPos);peg$currPos++}else{s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c38)}}}return s0}function peg$parsedq_char(){var s0,s1,s2;s0=peg$currPos;if(input.charCodeAt(peg$currPos)===92){s1=peg$c32;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===34){s2=peg$c24;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c25)}}if(s2===peg$FAILED){if(input.charCodeAt(peg$currPos)===92){s2=peg$c32;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}}if(s2!==peg$FAILED){peg$savedPos=s0;s1=peg$c36(s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){if(peg$c39.test(input.charAt(peg$currPos))){s0=input.charAt(peg$currPos);peg$currPos++}else{s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c40)}}}return s0}function peg$parsesq_char(){var s0,s1,s2;s0=peg$currPos;if(input.charCodeAt(peg$currPos)===92){s1=peg$c32;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===39){s2=peg$c27;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c28)}}if(s2===peg$FAILED){if(input.charCodeAt(peg$currPos)===92){s2=peg$c32;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}}if(s2!==peg$FAILED){peg$savedPos=s0;s1=peg$c36(s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){if(peg$c41.test(input.charAt(peg$currPos))){s0=input.charAt(peg$currPos);peg$currPos++}else{s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c42)}}}return s0}function addMeta(node,text,{start:{offset:start},end:{offset:end}}){if(!options.addMeta)return node;return{node:node,text:text,start:start,end:end}}peg$result=peg$startRuleFunction();if(peg$result!==peg$FAILED&&peg$currPos===input.length){return peg$result}else{if(peg$result!==peg$FAILED&&peg$currPos<input.length){peg$fail(peg$endExpectation())}throw peg$buildStructuredError(peg$maxFailExpected,peg$maxFailPos<input.length?input.charAt(peg$maxFailPos):null,peg$maxFailPos<input.length?peg$computeLocation(peg$maxFailPos,peg$maxFailPos+1):peg$computeLocation(peg$maxFailPos,peg$maxFailPos))}}module.exports={SyntaxError:peg$SyntaxError,parse:peg$parse}},function(module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}module.exports=_interopRequireDefault},function(module,exports){function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}module.exports=_defineProperty},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(45);case"v7light":return __webpack_require__(47);case"v8dark":return __webpack_require__(49);case"v8light":return __webpack_require__(51)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(46);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDataTable {\n  align-self: flex-start; }\n\n.lnsDataTable__filter {\n  opacity: 0;\n  transition: opacity 250ms ease-in-out; }\n\n.lnsDataTable__cell:hover .lnsDataTable__filter,\n.lnsDataTable__filter:focus-within {\n  opacity: 1; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(48);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDataTable {\n  align-self: flex-start; }\n\n.lnsDataTable__filter {\n  opacity: 0;\n  transition: opacity 250ms ease-in-out; }\n\n.lnsDataTable__cell:hover .lnsDataTable__filter,\n.lnsDataTable__filter:focus-within {\n  opacity: 1; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(50);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDataTable {\n  align-self: flex-start; }\n\n.lnsDataTable__filter {\n  opacity: 0;\n  transition: opacity 250ms ease-in-out; }\n\n.lnsDataTable__cell:hover .lnsDataTable__filter,\n.lnsDataTable__filter:focus-within {\n  opacity: 1; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(52);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDataTable {\n  align-self: flex-start; }\n\n.lnsDataTable__filter {\n  opacity: 0;\n  transition: opacity 250ms ease-in-out; }\n\n.lnsDataTable__cell:hover .lnsDataTable__filter,\n.lnsDataTable__filter:focus-within {\n  opacity: 1; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(54);case"v7light":return __webpack_require__(56);case"v8dark":return __webpack_require__(58);case"v8light":return __webpack_require__(60)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(55);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsVisualizationContainer {\n  scrollbar-width: thin;\n  overflow: auto; }\n  .lnsVisualizationContainer::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsVisualizationContainer::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsVisualizationContainer::-webkit-scrollbar-corner, .lnsVisualizationContainer::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsExpressionRenderer {\n  scrollbar-width: thin;\n  position: relative;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  overflow: auto; }\n  .lnsExpressionRenderer::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsExpressionRenderer::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsExpressionRenderer::-webkit-scrollbar-corner, .lnsExpressionRenderer::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsExpressionRenderer .lnsExpressionRenderer__component {\n    position: static; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(57);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsVisualizationContainer {\n  scrollbar-width: thin;\n  overflow: auto; }\n  .lnsVisualizationContainer::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsVisualizationContainer::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsVisualizationContainer::-webkit-scrollbar-corner, .lnsVisualizationContainer::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsExpressionRenderer {\n  scrollbar-width: thin;\n  position: relative;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  overflow: auto; }\n  .lnsExpressionRenderer::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsExpressionRenderer::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsExpressionRenderer::-webkit-scrollbar-corner, .lnsExpressionRenderer::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsExpressionRenderer .lnsExpressionRenderer__component {\n    position: static; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(59);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsVisualizationContainer {\n  scrollbar-width: thin;\n  overflow: auto; }\n  .lnsVisualizationContainer::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsVisualizationContainer::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsVisualizationContainer::-webkit-scrollbar-corner, .lnsVisualizationContainer::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsExpressionRenderer {\n  scrollbar-width: thin;\n  position: relative;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  overflow: auto; }\n  .lnsExpressionRenderer::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsExpressionRenderer::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsExpressionRenderer::-webkit-scrollbar-corner, .lnsExpressionRenderer::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsExpressionRenderer .lnsExpressionRenderer__component {\n    position: static; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(61);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsVisualizationContainer {\n  scrollbar-width: thin;\n  overflow: auto; }\n  .lnsVisualizationContainer::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsVisualizationContainer::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsVisualizationContainer::-webkit-scrollbar-corner, .lnsVisualizationContainer::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsExpressionRenderer {\n  scrollbar-width: thin;\n  position: relative;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  overflow: auto; }\n  .lnsExpressionRenderer::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsExpressionRenderer::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsExpressionRenderer::-webkit-scrollbar-corner, .lnsExpressionRenderer::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsExpressionRenderer .lnsExpressionRenderer__component {\n    position: static; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(63);case"v7light":return __webpack_require__(65);case"v8dark":return __webpack_require__(67);case"v8light":return __webpack_require__(69)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(64);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsToolbarButton {\n  line-height: 40px;\n  background-color: #1D1E24;\n  min-width: 0; }\n  .lnsToolbarButton[class*='--text'] {\n    border-color: #343741 !important; }\n  .lnsToolbarButton[class*='isDisabled'] {\n    pointer-events: initial; }\n  .lnsToolbarButton .lnsToolbarButton__text > svg {\n    margin-top: -1px; }\n  .lnsToolbarButton .lnsToolbarButton__text:empty {\n    margin: 0; }\n  .lnsToolbarButton[class*='fullWidth'] {\n    text-align: left; }\n    .lnsToolbarButton[class*='fullWidth'] .lnsToolbarButton__content {\n      justify-content: space-between; }\n\n.lnsToolbarButton--groupLeft {\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0; }\n\n.lnsToolbarButton--groupCenter {\n  border-radius: 0;\n  border-left: none; }\n\n.lnsToolbarButton--groupRight {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  border-left: none; }\n\n.lnsToolbarButton--bold {\n  font-weight: 700; }\n\n.lnsToolbarButton--s {\n  box-shadow: none !important;\n  font-size: 14px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(66);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsToolbarButton {\n  line-height: 40px;\n  background-color: #FFF;\n  min-width: 0; }\n  .lnsToolbarButton[class*='--text'] {\n    border-color: #E6E6E6 !important; }\n  .lnsToolbarButton[class*='isDisabled'] {\n    pointer-events: initial; }\n  .lnsToolbarButton .lnsToolbarButton__text > svg {\n    margin-top: -1px; }\n  .lnsToolbarButton .lnsToolbarButton__text:empty {\n    margin: 0; }\n  .lnsToolbarButton[class*='fullWidth'] {\n    text-align: left; }\n    .lnsToolbarButton[class*='fullWidth'] .lnsToolbarButton__content {\n      justify-content: space-between; }\n\n.lnsToolbarButton--groupLeft {\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0; }\n\n.lnsToolbarButton--groupCenter {\n  border-radius: 0;\n  border-left: none; }\n\n.lnsToolbarButton--groupRight {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  border-left: none; }\n\n.lnsToolbarButton--bold {\n  font-weight: 700; }\n\n.lnsToolbarButton--s {\n  box-shadow: none !important;\n  font-size: 14px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(68);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsToolbarButton {\n  line-height: 40px;\n  background-color: #1D1E24;\n  min-width: 0; }\n  .lnsToolbarButton[class*='--text'] {\n    border-color: #343741 !important; }\n  .lnsToolbarButton[class*='isDisabled'] {\n    pointer-events: initial; }\n  .lnsToolbarButton .lnsToolbarButton__text > svg {\n    margin-top: -1px; }\n  .lnsToolbarButton .lnsToolbarButton__text:empty {\n    margin: 0; }\n  .lnsToolbarButton[class*='fullWidth'] {\n    text-align: left; }\n    .lnsToolbarButton[class*='fullWidth'] .lnsToolbarButton__content {\n      justify-content: space-between; }\n\n.lnsToolbarButton--groupLeft {\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0; }\n\n.lnsToolbarButton--groupCenter {\n  border-radius: 0;\n  border-left: none; }\n\n.lnsToolbarButton--groupRight {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  border-left: none; }\n\n.lnsToolbarButton--bold {\n  font-weight: 700; }\n\n.lnsToolbarButton--s {\n  box-shadow: none !important;\n  font-size: 14px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(70);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsToolbarButton {\n  line-height: 40px;\n  background-color: #FFF;\n  min-width: 0; }\n  .lnsToolbarButton[class*='--text'] {\n    border-color: #E6E6E6 !important; }\n  .lnsToolbarButton[class*='isDisabled'] {\n    pointer-events: initial; }\n  .lnsToolbarButton .lnsToolbarButton__text > svg {\n    margin-top: -1px; }\n  .lnsToolbarButton .lnsToolbarButton__text:empty {\n    margin: 0; }\n  .lnsToolbarButton[class*='fullWidth'] {\n    text-align: left; }\n    .lnsToolbarButton[class*='fullWidth'] .lnsToolbarButton__content {\n      justify-content: space-between; }\n\n.lnsToolbarButton--groupLeft {\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0; }\n\n.lnsToolbarButton--groupCenter {\n  border-radius: 0;\n  border-left: none; }\n\n.lnsToolbarButton--groupRight {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  border-left: none; }\n\n.lnsToolbarButton--bold {\n  font-weight: 700; }\n\n.lnsToolbarButton--s {\n  box-shadow: none !important;\n  font-size: 14px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(72);case"v7light":return __webpack_require__(74);case"v8dark":return __webpack_require__(76);case"v8light":return __webpack_require__(78)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(73);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsMetricExpression__container {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  text-align: center; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(75);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsMetricExpression__container {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  text-align: center; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(77);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsMetricExpression__container {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  text-align: center; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(79);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsMetricExpression__container {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  text-align: center; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(81);case"v7light":return __webpack_require__(83);case"v8dark":return __webpack_require__(85);case"v8light":return __webpack_require__(87)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(82);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsPieExpression__container {\n  height: 100%;\n  width: 100%; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(84);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsPieExpression__container {\n  height: 100%;\n  width: 100%; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(86);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsPieExpression__container {\n  height: 100%;\n  width: 100%; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(88);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsPieExpression__container {\n  height: 100%;\n  width: 100%; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(90);case"v7light":return __webpack_require__(92);case"v8dark":return __webpack_require__(94);case"v8light":return __webpack_require__(96)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(91);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsPieToolbar__popover {\n  width: 400px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(93);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsPieToolbar__popover {\n  width: 400px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(95);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsPieToolbar__popover {\n  width: 400px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(97);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsPieToolbar__popover {\n  width: 400px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(4);function useTimeoutFn(fn,ms){if(ms===void 0){ms=0}var ready=react_1.useRef(false);var timeout=react_1.useRef();var callback=react_1.useRef(fn);var isReady=react_1.useCallback((function(){return ready.current}),[]);var set=react_1.useCallback((function(){ready.current=false;timeout.current&&clearTimeout(timeout.current);timeout.current=setTimeout((function(){ready.current=true;callback.current()}),ms)}),[ms]);var clear=react_1.useCallback((function(){ready.current=null;timeout.current&&clearTimeout(timeout.current)}),[]);react_1.useEffect((function(){callback.current=fn}),[fn]);react_1.useEffect((function(){set();return clear}),[ms]);return[isReady,clear,set]}exports.default=useTimeoutFn},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(100);case"v7light":return __webpack_require__(102);case"v8dark":return __webpack_require__(104);case"v8light":return __webpack_require__(106)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(101);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsXyExpression__container {\n  height: 100%;\n  width: 100%; }\n\n.lnsChart__empty {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(103);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsXyExpression__container {\n  height: 100%;\n  width: 100%; }\n\n.lnsChart__empty {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(105);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsXyExpression__container {\n  height: 100%;\n  width: 100%; }\n\n.lnsChart__empty {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(107);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsXyExpression__container {\n  height: 100%;\n  width: 100%; }\n\n.lnsChart__empty {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(109);case"v7light":return __webpack_require__(111);case"v8dark":return __webpack_require__(113);case"v8light":return __webpack_require__(115)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(110);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsXyToolbar__popover {\n  width: 320px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(112);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsXyToolbar__popover {\n  width: 320px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(114);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsXyToolbar__popover {\n  width: 320px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(116);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsXyToolbar__popover {\n  width: 320px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var rng=__webpack_require__(118);var bytesToUuid=__webpack_require__(119);function v4(options,buf,offset){var i=buf&&offset||0;if(typeof options=="string"){buf=options==="binary"?new Array(16):null;options=null}options=options||{};var rnds=options.random||(options.rng||rng)();rnds[6]=rnds[6]&15|64;rnds[8]=rnds[8]&63|128;if(buf){for(var ii=0;ii<16;++ii){buf[i+ii]=rnds[ii]}}return buf||bytesToUuid(rnds)}module.exports=v4},function(module,exports){var getRandomValues=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(getRandomValues){var rnds8=new Uint8Array(16);module.exports=function whatwgRNG(){getRandomValues(rnds8);return rnds8}}else{var rnds=new Array(16);module.exports=function mathRNG(){for(var i=0,r;i<16;i++){if((i&3)===0)r=Math.random()*4294967296;rnds[i]=r>>>((i&3)<<3)&255}return rnds}}},function(module,exports){var byteToHex=[];for(var i=0;i<256;++i){byteToHex[i]=(i+256).toString(16).substr(1)}function bytesToUuid(buf,offset){var i=offset||0;var bth=byteToHex;return[bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]]].join("")}module.exports=bytesToUuid},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(121);case"v7light":return __webpack_require__(123);case"v8dark":return __webpack_require__(125);case"v8light":return __webpack_require__(127)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(122);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFiltersOperation__popoverButton {\n  overflow-wrap: break-word !important;\n  word-wrap: break-word !important;\n  word-break: break-word;\n  font-size: 14px;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  min-height: 32px;\n  width: 100%; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(124);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFiltersOperation__popoverButton {\n  overflow-wrap: break-word !important;\n  word-wrap: break-word !important;\n  word-break: break-word;\n  font-size: 14px;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  min-height: 32px;\n  width: 100%; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(126);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFiltersOperation__popoverButton {\n  overflow-wrap: break-word !important;\n  word-wrap: break-word !important;\n  word-break: break-word;\n  font-size: 14px;\n  font-size: 1rem;\n  line-height: 1.5;\n  min-height: 32px;\n  width: 100%; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(128);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFiltersOperation__popoverButton {\n  overflow-wrap: break-word !important;\n  word-wrap: break-word !important;\n  word-break: break-word;\n  font-size: 14px;\n  font-size: 1rem;\n  line-height: 1.5;\n  min-height: 32px;\n  width: 100%; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(130);case"v7light":return __webpack_require__(132);case"v8dark":return __webpack_require__(134);case"v8light":return __webpack_require__(136)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(131);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsIndexPatternDimensionEditor__filtersEditor {\n  width: 960px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(133);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsIndexPatternDimensionEditor__filtersEditor {\n  width: 960px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(135);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsIndexPatternDimensionEditor__filtersEditor {\n  width: 960px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(137);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsIndexPatternDimensionEditor__filtersEditor {\n  width: 960px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(139);case"v7light":return __webpack_require__(141);case"v8dark":return __webpack_require__(143);case"v8light":return __webpack_require__(145)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(140);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsRangesOperation__popoverButton {\n  overflow-wrap: break-word !important;\n  word-wrap: break-word !important;\n  word-break: break-word;\n  font-size: 14px;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  min-height: 32px;\n  width: 100%; }\n\n.lnsRangesOperation__popoverNumberField {\n  width: 14ch; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(142);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsRangesOperation__popoverButton {\n  overflow-wrap: break-word !important;\n  word-wrap: break-word !important;\n  word-break: break-word;\n  font-size: 14px;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  min-height: 32px;\n  width: 100%; }\n\n.lnsRangesOperation__popoverNumberField {\n  width: 14ch; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(144);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsRangesOperation__popoverButton {\n  overflow-wrap: break-word !important;\n  word-wrap: break-word !important;\n  word-break: break-word;\n  font-size: 14px;\n  font-size: 1rem;\n  line-height: 1.5;\n  min-height: 32px;\n  width: 100%; }\n\n.lnsRangesOperation__popoverNumberField {\n  width: 14ch; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(146);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsRangesOperation__popoverButton {\n  overflow-wrap: break-word !important;\n  word-wrap: break-word !important;\n  word-break: break-word;\n  font-size: 14px;\n  font-size: 1rem;\n  line-height: 1.5;\n  min-height: 32px;\n  width: 100%; }\n\n.lnsRangesOperation__popoverNumberField {\n  width: 14ch; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(148);case"v7light":return __webpack_require__(150);case"v8dark":return __webpack_require__(152);case"v8light":return __webpack_require__(154)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(149);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsIndexPatternDimensionEditor {\n  height: 100%; }\n\n.lnsIndexPatternDimensionEditor__section {\n  padding: 8px; }\n\n.lnsIndexPatternDimensionEditor__section--shaded {\n  background-color: #25262E; }\n\n.lnsIndexPatternDimensionEditor__columns {\n  -webkit-column-count: 2;\n          column-count: 2;\n  -webkit-column-gap: 32px;\n          column-gap: 32px; }\n\n.lnsIndexPatternDimensionEditor__operation > button {\n  padding-top: 0;\n  padding-bottom: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(151);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsIndexPatternDimensionEditor {\n  height: 100%; }\n\n.lnsIndexPatternDimensionEditor__section {\n  padding: 8px; }\n\n.lnsIndexPatternDimensionEditor__section--shaded {\n  background-color: #F8F8F8; }\n\n.lnsIndexPatternDimensionEditor__columns {\n  -webkit-column-count: 2;\n          column-count: 2;\n  -webkit-column-gap: 32px;\n          column-gap: 32px; }\n\n.lnsIndexPatternDimensionEditor__operation > button {\n  padding-top: 0;\n  padding-bottom: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(153);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsIndexPatternDimensionEditor {\n  height: 100%; }\n\n.lnsIndexPatternDimensionEditor__section {\n  padding: 8px; }\n\n.lnsIndexPatternDimensionEditor__section--shaded {\n  background-color: #25262E; }\n\n.lnsIndexPatternDimensionEditor__columns {\n  -webkit-column-count: 2;\n          column-count: 2;\n  -webkit-column-gap: 32px;\n          column-gap: 32px; }\n\n.lnsIndexPatternDimensionEditor__operation > button {\n  padding-top: 0;\n  padding-bottom: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(155);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsIndexPatternDimensionEditor {\n  height: 100%; }\n\n.lnsIndexPatternDimensionEditor__section {\n  padding: 8px; }\n\n.lnsIndexPatternDimensionEditor__section--shaded {\n  background-color: #F8F8F8; }\n\n.lnsIndexPatternDimensionEditor__columns {\n  -webkit-column-count: 2;\n          column-count: 2;\n  -webkit-column-gap: 32px;\n          column-gap: 32px; }\n\n.lnsIndexPatternDimensionEditor__operation > button {\n  padding-top: 0;\n  padding-bottom: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(157);case"v7light":return __webpack_require__(159);case"v8dark":return __webpack_require__(161);case"v8light":return __webpack_require__(163)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(158);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnFieldSelect__option--incompatible {\n  color: #343741; }\n\n.lnFieldSelect__option--nonExistant {\n  background-color: #25262E; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(160);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnFieldSelect__option--incompatible {\n  color: #E6E6E6; }\n\n.lnFieldSelect__option--nonExistant {\n  background-color: #F8F8F8; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(162);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnFieldSelect__option--incompatible {\n  color: #343741; }\n\n.lnFieldSelect__option--nonExistant {\n  background-color: #25262E; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(164);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnFieldSelect__option--incompatible {\n  color: #E6E6E6; }\n\n.lnFieldSelect__option--nonExistant {\n  background-color: #F8F8F8; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(166);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsInnerIndexPatternDataPanel {\n  width: 100%;\n  height: 100%;\n  padding: 16px 16px 0; }\n\n.lnsInnerIndexPatternDataPanel__header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 8px; }\n\n.lnsInnerIndexPatternDataPanel__fieldItems {\n  padding: 4px; }\n\n.lnsInnerIndexPatternDataPanel__textField {\n  padding-right: 40px;\n  padding-left: 40px; }\n\n.lnsInnerIndexPatternDataPanel__filterType {\n  font-size: 14px;\n  padding: 8px;\n  border-bottom: 1px solid #25262E; }\n\n.lnsInnerIndexPatternDataPanel__filterTypeInner {\n  display: flex;\n  align-items: center; }\n  .lnsInnerIndexPatternDataPanel__filterTypeInner .lnsFieldListPanel__fieldIcon {\n    margin-right: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(168);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsInnerIndexPatternDataPanel {\n  width: 100%;\n  height: 100%;\n  padding: 16px 16px 0; }\n\n.lnsInnerIndexPatternDataPanel__header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 8px; }\n\n.lnsInnerIndexPatternDataPanel__fieldItems {\n  padding: 4px; }\n\n.lnsInnerIndexPatternDataPanel__textField {\n  padding-right: 40px;\n  padding-left: 40px; }\n\n.lnsInnerIndexPatternDataPanel__filterType {\n  font-size: 14px;\n  padding: 8px;\n  border-bottom: 1px solid #F8F8F8; }\n\n.lnsInnerIndexPatternDataPanel__filterTypeInner {\n  display: flex;\n  align-items: center; }\n  .lnsInnerIndexPatternDataPanel__filterTypeInner .lnsFieldListPanel__fieldIcon {\n    margin-right: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(170);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsInnerIndexPatternDataPanel {\n  width: 100%;\n  height: 100%;\n  padding: 16px 16px 0; }\n\n.lnsInnerIndexPatternDataPanel__header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 8px; }\n\n.lnsInnerIndexPatternDataPanel__fieldItems {\n  padding: 4px; }\n\n.lnsInnerIndexPatternDataPanel__textField {\n  padding-right: 40px;\n  padding-left: 40px; }\n\n.lnsInnerIndexPatternDataPanel__filterType {\n  font-size: 14px;\n  padding: 8px;\n  border-bottom: 1px solid #25262E; }\n\n.lnsInnerIndexPatternDataPanel__filterTypeInner {\n  display: flex;\n  align-items: center; }\n  .lnsInnerIndexPatternDataPanel__filterTypeInner .lnsFieldListPanel__fieldIcon {\n    margin-right: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(172);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsInnerIndexPatternDataPanel {\n  width: 100%;\n  height: 100%;\n  padding: 16px 16px 0; }\n\n.lnsInnerIndexPatternDataPanel__header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 8px; }\n\n.lnsInnerIndexPatternDataPanel__fieldItems {\n  padding: 4px; }\n\n.lnsInnerIndexPatternDataPanel__textField {\n  padding-right: 40px;\n  padding-left: 40px; }\n\n.lnsInnerIndexPatternDataPanel__filterType {\n  font-size: 14px;\n  padding: 8px;\n  border-bottom: 1px solid #F8F8F8; }\n\n.lnsInnerIndexPatternDataPanel__filterTypeInner {\n  display: flex;\n  align-items: center; }\n  .lnsInnerIndexPatternDataPanel__filterTypeInner .lnsFieldListPanel__fieldIcon {\n    margin-right: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(174);case"v7light":return __webpack_require__(176);case"v8dark":return __webpack_require__(178);case"v8light":return __webpack_require__(180)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(175);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDragDrop {\n  transition: background-color 150ms ease-in-out, border-color 150ms ease-in-out; }\n\n.lnsDragDrop-isDraggable {\n  box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.3);\n  background: #25262E;\n  border: 1px dashed transparent;\n  cursor: -webkit-grab;\n  cursor: grab; }\n  .lnsDragDrop-isDraggable:hover {\n    border: 1px dashed #535966; }\n  .lnsDragDrop-isDraggable > .kbnFieldButton__button {\n    cursor: -webkit-grab;\n    cursor: grab; }\n  .lnsDragDrop-isDraggable:focus {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsDragDrop-isDroppable {\n  border: 1px dashed #343741; }\n\n.lnsDragDrop-isDropTarget {\n  background-color: rgba(157, 87, 244, 0.1); }\n\n.lnsDragDrop-isActiveGroup {\n  background-color: rgba(157, 87, 244, 0.25); }\n\n.lnsDragDrop-isActiveDropTarget {\n  background-color: rgba(157, 87, 244, 0.25);\n  border: 1px dashed #9D57F4; }\n\n.lnsDragDrop-isNotDroppable {\n  opacity: .5; }\n\n.lnsDragDrop-isReplacing,\n.lnsDragDrop-isReplacing .lnsLayerPanel__triggerText {\n  text-decoration: line-through; }\n\n.lnsDragDrop__reorderableContainer {\n  position: relative; }\n\n.lnsDragDrop__reorderableDrop {\n  position: absolute;\n  width: 100%;\n  top: 0;\n  height: calc(100% + 8px); }\n\n.lnsDragDrop-isReorderable {\n  transition: transform 150ms ease-in-out;\n  pointer-events: none; }\n\n.lnsDragDrop-isHidden {\n  opacity: 0; }\n\n.lnsDragDrop__keyboardHandler {\n  top: 0;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 4px; }\n  .lnsDragDrop__keyboardHandler:focus, .lnsDragDrop__keyboardHandler:focus-within {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important;\n    pointer-events: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(177);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDragDrop {\n  transition: background-color 150ms ease-in-out, border-color 150ms ease-in-out; }\n\n.lnsDragDrop-isDraggable {\n  box-shadow: 0 2px 2px -1px rgba(144, 144, 144, 0.3);\n  background: #FFF;\n  border: 1px dashed transparent;\n  cursor: -webkit-grab;\n  cursor: grab; }\n  .lnsDragDrop-isDraggable:hover {\n    border: 1px dashed #909090; }\n  .lnsDragDrop-isDraggable > .kbnFieldButton__button {\n    cursor: -webkit-grab;\n    cursor: grab; }\n  .lnsDragDrop-isDraggable:focus {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsDragDrop-isDroppable {\n  border: 1px dashed #E6E6E6; }\n\n.lnsDragDrop-isDropTarget {\n  background-color: rgba(157, 87, 244, 0.1); }\n\n.lnsDragDrop-isActiveGroup {\n  background-color: rgba(157, 87, 244, 0.25); }\n\n.lnsDragDrop-isActiveDropTarget {\n  background-color: rgba(157, 87, 244, 0.25);\n  border: 1px dashed #9D57F4; }\n\n.lnsDragDrop-isNotDroppable {\n  opacity: .5; }\n\n.lnsDragDrop-isReplacing,\n.lnsDragDrop-isReplacing .lnsLayerPanel__triggerText {\n  text-decoration: line-through; }\n\n.lnsDragDrop__reorderableContainer {\n  position: relative; }\n\n.lnsDragDrop__reorderableDrop {\n  position: absolute;\n  width: 100%;\n  top: 0;\n  height: calc(100% + 8px); }\n\n.lnsDragDrop-isReorderable {\n  transition: transform 150ms ease-in-out;\n  pointer-events: none; }\n\n.lnsDragDrop-isHidden {\n  opacity: 0; }\n\n.lnsDragDrop__keyboardHandler {\n  top: 0;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 4px; }\n  .lnsDragDrop__keyboardHandler:focus, .lnsDragDrop__keyboardHandler:focus-within {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important;\n    pointer-events: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(179);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDragDrop {\n  transition: background-color 150ms ease-in-out, border-color 150ms ease-in-out; }\n\n.lnsDragDrop-isDraggable {\n  box-shadow: 0 0.8px 0.8px rgba(0, 0, 0, 0.1), 0 2.3px 2px rgba(0, 0, 0, 0.075);\n  background: #25262E;\n  border: 1px dashed transparent;\n  cursor: -webkit-grab;\n  cursor: grab; }\n  .lnsDragDrop-isDraggable:hover {\n    border: 1px dashed #535966; }\n  .lnsDragDrop-isDraggable > .kbnFieldButton__button {\n    cursor: -webkit-grab;\n    cursor: grab; }\n  .lnsDragDrop-isDraggable:focus {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsDragDrop-isDroppable {\n  border: 1px dashed #343741; }\n\n.lnsDragDrop-isDropTarget {\n  background-color: rgba(157, 87, 244, 0.1); }\n\n.lnsDragDrop-isActiveGroup {\n  background-color: rgba(157, 87, 244, 0.25); }\n\n.lnsDragDrop-isActiveDropTarget {\n  background-color: rgba(157, 87, 244, 0.25);\n  border: 1px dashed #9D57F4; }\n\n.lnsDragDrop-isNotDroppable {\n  opacity: .5; }\n\n.lnsDragDrop-isReplacing,\n.lnsDragDrop-isReplacing .lnsLayerPanel__triggerText {\n  text-decoration: line-through; }\n\n.lnsDragDrop__reorderableContainer {\n  position: relative; }\n\n.lnsDragDrop__reorderableDrop {\n  position: absolute;\n  width: 100%;\n  top: 0;\n  height: calc(100% + 8px); }\n\n.lnsDragDrop-isReorderable {\n  transition: transform 150ms ease-in-out;\n  pointer-events: none; }\n\n.lnsDragDrop-isHidden {\n  opacity: 0; }\n\n.lnsDragDrop__keyboardHandler {\n  top: 0;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 6px; }\n  .lnsDragDrop__keyboardHandler:focus, .lnsDragDrop__keyboardHandler:focus-within {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important;\n    pointer-events: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(181);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDragDrop {\n  transition: background-color 150ms ease-in-out, border-color 150ms ease-in-out; }\n\n.lnsDragDrop-isDraggable {\n  box-shadow: 0 0.8px 0.8px rgba(34, 34, 34, 0.04), 0 2.3px 2px rgba(34, 34, 34, 0.03);\n  background: #FFF;\n  border: 1px dashed transparent;\n  cursor: -webkit-grab;\n  cursor: grab; }\n  .lnsDragDrop-isDraggable:hover {\n    border: 1px dashed #909090; }\n  .lnsDragDrop-isDraggable > .kbnFieldButton__button {\n    cursor: -webkit-grab;\n    cursor: grab; }\n  .lnsDragDrop-isDraggable:focus {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsDragDrop-isDroppable {\n  border: 1px dashed #E6E6E6; }\n\n.lnsDragDrop-isDropTarget {\n  background-color: rgba(157, 87, 244, 0.1); }\n\n.lnsDragDrop-isActiveGroup {\n  background-color: rgba(157, 87, 244, 0.25); }\n\n.lnsDragDrop-isActiveDropTarget {\n  background-color: rgba(157, 87, 244, 0.25);\n  border: 1px dashed #9D57F4; }\n\n.lnsDragDrop-isNotDroppable {\n  opacity: .5; }\n\n.lnsDragDrop-isReplacing,\n.lnsDragDrop-isReplacing .lnsLayerPanel__triggerText {\n  text-decoration: line-through; }\n\n.lnsDragDrop__reorderableContainer {\n  position: relative; }\n\n.lnsDragDrop__reorderableDrop {\n  position: absolute;\n  width: 100%;\n  top: 0;\n  height: calc(100% + 8px); }\n\n.lnsDragDrop-isReorderable {\n  transition: transform 150ms ease-in-out;\n  pointer-events: none; }\n\n.lnsDragDrop-isHidden {\n  opacity: 0; }\n\n.lnsDragDrop__keyboardHandler {\n  top: 0;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 6px; }\n  .lnsDragDrop__keyboardHandler:focus, .lnsDragDrop__keyboardHandler:focus-within {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important;\n    pointer-events: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(183);case"v7light":return __webpack_require__(185);case"v8dark":return __webpack_require__(187);case"v8light":return __webpack_require__(189)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(184);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,"/**\n * 1. Don't cut off the shadow of the field items\n */\n.lnsIndexPatternFieldList {\n  -webkit-mask-image: linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n          mask-image: linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n  scrollbar-width: thin;\n  margin-left: -16px;\n  /* 1 */\n  position: relative;\n  flex-grow: 1;\n  overflow: auto; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar-corner, .lnsIndexPatternFieldList::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsIndexPatternFieldList__accordionContainer {\n  padding-top: 8px;\n  position: absolute;\n  top: 0;\n  left: 16px;\n  /* 1 */\n  right: 4px;\n  /* 1 */ }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(186);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,"/**\n * 1. Don't cut off the shadow of the field items\n */\n.lnsIndexPatternFieldList {\n  -webkit-mask-image: linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n          mask-image: linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n  scrollbar-width: thin;\n  margin-left: -16px;\n  /* 1 */\n  position: relative;\n  flex-grow: 1;\n  overflow: auto; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar-corner, .lnsIndexPatternFieldList::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsIndexPatternFieldList__accordionContainer {\n  padding-top: 8px;\n  position: absolute;\n  top: 0;\n  left: 16px;\n  /* 1 */\n  right: 4px;\n  /* 1 */ }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(188);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,"/**\n * 1. Don't cut off the shadow of the field items\n */\n.lnsIndexPatternFieldList {\n  -webkit-mask-image: linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n          mask-image: linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n  scrollbar-width: thin;\n  margin-left: -16px;\n  /* 1 */\n  position: relative;\n  flex-grow: 1;\n  overflow: auto; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar-corner, .lnsIndexPatternFieldList::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsIndexPatternFieldList__accordionContainer {\n  padding-top: 8px;\n  position: absolute;\n  top: 0;\n  left: 16px;\n  /* 1 */\n  right: 4px;\n  /* 1 */ }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(190);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,"/**\n * 1. Don't cut off the shadow of the field items\n */\n.lnsIndexPatternFieldList {\n  -webkit-mask-image: linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n          mask-image: linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n  scrollbar-width: thin;\n  margin-left: -16px;\n  /* 1 */\n  position: relative;\n  flex-grow: 1;\n  overflow: auto; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsIndexPatternFieldList::-webkit-scrollbar-corner, .lnsIndexPatternFieldList::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsIndexPatternFieldList__accordionContainer {\n  padding-top: 8px;\n  position: absolute;\n  top: 0;\n  left: 16px;\n  /* 1 */\n  right: 4px;\n  /* 1 */ }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(192);case"v7light":return __webpack_require__(194);case"v8dark":return __webpack_require__(196);case"v8light":return __webpack_require__(198)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(193);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFieldItem .lnsFieldItem__infoIcon {\n  visibility: hidden;\n  opacity: 0; }\n\n.lnsFieldItem:hover:not([class*='isActive']) {\n  cursor: -webkit-grab;\n  cursor: grab; }\n  .lnsFieldItem:hover:not([class*='isActive']) .lnsFieldItem__infoIcon {\n    visibility: visible;\n    opacity: 1;\n    transition: opacity 150ms ease-in-out 1s; }\n\n.lnsFieldItem--missing {\n  background: #1D1E24;\n  color: #98A2B3; }\n\n.lnsFieldItem__topValue {\n  margin-bottom: 8px; }\n  .lnsFieldItem__topValue:last-of-type {\n    margin-bottom: 0; }\n\n.lnsFieldItem__topValueProgress {\n  background-color: #25262E; }\n  .lnsFieldItem__topValueProgress::-webkit-progress-bar {\n    background-color: #25262E; }\n\n.lnsFieldItem__fieldPanel {\n  min-width: 260px;\n  max-width: 300px; }\n\n.lnsFieldItem__buttonGroup {\n  text-transform: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(195);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFieldItem .lnsFieldItem__infoIcon {\n  visibility: hidden;\n  opacity: 0; }\n\n.lnsFieldItem:hover:not([class*='isActive']) {\n  cursor: -webkit-grab;\n  cursor: grab; }\n  .lnsFieldItem:hover:not([class*='isActive']) .lnsFieldItem__infoIcon {\n    visibility: visible;\n    opacity: 1;\n    transition: opacity 150ms ease-in-out 1s; }\n\n.lnsFieldItem--missing {\n  background: rgba(144, 144, 144, 0.1);\n  color: #6D6D6D; }\n\n.lnsFieldItem__topValue {\n  margin-bottom: 8px; }\n  .lnsFieldItem__topValue:last-of-type {\n    margin-bottom: 0; }\n\n.lnsFieldItem__topValueProgress {\n  background-color: #F8F8F8; }\n  .lnsFieldItem__topValueProgress::-webkit-progress-bar {\n    background-color: #F8F8F8; }\n\n.lnsFieldItem__fieldPanel {\n  min-width: 260px;\n  max-width: 300px; }\n\n.lnsFieldItem__buttonGroup {\n  text-transform: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(197);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFieldItem .lnsFieldItem__infoIcon {\n  visibility: hidden;\n  opacity: 0; }\n\n.lnsFieldItem:hover:not([class*='isActive']) {\n  cursor: -webkit-grab;\n  cursor: grab; }\n  .lnsFieldItem:hover:not([class*='isActive']) .lnsFieldItem__infoIcon {\n    visibility: visible;\n    opacity: 1;\n    transition: opacity 150ms ease-in-out 1s; }\n\n.lnsFieldItem--missing {\n  background: #1D1E24;\n  color: #98A2B3; }\n\n.lnsFieldItem__topValue {\n  margin-bottom: 8px; }\n  .lnsFieldItem__topValue:last-of-type {\n    margin-bottom: 0; }\n\n.lnsFieldItem__topValueProgress {\n  background-color: #25262E; }\n  .lnsFieldItem__topValueProgress::-webkit-progress-bar {\n    background-color: #25262E; }\n\n.lnsFieldItem__fieldPanel {\n  min-width: 260px;\n  max-width: 300px; }\n\n.lnsFieldItem__buttonGroup {\n  text-transform: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(199);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFieldItem .lnsFieldItem__infoIcon {\n  visibility: hidden;\n  opacity: 0; }\n\n.lnsFieldItem:hover:not([class*='isActive']) {\n  cursor: -webkit-grab;\n  cursor: grab; }\n  .lnsFieldItem:hover:not([class*='isActive']) .lnsFieldItem__infoIcon {\n    visibility: visible;\n    opacity: 1;\n    transition: opacity 150ms ease-in-out 1s; }\n\n.lnsFieldItem--missing {\n  background: rgba(144, 144, 144, 0.1);\n  color: #6D6D6D; }\n\n.lnsFieldItem__topValue {\n  margin-bottom: 8px; }\n  .lnsFieldItem__topValue:last-of-type {\n    margin-bottom: 0; }\n\n.lnsFieldItem__topValueProgress {\n  background-color: #F8F8F8; }\n  .lnsFieldItem__topValueProgress::-webkit-progress-bar {\n    background-color: #F8F8F8; }\n\n.lnsFieldItem__fieldPanel {\n  min-width: 260px;\n  max-width: 300px; }\n\n.lnsFieldItem__buttonGroup {\n  text-transform: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){const moment=__webpack_require__(25);const unitsMap={ms:{weight:1,type:"fixed",base:1},s:{weight:2,type:"fixed",base:1e3},m:{weight:3,type:"mixed",base:1e3*60},h:{weight:4,type:"mixed",base:1e3*60*60},d:{weight:5,type:"mixed",base:1e3*60*60*24},w:{weight:6,type:"calendar",base:NaN},M:{weight:7,type:"calendar",base:NaN},y:{weight:9,type:"calendar",base:NaN}};const units=Object.keys(unitsMap).sort((a,b)=>unitsMap[b].weight-unitsMap[a].weight);const unitsDesc=[...units];const unitsAsc=[...units].reverse();const isDate=d=>Object.prototype.toString.call(d)==="[object Date]";const isValidDate=d=>isDate(d)&&!isNaN(d.valueOf());function parse(text,{roundUp:roundUp=false,momentInstance:momentInstance=moment,forceNow:forceNow}={}){if(!text)return undefined;if(momentInstance.isMoment(text))return text;if(isDate(text))return momentInstance(text);if(forceNow!==undefined&&!isValidDate(forceNow)){throw new Error("forceNow must be a valid Date")}let time;let mathString="";let index;let parseString;if(text.substring(0,3)==="now"){time=momentInstance(forceNow);mathString=text.substring("now".length)}else{index=text.indexOf("||");if(index===-1){parseString=text;mathString=""}else{parseString=text.substring(0,index);mathString=text.substring(index+2)}time=momentInstance(parseString)}if(!mathString.length){return time}return parseDateMath(mathString,time,roundUp)}function parseDateMath(mathString,time,roundUp){const dateTime=time;const len=mathString.length;let i=0;while(i<len){const c=mathString.charAt(i++);let type;let num;let unit;if(c==="/"){type=0}else if(c==="+"){type=1}else if(c==="-"){type=2}else{return}if(isNaN(mathString.charAt(i))){num=1}else if(mathString.length===2){num=mathString.charAt(i)}else{const numFrom=i;while(!isNaN(mathString.charAt(i))){i++;if(i>=len)return}num=parseInt(mathString.substring(numFrom,i),10)}if(type===0){if(num!==1){return}}unit=mathString.charAt(i++);for(let j=i;j<len;j++){const unitChar=mathString.charAt(i);if(/[a-z]/i.test(unitChar)){unit+=unitChar;i++}else{break}}if(units.indexOf(unit)===-1){return}else{if(type===0){if(roundUp)dateTime.endOf(unit);else dateTime.startOf(unit)}else if(type===1){dateTime.add(num,unit)}else if(type===2){dateTime.subtract(num,unit)}}}return dateTime}module.exports={parse:parse,unitsMap:Object.freeze(unitsMap),units:Object.freeze(units),unitsAsc:Object.freeze(unitsAsc),unitsDesc:Object.freeze(unitsDesc)}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(202);case"v7light":return __webpack_require__(204);case"v8dark":return __webpack_require__(206);case"v8light":return __webpack_require__(208)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(203);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDataPanelWrapper {\n  flex: 1 0 100%;\n  overflow: hidden;\n  background-color: #000; }\n\n.lnsDataPanelWrapper__switchSource {\n  position: absolute;\n  right: 20px;\n  top: 20px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(205);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDataPanelWrapper {\n  flex: 1 0 100%;\n  overflow: hidden;\n  background-color: #F8F8F8; }\n\n.lnsDataPanelWrapper__switchSource {\n  position: absolute;\n  right: 20px;\n  top: 20px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(207);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDataPanelWrapper {\n  flex: 1 0 100%;\n  overflow: hidden;\n  background-color: #000; }\n\n.lnsDataPanelWrapper__switchSource {\n  position: absolute;\n  right: 20px;\n  top: 20px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(209);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDataPanelWrapper {\n  flex: 1 0 100%;\n  overflow: hidden;\n  background-color: #F8F8F8; }\n\n.lnsDataPanelWrapper__switchSource {\n  position: absolute;\n  right: 20px;\n  top: 20px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(211);case"v7light":return __webpack_require__(213);case"v8dark":return __webpack_require__(215);case"v8light":return __webpack_require__(217)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(212);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsConfigPanel__addLayerBtn {\n  color: rgba(83, 89, 102, 0.7);\n  box-shadow: none !important;\n  border-color: #343741; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(214);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsConfigPanel__addLayerBtn {\n  color: rgba(144, 144, 144, 0.7);\n  box-shadow: none !important;\n  border-color: #E6E6E6; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(216);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsConfigPanel__addLayerBtn {\n  color: rgba(83, 89, 102, 0.7);\n  box-shadow: none !important;\n  border-color: #343741; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(218);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsConfigPanel__addLayerBtn {\n  color: rgba(144, 144, 144, 0.7);\n  box-shadow: none !important;\n  border-color: #E6E6E6; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(220);case"v7light":return __webpack_require__(222);case"v8dark":return __webpack_require__(224);case"v8light":return __webpack_require__(226)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(221);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsLayerPanel {\n  margin-bottom: 8px; }\n\n.lnsLayerPanel__sourceFlexItem {\n  max-width: calc(100% - 58px); }\n\n.lnsLayerPanel__settingsFlexItem:empty + .lnsLayerPanel__sourceFlexItem {\n  max-width: calc(100% - 8px); }\n\n.lnsLayerPanel__settingsFlexItem:empty {\n  margin: 0; }\n\n.lnsLayerPanel__row {\n  background: #25262E;\n  padding: 8px 0;\n  border-radius: 4px; }\n  .lnsLayerPanel__row + .lnsLayerPanel__row {\n    margin-top: 16px; }\n\n.lnsLayerPanel__row--notSupportsMoreColumns {\n  padding-bottom: 0; }\n\n.lnsLayerPanel__group {\n  padding: 8px 0; }\n\n.lnsLayerPanel__group:empty {\n  padding: 0; }\n\n.lnsLayerPanel__groupLabel {\n  padding: 0 8px; }\n\n.lnsLayerPanel__error {\n  padding: 0 8px; }\n\n.lnsLayerPanel__dimension {\n  font-size: 14px;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  overflow: hidden;\n  min-height: 40px;\n  position: relative; }\n  .lnsLayerPanel__dimension > div {\n    flex-grow: 1; }\n\n.lnsLayerPanel__dimension--empty {\n  margin-top: 8px; }\n  .lnsLayerPanel__dimension--empty:focus, .lnsLayerPanel__dimension--empty:focus-within {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsLayerPanel__dimensionContainer {\n  margin: 0 8px 8px; }\n  .lnsLayerPanel__dimensionContainer:last-child {\n    margin-bottom: 0; }\n\n.lnsLayerPanel__dimensionRemove {\n  margin-right: 8px; }\n\n.lnsLayerPanel__triggerText {\n  width: 100%;\n  padding: 8px;\n  min-height: 38px;\n  word-break: break-word; }\n\n.lnsLayerPanel__triggerTextLabel {\n  transition: background-color 150ms ease-in-out; }\n\n.lnsLayerPanel__triggerTextContent {\n  justify-content: flex-start;\n  padding: 0 !important;\n  color: #81858f; }\n\n.lnsLayerPanel__styleEditor {\n  padding: 0 8px 8px; }\n\n.lnsLayerPanel__colorIndicator {\n  margin-left: 8px; }\n\n.lnsLayerPanel__paletteContainer {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0; }\n\n.lnsLayerPanel__paletteColor {\n  height: 4px; }\n\n.lnsLayerPanel__dimensionLink {\n  width: 100%; }\n  .lnsLayerPanel__dimensionLink:focus {\n    background-color: transparent !important;\n    outline: none !important; }\n  .lnsLayerPanel__dimensionLink:focus .lnsLayerPanel__triggerTextLabel,\n  .lnsLayerPanel__dimensionLink:focus-within .lnsLayerPanel__triggerTextLabel {\n    background-color: rgba(104, 109, 244, 0.1); }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(223);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsLayerPanel {\n  margin-bottom: 8px; }\n\n.lnsLayerPanel__sourceFlexItem {\n  max-width: calc(100% - 58px); }\n\n.lnsLayerPanel__settingsFlexItem:empty + .lnsLayerPanel__sourceFlexItem {\n  max-width: calc(100% - 8px); }\n\n.lnsLayerPanel__settingsFlexItem:empty {\n  margin: 0; }\n\n.lnsLayerPanel__row {\n  background: #F8F8F8;\n  padding: 8px 0;\n  border-radius: 4px; }\n  .lnsLayerPanel__row + .lnsLayerPanel__row {\n    margin-top: 16px; }\n\n.lnsLayerPanel__row--notSupportsMoreColumns {\n  padding-bottom: 0; }\n\n.lnsLayerPanel__group {\n  padding: 8px 0; }\n\n.lnsLayerPanel__group:empty {\n  padding: 0; }\n\n.lnsLayerPanel__groupLabel {\n  padding: 0 8px; }\n\n.lnsLayerPanel__error {\n  padding: 0 8px; }\n\n.lnsLayerPanel__dimension {\n  font-size: 14px;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  overflow: hidden;\n  min-height: 40px;\n  position: relative; }\n  .lnsLayerPanel__dimension > div {\n    flex-grow: 1; }\n\n.lnsLayerPanel__dimension--empty {\n  margin-top: 8px; }\n  .lnsLayerPanel__dimension--empty:focus, .lnsLayerPanel__dimension--empty:focus-within {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsLayerPanel__dimensionContainer {\n  margin: 0 8px 8px; }\n  .lnsLayerPanel__dimensionContainer:last-child {\n    margin-bottom: 0; }\n\n.lnsLayerPanel__dimensionRemove {\n  margin-right: 8px; }\n\n.lnsLayerPanel__triggerText {\n  width: 100%;\n  padding: 8px;\n  min-height: 38px;\n  word-break: break-word; }\n\n.lnsLayerPanel__triggerTextLabel {\n  transition: background-color 150ms ease-in-out; }\n\n.lnsLayerPanel__triggerTextContent {\n  justify-content: flex-start;\n  padding: 0 !important;\n  color: #747474; }\n\n.lnsLayerPanel__styleEditor {\n  padding: 0 8px 8px; }\n\n.lnsLayerPanel__colorIndicator {\n  margin-left: 8px; }\n\n.lnsLayerPanel__paletteContainer {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0; }\n\n.lnsLayerPanel__paletteColor {\n  height: 4px; }\n\n.lnsLayerPanel__dimensionLink {\n  width: 100%; }\n  .lnsLayerPanel__dimensionLink:focus {\n    background-color: transparent !important;\n    outline: none !important; }\n  .lnsLayerPanel__dimensionLink:focus .lnsLayerPanel__triggerTextLabel,\n  .lnsLayerPanel__dimensionLink:focus-within .lnsLayerPanel__triggerTextLabel {\n    background-color: rgba(104, 109, 244, 0.1); }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(225);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsLayerPanel {\n  margin-bottom: 8px; }\n\n.lnsLayerPanel__sourceFlexItem {\n  max-width: calc(100% - 58px); }\n\n.lnsLayerPanel__settingsFlexItem:empty + .lnsLayerPanel__sourceFlexItem {\n  max-width: calc(100% - 8px); }\n\n.lnsLayerPanel__settingsFlexItem:empty {\n  margin: 0; }\n\n.lnsLayerPanel__row {\n  background: #25262E;\n  padding: 8px 0;\n  border-radius: 6px; }\n  .lnsLayerPanel__row + .lnsLayerPanel__row {\n    margin-top: 16px; }\n\n.lnsLayerPanel__row--notSupportsMoreColumns {\n  padding-bottom: 0; }\n\n.lnsLayerPanel__group {\n  padding: 8px 0; }\n\n.lnsLayerPanel__group:empty {\n  padding: 0; }\n\n.lnsLayerPanel__groupLabel {\n  padding: 0 8px; }\n\n.lnsLayerPanel__error {\n  padding: 0 8px; }\n\n.lnsLayerPanel__dimension {\n  font-size: 14px;\n  font-size: 1rem;\n  line-height: 1.5;\n  border-radius: 6px;\n  display: flex;\n  align-items: center;\n  overflow: hidden;\n  min-height: 40px;\n  position: relative; }\n  .lnsLayerPanel__dimension > div {\n    flex-grow: 1; }\n\n.lnsLayerPanel__dimension--empty {\n  margin-top: 8px; }\n  .lnsLayerPanel__dimension--empty:focus, .lnsLayerPanel__dimension--empty:focus-within {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsLayerPanel__dimensionContainer {\n  margin: 0 8px 8px; }\n  .lnsLayerPanel__dimensionContainer:last-child {\n    margin-bottom: 0; }\n\n.lnsLayerPanel__dimensionRemove {\n  margin-right: 8px; }\n\n.lnsLayerPanel__triggerText {\n  width: 100%;\n  padding: 8px;\n  min-height: 38px;\n  word-break: break-word; }\n\n.lnsLayerPanel__triggerTextLabel {\n  transition: background-color 150ms ease-in-out; }\n\n.lnsLayerPanel__triggerTextContent {\n  justify-content: flex-start;\n  padding: 0 !important;\n  color: #81858f; }\n\n.lnsLayerPanel__styleEditor {\n  padding: 0 8px 8px; }\n\n.lnsLayerPanel__colorIndicator {\n  margin-left: 8px; }\n\n.lnsLayerPanel__paletteContainer {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0; }\n\n.lnsLayerPanel__paletteColor {\n  height: 4px; }\n\n.lnsLayerPanel__dimensionLink {\n  width: 100%; }\n  .lnsLayerPanel__dimensionLink:focus {\n    background-color: transparent !important;\n    outline: none !important; }\n  .lnsLayerPanel__dimensionLink:focus .lnsLayerPanel__triggerTextLabel,\n  .lnsLayerPanel__dimensionLink:focus-within .lnsLayerPanel__triggerTextLabel {\n    background-color: rgba(104, 109, 244, 0.1); }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(227);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsLayerPanel {\n  margin-bottom: 8px; }\n\n.lnsLayerPanel__sourceFlexItem {\n  max-width: calc(100% - 58px); }\n\n.lnsLayerPanel__settingsFlexItem:empty + .lnsLayerPanel__sourceFlexItem {\n  max-width: calc(100% - 8px); }\n\n.lnsLayerPanel__settingsFlexItem:empty {\n  margin: 0; }\n\n.lnsLayerPanel__row {\n  background: #F8F8F8;\n  padding: 8px 0;\n  border-radius: 6px; }\n  .lnsLayerPanel__row + .lnsLayerPanel__row {\n    margin-top: 16px; }\n\n.lnsLayerPanel__row--notSupportsMoreColumns {\n  padding-bottom: 0; }\n\n.lnsLayerPanel__group {\n  padding: 8px 0; }\n\n.lnsLayerPanel__group:empty {\n  padding: 0; }\n\n.lnsLayerPanel__groupLabel {\n  padding: 0 8px; }\n\n.lnsLayerPanel__error {\n  padding: 0 8px; }\n\n.lnsLayerPanel__dimension {\n  font-size: 14px;\n  font-size: 1rem;\n  line-height: 1.5;\n  border-radius: 6px;\n  display: flex;\n  align-items: center;\n  overflow: hidden;\n  min-height: 40px;\n  position: relative; }\n  .lnsLayerPanel__dimension > div {\n    flex-grow: 1; }\n\n.lnsLayerPanel__dimension--empty {\n  margin-top: 8px; }\n  .lnsLayerPanel__dimension--empty:focus, .lnsLayerPanel__dimension--empty:focus-within {\n    animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsLayerPanel__dimensionContainer {\n  margin: 0 8px 8px; }\n  .lnsLayerPanel__dimensionContainer:last-child {\n    margin-bottom: 0; }\n\n.lnsLayerPanel__dimensionRemove {\n  margin-right: 8px; }\n\n.lnsLayerPanel__triggerText {\n  width: 100%;\n  padding: 8px;\n  min-height: 38px;\n  word-break: break-word; }\n\n.lnsLayerPanel__triggerTextLabel {\n  transition: background-color 150ms ease-in-out; }\n\n.lnsLayerPanel__triggerTextContent {\n  justify-content: flex-start;\n  padding: 0 !important;\n  color: #747474; }\n\n.lnsLayerPanel__styleEditor {\n  padding: 0 8px 8px; }\n\n.lnsLayerPanel__colorIndicator {\n  margin-left: 8px; }\n\n.lnsLayerPanel__paletteContainer {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0; }\n\n.lnsLayerPanel__paletteColor {\n  height: 4px; }\n\n.lnsLayerPanel__dimensionLink {\n  width: 100%; }\n  .lnsLayerPanel__dimensionLink:focus {\n    background-color: transparent !important;\n    outline: none !important; }\n  .lnsLayerPanel__dimensionLink:focus .lnsLayerPanel__triggerTextLabel,\n  .lnsLayerPanel__dimensionLink:focus-within .lnsLayerPanel__triggerTextLabel {\n    background-color: rgba(104, 109, 244, 0.1); }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(229);case"v7light":return __webpack_require__(231);case"v8dark":return __webpack_require__(233);case"v8light":return __webpack_require__(235)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(230);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDimensionContainer {\n  border-left: 1px solid #343741;\n  box-shadow: 0 40px 64px 0 rgba(0, 0, 0, 0.1), 0 24px 32px 0 rgba(0, 0, 0, 0.1), 0 16px 16px 0 rgba(0, 0, 0, 0.1), 0 8px 8px 0 rgba(0, 0, 0, 0.1), 0 4px 4px 0 rgba(0, 0, 0, 0.1), 0 2px 2px 0 rgba(0, 0, 0, 0.1);\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  height: 100%;\n  z-index: 3000;\n  background: #1D1E24;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  -webkit-clip-path: polygon(-20% 0, 100% 0, 100% 100%, -20% 100%);\n          clip-path: polygon(-20% 0, 100% 0, 100% 100%, -20% 100%);\n  position: absolute;\n  right: 0;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  animation: euiFlyout 250ms cubic-bezier(0.694, 0.0482, 0.335, 1); }\n\n.lnsDimensionContainer__footer,\n.lnsDimensionContainer__header {\n  padding: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(232);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDimensionContainer {\n  border-left: 1px solid #E6E6E6;\n  box-shadow: 0 40px 64px 0 rgba(103, 75, 75, 0.1), 0 24px 32px 0 rgba(103, 75, 75, 0.1), 0 16px 16px 0 rgba(103, 75, 75, 0.1), 0 8px 8px 0 rgba(103, 75, 75, 0.1), 0 4px 4px 0 rgba(103, 75, 75, 0.1), 0 2px 2px 0 rgba(103, 75, 75, 0.1);\n  border-color: #d1c9c9;\n  border-top-color: #e8e4e4;\n  border-bottom-color: #bbaeae;\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  height: 100%;\n  z-index: 3000;\n  background: #FFF;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  -webkit-clip-path: polygon(-20% 0, 100% 0, 100% 100%, -20% 100%);\n          clip-path: polygon(-20% 0, 100% 0, 100% 100%, -20% 100%);\n  position: absolute;\n  right: 0;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  animation: euiFlyout 250ms cubic-bezier(0.694, 0.0482, 0.335, 1); }\n\n.lnsDimensionContainer__footer,\n.lnsDimensionContainer__header {\n  padding: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(234);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDimensionContainer {\n  border-left: none;\n  box-shadow: 0 2.7px 9px rgba(0, 0, 0, 0.325), 0 9.4px 24px rgba(0, 0, 0, 0.225), 0 21.8px 43px rgba(0, 0, 0, 0.2);\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  height: 100%;\n  z-index: 3000;\n  background: #1D1E24;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  -webkit-clip-path: polygon(-20% 0, 100% 0, 100% 100%, -20% 100%);\n          clip-path: polygon(-20% 0, 100% 0, 100% 100%, -20% 100%);\n  position: absolute;\n  right: 0;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  animation: euiFlyout 250ms cubic-bezier(0.694, 0.0482, 0.335, 1); }\n\n.lnsDimensionContainer__footer,\n.lnsDimensionContainer__header {\n  padding: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(236);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsDimensionContainer {\n  border-left: none;\n  box-shadow: 0 2.7px 9px rgba(34, 34, 34, 0.13), 0 9.4px 24px rgba(34, 34, 34, 0.09), 0 21.8px 43px rgba(34, 34, 34, 0.08);\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  height: 100%;\n  z-index: 3000;\n  background: #FFF;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  -webkit-clip-path: polygon(-20% 0, 100% 0, 100% 100%, -20% 100%);\n          clip-path: polygon(-20% 0, 100% 0, 100% 100%, -20% 100%);\n  position: absolute;\n  right: 0;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  animation: euiFlyout 250ms cubic-bezier(0.694, 0.0482, 0.335, 1); }\n\n.lnsDimensionContainer__footer,\n.lnsDimensionContainer__header {\n  padding: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(238);case"v7light":return __webpack_require__(240);case"v8dark":return __webpack_require__(242);case"v8light":return __webpack_require__(244)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(239);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFrameLayout {\n  padding: 0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: hidden;\n  flex-direction: column; }\n\n.lnsFrameLayout__pageContent {\n  display: flex;\n  overflow: hidden;\n  flex-grow: 1; }\n\n.lnsFrameLayout__pageBody {\n  scrollbar-width: thin;\n  min-width: 320px;\n  overflow: hidden auto;\n  padding: 16px 16px 0; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar-corner, .lnsFrameLayout__pageBody::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsFrameLayout__pageBody:first-child {\n    padding-left: 16px; }\n\n.lnsFrameLayout__sidebar {\n  margin: 0;\n  flex: 1 0 18%;\n  min-width: 304px;\n  display: flex;\n  flex-direction: column;\n  position: relative; }\n\n.lnsFrameLayout__sidebar--right {\n  flex-basis: 25%;\n  background-color: #000;\n  min-width: 320px;\n  max-width: 440px;\n  max-height: 100%; }\n  .lnsFrameLayout__sidebar--right .lnsConfigPanel {\n    scrollbar-width: thin;\n    padding: 16px 0 16px 16px;\n    overflow-x: hidden;\n    overflow-y: scroll; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar {\n      width: 16px;\n      height: 16px; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-thumb {\n      background-color: rgba(152, 162, 179, 0.5);\n      border: 6px solid transparent;\n      background-clip: content-box; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-corner, .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-track {\n      background-color: transparent; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(241);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFrameLayout {\n  padding: 0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: hidden;\n  flex-direction: column; }\n\n.lnsFrameLayout__pageContent {\n  display: flex;\n  overflow: hidden;\n  flex-grow: 1; }\n\n.lnsFrameLayout__pageBody {\n  scrollbar-width: thin;\n  min-width: 320px;\n  overflow: hidden auto;\n  padding: 16px 16px 0; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar-corner, .lnsFrameLayout__pageBody::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsFrameLayout__pageBody:first-child {\n    padding-left: 16px; }\n\n.lnsFrameLayout__sidebar {\n  margin: 0;\n  flex: 1 0 18%;\n  min-width: 304px;\n  display: flex;\n  flex-direction: column;\n  position: relative; }\n\n.lnsFrameLayout__sidebar--right {\n  flex-basis: 25%;\n  background-color: #F8F8F8;\n  min-width: 320px;\n  max-width: 440px;\n  max-height: 100%; }\n  .lnsFrameLayout__sidebar--right .lnsConfigPanel {\n    scrollbar-width: thin;\n    padding: 16px 0 16px 16px;\n    overflow-x: hidden;\n    overflow-y: scroll; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar {\n      width: 16px;\n      height: 16px; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-thumb {\n      background-color: rgba(109, 109, 109, 0.5);\n      border: 6px solid transparent;\n      background-clip: content-box; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-corner, .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-track {\n      background-color: transparent; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(243);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFrameLayout {\n  padding: 0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: hidden;\n  flex-direction: column; }\n\n.lnsFrameLayout__pageContent {\n  display: flex;\n  overflow: hidden;\n  flex-grow: 1; }\n\n.lnsFrameLayout__pageBody {\n  scrollbar-width: thin;\n  min-width: 320px;\n  overflow: hidden auto;\n  padding: 16px 16px 0; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar-corner, .lnsFrameLayout__pageBody::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsFrameLayout__pageBody:first-child {\n    padding-left: 16px; }\n\n.lnsFrameLayout__sidebar {\n  margin: 0;\n  flex: 1 0 18%;\n  min-width: 304px;\n  display: flex;\n  flex-direction: column;\n  position: relative; }\n\n.lnsFrameLayout__sidebar--right {\n  flex-basis: 25%;\n  background-color: #000;\n  min-width: 320px;\n  max-width: 440px;\n  max-height: 100%; }\n  .lnsFrameLayout__sidebar--right .lnsConfigPanel {\n    scrollbar-width: thin;\n    padding: 16px 0 16px 16px;\n    overflow-x: hidden;\n    overflow-y: scroll; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar {\n      width: 16px;\n      height: 16px; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-thumb {\n      background-color: rgba(152, 162, 179, 0.5);\n      border: 6px solid transparent;\n      background-clip: content-box; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-corner, .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-track {\n      background-color: transparent; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(245);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsFrameLayout {\n  padding: 0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: hidden;\n  flex-direction: column; }\n\n.lnsFrameLayout__pageContent {\n  display: flex;\n  overflow: hidden;\n  flex-grow: 1; }\n\n.lnsFrameLayout__pageBody {\n  scrollbar-width: thin;\n  min-width: 320px;\n  overflow: hidden auto;\n  padding: 16px 16px 0; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsFrameLayout__pageBody::-webkit-scrollbar-corner, .lnsFrameLayout__pageBody::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsFrameLayout__pageBody:first-child {\n    padding-left: 16px; }\n\n.lnsFrameLayout__sidebar {\n  margin: 0;\n  flex: 1 0 18%;\n  min-width: 304px;\n  display: flex;\n  flex-direction: column;\n  position: relative; }\n\n.lnsFrameLayout__sidebar--right {\n  flex-basis: 25%;\n  background-color: #F8F8F8;\n  min-width: 320px;\n  max-width: 440px;\n  max-height: 100%; }\n  .lnsFrameLayout__sidebar--right .lnsConfigPanel {\n    scrollbar-width: thin;\n    padding: 16px 0 16px 16px;\n    overflow-x: hidden;\n    overflow-y: scroll; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar {\n      width: 16px;\n      height: 16px; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-thumb {\n      background-color: rgba(109, 109, 109, 0.5);\n      border: 6px solid transparent;\n      background-clip: content-box; }\n    .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-corner, .lnsFrameLayout__sidebar--right .lnsConfigPanel::-webkit-scrollbar-track {\n      background-color: transparent; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(247);case"v7light":return __webpack_require__(249);case"v8dark":return __webpack_require__(251);case"v8light":return __webpack_require__(253)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(248);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsSuggestionPanel__title {\n  margin-left: 2px; }\n\n.lnsSuggestionPanel__suggestions {\n  scrollbar-width: thin;\n  -webkit-mask-image: linear-gradient(to right, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n          mask-image: linear-gradient(to right, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n  padding-top: 4px;\n  overflow-x: scroll;\n  overflow-y: hidden;\n  display: flex;\n  padding-left: 4px;\n  margin-left: -4px; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar-corner, .lnsSuggestionPanel__suggestions::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsSuggestionPanel__button {\n  position: relative;\n  flex: 0 0 auto;\n  width: 150px !important;\n  height: 100px;\n  margin-right: 8px;\n  margin-left: 2px;\n  margin-bottom: 2px; }\n  .lnsSuggestionPanel__button .lnsSuggestionPanel__expressionRenderer {\n    position: static; }\n\n.lnsSuggestionPanel__button-isSelected {\n  animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsSuggestionPanel__suggestionIcon {\n  color: #98A2B3;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 8px; }\n  .lnsSuggestionPanel__suggestionIcon:not(:only-child) {\n    height: calc(100% - 24px); }\n\n.lnsSuggestionPanel__chartWrapper {\n  display: flex;\n  height: 100%;\n  width: 100%;\n  pointer-events: none; }\n\n.lnsSuggestionPanel__chartWrapper--withLabel {\n  height: calc(100% - 24px); }\n\n.lnsSuggestionPanel__buttonLabel {\n  max-width: 100%;\n  overflow: hidden !important;\n  text-overflow: ellipsis !important;\n  white-space: nowrap !important;\n  word-wrap: normal !important;\n  font-size: 12px;\n  font-size: 0.75rem;\n  line-height: 1.5;\n  display: block;\n  font-weight: 700;\n  text-align: center;\n  flex-grow: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(250);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsSuggestionPanel__title {\n  margin-left: 2px; }\n\n.lnsSuggestionPanel__suggestions {\n  scrollbar-width: thin;\n  -webkit-mask-image: linear-gradient(to right, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n          mask-image: linear-gradient(to right, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n  padding-top: 4px;\n  overflow-x: scroll;\n  overflow-y: hidden;\n  display: flex;\n  padding-left: 4px;\n  margin-left: -4px; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar-corner, .lnsSuggestionPanel__suggestions::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsSuggestionPanel__button {\n  position: relative;\n  flex: 0 0 auto;\n  width: 150px !important;\n  height: 100px;\n  margin-right: 8px;\n  margin-left: 2px;\n  margin-bottom: 2px; }\n  .lnsSuggestionPanel__button .lnsSuggestionPanel__expressionRenderer {\n    position: static; }\n\n.lnsSuggestionPanel__button-isSelected {\n  animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsSuggestionPanel__suggestionIcon {\n  color: #6D6D6D;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 8px; }\n  .lnsSuggestionPanel__suggestionIcon:not(:only-child) {\n    height: calc(100% - 24px); }\n\n.lnsSuggestionPanel__chartWrapper {\n  display: flex;\n  height: 100%;\n  width: 100%;\n  pointer-events: none; }\n\n.lnsSuggestionPanel__chartWrapper--withLabel {\n  height: calc(100% - 24px); }\n\n.lnsSuggestionPanel__buttonLabel {\n  max-width: 100%;\n  overflow: hidden !important;\n  text-overflow: ellipsis !important;\n  white-space: nowrap !important;\n  word-wrap: normal !important;\n  font-size: 12px;\n  font-size: 0.75rem;\n  line-height: 1.5;\n  display: block;\n  font-weight: 700;\n  text-align: center;\n  flex-grow: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(252);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsSuggestionPanel__title {\n  margin-left: 2px; }\n\n.lnsSuggestionPanel__suggestions {\n  scrollbar-width: thin;\n  -webkit-mask-image: linear-gradient(to right, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n          mask-image: linear-gradient(to right, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n  padding-top: 4px;\n  overflow-x: scroll;\n  overflow-y: hidden;\n  display: flex;\n  padding-left: 4px;\n  margin-left: -4px; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar-corner, .lnsSuggestionPanel__suggestions::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsSuggestionPanel__button {\n  position: relative;\n  flex: 0 0 auto;\n  width: 150px !important;\n  height: 100px;\n  margin-right: 8px;\n  margin-left: 2px;\n  margin-bottom: 2px; }\n  .lnsSuggestionPanel__button .lnsSuggestionPanel__expressionRenderer {\n    position: static; }\n\n.lnsSuggestionPanel__button-isSelected {\n  animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsSuggestionPanel__suggestionIcon {\n  color: #98A2B3;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 8px; }\n  .lnsSuggestionPanel__suggestionIcon:not(:only-child) {\n    height: calc(100% - 24px); }\n\n.lnsSuggestionPanel__chartWrapper {\n  display: flex;\n  height: 100%;\n  width: 100%;\n  pointer-events: none; }\n\n.lnsSuggestionPanel__chartWrapper--withLabel {\n  height: calc(100% - 24px); }\n\n.lnsSuggestionPanel__buttonLabel {\n  max-width: 100%;\n  overflow: hidden !important;\n  text-overflow: ellipsis !important;\n  white-space: nowrap !important;\n  word-wrap: normal !important;\n  font-size: 12px;\n  font-size: 0.85714rem;\n  line-height: 1.5;\n  display: block;\n  font-weight: 700;\n  text-align: center;\n  flex-grow: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(254);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsSuggestionPanel__title {\n  margin-left: 2px; }\n\n.lnsSuggestionPanel__suggestions {\n  scrollbar-width: thin;\n  -webkit-mask-image: linear-gradient(to right, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n          mask-image: linear-gradient(to right, rgba(255, 0, 0, 0.1) 0%, red 7.5px, red calc(100% - 7.5px), rgba(255, 0, 0, 0.1) 100%);\n  padding-top: 4px;\n  overflow-x: scroll;\n  overflow-y: hidden;\n  display: flex;\n  padding-left: 4px;\n  margin-left: -4px; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsSuggestionPanel__suggestions::-webkit-scrollbar-corner, .lnsSuggestionPanel__suggestions::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.lnsSuggestionPanel__button {\n  position: relative;\n  flex: 0 0 auto;\n  width: 150px !important;\n  height: 100px;\n  margin-right: 8px;\n  margin-left: 2px;\n  margin-bottom: 2px; }\n  .lnsSuggestionPanel__button .lnsSuggestionPanel__expressionRenderer {\n    position: static; }\n\n.lnsSuggestionPanel__button-isSelected {\n  animation: 350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important; }\n\n.lnsSuggestionPanel__suggestionIcon {\n  color: #6D6D6D;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 8px; }\n  .lnsSuggestionPanel__suggestionIcon:not(:only-child) {\n    height: calc(100% - 24px); }\n\n.lnsSuggestionPanel__chartWrapper {\n  display: flex;\n  height: 100%;\n  width: 100%;\n  pointer-events: none; }\n\n.lnsSuggestionPanel__chartWrapper--withLabel {\n  height: calc(100% - 24px); }\n\n.lnsSuggestionPanel__buttonLabel {\n  max-width: 100%;\n  overflow: hidden !important;\n  text-overflow: ellipsis !important;\n  white-space: nowrap !important;\n  word-wrap: normal !important;\n  font-size: 12px;\n  font-size: 0.85714rem;\n  line-height: 1.5;\n  display: block;\n  font-weight: 700;\n  text-align: center;\n  flex-grow: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fromExpression=fromExpression;exports.safeElementFromExpression=safeElementFromExpression;exports.toExpression=toExpression;var _get_type=__webpack_require__(38);var _grammar=__webpack_require__(41);function getArgumentString(arg,argKey,level=0){const type=(0,_get_type.getType)(arg);function maybeArgKey(argKey,argString){return argKey==null||argKey==="_"?argString:"".concat(argKey,"=").concat(argString)}if(type==="string"){const escapedArg=arg.replace(/[\\"]/g,"\\$&");return maybeArgKey(argKey,'"'.concat(escapedArg,'"'))}if(type==="boolean"||type==="null"||type==="number"){return maybeArgKey(argKey,"".concat(arg))}if(type==="expression"){return maybeArgKey(argKey,"{".concat(getExpression(arg.chain,level+1),"}"))}throw new Error("Invalid argument type in AST: ".concat(type))}function getExpressionArgs(block,level=0){const args=block.arguments;const hasValidArgs=typeof args==="object"&&args!=null&&!Array.isArray(args);if(!hasValidArgs)throw new Error("Arguments can only be an object");const argKeys=Object.keys(args);const MAX_LINE_LENGTH=80;return argKeys.map(argKey=>args[argKey].reduce((acc,arg)=>{const argString=getArgumentString(arg,argKey,level);const lineLength=acc.split("\n").pop().length;if(level===0&&lineLength+argString.length>MAX_LINE_LENGTH){return"".concat(acc,"\n  ").concat(argString)}if(lineLength>0)return"".concat(acc," ").concat(argString);return argString},""))}function fnWithArgs(fnName,args){if(!args||args.length===0)return fnName;return"".concat(fnName," ").concat(args.join(" "))}function getExpression(chain,level=0){if(!chain)throw new Error("Expressions must contain a chain");const separator=level>0?" | ":"\n| ";return chain.map(chainObj=>{const type=(0,_get_type.getType)(chainObj);if(type==="function"){const fn=chainObj.function;if(!fn||fn.length===0)throw new Error("Functions must have a function name");const expArgs=getExpressionArgs(chainObj,level);return fnWithArgs(fn,expArgs)}},[]).join(separator)}function fromExpression(expression,type="expression"){try{return(0,_grammar.parse)(String(expression),{startRule:type})}catch(e){throw new Error("Unable to parse expression: ".concat(e.message))}}function safeElementFromExpression(expression){try{return fromExpression(expression)}catch(e){return fromExpression("markdown\n\"## Crud.\nCanvas could not parse this element's expression. I am so sorry this error isn't more useful. I promise it will be soon.\n\nThanks for understanding,\n#### Management\n\"")}}function toExpression(astObj,type="expression"){if(type==="argument")return getArgumentString(astObj);const validType=["expression","function"].includes((0,_get_type.getType)(astObj));if(!validType)throw new Error("Expression must be an expression or argument function");if((0,_get_type.getType)(astObj)==="expression"){if(!Array.isArray(astObj.chain))throw new Error("Expressions must contain a chain");return getExpression(astObj.chain)}const expArgs=getExpressionArgs(astObj);return fnWithArgs(astObj.function,expArgs)}},function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(42);Object.defineProperty(exports,"__esModule",{value:true});exports.Fn=Fn;var _defineProperty2=_interopRequireDefault(__webpack_require__(43));var _lodash=__webpack_require__(21);var _arg=__webpack_require__(257);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){(0,_defineProperty2.default)(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function Fn(config){this.name=config.name;this.type=config.type;this.aliases=config.aliases||[];this.fn=(...args)=>Promise.resolve(config.fn(...args));this.help=config.help||"";this.args=(0,_lodash.mapValues)(config.args||{},(arg,name)=>new _arg.Arg(_objectSpread({name:name},arg)));this.context=config.context||{};this.accepts=type=>{if(!this.context.types)return true;return(0,_lodash.includes)(this.context.types,type)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Arg=Arg;var _lodash=__webpack_require__(21);function Arg(config){if(config.name==="_")throw Error("Arg names must not be _. Use it in aliases instead.");this.name=config.name;this.required=config.required||false;this.help=config.help||"";this.types=config.types||[];this.default=config.default;this.aliases=config.aliases||[];this.multi=config.multi==null?false:config.multi;this.resolve=config.resolve==null?true:config.resolve;this.options=config.options||[];this.accepts=type=>{if(!this.types.length)return true;return(0,_lodash.includes)(config.types,type)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.castProvider=castProvider;var _get_type=__webpack_require__(38);function castProvider(types){return function cast(node,toTypeNames){if(!toTypeNames||toTypeNames.length===0)return node;const fromTypeName=(0,_get_type.getType)(node);if(toTypeNames.includes(fromTypeName))return node;const fromTypeDef=types[fromTypeName];for(let i=0;i<toTypeNames.length;i++){if(fromTypeDef&&fromTypeDef.castsTo(toTypeNames[i])){return fromTypeDef.to(node,toTypeNames[i],types)}const toTypeDef=types[toTypeNames[i]];if(toTypeDef&&toTypeDef.castsFrom(fromTypeName))return toTypeDef.from(node,types)}throw new Error("Can not cast '".concat(fromTypeName,"' to any of '").concat(toTypeNames.join(", "),"'"))}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getByAlias=getByAlias;function getByAlias(specs,name){const lowerCaseName=name.toLowerCase();return Object.values(specs).find(({name:name,aliases:aliases})=>{if(name.toLowerCase()===lowerCaseName)return true;return(aliases||[]).some(alias=>alias.toLowerCase()===lowerCaseName)})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Registry=void 0;var _lodash=__webpack_require__(21);class Registry{constructor(prop="name"){if(typeof prop!=="string")throw new Error("Registry property name must be a string");this._prop=prop;this._indexed=new Object}wrapper(obj){return obj}register(fn){const obj=typeof fn==="function"?fn():fn;if(typeof obj!=="object"||!obj[this._prop]){throw new Error("Registered functions must return an object with a ".concat(this._prop," property"))}this._indexed[obj[this._prop].toLowerCase()]=this.wrapper(obj)}toJS(){return Object.keys(this._indexed).reduce((acc,key)=>{acc[key]=this.get(key);return acc},{})}toArray(){return Object.keys(this._indexed).map(key=>this.get(key))}get(name){if(name===undefined)return null;const lowerCaseName=name.toLowerCase();return this._indexed[lowerCaseName]?(0,_lodash.clone)(this._indexed[lowerCaseName]):null}getProp(){return this._prop}reset(){this._indexed=new Object}}exports.Registry=Registry},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.addRegistries=addRegistries;exports.register=register;exports.registryFactory=registryFactory;function addRegistries(registries,newRegistries){Object.keys(newRegistries).forEach(registryName=>{if(registries[registryName]){throw new Error('There is already a registry named "'.concat(registryName,'".'))}registries[registryName]=newRegistries[registryName]});return registries}function register(registries,specs){Object.keys(specs).forEach(registryName=>{if(!registries[registryName]){throw new Error('There is no registry named "'.concat(registryName,'".'))}if(!registries[registryName].register){throw new Error('Registry "'.concat(registryName,'" must have a register function.'))}specs[registryName].forEach(f=>registries[registryName].register(f))});return registries}function registryFactory(registries){return{registries(){return registries},register(specs){return register(registries,specs)}}}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(263);case"v7light":return __webpack_require__(265);case"v8dark":return __webpack_require__(267);case"v8light":return __webpack_require__(269)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(264);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsWorkspacePanelWrapper {\n  scrollbar-width: thin;\n  overflow: hidden;\n  padding: 0 !important;\n  margin-bottom: 16px;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  min-height: 400px; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar-corner, .lnsWorkspacePanelWrapper::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody {\n    scrollbar-width: thin;\n    flex-grow: 1;\n    display: flex;\n    align-items: stretch;\n    justify-content: stretch;\n    overflow: auto; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar {\n      width: 16px;\n      height: 16px; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-thumb {\n      background-color: rgba(152, 162, 179, 0.5);\n      border: 6px solid transparent;\n      background-clip: content-box; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-corner, .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-track {\n      background-color: transparent; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody > * {\n      flex: 1 1 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      overflow: hidden; }\n\n.lnsWorkspacePanel__dragDrop {\n  background-color: transparent !important;\n  border: none !important; }\n\n.lnsDragDrop-isDropTarget .lnsExpressionRenderer {\n  transition: opacity 250ms ease-in-out, -webkit-filter 250ms ease-in-out;\n  transition: filter 250ms ease-in-out, opacity 250ms ease-in-out;\n  transition: filter 250ms ease-in-out, opacity 250ms ease-in-out, -webkit-filter 250ms ease-in-out;\n  -webkit-filter: blur(4px);\n          filter: blur(4px);\n  opacity: .25; }\n\n.lnsWorkspacePanel__emptyContent {\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  transition: background-color 150ms ease-in-out; }\n  .lnsDragDrop-isDropTarget .lnsWorkspacePanel__emptyContent {\n    border: 1px dashed #343741;\n    background-color: rgba(157, 87, 244, 0.1); }\n    .lnsDragDrop-isDropTarget .lnsWorkspacePanel__emptyContent p {\n      transition: -webkit-filter 150ms ease-in-out;\n      transition: filter 150ms ease-in-out;\n      transition: filter 150ms ease-in-out, -webkit-filter 150ms ease-in-out;\n      -webkit-filter: blur(5px);\n              filter: blur(5px); }\n  .lnsDragDrop-isActiveDropTarget .lnsWorkspacePanel__emptyContent {\n    background-color: rgba(157, 87, 244, 0.25);\n    border: 1px dashed #9D57F4; }\n    .lnsDragDrop-isActiveDropTarget .lnsWorkspacePanel__emptyContent .lnsDropIllustration__hand {\n      animation: lnsWorkspacePanel__illustrationPulseContinuous 1.5s ease-in-out 0s infinite normal forwards; }\n\n.lnsWorkspacePanelWrapper__toolbar {\n  margin-bottom: 0; }\n\n.lnsDropIllustration__adjustFill {\n  fill: #FFF; }\n\n.lnsWorkspacePanel__dropIllustration {\n  overflow: visible;\n  margin-top: 24px;\n  margin-bottom: 40px;\n  -webkit-filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.2)) drop-shadow(0 4px 4px rgba(0, 0, 0, 0.2)) drop-shadow(0 2px 2px rgba(0, 0, 0, 0.2));\n          filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.2)) drop-shadow(0 4px 4px rgba(0, 0, 0, 0.2)) drop-shadow(0 2px 2px rgba(0, 0, 0, 0.2)); }\n\n.lnsDropIllustration__hand {\n  animation: lnsWorkspacePanel__illustrationPulseArrow 5s ease-in-out 0s infinite normal forwards; }\n\n@keyframes lnsWorkspacePanel__illustrationPulseArrow {\n  0% {\n    transform: translateY(0%); }\n  65% {\n    transform: translateY(0%); }\n  72% {\n    transform: translateY(10%); }\n  79% {\n    transform: translateY(7%); }\n  86% {\n    transform: translateY(10%); }\n  95% {\n    transform: translateY(0); } }\n\n@keyframes lnsWorkspacePanel__illustrationPulseContinuous {\n  0% {\n    transform: translateY(10%); }\n  25% {\n    transform: translateY(15%); }\n  50% {\n    transform: translateY(10%); }\n  75% {\n    transform: translateY(15%); }\n  100% {\n    transform: translateY(10%); } }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(266);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsWorkspacePanelWrapper {\n  scrollbar-width: thin;\n  overflow: hidden;\n  padding: 0 !important;\n  margin-bottom: 16px;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  min-height: 400px; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar-corner, .lnsWorkspacePanelWrapper::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody {\n    scrollbar-width: thin;\n    flex-grow: 1;\n    display: flex;\n    align-items: stretch;\n    justify-content: stretch;\n    overflow: auto; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar {\n      width: 16px;\n      height: 16px; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-thumb {\n      background-color: rgba(109, 109, 109, 0.5);\n      border: 6px solid transparent;\n      background-clip: content-box; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-corner, .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-track {\n      background-color: transparent; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody > * {\n      flex: 1 1 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      overflow: hidden; }\n\n.lnsWorkspacePanel__dragDrop {\n  background-color: transparent !important;\n  border: none !important; }\n\n.lnsDragDrop-isDropTarget .lnsExpressionRenderer {\n  transition: opacity 250ms ease-in-out, -webkit-filter 250ms ease-in-out;\n  transition: filter 250ms ease-in-out, opacity 250ms ease-in-out;\n  transition: filter 250ms ease-in-out, opacity 250ms ease-in-out, -webkit-filter 250ms ease-in-out;\n  -webkit-filter: blur(4px);\n          filter: blur(4px);\n  opacity: .25; }\n\n.lnsWorkspacePanel__emptyContent {\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  transition: background-color 150ms ease-in-out; }\n  .lnsDragDrop-isDropTarget .lnsWorkspacePanel__emptyContent {\n    border: 1px dashed #E6E6E6;\n    background-color: rgba(157, 87, 244, 0.1); }\n    .lnsDragDrop-isDropTarget .lnsWorkspacePanel__emptyContent p {\n      transition: -webkit-filter 150ms ease-in-out;\n      transition: filter 150ms ease-in-out;\n      transition: filter 150ms ease-in-out, -webkit-filter 150ms ease-in-out;\n      -webkit-filter: blur(5px);\n              filter: blur(5px); }\n  .lnsDragDrop-isActiveDropTarget .lnsWorkspacePanel__emptyContent {\n    background-color: rgba(157, 87, 244, 0.25);\n    border: 1px dashed #9D57F4; }\n    .lnsDragDrop-isActiveDropTarget .lnsWorkspacePanel__emptyContent .lnsDropIllustration__hand {\n      animation: lnsWorkspacePanel__illustrationPulseContinuous 1.5s ease-in-out 0s infinite normal forwards; }\n\n.lnsWorkspacePanelWrapper__toolbar {\n  margin-bottom: 0; }\n\n.lnsDropIllustration__adjustFill {\n  fill: #222; }\n\n.lnsWorkspacePanel__dropIllustration {\n  overflow: visible;\n  margin-top: 24px;\n  margin-bottom: 40px;\n  -webkit-filter: drop-shadow(0 6px 12px rgba(144, 144, 144, 0.2)) drop-shadow(0 4px 4px rgba(144, 144, 144, 0.2)) drop-shadow(0 2px 2px rgba(144, 144, 144, 0.2));\n          filter: drop-shadow(0 6px 12px rgba(144, 144, 144, 0.2)) drop-shadow(0 4px 4px rgba(144, 144, 144, 0.2)) drop-shadow(0 2px 2px rgba(144, 144, 144, 0.2)); }\n\n.lnsDropIllustration__hand {\n  animation: lnsWorkspacePanel__illustrationPulseArrow 5s ease-in-out 0s infinite normal forwards; }\n\n@keyframes lnsWorkspacePanel__illustrationPulseArrow {\n  0% {\n    transform: translateY(0%); }\n  65% {\n    transform: translateY(0%); }\n  72% {\n    transform: translateY(10%); }\n  79% {\n    transform: translateY(7%); }\n  86% {\n    transform: translateY(10%); }\n  95% {\n    transform: translateY(0); } }\n\n@keyframes lnsWorkspacePanel__illustrationPulseContinuous {\n  0% {\n    transform: translateY(10%); }\n  25% {\n    transform: translateY(15%); }\n  50% {\n    transform: translateY(10%); }\n  75% {\n    transform: translateY(15%); }\n  100% {\n    transform: translateY(10%); } }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(268);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsWorkspacePanelWrapper {\n  scrollbar-width: thin;\n  overflow: hidden;\n  padding: 0 !important;\n  margin-bottom: 16px;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  min-height: 400px; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar-corner, .lnsWorkspacePanelWrapper::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody {\n    scrollbar-width: thin;\n    flex-grow: 1;\n    display: flex;\n    align-items: stretch;\n    justify-content: stretch;\n    overflow: auto; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar {\n      width: 16px;\n      height: 16px; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-thumb {\n      background-color: rgba(152, 162, 179, 0.5);\n      border: 6px solid transparent;\n      background-clip: content-box; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-corner, .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-track {\n      background-color: transparent; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody > * {\n      flex: 1 1 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      overflow: hidden; }\n\n.lnsWorkspacePanel__dragDrop {\n  background-color: transparent !important;\n  border: none !important; }\n\n.lnsDragDrop-isDropTarget .lnsExpressionRenderer {\n  transition: opacity 250ms ease-in-out, -webkit-filter 250ms ease-in-out;\n  transition: filter 250ms ease-in-out, opacity 250ms ease-in-out;\n  transition: filter 250ms ease-in-out, opacity 250ms ease-in-out, -webkit-filter 250ms ease-in-out;\n  -webkit-filter: blur(4px);\n          filter: blur(4px);\n  opacity: .25; }\n\n.lnsWorkspacePanel__emptyContent {\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  transition: background-color 150ms ease-in-out; }\n  .lnsDragDrop-isDropTarget .lnsWorkspacePanel__emptyContent {\n    border: 1px dashed #343741;\n    background-color: rgba(157, 87, 244, 0.1); }\n    .lnsDragDrop-isDropTarget .lnsWorkspacePanel__emptyContent p {\n      transition: -webkit-filter 150ms ease-in-out;\n      transition: filter 150ms ease-in-out;\n      transition: filter 150ms ease-in-out, -webkit-filter 150ms ease-in-out;\n      -webkit-filter: blur(5px);\n              filter: blur(5px); }\n  .lnsDragDrop-isActiveDropTarget .lnsWorkspacePanel__emptyContent {\n    background-color: rgba(157, 87, 244, 0.25);\n    border: 1px dashed #9D57F4; }\n    .lnsDragDrop-isActiveDropTarget .lnsWorkspacePanel__emptyContent .lnsDropIllustration__hand {\n      animation: lnsWorkspacePanel__illustrationPulseContinuous 1.5s ease-in-out 0s infinite normal forwards; }\n\n.lnsWorkspacePanelWrapper__toolbar {\n  margin-bottom: 0; }\n\n.lnsDropIllustration__adjustFill {\n  fill: #FFF; }\n\n.lnsWorkspacePanel__dropIllustration {\n  overflow: visible;\n  margin-top: 24px;\n  margin-bottom: 40px;\n  -webkit-filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.2)) drop-shadow(0 4px 4px rgba(0, 0, 0, 0.2)) drop-shadow(0 2px 2px rgba(0, 0, 0, 0.2));\n          filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.2)) drop-shadow(0 4px 4px rgba(0, 0, 0, 0.2)) drop-shadow(0 2px 2px rgba(0, 0, 0, 0.2)); }\n\n.lnsDropIllustration__hand {\n  animation: lnsWorkspacePanel__illustrationPulseArrow 5s ease-in-out 0s infinite normal forwards; }\n\n@keyframes lnsWorkspacePanel__illustrationPulseArrow {\n  0% {\n    transform: translateY(0%); }\n  65% {\n    transform: translateY(0%); }\n  72% {\n    transform: translateY(10%); }\n  79% {\n    transform: translateY(7%); }\n  86% {\n    transform: translateY(10%); }\n  95% {\n    transform: translateY(0); } }\n\n@keyframes lnsWorkspacePanel__illustrationPulseContinuous {\n  0% {\n    transform: translateY(10%); }\n  25% {\n    transform: translateY(15%); }\n  50% {\n    transform: translateY(10%); }\n  75% {\n    transform: translateY(15%); }\n  100% {\n    transform: translateY(10%); } }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(270);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsWorkspacePanelWrapper {\n  scrollbar-width: thin;\n  overflow: hidden;\n  padding: 0 !important;\n  margin-bottom: 16px;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  min-height: 400px; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar-thumb {\n    background-color: rgba(109, 109, 109, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .lnsWorkspacePanelWrapper::-webkit-scrollbar-corner, .lnsWorkspacePanelWrapper::-webkit-scrollbar-track {\n    background-color: transparent; }\n  .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody {\n    scrollbar-width: thin;\n    flex-grow: 1;\n    display: flex;\n    align-items: stretch;\n    justify-content: stretch;\n    overflow: auto; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar {\n      width: 16px;\n      height: 16px; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-thumb {\n      background-color: rgba(109, 109, 109, 0.5);\n      border: 6px solid transparent;\n      background-clip: content-box; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-corner, .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody::-webkit-scrollbar-track {\n      background-color: transparent; }\n    .lnsWorkspacePanelWrapper .lnsWorkspacePanelWrapper__pageContentBody > * {\n      flex: 1 1 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      overflow: hidden; }\n\n.lnsWorkspacePanel__dragDrop {\n  background-color: transparent !important;\n  border: none !important; }\n\n.lnsDragDrop-isDropTarget .lnsExpressionRenderer {\n  transition: opacity 250ms ease-in-out, -webkit-filter 250ms ease-in-out;\n  transition: filter 250ms ease-in-out, opacity 250ms ease-in-out;\n  transition: filter 250ms ease-in-out, opacity 250ms ease-in-out, -webkit-filter 250ms ease-in-out;\n  -webkit-filter: blur(4px);\n          filter: blur(4px);\n  opacity: .25; }\n\n.lnsWorkspacePanel__emptyContent {\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  transition: background-color 150ms ease-in-out; }\n  .lnsDragDrop-isDropTarget .lnsWorkspacePanel__emptyContent {\n    border: 1px dashed #E6E6E6;\n    background-color: rgba(157, 87, 244, 0.1); }\n    .lnsDragDrop-isDropTarget .lnsWorkspacePanel__emptyContent p {\n      transition: -webkit-filter 150ms ease-in-out;\n      transition: filter 150ms ease-in-out;\n      transition: filter 150ms ease-in-out, -webkit-filter 150ms ease-in-out;\n      -webkit-filter: blur(5px);\n              filter: blur(5px); }\n  .lnsDragDrop-isActiveDropTarget .lnsWorkspacePanel__emptyContent {\n    background-color: rgba(157, 87, 244, 0.25);\n    border: 1px dashed #9D57F4; }\n    .lnsDragDrop-isActiveDropTarget .lnsWorkspacePanel__emptyContent .lnsDropIllustration__hand {\n      animation: lnsWorkspacePanel__illustrationPulseContinuous 1.5s ease-in-out 0s infinite normal forwards; }\n\n.lnsWorkspacePanelWrapper__toolbar {\n  margin-bottom: 0; }\n\n.lnsDropIllustration__adjustFill {\n  fill: #222; }\n\n.lnsWorkspacePanel__dropIllustration {\n  overflow: visible;\n  margin-top: 24px;\n  margin-bottom: 40px;\n  -webkit-filter: drop-shadow(0 6px 12px rgba(34, 34, 34, 0.2)) drop-shadow(0 4px 4px rgba(34, 34, 34, 0.2)) drop-shadow(0 2px 2px rgba(34, 34, 34, 0.2));\n          filter: drop-shadow(0 6px 12px rgba(34, 34, 34, 0.2)) drop-shadow(0 4px 4px rgba(34, 34, 34, 0.2)) drop-shadow(0 2px 2px rgba(34, 34, 34, 0.2)); }\n\n.lnsDropIllustration__hand {\n  animation: lnsWorkspacePanel__illustrationPulseArrow 5s ease-in-out 0s infinite normal forwards; }\n\n@keyframes lnsWorkspacePanel__illustrationPulseArrow {\n  0% {\n    transform: translateY(0%); }\n  65% {\n    transform: translateY(0%); }\n  72% {\n    transform: translateY(10%); }\n  79% {\n    transform: translateY(7%); }\n  86% {\n    transform: translateY(10%); }\n  95% {\n    transform: translateY(0); } }\n\n@keyframes lnsWorkspacePanel__illustrationPulseContinuous {\n  0% {\n    transform: translateY(10%); }\n  25% {\n    transform: translateY(15%); }\n  50% {\n    transform: translateY(10%); }\n  75% {\n    transform: translateY(15%); }\n  100% {\n    transform: translateY(10%); } }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(272);case"v7light":return __webpack_require__(274);case"v8dark":return __webpack_require__(276);case"v8light":return __webpack_require__(278)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(273);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsChartSwitch__header > * {\n  display: flex;\n  align-items: center; }\n\n.lnsChartSwitch__summaryIcon {\n  margin-right: 8px;\n  transform: translateY(-1px);\n  color: #81858f; }\n\nimg.lnsChartSwitch__chartIcon {\n  width: 100%; }\n\n.lnsChartSwitch__search {\n  width: 160px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(275);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsChartSwitch__header > * {\n  display: flex;\n  align-items: center; }\n\n.lnsChartSwitch__summaryIcon {\n  margin-right: 8px;\n  transform: translateY(-1px);\n  color: #747474; }\n\nimg.lnsChartSwitch__chartIcon {\n  width: 100%; }\n\n.lnsChartSwitch__search {\n  width: 160px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(277);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsChartSwitch__header > * {\n  display: flex;\n  align-items: center; }\n\n.lnsChartSwitch__summaryIcon {\n  margin-right: 8px;\n  transform: translateY(-1px);\n  color: #81858f; }\n\nimg.lnsChartSwitch__chartIcon {\n  width: 100%; }\n\n.lnsChartSwitch__search {\n  width: 160px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(279);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsChartSwitch__header > * {\n  display: flex;\n  align-items: center; }\n\n.lnsChartSwitch__summaryIcon {\n  margin-right: 8px;\n  transform: translateY(-1px);\n  color: #747474; }\n\nimg.lnsChartSwitch__chartIcon {\n  width: 100%; }\n\n.lnsChartSwitch__search {\n  width: 160px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(281);case"v7light":return __webpack_require__(283);case"v8dark":return __webpack_require__(285);case"v8light":return __webpack_require__(287)}},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(282);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n\n.lnsApp {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden; }\n\n.lnsApp__header {\n  border-bottom: 1px solid #343741; }\n\n.lnsApp__frame {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n\n.lensChartIcon__subdued {\n  fill: #81858f; }\n  .euiButton--fill .lensChartIcon__subdued {\n    fill: currentColor; }\n\n.lensChartIcon__accent {\n  fill: #9D57F4; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(284);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n\n.lnsApp {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden; }\n\n.lnsApp__header {\n  border-bottom: 1px solid #E6E6E6; }\n\n.lnsApp__frame {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n\n.lensChartIcon__subdued {\n  fill: #747474; }\n  .euiButton--fill .lensChartIcon__subdued {\n    fill: currentColor; }\n\n.lensChartIcon__accent {\n  fill: #9D57F4; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(286);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n\n.lnsApp {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden; }\n\n.lnsApp__header {\n  border-bottom: 1px solid #343741; }\n\n.lnsApp__frame {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n\n.lensChartIcon__subdued {\n  fill: #81858f; }\n  .euiButton--fill .lensChartIcon__subdued {\n    fill: currentColor; }\n\n.lensChartIcon__accent {\n  fill: #9D57F4; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(33);var content=__webpack_require__(288);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(34);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".lnsAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n\n.lnsApp {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden; }\n\n.lnsApp__header {\n  border-bottom: 1px solid #E6E6E6; }\n\n.lnsApp__frame {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n\n.lensChartIcon__subdued {\n  fill: #747474; }\n  .euiButton--fill .lensChartIcon__subdued {\n    fill: currentColor; }\n\n.lensChartIcon__accent {\n  fill: #9D57F4; }\n",""]);module.exports=exports},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"datatable",(function(){return expression_datatable}));__webpack_require__.d(__webpack_exports__,"datatableColumns",(function(){return datatableColumns}));__webpack_require__.d(__webpack_exports__,"getDatatableRenderer",(function(){return getDatatableRenderer}));__webpack_require__.d(__webpack_exports__,"DatatableComponent",(function(){return DatatableComponent}));__webpack_require__.d(__webpack_exports__,"datatableVisualization",(function(){return datatableVisualization}));__webpack_require__.d(__webpack_exports__,"metricChart",(function(){return metricChart}));__webpack_require__.d(__webpack_exports__,"getMetricChartRenderer",(function(){return getMetricChartRenderer}));__webpack_require__.d(__webpack_exports__,"MetricChart",(function(){return MetricChart}));__webpack_require__.d(__webpack_exports__,"metricVisualization",(function(){return metricVisualization}));__webpack_require__.d(__webpack_exports__,"pie",(function(){return pie}));__webpack_require__.d(__webpack_exports__,"getPieRenderer",(function(){return getPieRenderer}));__webpack_require__.d(__webpack_exports__,"getPieVisualization",(function(){return getPieVisualization}));__webpack_require__.d(__webpack_exports__,"xyChart",(function(){return xyChart}));__webpack_require__.d(__webpack_exports__,"calculateMinInterval",(function(){return calculateMinInterval}));__webpack_require__.d(__webpack_exports__,"getXyChartRenderer",(function(){return getXyChartRenderer}));__webpack_require__.d(__webpack_exports__,"XYChartReportable",(function(){return XYChartReportable}));__webpack_require__.d(__webpack_exports__,"XYChart",(function(){return XYChart}));__webpack_require__.d(__webpack_exports__,"legendConfig",(function(){return legendConfig}));__webpack_require__.d(__webpack_exports__,"tickLabelsConfig",(function(){return tickLabelsConfig}));__webpack_require__.d(__webpack_exports__,"gridlinesConfig",(function(){return gridlinesConfig}));__webpack_require__.d(__webpack_exports__,"axisTitlesVisibilityConfig",(function(){return axisTitlesVisibilityConfig}));__webpack_require__.d(__webpack_exports__,"yAxisConfig",(function(){return yAxisConfig}));__webpack_require__.d(__webpack_exports__,"layerConfig",(function(){return layerConfig}));__webpack_require__.d(__webpack_exports__,"visualizationTypes",(function(){return types_visualizationTypes}));__webpack_require__.d(__webpack_exports__,"getXyVisualization",(function(){return getXyVisualization}));__webpack_require__.d(__webpack_exports__,"OperationType",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"IndexPatternColumn",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"deleteColumn",(function(){return deleteColumn}));__webpack_require__.d(__webpack_exports__,"columnToOperation",(function(){return columnToOperation}));__webpack_require__.d(__webpack_exports__,"renameColumns",(function(){return renameColumns}));__webpack_require__.d(__webpack_exports__,"supportedFormats",(function(){return supportedFormats}));__webpack_require__.d(__webpack_exports__,"formatColumn",(function(){return formatColumn}));__webpack_require__.d(__webpack_exports__,"getTimeScaleFunction",(function(){return getTimeScaleFunction}));__webpack_require__.d(__webpack_exports__,"counterRate",(function(){return counterRate}));__webpack_require__.d(__webpack_exports__,"getSuffixFormatter",(function(){return getSuffixFormatter}));__webpack_require__.d(__webpack_exports__,"getIndexPatternDatasource",(function(){return getIndexPatternDatasource}));__webpack_require__.d(__webpack_exports__,"EditorFrame",(function(){return EditorFrame}));__webpack_require__.d(__webpack_exports__,"initializeDatasources",(function(){return initializeDatasources}));__webpack_require__.d(__webpack_exports__,"createDatasourceLayers",(function(){return createDatasourceLayers}));__webpack_require__.d(__webpack_exports__,"persistedStateToExpression",(function(){return persistedStateToExpression}));__webpack_require__.d(__webpack_exports__,"validateDatasourceAndVisualization",(function(){return validateDatasourceAndVisualization}));__webpack_require__.d(__webpack_exports__,"getActiveDatasourceIdFromDoc",(function(){return getActiveDatasourceIdFromDoc}));__webpack_require__.d(__webpack_exports__,"getInitialState",(function(){return getInitialState}));__webpack_require__.d(__webpack_exports__,"reducer",(function(){return reducer}));__webpack_require__.d(__webpack_exports__,"Embeddable",(function(){return embeddable_Embeddable}));__webpack_require__.d(__webpack_exports__,"mountApp",(function(){return mountApp}));__webpack_require__.d(__webpack_exports__,"getLensAttributeService",(function(){return getLensAttributeService}));__webpack_require__.d(__webpack_exports__,"setReportManager",(function(){return setReportManager}));__webpack_require__.d(__webpack_exports__,"stopReportManager",(function(){return stopReportManager}));__webpack_require__.d(__webpack_exports__,"trackUiEvent",(function(){return factory_trackUiEvent}));__webpack_require__.d(__webpack_exports__,"trackSuggestionEvent",(function(){return trackSuggestionEvent}));__webpack_require__.d(__webpack_exports__,"LensReportManager",(function(){return factory_LensReportManager}));var datatable_visualization_expression=__webpack_require__(44);var external_kbnSharedDeps_React_=__webpack_require__(4);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(5);var external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(0);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(8);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(20);var visualization_container=__webpack_require__(53);var classnames=__webpack_require__(35);var classnames_default=__webpack_require__.n(classnames);function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function VisualizationContainer(_ref){let _ref$isReady=_ref.isReady,isReady=_ref$isReady===void 0?true:_ref$isReady,reportTitle=_ref.reportTitle,reportDescription=_ref.reportDescription,children=_ref.children,className=_ref.className,rest=_objectWithoutProperties(_ref,["isReady","reportTitle","reportDescription","children","className"]);const attributes={};if(reportTitle){attributes["data-title"]=reportTitle}if(reportDescription){attributes["data-description"]=reportDescription}return external_kbnSharedDeps_React_default.a.createElement("div",_extends({"data-shared-item":true,"data-render-complete":isReady,className:classnames_default()(className,"lnsVisualizationContainer")},attributes,rest),children)}const EmptyPlaceholder=props=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{className:"lnsChart__empty",textAlign:"center",color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:props.icon,color:"subdued",size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.xyVisualization.noDataLabel",defaultMessage:"No results found"}))));var toolbar_button=__webpack_require__(62);function toolbar_button_extends(){toolbar_button_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return toolbar_button_extends.apply(this,arguments)}function toolbar_button_objectWithoutProperties(source,excluded){if(source==null)return{};var target=toolbar_button_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function toolbar_button_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const groupPositionToClassMap={none:null,left:"lnsToolbarButton--groupLeft",center:"lnsToolbarButton--groupCenter",right:"lnsToolbarButton--groupRight"};const ToolbarButton=_ref=>{let children=_ref.children,className=_ref.className,_ref$fontWeight=_ref.fontWeight,fontWeight=_ref$fontWeight===void 0?"normal":_ref$fontWeight,_ref$size=_ref.size,size=_ref$size===void 0?"m":_ref$size,_ref$hasArrow=_ref.hasArrow,hasArrow=_ref$hasArrow===void 0?true:_ref$hasArrow,_ref$groupPosition=_ref.groupPosition,groupPosition=_ref$groupPosition===void 0?"none":_ref$groupPosition,_ref$dataTestSubj=_ref.dataTestSubj,dataTestSubj=_ref$dataTestSubj===void 0?"":_ref$dataTestSubj,rest=toolbar_button_objectWithoutProperties(_ref,["children","className","fontWeight","size","hasArrow","groupPosition","dataTestSubj"]);const classes=classnames_default()("lnsToolbarButton",groupPositionToClassMap[groupPosition],["lnsToolbarButton--".concat(fontWeight),"lnsToolbarButton--".concat(size)],className);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],toolbar_button_extends({"data-test-subj":dataTestSubj,className:classes,iconSide:"right",iconType:hasArrow?"arrowDown":"",color:"text",contentProps:{className:"lnsToolbarButton__content"},textProps:{className:"lnsToolbarButton__text"}},rest,{size:size}),children)};function legend_extends(){legend_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return legend_extends.apply(this,arguments)}function legend_objectWithoutProperties(source,excluded){if(source==null)return{};var target=legend_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function legend_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const EuiIconLegend=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=legend_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_["createElement"]("svg",legend_extends({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_["createElement"]("title",{id:titleId},title):null,external_kbnSharedDeps_React_["createElement"]("path",{clipRule:"evenodd",fillRule:"evenodd",d:"M2.786.357a.25.25 0 01.428 0l2.559 4.264A.25.25 0 015.558 5H.442a.25.25 0 01-.215-.379L2.786.357zM3 1.944L4.234 4H1.766L3 1.944z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M8.5 2a.5.5 0 000 1h7a.5.5 0 000-1h-7z"}),external_kbnSharedDeps_React_["createElement"]("path",{clipRule:"evenodd",fillRule:"evenodd",d:"M1.5 6a.5.5 0 00-.5.5v3a.5.5 0 00.5.5h3a.5.5 0 00.5-.5v-3a.5.5 0 00-.5-.5h-3zM2 7v2h2V7H2z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M8.5 7.5a.5.5 0 000 1h7a.5.5 0 000-1h-7z"}),external_kbnSharedDeps_React_["createElement"]("path",{clipRule:"evenodd",fillRule:"evenodd",d:"M3 16a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm0-1a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M8.5 13a.5.5 0 000 1h7a.5.5 0 000-1h-7z"}))};function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const typeToIconMap={legend:EuiIconLegend,labels:"visText",values:"number"};const ToolbarPopover=({children:children,title:title,type:type,isDisabled:isDisabled=false,groupPosition:groupPosition,buttonDataTestSubj:buttonDataTestSubj})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];const iconType=typeof type==="string"?typeToIconMap[type]:type;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{panelClassName:"lnsXyToolbar__popover",ownFocus:true,"aria-label":title,button:external_kbnSharedDeps_React_default.a.createElement(ToolbarButton,{fontWeight:"normal",onClick:()=>{setOpen(!open)},title:title,hasArrow:false,isDisabled:isDisabled,groupPosition:groupPosition,dataTestSubj:buttonDataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:iconType})),isOpen:open,closePopover:()=>{setOpen(false)},anchorPosition:"downRight"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,title),children))};var external_kbnSharedDeps_ElasticCharts_=__webpack_require__(22);const toggleButtonsIcons=[{id:external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.legendPositionBottom",{defaultMessage:"Bottom"}),iconType:"arrowDown"},{id:external_kbnSharedDeps_ElasticCharts_["Position"].Left,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.legendPositionLeft",{defaultMessage:"Left"}),iconType:"arrowLeft"},{id:external_kbnSharedDeps_ElasticCharts_["Position"].Right,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.legendPositionRight",{defaultMessage:"Right"}),iconType:"arrowRight"},{id:external_kbnSharedDeps_ElasticCharts_["Position"].Top,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.legendPositionTop",{defaultMessage:"Top"}),iconType:"arrowUp"}];const LegendSettingsPopover=({legendOptions:legendOptions,mode:mode,onDisplayChange:onDisplayChange,position:position,onPositionChange:onPositionChange,renderNestedLegendSwitch:renderNestedLegendSwitch,nestedLegend:nestedLegend,onNestedLegendChange:onNestedLegendChange=(()=>{})})=>external_kbnSharedDeps_React_default.a.createElement(ToolbarPopover,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.legendLabel",{defaultMessage:"Legend"}),type:"legend",groupPosition:"right",buttonDataTestSubj:"lnsLegendButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"columnCompressed",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.legendVisibilityLabel",{defaultMessage:"Display"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{isFullWidth:true,legend:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.legendVisibilityLabel",{defaultMessage:"Display"}),"data-test-subj":"lens-legend-display-btn",name:"legendDisplay",buttonSize:"compressed",options:legendOptions,idSelected:legendOptions.find(({value:value})=>value===mode).id,onChange:onDisplayChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"columnCompressed",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.legendPositionLabel",{defaultMessage:"Position"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{legend:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.legendPositionLabel",{defaultMessage:"Position"}),isDisabled:mode==="hide","data-test-subj":"lens-legend-position-btn",name:"legendPosition",buttonSize:"compressed",options:toggleButtonsIcons,idSelected:position||external_kbnSharedDeps_ElasticCharts_["Position"].Right,onChange:onPositionChange,isIconOnly:true})),renderNestedLegendSwitch&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"columnCompressedSwitch",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.nestedLegendLabel",{defaultMessage:"Nested"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{compressed:true,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.nestedLegendLabel",{defaultMessage:"Nested"}),"data-test-subj":"lens-legend-nested-switch",showLabel:false,disabled:mode==="hide",checked:!!nestedLegend,onChange:onNestedLegendChange})));function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function native_renderer_objectWithoutProperties(source,excluded){if(source==null)return{};var target=native_renderer_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function native_renderer_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function NativeRenderer(_ref){let render=_ref.render,nativeProps=_ref.nativeProps,tag=_ref.tag,rest=native_renderer_objectWithoutProperties(_ref,["render","nativeProps","tag"]);return external_kbnSharedDeps_React_default.a.createElement(tag||"div",_objectSpread(_objectSpread({},rest),{},{ref:el=>el&&render(el,nativeProps)}))}function PalettePicker({palettes:palettes,activePalette:activePalette,setPalette:setPalette}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"columnCompressed",fullWidth:true,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.palettePicker.label",{defaultMessage:"Color palette"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiColorPalettePicker"],{"data-test-subj":"lns-palettePicker",compressed:true,palettes:palettes.getAll().filter(({internal:internal})=>!internal).map(({id:id,title:title,getColors:getColors})=>({value:id,title:title,type:"fixed",palette:getColors(10,id===(activePalette===null||activePalette===void 0?void 0:activePalette.name)?activePalette===null||activePalette===void 0?void 0:activePalette.params:undefined)})),onChange:newPalette=>{setPalette({type:"palette",name:newPalette})},valueOfSelected:(activePalette===null||activePalette===void 0?void 0:activePalette.name)||"default",selectionDisplay:"palette"}),activePalette&&palettes.get(activePalette.name).renderEditor&&external_kbnSharedDeps_React_default.a.createElement(NativeRenderer,{render:palettes.get(activePalette.name).renderEditor,nativeProps:{state:activePalette.params,setState:updater=>{setPalette({type:"palette",name:activePalette.name,params:updater(activePalette.params)})}}})))}function utils_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function utils_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){utils_ownKeys(Object(source),true).forEach((function(key){utils_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{utils_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function utils_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const desanitizeFilterContext=context=>{const emptyTextValue=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexpattern.emptyTextColumnValue",{defaultMessage:"(empty)"});const result=utils_objectSpread(utils_objectSpread({},context),{},{data:context.data.map(point=>point.value===emptyTextValue?utils_objectSpread(utils_objectSpread({},point),{},{value:"",table:utils_objectSpread(utils_objectSpread({},point.table),{},{rows:point.table.rows.map((row,index)=>index===point.row?utils_objectSpread(utils_objectSpread({},row),{},{[point.table.columns[point.column].id]:""}):row)})}):point)});if(context.timeFieldName){result.timeFieldName=context.timeFieldName}return result};function chart_datatable_extends(){chart_datatable_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_datatable_extends.apply(this,arguments)}function chart_datatable_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_datatable_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_datatable_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartDatatable=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_datatable_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_datatable_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M11 18a1 1 0 011 1v2a1 1 0 01-1 1H1a1 1 0 01-1-1v-2a1 1 0 011-1h10zm0-6a1 1 0 011 1v2a1 1 0 01-1 1H1a1 1 0 01-1-1v-2a1 1 0 011-1h10zm0-6a1 1 0 011 1v2a1 1 0 01-1 1H1a1 1 0 01-1-1V7a1 1 0 011-1h10zm18-6a1 1 0 011 1v2a1 1 0 01-1 1H1a1 1 0 01-1-1V1a1 1 0 011-1h28z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M20 18a1 1 0 011 1v2a1 1 0 01-.883.993L20 22h-5a1 1 0 01-1-1v-2a1 1 0 011-1h5zm9 0a1 1 0 011 1v2a1 1 0 01-1 1h-5a1 1 0 01-1-1v-2a1 1 0 011-1h5zm-9-6a1 1 0 011 1v2a1 1 0 01-.883.993L20 16h-5a1 1 0 01-1-1v-2a1 1 0 011-1h5zm9 0a1 1 0 011 1v2a1 1 0 01-1 1h-5a1 1 0 01-1-1v-2a1 1 0 011-1h5zm-9-6a1 1 0 011 1v2a1 1 0 01-.883.993L20 10h-5a1 1 0 01-1-1V7a1 1 0 011-1h5zm9 0a1 1 0 011 1v2a1 1 0 01-1 1h-5a1 1 0 01-1-1V7a1 1 0 011-1h5z",className:"lensChartIcon__accent"}))};function expression_slicedToArray(arr,i){return expression_arrayWithHoles(arr)||expression_iterableToArrayLimit(arr,i)||expression_unsupportedIterableToArray(arr,i)||expression_nonIterableRest()}function expression_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function expression_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return expression_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return expression_arrayLikeToArray(o,minLen)}function expression_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function expression_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function expression_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function expression_extends(){expression_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return expression_extends.apply(this,arguments)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function expression_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function expression_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){expression_ownKeys(Object(source),true).forEach((function(key){expression_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{expression_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function expression_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const expression_datatable={name:"lens_datatable",type:"render",inputTypes:["lens_multitable"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatable.expressionHelpLabel",{defaultMessage:"Datatable renderer"}),args:{title:{types:["string"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatable.titleLabel",{defaultMessage:"Title"})},description:{types:["string"],help:""},columns:{types:["lens_datatable_columns"],help:""}},fn(data,args){return{type:"render",as:"lens_datatable_renderer",value:{data:data,args:args}}}};const datatableColumns={name:"lens_datatable_columns",aliases:[],type:"lens_datatable_columns",help:"",inputTypes:["null"],args:{columnIds:{types:["string"],multi:true,help:""}},fn:function fn(input,args){return expression_objectSpread({type:"lens_datatable_columns"},args)}};const getDatatableRenderer=dependencies=>({name:"lens_datatable_renderer",displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatable.visualizationName",{defaultMessage:"Datatable"}),help:"",validate:()=>undefined,reuseDomNode:true,render:function(){var _render=_asyncToGenerator(regeneratorRuntime.mark((function _callee(domNode,config,handlers){var resolvedFormatFactory,resolvedGetType,onClickValue;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return dependencies.formatFactory;case 2:resolvedFormatFactory=_context.sent;_context.next=5;return dependencies.getType;case 5:resolvedGetType=_context.sent;onClickValue=data=>{handlers.event({name:"filter",data:data})};external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(DatatableComponent,expression_extends({},config,{formatFactory:resolvedFormatFactory,onClickValue:onClickValue,getType:resolvedGetType}))),domNode,()=>{handlers.done()});handlers.onDestroy(()=>external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(domNode));case 9:case"end":return _context.stop()}}),_callee)})));function render(_x,_x2,_x3){return _render.apply(this,arguments)}return render}()});function DatatableComponent(props){const _Object$values=Object.values(props.data.tables),_Object$values2=expression_slicedToArray(_Object$values,1),firstTable=_Object$values2[0];const formatters={};firstTable.columns.forEach(column=>{var _column$meta;formatters[column.id]=props.formatFactory((_column$meta=column.meta)===null||_column$meta===void 0?void 0:_column$meta.params)});const onClickValue=props.onClickValue;const handleFilterClick=Object(external_kbnSharedDeps_React_["useMemo"])(()=>(field,value,colIndex,negate=false)=>{var _col$meta,_col$meta2;const col=firstTable.columns[colIndex];const isDate=((_col$meta=col.meta)===null||_col$meta===void 0?void 0:_col$meta.type)==="date";const timeFieldName=negate&&isDate?undefined:col===null||col===void 0?void 0:(_col$meta2=col.meta)===null||_col$meta2===void 0?void 0:_col$meta2.field;const rowIndex=firstTable.rows.findIndex(row=>row[field]===value);const data={negate:negate,data:[{row:rowIndex,column:colIndex,value:value,table:firstTable}],timeFieldName:timeFieldName};onClickValue(desanitizeFilterContext(data))},[firstTable,onClickValue]);const bucketColumns=firstTable.columns.filter(col=>{var _col$meta3,_col$meta3$sourcePara,_props$getType;return(col===null||col===void 0?void 0:(_col$meta3=col.meta)===null||_col$meta3===void 0?void 0:(_col$meta3$sourcePara=_col$meta3.sourceParams)===null||_col$meta3$sourcePara===void 0?void 0:_col$meta3$sourcePara.type)&&((_props$getType=props.getType(col.meta.sourceParams.type))===null||_props$getType===void 0?void 0:_props$getType.type)==="buckets"}).map(col=>col.id);const isEmpty=firstTable.rows.length===0||bucketColumns.length&&firstTable.rows.every(row=>bucketColumns.every(col=>typeof row[col]==="undefined"));if(isEmpty){return external_kbnSharedDeps_React_default.a.createElement(EmptyPlaceholder,{icon:LensIconChartDatatable})}return external_kbnSharedDeps_React_default.a.createElement(VisualizationContainer,{reportTitle:props.args.title,reportDescription:props.args.description},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{className:"lnsDataTable","data-test-subj":"lnsDataTable",tableLayout:"auto",columns:props.args.columns.columnIds.map(field=>{const col=firstTable.columns.find(c=>c.id===field);const filterable=bucketColumns.includes(field);const colIndex=firstTable.columns.findIndex(c=>c.id===field);return{field:field,name:col&&col.name||"",render:value=>{var _formatters$field,_col$meta4;const formattedValue=(_formatters$field=formatters[field])===null||_formatters$field===void 0?void 0:_formatters$field.convert(value);const fieldName=col===null||col===void 0?void 0:(_col$meta4=col.meta)===null||_col$meta4===void 0?void 0:_col$meta4.field;if(filterable){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{className:"lnsDataTable__cell","data-test-subj":"lnsDataTableCellValueFilterable",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},formattedValue),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"none",alignItems:"center",className:"lnsDataTable__filter"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"bottom",content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.includeValueButtonTooltip",{defaultMessage:"Include value"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:"plusInCircle",color:"text","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.includeValueButtonAriaLabel",{defaultMessage:"Include {value}",values:{value:"".concat(fieldName?"".concat(fieldName,": "):"").concat(formattedValue)}}),"data-test-subj":"lensDatatableFilterFor",onClick:()=>handleFilterClick(field,value,colIndex)})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"bottom",content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.excludeValueButtonTooltip",{defaultMessage:"Exclude value"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:"minusInCircle",color:"text","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.excludeValueButtonAriaLabel",{defaultMessage:"Exclude {value}",values:{value:"".concat(fieldName?"".concat(fieldName,": "):"").concat(formattedValue)}}),"data-test-subj":"lensDatatableFilterOut",onClick:()=>handleFilterClick(field,value,colIndex,true)}))))))}return external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"lnsDataTableCellValue"},formattedValue)}}}).filter(({field:field})=>!!field),items:firstTable?firstTable.rows:[]}))}function visualization_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function visualization_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){visualization_ownKeys(Object(source),true).forEach((function(key){visualization_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{visualization_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function visualization_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function newLayerState(layerId){return{layerId:layerId,columns:[]}}const datatableVisualization={id:"lnsDatatable",visualizationTypes:[{id:"lnsDatatable",icon:LensIconChartDatatable,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatable.label",{defaultMessage:"Data table"})}],getVisualizationTypeId(){return"lnsDatatable"},getLayerIds(state){return state.layers.map(l=>l.layerId)},clearLayer(state){return{layers:state.layers.map(l=>newLayerState(l.layerId))}},getDescription(){return{icon:LensIconChartDatatable,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatable.label",{defaultMessage:"Data table"})}},switchVisualizationType:(_,state)=>state,initialize(frame,state){return state||{layers:[newLayerState(frame.addNewLayer())]}},getSuggestions({table:table,state:state,keptLayerIds:keptLayerIds}){if(keptLayerIds.length>1||keptLayerIds.length&&table.layerId!==keptLayerIds[0]||state&&table.changeType==="unchanged"){return[]}const title=table.changeType==="unchanged"?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatable.suggestionLabel",{defaultMessage:"As table"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatable.visualizationOf",{defaultMessage:"Table {operations}",values:{operations:table.label||table.columns.map(col=>col.operation.label).join(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatable.conjunctionSign",{defaultMessage:" & ",description:"A character that can be used for conjunction of multiple enumarated items. Make sure to include spaces around it if needed."}))}});return[{title:title,score:Math.min(table.columns.length,10)/10*.4,state:{layers:[{layerId:table.layerId,columns:table.columns.map(col=>col.columnId)}]},previewIcon:LensIconChartDatatable,hide:true}]},getConfiguration({state:state,frame:frame,layerId:layerId}){const _ref=getDataSourceAndSortedColumns(state,frame.datasourceLayers,layerId)||{},sortedColumns=_ref.sortedColumns,datasource=_ref.datasource;if(!sortedColumns){return{groups:[]}}return{groups:[{groupId:"columns",groupLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatable.breakdown",{defaultMessage:"Break down by"}),layerId:state.layers[0].layerId,accessors:sortedColumns.filter(c=>{var _getOperationForColum;return(_getOperationForColum=datasource.getOperationForColumnId(c))===null||_getOperationForColum===void 0?void 0:_getOperationForColum.isBucketed}).map(accessor=>({columnId:accessor})),supportsMoreColumns:true,filterOperations:op=>op.isBucketed,dataTestSubj:"lnsDatatable_column"},{groupId:"metrics",groupLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatable.metrics",{defaultMessage:"Metrics"}),layerId:state.layers[0].layerId,accessors:sortedColumns.filter(c=>{var _getOperationForColum2;return!((_getOperationForColum2=datasource.getOperationForColumnId(c))===null||_getOperationForColum2===void 0?void 0:_getOperationForColum2.isBucketed)}).map(accessor=>({columnId:accessor})),supportsMoreColumns:true,filterOperations:op=>!op.isBucketed,required:true,dataTestSubj:"lnsDatatable_metrics"}]}},setDimension({prevState:prevState,layerId:layerId,columnId:columnId}){return visualization_objectSpread(visualization_objectSpread({},prevState),{},{layers:prevState.layers.map(l=>{if(l.layerId!==layerId||l.columns.includes(columnId)){return l}return visualization_objectSpread(visualization_objectSpread({},l),{},{columns:[...l.columns,columnId]})})})},removeDimension({prevState:prevState,layerId:layerId,columnId:columnId}){return visualization_objectSpread(visualization_objectSpread({},prevState),{},{layers:prevState.layers.map(l=>l.layerId===layerId?visualization_objectSpread(visualization_objectSpread({},l),{},{columns:l.columns.filter(c=>c!==columnId)}):l)})},toExpression(state,datasourceLayers,{title:title,description:description}={}){const _ref2=getDataSourceAndSortedColumns(state,datasourceLayers,state.layers[0].layerId)||{},sortedColumns=_ref2.sortedColumns,datasource=_ref2.datasource;if((sortedColumns===null||sortedColumns===void 0?void 0:sortedColumns.length)&&sortedColumns.filter(c=>{var _getOperationForColum3;return!((_getOperationForColum3=datasource.getOperationForColumnId(c))===null||_getOperationForColum3===void 0?void 0:_getOperationForColum3.isBucketed)}).length===0){return null}const operations=sortedColumns.map(columnId=>({columnId:columnId,operation:datasource.getOperationForColumnId(columnId)})).filter(o=>!!o.operation);return{type:"expression",chain:[{type:"function",function:"lens_datatable",arguments:{title:[title||""],description:[description||""],columns:[{type:"expression",chain:[{type:"function",function:"lens_datatable_columns",arguments:{columnIds:operations.map(o=>o.columnId)}}]}]}}]}},getErrorMessages(state,frame){return undefined}};function getDataSourceAndSortedColumns(state,datasourceLayers,layerId){const layer=state.layers.find(l=>l.layerId===layerId);if(!layer){return undefined}const datasource=datasourceLayers[layer.layerId];const originalOrder=datasource.getTableSpec().map(({columnId:columnId})=>columnId);const sortedColumns=Array.from(new Set(originalOrder.concat(layer.columns)));return{datasource:datasource,sortedColumns:sortedColumns}}var metric_visualization_expression=__webpack_require__(71);var external_kbnSharedDeps_Lodash_=__webpack_require__(21);var external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_);function auto_scale_extends(){auto_scale_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return auto_scale_extends.apply(this,arguments)}function auto_scale_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function auto_scale_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){auto_scale_ownKeys(Object(source),true).forEach((function(key){auto_scale_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{auto_scale_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function auto_scale_objectWithoutProperties(source,excluded){if(source==null)return{};var target=auto_scale_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function auto_scale_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function auto_scale_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class auto_scale_AutoScale extends external_kbnSharedDeps_React_default.a.Component{constructor(props){super(props);auto_scale_defineProperty(this,"child",null);auto_scale_defineProperty(this,"parent",null);auto_scale_defineProperty(this,"scale",void 0);auto_scale_defineProperty(this,"setParent",el=>{if(el&&this.parent!==el){this.parent=el;setTimeout(()=>this.scale())}});auto_scale_defineProperty(this,"setChild",el=>{if(el&&this.child!==el){this.child=el;setTimeout(()=>this.scale())}});this.scale=external_kbnSharedDeps_Lodash_default.a.throttle(()=>{const scale=computeScale(this.parent,this.child,this.props.minScale);if(this.state.scale!==scale){this.setState({scale:scale})}});this.state={scale:0}}render(){const _this$props=this.props,children=_this$props.children,minScale=_this$props.minScale,rest=auto_scale_objectWithoutProperties(_this$props,["children","minScale"]);const scale=this.state.scale;const style=this.props.style||{};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiResizeObserver"],{onResize:this.scale},resizeRef=>external_kbnSharedDeps_React_default.a.createElement("div",auto_scale_extends({},rest,{ref:el=>{this.setParent(el);resizeRef(el)},style:auto_scale_objectSpread(auto_scale_objectSpread({},style),{},{display:"flex",justifyContent:"center",alignItems:"center",maxWidth:"100%",maxHeight:"100%",overflow:"hidden",lineHeight:1.5})}),external_kbnSharedDeps_React_default.a.createElement("div",{ref:this.setChild,style:{transform:"scale(".concat(scale,")")}},children)))}}const MAX_SCALE=1;const MIN_SCALE=.3;function computeScale(parent,child,minScale=MIN_SCALE){if(!parent||!child){return 1}const scaleX=parent.clientWidth/child.clientWidth;const scaleY=parent.clientHeight/child.clientHeight;return Math.max(Math.min(MAX_SCALE,Math.min(scaleX,scaleY)),minScale)}function chart_metric_extends(){chart_metric_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_metric_extends.apply(this,arguments)}function chart_metric_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_metric_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_metric_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartMetric=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_metric_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_metric_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M25 0a1 1 0 011 1v14a1 1 0 01-1 1H5a1 1 0 01-1-1V1a1 1 0 011-1h20zm-9.878 3c-1.887 0-3.265 1.107-3.26 2.61-.005 1.054.67 1.938 1.672 2.157v.067l-.155.03a2.453 2.453 0 00-1.879 2.394C11.495 11.84 12.997 13 15.122 13c2.105 0 3.612-1.16 3.617-2.742-.005-1.217-.903-2.234-2.035-2.424v-.067l.162-.042c.896-.275 1.507-1.12 1.511-2.116C18.373 4.112 16.994 3 15.122 3zm0 5.542c1.036 0 1.796.665 1.806 1.592-.01.898-.718 1.507-1.806 1.507-1.103 0-1.816-.609-1.806-1.507-.01-.932.755-1.592 1.806-1.592zm0-4.164c.908 0 1.53.561 1.54 1.398-.01.85-.651 1.43-1.54 1.43-.903 0-1.55-.584-1.54-1.43-.01-.837.618-1.398 1.54-1.398z",className:"lensChartIcon__accent"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M1 18h28a1 1 0 011 1v2a1 1 0 01-1 1H1a1 1 0 01-1-1v-2a1 1 0 011-1z",className:"lensChartIcon__subdued"}))};function metric_visualization_expression_extends(){metric_visualization_expression_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return metric_visualization_expression_extends.apply(this,arguments)}function expression_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function expression_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){expression_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){expression_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const metricChart={name:"lens_metric_chart",type:"render",help:"A metric chart",args:{title:{types:["string"],help:"The chart title."},description:{types:["string"],help:""},metricTitle:{types:["string"],help:"The title of the metric shown."},accessor:{types:["string"],help:"The column whose value is being displayed"},mode:{types:["string"],options:["reduced","full"],default:"full",help:"The display mode of the chart - reduced will only show the metric itself without min size"}},inputTypes:["lens_multitable"],fn(data,args){return{type:"render",as:"lens_metric_chart_renderer",value:{data:data,args:args}}}};const getMetricChartRenderer=formatFactory=>({name:"lens_metric_chart_renderer",displayName:"Metric chart",help:"Metric chart renderer",validate:()=>undefined,reuseDomNode:true,render:function(){var _render=expression_asyncToGenerator(regeneratorRuntime.mark((function _callee(domNode,config,handlers){var resolvedFormatFactory;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return formatFactory;case 2:resolvedFormatFactory=_context.sent;external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(MetricChart,metric_visualization_expression_extends({},config,{formatFactory:resolvedFormatFactory}))),domNode,()=>{handlers.done()});handlers.onDestroy(()=>external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(domNode));case 5:case"end":return _context.stop()}}),_callee)})));function render(_x,_x2,_x3){return _render.apply(this,arguments)}return render}()});function MetricChart({data:data,args:args,formatFactory:formatFactory}){var _column$meta,_column$meta2;const metricTitle=args.metricTitle,title=args.title,description=args.description,accessor=args.accessor,mode=args.mode;const firstTable=Object.values(data.tables)[0];if(!accessor){return external_kbnSharedDeps_React_default.a.createElement(VisualizationContainer,{reportTitle:title,reportDescription:description,className:"lnsMetricExpression__container"})}if(!firstTable){return external_kbnSharedDeps_React_default.a.createElement(EmptyPlaceholder,{icon:LensIconChartMetric})}const column=firstTable.columns[0];const row=firstTable.rows[0];const shouldShowResults=row[accessor]!=null;if(!shouldShowResults){return external_kbnSharedDeps_React_default.a.createElement(EmptyPlaceholder,{icon:LensIconChartMetric})}const value=column&&((_column$meta=column.meta)===null||_column$meta===void 0?void 0:_column$meta.params)?formatFactory((_column$meta2=column.meta)===null||_column$meta2===void 0?void 0:_column$meta2.params).convert(row[accessor]):Number(Number(row[accessor]).toFixed(3)).toString();return external_kbnSharedDeps_React_default.a.createElement(VisualizationContainer,{reportTitle:title,reportDescription:description,className:"lnsMetricExpression__container"},external_kbnSharedDeps_React_default.a.createElement(auto_scale_AutoScale,null,external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"lns_metric_value",style:{fontSize:"60pt",fontWeight:600}},value),mode==="full"&&external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"lns_metric_title",style:{fontSize:"24pt"}},metricTitle)))}function getSuggestions({table:table,state:state,keptLayerIds:keptLayerIds}){if(table.isMultiRow||keptLayerIds.length>1||keptLayerIds.length&&table.layerId!==keptLayerIds[0]||table.columns.length!==1||table.columns[0].operation.dataType!=="number"){return[]}if(state&&table.changeType==="unchanged"){return[]}return[getSuggestion(table)]}function getSuggestion(table){const col=table.columns[0];const title=table.label||col.operation.label;return{title:title,score:.1,previewIcon:LensIconChartMetric,state:{layerId:table.layerId,accessor:col.columnId}}}function metric_visualization_visualization_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function metric_visualization_visualization_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){metric_visualization_visualization_ownKeys(Object(source),true).forEach((function(key){metric_visualization_visualization_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{metric_visualization_visualization_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function metric_visualization_visualization_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function visualization_slicedToArray(arr,i){return visualization_arrayWithHoles(arr)||visualization_iterableToArrayLimit(arr,i)||visualization_unsupportedIterableToArray(arr,i)||visualization_nonIterableRest()}function visualization_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function visualization_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return visualization_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return visualization_arrayLikeToArray(o,minLen)}function visualization_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function visualization_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function visualization_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const toExpression=(state,datasourceLayers,attributes)=>{if(!state.accessor){return null}const _Object$values=Object.values(datasourceLayers),_Object$values2=visualization_slicedToArray(_Object$values,1),datasource=_Object$values2[0];const operation=datasource&&datasource.getOperationForColumnId(state.accessor);return{type:"expression",chain:[{type:"function",function:"lens_metric_chart",arguments:{title:[(attributes===null||attributes===void 0?void 0:attributes.title)||""],description:[(attributes===null||attributes===void 0?void 0:attributes.description)||""],metricTitle:[operation&&operation.label||""],accessor:[state.accessor],mode:[(attributes===null||attributes===void 0?void 0:attributes.mode)||"full"]}}]}};const metricVisualization={id:"lnsMetric",visualizationTypes:[{id:"lnsMetric",icon:LensIconChartMetric,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.metric.label",{defaultMessage:"Metric"})}],getVisualizationTypeId(){return"lnsMetric"},clearLayer(state){return metric_visualization_visualization_objectSpread(metric_visualization_visualization_objectSpread({},state),{},{accessor:undefined})},getLayerIds(state){return[state.layerId]},getDescription(){return{icon:LensIconChartMetric,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.metric.label",{defaultMessage:"Metric"})}},getSuggestions:getSuggestions,initialize(frame,state){return state||{layerId:frame.addNewLayer(),accessor:undefined}},getConfiguration(props){return{groups:[{groupId:"metric",groupLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.metric.label",{defaultMessage:"Metric"}),layerId:props.state.layerId,accessors:props.state.accessor?[{columnId:props.state.accessor}]:[],supportsMoreColumns:!props.state.accessor,filterOperations:op=>!op.isBucketed&&op.dataType==="number"}]}},toExpression:toExpression,toPreviewExpression:(state,datasourceLayers)=>toExpression(state,datasourceLayers,{mode:"reduced"}),setDimension({prevState:prevState,columnId:columnId}){return metric_visualization_visualization_objectSpread(metric_visualization_visualization_objectSpread({},prevState),{},{accessor:columnId})},removeDimension({prevState:prevState}){return metric_visualization_visualization_objectSpread(metric_visualization_visualization_objectSpread({},prevState),{},{accessor:undefined})},getErrorMessages(state,frame){return undefined}};function chart_donut_extends(){chart_donut_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_donut_extends.apply(this,arguments)}function chart_donut_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_donut_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_donut_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartDonut=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_donut_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_donut_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M19.21 21.119a11 11 0 006.595-8.1c.11-.577-.355-1.082-.942-1.082H20.75c-.477 0-.878.342-1.046.788a5.028 5.028 0 11-6.474-6.474c.447-.168.788-.569.788-1.046V1.094c0-.588-.505-1.053-1.082-.943a11 11 0 106.272 20.968h.002z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M22.778 3.176A11 11 0 0017.084.154C16.507.042 16 .507 16 1.095v4.116c0 .475.34.875.784 1.044l.14.055A5.026 5.026 0 0119.7 9.17c.168.445.568.784 1.044.784h4.115c.588 0 1.053-.506.942-1.084a11 11 0 00-3.023-5.694z",className:"lensChartIcon__accent"}))};function chart_pie_extends(){chart_pie_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_pie_extends.apply(this,arguments)}function chart_pie_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_pie_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_pie_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartPie=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_pie_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_pie_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M17.827 21.189a10.001 10.001 0 005.952-7.148c.124-.578-.343-1.091-.935-1.091H14a1 1 0 01-1-1V3.106c0-.592-.513-1.059-1.092-.935a10 10 0 105.919 19.018z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M22.462 3.538A12.29 12.29 0 0016.094.16C15.512.048 15 .514 15 1.106V10a1 1 0 001 1h8.895c.591 0 1.057-.512.945-1.094a12.288 12.288 0 00-3.378-6.368z",className:"lensChartIcon__accent"}))};function chart_treemap_extends(){chart_treemap_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_treemap_extends.apply(this,arguments)}function chart_treemap_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_treemap_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_treemap_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartTreemap=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_treemap_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_treemap_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M0 1a1 1 0 011-1h13a1 1 0 011 1v20a1 1 0 01-1 1H1a1 1 0 01-1-1V1z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M17 1a1 1 0 011-1h11a1 1 0 011 1v12a1 1 0 01-1 1H18a1 1 0 01-1-1V1z",className:"lensChartIcon__accent"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M29 16H18a1 1 0 00-1 1v4a1 1 0 001 1h11a1 1 0 001-1v-4a1 1 0 00-1-1z",className:"lensChartIcon__subdued"}))};const CHART_NAMES={donut:{icon:LensIconChartDonut,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.donutLabel",{defaultMessage:"Donut"})},pie:{icon:LensIconChartPie,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.pielabel",{defaultMessage:"Pie"})},treemap:{icon:LensIconChartTreemap,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.treemaplabel",{defaultMessage:"Treemap"})}};const MAX_PIE_BUCKETS=3;const MAX_TREEMAP_BUCKETS=2;const DEFAULT_PERCENT_DECIMALS=2;function getSliceValue(d,metricColumn){if(typeof d[metricColumn.id]==="number"&&d[metricColumn.id]!==0){return d[metricColumn.id]}return Number.EPSILON}function getFilterContext(clickedLayers,layerColumnIds,table){const matchingIndex=table.rows.findIndex(row=>clickedLayers.every((layer,index)=>{const columnId=layerColumnIds[index];return row[columnId]===layer.groupByRollup}));return{data:clickedLayers.map((clickedLayer,index)=>({column:table.columns.findIndex(col=>col.id===layerColumnIds[index]),row:matchingIndex,value:clickedLayer.groupByRollup,table:table}))}}var pie_visualization_visualization=__webpack_require__(80);function render_function_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function render_function_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){render_function_ownKeys(Object(source),true).forEach((function(key){render_function_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{render_function_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function render_function_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function render_function_slicedToArray(arr,i){return render_function_arrayWithHoles(arr)||render_function_iterableToArrayLimit(arr,i)||render_function_unsupportedIterableToArray(arr,i)||render_function_nonIterableRest()}function render_function_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function render_function_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return render_function_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return render_function_arrayLikeToArray(o,minLen)}function render_function_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function render_function_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function render_function_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const EMPTY_SLICE=Symbol("empty_slice");function PieComponent(props){var _chartTheme$barSeries,_chartTheme$barSeries2,_chartTheme$axes,_chartTheme$axes$axis,_chartTheme$lineSerie,_chartTheme$lineSerie2;const _Object$values=Object.values(props.data.tables),_Object$values2=render_function_slicedToArray(_Object$values,1),firstTable=_Object$values2[0];const formatters={};const chartsThemeService=props.chartsThemeService,paletteService=props.paletteService,onClickValue=props.onClickValue;const _props$args=props.args,shape=_props$args.shape,groups=_props$args.groups,metric=_props$args.metric,numberDisplay=_props$args.numberDisplay,categoryDisplay=_props$args.categoryDisplay,legendDisplay=_props$args.legendDisplay,legendPosition=_props$args.legendPosition,nestedLegend=_props$args.nestedLegend,percentDecimals=_props$args.percentDecimals,hideLabels=_props$args.hideLabels,palette=_props$args.palette;const chartTheme=chartsThemeService.useChartsTheme();const chartBaseTheme=chartsThemeService.useChartsBaseTheme();const isDarkMode=chartsThemeService.useDarkMode();if(!hideLabels){firstTable.columns.forEach(column=>{formatters[column.id]=props.formatFactory(column.meta.params)})}const fillLabel={textInvertible:true,valueFont:{fontWeight:700}};if(numberDisplay==="hidden"){fillLabel.valueFormatter=()=>""}const bucketColumns=firstTable.columns.filter(col=>groups.includes(col.id));const totalSeriesCount=Object(external_kbnSharedDeps_Lodash_["uniq"])(firstTable.rows.map(row=>bucketColumns.map(({id:columnId})=>row[columnId]).join(","))).length;const layers=bucketColumns.map((col,layerIndex)=>({groupByRollup:d=>{var _d$col$id;return(_d$col$id=d[col.id])!==null&&_d$col$id!==void 0?_d$col$id:EMPTY_SLICE},showAccessor:d=>d!==EMPTY_SLICE,nodeLabel:d=>{if(hideLabels||d===EMPTY_SLICE){return""}if(col.meta.params){var _formatters$col$id$co;return(_formatters$col$id$co=formatters[col.id].convert(d))!==null&&_formatters$col$id$co!==void 0?_formatters$col$id$co:""}return String(d)},fillLabel:fillLabel,shape:{fillColor:d=>{const seriesLayers=[];let tempParent=d;while(tempParent.parent&&tempParent.depth>0){seriesLayers.unshift({name:String(tempParent.parent.children[tempParent.sortIndex][0]),rankAtDepth:tempParent.sortIndex,totalSeriesAtDepth:tempParent.parent.children.length});tempParent=tempParent.parent}if(shape==="treemap"){if(layerIndex<bucketColumns.length-1){return isDarkMode?"rgba(0,0,0,0)":"rgba(255,255,255,0)"}if(seriesLayers.length>1){seriesLayers.pop()}}const outputColor=paletteService.get(palette.name).getColor(seriesLayers,{behindText:categoryDisplay!=="hide",maxDepth:bucketColumns.length,totalSeries:totalSeriesCount},palette.params);return outputColor||"rgba(0,0,0,0)"}}}));const config={partitionLayout:shape==="treemap"?external_kbnSharedDeps_ElasticCharts_["PartitionLayout"].treemap:external_kbnSharedDeps_ElasticCharts_["PartitionLayout"].sunburst,fontFamily:(_chartTheme$barSeries=chartTheme.barSeriesStyle)===null||_chartTheme$barSeries===void 0?void 0:(_chartTheme$barSeries2=_chartTheme$barSeries.displayValue)===null||_chartTheme$barSeries2===void 0?void 0:_chartTheme$barSeries2.fontFamily,outerSizeRatio:1,specialFirstInnermostSector:true,clockwiseSectors:false,minFontSize:10,maxFontSize:16,linkLabel:{maxCount:5,fontSize:11,textColor:(_chartTheme$axes=chartTheme.axes)===null||_chartTheme$axes===void 0?void 0:(_chartTheme$axes$axis=_chartTheme$axes.axisTitle)===null||_chartTheme$axes$axis===void 0?void 0:_chartTheme$axes$axis.fill},sectorLineStroke:(_chartTheme$lineSerie=chartTheme.lineSeriesStyle)===null||_chartTheme$lineSerie===void 0?void 0:(_chartTheme$lineSerie2=_chartTheme$lineSerie.point)===null||_chartTheme$lineSerie2===void 0?void 0:_chartTheme$lineSerie2.fill,sectorLineWidth:1.5,circlePadding:4};if(shape==="treemap"){if(hideLabels||categoryDisplay==="hide"){config.fillLabel={textColor:"rgba(0,0,0,0)"}}}else{config.emptySizeRatio=shape==="donut"?.3:0;if(hideLabels||categoryDisplay==="hide"){config.linkLabel={maxCount:0,maximumSection:Number.POSITIVE_INFINITY}}else if(categoryDisplay==="inside"){config.linkLabel={maxCount:0}}}const metricColumn=firstTable.columns.find(c=>c.id===metric);const _percentFormatter=props.formatFactory({id:"percent",params:{pattern:"0,0.[".concat("0".repeat(percentDecimals!==null&&percentDecimals!==void 0?percentDecimals:DEFAULT_PERCENT_DECIMALS),"]%")}});const _useState=Object(external_kbnSharedDeps_React_["useState"])({isReady:false}),_useState2=render_function_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setState({isReady:true})},[]);const hasNegative=firstTable.rows.some(row=>{const value=row[metricColumn.id];return typeof value==="number"&&value<0});const isEmpty=firstTable.rows.length===0||firstTable.rows.every(row=>groups.every(colId=>!row[colId]||typeof row[colId]==="undefined"));if(isEmpty){return external_kbnSharedDeps_React_default.a.createElement(EmptyPlaceholder,{icon:LensIconChartDonut})}if(hasNegative){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{className:"lnsChart__empty",textAlign:"center",color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.pie.pieWithNegativeWarningLabel",defaultMessage:"{chartType} charts can't render with negative values. Try a different chart type.",values:{chartType:CHART_NAMES[shape].label}}))}const onElementClickHandler=args=>{const context=getFilterContext(args[0][0],groups,firstTable);onClickValue(desanitizeFilterContext(context))};return external_kbnSharedDeps_React_default.a.createElement(VisualizationContainer,{reportTitle:props.args.title,reportDescription:props.args.description,className:"lnsPieExpression__container",isReady:state.isReady},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],{showLegend:!hideLabels&&(legendDisplay==="show"||legendDisplay==="default"&&bucketColumns.length>1&&shape!=="treemap"),legendPosition:legendPosition||external_kbnSharedDeps_ElasticCharts_["Position"].Right,legendMaxDepth:nestedLegend?undefined:1,onElementClick:props.renderMode!=="noInteractivity"?onElementClickHandler:undefined,theme:render_function_objectSpread(render_function_objectSpread({},chartTheme),{},{background:render_function_objectSpread(render_function_objectSpread({},chartTheme.background),{},{color:undefined})}),baseTheme:chartBaseTheme}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Partition"],{id:shape,data:firstTable.rows,valueAccessor:d=>getSliceValue(d,metricColumn),percentFormatter:d=>_percentFormatter.convert(d/100),valueGetter:hideLabels||numberDisplay==="value"?undefined:"percent",valueFormatter:d=>hideLabels?"":formatters[metricColumn.id].convert(d),layers:layers,config:config,topGroove:hideLabels||categoryDisplay==="hide"?0:undefined})))}function pie_visualization_expression_extends(){pie_visualization_expression_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return pie_visualization_expression_extends.apply(this,arguments)}function pie_visualization_expression_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function pie_visualization_expression_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){pie_visualization_expression_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){pie_visualization_expression_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const pie={name:"lens_pie",type:"render",help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.expressionHelpLabel",{defaultMessage:"Pie renderer"}),args:{title:{types:["string"],help:"The chart title."},description:{types:["string"],help:""},groups:{types:["string"],multi:true,help:""},metric:{types:["string"],help:""},shape:{types:["string"],options:["pie","donut","treemap"],help:""},hideLabels:{types:["boolean"],help:""},numberDisplay:{types:["string"],options:["hidden","percent","value"],help:""},categoryDisplay:{types:["string"],options:["default","inside","hide"],help:""},legendDisplay:{types:["string"],options:["default","show","hide"],help:""},nestedLegend:{types:["boolean"],help:""},legendPosition:{types:["string"],options:[external_kbnSharedDeps_ElasticCharts_["Position"].Top,external_kbnSharedDeps_ElasticCharts_["Position"].Right,external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,external_kbnSharedDeps_ElasticCharts_["Position"].Left],help:""},percentDecimals:{types:["number"],help:""},palette:{default:'{theme "palette" default={system_palette name="default"} }',help:"",types:["palette"]}},inputTypes:["lens_multitable"],fn(data,args){return{type:"render",as:"lens_pie_renderer",value:{data:data,args:args}}}};const getPieRenderer=dependencies=>({name:"lens_pie_renderer",displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.visualizationName",{defaultMessage:"Pie"}),help:"",validate:()=>undefined,reuseDomNode:true,render:function(){var _render=pie_visualization_expression_asyncToGenerator(regeneratorRuntime.mark((function _callee(domNode,config,handlers){var onClickValue,formatFactory;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:onClickValue=data=>{handlers.event({name:"filter",data:data})};_context.next=3;return dependencies.formatFactory;case 3:formatFactory=_context.sent;external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(MemoizedChart,pie_visualization_expression_extends({},config,{formatFactory:formatFactory,chartsThemeService:dependencies.chartsThemeService,paletteService:dependencies.paletteService,onClickValue:onClickValue,renderMode:handlers.getRenderMode()}))),domNode,()=>{handlers.done()});handlers.onDestroy(()=>external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(domNode));case 6:case"end":return _context.stop()}}),_callee)})));function render(_x,_x2,_x3){return _render.apply(this,arguments)}return render}()});const MemoizedChart=external_kbnSharedDeps_React_default.a.memo(PieComponent);function to_expression_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function to_expression_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){to_expression_ownKeys(Object(source),true).forEach((function(key){to_expression_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{to_expression_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function to_expression_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function to_expression_toExpression(state,datasourceLayers,paletteService,attributes={}){return expressionHelper(state,datasourceLayers,paletteService,to_expression_objectSpread(to_expression_objectSpread({},attributes),{},{isPreview:false}))}function expressionHelper(state,datasourceLayers,paletteService,attributes={isPreview:false}){var _layer$percentDecimal;const layer=state.layers[0];const datasource=datasourceLayers[layer.layerId];const operations=layer.groups.map(columnId=>({columnId:columnId,operation:datasource.getOperationForColumnId(columnId)})).filter(o=>!!o.operation);if(!layer.metric||!operations.length){return null}return{type:"expression",chain:[{type:"function",function:"lens_pie",arguments:to_expression_objectSpread({title:[attributes.title||""],description:[attributes.description||""],shape:[state.shape],hideLabels:[attributes.isPreview],groups:operations.map(o=>o.columnId),metric:[layer.metric],numberDisplay:[layer.numberDisplay],categoryDisplay:[layer.categoryDisplay],legendDisplay:[layer.legendDisplay],legendPosition:[layer.legendPosition||"right"],percentDecimals:[(_layer$percentDecimal=layer.percentDecimals)!==null&&_layer$percentDecimal!==void 0?_layer$percentDecimal:DEFAULT_PERCENT_DECIMALS],nestedLegend:[!!layer.nestedLegend]},state.palette?{palette:[{type:"expression",chain:[{type:"function",function:"theme",arguments:{variable:["palette"],default:[paletteService.get(state.palette.name).toExpression(state.palette.params)]}}]}]}:{})}]}}function toPreviewExpression(state,datasourceLayers,paletteService){return expressionHelper(state,datasourceLayers,paletteService,{isPreview:true})}function suggestions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function suggestions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){suggestions_ownKeys(Object(source),true).forEach((function(key){suggestions_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{suggestions_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function suggestions_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function suggestions_slicedToArray(arr,i){return suggestions_arrayWithHoles(arr)||suggestions_iterableToArrayLimit(arr,i)||suggestions_unsupportedIterableToArray(arr,i)||suggestions_nonIterableRest()}function suggestions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function suggestions_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return suggestions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return suggestions_arrayLikeToArray(o,minLen)}function suggestions_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function suggestions_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function suggestions_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function shouldReject({table:table,keptLayerIds:keptLayerIds}){return keptLayerIds.length>1||keptLayerIds.length&&table.layerId!==keptLayerIds[0]||table.changeType==="reorder"||table.columns.some(col=>col.operation.scale==="interval")}function suggestions_suggestions({table:table,state:state,keptLayerIds:keptLayerIds,mainPalette:mainPalette,subVisualizationId:subVisualizationId}){if(shouldReject({table:table,state:state,keptLayerIds:keptLayerIds})){return[]}const _partition=Object(external_kbnSharedDeps_Lodash_["partition"])(table.columns,col=>col.operation.isBucketed),_partition2=suggestions_slicedToArray(_partition,2),groups=_partition2[0],metrics=_partition2[1];if(metrics.length>1||groups.length>Math.max(MAX_PIE_BUCKETS,MAX_TREEMAP_BUCKETS)){return[]}const incompleteConfiguration=metrics.length===0||groups.length===0;const metricColumnId=metrics.length>0?metrics[0].columnId:undefined;if(incompleteConfiguration&&state&&!subVisualizationId){return[]}const results=[];if(groups.length<=MAX_PIE_BUCKETS){let newShape="donut";if(groups.length!==1){newShape="pie"}const baseSuggestion={title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.suggestionLabel",{defaultMessage:"As {chartName}",values:{chartName:CHART_NAMES[newShape].label},description:"chartName is already translated"}),score:state&&state.shape!=="treemap"?.6:.4,state:{shape:newShape,palette:mainPalette||(state===null||state===void 0?void 0:state.palette),layers:[(state===null||state===void 0?void 0:state.layers[0])?suggestions_objectSpread(suggestions_objectSpread({},state.layers[0]),{},{layerId:table.layerId,groups:groups.map(col=>col.columnId),metric:metricColumnId}):{layerId:table.layerId,groups:groups.map(col=>col.columnId),metric:metricColumnId,numberDisplay:"percent",categoryDisplay:"default",legendDisplay:"default",nestedLegend:false}]},previewIcon:"bullseye",hide:table.changeType==="reduced"||state&&state.shape!=="treemap"};results.push(baseSuggestion);results.push(suggestions_objectSpread(suggestions_objectSpread({},baseSuggestion),{},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.suggestionLabel",{defaultMessage:"As {chartName}",values:{chartName:CHART_NAMES[newShape==="pie"?"donut":"pie"].label},description:"chartName is already translated"}),score:.1,state:suggestions_objectSpread(suggestions_objectSpread({},baseSuggestion.state),{},{shape:newShape==="pie"?"donut":"pie"}),hide:true}))}if(groups.length<=MAX_TREEMAP_BUCKETS){results.push({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.treemapSuggestionLabel",{defaultMessage:"As Treemap"}),score:(state===null||state===void 0?void 0:state.shape)==="treemap"?.7:.5,state:{shape:"treemap",palette:mainPalette||(state===null||state===void 0?void 0:state.palette),layers:[(state===null||state===void 0?void 0:state.layers[0])?suggestions_objectSpread(suggestions_objectSpread({},state.layers[0]),{},{layerId:table.layerId,groups:groups.map(col=>col.columnId),metric:metricColumnId,categoryDisplay:state.layers[0].categoryDisplay==="inside"?"default":state.layers[0].categoryDisplay}):{layerId:table.layerId,groups:groups.map(col=>col.columnId),metric:metricColumnId,numberDisplay:"percent",categoryDisplay:"default",legendDisplay:"default",nestedLegend:false}]},previewIcon:"bullseye",hide:table.changeType==="reduced"||!state||state&&state.shape==="treemap"})}return[...results].sort((a,b)=>a.score-b.score).map(suggestion=>suggestions_objectSpread(suggestions_objectSpread({},suggestion),{},{hide:incompleteConfiguration||suggestion.hide}))}var toolbar=__webpack_require__(89);var useDebounce=__webpack_require__(36);var useDebounce_default=__webpack_require__.n(useDebounce);function toolbar_slicedToArray(arr,i){return toolbar_arrayWithHoles(arr)||toolbar_iterableToArrayLimit(arr,i)||toolbar_unsupportedIterableToArray(arr,i)||toolbar_nonIterableRest()}function toolbar_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function toolbar_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return toolbar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return toolbar_arrayLikeToArray(o,minLen)}function toolbar_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function toolbar_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function toolbar_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function toolbar_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function toolbar_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){toolbar_ownKeys(Object(source),true).forEach((function(key){toolbar_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{toolbar_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function toolbar_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const numberOptions=[{value:"hidden",inputDisplay:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.hiddenNumbersLabel",{defaultMessage:"Hide from chart"})},{value:"percent",inputDisplay:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.showPercentValuesLabel",{defaultMessage:"Show percent"})},{value:"value",inputDisplay:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.showFormatterValuesLabel",{defaultMessage:"Show value"})}];const categoryOptions=[{value:"default",inputDisplay:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.showCategoriesLabel",{defaultMessage:"Inside or outside"})},{value:"inside",inputDisplay:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.fitInsideOnlyLabel",{defaultMessage:"Inside only"})},{value:"hide",inputDisplay:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.categoriesInLegendLabel",{defaultMessage:"Hide labels"})}];const categoryOptionsTreemap=[{value:"default",inputDisplay:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.showTreemapCategoriesLabel",{defaultMessage:"Show labels"})},{value:"hide",inputDisplay:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.categoriesInLegendLabel",{defaultMessage:"Hide labels"})}];const toolbar_legendOptions=[{id:"pieLegendDisplay-default",value:"default",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.legendVisibility.auto",{defaultMessage:"Auto"})},{id:"pieLegendDisplay-show",value:"show",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.legendVisibility.show",{defaultMessage:"Show"})},{id:"pieLegendDisplay-hide",value:"hide",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.legendVisibility.hide",{defaultMessage:"Hide"})}];function PieToolbar(props){var _layer$percentDecimal;const state=props.state,setState=props.setState;const layer=state.layers[0];if(!layer){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(ToolbarPopover,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.valuesLabel",{defaultMessage:"Labels"}),type:"labels",groupPosition:"left",buttonDataTestSubj:"lnsLabelsButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.labelPositionLabel",{defaultMessage:"Position"}),fullWidth:true,display:"columnCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{compressed:true,valueOfSelected:layer.categoryDisplay,options:state.shape==="treemap"?categoryOptionsTreemap:categoryOptions,onChange:option=>{setState(toolbar_objectSpread(toolbar_objectSpread({},state),{},{layers:[toolbar_objectSpread(toolbar_objectSpread({},layer),{},{categoryDisplay:option})]}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.numberLabels",{defaultMessage:"Values"}),fullWidth:true,display:"columnCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{compressed:true,disabled:layer.categoryDisplay==="hide",valueOfSelected:layer.categoryDisplay==="hide"?"hidden":layer.numberDisplay,options:numberOptions,onChange:option=>{setState(toolbar_objectSpread(toolbar_objectSpread({},state),{},{layers:[toolbar_objectSpread(toolbar_objectSpread({},layer),{},{numberDisplay:option})]}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pieChart.percentDecimalsLabel",{defaultMessage:"Maximum decimal places for percent"}),fullWidth:true,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(DecimalPlaceSlider,{value:(_layer$percentDecimal=layer.percentDecimals)!==null&&_layer$percentDecimal!==void 0?_layer$percentDecimal:DEFAULT_PERCENT_DECIMALS,setValue:value=>setState(toolbar_objectSpread(toolbar_objectSpread({},state),{},{layers:[toolbar_objectSpread(toolbar_objectSpread({},layer),{},{percentDecimals:value})]}))}))),external_kbnSharedDeps_React_default.a.createElement(LegendSettingsPopover,{legendOptions:toolbar_legendOptions,mode:layer.legendDisplay,onDisplayChange:optionId=>{setState(toolbar_objectSpread(toolbar_objectSpread({},state),{},{layers:[toolbar_objectSpread(toolbar_objectSpread({},layer),{},{legendDisplay:toolbar_legendOptions.find(({id:id})=>id===optionId).value})]}))},position:layer.legendPosition,onPositionChange:id=>{setState(toolbar_objectSpread(toolbar_objectSpread({},state),{},{layers:[toolbar_objectSpread(toolbar_objectSpread({},layer),{},{legendPosition:id})]}))},renderNestedLegendSwitch:true,nestedLegend:!!layer.nestedLegend,onNestedLegendChange:()=>{setState(toolbar_objectSpread(toolbar_objectSpread({},state),{},{layers:[toolbar_objectSpread(toolbar_objectSpread({},layer),{},{nestedLegend:!layer.nestedLegend})]}))}}))}const DecimalPlaceSlider=({value:value,setValue:setValue})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(value),_useState2=toolbar_slicedToArray(_useState,2),localValue=_useState2[0],setLocalValue=_useState2[1];useDebounce_default()(()=>setValue(localValue),256,[localValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRange"],{"data-test-subj":"indexPattern-dimension-formatDecimals",value:localValue,min:0,max:10,showInput:true,compressed:true,onChange:e=>{setLocalValue(Number(e.currentTarget.value))}})};function DimensionEditor(props){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(PalettePicker,{palettes:props.frame.availablePalettes,activePalette:props.state.palette,setPalette:newPalette=>{props.setState(toolbar_objectSpread(toolbar_objectSpread({},props.state),{},{palette:newPalette}))}}))}function pie_visualization_visualization_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function pie_visualization_visualization_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){pie_visualization_visualization_ownKeys(Object(source),true).forEach((function(key){pie_visualization_visualization_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{pie_visualization_visualization_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function pie_visualization_visualization_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function visualization_newLayerState(layerId){return{layerId:layerId,groups:[],metric:undefined,numberDisplay:"percent",categoryDisplay:"default",legendDisplay:"default",nestedLegend:false}}const bucketedOperations=op=>op.isBucketed;const numberMetricOperations=op=>!op.isBucketed&&op.dataType==="number";const getPieVisualization=({paletteService:paletteService})=>({id:"lnsPie",visualizationTypes:[{id:"donut",icon:CHART_NAMES.donut.icon,label:CHART_NAMES.donut.label},{id:"pie",icon:CHART_NAMES.pie.icon,label:CHART_NAMES.pie.label},{id:"treemap",icon:CHART_NAMES.treemap.icon,label:CHART_NAMES.treemap.label}],getVisualizationTypeId(state){return state.shape},getLayerIds(state){return state.layers.map(l=>l.layerId)},clearLayer(state){return{shape:state.shape,layers:state.layers.map(l=>visualization_newLayerState(l.layerId))}},getDescription(state){if(state.shape==="treemap"){return CHART_NAMES.treemap}if(state.shape==="donut"){return CHART_NAMES.donut}return CHART_NAMES.pie},switchVisualizationType:(visualizationTypeId,state)=>pie_visualization_visualization_objectSpread(pie_visualization_visualization_objectSpread({},state),{},{shape:visualizationTypeId}),initialize(frame,state,mainPalette){return state||{shape:"donut",layers:[visualization_newLayerState(frame.addNewLayer())],palette:mainPalette}},getMainPalette:state=>state?state.palette:undefined,getSuggestions:suggestions_suggestions,getConfiguration({state:state,frame:frame,layerId:layerId}){const layer=state.layers.find(l=>l.layerId===layerId);if(!layer){return{groups:[]}}const datasource=frame.datasourceLayers[layer.layerId];const originalOrder=datasource.getTableSpec().map(({columnId:columnId})=>columnId).filter(columnId=>columnId!==layer.metric);const sortedColumns=Array.from(new Set(originalOrder.concat(layer.groups))).map(accessor=>({columnId:accessor}));if(sortedColumns.length>0){var _state$palette,_state$palette2;sortedColumns[0]={columnId:sortedColumns[0].columnId,triggerIcon:"colorBy",palette:paletteService.get(((_state$palette=state.palette)===null||_state$palette===void 0?void 0:_state$palette.name)||"default").getColors(10,(_state$palette2=state.palette)===null||_state$palette2===void 0?void 0:_state$palette2.params)}}if(state.shape==="treemap"){return{groups:[{groupId:"groups",groupLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.treemapGroupLabel",{defaultMessage:"Group by"}),layerId:layerId,accessors:sortedColumns,supportsMoreColumns:sortedColumns.length<MAX_TREEMAP_BUCKETS,filterOperations:bucketedOperations,required:true,dataTestSubj:"lnsPie_groupByDimensionPanel",enableDimensionEditor:true},{groupId:"metric",groupLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.groupsizeLabel",{defaultMessage:"Size by"}),layerId:layerId,accessors:layer.metric?[{columnId:layer.metric}]:[],supportsMoreColumns:!layer.metric,filterOperations:numberMetricOperations,required:true,dataTestSubj:"lnsPie_sizeByDimensionPanel"}]}}return{groups:[{groupId:"groups",groupLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.sliceGroupLabel",{defaultMessage:"Slice by"}),layerId:layerId,accessors:sortedColumns,supportsMoreColumns:sortedColumns.length<MAX_PIE_BUCKETS,filterOperations:bucketedOperations,required:true,dataTestSubj:"lnsPie_sliceByDimensionPanel",enableDimensionEditor:true},{groupId:"metric",groupLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pie.groupsizeLabel",{defaultMessage:"Size by"}),layerId:layerId,accessors:layer.metric?[{columnId:layer.metric}]:[],supportsMoreColumns:!layer.metric,filterOperations:numberMetricOperations,required:true,dataTestSubj:"lnsPie_sizeByDimensionPanel"}]}},setDimension({prevState:prevState,layerId:layerId,columnId:columnId,groupId:groupId}){return pie_visualization_visualization_objectSpread(pie_visualization_visualization_objectSpread({},prevState),{},{shape:prevState.shape==="donut"&&prevState.layers.every(l=>l.groups.length===1)?"pie":prevState.shape,layers:prevState.layers.map(l=>{if(l.layerId!==layerId){return l}if(groupId==="groups"){return pie_visualization_visualization_objectSpread(pie_visualization_visualization_objectSpread({},l),{},{groups:[...l.groups,columnId]})}return pie_visualization_visualization_objectSpread(pie_visualization_visualization_objectSpread({},l),{},{metric:columnId})})})},removeDimension({prevState:prevState,layerId:layerId,columnId:columnId}){return pie_visualization_visualization_objectSpread(pie_visualization_visualization_objectSpread({},prevState),{},{layers:prevState.layers.map(l=>{if(l.layerId!==layerId){return l}if(l.metric===columnId){return pie_visualization_visualization_objectSpread(pie_visualization_visualization_objectSpread({},l),{},{metric:undefined})}return pie_visualization_visualization_objectSpread(pie_visualization_visualization_objectSpread({},l),{},{groups:l.groups.filter(c=>c!==columnId)})})})},renderDimensionEditor(domElement,props){Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(DimensionEditor,props)),domElement)},toExpression:(state,layers,attributes)=>to_expression_toExpression(state,layers,paletteService,attributes),toPreviewExpression:(state,layers)=>toPreviewExpression(state,layers,paletteService),renderToolbar(domElement,props){Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(PieToolbar,props)),domElement)},getErrorMessages(state,frame){return undefined}});var xy_visualization_expression=__webpack_require__(99);function chart_area_extends(){chart_area_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_area_extends.apply(this,arguments)}function chart_area_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_area_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_area_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartArea=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_area_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_area_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M30 6v15a1 1 0 01-1 1H1a1 1 0 01-1-1v-2c1 0 3.5-4 6-4s5 3 6 3 3.23-6.994 5.865-6.997C20.5 11 23 11 24 11s3-5 6-5z",className:"lensChartIcon__accent"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M6 1c3 0 5 6 6 6s3.5-3 6-3c1.667 0 2.944 2.333 3.833 6.999l.309.001c-1.013 0-2.27 0-3.593.002h-.684C15.231 11.007 13 18 12 18s-3.5-3-6-3-5 4-6 4V7c1-1.5 3-6 6-6z",className:"lensChartIcon__subdued"}))};function chart_area_stacked_extends(){chart_area_stacked_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_area_stacked_extends.apply(this,arguments)}function chart_area_stacked_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_area_stacked_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_area_stacked_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartAreaStacked=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_area_stacked_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_area_stacked_extends({viewBox:"0 0 30 22",width:31,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M0 15.213l.484.091.813.146.762.129C3.779 15.859 5.09 16 6 16c.986 0 1.712-.25 3.166-.966l.281-.14C10.802 14.217 11.381 14 12 14c.507 0 .988.146 1.89.571l1.209.592c1.28.617 1.977.837 2.901.837 1.028 0 1.75-.349 3.119-1.344l.89-.659C23.034 13.252 23.535 13 24 13c.581 0 1.232.185 2.598.718l1.1.436.568.217c.72.27 1.256.438 1.736.532L30 21a1 1 0 01-1 1H1a1 1 0 01-1-1v-5.787z",className:"lensChartIcon__accent"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M24 1c1.334 0 3.334 1 6 3v8.842l-.324-.098c-.346-.11-.759-.262-1.273-.462l-1.101-.436-.568-.217-.536-.193C25.277 11.118 24.676 11 24 11c-1.028 0-1.75.349-3.119 1.344l-.89.659c-1.024.745-1.524.997-1.99.997-.508 0-.989-.146-1.89-.571l-1.21-.592c-1.28-.617-1.977-.837-2.9-.837-.987 0-1.713.25-3.167.966l-.281.14C7.198 13.783 6.619 14 6 14l-.334-.007c-1.182-.045-3.08-.317-5.665-.815V9c2 0 4.666 1 6 1 2 0 4-4 6-4s4 1 6 1 4-6 6-6z",className:"lensChartIcon__subdued"}))};function chart_area_percentage_extends(){chart_area_percentage_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_area_percentage_extends.apply(this,arguments)}function chart_area_percentage_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_area_percentage_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_area_percentage_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartAreaPercentage=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_area_percentage_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_area_percentage_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M0 13v8a1 1 0 001 1h28a1 1 0 001-1V9.25c-1.251-.929-2.45-1.734-3.493-2.313a11.028 11.028 0 00-1.478-.703C24.592 6.072 24.25 6 24 6c-.262 0-.63.212-1.126.77-.472.53-.952 1.249-1.458 2.007l-.013.02c-.49.736-1.006 1.51-1.53 2.098C19.37 11.462 18.739 12 18 12c-1.062 0-2.112-.263-3.092-.508l-.03-.007C13.869 11.232 12.929 11 12 11c-.337 0-.729.171-1.2.525-.466.35-.94.822-1.446 1.329l-.015.015c-.49.489-1.01 1.01-1.539 1.406-.529.396-1.137.725-1.8.725-.657 0-1.57-.212-2.48-.424l-.058-.014C2.275 14.287 1.032 14 0 14v-1z",className:"lensChartIcon__accent"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M29 0a1 1 0 011 1v6.012c-1.06-.764-2.085-1.437-3.007-1.95a11.93 11.93 0 00-1.616-.765C24.887 4.115 24.418 4 24 4c-.738 0-1.369.538-1.874 1.105-.523.589-1.039 1.362-1.529 2.098l-.013.02c-.506.758-.985 1.476-1.458 2.007-.495.558-.864.77-1.126.77-.928 0-1.867-.232-2.879-.485l-.029-.007C14.112 9.263 13.062 9 12 9c-.663 0-1.271.328-1.8.725-.528.396-1.05.917-1.538 1.406l-.015.015c-.507.507-.98.98-1.447 1.329-.471.354-.863.525-1.2.525-.528 0-1.328-.183-2.311-.412l-.034-.007C2.507 12.314 1.159 12 .001 12V1a1 1 0 011-1h28z",className:"lensChartIcon__subdued"}))};function chart_bar_extends(){chart_bar_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_bar_extends.apply(this,arguments)}function chart_bar_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_bar_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_bar_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartBar=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_bar_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_bar_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M5 7a1 1 0 011 1v13a1 1 0 01-1 1H1a1 1 0 01-1-1V8a1 1 0 011-1h4zm16-7a1 1 0 011 1v20a1 1 0 01-1 1h-4a1 1 0 01-1-1V1a1 1 0 011-1h4z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M13 11a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1v-9a1 1 0 011-1h4zm16-7a1 1 0 011 1v16a1 1 0 01-1 1h-4a1 1 0 01-1-1V5a1 1 0 011-1h4z",className:"lensChartIcon__accent"}))};function chart_bar_stacked_extends(){chart_bar_stacked_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_bar_stacked_extends.apply(this,arguments)}function chart_bar_stacked_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_bar_stacked_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_bar_stacked_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartBarStacked=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_bar_stacked_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_bar_stacked_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{className:"lensChartIcon__subdued",d:"M6 13v8a1 1 0 01-1 1H1a1 1 0 01-1-1v-8h6zm8-4v12a1 1 0 01-1 1H9a1 1 0 01-1-1V9h6zm8 4v8a1 1 0 01-1 1h-4a1 1 0 01-1-1v-8h6zm8 1v7a1 1 0 01-1 1h-4a1 1 0 01-1-1v-7h6z"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M29 1a1 1 0 011 1v10h-6V2a1 1 0 011-1h4zM5 7a1 1 0 011 1v3H0V8a1 1 0 011-1h4zm16-4a1 1 0 011 1v7h-6V4a1 1 0 011-1h4zm-8-3a1 1 0 011 1v6H8V1a1 1 0 011-1h4z",className:"lensChartIcon__accent"}))};function chart_bar_percentage_extends(){chart_bar_percentage_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_bar_percentage_extends.apply(this,arguments)}function chart_bar_percentage_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_bar_percentage_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_bar_percentage_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartBarPercentage=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_bar_percentage_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_bar_percentage_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M6 13v8a1 1 0 01-1 1H1a1 1 0 01-1-1v-8h6zm8-4v12a1 1 0 01-1 1H9a1 1 0 01-1-1V9h6zm8 4v8a1 1 0 01-1 1h-4a1 1 0 01-1-1v-8h6zm8 1v7a1 1 0 01-1 1h-4a1 1 0 01-1-1v-7h6z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M29 0a1 1 0 011 1v11h-6V1a1 1 0 011-1h4zM5 0a1 1 0 011 1v10H0V1a1 1 0 011-1h4zm16 0a1 1 0 011 1v10h-6V1a1 1 0 011-1h4zm-8 0a1 1 0 011 1v6H8V1a1 1 0 011-1h4z",className:"lensChartIcon__accent"}))};function chart_bar_horizontal_extends(){chart_bar_horizontal_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_bar_horizontal_extends.apply(this,arguments)}function chart_bar_horizontal_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_bar_horizontal_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_bar_horizontal_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartBarHorizontal=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_bar_horizontal_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_bar_horizontal_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M29 16a1 1 0 011 1v4a1 1 0 01-1 1H1a1 1 0 01-1-1v-4a1 1 0 011-1h28zM22 0a1 1 0 011 1v4a1 1 0 01-1 1H1a1 1 0 01-1-1V1a1 1 0 011-1h21z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M0 9a1 1 0 011-1h15a1 1 0 011 1v4a1 1 0 01-1 1H1a1 1 0 01-1-1V9z",className:"lensChartIcon__accent"}))};function chart_bar_horizontal_stacked_extends(){chart_bar_horizontal_stacked_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_bar_horizontal_stacked_extends.apply(this,arguments)}function chart_bar_horizontal_stacked_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_bar_horizontal_stacked_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_bar_horizontal_stacked_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartBarHorizontalStacked=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_bar_horizontal_stacked_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_bar_horizontal_stacked_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M18 16v6H1a1 1 0 01-1-1v-4a1 1 0 011-1h17zm-3-8v6H1.222C.547 14 0 13.552 0 13V9c0-.552.547-1 1.222-1H15zm1-8v6H1.042C.466 6 0 5.552 0 5V1c0-.552.466-1 1.042-1H16z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M29 16a1 1 0 011 1v4a1 1 0 01-1 1h-9v-6h9zm-9.222-8C20.453 8 21 8.448 21 9v4c0 .552-.547 1-1.222 1H17V8h2.778zm3.18-8C23.534 0 24 .448 24 1v4c0 .552-.466 1-1.042 1H18V0h4.958z",className:"lensChartIcon__accent"}))};function chart_bar_horizontal_percentage_extends(){chart_bar_horizontal_percentage_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_bar_horizontal_percentage_extends.apply(this,arguments)}function chart_bar_horizontal_percentage_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_bar_horizontal_percentage_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_bar_horizontal_percentage_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartBarHorizontalPercentage=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_bar_horizontal_percentage_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_bar_horizontal_percentage_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M20 16v6H1a1 1 0 01-1-1v-4a1 1 0 011-1h19zm-3-8v6H1.222C.547 14 0 13.552 0 13V9c0-.552.547-1 1.222-1H17zm1-8v6H1.042C.466 6 0 5.552 0 5V1c0-.552.466-1 1.042-1H18z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M29 16a1 1 0 011 1v4a1 1 0 01-1 1h-7v-6h7zm-.222-8C29.453 8 30 8.448 30 9v4c0 .552-.547 1-1.222 1H19V8h9.778zm.18-8C29.534 0 30 .448 30 1v4c0 .552-.466 1-1.042 1H20V0h8.958z",className:"lensChartIcon__accent"}))};function chart_line_extends(){chart_line_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_line_extends.apply(this,arguments)}function chart_line_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_line_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_line_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartLine=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_line_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_line_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M23.434 16.456c.211.553.406.982.58 1.277l.073.119c.038.058.072.105.101.141.52-.04 1.07-.248 2.13-.77l.235-.117C28.198 16.283 28.953 16 30 16v2c-.507 0-.988.146-1.89.571l-1.209.592C25.621 19.78 24.924 20 24 20l-.174-.005c-1.251-.076-1.805-1.036-2.994-4.993L22.93 15c.18.563.335 1.012.505 1.455zM6 1c1.269 0 1.966.69 3.492 2.939l.774 1.146.272.387.26.358C11.419 6.658 11.788 7 12 7c.466 0 .967-.252 1.99-.997l.891-.659.458-.325C16.424 4.272 17.093 4 18 4c1.377 0 1.925.863 3.168 4.999L19.07 9a26.766 26.766 0 00-.505-1.457c-.24-.631-.46-1.1-.652-1.395l-.051-.074-.045-.06c-.452.064-.988.375-2.007 1.13l-.691.512-.458.325C13.576 8.728 12.907 9 12 9c-1.269 0-1.966-.69-3.492-2.939l-.774-1.146-.272-.387-.26-.358C6.581 3.342 6.213 3 6 3c-.294 0-.885.651-2.017 2.33l-.491.731-.326.475C1.859 8.409 1.175 9 0 9V7c.294 0 .885-.651 2.017-2.33l.491-.731.326-.475C4.141 1.591 4.825 1 6 1z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M0 21c1.123 0 1.852-.477 3.295-1.885l.758-.75.345-.33C5.208 17.275 5.648 17 6 17c.466 0 .967.252 1.99.997l.891.659.458.325C10.424 19.728 11.093 20 12 20c1.325 0 1.996-.772 3.546-3.444l.593-1.028.385-.646C17.328 13.562 17.796 13 18 13h6c1.333 0 1.978-.795 3.452-3.676l.692-1.37.358-.69C29.333 5.7 29.831 5 30 5V3c-1.333 0-1.978.795-3.452 3.676l-.692 1.37-.358.69C24.667 10.3 24.169 11 24 11h-6c-1.325 0-1.996.772-3.546 3.444l-.593 1.028-.385.646C12.672 17.438 12.204 18 12 18c-.466 0-.967-.252-1.99-.997l-.891-.659-.458-.325C7.576 15.272 6.907 15 6 15c-1.123 0-1.852.477-3.295 1.885l-.758.75-.345.33C.792 18.725.352 19 0 19v2z",className:"lensChartIcon__accent"}))};function types_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function types_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){types_ownKeys(Object(source),true).forEach((function(key){types_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{types_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function types_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const legendConfig={name:"lens_xy_legendConfig",aliases:[],type:"lens_xy_legendConfig",help:"Configure the xy chart's legend",inputTypes:["null"],args:{isVisible:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.isVisible.help",{defaultMessage:"Specifies whether or not the legend is visible."})},position:{types:["string"],options:[external_kbnSharedDeps_ElasticCharts_["Position"].Top,external_kbnSharedDeps_ElasticCharts_["Position"].Right,external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,external_kbnSharedDeps_ElasticCharts_["Position"].Left],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.position.help",{defaultMessage:"Specifies the legend position."})},showSingleSeries:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.showSingleSeries.help",{defaultMessage:"Specifies whether a legend with just a single entry should be shown"})}},fn:function fn(input,args){return types_objectSpread({type:"lens_xy_legendConfig"},args)}};const tickLabelsConfig={name:"lens_xy_tickLabelsConfig",aliases:[],type:"lens_xy_tickLabelsConfig",help:"Configure the xy chart's tick labels appearance",inputTypes:["null"],args:{x:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.xAxisTickLabels.help",{defaultMessage:"Specifies whether or not the tick labels of the x-axis are visible."})},yLeft:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.yLeftAxisTickLabels.help",{defaultMessage:"Specifies whether or not the tick labels of the left y-axis are visible."})},yRight:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.yRightAxisTickLabels.help",{defaultMessage:"Specifies whether or not the tick labels of the right y-axis are visible."})}},fn:function fn(input,args){return types_objectSpread({type:"lens_xy_tickLabelsConfig"},args)}};const gridlinesConfig={name:"lens_xy_gridlinesConfig",aliases:[],type:"lens_xy_gridlinesConfig",help:"Configure the xy chart's gridlines appearance",inputTypes:["null"],args:{x:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.xAxisGridlines.help",{defaultMessage:"Specifies whether or not the gridlines of the x-axis are visible."})},yLeft:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.yLeftAxisgridlines.help",{defaultMessage:"Specifies whether or not the gridlines of the left y-axis are visible."})},yRight:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.yRightAxisgridlines.help",{defaultMessage:"Specifies whether or not the gridlines of the right y-axis are visible."})}},fn:function fn(input,args){return types_objectSpread({type:"lens_xy_gridlinesConfig"},args)}};const axisTitlesVisibilityConfig={name:"lens_xy_axisTitlesVisibilityConfig",aliases:[],type:"lens_xy_axisTitlesVisibilityConfig",help:"Configure the xy chart's axis titles appearance",inputTypes:["null"],args:{x:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.xAxisTitle.help",{defaultMessage:"Specifies whether or not the title of the x-axis are visible."})},yLeft:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.yLeftAxisTitle.help",{defaultMessage:"Specifies whether or not the title of the left y-axis are visible."})},yRight:{types:["boolean"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.yRightAxisTitle.help",{defaultMessage:"Specifies whether or not the title of the right y-axis are visible."})}},fn:function fn(input,args){return types_objectSpread({type:"lens_xy_axisTitlesVisibilityConfig"},args)}};const axisConfig={title:{types:["string"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.title.help",{defaultMessage:"The axis title"})},hide:{types:["boolean"],default:false,help:"Show / hide axis"}};const yAxisConfig={name:"lens_xy_yConfig",aliases:[],type:"lens_xy_yConfig",help:"Configure the behavior of a xy chart's y axis metric",inputTypes:["null"],args:{forAccessor:{types:["string"],help:"The accessor this configuration is for"},axisMode:{types:["string"],options:["auto","left","right"],help:"The axis mode of the metric"},color:{types:["string"],help:"The color of the series"}},fn:function fn(input,args){return types_objectSpread({type:"lens_xy_yConfig"},args)}};const layerConfig={name:"lens_xy_layer",aliases:[],type:"lens_xy_layer",help:"Configure a layer in the xy chart",inputTypes:["null"],args:types_objectSpread(types_objectSpread({},axisConfig),{},{layerId:{types:["string"],help:""},xAccessor:{types:["string"],help:""},seriesType:{types:["string"],options:["bar","line","area","bar_stacked","area_stacked","bar_percentage_stacked","area_percentage_stacked"],help:"The type of chart to display."},xScaleType:{options:["ordinal","linear","time"],help:"The scale type of the x axis",default:"ordinal"},isHistogram:{types:["boolean"],default:false,help:"Whether to layout the chart as a histogram"},yScaleType:{options:["log","sqrt","linear","time"],help:"The scale type of the y axes",default:"linear"},splitAccessor:{types:["string"],help:"The column to split by",multi:false},accessors:{types:["string"],help:"The columns to display on the y axis.",multi:true},yConfig:{types:["lens_xy_yConfig"],help:"Additional configuration for y axes",multi:true},columnToLabel:{types:["string"],help:"JSON key-value pairs of column ID to label"},palette:{default:'{theme "palette" default={system_palette name="default"} }',help:"",types:["palette"]}}),fn:function fn(input,args){return types_objectSpread({type:"lens_xy_layer"},args)}};const types_visualizationTypes=[{id:"bar",icon:LensIconChartBar,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.barLabel",{defaultMessage:"Bar"})},{id:"bar_horizontal",icon:LensIconChartBarHorizontal,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.barHorizontalLabel",{defaultMessage:"H. Bar"}),fullLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.barHorizontalFullLabel",{defaultMessage:"Horizontal bar"})},{id:"bar_stacked",icon:LensIconChartBarStacked,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.stackedBarLabel",{defaultMessage:"Stacked bar"})},{id:"bar_percentage_stacked",icon:LensIconChartBarPercentage,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.stackedPercentageBarLabel",{defaultMessage:"Percentage bar"})},{id:"bar_horizontal_stacked",icon:LensIconChartBarHorizontalStacked,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.stackedBarHorizontalLabel",{defaultMessage:"H. Stacked bar"}),fullLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.stackedBarHorizontalFullLabel",{defaultMessage:"Horizontal stacked bar"})},{id:"bar_horizontal_percentage_stacked",icon:LensIconChartBarHorizontalPercentage,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.stackedPercentageBarHorizontalLabel",{defaultMessage:"H. Percentage bar"}),fullLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.stackedPercentageBarHorizontalFullLabel",{defaultMessage:"Horizontal percentage bar"})},{id:"area",icon:LensIconChartArea,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.areaLabel",{defaultMessage:"Area"})},{id:"area_stacked",icon:LensIconChartAreaStacked,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.stackedAreaLabel",{defaultMessage:"Stacked area"})},{id:"area_percentage_stacked",icon:LensIconChartAreaPercentage,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.stackedPercentageAreaLabel",{defaultMessage:"Percentage area"})},{id:"line",icon:LensIconChartLine,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.lineLabel",{defaultMessage:"Line"})}];function isHorizontalSeries(seriesType){return seriesType==="bar_horizontal"||seriesType==="bar_horizontal_stacked"||seriesType==="bar_horizontal_percentage_stacked"}function isHorizontalChart(layers){return layers.every(l=>isHorizontalSeries(l.seriesType))}function getIconForSeries(type){const definition=types_visualizationTypes.find(t=>t.id===type);if(!definition){throw new Error("Unknown series type ".concat(type))}return definition.icon||"empty"}const getSeriesColor=(layer,accessor)=>{var _layer$yConfig,_layer$yConfig$find;if(layer.splitAccessor){return null}return(layer===null||layer===void 0?void 0:(_layer$yConfig=layer.yConfig)===null||_layer$yConfig===void 0?void 0:(_layer$yConfig$find=_layer$yConfig.find(yConfig=>yConfig.forAccessor===accessor))===null||_layer$yConfig$find===void 0?void 0:_layer$yConfig$find.color)||null};const getColumnToLabelMap=(layer,datasource)=>{const columnToLabel={};layer.accessors.concat(layer.splitAccessor?[layer.splitAccessor]:[]).forEach(accessor=>{const operation=datasource.getOperationForColumnId(accessor);if(operation===null||operation===void 0?void 0:operation.label){columnToLabel[accessor]=operation.label}});return columnToLabel};function hasHistogramSeries(layers=[],datasourceLayers){if(!datasourceLayers){return false}const validLayers=layers.filter(({accessors:accessors})=>accessors.length);return validLayers.some(({layerId:layerId,xAccessor:xAccessor})=>{const xAxisOperation=datasourceLayers[layerId].getOperationForColumnId(xAccessor);return xAxisOperation&&xAxisOperation.isBucketed&&xAxisOperation.scale&&xAxisOperation.scale!=="ordinal"})}var public_=__webpack_require__(9);const fittingFunctionDefinitions=[{id:"None",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fittingFunctionsTitle.none",{defaultMessage:"Hide"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fittingFunctionsDescription.none",{defaultMessage:"Do not fill gaps"})},{id:"Zero",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fittingFunctionsTitle.zero",{defaultMessage:"Zero"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fittingFunctionsDescription.zero",{defaultMessage:"Fill gaps with zeros"})},{id:"Linear",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fittingFunctionsTitle.linear",{defaultMessage:"Linear"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fittingFunctionsDescription.linear",{defaultMessage:"Fill gaps with a line"})},{id:"Carry",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fittingFunctionsTitle.carry",{defaultMessage:"Last"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fittingFunctionsDescription.carry",{defaultMessage:"Fill gaps with the last value"})},{id:"Lookahead",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fittingFunctionsTitle.lookahead",{defaultMessage:"Next"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fittingFunctionsDescription.lookahead",{defaultMessage:"Fill gaps with the next value"})}];function getFitEnum(fittingFunction){if(fittingFunction){return external_kbnSharedDeps_ElasticCharts_["Fit"][fittingFunction]}return external_kbnSharedDeps_ElasticCharts_["Fit"].None}function getFitOptions(fittingFunction){return{type:getFitEnum(fittingFunction)}}function axes_configuration_objectWithoutProperties(source,excluded){if(source==null)return{};var target=axes_configuration_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function axes_configuration_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function isFormatterCompatible(formatter1,formatter2){return formatter1.id===formatter2.id}function getAxesConfiguration(layers,shouldRotate,tables,formatFactory){const series={auto:[],left:[],right:[]};layers===null||layers===void 0?void 0:layers.forEach(layer=>{const table=tables===null||tables===void 0?void 0:tables[layer.layerId];layer.accessors.forEach(accessor=>{var _layer$yConfig,_layer$yConfig$find,_table$columns$find,_table$columns$find$m;const mode=((_layer$yConfig=layer.yConfig)===null||_layer$yConfig===void 0?void 0:(_layer$yConfig$find=_layer$yConfig.find(yAxisConfig=>yAxisConfig.forAccessor===accessor))===null||_layer$yConfig$find===void 0?void 0:_layer$yConfig$find.axisMode)||"auto";let formatter=(table===null||table===void 0?void 0:(_table$columns$find=table.columns.find(column=>column.id===accessor))===null||_table$columns$find===void 0?void 0:(_table$columns$find$m=_table$columns$find.meta)===null||_table$columns$find$m===void 0?void 0:_table$columns$find$m.params)||{id:"number"};if(layer.seriesType.includes("percentage")&&formatter.id!=="percent"){formatter={id:"percent",params:{pattern:"0.[00]%"}}}series[mode].push({layer:layer.layerId,accessor:accessor,fieldFormat:formatter})})});series.auto.forEach(currentSeries=>{if(series.left.length===0||tables&&series.left.every(leftSeries=>isFormatterCompatible(leftSeries.fieldFormat,currentSeries.fieldFormat))){series.left.push(currentSeries)}else if(series.right.length===0||tables&&series.left.every(leftSeries=>isFormatterCompatible(leftSeries.fieldFormat,currentSeries.fieldFormat))){series.right.push(currentSeries)}else if(series.right.length>=series.left.length){series.left.push(currentSeries)}else{series.right.push(currentSeries)}});const axisGroups=[];if(series.left.length>0){axisGroups.push({groupId:"left",position:shouldRotate?"bottom":"left",formatter:formatFactory===null||formatFactory===void 0?void 0:formatFactory(series.left[0].fieldFormat),series:series.left.map(_ref=>{let fieldFormat=_ref.fieldFormat,currentSeries=axes_configuration_objectWithoutProperties(_ref,["fieldFormat"]);return currentSeries})})}if(series.right.length>0){axisGroups.push({groupId:"right",position:shouldRotate?"top":"right",formatter:formatFactory===null||formatFactory===void 0?void 0:formatFactory(series.right[0].fieldFormat),series:series.right.map(_ref2=>{let fieldFormat=_ref2.fieldFormat,currentSeries=axes_configuration_objectWithoutProperties(_ref2,["fieldFormat"]);return currentSeries})})}return axisGroups}const color_assignment_isPrimitive=value=>value!=null&&typeof value!=="object";function getColorAssignments(layers,data,formatFactory){const layersPerPalette={};layers.forEach(layer=>{var _layer$palette;const palette=((_layer$palette=layer.palette)===null||_layer$palette===void 0?void 0:_layer$palette.name)||"default";if(!layersPerPalette[palette]){layersPerPalette[palette]=[]}layersPerPalette[palette].push(layer)});return Object(external_kbnSharedDeps_Lodash_["mapValues"])(layersPerPalette,paletteLayers=>{const seriesPerLayer=paletteLayers.map((layer,layerIndex)=>{var _data$tables$layer$la;if(!layer.splitAccessor){return{numberOfSeries:layer.accessors.length,splits:[]}}const splitAccessor=layer.splitAccessor;const column=(_data$tables$layer$la=data.tables[layer.layerId])===null||_data$tables$layer$la===void 0?void 0:_data$tables$layer$la.columns.find(({id:id})=>id===splitAccessor);const splits=!column||!data.tables[layer.layerId]?[]:Object(external_kbnSharedDeps_Lodash_["uniq"])(data.tables[layer.layerId].rows.map(row=>{let value=row[splitAccessor];if(value&&!color_assignment_isPrimitive(value)){value=formatFactory(column.meta.params).convert(value)}else{value=String(value)}return value}));return{numberOfSeries:(splits.length||1)*layer.accessors.length,splits:splits}});const totalSeriesCount=seriesPerLayer.reduce((sum,perLayer)=>sum+perLayer.numberOfSeries,0);return{totalSeriesCount:totalSeriesCount,getRank(layer,seriesKey,yAccessor){const layerIndex=paletteLayers.indexOf(layer);const currentSeriesPerLayer=seriesPerLayer[layerIndex];const splitRank=currentSeriesPerLayer.splits.indexOf(seriesKey);return(layerIndex===0?0:seriesPerLayer.slice(0,layerIndex).reduce((sum,perLayer)=>sum+perLayer.numberOfSeries,0))+(layer.splitAccessor&&splitRank!==-1?splitRank*layer.accessors.length:0)+layer.accessors.indexOf(yAccessor)}}})}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=xy_visualization_expression_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function xy_visualization_expression_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function xy_visualization_expression_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){xy_visualization_expression_ownKeys(Object(source),true).forEach((function(key){xy_visualization_expression_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{xy_visualization_expression_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function xy_visualization_expression_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function xy_visualization_expression_slicedToArray(arr,i){return xy_visualization_expression_arrayWithHoles(arr)||xy_visualization_expression_iterableToArrayLimit(arr,i)||xy_visualization_expression_unsupportedIterableToArray(arr,i)||xy_visualization_expression_nonIterableRest()}function xy_visualization_expression_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xy_visualization_expression_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return xy_visualization_expression_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xy_visualization_expression_arrayLikeToArray(o,minLen)}function xy_visualization_expression_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function xy_visualization_expression_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function xy_visualization_expression_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function xy_visualization_expression_extends(){xy_visualization_expression_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return xy_visualization_expression_extends.apply(this,arguments)}function xy_visualization_expression_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function xy_visualization_expression_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){xy_visualization_expression_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){xy_visualization_expression_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const xyChart={name:"lens_xy_chart",type:"render",inputTypes:["lens_multitable","kibana_context","null"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.help",{defaultMessage:"An X/Y chart"}),args:{title:{types:["string"],help:"The chart title."},description:{types:["string"],help:""},xTitle:{types:["string"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.xTitle.help",{defaultMessage:"X axis title"})},yTitle:{types:["string"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.yLeftTitle.help",{defaultMessage:"Y left axis title"})},yRightTitle:{types:["string"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.yRightTitle.help",{defaultMessage:"Y right axis title"})},legend:{types:["lens_xy_legendConfig"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.legend.help",{defaultMessage:"Configure the chart legend."})},fittingFunction:{types:["string"],options:[...fittingFunctionDefinitions.map(({id:id})=>id)],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.fittingFunction.help",{defaultMessage:"Define how missing values are treated"})},valueLabels:{types:["string"],options:["hide","inside"],help:""},tickLabelsVisibilitySettings:{types:["lens_xy_tickLabelsConfig"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.tickLabelsSettings.help",{defaultMessage:"Show x and y axes tick labels"})},gridlinesVisibilitySettings:{types:["lens_xy_gridlinesConfig"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.gridlinesSettings.help",{defaultMessage:"Show x and y axes gridlines"})},axisTitlesVisibilitySettings:{types:["lens_xy_axisTitlesVisibilityConfig"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.axisTitlesSettings.help",{defaultMessage:"Show x and y axes titles"})},layers:{types:["lens_xy_layer"],help:"Layers of visual series",multi:true}},fn(data,args){return{type:"render",as:"lens_xy_chart_renderer",value:{data:data,args:args}}}};function calculateMinInterval(_x,_x2){return _calculateMinInterval.apply(this,arguments)}function _calculateMinInterval(){_calculateMinInterval=xy_visualization_expression_asyncToGenerator(regeneratorRuntime.mark((function _callee2({args:{layers:layers},data:data},getIntervalByColumn){var filteredLayers,isTimeViz,dateColumn,dateMetaData,intervalDuration;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:filteredLayers=getFilteredLayers(layers,data);if(!(filteredLayers.length===0)){_context2.next=3;break}return _context2.abrupt("return");case 3:isTimeViz=data.dateRange&&filteredLayers.every(l=>l.xScaleType==="time");if(isTimeViz){_context2.next=6;break}return _context2.abrupt("return");case 6:dateColumn=data.tables[filteredLayers[0].layerId].columns.find(column=>column.id===filteredLayers[0].xAccessor);if(dateColumn){_context2.next=9;break}return _context2.abrupt("return");case 9:_context2.next=11;return getIntervalByColumn(dateColumn);case 11:dateMetaData=_context2.sent;if(dateMetaData){_context2.next=14;break}return _context2.abrupt("return");case 14:intervalDuration=public_["search"].aggs.parseInterval(dateMetaData.interval);if(intervalDuration){_context2.next=17;break}return _context2.abrupt("return");case 17:return _context2.abrupt("return",intervalDuration.as("milliseconds"));case 18:case"end":return _context2.stop()}}),_callee2)})));return _calculateMinInterval.apply(this,arguments)}const getXyChartRenderer=dependencies=>({name:"lens_xy_chart_renderer",displayName:"XY chart",help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.renderer.help",{defaultMessage:"X/Y chart renderer"}),validate:()=>undefined,reuseDomNode:true,render:function(){var _render=xy_visualization_expression_asyncToGenerator(regeneratorRuntime.mark((function _callee(domNode,config,handlers){var onClickValue,onSelectRange,formatFactory;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:handlers.onDestroy(()=>external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(domNode));onClickValue=data=>{handlers.event({name:"filter",data:data})};onSelectRange=data=>{handlers.event({name:"brush",data:data})};_context.next=5;return dependencies.formatFactory;case 5:formatFactory=_context.sent;_context.t0=external_kbnSharedDeps_ReactDom_default.a;_context.t1=external_kbnSharedDeps_React_default.a;_context.t2=external_kbnSharedDeps_KbnI18nReact_["I18nProvider"];_context.t3=external_kbnSharedDeps_React_default.a;_context.t4=XYChartReportable;_context.t5=xy_visualization_expression_extends;_context.t6={};_context.t7=config;_context.t8=formatFactory;_context.t9=dependencies.chartsThemeService;_context.t10=dependencies.paletteService;_context.t11=dependencies.timeZone;_context.next=20;return calculateMinInterval(config,dependencies.getIntervalByColumn);case 20:_context.t12=_context.sent;_context.t13=onClickValue;_context.t14=onSelectRange;_context.t15=handlers.getRenderMode();_context.t16={formatFactory:_context.t8,chartsThemeService:_context.t9,paletteService:_context.t10,timeZone:_context.t11,minInterval:_context.t12,onClickValue:_context.t13,onSelectRange:_context.t14,renderMode:_context.t15};_context.t17=(0,_context.t5)(_context.t6,_context.t7,_context.t16);_context.t18=_context.t3.createElement.call(_context.t3,_context.t4,_context.t17);_context.t19=_context.t1.createElement.call(_context.t1,_context.t2,null,_context.t18);_context.t20=domNode;_context.t21=()=>handlers.done();_context.t0.render.call(_context.t0,_context.t19,_context.t20,_context.t21);case 31:case"end":return _context.stop()}}),_callee)})));function render(_x3,_x4,_x5){return _render.apply(this,arguments)}return render}()});function getValueLabelsStyling(isHorizontal){const VALUE_LABELS_MAX_FONTSIZE=15;const VALUE_LABELS_MIN_FONTSIZE=10;const VALUE_LABELS_VERTICAL_OFFSET=-10;const VALUE_LABELS_HORIZONTAL_OFFSET=10;return{displayValue:{fontSize:{min:VALUE_LABELS_MIN_FONTSIZE,max:VALUE_LABELS_MAX_FONTSIZE},fill:{textInverted:true,textBorder:2},alignment:isHorizontal?{vertical:external_kbnSharedDeps_ElasticCharts_["VerticalAlignment"].Middle}:{horizontal:external_kbnSharedDeps_ElasticCharts_["HorizontalAlignment"].Center},offsetX:isHorizontal?VALUE_LABELS_HORIZONTAL_OFFSET:0,offsetY:isHorizontal?0:VALUE_LABELS_VERTICAL_OFFSET}}}function getIconForSeriesType(seriesType){return types_visualizationTypes.find(c=>c.id===seriesType).icon||"empty"}const expression_MemoizedChart=external_kbnSharedDeps_React_default.a.memo(XYChart);function XYChartReportable(props){const _useState=Object(external_kbnSharedDeps_React_["useState"])({isReady:false}),_useState2=xy_visualization_expression_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setState({isReady:true})},[setState]);return external_kbnSharedDeps_React_default.a.createElement(VisualizationContainer,{className:"lnsXyExpression__container",isReady:state.isReady,reportTitle:props.args.title,reportDescription:props.args.description},external_kbnSharedDeps_React_default.a.createElement(expression_MemoizedChart,props))}function XYChart({data:data,args:args,formatFactory:formatFactory,timeZone:timeZone,chartsThemeService:chartsThemeService,paletteService:paletteService,minInterval:minInterval,onClickValue:onClickValue,onSelectRange:onSelectRange,renderMode:renderMode}){var _xAxisColumn$meta,_data$dateRange,_data$dateRange2;const legend=args.legend,layers=args.layers,fittingFunction=args.fittingFunction,gridlinesVisibilitySettings=args.gridlinesVisibilitySettings,valueLabels=args.valueLabels;const chartTheme=chartsThemeService.useChartsTheme();const chartBaseTheme=chartsThemeService.useChartsBaseTheme();const filteredLayers=getFilteredLayers(layers,data);if(filteredLayers.length===0){const icon=layers.length>0?getIconForSeriesType(layers[0].seriesType):"bar";return external_kbnSharedDeps_React_default.a.createElement(EmptyPlaceholder,{icon:icon})}const xAxisColumn=data.tables[filteredLayers[0].layerId].columns.find(({id:id})=>id===filteredLayers[0].xAccessor);const xAxisFormatter=formatFactory(xAxisColumn&&((_xAxisColumn$meta=xAxisColumn.meta)===null||_xAxisColumn$meta===void 0?void 0:_xAxisColumn$meta.params));const layersAlreadyFormatted={};const safeXAccessorLabelRenderer=value=>xAxisColumn&&layersAlreadyFormatted[xAxisColumn.id]?value:xAxisFormatter.convert(value);const chartHasMoreThanOneSeries=filteredLayers.length>1||filteredLayers.some(layer=>layer.accessors.length>1)||filteredLayers.some(layer=>layer.splitAccessor);const shouldRotate=isHorizontalChart(filteredLayers);const yAxesConfiguration=getAxesConfiguration(filteredLayers,shouldRotate,data.tables,formatFactory);const xTitle=args.xTitle||xAxisColumn&&xAxisColumn.name;const axisTitlesVisibilitySettings=args.axisTitlesVisibilitySettings||{x:true,yLeft:true,yRight:true};const tickLabelsVisibilitySettings=args.tickLabelsVisibilitySettings||{x:true,yLeft:true,yRight:true};const filteredBarLayers=filteredLayers.filter(layer=>layer.seriesType.includes("bar"));const chartHasMoreThanOneBarSeries=filteredBarLayers.length>1||filteredBarLayers.some(layer=>layer.accessors.length>1)||filteredBarLayers.some(layer=>layer.splitAccessor);const isTimeViz=data.dateRange&&filteredLayers.every(l=>l.xScaleType==="time");const isHistogramViz=filteredLayers.every(l=>l.isHistogram);const xDomain=isTimeViz?{min:(_data$dateRange=data.dateRange)===null||_data$dateRange===void 0?void 0:_data$dateRange.fromDate.getTime(),max:(_data$dateRange2=data.dateRange)===null||_data$dateRange2===void 0?void 0:_data$dateRange2.toDate.getTime(),minInterval:minInterval}:undefined;const getYAxesTitles=(axisSeries,groupId)=>{const yTitle=groupId==="right"?args.yRightTitle:args.yTitle;return yTitle||axisSeries.map(series=>{var _data$tables$series$l;return(_data$tables$series$l=data.tables[series.layer].columns.find(column=>column.id===series.accessor))===null||_data$tables$series$l===void 0?void 0:_data$tables$series$l.name}).filter(name=>Boolean(name))[0]};const getYAxesStyle=groupId=>{const style={tickLabel:{visible:groupId==="right"?tickLabelsVisibilitySettings===null||tickLabelsVisibilitySettings===void 0?void 0:tickLabelsVisibilitySettings.yRight:tickLabelsVisibilitySettings===null||tickLabelsVisibilitySettings===void 0?void 0:tickLabelsVisibilitySettings.yLeft},axisTitle:{visible:groupId==="right"?axisTitlesVisibilitySettings===null||axisTitlesVisibilitySettings===void 0?void 0:axisTitlesVisibilitySettings.yRight:axisTitlesVisibilitySettings===null||axisTitlesVisibilitySettings===void 0?void 0:axisTitlesVisibilitySettings.yLeft}};return style};const shouldShowValueLabels=filteredLayers.every(layer=>!layer.seriesType.includes("stacked"))&&!isHistogramViz;const valueLabelsStyling=shouldShowValueLabels&&valueLabels!=="hide"&&getValueLabelsStyling(shouldRotate);const colorAssignments=getColorAssignments(args.layers,data,formatFactory);const clickHandler=([[geometry,series]])=>{var _table$columns$find,_table$columns$find$m;const xySeries=series;const xyGeometry=geometry;const layer=filteredLayers.find(l=>xySeries.seriesKeys.some(key=>l.accessors.includes(key.toString())));if(!layer){return}const table=data.tables[layer.layerId];const points=[{row:table.rows.findIndex(row=>{if(layer.xAccessor){if(layersAlreadyFormatted[layer.xAccessor]){return xAxisFormatter.convert(row[layer.xAccessor])===xyGeometry.x}return row[layer.xAccessor]===xyGeometry.x}}),column:table.columns.findIndex(col=>col.id===layer.xAccessor),value:xyGeometry.x}];if(xySeries.seriesKeys.length>1){const pointValue=xySeries.seriesKeys[0];points.push({row:table.rows.findIndex(row=>layer.splitAccessor&&row[layer.splitAccessor]===pointValue),column:table.columns.findIndex(col=>col.id===layer.splitAccessor),value:pointValue})}const xAxisFieldName=(_table$columns$find=table.columns.find(el=>el.id===layer.xAccessor))===null||_table$columns$find===void 0?void 0:(_table$columns$find$m=_table$columns$find.meta)===null||_table$columns$find$m===void 0?void 0:_table$columns$find$m.field;const timeFieldName=xDomain&&xAxisFieldName;const context={data:points.map(point=>({row:point.row,column:point.column,value:point.value,table:table})),timeFieldName:timeFieldName};onClickValue(desanitizeFilterContext(context))};const brushHandler=({x:x})=>{var _table$columns$xAxisC,_table$columns$xAxisC2;if(!x){return}const _x6=xy_visualization_expression_slicedToArray(x,2),min=_x6[0],max=_x6[1];if(!xAxisColumn||!isHistogramViz){return}const table=data.tables[filteredLayers[0].layerId];const xAxisColumnIndex=table.columns.findIndex(el=>el.id===filteredLayers[0].xAccessor);const timeFieldName=isTimeViz?(_table$columns$xAxisC=table.columns[xAxisColumnIndex])===null||_table$columns$xAxisC===void 0?void 0:(_table$columns$xAxisC2=_table$columns$xAxisC.meta)===null||_table$columns$xAxisC2===void 0?void 0:_table$columns$xAxisC2.field:undefined;const context={range:[min,max],table:table,column:xAxisColumnIndex,timeFieldName:timeFieldName};onSelectRange(context)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],{showLegend:legend.isVisible&&!legend.showSingleSeries?chartHasMoreThanOneSeries:legend.isVisible,legendPosition:legend.position,showLegendExtra:false,theme:xy_visualization_expression_objectSpread(xy_visualization_expression_objectSpread({},chartTheme),{},{barSeriesStyle:xy_visualization_expression_objectSpread(xy_visualization_expression_objectSpread({},chartTheme.barSeriesStyle),valueLabelsStyling),background:{color:undefined}}),baseTheme:chartBaseTheme,tooltip:{headerFormatter:d=>safeXAccessorLabelRenderer(d.value)},rotation:shouldRotate?90:0,xDomain:xDomain,onBrushEnd:renderMode!=="noInteractivity"?brushHandler:undefined,onElementClick:renderMode!=="noInteractivity"?clickHandler:undefined}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:"x",position:shouldRotate?external_kbnSharedDeps_ElasticCharts_["Position"].Left:external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,title:xTitle,gridLine:{visible:gridlinesVisibilitySettings===null||gridlinesVisibilitySettings===void 0?void 0:gridlinesVisibilitySettings.x,strokeWidth:2},hide:filteredLayers[0].hide||!filteredLayers[0].xAccessor,tickFormat:d=>safeXAccessorLabelRenderer(d),style:{tickLabel:{visible:tickLabelsVisibilitySettings===null||tickLabelsVisibilitySettings===void 0?void 0:tickLabelsVisibilitySettings.x},axisTitle:{visible:axisTitlesVisibilitySettings.x}}}),yAxesConfiguration.map(axis=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{key:axis.groupId,id:axis.groupId,groupId:axis.groupId,position:axis.position,title:getYAxesTitles(axis.series,axis.groupId),gridLine:{visible:axis.groupId==="right"?gridlinesVisibilitySettings===null||gridlinesVisibilitySettings===void 0?void 0:gridlinesVisibilitySettings.yRight:gridlinesVisibilitySettings===null||gridlinesVisibilitySettings===void 0?void 0:gridlinesVisibilitySettings.yLeft},hide:filteredLayers[0].hide,tickFormat:d=>{var _axis$formatter;return((_axis$formatter=axis.formatter)===null||_axis$formatter===void 0?void 0:_axis$formatter.convert(d))||""},style:getYAxesStyle(axis.groupId)})),filteredLayers.flatMap((layer,layerIndex)=>layer.accessors.map((accessor,accessorIndex)=>{const splitAccessor=layer.splitAccessor,seriesType=layer.seriesType,accessors=layer.accessors,xAccessor=layer.xAccessor,layerId=layer.layerId,columnToLabel=layer.columnToLabel,yScaleType=layer.yScaleType,xScaleType=layer.xScaleType,isHistogram=layer.isHistogram,palette=layer.palette;const columnToLabelMap=columnToLabel?JSON.parse(columnToLabel):{};const table=data.tables[layerId];const isPrimitive=value=>value!=null&&typeof value!=="object";const tableConverted=xy_visualization_expression_objectSpread(xy_visualization_expression_objectSpread({},table),{},{rows:table.rows.map(row=>{const newRow=xy_visualization_expression_objectSpread({},row);var _iterator=_createForOfIteratorHelper(table.columns),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){const column=_step.value;const record=newRow[column.id];if(record&&!isPrimitive(record)){newRow[column.id]=formatFactory(column.meta.params).convert(record)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return newRow})});table.columns.reduce((alreadyFormatted,{id:id})=>{if(alreadyFormatted[id]){return alreadyFormatted}alreadyFormatted[id]=table.rows.some((row,i)=>row[id]!==tableConverted.rows[i][id]);return alreadyFormatted},layersAlreadyFormatted);const rows=tableConverted.rows.filter(row=>!(xAccessor&&typeof row[xAccessor]==="undefined")&&!(splitAccessor&&typeof row[splitAccessor]==="undefined"&&typeof row[accessor]==="undefined"));if(!xAccessor){rows.forEach(row=>{row.unifiedX=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.emptyXLabel",{defaultMessage:"(empty)"})})}const yAxis=yAxesConfiguration.find(axisConfiguration=>axisConfiguration.series.find(currentSeries=>currentSeries.accessor===accessor));const seriesProps={splitSeriesAccessors:splitAccessor?[splitAccessor]:[],stackAccessors:seriesType.includes("stacked")?[xAccessor]:[],id:"".concat(splitAccessor,"-").concat(accessor),xAccessor:xAccessor||"unifiedX",yAccessors:[accessor],data:rows,xScaleType:xAccessor?xScaleType:"ordinal",yScaleType:yScaleType,color:({yAccessor:yAccessor,seriesKeys:seriesKeys})=>{const overwriteColor=getSeriesColor(layer,accessor);if(overwriteColor!==null){return overwriteColor}const colorAssignment=colorAssignments[palette.name];const seriesLayers=[{name:splitAccessor?String(seriesKeys[0]):columnToLabelMap[seriesKeys[0]],totalSeriesAtDepth:colorAssignment.totalSeriesCount,rankAtDepth:colorAssignment.getRank(layer,String(seriesKeys[0]),String(yAccessor))}];return paletteService.get(palette.name).getColor(seriesLayers,{maxDepth:1,behindText:false,totalSeries:colorAssignment.totalSeriesCount},palette.params)},groupId:yAxis===null||yAxis===void 0?void 0:yAxis.groupId,enableHistogramMode:isHistogram&&(seriesType.includes("stacked")||!splitAccessor)&&(seriesType.includes("stacked")||!seriesType.includes("bar")||!chartHasMoreThanOneBarSeries),stackMode:seriesType.includes("percentage")?external_kbnSharedDeps_ElasticCharts_["StackMode"].Percentage:undefined,timeZone:timeZone,areaSeriesStyle:{point:{visible:!xAccessor,radius:5}},lineSeriesStyle:{point:{visible:!xAccessor,radius:5}},name(d){var _table$columns$find2,_table$columns$find2$,_columnToLabelMap$d$s;const splitHint=(_table$columns$find2=table.columns.find(col=>col.id===splitAccessor))===null||_table$columns$find2===void 0?void 0:(_table$columns$find2$=_table$columns$find2.meta)===null||_table$columns$find2$===void 0?void 0:_table$columns$find2$.params;if(accessors.length>1){const result=d.seriesKeys.map((key,i)=>{var _columnToLabelMap$key;if(i===0&&splitHint&&splitAccessor&&!layersAlreadyFormatted[splitAccessor]){return formatFactory(splitHint).convert(key)}return splitAccessor&&i===0?key:(_columnToLabelMap$key=columnToLabelMap[key])!==null&&_columnToLabelMap$key!==void 0?_columnToLabelMap$key:""}).join(" - ");return result}if(splitHint){if(splitAccessor&&layersAlreadyFormatted[splitAccessor]){return d.seriesKeys[0]}return formatFactory(splitHint).convert(d.seriesKeys[0])}return splitAccessor?d.seriesKeys[0]:(_columnToLabelMap$d$s=columnToLabelMap[d.seriesKeys[0]])!==null&&_columnToLabelMap$d$s!==void 0?_columnToLabelMap$d$s:""}};const index="".concat(layerIndex,"-").concat(accessorIndex);switch(seriesType){case"line":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["LineSeries"],xy_visualization_expression_extends({key:index},seriesProps,{fit:getFitOptions(fittingFunction)}));case"bar":case"bar_stacked":case"bar_percentage_stacked":case"bar_horizontal":case"bar_horizontal_stacked":case"bar_horizontal_percentage_stacked":const valueLabelsSettings={displayValueSettings:{valueFormatter:d=>{var _yAxis$formatter;return(yAxis===null||yAxis===void 0?void 0:(_yAxis$formatter=yAxis.formatter)===null||_yAxis$formatter===void 0?void 0:_yAxis$formatter.convert(d))||""},showValueLabel:shouldShowValueLabels&&valueLabels!=="hide",isAlternatingValueLabel:false,isValueContainedInElement:true,hideClippedValue:true}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["BarSeries"],xy_visualization_expression_extends({key:index},seriesProps,valueLabelsSettings));case"area_stacked":case"area_percentage_stacked":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["AreaSeries"],xy_visualization_expression_extends({key:index},seriesProps,{fit:getFitOptions(fittingFunction)}));case"area":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["AreaSeries"],xy_visualization_expression_extends({key:index},seriesProps,{fit:getFitOptions(fittingFunction)}));default:return assertNever(seriesType)}})))}function getFilteredLayers(layers,data){return layers.filter(({layerId:layerId,xAccessor:xAccessor,accessors:accessors,splitAccessor:splitAccessor})=>!(!accessors.length||!data.tables[layerId]||data.tables[layerId].rows.length===0||xAccessor&&data.tables[layerId].rows.every(row=>typeof row[xAccessor]==="undefined")||!xAccessor&&splitAccessor&&data.tables[layerId].rows.every(row=>typeof row[splitAccessor]==="undefined")))}function assertNever(x){throw new Error("Unexpected series type: "+x)}function xy_suggestions_slicedToArray(arr,i){return xy_suggestions_arrayWithHoles(arr)||xy_suggestions_iterableToArrayLimit(arr,i)||xy_suggestions_unsupportedIterableToArray(arr,i)||xy_suggestions_nonIterableRest()}function xy_suggestions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xy_suggestions_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return xy_suggestions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xy_suggestions_arrayLikeToArray(o,minLen)}function xy_suggestions_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function xy_suggestions_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function xy_suggestions_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function xy_suggestions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function xy_suggestions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){xy_suggestions_ownKeys(Object(source),true).forEach((function(key){xy_suggestions_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{xy_suggestions_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function xy_suggestions_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const columnSortOrder={document:0,date:1,string:2,ip:3,boolean:4,number:5};function xy_suggestions_getSuggestions({table:table,state:state,keptLayerIds:keptLayerIds,subVisualizationId:subVisualizationId,mainPalette:mainPalette}){const incompleteTable=!table.isMultiRow||table.columns.length<=1||table.columns.every(col=>col.operation.dataType!=="number")||table.columns.some(col=>!columnSortOrder.hasOwnProperty(col.operation.dataType));if(incompleteTable&&table.changeType==="unchanged"&&state){return types_visualizationTypes.map(visType=>{const seriesType=visType.id;return{seriesType:seriesType,score:0,state:xy_suggestions_objectSpread(xy_suggestions_objectSpread({},state),{},{preferredSeriesType:seriesType,layers:state.layers.map(layer=>xy_suggestions_objectSpread(xy_suggestions_objectSpread({},layer),{},{seriesType:seriesType}))}),previewIcon:getIconForSeries(seriesType),title:visType.label,hide:true}})}if(incompleteTable&&state&&!subVisualizationId){return[]}const suggestions=getSuggestionForColumns(table,keptLayerIds,state,subVisualizationId,mainPalette);if(suggestions&&suggestions instanceof Array){return suggestions}return suggestions?[suggestions]:[]}function getSuggestionForColumns(table,keptLayerIds,currentState,seriesType,mainPalette){const _partition=Object(external_kbnSharedDeps_Lodash_["partition"])(table.columns,col=>col.operation.isBucketed),_partition2=xy_suggestions_slicedToArray(_partition,2),buckets=_partition2[0],values=_partition2[1];if(buckets.length===1||buckets.length===2){const _getBucketMappings=getBucketMappings(table,currentState),_getBucketMappings2=xy_suggestions_slicedToArray(_getBucketMappings,2),x=_getBucketMappings2[0],splitBy=_getBucketMappings2[1];return getSuggestionsForLayer({layerId:table.layerId,changeType:table.changeType,xValue:x,yValues:values,splitBy:splitBy,currentState:currentState,tableLabel:table.label,keptLayerIds:keptLayerIds,requestedSeriesType:seriesType,mainPalette:mainPalette})}else if(buckets.length===0){const _partition3=Object(external_kbnSharedDeps_Lodash_["partition"])(prioritizeColumns(values),col=>col.operation.dataType==="number"&&!col.operation.isBucketed),_partition4=xy_suggestions_slicedToArray(_partition3,2),yValues=_partition4[0],_partition4$=xy_suggestions_slicedToArray(_partition4[1],2),xValue=_partition4$[0],splitBy=_partition4$[1];return getSuggestionsForLayer({layerId:table.layerId,changeType:table.changeType,xValue:xValue,yValues:yValues,splitBy:splitBy,currentState:currentState,tableLabel:table.label,keptLayerIds:keptLayerIds,requestedSeriesType:seriesType,mainPalette:mainPalette})}}function flipSeriesType(seriesType){switch(seriesType){case"bar_horizontal":return"bar";case"bar_horizontal_stacked":return"bar_stacked";case"bar":return"bar_horizontal";case"bar_horizontal_percentage_stacked":return"bar_percentage_stacked";case"bar_percentage_stacked":return"bar_horizontal_percentage_stacked";default:return"bar_horizontal"}}function getBucketMappings(table,currentState){const currentLayer=currentState&&currentState.layers.find(({layerId:layerId})=>layerId===table.layerId);const buckets=table.columns.filter(col=>col.operation.isBucketed);const prioritizedBuckets=prioritizeColumns([...buckets].reverse());if(!currentLayer||table.changeType==="initial"){return prioritizedBuckets}if(table.changeType==="reorder"){return buckets}const currentXColumnIndex=prioritizedBuckets.findIndex(({columnId:columnId})=>columnId===currentLayer.xAccessor);const currentXScaleType=currentXColumnIndex>-1&&prioritizedBuckets[currentXColumnIndex].operation.scale;if(currentXScaleType&&(currentXScaleType==="interval"||prioritizedBuckets[0].operation.scale!=="interval")){const _prioritizedBuckets$s=prioritizedBuckets.splice(currentXColumnIndex,1),_prioritizedBuckets$s2=xy_suggestions_slicedToArray(_prioritizedBuckets$s,1),x=_prioritizedBuckets$s2[0];prioritizedBuckets.unshift(x)}const currentSplitColumnIndex=prioritizedBuckets.findIndex(({columnId:columnId})=>columnId===currentLayer.splitAccessor);if(currentSplitColumnIndex>-1){const _prioritizedBuckets$s3=prioritizedBuckets.splice(currentSplitColumnIndex,1),_prioritizedBuckets$s4=xy_suggestions_slicedToArray(_prioritizedBuckets$s3,1),splitBy=_prioritizedBuckets$s4[0];prioritizedBuckets.push(splitBy)}return prioritizedBuckets}function prioritizeColumns(columns){return[...columns].sort((a,b)=>columnSortOrder[a.operation.dataType]-columnSortOrder[b.operation.dataType])}function getSuggestionsForLayer({layerId:layerId,changeType:changeType,xValue:xValue,yValues:yValues,splitBy:splitBy,currentState:currentState,tableLabel:tableLabel,keptLayerIds:keptLayerIds,requestedSeriesType:requestedSeriesType,mainPalette:mainPalette}){const title=getSuggestionTitle(yValues,xValue,tableLabel);const seriesType=requestedSeriesType||getSeriesType(currentState,layerId,xValue);const options={currentState:currentState,seriesType:seriesType,layerId:layerId,title:title,yValues:yValues,splitBy:splitBy,changeType:changeType,xValue:xValue,keptLayerIds:keptLayerIds,mainPalette:splitBy?mainPalette:undefined};if(!currentState&&changeType==="unchanged"){return types_visualizationTypes.map(visType=>xy_suggestions_objectSpread(xy_suggestions_objectSpread({},buildSuggestion(xy_suggestions_objectSpread(xy_suggestions_objectSpread({},options),{},{seriesType:visType.id,hide:visType.id==="bar_stacked"?undefined:true}))),{},{title:visType.label})).sort((a,b)=>a.state.preferredSeriesType==="bar_stacked"?-1:1)}const isSameState=currentState&&changeType==="unchanged";if(!isSameState){return buildSuggestion(options)}const sameStateSuggestions=[];if(seriesType.includes("bar")&&(!xValue||xValue.operation.scale==="ordinal")){sameStateSuggestions.push(buildSuggestion(xy_suggestions_objectSpread(xy_suggestions_objectSpread({},options),{},{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xySuggestions.flipTitle",{defaultMessage:"Flip"}),seriesType:flipSeriesType(seriesType)})))}else{const newSeriesType=altSeriesType(seriesType);sameStateSuggestions.push(buildSuggestion(xy_suggestions_objectSpread(xy_suggestions_objectSpread({},options),{},{seriesType:newSeriesType,title:newSeriesType.startsWith("bar")?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xySuggestions.barChartTitle",{defaultMessage:"Bar chart"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xySuggestions.lineChartTitle",{defaultMessage:"Line chart"})})))}if(seriesType!=="line"&&splitBy&&!seriesType.includes("percentage")){sameStateSuggestions.push(buildSuggestion(xy_suggestions_objectSpread(xy_suggestions_objectSpread({},options),{},{seriesType:toggleStackSeriesType(seriesType),title:seriesType.endsWith("stacked")?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xySuggestions.unstackedChartTitle",{defaultMessage:"Unstacked"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xySuggestions.stackedChartTitle",{defaultMessage:"Stacked"})})))}if(seriesType!=="line"&&seriesType.includes("stacked")&&!seriesType.includes("percentage")){var _percentageOptions$xV;const percentageOptions=xy_suggestions_objectSpread({},options);if(((_percentageOptions$xV=percentageOptions.xValue)===null||_percentageOptions$xV===void 0?void 0:_percentageOptions$xV.operation.scale)==="ordinal"&&!percentageOptions.splitBy){percentageOptions.splitBy=percentageOptions.xValue;delete percentageOptions.xValue}sameStateSuggestions.push(buildSuggestion(xy_suggestions_objectSpread(xy_suggestions_objectSpread({},options),{},{hide:!percentageOptions.splitBy,seriesType:asPercentageSeriesType(seriesType),title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xySuggestions.asPercentageTitle",{defaultMessage:"Percentage"})})))}return sameStateSuggestions.concat(types_visualizationTypes.filter(visType=>!sameStateSuggestions.find(suggestion=>suggestion.state.preferredSeriesType===visType.id)).map(visType=>xy_suggestions_objectSpread(xy_suggestions_objectSpread({},buildSuggestion(xy_suggestions_objectSpread(xy_suggestions_objectSpread({},options),{},{seriesType:visType.id}))),{},{hide:true})))}function toggleStackSeriesType(oldSeriesType){switch(oldSeriesType){case"area":return"area_stacked";case"area_stacked":return"area";case"bar":return"bar_stacked";case"bar_stacked":return"bar";default:return oldSeriesType}}function asPercentageSeriesType(oldSeriesType){switch(oldSeriesType){case"area_stacked":return"area_percentage_stacked";case"bar_stacked":return"bar_percentage_stacked";case"bar_horizontal_stacked":return"bar_horizontal_percentage_stacked";default:return oldSeriesType}}function altSeriesType(oldSeriesType){switch(oldSeriesType){case"area":return"line";case"area_stacked":return"bar_stacked";case"bar":return"line";case"bar_stacked":return"line";case"line":default:return"bar_stacked"}}function getSeriesType(currentState,layerId,xValue){const defaultType="bar_stacked";const oldLayer=getExistingLayer(currentState,layerId);const oldLayerSeriesType=oldLayer?oldLayer.seriesType:false;const closestSeriesType=oldLayerSeriesType||currentState&&currentState.preferredSeriesType||defaultType;if(xValue&&xValue.operation.scale&&xValue.operation.scale==="ordinal"){return closestSeriesType.startsWith("bar")?closestSeriesType:defaultType}return closestSeriesType}function getSuggestionTitle(yValues,xValue,tableLabel){const yTitle=yValues.map(col=>col.operation.label).join(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xySuggestions.yAxixConjunctionSign",{defaultMessage:" & ",description:"A character that can be used for conjunction of multiple enumarated items. Make sure to include spaces around it if needed."}));const xTitle=(xValue===null||xValue===void 0?void 0:xValue.operation.label)||external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xySuggestions.emptyAxisTitle",{defaultMessage:"(empty)"});const title=tableLabel||((xValue===null||xValue===void 0?void 0:xValue.operation.dataType)==="date"?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xySuggestions.dateSuggestion",{defaultMessage:"{yTitle} over {xTitle}",description:'Chart description for charts over time, like "Transfered bytes over log.timestamp"',values:{xTitle:xTitle,yTitle:yTitle}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xySuggestions.nonDateSuggestion",{defaultMessage:"{yTitle} of {xTitle}",description:'Chart description for a value of some groups, like "Top URLs of top 5 countries"',values:{xTitle:xTitle,yTitle:yTitle}}));return title}function buildSuggestion({currentState:currentState,seriesType:seriesType,layerId:layerId,title:title,yValues:yValues,splitBy:splitBy,changeType:changeType,xValue:xValue,keptLayerIds:keptLayerIds,hide:hide,mainPalette:mainPalette}){var _xValue,_xValue2,_splitBy;if(seriesType.includes("percentage")&&((_xValue=xValue)===null||_xValue===void 0?void 0:_xValue.operation.scale)==="ordinal"&&!splitBy){splitBy=xValue;xValue=undefined}const existingLayer=getExistingLayer(currentState,layerId)||{};const accessors=yValues.map(col=>col.columnId);const newLayer=xy_suggestions_objectSpread(xy_suggestions_objectSpread({},existingLayer),{},{palette:mainPalette||("palette"in existingLayer?existingLayer.palette:undefined),layerId:layerId,seriesType:seriesType,xAccessor:(_xValue2=xValue)===null||_xValue2===void 0?void 0:_xValue2.columnId,splitAccessor:(_splitBy=splitBy)===null||_splitBy===void 0?void 0:_splitBy.columnId,accessors:accessors,yConfig:"yConfig"in existingLayer&&existingLayer.yConfig?existingLayer.yConfig.filter(({forAccessor:forAccessor})=>accessors.indexOf(forAccessor)!==-1):undefined});const keptLayers=currentState?currentState.layers.filter(layer=>keptLayerIds.includes(layer.layerId)).map(layer=>layer.layerId===layerId?newLayer:layer).map(layer=>xy_suggestions_objectSpread(xy_suggestions_objectSpread({},layer),{},{seriesType:seriesType})):[];const state={legend:currentState?currentState.legend:{isVisible:true,position:external_kbnSharedDeps_ElasticCharts_["Position"].Right},valueLabels:(currentState===null||currentState===void 0?void 0:currentState.valueLabels)||"hide",fittingFunction:(currentState===null||currentState===void 0?void 0:currentState.fittingFunction)||"None",xTitle:currentState===null||currentState===void 0?void 0:currentState.xTitle,yTitle:currentState===null||currentState===void 0?void 0:currentState.yTitle,yRightTitle:currentState===null||currentState===void 0?void 0:currentState.yRightTitle,axisTitlesVisibilitySettings:(currentState===null||currentState===void 0?void 0:currentState.axisTitlesVisibilitySettings)||{x:true,yLeft:true,yRight:true},tickLabelsVisibilitySettings:(currentState===null||currentState===void 0?void 0:currentState.tickLabelsVisibilitySettings)||{x:true,yLeft:true,yRight:true},gridlinesVisibilitySettings:(currentState===null||currentState===void 0?void 0:currentState.gridlinesVisibilitySettings)||{x:true,yLeft:true,yRight:true},preferredSeriesType:seriesType,layers:Object.keys(existingLayer).length?keptLayers:[...keptLayers,newLayer]};return{title:title,score:getScore(yValues,splitBy,changeType),hide:hide!==null&&hide!==void 0?hide:!currentState&&changeType!=="unchanged"&&changeType!=="extended"||currentState&&changeType==="reduced"||yValues.length===0||!xValue&&!splitBy,state:state,previewIcon:getIconForSeries(seriesType)}}function getScore(yValues,splitBy,changeType){const changeFactor=changeType==="unchanged"?.5:1;return((yValues.length>1?2:1)+(splitBy?1:0))/3*changeFactor}function getExistingLayer(currentState,layerId){return currentState&&currentState.layers.find(layer=>layer.layerId===layerId)}var xy_config_panel=__webpack_require__(108);var external_kbnSharedDeps_Moment_=__webpack_require__(25);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var common=__webpack_require__(1);function factory_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function factory_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){factory_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){factory_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function factory_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const STORAGE_KEY="lens-ui-telemetry";let reportManager;function setReportManager(newManager){if(reportManager){reportManager.stop()}reportManager=newManager}function stopReportManager(){if(reportManager){reportManager.stop()}}function factory_trackUiEvent(name){if(reportManager){reportManager.trackEvent(name)}}function trackSuggestionEvent(name){if(reportManager){reportManager.trackSuggestionEvent(name)}}class factory_LensReportManager{constructor({storage:storage,http:http}){factory_defineProperty(this,"events",{});factory_defineProperty(this,"suggestionEvents",{});factory_defineProperty(this,"storage",void 0);factory_defineProperty(this,"http",void 0);factory_defineProperty(this,"timer",void 0);this.storage=storage;this.http=http;this.readFromStorage();this.timer=setInterval(()=>{this.postToServer()},1e4)}trackEvent(name){this.readFromStorage();this.trackTo(this.events,name)}trackSuggestionEvent(name){this.readFromStorage();this.trackTo(this.suggestionEvents,name)}stop(){if(this.timer){clearInterval(this.timer)}}readFromStorage(){const data=this.storage.get(STORAGE_KEY);if(data&&typeof data.events==="object"&&typeof data.suggestionEvents==="object"){this.events=data.events;this.suggestionEvents=data.suggestionEvents}}postToServer(){var _this=this;return factory_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_this.readFromStorage();if(!(Object.keys(_this.events).length||Object.keys(_this.suggestionEvents).length)){_context.next=12;break}_context.prev=2;_context.next=5;return _this.http.post("".concat(common["BASE_API_URL"],"/stats"),{body:JSON.stringify({events:_this.events,suggestionEvents:_this.suggestionEvents})});case 5:_this.events={};_this.suggestionEvents={};_this.write();_context.next=12;break;case 10:_context.prev=10;_context.t0=_context["catch"](2);case 12:case"end":return _context.stop()}}),_callee,null,[[2,10]])})))()}trackTo(target,name){const date=external_kbnSharedDeps_Moment_default()().utc().format("YYYY-MM-DD");if(!target[date]){target[date]={[name]:1}}else if(!target[date][name]){target[date][name]=1}else{target[date][name]+=1}this.write()}write(){this.storage.set(STORAGE_KEY,{events:this.events,suggestionEvents:this.suggestionEvents})}}function axis_bottom_extends(){axis_bottom_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return axis_bottom_extends.apply(this,arguments)}function axis_bottom_objectWithoutProperties(source,excluded){if(source==null)return{};var target=axis_bottom_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function axis_bottom_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const EuiIconAxisBottom=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=axis_bottom_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_["createElement"]("svg",axis_bottom_extends({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_["createElement"]("title",{id:titleId},title):null,external_kbnSharedDeps_React_["createElement"]("path",{d:"M5 1.5a.5.5 0 111 0v7a.5.5 0 01-1 0v-7zM15.39 11.39a1.5 1.5 0 010 2.12l-2.122 2.122a.5.5 0 11-.707-.707l2.121-2.122a.5.5 0 000-.707l-2.121-2.12a.5.5 0 11.707-.708l2.121 2.121zM3.439 9.269a.5.5 0 010 .707l-2.122 2.121a.5.5 0 000 .707l2.122 2.121a.5.5 0 01-.707.708L.61 13.51a1.5 1.5 0 010-2.121l2.122-2.121a.5.5 0 01.707 0zM8 3a.5.5 0 01.5.5v5a.5.5 0 01-1 0v-5A.5.5 0 018 3zM11 5.5a.5.5 0 00-1 0v3a.5.5 0 001 0v-3z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M3.5 12a.5.5 0 000 1h9a.5.5 0 000-1h-9z"}))};function axis_left_extends(){axis_left_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return axis_left_extends.apply(this,arguments)}function axis_left_objectWithoutProperties(source,excluded){if(source==null)return{};var target=axis_left_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function axis_left_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const EuiIconAxisLeft=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=axis_left_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_["createElement"]("svg",axis_left_extends({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_["createElement"]("title",{id:titleId},title):null,external_kbnSharedDeps_React_["createElement"]("path",{d:"M7.378 3.585a.5.5 0 00.353-.854L5.61.611a1.5 1.5 0 00-2.121 0L1.367 2.73a.5.5 0 00.708.707l2.12-2.12a.5.5 0 01.708 0l2.121 2.12a.5.5 0 00.354.147z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M5.046 3.088v4.129l.005.04v5.658a.5.5 0 01-.992.09l-.01-.09V8.786l-.004-.04V3.087a.5.5 0 01.992-.09l.01.09z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M4.55 15.829a1.5 1.5 0 001.06-.44l2.122-2.121a.5.5 0 10-.707-.707l-2.121 2.121a.5.5 0 01-.708 0l-2.12-2.121a.5.5 0 00-.708.707l2.121 2.121a1.5 1.5 0 001.061.44zM13.5 4a.5.5 0 01.5.5v7a.5.5 0 11-1 0v-7a.5.5 0 01.5-.5zM10.5 6.5a.5.5 0 011 0v5a.5.5 0 11-1 0v-5zM8.5 8a.5.5 0 00-.5.5v3a.5.5 0 101 0v-3a.5.5 0 00-.5-.5z"}))};function axis_right_extends(){axis_right_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return axis_right_extends.apply(this,arguments)}function axis_right_objectWithoutProperties(source,excluded){if(source==null)return{};var target=axis_right_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function axis_right_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const EuiIconAxisRight=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=axis_right_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_["createElement"]("svg",axis_right_extends({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_["createElement"]("title",{id:titleId},title):null,external_kbnSharedDeps_React_["createElement"]("path",{d:"M8.622 3.585a.5.5 0 01-.353-.854L10.39.611a1.5 1.5 0 012.121 0l2.122 2.12a.5.5 0 11-.707.707l-2.122-2.12a.5.5 0 00-.707 0l-2.121 2.12a.5.5 0 01-.354.147z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M11.95 12.915V8.786l.005-.04V3.087a.5.5 0 00-.992-.09l-.01.09v4.129l-.004.04v5.658a.5.5 0 00.992.09l.01-.09z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M11.45 15.829a1.5 1.5 0 01-1.06-.44l-2.122-2.121a.5.5 0 11.707-.707l2.121 2.121a.5.5 0 00.707 0l2.122-2.121a.5.5 0 01.707.707l-2.121 2.121a1.5 1.5 0 01-1.061.44zM2.5 4a.5.5 0 00-.5.5v7a.5.5 0 101 0v-7a.5.5 0 00-.5-.5zM5.5 6.5a.5.5 0 00-1 0v5a.5.5 0 101 0v-5zM7.5 8a.5.5 0 01.5.5v3a.5.5 0 11-1 0v-3a.5.5 0 01.5-.5z"}))};function axis_top_extends(){axis_top_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return axis_top_extends.apply(this,arguments)}function axis_top_objectWithoutProperties(source,excluded){if(source==null)return{};var target=axis_top_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function axis_top_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const EuiIconAxisTop=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=axis_top_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_["createElement"]("svg",axis_top_extends({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_["createElement"]("title",{id:titleId},title):null,external_kbnSharedDeps_React_["createElement"]("path",{d:"M4.99991 7.49999C4.99991 7.22384 5.22376 6.99999 5.49991 6.99999C5.77605 6.99999 5.99991 7.22384 5.99991 7.49999V14.5C5.99991 14.7761 5.77605 15 5.49991 15C5.22376 15 4.99991 14.7761 4.99991 14.5V7.49999Z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M15.3893 2.38929C15.6706 2.67059 15.8287 3.05212 15.8287 3.44995C15.8287 3.84777 15.6706 4.2293 15.3893 4.51061L13.268 6.63193C13.1742 6.7257 13.0471 6.77838 12.9145 6.77838C12.7818 6.77838 12.6547 6.7257 12.5609 6.63193C12.4671 6.53816 12.4145 6.41098 12.4145 6.27838C12.4145 6.14577 12.4671 6.01859 12.5609 5.92482L14.6822 3.8035C14.776 3.70973 14.8287 3.58256 14.8287 3.44995C14.8287 3.31734 14.776 3.19016 14.6822 3.09639L12.5609 0.975075C12.4671 0.881307 12.4145 0.754129 12.4145 0.621522C12.4145 0.488914 12.4671 0.361736 12.5609 0.267968C12.6547 0.1742 12.7819 0.121521 12.9145 0.121521C13.0471 0.121521 13.1742 0.1742 13.268 0.267968L15.3893 2.38929Z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M3.43867 0.26864C3.53243 0.362408 3.58511 0.489585 3.58511 0.622193C3.58511 0.754801 3.53243 0.881978 3.43867 0.975746L1.31735 3.09707C1.22358 3.19083 1.1709 3.31801 1.1709 3.45062C1.1709 3.58323 1.22358 3.71041 1.31735 3.80417L3.43867 5.92549C3.53243 6.01926 3.58511 6.14644 3.58511 6.27905C3.58511 6.41166 3.53243 6.53883 3.43867 6.6326C3.3449 6.72637 3.21772 6.77905 3.08511 6.77905C2.9525 6.77905 2.82533 6.72637 2.73156 6.6326L0.610239 4.51128C0.328934 4.22998 0.170898 3.84844 0.170898 3.45062C0.170898 3.0528 0.328934 2.67126 0.610238 2.38996L2.73156 0.26864C2.82533 0.174871 2.9525 0.122192 3.08511 0.122192C3.21772 0.122192 3.3449 0.174871 3.43867 0.26864Z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M7.99991 6.99999C8.27605 6.99999 8.49991 7.22384 8.49991 7.49999V12.5C8.49991 12.7761 8.27605 13 7.99991 13C7.72377 13 7.49991 12.7761 7.49991 12.5V7.49999C7.49991 7.22384 7.72377 6.99999 7.99991 6.99999Z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M10.9999 7.49999C10.9999 7.22384 10.776 6.99999 10.4999 6.99999C10.2238 6.99999 9.99991 7.22384 9.99991 7.49999V10.5C9.99991 10.7761 10.2238 11 10.4999 11C10.776 11 10.9999 10.7761 10.9999 10.5V7.49999Z"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M3.50015 2.99999C3.22401 2.99999 3.00015 3.22384 3.00015 3.49999C3.00015 3.77613 3.22401 3.99999 3.50015 3.99999H12.5002C12.7763 3.99999 13.0002 3.77613 13.0002 3.49999C13.0002 3.22384 12.7763 2.99999 12.5002 2.99999H3.50015Z"}))};function axis_settings_popover_slicedToArray(arr,i){return axis_settings_popover_arrayWithHoles(arr)||axis_settings_popover_iterableToArrayLimit(arr,i)||axis_settings_popover_unsupportedIterableToArray(arr,i)||axis_settings_popover_nonIterableRest()}function axis_settings_popover_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function axis_settings_popover_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return axis_settings_popover_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return axis_settings_popover_arrayLikeToArray(o,minLen)}function axis_settings_popover_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function axis_settings_popover_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function axis_settings_popover_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const popoverConfig=(axis,isHorizontal)=>{switch(axis){case"yLeft":return{icon:isHorizontal?EuiIconAxisBottom:EuiIconAxisLeft,groupPosition:"left",popoverTitle:isHorizontal?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.bottomAxisLabel",{defaultMessage:"Bottom axis"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.leftAxisLabel",{defaultMessage:"Left axis"}),buttonDataTestSubj:"lnsLeftAxisButton"};case"yRight":return{icon:isHorizontal?EuiIconAxisTop:EuiIconAxisRight,groupPosition:"right",popoverTitle:isHorizontal?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.topAxisLabel",{defaultMessage:"Top axis"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.rightAxisLabel",{defaultMessage:"Right axis"}),buttonDataTestSubj:"lnsRightAxisButton"};case"x":default:return{icon:isHorizontal?EuiIconAxisLeft:EuiIconAxisBottom,groupPosition:"center",popoverTitle:isHorizontal?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.leftAxisLabel",{defaultMessage:"Left axis"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.bottomAxisLabel",{defaultMessage:"Bottom axis"}),buttonDataTestSubj:"lnsBottomAxisButton"}}};const AxisSettingsPopover=({layers:layers,axis:axis,axisTitle:axisTitle,updateTitleState:updateTitleState,toggleTickLabelsVisibility:toggleTickLabelsVisibility,toggleGridlinesVisibility:toggleGridlinesVisibility,isDisabled:isDisabled,areTickLabelsVisible:areTickLabelsVisible,areGridlinesVisible:areGridlinesVisible,isAxisTitleVisible:isAxisTitleVisible,toggleAxisTitleVisibility:toggleAxisTitleVisibility})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(axisTitle),_useState2=axis_settings_popover_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];const isHorizontal=(layers===null||layers===void 0?void 0:layers.length)?isHorizontalChart(layers):false;const config=popoverConfig(axis,isHorizontal);const onTitleChange=value=>{setTitle(value);updateTitleState(value)};return external_kbnSharedDeps_React_default.a.createElement(ToolbarPopover,{title:config.popoverTitle,type:config.icon,groupPosition:config.groupPosition,isDisabled:isDisabled,buttonDataTestSubj:config.buttonDataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.axisNameLabel",{defaultMessage:"Axis name"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{compressed:true,"data-test-subj":"lnsShowAxisTitleSwitch__".concat(axis),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.ShowAxisTitleLabel",{defaultMessage:"Show"}),onChange:({target:target})=>toggleAxisTitleVisibility(axis,target.checked),checked:isAxisTitleVisible}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"lns".concat(axis,"AxisTitle"),compressed:true,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.overwriteAxisTitle",{defaultMessage:"Overwrite axis title"}),value:title||"",disabled:!isAxisTitleVisible||false,onChange:({target:target})=>onTitleChange(target.value),"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.overwriteAxisTitle",{defaultMessage:"Overwrite axis title"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{compressed:true,"data-test-subj":"lnsshow".concat(axis,"AxisTickLabels"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.tickLabels",{defaultMessage:"Tick labels"}),onChange:()=>toggleTickLabelsVisibility(axis),checked:areTickLabelsVisible}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{compressed:true,"data-test-subj":"lnsshow".concat(axis,"AxisGridlines"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.Gridlines",{defaultMessage:"Gridlines"}),onChange:()=>toggleGridlinesVisibility(axis),checked:areGridlinesVisible}))};const TooltipWrapper=({children:children,condition:condition,tooltipContent:tooltipContent})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,condition?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:tooltipContent,delay:"long"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)):children);function xy_config_panel_slicedToArray(arr,i){return xy_config_panel_arrayWithHoles(arr)||xy_config_panel_iterableToArrayLimit(arr,i)||xy_config_panel_unsupportedIterableToArray(arr,i)||xy_config_panel_nonIterableRest()}function xy_config_panel_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xy_config_panel_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return xy_config_panel_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xy_config_panel_arrayLikeToArray(o,minLen)}function xy_config_panel_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function xy_config_panel_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function xy_config_panel_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function xy_config_panel_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function xy_config_panel_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){xy_config_panel_ownKeys(Object(source),true).forEach((function(key){xy_config_panel_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{xy_config_panel_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function xy_config_panel_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function updateLayer(state,layer,index){const newLayers=[...state.layers];newLayers[index]=layer;return xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{layers:newLayers})}const xy_config_panel_legendOptions=[{id:"xy_legend_auto",value:"auto",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.legendVisibility.auto",{defaultMessage:"Auto"})},{id:"xy_legend_show",value:"show",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.legendVisibility.show",{defaultMessage:"Show"})},{id:"xy_legend_hide",value:"hide",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.legendVisibility.hide",{defaultMessage:"Hide"})}];const valueLabelsOptions=[{id:"value_labels_hide",value:"hide",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.valueLabelsVisibility.auto",{defaultMessage:"Hide"})},{id:"value_labels_inside",value:"inside",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.valueLabelsVisibility.inside",{defaultMessage:"Show"})}];function LayerContextMenu(props){const state=props.state,layerId=props.layerId;const horizontalOnly=isHorizontalChart(state.layers);const index=state.layers.findIndex(l=>l.layerId===layerId);const layer=state.layers[index];if(!layer){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.chartTypeLabel",{defaultMessage:"Chart type"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{legend:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.chartTypeLegend",{defaultMessage:"Chart type"}),name:"chartType",className:"eui-displayInlineBlock",options:types_visualizationTypes.filter(t=>isHorizontalSeries(t.id)===horizontalOnly).map(t=>({id:t.id,label:t.label,iconType:t.icon||"empty","data-test-subj":"lnsXY_seriesType-".concat(t.id)})),idSelected:layer.seriesType,onChange:seriesType=>{factory_trackUiEvent("xy_change_layer_display");props.setState(updateLayer(state,xy_config_panel_objectSpread(xy_config_panel_objectSpread({},layer),{},{seriesType:seriesType}),index))},isIconOnly:true}))}function XyToolbar(props){var _state$tickLabelsVisi,_state$tickLabelsVisi2,_state$tickLabelsVisi3,_state$tickLabelsVisi4,_state$tickLabelsVisi5,_state$tickLabelsVisi6,_state$gridlinesVisib,_state$gridlinesVisib2,_state$gridlinesVisib3,_state$gridlinesVisib4,_state$gridlinesVisib5,_state$gridlinesVisib6,_state$axisTitlesVisi,_state$axisTitlesVisi2,_state$axisTitlesVisi3,_state$axisTitlesVisi4,_state$axisTitlesVisi5,_state$axisTitlesVisi6;const state=props.state,setState=props.setState,frame=props.frame;const hasNonBarSeries=state===null||state===void 0?void 0:state.layers.some(({seriesType:seriesType})=>["area_stacked","area","line"].includes(seriesType));const hasBarNotStacked=state===null||state===void 0?void 0:state.layers.some(({seriesType:seriesType})=>["bar","bar_horizontal"].includes(seriesType));const isAreaPercentage=state===null||state===void 0?void 0:state.layers.some(({seriesType:seriesType})=>seriesType==="area_percentage_stacked");const isHistogramSeries=Boolean(hasHistogramSeries(state===null||state===void 0?void 0:state.layers,frame.datasourceLayers));const shouldRotate=(state===null||state===void 0?void 0:state.layers.length)?isHorizontalChart(state.layers):false;const axisGroups=getAxesConfiguration(state===null||state===void 0?void 0:state.layers,shouldRotate);const tickLabelsVisibilitySettings={x:(_state$tickLabelsVisi=state===null||state===void 0?void 0:(_state$tickLabelsVisi2=state.tickLabelsVisibilitySettings)===null||_state$tickLabelsVisi2===void 0?void 0:_state$tickLabelsVisi2.x)!==null&&_state$tickLabelsVisi!==void 0?_state$tickLabelsVisi:true,yLeft:(_state$tickLabelsVisi3=state===null||state===void 0?void 0:(_state$tickLabelsVisi4=state.tickLabelsVisibilitySettings)===null||_state$tickLabelsVisi4===void 0?void 0:_state$tickLabelsVisi4.yLeft)!==null&&_state$tickLabelsVisi3!==void 0?_state$tickLabelsVisi3:true,yRight:(_state$tickLabelsVisi5=state===null||state===void 0?void 0:(_state$tickLabelsVisi6=state.tickLabelsVisibilitySettings)===null||_state$tickLabelsVisi6===void 0?void 0:_state$tickLabelsVisi6.yRight)!==null&&_state$tickLabelsVisi5!==void 0?_state$tickLabelsVisi5:true};const onTickLabelsVisibilitySettingsChange=optionId=>{const newTickLabelsVisibilitySettings=xy_config_panel_objectSpread(xy_config_panel_objectSpread({},tickLabelsVisibilitySettings),{[optionId]:!tickLabelsVisibilitySettings[optionId]});setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{tickLabelsVisibilitySettings:newTickLabelsVisibilitySettings}))};const gridlinesVisibilitySettings={x:(_state$gridlinesVisib=state===null||state===void 0?void 0:(_state$gridlinesVisib2=state.gridlinesVisibilitySettings)===null||_state$gridlinesVisib2===void 0?void 0:_state$gridlinesVisib2.x)!==null&&_state$gridlinesVisib!==void 0?_state$gridlinesVisib:true,yLeft:(_state$gridlinesVisib3=state===null||state===void 0?void 0:(_state$gridlinesVisib4=state.gridlinesVisibilitySettings)===null||_state$gridlinesVisib4===void 0?void 0:_state$gridlinesVisib4.yLeft)!==null&&_state$gridlinesVisib3!==void 0?_state$gridlinesVisib3:true,yRight:(_state$gridlinesVisib5=state===null||state===void 0?void 0:(_state$gridlinesVisib6=state.gridlinesVisibilitySettings)===null||_state$gridlinesVisib6===void 0?void 0:_state$gridlinesVisib6.yRight)!==null&&_state$gridlinesVisib5!==void 0?_state$gridlinesVisib5:true};const onGridlinesVisibilitySettingsChange=optionId=>{const newGridlinesVisibilitySettings=xy_config_panel_objectSpread(xy_config_panel_objectSpread({},gridlinesVisibilitySettings),{[optionId]:!gridlinesVisibilitySettings[optionId]});setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{gridlinesVisibilitySettings:newGridlinesVisibilitySettings}))};const axisTitlesVisibilitySettings={x:(_state$axisTitlesVisi=state===null||state===void 0?void 0:(_state$axisTitlesVisi2=state.axisTitlesVisibilitySettings)===null||_state$axisTitlesVisi2===void 0?void 0:_state$axisTitlesVisi2.x)!==null&&_state$axisTitlesVisi!==void 0?_state$axisTitlesVisi:true,yLeft:(_state$axisTitlesVisi3=state===null||state===void 0?void 0:(_state$axisTitlesVisi4=state.axisTitlesVisibilitySettings)===null||_state$axisTitlesVisi4===void 0?void 0:_state$axisTitlesVisi4.yLeft)!==null&&_state$axisTitlesVisi3!==void 0?_state$axisTitlesVisi3:true,yRight:(_state$axisTitlesVisi5=state===null||state===void 0?void 0:(_state$axisTitlesVisi6=state.axisTitlesVisibilitySettings)===null||_state$axisTitlesVisi6===void 0?void 0:_state$axisTitlesVisi6.yRight)!==null&&_state$axisTitlesVisi5!==void 0?_state$axisTitlesVisi5:true};const onAxisTitlesVisibilitySettingsChange=(axis,checked)=>{const newAxisTitlesVisibilitySettings=xy_config_panel_objectSpread(xy_config_panel_objectSpread({},axisTitlesVisibilitySettings),{[axis]:checked});setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{axisTitlesVisibilitySettings:newAxisTitlesVisibilitySettings}))};const legendMode=(state===null||state===void 0?void 0:state.legend.isVisible)&&!(state===null||state===void 0?void 0:state.legend.showSingleSeries)?"auto":!(state===null||state===void 0?void 0:state.legend.isVisible)?"hide":"show";const valueLabelsVisibilityMode=(state===null||state===void 0?void 0:state.valueLabels)||"hide";const isValueLabelsEnabled=!hasNonBarSeries&&hasBarNotStacked&&!isHistogramSeries;const isFittingEnabled=hasNonBarSeries;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",responsive:false},external_kbnSharedDeps_React_default.a.createElement(TooltipWrapper,{tooltipContent:isAreaPercentage?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.valuesPercentageDisabledHelpText",{defaultMessage:"This setting cannot be changed on percentage area charts."}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.valuesStackedDisabledHelpText",{defaultMessage:"This setting cannot be changed on histograms."}),condition:!isValueLabelsEnabled&&!isFittingEnabled},external_kbnSharedDeps_React_default.a.createElement(ToolbarPopover,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.valuesLabel",{defaultMessage:"Values"}),type:"values",groupPosition:"left",buttonDataTestSubj:"lnsValuesButton",isDisabled:!isValueLabelsEnabled&&!isFittingEnabled},isValueLabelsEnabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"columnCompressed",label:external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.chartValueLabelVisibilityLabel",{defaultMessage:"Labels"}))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{isFullWidth:true,legend:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.shared.chartValueLabelVisibilityLabel",{defaultMessage:"Labels"}),"data-test-subj":"lnsValueLabelsDisplay",name:"valueLabelsDisplay",buttonSize:"compressed",options:valueLabelsOptions,idSelected:valueLabelsOptions.find(({value:value})=>value===valueLabelsVisibilityMode).id,onChange:modeId=>{const newMode=valueLabelsOptions.find(({id:id})=>id===modeId).value;setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{valueLabels:newMode}))}})):null,isFittingEnabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"columnCompressed",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.missingValuesLabel",{defaultMessage:"Missing values"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{"data-test-subj":"lnsMissingValuesSelect",compressed:true,options:fittingFunctionDefinitions.map(({id:id,title:title,description:description})=>({value:id,dropdownDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("strong",null,title),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,description))),inputDisplay:title})),valueOfSelected:(state===null||state===void 0?void 0:state.fittingFunction)||"None",onChange:value=>setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{fittingFunction:value})),itemLayoutAlign:"top",hasDividers:true})):null)),external_kbnSharedDeps_React_default.a.createElement(LegendSettingsPopover,{legendOptions:xy_config_panel_legendOptions,mode:legendMode,onDisplayChange:optionId=>{const newMode=xy_config_panel_legendOptions.find(({id:id})=>id===optionId).value;if(newMode==="auto"){setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{legend:xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state.legend),{},{isVisible:true,showSingleSeries:false})}))}else if(newMode==="show"){setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{legend:xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state.legend),{},{isVisible:true,showSingleSeries:true})}))}else if(newMode==="hide"){setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{legend:xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state.legend),{},{isVisible:false,showSingleSeries:false})}))}},position:state===null||state===void 0?void 0:state.legend.position,onPositionChange:id=>{setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{legend:xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state.legend),{},{position:id})}))}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",responsive:false},external_kbnSharedDeps_React_default.a.createElement(TooltipWrapper,{tooltipContent:shouldRotate?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.bottomAxisDisabledHelpText",{defaultMessage:"This setting only applies when bottom axis is enabled."}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.leftAxisDisabledHelpText",{defaultMessage:"This setting only applies when left axis is enabled."}),condition:Object.keys(axisGroups.find(group=>group.groupId==="left")||{}).length===0},external_kbnSharedDeps_React_default.a.createElement(AxisSettingsPopover,{axis:"yLeft",layers:state===null||state===void 0?void 0:state.layers,axisTitle:state===null||state===void 0?void 0:state.yTitle,updateTitleState:value=>setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{yTitle:value})),areTickLabelsVisible:tickLabelsVisibilitySettings.yLeft,toggleTickLabelsVisibility:onTickLabelsVisibilitySettingsChange,areGridlinesVisible:gridlinesVisibilitySettings.yLeft,toggleGridlinesVisibility:onGridlinesVisibilitySettingsChange,isDisabled:Object.keys(axisGroups.find(group=>group.groupId==="left")||{}).length===0,isAxisTitleVisible:axisTitlesVisibilitySettings.yLeft,toggleAxisTitleVisibility:onAxisTitlesVisibilitySettingsChange})),external_kbnSharedDeps_React_default.a.createElement(AxisSettingsPopover,{axis:"x",layers:state===null||state===void 0?void 0:state.layers,axisTitle:state===null||state===void 0?void 0:state.xTitle,updateTitleState:value=>setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{xTitle:value})),areTickLabelsVisible:tickLabelsVisibilitySettings.x,toggleTickLabelsVisibility:onTickLabelsVisibilitySettingsChange,areGridlinesVisible:gridlinesVisibilitySettings.x,toggleGridlinesVisibility:onGridlinesVisibilitySettingsChange,isAxisTitleVisible:axisTitlesVisibilitySettings.x,toggleAxisTitleVisibility:onAxisTitlesVisibilitySettingsChange}),external_kbnSharedDeps_React_default.a.createElement(TooltipWrapper,{tooltipContent:shouldRotate?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.topAxisDisabledHelpText",{defaultMessage:"This setting only applies when top axis is enabled."}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.rightAxisDisabledHelpText",{defaultMessage:"This setting only applies when right axis is enabled."}),condition:Object.keys(axisGroups.find(group=>group.groupId==="right")||{}).length===0},external_kbnSharedDeps_React_default.a.createElement(AxisSettingsPopover,{axis:"yRight",layers:state===null||state===void 0?void 0:state.layers,axisTitle:state===null||state===void 0?void 0:state.yRightTitle,updateTitleState:value=>setState(xy_config_panel_objectSpread(xy_config_panel_objectSpread({},state),{},{yRightTitle:value})),areTickLabelsVisible:tickLabelsVisibilitySettings.yRight,toggleTickLabelsVisibility:onTickLabelsVisibilitySettingsChange,areGridlinesVisible:gridlinesVisibilitySettings.yRight,toggleGridlinesVisibility:onGridlinesVisibilitySettingsChange,isDisabled:Object.keys(axisGroups.find(group=>group.groupId==="right")||{}).length===0,isAxisTitleVisible:axisTitlesVisibilitySettings.yRight,toggleAxisTitleVisibility:onAxisTitlesVisibilitySettingsChange})))))}const idPrefix=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])()();function xy_config_panel_DimensionEditor(props){var _layer$yConfig,_layer$yConfig$find;const state=props.state,setState=props.setState,layerId=props.layerId,accessor=props.accessor;const index=state.layers.findIndex(l=>l.layerId===layerId);const layer=state.layers[index];const isHorizontal=isHorizontalChart(state.layers);const axisMode=layer.yConfig&&((_layer$yConfig=layer.yConfig)===null||_layer$yConfig===void 0?void 0:(_layer$yConfig$find=_layer$yConfig.find(yAxisConfig=>yAxisConfig.forAccessor===accessor))===null||_layer$yConfig$find===void 0?void 0:_layer$yConfig$find.axisMode)||"auto";if(props.groupId==="breakdown"){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(PalettePicker,{palettes:props.frame.availablePalettes,activePalette:layer.palette,setPalette:newPalette=>{setState(updateLayer(state,xy_config_panel_objectSpread(xy_config_panel_objectSpread({},layer),{},{palette:newPalette}),index))}}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ColorPicker,props),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"columnCompressed",fullWidth:true,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.axisSide.label",{defaultMessage:"Axis side"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{isFullWidth:true,legend:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.axisSide.label",{defaultMessage:"Axis side"}),name:"axisSide",buttonSize:"compressed",options:[{id:"".concat(idPrefix,"auto"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.axisSide.auto",{defaultMessage:"Auto"})},{id:"".concat(idPrefix,"left"),label:isHorizontal?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.axisSide.bottom",{defaultMessage:"Bottom"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.axisSide.left",{defaultMessage:"Left"})},{id:"".concat(idPrefix,"right"),label:isHorizontal?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.axisSide.top",{defaultMessage:"Top"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.axisSide.right",{defaultMessage:"Right"})}],idSelected:"".concat(idPrefix).concat(axisMode),onChange:id=>{const newMode=id.replace(idPrefix,"");const newYAxisConfigs=[...layer.yConfig||[]];const existingIndex=newYAxisConfigs.findIndex(yAxisConfig=>yAxisConfig.forAccessor===accessor);if(existingIndex!==-1){newYAxisConfigs[existingIndex].axisMode=newMode}else{newYAxisConfigs.push({forAccessor:accessor,axisMode:newMode})}setState(updateLayer(state,xy_config_panel_objectSpread(xy_config_panel_objectSpread({},layer),{},{yConfig:newYAxisConfigs}),index))}})))}const xy_config_panel_tooltipContent={auto:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.configPanel.color.tooltip.auto",{defaultMessage:"Lens automatically picks colors for you unless you specify a custom color."}),custom:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.configPanel.color.tooltip.custom",{defaultMessage:"Clear the custom color to return to “Auto” mode."}),disabled:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.configPanel.color.tooltip.disabled",{defaultMessage:"Individual series cannot be custom colored when the layer includes a “Break down by.“"})};const ColorPicker=({state:state,setState:setState,layerId:layerId,accessor:accessor})=>{const index=state.layers.findIndex(l=>l.layerId===layerId);const layer=state.layers[index];const disabled=!!layer.splitAccessor;const _useState=Object(external_kbnSharedDeps_React_["useState"])(getSeriesColor(layer,accessor)),_useState2=xy_config_panel_slicedToArray(_useState,2),color=_useState2[0],setColor=_useState2[1];const handleColor=(text,output)=>{setColor(text);if(output.isValid||text===""){updateColorInState(text,output)}};const updateColorInState=external_kbnSharedDeps_React_default.a.useMemo(()=>Object(external_kbnSharedDeps_Lodash_["debounce"])((text,output)=>{const newYConfigs=[...layer.yConfig||[]];const existingIndex=newYConfigs.findIndex(yConfig=>yConfig.forAccessor===accessor);if(existingIndex!==-1){if(text===""){delete newYConfigs[existingIndex].color}else{newYConfigs[existingIndex].color=output.hex}}else{newYConfigs.push({forAccessor:accessor,color:output.hex})}setState(updateLayer(state,xy_config_panel_objectSpread(xy_config_panel_objectSpread({},layer),{},{yConfig:newYConfigs}),index))},256),[state,setState,layer,accessor,index]);const colorPicker=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiColorPicker"],{"data-test-subj":"indexPattern-dimension-colorPicker",compressed:true,isClearable:true,onChange:handleColor,color:disabled?"":color,disabled:disabled,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.seriesColor.auto",{defaultMessage:"Auto"}),"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.seriesColor.label",{defaultMessage:"Series color"})});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"columnCompressed",fullWidth:true,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{delay:"long",position:"top",content:color&&!disabled?xy_config_panel_tooltipContent.custom:xy_config_panel_tooltipContent.auto},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.seriesColor.label",{defaultMessage:"Series color"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"questionInCircle",color:"subdued",size:"s",className:"eui-alignTop"})))},disabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:xy_config_panel_tooltipContent.disabled,delay:"long",anchorClassName:"eui-displayBlock"},colorPicker):colorPicker)};function xy_visualization_to_expression_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function xy_visualization_to_expression_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){xy_visualization_to_expression_ownKeys(Object(source),true).forEach((function(key){xy_visualization_to_expression_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{xy_visualization_to_expression_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function xy_visualization_to_expression_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const getSortedAccessors=(datasource,layer)=>{const originalOrder=datasource.getTableSpec().map(({columnId:columnId})=>columnId).filter(columnId=>layer.accessors.includes(columnId));return Array.from(new Set(originalOrder.concat(layer.accessors)))};const xy_visualization_to_expression_toExpression=(state,datasourceLayers,paletteService,attributes={})=>{if(!state||!state.layers.length){return null}const metadata={};state.layers.forEach(layer=>{metadata[layer.layerId]={};const datasource=datasourceLayers[layer.layerId];datasource.getTableSpec().forEach(column=>{const operation=datasourceLayers[layer.layerId].getOperationForColumnId(column.columnId);metadata[layer.layerId][column.columnId]=operation})});return buildExpression(state,metadata,datasourceLayers,paletteService,attributes)};function to_expression_toPreviewExpression(state,datasourceLayers,paletteService){return xy_visualization_to_expression_toExpression(xy_visualization_to_expression_objectSpread(xy_visualization_to_expression_objectSpread({},state),{},{layers:state.layers.map(layer=>xy_visualization_to_expression_objectSpread(xy_visualization_to_expression_objectSpread({},layer),{},{hide:true})),legend:xy_visualization_to_expression_objectSpread(xy_visualization_to_expression_objectSpread({},state.legend),{},{isVisible:false}),valueLabels:"hide"}),datasourceLayers,paletteService,{})}function getScaleType(metadata,defaultScale){if(!metadata){return defaultScale}if(metadata.scale==="ordinal"){return external_kbnSharedDeps_ElasticCharts_["ScaleType"].Ordinal}if(metadata.scale==="interval"||metadata.scale==="ratio"){return metadata.dataType==="date"?external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear}switch(metadata.dataType){case"boolean":case"string":case"ip":return external_kbnSharedDeps_ElasticCharts_["ScaleType"].Ordinal;case"date":return external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time;default:return external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear}}const buildExpression=(state,metadata,datasourceLayers,paletteService,attributes={})=>{var _state$axisTitlesVisi,_state$axisTitlesVisi2,_state$axisTitlesVisi3,_state$axisTitlesVisi4,_state$axisTitlesVisi5,_state$axisTitlesVisi6,_state$tickLabelsVisi,_state$tickLabelsVisi2,_state$tickLabelsVisi3,_state$tickLabelsVisi4,_state$tickLabelsVisi5,_state$tickLabelsVisi6,_state$gridlinesVisib,_state$gridlinesVisib2,_state$gridlinesVisib3,_state$gridlinesVisib4,_state$gridlinesVisib5,_state$gridlinesVisib6;const validLayers=state.layers.filter(layer=>Boolean(layer.accessors.length)).map(layer=>{if(!datasourceLayers){return layer}const sortedAccessors=getSortedAccessors(datasourceLayers[layer.layerId],layer);return xy_visualization_to_expression_objectSpread(xy_visualization_to_expression_objectSpread({},layer),{},{accessors:sortedAccessors})});if(!validLayers.length){return null}return{type:"expression",chain:[{type:"function",function:"lens_xy_chart",arguments:{title:[(attributes===null||attributes===void 0?void 0:attributes.title)||""],description:[(attributes===null||attributes===void 0?void 0:attributes.description)||""],xTitle:[state.xTitle||""],yTitle:[state.yTitle||""],yRightTitle:[state.yRightTitle||""],legend:[{type:"expression",chain:[{type:"function",function:"lens_xy_legendConfig",arguments:{isVisible:[state.legend.isVisible],showSingleSeries:state.legend.showSingleSeries?[state.legend.showSingleSeries]:[],position:[state.legend.position]}}]}],fittingFunction:[state.fittingFunction||"None"],axisTitlesVisibilitySettings:[{type:"expression",chain:[{type:"function",function:"lens_xy_axisTitlesVisibilityConfig",arguments:{x:[(_state$axisTitlesVisi=state===null||state===void 0?void 0:(_state$axisTitlesVisi2=state.axisTitlesVisibilitySettings)===null||_state$axisTitlesVisi2===void 0?void 0:_state$axisTitlesVisi2.x)!==null&&_state$axisTitlesVisi!==void 0?_state$axisTitlesVisi:true],yLeft:[(_state$axisTitlesVisi3=state===null||state===void 0?void 0:(_state$axisTitlesVisi4=state.axisTitlesVisibilitySettings)===null||_state$axisTitlesVisi4===void 0?void 0:_state$axisTitlesVisi4.yLeft)!==null&&_state$axisTitlesVisi3!==void 0?_state$axisTitlesVisi3:true],yRight:[(_state$axisTitlesVisi5=state===null||state===void 0?void 0:(_state$axisTitlesVisi6=state.axisTitlesVisibilitySettings)===null||_state$axisTitlesVisi6===void 0?void 0:_state$axisTitlesVisi6.yRight)!==null&&_state$axisTitlesVisi5!==void 0?_state$axisTitlesVisi5:true]}}]}],tickLabelsVisibilitySettings:[{type:"expression",chain:[{type:"function",function:"lens_xy_tickLabelsConfig",arguments:{x:[(_state$tickLabelsVisi=state===null||state===void 0?void 0:(_state$tickLabelsVisi2=state.tickLabelsVisibilitySettings)===null||_state$tickLabelsVisi2===void 0?void 0:_state$tickLabelsVisi2.x)!==null&&_state$tickLabelsVisi!==void 0?_state$tickLabelsVisi:true],yLeft:[(_state$tickLabelsVisi3=state===null||state===void 0?void 0:(_state$tickLabelsVisi4=state.tickLabelsVisibilitySettings)===null||_state$tickLabelsVisi4===void 0?void 0:_state$tickLabelsVisi4.yLeft)!==null&&_state$tickLabelsVisi3!==void 0?_state$tickLabelsVisi3:true],yRight:[(_state$tickLabelsVisi5=state===null||state===void 0?void 0:(_state$tickLabelsVisi6=state.tickLabelsVisibilitySettings)===null||_state$tickLabelsVisi6===void 0?void 0:_state$tickLabelsVisi6.yRight)!==null&&_state$tickLabelsVisi5!==void 0?_state$tickLabelsVisi5:true]}}]}],gridlinesVisibilitySettings:[{type:"expression",chain:[{type:"function",function:"lens_xy_gridlinesConfig",arguments:{x:[(_state$gridlinesVisib=state===null||state===void 0?void 0:(_state$gridlinesVisib2=state.gridlinesVisibilitySettings)===null||_state$gridlinesVisib2===void 0?void 0:_state$gridlinesVisib2.x)!==null&&_state$gridlinesVisib!==void 0?_state$gridlinesVisib:true],yLeft:[(_state$gridlinesVisib3=state===null||state===void 0?void 0:(_state$gridlinesVisib4=state.gridlinesVisibilitySettings)===null||_state$gridlinesVisib4===void 0?void 0:_state$gridlinesVisib4.yLeft)!==null&&_state$gridlinesVisib3!==void 0?_state$gridlinesVisib3:true],yRight:[(_state$gridlinesVisib5=state===null||state===void 0?void 0:(_state$gridlinesVisib6=state.gridlinesVisibilitySettings)===null||_state$gridlinesVisib6===void 0?void 0:_state$gridlinesVisib6.yRight)!==null&&_state$gridlinesVisib5!==void 0?_state$gridlinesVisib5:true]}}]}],valueLabels:[(state===null||state===void 0?void 0:state.valueLabels)||"hide"],layers:validLayers.map(layer=>{const columnToLabel=getColumnToLabelMap(layer,datasourceLayers[layer.layerId]);const xAxisOperation=datasourceLayers&&datasourceLayers[layer.layerId].getOperationForColumnId(layer.xAccessor);const isHistogramDimension=Boolean(xAxisOperation&&xAxisOperation.isBucketed&&xAxisOperation.scale&&xAxisOperation.scale!=="ordinal");return{type:"expression",chain:[{type:"function",function:"lens_xy_layer",arguments:xy_visualization_to_expression_objectSpread({layerId:[layer.layerId],hide:[Boolean(layer.hide)],xAccessor:layer.xAccessor?[layer.xAccessor]:[],yScaleType:[getScaleType(metadata[layer.layerId][layer.accessors[0]],external_kbnSharedDeps_ElasticCharts_["ScaleType"].Ordinal)],xScaleType:[getScaleType(metadata[layer.layerId][layer.xAccessor],external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear)],isHistogram:[isHistogramDimension],splitAccessor:layer.splitAccessor?[layer.splitAccessor]:[],yConfig:layer.yConfig?layer.yConfig.map(yConfig=>({type:"expression",chain:[{type:"function",function:"lens_xy_yConfig",arguments:{forAccessor:[yConfig.forAccessor],axisMode:yConfig.axisMode?[yConfig.axisMode]:[],color:yConfig.color?[yConfig.color]:[]}}]})):[],seriesType:[layer.seriesType],accessors:layer.accessors,columnToLabel:[JSON.stringify(columnToLabel)]},layer.palette?{palette:[{type:"expression",chain:[{type:"function",function:"theme",arguments:{variable:["palette"],default:[paletteService.get(layer.palette.name).toExpression(layer.palette.params)]}}]}]}:{})}]}})}}]}};function chart_mixed_xy_extends(){chart_mixed_xy_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return chart_mixed_xy_extends.apply(this,arguments)}function chart_mixed_xy_objectWithoutProperties(source,excluded){if(source==null)return{};var target=chart_mixed_xy_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function chart_mixed_xy_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const LensIconChartMixedXy=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=chart_mixed_xy_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_default.a.createElement("svg",chart_mixed_xy_extends({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_default.a.createElement("title",{id:titleId},title):null,external_kbnSharedDeps_React_default.a.createElement("path",{d:"M24 16l.186-.002.345-.02.266-.03.334-.058.193-.043.25-.067.223-.07.215-.074.209-.079.305-.124c.166-.07.34-.148.524-.234l.285-.135 1.202-.588c.428-.203.728-.326.966-.396.146-.044.27-.067.384-.076L30 14v7a1 1 0 01-1 1H1a1 1 0 01-1-1v-2c1 0 3.5-4 6-4s5 3 6 3 3.23-7.994 5.865-7.997L19.032 10l.541 1.205.272.595.29.612c.517 1.069.955 1.842 1.391 2.391.08.1.16.194.241.28.095.101.189.191.283.272l.143.114c.218.164.446.284.69.368.207.071.426.116.662.14l.14.012.154.008L24 16zm6-12v6l-.186.002-.345.02-.266.03-.331.057-.196.044-.25.067-.304.097-.134.047a9.492 9.492 0 00-.386.15l-.128.053c-.166.07-.34.148-.524.234l-.285.135-1.264.618-.352.159-.187.078-.256.095-.178.054a13.872 13.872 0 01-.38-.687l-.16-.311-.233-.47-.016-.472H24c1 0 3-6 6-6z",className:"lensChartIcon__accent"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M30 13c-.507 0-.988.146-1.89.571l-1.209.592C25.621 14.78 24.924 15 24 15c-1.384 0-2.003-.865-3.516-4.206l-.637-1.42-.346-.749-.213-.445C18.572 6.698 18.127 6 18 6c-.466 0-.967.252-1.99.997l-.891.659-.458.325C13.576 8.728 12.907 9 12 9c-1.269 0-1.966-.69-3.492-2.939l-.774-1.146-.272-.387-.26-.358C6.581 3.342 6.213 3 6 3c-.294 0-.885.651-2.017 2.33l-.491.731-.326.475C1.859 8.409 1.175 9 0 9V7c.294 0 .885-.651 2.017-2.33l.491-.731.326-.475C4.141 1.591 4.825 1 6 1c1.269 0 1.966.69 3.492 2.939l.774 1.146.272.387.26.358C11.419 6.658 11.788 7 12 7c.466 0 .967-.252 1.99-.997l.891-.659.458-.325C16.424 4.272 17.093 4 18 4c1.384 0 2.003.865 3.516 4.206l.637 1.42.346.749.213.445C23.428 12.302 23.873 13 24 13c.507 0 .988-.146 1.89-.571l1.209-.592C28.379 11.22 29.076 11 30 11v2z",className:"lensChartIcon__subdued"}),external_kbnSharedDeps_React_default.a.createElement("path",{d:"M6 13v7.889C6 21.503 5.552 22 5 22H1c-.552 0-1-.497-1-1.111V13a1 1 0 011-1h4a1 1 0 011 1zm8-1v9a1 1 0 01-1 1H9a1 1 0 01-1-1v-9a1 1 0 011-1h4a1 1 0 011 1zm8 5v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4a1 1 0 011-1h4a1 1 0 011 1zm8 2v2a1 1 0 01-1 1h-4a1 1 0 01-1-1v-2a1 1 0 011-1h4a1 1 0 011 1z",className:"lensChartIcon__subdued"}))};function xy_visualization_visualization_slicedToArray(arr,i){return xy_visualization_visualization_arrayWithHoles(arr)||xy_visualization_visualization_iterableToArrayLimit(arr,i)||xy_visualization_visualization_unsupportedIterableToArray(arr,i)||xy_visualization_visualization_nonIterableRest()}function xy_visualization_visualization_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xy_visualization_visualization_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return xy_visualization_visualization_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xy_visualization_visualization_arrayLikeToArray(o,minLen)}function xy_visualization_visualization_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function xy_visualization_visualization_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function xy_visualization_visualization_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function xy_visualization_visualization_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function xy_visualization_visualization_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){xy_visualization_visualization_ownKeys(Object(source),true).forEach((function(key){xy_visualization_visualization_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{xy_visualization_visualization_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function xy_visualization_visualization_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const defaultIcon=LensIconChartBarStacked;const defaultSeriesType="bar_stacked";const isNumericMetric=op=>!op.isBucketed&&op.dataType==="number";const visualization_isBucketed=op=>op.isBucketed;function getVisualizationType(state){if(!state.layers.length){var _visualizationTypes$f;return(_visualizationTypes$f=types_visualizationTypes.find(t=>t.id===state.preferredSeriesType))!==null&&_visualizationTypes$f!==void 0?_visualizationTypes$f:types_visualizationTypes[0]}const visualizationType=types_visualizationTypes.find(t=>t.id===state.layers[0].seriesType);const seriesTypes=external_kbnSharedDeps_Lodash_default.a.uniq(state.layers.map(l=>l.seriesType));return visualizationType&&seriesTypes.length===1?visualizationType:"mixed"}function getDescription(state){if(!state){return{icon:defaultIcon,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.xyLabel",{defaultMessage:"XY"})}}const visualizationType=getVisualizationType(state);if(visualizationType==="mixed"&&isHorizontalChart(state.layers)){return{icon:LensIconChartBarHorizontal,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.mixedBarHorizontalLabel",{defaultMessage:"Mixed H. bar"})}}if(visualizationType==="mixed"){return{icon:LensIconChartMixedXy,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.mixedLabel",{defaultMessage:"Mixed XY"})}}return{icon:visualizationType.icon,label:visualizationType.label}}const getXyVisualization=({paletteService:paletteService,data:data})=>({id:"lnsXY",visualizationTypes:types_visualizationTypes,getVisualizationTypeId(state){const type=getVisualizationType(state);return type==="mixed"?type:type.id},getLayerIds(state){return state.layers.map(l=>l.layerId)},removeLayer(state,layerId){return xy_visualization_visualization_objectSpread(xy_visualization_visualization_objectSpread({},state),{},{layers:state.layers.filter(l=>l.layerId!==layerId)})},appendLayer(state,layerId){const usedSeriesTypes=external_kbnSharedDeps_Lodash_default.a.uniq(state.layers.map(layer=>layer.seriesType));return xy_visualization_visualization_objectSpread(xy_visualization_visualization_objectSpread({},state),{},{layers:[...state.layers,xy_visualization_visualization_newLayerState(usedSeriesTypes.length===1?usedSeriesTypes[0]:state.preferredSeriesType,layerId)]})},clearLayer(state,layerId){return xy_visualization_visualization_objectSpread(xy_visualization_visualization_objectSpread({},state),{},{layers:state.layers.map(l=>l.layerId!==layerId?l:xy_visualization_visualization_newLayerState(state.preferredSeriesType,layerId))})},getDescription(state){const _getDescription=getDescription(state),icon=_getDescription.icon,label=_getDescription.label;return{icon:icon||defaultIcon,label:label}},switchVisualizationType(seriesType,state){return xy_visualization_visualization_objectSpread(xy_visualization_visualization_objectSpread({},state),{},{preferredSeriesType:seriesType,layers:state.layers.map(layer=>xy_visualization_visualization_objectSpread(xy_visualization_visualization_objectSpread({},layer),{},{seriesType:seriesType}))})},getSuggestions:xy_suggestions_getSuggestions,initialize(frame,state){return state||{title:"Empty XY chart",legend:{isVisible:true,position:external_kbnSharedDeps_ElasticCharts_["Position"].Right},valueLabels:"hide",preferredSeriesType:defaultSeriesType,layers:[{layerId:frame.addNewLayer(),accessors:[],position:external_kbnSharedDeps_ElasticCharts_["Position"].Top,seriesType:defaultSeriesType,showGridlines:false}]}},getConfiguration({state:state,frame:frame,layerId:layerId}){var _layer$palette,_layer$palette2;const layer=state.layers.find(l=>l.layerId===layerId);if(!layer){return{groups:[]}}const datasource=frame.datasourceLayers[layer.layerId];const sortedAccessors=getSortedAccessors(datasource,layer);let mappedAccessors=sortedAccessors.map(accessor=>({columnId:accessor}));if(frame.activeData){const colorAssignments=getColorAssignments(state.layers,{tables:frame.activeData},data.fieldFormats.deserialize);mappedAccessors=getAccessorColorConfig(colorAssignments,frame,layer,sortedAccessors,paletteService)}const isHorizontal=isHorizontalChart(state.layers);return{groups:[{groupId:"x",groupLabel:getAxisName("x",{isHorizontal:isHorizontal}),accessors:layer.xAccessor?[{columnId:layer.xAccessor}]:[],filterOperations:visualization_isBucketed,supportsMoreColumns:!layer.xAccessor,dataTestSubj:"lnsXY_xDimensionPanel"},{groupId:"y",groupLabel:getAxisName("y",{isHorizontal:isHorizontal}),accessors:mappedAccessors,filterOperations:isNumericMetric,supportsMoreColumns:true,required:true,dataTestSubj:"lnsXY_yDimensionPanel",enableDimensionEditor:true},{groupId:"breakdown",groupLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.splitSeries",{defaultMessage:"Break down by"}),accessors:layer.splitAccessor?[{columnId:layer.splitAccessor,triggerIcon:"colorBy",palette:paletteService.get(((_layer$palette=layer.palette)===null||_layer$palette===void 0?void 0:_layer$palette.name)||"default").getColors(10,(_layer$palette2=layer.palette)===null||_layer$palette2===void 0?void 0:_layer$palette2.params)}]:[],filterOperations:visualization_isBucketed,supportsMoreColumns:!layer.splitAccessor,dataTestSubj:"lnsXY_splitDimensionPanel",required:layer.seriesType.includes("percentage"),enableDimensionEditor:true}]}},getMainPalette:state=>{if(!state||state.layers.length===0)return;return state.layers[0].palette},setDimension({prevState:prevState,layerId:layerId,columnId:columnId,groupId:groupId}){const newLayer=prevState.layers.find(l=>l.layerId===layerId);if(!newLayer){return prevState}if(groupId==="x"){newLayer.xAccessor=columnId}if(groupId==="y"){newLayer.accessors=[...newLayer.accessors.filter(a=>a!==columnId),columnId]}if(groupId==="breakdown"){newLayer.splitAccessor=columnId}return xy_visualization_visualization_objectSpread(xy_visualization_visualization_objectSpread({},prevState),{},{layers:prevState.layers.map(l=>l.layerId===layerId?newLayer:l)})},removeDimension({prevState:prevState,layerId:layerId,columnId:columnId}){const newLayer=prevState.layers.find(l=>l.layerId===layerId);if(!newLayer){return prevState}if(newLayer.xAccessor===columnId){delete newLayer.xAccessor}else if(newLayer.splitAccessor===columnId){delete newLayer.splitAccessor;delete newLayer.palette}else if(newLayer.accessors.includes(columnId)){newLayer.accessors=newLayer.accessors.filter(a=>a!==columnId)}if(newLayer.yConfig){newLayer.yConfig=newLayer.yConfig.filter(({forAccessor:forAccessor})=>forAccessor!==columnId)}return xy_visualization_visualization_objectSpread(xy_visualization_visualization_objectSpread({},prevState),{},{layers:prevState.layers.map(l=>l.layerId===layerId?newLayer:l)})},getLayerContextMenuIcon({state:state,layerId:layerId}){var _visualizationTypes$f2;const layer=state.layers.find(l=>l.layerId===layerId);return(_visualizationTypes$f2=types_visualizationTypes.find(t=>t.id===(layer===null||layer===void 0?void 0:layer.seriesType)))===null||_visualizationTypes$f2===void 0?void 0:_visualizationTypes$f2.icon},renderLayerContextMenu(domElement,props){Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(LayerContextMenu,props)),domElement)},renderToolbar(domElement,props){Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(XyToolbar,props)),domElement)},renderDimensionEditor(domElement,props){Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(xy_config_panel_DimensionEditor,props)),domElement)},toExpression:(state,layers,attributes)=>xy_visualization_to_expression_toExpression(state,layers,paletteService,attributes),toPreviewExpression:(state,layers)=>to_expression_toPreviewExpression(state,layers,paletteService),getErrorMessages(state,frame){const hasNoAccessors=({accessors:accessors})=>accessors==null||accessors.length===0;const hasNoSplitAccessor=({splitAccessor:splitAccessor,seriesType:seriesType})=>seriesType.includes("percentage")&&splitAccessor==null;const errors=[];if(state&&state.layers.length>1){const checks=[["Y",hasNoAccessors],["Break down",hasNoSplitAccessor]];const filteredLayers=state.layers.filter(({accessors:accessors,xAccessor:xAccessor,splitAccessor:splitAccessor})=>accessors.length>0||xAccessor!=null||splitAccessor!=null);for(var _i=0,_checks=checks;_i<_checks.length;_i++){const _checks$_i=xy_visualization_visualization_slicedToArray(_checks[_i],2),dimension=_checks$_i[0],criteria=_checks$_i[1];const result=validateLayersForDimension(dimension,filteredLayers,criteria);if(!result.valid){errors.push(result.payload)}}}return errors.length?errors:undefined}});function getAccessorColorConfig(colorAssignments,frame,layer,sortedAccessors,paletteService){const layerContainsSplits=Boolean(layer.splitAccessor);const currentPalette=layer.palette||{type:"palette",name:"default"};const totalSeriesCount=colorAssignments[currentPalette.name].totalSeriesCount;return sortedAccessors.map(accessor=>{var _layer$yConfig;const currentYConfig=(_layer$yConfig=layer.yConfig)===null||_layer$yConfig===void 0?void 0:_layer$yConfig.find(yConfig=>yConfig.forAccessor===accessor);if(layerContainsSplits){return{columnId:accessor,triggerIcon:"disabled"}}const columnToLabel=getColumnToLabelMap(layer,frame.datasourceLayers[layer.layerId]);const rank=colorAssignments[currentPalette.name].getRank(layer,columnToLabel[accessor]||accessor,accessor);const customColor=(currentYConfig===null||currentYConfig===void 0?void 0:currentYConfig.color)||paletteService.get(currentPalette.name).getColor([{name:columnToLabel[accessor]||accessor,rankAtDepth:rank,totalSeriesAtDepth:totalSeriesCount}],{maxDepth:1,totalSeries:totalSeriesCount},currentPalette.params);return{columnId:accessor,triggerIcon:customColor?"color":"disabled",color:customColor?customColor:undefined}})}function validateLayersForDimension(dimension,layers,missingCriteria){if(layers.every(missingCriteria)||!layers.some(missingCriteria)){return{valid:true}}const layerMissingAccessors=layers.reduce((missing,layer,i)=>{if(missingCriteria(layer)){missing.push(i)}return missing},[]);return{valid:false,payload:getMessageIdsForDimension(dimension,layerMissingAccessors,isHorizontalChart(layers))}}function getAxisName(axis,{isHorizontal:isHorizontal}){const vertical=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.verticalAxisLabel",{defaultMessage:"Vertical axis"});const horizontal=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.horizontalAxisLabel",{defaultMessage:"Horizontal axis"});if(axis==="x"){return isHorizontal?vertical:horizontal}return isHorizontal?horizontal:vertical}function getMessageIdsForDimension(dimension,layers,isHorizontal){const layersList=layers.map(i=>i+1).join(", ");switch(dimension){case"Break down":return{shortMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.dataFailureSplitShort",{defaultMessage:"Missing {axis}.",values:{axis:"Break down by axis"}}),longMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.dataFailureSplitLong",{defaultMessage:"{layers, plural, one {Layer} other {Layers}} {layersList} {layers, plural, one {requires} other {require}} a field for the {axis}.",values:{layers:layers.length,layersList:layersList,axis:"Break down by axis"}})};case"Y":return{shortMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.dataFailureYShort",{defaultMessage:"Missing {axis}.",values:{axis:getAxisName("y",{isHorizontal:isHorizontal})}}),longMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyVisualization.dataFailureYLong",{defaultMessage:"{layers, plural, one {Layer} other {Layers}} {layersList} {layers, plural, one {requires} other {require}} a field for the {axis}.",values:{layers:layers.length,layersList:layersList,axis:getAxisName("y",{isHorizontal:isHorizontal})}})}}return{shortMessage:"",longMessage:""}}function xy_visualization_visualization_newLayerState(seriesType,layerId){return{layerId:layerId,seriesType:seriesType,accessors:[]}}function state_helpers_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function state_helpers_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){state_helpers_ownKeys(Object(source),true).forEach((function(key){state_helpers_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{state_helpers_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function state_helpers_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function mergeLayer({state:state,layerId:layerId,newLayer:newLayer}){return state_helpers_objectSpread(state_helpers_objectSpread({},state),{},{layers:state_helpers_objectSpread(state_helpers_objectSpread({},state.layers),{},{[layerId]:state_helpers_objectSpread(state_helpers_objectSpread({},state.layers[layerId]),newLayer)})})}var v4=__webpack_require__(117);var v4_default=__webpack_require__.n(v4);function generateId(){return v4_default()()}function layer_helpers_slicedToArray(arr,i){return layer_helpers_arrayWithHoles(arr)||layer_helpers_iterableToArrayLimit(arr,i)||layer_helpers_unsupportedIterableToArray(arr,i)||layer_helpers_nonIterableRest()}function layer_helpers_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function layer_helpers_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return layer_helpers_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return layer_helpers_arrayLikeToArray(o,minLen)}function layer_helpers_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function layer_helpers_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function layer_helpers_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function layer_helpers_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function layer_helpers_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){layer_helpers_ownKeys(Object(source),true).forEach((function(key){layer_helpers_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{layer_helpers_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function layer_helpers_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function insertOrReplaceColumn(args){if(args.layer.columns[args.columnId]){return replaceColumn(args)}return insertNewColumn(args)}function insertNewColumn({op:op,layer:layer,columnId:columnId,field:field,indexPattern:indexPattern}){const operationDefinition=operationDefinitionMap[op];if(!operationDefinition){throw new Error("No suitable operation found for given parameters")}if(layer.columns[columnId]){throw new Error("Can't insert a column with an ID that is already in use")}const baseOptions={indexPattern:indexPattern,previousColumn:layer.columns[columnId]};if(operationDefinition.input==="none"){if(field){throw new Error("Can't create operation ".concat(op," with the provided field ").concat(field.name))}const possibleOperation=operationDefinition.getPossibleOperation();const isBucketed=Boolean(possibleOperation.isBucketed);if(isBucketed){return addBucket(layer,operationDefinition.buildColumn(layer_helpers_objectSpread(layer_helpers_objectSpread({},baseOptions),{},{layer:layer})),columnId)}else{return addMetric(layer,operationDefinition.buildColumn(layer_helpers_objectSpread(layer_helpers_objectSpread({},baseOptions),{},{layer:layer})),columnId)}}if(operationDefinition.input==="fullReference"){if(field){throw new Error("Reference-based operations can't take a field as input when creating")}let tempLayer=layer_helpers_objectSpread({},layer);const referenceIds=operationDefinition.requiredReferences.map(validation=>{const validOperations=Object.values(operationDefinitionMap).filter(({type:type})=>isOperationAllowedAsReference({validation:validation,operationType:type}));if(!validOperations.length){throw new Error("Can't create reference, ".concat(op," has a validation function which doesn't allow any operations"))}const newId=generateId();if(validOperations.length===1){const def=validOperations[0];const validFields=def.input==="field"?indexPattern.fields.filter(def.getPossibleOperationForField):[];if(def.input==="none"){tempLayer=insertNewColumn({layer:tempLayer,columnId:newId,op:def.type,indexPattern:indexPattern})}else if(validFields.length===1){tempLayer=insertNewColumn({layer:tempLayer,columnId:newId,op:def.type,indexPattern:indexPattern,field:validFields[0]})}else{tempLayer=layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer),{},{incompleteColumns:layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer.incompleteColumns),{},{[newId]:{operationType:def.type}})})}}return newId});const possibleOperation=operationDefinition.getPossibleOperation();const isBucketed=Boolean(possibleOperation.isBucketed);if(isBucketed){return addBucket(tempLayer,operationDefinition.buildColumn(layer_helpers_objectSpread(layer_helpers_objectSpread({},baseOptions),{},{layer:tempLayer,referenceIds:referenceIds})),columnId)}else{return addMetric(tempLayer,operationDefinition.buildColumn(layer_helpers_objectSpread(layer_helpers_objectSpread({},baseOptions),{},{layer:tempLayer,referenceIds:referenceIds})),columnId)}}if(!field){throw new Error("Invariant error: ".concat(operationDefinition.type," operation requires field"))}const possibleOperation=operationDefinition.getPossibleOperationForField(field);if(!possibleOperation){throw new Error("Tried to create an invalid operation ".concat(operationDefinition.type," on ").concat(field.name))}const isBucketed=Boolean(possibleOperation.isBucketed);if(isBucketed){return addBucket(layer,operationDefinition.buildColumn(layer_helpers_objectSpread(layer_helpers_objectSpread({},baseOptions),{},{layer:layer,field:field})),columnId)}else{return addMetric(layer,operationDefinition.buildColumn(layer_helpers_objectSpread(layer_helpers_objectSpread({},baseOptions),{},{layer:layer,field:field})),columnId)}}function replaceColumn({layer:layer,columnId:columnId,indexPattern:indexPattern,op:op,field:field}){const previousColumn=layer.columns[columnId];if(!previousColumn){throw new Error("Can't replace column because there is no prior column")}const isNewOperation=op!==previousColumn.operationType;const operationDefinition=operationDefinitionMap[op];const previousDefinition=operationDefinitionMap[previousColumn.operationType];if(!operationDefinition){throw new Error("No suitable operation found for given parameters")}const baseOptions={columns:layer.columns,indexPattern:indexPattern,previousColumn:previousColumn};if(isNewOperation){let tempLayer=layer_helpers_objectSpread({},layer);if(previousDefinition.input==="fullReference"){previousColumn.references.forEach(id=>{tempLayer=deleteColumn({layer:tempLayer,columnId:id})})}if(operationDefinition.input==="fullReference"){const referenceIds=operationDefinition.requiredReferences.map(()=>generateId());const incompleteColumns=layer_helpers_objectSpread({},tempLayer.incompleteColumns||{});delete incompleteColumns[columnId];const newColumns=layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer.columns),{},{[columnId]:operationDefinition.buildColumn(layer_helpers_objectSpread(layer_helpers_objectSpread({},baseOptions),{},{layer:tempLayer,referenceIds:referenceIds,previousColumn:previousColumn}))});return layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer),{},{columnOrder:getColumnOrder(layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer),{},{columns:newColumns})),columns:newColumns,incompleteColumns:incompleteColumns})}if(operationDefinition.input==="none"){const newColumn=operationDefinition.buildColumn(layer_helpers_objectSpread(layer_helpers_objectSpread({},baseOptions),{},{layer:tempLayer}));if(previousColumn.customLabel){newColumn.customLabel=true;newColumn.label=previousColumn.label}const newColumns=layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer.columns),{},{[columnId]:newColumn});return layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer),{},{columnOrder:getColumnOrder(layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer),{},{columns:newColumns})),columns:adjustColumnReferencesForChangedColumn(newColumns,columnId)})}if(!field){throw new Error("Invariant error: ".concat(operationDefinition.type," operation requires field"))}const newColumn=operationDefinition.buildColumn(layer_helpers_objectSpread(layer_helpers_objectSpread({},baseOptions),{},{layer:tempLayer,field:field}));if(previousColumn.customLabel){newColumn.customLabel=true;newColumn.label=previousColumn.label}const newColumns=layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer.columns),{},{[columnId]:newColumn});return layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer),{},{columnOrder:getColumnOrder(layer_helpers_objectSpread(layer_helpers_objectSpread({},tempLayer),{},{columns:newColumns})),columns:adjustColumnReferencesForChangedColumn(newColumns,columnId)})}else if(operationDefinition.input==="field"&&field&&"sourceField"in previousColumn&&previousColumn.sourceField!==field.name){const newColumn=operationDefinition.onFieldChange(previousColumn,field);if(previousColumn.customLabel){newColumn.customLabel=true;newColumn.label=previousColumn.label}const newColumns=layer_helpers_objectSpread(layer_helpers_objectSpread({},layer.columns),{},{[columnId]:newColumn});return layer_helpers_objectSpread(layer_helpers_objectSpread({},layer),{},{columnOrder:getColumnOrder(layer_helpers_objectSpread(layer_helpers_objectSpread({},layer),{},{columns:newColumns})),columns:adjustColumnReferencesForChangedColumn(newColumns,columnId)})}else{throw new Error("nothing changed")}}function addBucket(layer,column,addedColumnId){const _separateBucketColumn=separateBucketColumns(layer),_separateBucketColumn2=layer_helpers_slicedToArray(_separateBucketColumn,2),buckets=_separateBucketColumn2[0],metrics=_separateBucketColumn2[1];const oldDateHistogramIndex=layer.columnOrder.findIndex(columnId=>layer.columns[columnId].operationType==="date_histogram");let updatedColumnOrder=[];if(oldDateHistogramIndex>-1&&column.operationType==="terms"){updatedColumnOrder=[...buckets.slice(0,oldDateHistogramIndex),addedColumnId,...buckets.slice(oldDateHistogramIndex,buckets.length),...metrics]}else{updatedColumnOrder=[...buckets,addedColumnId,...metrics]}return layer_helpers_objectSpread(layer_helpers_objectSpread({},layer),{},{columns:layer_helpers_objectSpread(layer_helpers_objectSpread({},layer.columns),{},{[addedColumnId]:column}),columnOrder:updatedColumnOrder})}function addMetric(layer,column,addedColumnId){return layer_helpers_objectSpread(layer_helpers_objectSpread({},layer),{},{columns:layer_helpers_objectSpread(layer_helpers_objectSpread({},layer.columns),{},{[addedColumnId]:column}),columnOrder:[...layer.columnOrder,addedColumnId]})}function separateBucketColumns(layer){return Object(external_kbnSharedDeps_Lodash_["partition"])(layer.columnOrder,columnId=>{var _layer$columns$column;return(_layer$columns$column=layer.columns[columnId])===null||_layer$columns$column===void 0?void 0:_layer$columns$column.isBucketed})}function getMetricOperationTypes(field){return operationDefinitions.sort(getSortScoreByPriority).filter(definition=>{if(definition.input!=="field")return;const metadata=definition.getPossibleOperationForField(field);return metadata&&!metadata.isBucketed&&metadata.dataType==="number"})}function updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:paramName,value:value}){const columnId=Object.entries(state.layers[layerId].columns).find(([_columnId,column])=>column===currentColumn)[0];const layer=state.layers[layerId];return mergeLayer({state:state,layerId:layerId,newLayer:{columns:layer_helpers_objectSpread(layer_helpers_objectSpread({},layer.columns),{},{[columnId]:layer_helpers_objectSpread(layer_helpers_objectSpread({},currentColumn),{},{params:layer_helpers_objectSpread(layer_helpers_objectSpread({},currentColumn.params),{},{[paramName]:value})})})}})}function adjustColumnReferencesForChangedColumn(columns,columnId){const newColumns=layer_helpers_objectSpread({},columns);Object.keys(newColumns).forEach(currentColumnId=>{if(currentColumnId!==columnId){const currentColumn=newColumns[currentColumnId];const operationDefinition=operationDefinitionMap[currentColumn.operationType];newColumns[currentColumnId]=operationDefinition.onOtherColumnChanged?operationDefinition.onOtherColumnChanged(currentColumn,newColumns):currentColumn}});return newColumns}function deleteColumn({layer:layer,columnId:columnId}){const column=layer.columns[columnId];if(!column){const newIncomplete=layer_helpers_objectSpread({},layer.incompleteColumns||{});delete newIncomplete[columnId];return layer_helpers_objectSpread(layer_helpers_objectSpread({},layer),{},{columnOrder:layer.columnOrder.filter(id=>id!==columnId),incompleteColumns:newIncomplete})}const extraDeletions="references"in column?column.references:[];const hypotheticalColumns=layer_helpers_objectSpread({},layer.columns);delete hypotheticalColumns[columnId];let newLayer=layer_helpers_objectSpread(layer_helpers_objectSpread({},layer),{},{columns:adjustColumnReferencesForChangedColumn(hypotheticalColumns,columnId)});extraDeletions.forEach(id=>{newLayer=deleteColumn({layer:newLayer,columnId:id})});const newIncomplete=layer_helpers_objectSpread({},newLayer.incompleteColumns||{});delete newIncomplete[columnId];return layer_helpers_objectSpread(layer_helpers_objectSpread({},newLayer),{},{columnOrder:getColumnOrder(newLayer),incompleteColumns:newIncomplete})}function getColumnOrder(layer){const _$partition=external_kbnSharedDeps_Lodash_default.a.partition(Object.entries(layer.columns),([id,col])=>operationDefinitionMap[col.operationType].input!=="fullReference"),_$partition2=layer_helpers_slicedToArray(_$partition,2),direct=_$partition2[0],referenceBased=_$partition2[1];referenceBased.sort(([idA,a],[idB,b])=>{if("references"in a&&a.references.includes(idB)){return 1}if("references"in b&&b.references.includes(idA)){return-1}return 0});const _$partition3=external_kbnSharedDeps_Lodash_default.a.partition(direct,([,col])=>col.isBucketed),_$partition4=layer_helpers_slicedToArray(_$partition3,2),aggregations=_$partition4[0],metrics=_$partition4[1];return aggregations.map(([id])=>id).concat(metrics.map(([id])=>id)).concat(referenceBased.map(([id])=>id))}function isColumnTransferable(column,newIndexPattern){return operationDefinitionMap[column.operationType].isTransferable(column,newIndexPattern)}function updateLayerIndexPattern(layer,newIndexPattern){const keptColumns=external_kbnSharedDeps_Lodash_default.a.pickBy(layer.columns,column=>isColumnTransferable(column,newIndexPattern));const newColumns=external_kbnSharedDeps_Lodash_default.a.mapValues(keptColumns,column=>{const operationDefinition=operationDefinitionMap[column.operationType];return operationDefinition.transfer?operationDefinition.transfer(column,newIndexPattern):column});const newColumnOrder=layer.columnOrder.filter(columnId=>newColumns[columnId]);return layer_helpers_objectSpread(layer_helpers_objectSpread({},layer),{},{indexPatternId:newIndexPattern.id,columns:newColumns,columnOrder:newColumnOrder})}function getErrorMessages(layer){const errors=[];Object.entries(layer.columns).forEach(([columnId,column])=>{const def=operationDefinitionMap[column.operationType];if(def.input==="fullReference"&&def.getErrorMessage){var _def$getErrorMessage;errors.push(...(_def$getErrorMessage=def.getErrorMessage(layer,columnId))!==null&&_def$getErrorMessage!==void 0?_def$getErrorMessage:[])}if("references"in column){column.references.forEach((referenceId,index)=>{if(!layer.columns[referenceId]){errors.push(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.missingReferenceError",{defaultMessage:"Dimension {dimensionLabel} is incomplete",values:{dimensionLabel:column.label}}))}else{const referenceColumn=layer.columns[referenceId];const requirements=operationDefinitionMap[column.operationType].requiredReferences[index];const isValid=isColumnValidAsReference({validation:requirements,column:referenceColumn});if(!isValid){errors.push(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.invalidReferenceConfiguration",{defaultMessage:"Dimension {dimensionLabel} does not have a valid configuration",values:{dimensionLabel:column.label}}))}}})}});return errors.length?errors:undefined}function isReferenced(layer,columnId){const allReferences=Object.values(layer.columns).flatMap(col=>"references"in col?col.references:[]);return allReferences.includes(columnId)}function isColumnValidAsReference({column:column,validation:validation}){if(!column)return false;const operationType=column.operationType;const operationDefinition=operationDefinitionMap[operationType];return validation.input.includes(operationDefinition.input)&&(!validation.specificOperations||validation.specificOperations.includes(operationType))&&validation.validateMetadata(column)}function isOperationAllowedAsReference({operationType:operationType,validation:validation,field:field}){const operationDefinition=operationDefinitionMap[operationType];let hasValidMetadata=true;if(field&&operationDefinition.input==="field"){const metadata=operationDefinition.getPossibleOperationForField(field);hasValidMetadata=Boolean(metadata)&&validation.validateMetadata(metadata)}else if(operationDefinition.input!=="field"){const metadata=operationDefinition.getPossibleOperation();hasValidMetadata=Boolean(metadata)&&validation.validateMetadata(metadata)}else{}return validation.input.includes(operationDefinition.input)&&(!validation.specificOperations||validation.specificOperations.includes(operationType))&&hasValidMetadata}const useDebounceWithOptions=(fn,{skipFirstRender:skipFirstRender}={skipFirstRender:false},ms,deps)=>{const isFirstRender=Object(external_kbnSharedDeps_React_["useRef"])(true);const newDeps=[...deps||[],isFirstRender];return useDebounce_default()(()=>{if(skipFirstRender&&isFirstRender.current){isFirstRender.current=false;return}return fn()},ms,newDeps)};function values_range_input_slicedToArray(arr,i){return values_range_input_arrayWithHoles(arr)||values_range_input_iterableToArrayLimit(arr,i)||values_range_input_unsupportedIterableToArray(arr,i)||values_range_input_nonIterableRest()}function values_range_input_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function values_range_input_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return values_range_input_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return values_range_input_arrayLikeToArray(o,minLen)}function values_range_input_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function values_range_input_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function values_range_input_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ValuesRangeInput=({value:value,onChange:onChange})=>{const MIN_NUMBER_OF_VALUES=1;const MAX_NUMBER_OF_VALUES=100;const _useState=Object(external_kbnSharedDeps_React_["useState"])(String(value)),_useState2=values_range_input_slicedToArray(_useState,2),inputValue=_useState2[0],setInputValue=_useState2[1];useDebounceWithOptions(()=>{if(inputValue===""){return}const inputNumber=Number(inputValue);onChange(Math.min(MAX_NUMBER_OF_VALUES,Math.max(inputNumber,MIN_NUMBER_OF_VALUES)))},{skipFirstRender:true},256,[inputValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRange"],{min:MIN_NUMBER_OF_VALUES,max:MAX_NUMBER_OF_VALUES,step:1,value:inputValue,showInput:true,showLabels:true,compressed:true,onChange:({currentTarget:currentTarget})=>setInputValue(currentTarget.value),"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.size",{defaultMessage:"Number of values"})})};function terms_slicedToArray(arr,i){return terms_arrayWithHoles(arr)||terms_iterableToArrayLimit(arr,i)||terms_unsupportedIterableToArray(arr,i)||terms_nonIterableRest()}function terms_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function terms_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return terms_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return terms_arrayLikeToArray(o,minLen)}function terms_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function terms_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function terms_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function terms_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function terms_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){terms_ownKeys(Object(source),true).forEach((function(key){terms_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{terms_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function terms_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function ofName(name){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.termsOf",{defaultMessage:"Top values of {name}",values:{name:name}})}function isSortableByColumn(column){return!column.isBucketed}const DEFAULT_SIZE=3;const supportedTypes=new Set(["string","boolean","number","ip"]);const termsOperation={type:"terms",displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms",{defaultMessage:"Top values"}),priority:3,input:"field",getPossibleOperationForField:({aggregationRestrictions:aggregationRestrictions,aggregatable:aggregatable,type:type})=>{if(supportedTypes.has(type)&&aggregatable&&(!aggregationRestrictions||aggregationRestrictions.terms)){return{dataType:type,isBucketed:true,scale:"ordinal"}}},isTransferable:(column,newIndexPattern)=>{const newField=newIndexPattern.getFieldByName(column.sourceField);return Boolean(newField&&supportedTypes.has(newField.type)&&newField.aggregatable&&(!newField.aggregationRestrictions||newField.aggregationRestrictions.terms)&&(!column.params.otherBucket||!newIndexPattern.hasRestrictions))},buildColumn({layer:layer,field:field,indexPattern:indexPattern}){const existingMetricColumn=Object.entries(layer.columns).filter(([columnId,column])=>column&&!column.isBucketed&&!isReferenced(layer,columnId)).map(([id])=>id)[0];const previousBucketsLength=Object.values(layer.columns).filter(col=>col&&col.isBucketed).length;return{label:ofName(field.displayName),dataType:field.type,operationType:"terms",scale:"ordinal",sourceField:field.name,isBucketed:true,params:{size:previousBucketsLength===0?5:DEFAULT_SIZE,orderBy:existingMetricColumn?{type:"column",columnId:existingMetricColumn}:{type:"alphabetical"},orderDirection:existingMetricColumn?"desc":"asc",otherBucket:!indexPattern.hasRestrictions,missingBucket:false}}},toEsAggsConfig:(column,columnId,_indexPattern)=>({id:columnId,enabled:true,type:"terms",schema:"segment",params:{field:column.sourceField,orderBy:column.params.orderBy.type==="alphabetical"?"_key":column.params.orderBy.columnId,order:column.params.orderDirection,size:column.params.size,otherBucket:Boolean(column.params.otherBucket),otherBucketLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.otherLabel",{defaultMessage:"Other"}),missingBucket:column.params.otherBucket&&column.params.missingBucket,missingBucketLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.missingLabel",{defaultMessage:"(missing value)"})}}),getDefaultLabel:(column,indexPattern)=>ofName(indexPattern.getFieldByName(column.sourceField).displayName),onFieldChange:(oldColumn,field)=>{const newParams=terms_objectSpread({},oldColumn.params);if("format"in newParams&&field.type!=="number"){delete newParams.format}return terms_objectSpread(terms_objectSpread({},oldColumn),{},{dataType:field.type,label:ofName(field.displayName),sourceField:field.name,params:newParams})},onOtherColumnChanged:(currentColumn,columns)=>{if(currentColumn.params.orderBy.type==="column"){const columnSortedBy=columns[currentColumn.params.orderBy.columnId];if(!columnSortedBy||!isSortableByColumn(columnSortedBy)){return terms_objectSpread(terms_objectSpread({},currentColumn),{},{params:terms_objectSpread(terms_objectSpread({},currentColumn.params),{},{orderBy:{type:"alphabetical"},orderDirection:"asc"})})}}return currentColumn},paramEditor:function ParamEditor({state:state,setState:setState,currentColumn:currentColumn,layerId:layerId}){const indexPattern=currentColumn&&state.indexPatterns[state.layers[layerId].indexPatternId];const hasRestrictions=indexPattern.hasRestrictions;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=terms_slicedToArray(_useState,2),popoverOpen=_useState2[0],setPopoverOpen=_useState2[1];const SEPARATOR="$$$";function toValue(orderBy){if(orderBy.type==="alphabetical"){return orderBy.type}return"".concat(orderBy.type).concat(SEPARATOR).concat(orderBy.columnId)}function fromValue(value){if(value==="alphabetical"){return{type:"alphabetical"}}const parts=value.split(SEPARATOR);return{type:"column",columnId:parts[1]}}const orderOptions=Object.entries(state.layers[layerId].columns).filter(([_columnId,column])=>isSortableByColumn(column)).map(([columnId,column])=>({value:toValue({type:"column",columnId:columnId}),text:column.label}));orderOptions.push({value:toValue({type:"alphabetical"}),text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.orderAlphabetical",{defaultMessage:"Alphabetical"})});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.size",{defaultMessage:"Number of values"}),display:"columnCompressed",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(ValuesRangeInput,{value:currentColumn.params.size,onChange:value=>{setState(updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:"size",value:value}))}})),!hasRestrictions&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{textAlign:"right"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{ownFocus:true,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",iconType:"arrowDown",iconSide:"right",onClick:()=>{setPopoverOpen(true)}},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.advancedSettings",{defaultMessage:"Advanced"})),isOpen:popoverOpen,closePopover:()=>{setPopoverOpen(false)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.otherBucketDescription",{defaultMessage:'Group other values as "Other"'}),compressed:true,"data-test-subj":"indexPattern-terms-other-bucket",checked:Boolean(currentColumn.params.otherBucket),onChange:e=>setState(updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:"otherBucket",value:e.target.checked}))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.missingBucketDescription",{defaultMessage:"Include documents without this field"}),compressed:true,disabled:!currentColumn.params.otherBucket,"data-test-subj":"indexPattern-terms-missing-bucket",checked:Boolean(currentColumn.params.missingBucket),onChange:e=>setState(updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:"missingBucket",value:e.target.checked}))})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.orderBy",{defaultMessage:"Order by"}),display:"columnCompressed",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,"data-test-subj":"indexPattern-terms-orderBy",options:orderOptions,value:toValue(currentColumn.params.orderBy),onChange:e=>setState(updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:"orderBy",value:fromValue(e.target.value)})),"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.orderBy",{defaultMessage:"Order by"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.orderDirection",{defaultMessage:"Order direction"}),display:"columnCompressed",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,"data-test-subj":"indexPattern-terms-orderDirection",options:[{value:"asc",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.orderAscending",{defaultMessage:"Ascending"})},{value:"desc",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.orderDescending",{defaultMessage:"Descending"})}],value:currentColumn.params.orderDirection,onChange:e=>setState(updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:"orderDirection",value:e.target.value})),"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.terms.orderBy",{defaultMessage:"Order by"})})))}};var filters_filters=__webpack_require__(120);var filter_popover=__webpack_require__(129);function label_input_slicedToArray(arr,i){return label_input_arrayWithHoles(arr)||label_input_iterableToArrayLimit(arr,i)||label_input_unsupportedIterableToArray(arr,i)||label_input_nonIterableRest()}function label_input_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function label_input_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return label_input_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return label_input_arrayLikeToArray(o,minLen)}function label_input_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function label_input_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function label_input_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const LabelInput=({value:value,onChange:onChange,placeholder:placeholder,inputRef:_inputRef,onSubmit:onSubmit,dataTestSubj:dataTestSubj,compressed:compressed})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(value),_useState2=label_input_slicedToArray(_useState,2),inputValue=_useState2[0],setInputValue=_useState2[1];useDebounce_default()(()=>onChange(inputValue),256,[inputValue]);const handleInputChange=e=>{const val=String(e.target.value);setInputValue(val)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":dataTestSubj||"lens-labelInput",value:inputValue,onChange:handleInputChange,fullWidth:true,placeholder:placeholder||"",inputRef:node=>{if(_inputRef&&node){_inputRef.current=node}},onKeyDown:({key:key})=>{if(external_kbnSharedDeps_ElasticEui_["keys"].ENTER===key&&onSubmit){onSubmit()}},prepend:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.labelInput.label",{defaultMessage:"Label"}),compressed:compressed})};function buckets_objectWithoutProperties(source,excluded){if(source==null)return{};var target=buckets_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function buckets_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const NewBucketButton=({label:label,onClick:onClick})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"lns-newBucket-add",size:"xs",iconType:"plusInCircle",onClick:onClick},label);const BucketContainer=({isInvalid:isInvalid,invalidMessage:invalidMessage,onRemoveClick:onRemoveClick,removeTitle:removeTitle,children:children,dataTestSubj:dataTestSubj,isNotRemovable:isNotRemovable})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"none","data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"s",color:isInvalid?"danger":"subdued",type:isInvalid?"alert":"grab",title:isInvalid?invalidMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.customBucketContainer.dragToReorder",{defaultMessage:"Drag to reorder"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},children),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconSize:"s",iconType:"cross",color:"danger","data-test-subj":"lns-customBucketContainer-remove",onClick:onRemoveClick,"aria-label":removeTitle,title:removeTitle,disabled:isNotRemovable}))));const DraggableBucketContainer=_ref=>{let id=_ref.id,idx=_ref.idx,children=_ref.children,bucketContainerProps=buckets_objectWithoutProperties(_ref,["id","idx","children"]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDraggable"],{style:{marginBottom:4},spacing:"none",index:idx,draggableId:id,disableInteractiveElementBlocking:true},provided=>external_kbnSharedDeps_React_default.a.createElement(BucketContainer,bucketContainerProps,children))};const DragDropBuckets=({items:items,onDragStart:onDragStart,onDragEnd:onDragEnd,droppableId:droppableId,children:children})=>{const handleDragEnd=({source:source,destination:destination})=>{if(source&&destination){const newItems=Object(external_kbnSharedDeps_ElasticEui_["euiDragDropReorder"])(items,source.index,destination.index);onDragEnd(newItems)}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDragDropContext"],{onDragEnd:handleDragEnd,onDragStart:onDragStart},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDroppable"],{droppableId:droppableId,spacing:"none"},children))};function filter_popover_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function filter_popover_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){filter_popover_ownKeys(Object(source),true).forEach((function(key){filter_popover_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{filter_popover_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function filter_popover_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function filter_popover_slicedToArray(arr,i){return filter_popover_arrayWithHoles(arr)||filter_popover_iterableToArrayLimit(arr,i)||filter_popover_unsupportedIterableToArray(arr,i)||filter_popover_nonIterableRest()}function filter_popover_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function filter_popover_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return filter_popover_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return filter_popover_arrayLikeToArray(o,minLen)}function filter_popover_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function filter_popover_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function filter_popover_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const FilterPopover=({filter:filter,setFilter:setFilter,indexPattern:indexPattern,Button:Button,isOpenByCreation:isOpenByCreation,setIsOpenByCreation:setIsOpenByCreation})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=filter_popover_slicedToArray(_useState,2),isPopoverOpen=_useState2[0],setIsPopoverOpen=_useState2[1];const inputRef=external_kbnSharedDeps_React_default.a.useRef();const _closePopover=()=>{if(isOpenByCreation){setIsOpenByCreation(false)}if(isPopoverOpen){setIsPopoverOpen(false)}};const setFilterLabel=label=>setFilter(filter_popover_objectSpread(filter_popover_objectSpread({},filter),{},{label:label}));const setFilterQuery=input=>setFilter(filter_popover_objectSpread(filter_popover_objectSpread({},filter),{},{input:input}));const getPlaceholder=query=>{if(query===""){return defaultLabel}if(query==="object")return JSON.stringify(query);else{return String(query)}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{"data-test-subj":"indexPattern-filters-existingFilterContainer",anchorClassName:"eui-fullWidth",panelClassName:"lnsIndexPatternDimensionEditor__filtersEditor",isOpen:isOpenByCreation||isPopoverOpen,ownFocus:true,closePopover:()=>_closePopover(),button:external_kbnSharedDeps_React_default.a.createElement(Button,{onClick:()=>{if(isOpenByCreation){setIsOpenByCreation(false)}setIsPopoverOpen(open=>!open)}})},external_kbnSharedDeps_React_default.a.createElement(QueryInput,{isInvalid:!isQueryValid(filter.input,indexPattern),value:filter.input,indexPattern:indexPattern,onChange:setFilterQuery,onSubmit:()=>{if(inputRef.current)inputRef.current.focus()}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(LabelInput,{value:filter.label||"",onChange:setFilterLabel,placeholder:getPlaceholder(filter.input.query),inputRef:inputRef,onSubmit:()=>_closePopover(),dataTestSubj:"indexPattern-filters-label"}))};const QueryInput=({value:value,onChange:onChange,indexPattern:indexPattern,isInvalid:isInvalid,onSubmit:_onSubmit})=>{const _useState3=Object(external_kbnSharedDeps_React_["useState"])(value),_useState4=filter_popover_slicedToArray(_useState3,2),inputValue=_useState4[0],setInputValue=_useState4[1];useDebounce_default()(()=>onChange(inputValue),256,[inputValue]);const handleInputChange=input=>{setInputValue(input)};return external_kbnSharedDeps_React_default.a.createElement(public_["QueryStringInput"],{dataTestSubj:"indexPattern-filters-queryStringInput",size:"s",isInvalid:isInvalid,bubbleSubmitEvent:false,indexPatterns:[indexPattern],query:inputValue,onChange:handleInputChange,onSubmit:()=>{if(inputValue.query){_onSubmit()}},placeholder:inputValue.language==="kuery"?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.filters.queryPlaceholderKql",{defaultMessage:"{example}",values:{example:'method : "GET" or status : "404"'}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.filters.queryPlaceholderLucene",{defaultMessage:"{example}",values:{example:"method:GET OR status:404"}}),languageSwitcherPopoverAnchorPosition:"rightDown"})};function filters_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function filters_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){filters_ownKeys(Object(source),true).forEach((function(key){filters_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{filters_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function filters_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function filters_slicedToArray(arr,i){return filters_arrayWithHoles(arr)||filters_iterableToArrayLimit(arr,i)||filters_unsupportedIterableToArray(arr,i)||filters_nonIterableRest()}function filters_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function filters_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return filters_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return filters_arrayLikeToArray(o,minLen)}function filters_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function filters_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function filters_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const filters_generateId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();const filtersLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.filters",{defaultMessage:"Filters"});const defaultLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.filters.label.placeholder",{defaultMessage:"All records"});const defaultFilter={input:{query:"",language:"kuery"},label:""};const isQueryValid=(input,indexPattern)=>{try{if(input.language==="kuery"){public_["esKuery"].toElasticsearchQuery(public_["esKuery"].fromKueryExpression(input.query),indexPattern)}else{public_["esQuery"].luceneStringToDsl(input.query)}return true}catch(e){return false}};const filtersOperation={type:"filters",displayName:filtersLabel,priority:3,input:"none",isTransferable:()=>true,getDefaultLabel:()=>filtersLabel,buildColumn({previousColumn:previousColumn}){let params={filters:[defaultFilter]};if((previousColumn===null||previousColumn===void 0?void 0:previousColumn.operationType)==="terms"){params={filters:[{label:"",input:{query:"".concat(previousColumn.sourceField," : *"),language:"kuery"}}]}}return{label:filtersLabel,dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:true,params:params}},getPossibleOperation(){return{dataType:"string",isBucketed:true,scale:"ordinal"}},toEsAggsConfig:(column,columnId,indexPattern)=>{var _column$params$filter;const validFilters=(_column$params$filter=column.params.filters)===null||_column$params$filter===void 0?void 0:_column$params$filter.filter(f=>isQueryValid(f.input,indexPattern));return{id:columnId,enabled:true,type:"filters",schema:"segment",params:{filters:(validFilters===null||validFilters===void 0?void 0:validFilters.length)>0?validFilters:[defaultFilter]}}},paramEditor:({state:state,setState:setState,currentColumn:currentColumn,layerId:layerId,data:data})=>{const indexPattern=state.indexPatterns[state.layers[layerId].indexPatternId];const filters=currentColumn.params.filters;const setFilters=newFilters=>setState(updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:"filters",value:newFilters}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(FilterList,{filters:filters,setFilters:setFilters,indexPattern:indexPattern,defaultQuery:defaultFilter}))}};const FilterList=({filters:filters,setFilters:setFilters,indexPattern:indexPattern,defaultQuery:defaultQuery})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=filters_slicedToArray(_useState,2),isOpenByCreation=_useState2[0],setIsOpenByCreation=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(()=>filters.map(filter=>filters_objectSpread(filters_objectSpread({},filter),{},{id:filters_generateId()}))),_useState4=filters_slicedToArray(_useState3,2),localFilters=_useState4[0],setLocalFilters=_useState4[1];const updateFilters=updatedFilters=>{setFilters(updatedFilters.map(filter=>Object(external_kbnSharedDeps_Lodash_["omit"])(filter,"id")));setLocalFilters(updatedFilters)};const onAddFilter=()=>updateFilters([...localFilters,filters_objectSpread(filters_objectSpread({},defaultQuery),{},{id:filters_generateId()})]);const onRemoveFilter=id=>updateFilters(localFilters.filter(filter=>filter.id!==id));const onChangeValue=(id,query,label)=>updateFilters(localFilters.map(filter=>filter.id===id?filters_objectSpread(filters_objectSpread({},filter),{},{input:query,label:label}):filter));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(DragDropBuckets,{onDragEnd:updateFilters,onDragStart:()=>setIsOpenByCreation(false),droppableId:"FILTERS_DROPPABLE_AREA",items:localFilters},localFilters===null||localFilters===void 0?void 0:localFilters.map((filter,idx)=>{const isInvalid=!isQueryValid(filter.input,indexPattern);return external_kbnSharedDeps_React_default.a.createElement(DraggableBucketContainer,{id:filter.id,key:filter.id,idx:idx,isInvalid:isInvalid,invalidMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.filters.isInvalid",{defaultMessage:"This query is invalid"}),onRemoveClick:()=>onRemoveFilter(filter.id),removeTitle:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.filters.removeFilter",{defaultMessage:"Remove a filter"}),isNotRemovable:localFilters.length===1},external_kbnSharedDeps_React_default.a.createElement(FilterPopover,{"data-test-subj":"indexPattern-filters-existingFilterContainer",isOpenByCreation:idx===localFilters.length-1&&isOpenByCreation,setIsOpenByCreation:setIsOpenByCreation,indexPattern:indexPattern,filter:filter,setFilter:f=>{onChangeValue(f.id,f.input,f.label)},Button:({onClick:onClick})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{className:"lnsFiltersOperation__popoverButton","data-test-subj":"indexPattern-filters-existingFilterTrigger",onClick:onClick,color:isInvalid?"danger":"text",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.filters.clickToEdit",{defaultMessage:"Click to edit"})},filter.label||filter.input.query||defaultLabel)}))})),external_kbnSharedDeps_React_default.a.createElement(NewBucketButton,{onClick:()=>{onAddFilter();setIsOpenByCreation(true)},label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.filters.addaFilter",{defaultMessage:"Add a filter"})}))};function cardinality_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function cardinality_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){cardinality_ownKeys(Object(source),true).forEach((function(key){cardinality_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{cardinality_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function cardinality_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const cardinality_supportedTypes=new Set(["string","boolean","number","ip","date"]);const SCALE="ratio";const OPERATION_TYPE="cardinality";const IS_BUCKETED=false;function cardinality_ofName(name){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.cardinalityOf",{defaultMessage:"Unique count of {name}",values:{name:name}})}const cardinalityOperation={type:OPERATION_TYPE,displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.cardinality",{defaultMessage:"Unique count"}),input:"field",getPossibleOperationForField:({aggregationRestrictions:aggregationRestrictions,aggregatable:aggregatable,type:type})=>{if(cardinality_supportedTypes.has(type)&&aggregatable&&(!aggregationRestrictions||aggregationRestrictions.cardinality)){return{dataType:"number",isBucketed:IS_BUCKETED,scale:SCALE}}},isTransferable:(column,newIndexPattern)=>{const newField=newIndexPattern.getFieldByName(column.sourceField);return Boolean(newField&&cardinality_supportedTypes.has(newField.type)&&newField.aggregatable&&(!newField.aggregationRestrictions||newField.aggregationRestrictions.cardinality))},getDefaultLabel:(column,indexPattern)=>cardinality_ofName(indexPattern.getFieldByName(column.sourceField).displayName),buildColumn({field:field,previousColumn:previousColumn}){return{label:cardinality_ofName(field.displayName),dataType:"number",operationType:OPERATION_TYPE,scale:SCALE,sourceField:field.name,isBucketed:IS_BUCKETED,params:(previousColumn===null||previousColumn===void 0?void 0:previousColumn.dataType)==="number"&&previousColumn.params&&"format"in previousColumn.params&&previousColumn.params.format?{format:previousColumn.params.format}:undefined}},toEsAggsConfig:(column,columnId)=>({id:columnId,enabled:true,type:OPERATION_TYPE,schema:"metric",params:{field:column.sourceField,missing:0}}),onFieldChange:(oldColumn,field)=>cardinality_objectSpread(cardinality_objectSpread({},oldColumn),{},{label:cardinality_ofName(field.displayName),sourceField:field.name})};function metrics_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function metrics_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){metrics_ownKeys(Object(source),true).forEach((function(key){metrics_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{metrics_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function metrics_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function buildMetricOperation({type:type,displayName:displayName,ofName:ofName,priority:priority}){return{type:type,priority:priority,displayName:displayName,input:"field",getPossibleOperationForField:({aggregationRestrictions:aggregationRestrictions,aggregatable:aggregatable,type:fieldType})=>{if(fieldType==="number"&&aggregatable&&(!aggregationRestrictions||aggregationRestrictions[type])){return{dataType:"number",isBucketed:false,scale:"ratio"}}},isTransferable:(column,newIndexPattern)=>{const newField=newIndexPattern.getFieldByName(column.sourceField);return Boolean(newField&&newField.type==="number"&&newField.aggregatable&&(!newField.aggregationRestrictions||newField.aggregationRestrictions[type]))},getDefaultLabel:(column,indexPattern,columns)=>ofName(indexPattern.getFieldByName(column.sourceField).displayName),buildColumn:({field:field,previousColumn:previousColumn})=>({label:ofName(field.displayName),dataType:"number",operationType:type,sourceField:field.name,isBucketed:false,scale:"ratio",params:previousColumn&&previousColumn.dataType==="number"?previousColumn.params:undefined}),onFieldChange:(oldColumn,field)=>metrics_objectSpread(metrics_objectSpread({},oldColumn),{},{label:ofName(field.displayName),sourceField:field.name}),toEsAggsConfig:(column,columnId,_indexPattern)=>({id:columnId,enabled:true,type:column.operationType,schema:"metric",params:{field:column.sourceField,missing:0}})}}const minOperation=buildMetricOperation({type:"min",displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.min",{defaultMessage:"Minimum"}),ofName:name=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.minOf",{defaultMessage:"Minimum of {name}",values:{name:name}})});const maxOperation=buildMetricOperation({type:"max",displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.max",{defaultMessage:"Maximum"}),ofName:name=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.maxOf",{defaultMessage:"Maximum of {name}",values:{name:name}})});const averageOperation=buildMetricOperation({type:"avg",priority:2,displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.avg",{defaultMessage:"Average"}),ofName:name=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.avgOf",{defaultMessage:"Average of {name}",values:{name:name}})});const sumOperation=buildMetricOperation({type:"sum",priority:1,displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.sum",{defaultMessage:"Sum"}),ofName:name=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.sumOf",{defaultMessage:"Sum of {name}",values:{name:name}})});const medianOperation=buildMetricOperation({type:"median",displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.median",{defaultMessage:"Median"}),ofName:name=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.medianOf",{defaultMessage:"Median of {name}",values:{name:name}})});function date_histogram_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function date_histogram_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){date_histogram_ownKeys(Object(source),true).forEach((function(key){date_histogram_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{date_histogram_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function date_histogram_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const isValidInterval=public_["search"].aggs.isValidInterval;const autoInterval="auto";const calendarOnlyIntervals=new Set(["w","M","q","y"]);const dateHistogramOperation={type:"date_histogram",displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram",{defaultMessage:"Date histogram"}),input:"field",priority:5,getPossibleOperationForField:({aggregationRestrictions:aggregationRestrictions,aggregatable:aggregatable,type:type})=>{if(type==="date"&&aggregatable&&(!aggregationRestrictions||aggregationRestrictions.date_histogram)){return{dataType:"date",isBucketed:true,scale:"interval"}}},getDefaultLabel:(column,indexPattern)=>indexPattern.getFieldByName(column.sourceField).displayName,buildColumn({field:field}){let interval=autoInterval;let timeZone;if(field.aggregationRestrictions&&field.aggregationRestrictions.date_histogram){interval=restrictedInterval(field.aggregationRestrictions);timeZone=field.aggregationRestrictions.date_histogram.time_zone}return{label:field.displayName,dataType:"date",operationType:"date_histogram",sourceField:field.name,isBucketed:true,scale:"interval",params:{interval:interval,timeZone:timeZone}}},isTransferable:(column,newIndexPattern)=>{const newField=newIndexPattern.getFieldByName(column.sourceField);return Boolean(newField&&newField.type==="date"&&newField.aggregatable&&(!newField.aggregationRestrictions||newField.aggregationRestrictions.date_histogram))},transfer:(column,newIndexPattern)=>{var _newField$aggregation;const newField=newIndexPattern.getFieldByName(column.sourceField);if(newField===null||newField===void 0?void 0:(_newField$aggregation=newField.aggregationRestrictions)===null||_newField$aggregation===void 0?void 0:_newField$aggregation.date_histogram){const restrictions=newField.aggregationRestrictions.date_histogram;return date_histogram_objectSpread(date_histogram_objectSpread({},column),{},{params:date_histogram_objectSpread(date_histogram_objectSpread({},column.params),{},{timeZone:restrictions.time_zone,interval:restrictedInterval(newField.aggregationRestrictions)})})}return column},onFieldChange:(oldColumn,field)=>date_histogram_objectSpread(date_histogram_objectSpread({},oldColumn),{},{label:field.displayName,sourceField:field.name}),toEsAggsConfig:(column,columnId,indexPattern)=>{var _usedField$aggregatio;const usedField=indexPattern.getFieldByName(column.sourceField);return{id:columnId,enabled:true,type:"date_histogram",schema:"segment",params:{field:column.sourceField,time_zone:column.params.timeZone,useNormalizedEsInterval:!(usedField===null||usedField===void 0?void 0:(_usedField$aggregatio=usedField.aggregationRestrictions)===null||_usedField$aggregatio===void 0?void 0:_usedField$aggregatio.date_histogram),interval:column.params.interval,drop_partials:false,min_doc_count:0,extended_bounds:{}}}},paramEditor:({state:state,setState:setState,currentColumn:currentColumn,layerId:layerId,dateRange:dateRange,data:data})=>{const field=currentColumn&&state.indexPatterns[state.layers[layerId].indexPatternId].getFieldByName(currentColumn.sourceField);const intervalIsRestricted=field.aggregationRestrictions&&field.aggregationRestrictions.date_histogram;const interval=parseInterval(currentColumn.params.interval);const isValid=isValidInterval("".concat(interval.value===""?"1":interval.value).concat(interval.unit),restrictedInterval(field.aggregationRestrictions));function onChangeAutoInterval(ev){const fromDate=dateRange.fromDate,toDate=dateRange.toDate;const value=ev.target.checked?data.search.aggs.calculateAutoTimeExpression({from:fromDate,to:toDate})||"1h":autoInterval;setState(updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:"interval",value:value}))}const setInterval=newInterval=>{const isCalendarInterval=calendarOnlyIntervals.has(newInterval.unit);const value="".concat(isCalendarInterval?"1":newInterval.value).concat(newInterval.unit||"d");setState(updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:"interval",value:value}))};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,!intervalIsRestricted&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"rowCompressed",hasChildLabel:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram.autoInterval",{defaultMessage:"Customize time interval"}),checked:currentColumn.params.interval!==autoInterval,onChange:onChangeAutoInterval,compressed:true})),currentColumn.params.interval!==autoInterval&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram.minimumInterval",{defaultMessage:"Minimum interval"}),fullWidth:true,display:"rowCompressed"},intervalIsRestricted?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.indexPattern.dateHistogram.restrictedInterval",defaultMessage:"Interval fixed to {intervalValue} due to aggregation restrictions.",values:{intervalValue:currentColumn.params.interval}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{compressed:true,"data-test-subj":"lensDateHistogramValue",value:typeof interval.value==="number"||interval.value===""?interval.value:parseInt(interval.value,10),disabled:calendarOnlyIntervals.has(interval.unit),isInvalid:!isValid,onChange:e=>{setInterval(date_histogram_objectSpread(date_histogram_objectSpread({},interval),{},{value:e.target.value}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,"data-test-subj":"lensDateHistogramUnit",value:interval.unit,onChange:e=>{setInterval(date_histogram_objectSpread(date_histogram_objectSpread({},interval),{},{unit:e.target.value}))},isInvalid:!isValid,options:[{value:"ms",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram.milliseconds",{defaultMessage:"milliseconds"})},{value:"s",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram.seconds",{defaultMessage:"seconds"})},{value:"m",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram.minutes",{defaultMessage:"minutes"})},{value:"h",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram.hours",{defaultMessage:"hours"})},{value:"d",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram.days",{defaultMessage:"days"})},{value:"w",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram.week",{defaultMessage:"week"})},{value:"M",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram.month",{defaultMessage:"month"})},{value:"y",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dateHistogram.year",{defaultMessage:"year"})}]}))),!isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:"danger","data-test-subj":"lensDateHistogramError"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.invalidInterval",{defaultMessage:"Invalid interval value"}))))))}};function parseInterval(currentInterval){const interval=currentInterval||"";const valueMatch=interval.match(/[\d]+/)||[];const unitMatch=interval.match(/[\D]+/)||[];const result=parseInt(valueMatch[0]||"",10);return{value:isNaN(result)?"":result,unit:unitMatch[0]||"h"}}function restrictedInterval(aggregationRestrictions){if(!aggregationRestrictions||!aggregationRestrictions.date_histogram){return}return aggregationRestrictions.date_histogram.calendar_interval||aggregationRestrictions.date_histogram.fixed_interval}function calculations_utils_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function calculations_utils_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){calculations_utils_ownKeys(Object(source),true).forEach((function(key){calculations_utils_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{calculations_utils_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function calculations_utils_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function checkForDateHistogram(layer,name){const buckets=layer.columnOrder.filter(colId=>layer.columns[colId].isBucketed);const hasDateHistogram=buckets.some(colId=>layer.columns[colId].operationType==="date_histogram");if(hasDateHistogram){return undefined}return[external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.calculations.dateHistogramErrorMessage",{defaultMessage:"{name} requires a date histogram to work. Choose a different function or add a date histogram.",values:{name:name}})]}function hasDateField(indexPattern){return indexPattern.fields.some(field=>field.type==="date")}function dateBasedOperationToExpression(layer,columnId,functionName,additionalArgs={}){const currentColumn=layer.columns[columnId];const buckets=layer.columnOrder.filter(colId=>layer.columns[colId].isBucketed);const dateColumnIndex=buckets.findIndex(colId=>layer.columns[colId].operationType==="date_histogram");buckets.splice(dateColumnIndex,1);return[{type:"function",function:functionName,arguments:calculations_utils_objectSpread({by:buckets,inputColumnId:[currentColumn.references[0]],outputColumnId:[columnId],outputColumnName:[currentColumn.label]},additionalArgs)}]}const counter_rate_ofName=name=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.CounterRateOf",{defaultMessage:"Counter rate of {name}",values:{name:name!==null&&name!==void 0?name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.incompleteOperation",{defaultMessage:"(incomplete)"})}});const counterRateOperation={type:"counter_rate",priority:1,displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.counterRate",{defaultMessage:"Counter rate"}),input:"fullReference",selectionStyle:"field",requiredReferences:[{input:["field"],specificOperations:["max"],validateMetadata:meta=>meta.dataType==="number"&&!meta.isBucketed}],getPossibleOperation:()=>({dataType:"number",isBucketed:false,scale:"ratio"}),getDefaultLabel:(column,indexPattern,columns)=>{var _columns$column$refer;return counter_rate_ofName((_columns$column$refer=columns[column.references[0]])===null||_columns$column$refer===void 0?void 0:_columns$column$refer.label)},toExpression:(layer,columnId)=>dateBasedOperationToExpression(layer,columnId,"lens_counter_rate"),buildColumn:({referenceIds:referenceIds,previousColumn:previousColumn,layer:layer})=>{const metric=layer.columns[referenceIds[0]];return{label:counter_rate_ofName(metric===null||metric===void 0?void 0:metric.label),dataType:"number",operationType:"counter_rate",isBucketed:false,scale:"ratio",references:referenceIds,params:(previousColumn===null||previousColumn===void 0?void 0:previousColumn.dataType)==="number"&&previousColumn.params&&"format"in previousColumn.params&&previousColumn.params.format?{format:previousColumn.params.format}:undefined}},isTransferable:(column,newIndexPattern)=>hasDateField(newIndexPattern),getErrorMessage:layer=>checkForDateHistogram(layer,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.counterRate",{defaultMessage:"Counter rate"}))};const cumulative_sum_ofName=name=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.cumulativeSumOf",{defaultMessage:"Cumulative sum rate of {name}",values:{name:name!==null&&name!==void 0?name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.incompleteOperation",{defaultMessage:"(incomplete)"})}});const cumulativeSumOperation={type:"cumulative_sum",priority:1,displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.cumulativeSum",{defaultMessage:"Cumulative sum"}),input:"fullReference",selectionStyle:"field",requiredReferences:[{input:["field"],specificOperations:["count","sum"],validateMetadata:meta=>meta.dataType==="number"&&!meta.isBucketed}],getPossibleOperation:()=>({dataType:"number",isBucketed:false,scale:"ratio"}),getDefaultLabel:(column,indexPattern,columns)=>{var _columns$column$refer;return cumulative_sum_ofName((_columns$column$refer=columns[column.references[0]])===null||_columns$column$refer===void 0?void 0:_columns$column$refer.label)},toExpression:(layer,columnId)=>dateBasedOperationToExpression(layer,columnId,"cumulative_sum"),buildColumn:({referenceIds:referenceIds,previousColumn:previousColumn,layer:layer})=>{const metric=layer.columns[referenceIds[0]];return{label:cumulative_sum_ofName(metric===null||metric===void 0?void 0:metric.label),dataType:"number",operationType:"cumulative_sum",isBucketed:false,scale:"ratio",references:referenceIds,params:(previousColumn===null||previousColumn===void 0?void 0:previousColumn.dataType)==="number"&&previousColumn.params&&"format"in previousColumn.params&&previousColumn.params.format?{format:previousColumn.params.format}:undefined}},isTransferable:()=>true,getErrorMessage:layer=>checkForDateHistogram(layer,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.cumulativeSum",{defaultMessage:"Cumulative sum"}))};const derivative_ofName=name=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.derivativeOf",{defaultMessage:"Differences of {name}",values:{name:name!==null&&name!==void 0?name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.incompleteOperation",{defaultMessage:"(incomplete)"})}});const derivativeOperation={type:"derivative",priority:1,displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.derivative",{defaultMessage:"Differences"}),input:"fullReference",selectionStyle:"full",requiredReferences:[{input:["field"],validateMetadata:meta=>meta.dataType==="number"&&!meta.isBucketed}],getPossibleOperation:()=>({dataType:"number",isBucketed:false,scale:"ratio"}),getDefaultLabel:(column,indexPattern,columns)=>{var _columns$column$refer;return derivative_ofName((_columns$column$refer=columns[column.references[0]])===null||_columns$column$refer===void 0?void 0:_columns$column$refer.label)},toExpression:(layer,columnId)=>dateBasedOperationToExpression(layer,columnId,"derivative"),buildColumn:({referenceIds:referenceIds,previousColumn:previousColumn,layer:layer})=>{const metric=layer.columns[referenceIds[0]];return{label:derivative_ofName(metric===null||metric===void 0?void 0:metric.label),dataType:"number",operationType:"derivative",isBucketed:false,scale:"ratio",references:referenceIds,params:(previousColumn===null||previousColumn===void 0?void 0:previousColumn.dataType)==="number"&&previousColumn.params&&"format"in previousColumn.params&&previousColumn.params.format?{format:previousColumn.params.format}:undefined}},isTransferable:(column,newIndexPattern)=>hasDateField(newIndexPattern),getErrorMessage:layer=>checkForDateHistogram(layer,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.derivative",{defaultMessage:"Differences"}))};function moving_average_slicedToArray(arr,i){return moving_average_arrayWithHoles(arr)||moving_average_iterableToArrayLimit(arr,i)||moving_average_unsupportedIterableToArray(arr,i)||moving_average_nonIterableRest()}function moving_average_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function moving_average_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return moving_average_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return moving_average_arrayLikeToArray(o,minLen)}function moving_average_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function moving_average_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function moving_average_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const moving_average_ofName=name=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.movingAverageOf",{defaultMessage:"Moving average of {name}",values:{name:name!==null&&name!==void 0?name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.incompleteOperation",{defaultMessage:"(incomplete)"})}});const movingAverageOperation={type:"moving_average",priority:1,displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.movingAverage",{defaultMessage:"Moving Average"}),input:"fullReference",selectionStyle:"full",requiredReferences:[{input:["field"],validateMetadata:meta=>meta.dataType==="number"&&!meta.isBucketed}],getPossibleOperation:()=>({dataType:"number",isBucketed:false,scale:"ratio"}),getDefaultLabel:(column,indexPattern,columns)=>{var _columns$column$refer;return moving_average_ofName((_columns$column$refer=columns[column.references[0]])===null||_columns$column$refer===void 0?void 0:_columns$column$refer.label)},toExpression:(layer,columnId)=>dateBasedOperationToExpression(layer,columnId,"moving_average",{window:[layer.columns[columnId].params.window]}),buildColumn:({referenceIds:referenceIds,previousColumn:previousColumn,layer:layer})=>{const metric=layer.columns[referenceIds[0]];return{label:moving_average_ofName(metric===null||metric===void 0?void 0:metric.label),dataType:"number",operationType:"moving_average",isBucketed:false,scale:"ratio",references:referenceIds,params:(previousColumn===null||previousColumn===void 0?void 0:previousColumn.dataType)==="number"&&previousColumn.params&&"format"in previousColumn.params&&previousColumn.params.format?{format:previousColumn.params.format,window:5}:{window:5}}},paramEditor:MovingAverageParamEditor,isTransferable:(column,newIndexPattern)=>hasDateField(newIndexPattern),getErrorMessage:layer=>checkForDateHistogram(layer,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.movingAverage",{defaultMessage:"Moving Average"}))};function MovingAverageParamEditor({state:state,setState:setState,currentColumn:currentColumn,layerId:layerId}){const _useState=Object(external_kbnSharedDeps_React_["useState"])(String(currentColumn.params.window)),_useState2=moving_average_slicedToArray(_useState,2),inputValue=_useState2[0],setInputValue=_useState2[1];useDebounceWithOptions(()=>{if(inputValue===""){return}const inputNumber=Number(inputValue);setState(updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:"window",value:inputNumber}))},{skipFirstRender:true},256,[inputValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.movingAverage.window",{defaultMessage:"Window size"}),display:"columnCompressed",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{compressed:true,value:inputValue,onChange:e=>setInputValue(e.target.value)}))}function count_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function count_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){count_ownKeys(Object(source),true).forEach((function(key){count_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{count_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function count_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const countLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.countOf",{defaultMessage:"Count of records"});const countOperation={type:"count",priority:2,displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.count",{defaultMessage:"Count"}),input:"field",onFieldChange:(oldColumn,field)=>count_objectSpread(count_objectSpread({},oldColumn),{},{label:field.displayName,sourceField:field.name}),getPossibleOperationForField:field=>{if(field.type==="document"){return{dataType:"number",isBucketed:false,scale:"ratio"}}},getDefaultLabel:()=>countLabel,buildColumn({field:field,previousColumn:previousColumn}){return{label:countLabel,dataType:"number",operationType:"count",isBucketed:false,scale:"ratio",sourceField:field.name,params:(previousColumn===null||previousColumn===void 0?void 0:previousColumn.dataType)==="number"&&previousColumn.params&&"format"in previousColumn.params&&previousColumn.params.format?{format:previousColumn.params.format}:undefined}},toEsAggsConfig:(column,columnId)=>({id:columnId,enabled:true,type:"count",schema:"metric",params:{}}),isTransferable:()=>true};var common_=__webpack_require__(29);var advanced_editor=__webpack_require__(138);const TYPING_DEBOUNCE_TIME=256;const FROM_PLACEHOLDER="−∞";const TO_PLACEHOLDER="+∞";const DEFAULT_INTERVAL=1e3;const AUTO_BARS="auto";const MIN_HISTOGRAM_BARS=1;const SLICES=6;const MODES={Range:"range",Histogram:"histogram"};function advanced_editor_objectWithoutProperties(source,excluded){if(source==null)return{};var target=advanced_editor_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function advanced_editor_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function advanced_editor_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function advanced_editor_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){advanced_editor_ownKeys(Object(source),true).forEach((function(key){advanced_editor_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{advanced_editor_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function advanced_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function advanced_editor_slicedToArray(arr,i){return advanced_editor_arrayWithHoles(arr)||advanced_editor_iterableToArrayLimit(arr,i)||advanced_editor_unsupportedIterableToArray(arr,i)||advanced_editor_nonIterableRest()}function advanced_editor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function advanced_editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return advanced_editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return advanced_editor_arrayLikeToArray(o,minLen)}function advanced_editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function advanced_editor_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function advanced_editor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const advanced_editor_generateId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();const getBetterLabel=(range,formatter)=>range.label||formatter.convert({gte:isValidNumber(range.from)?range.from:-Infinity,lt:isValidNumber(range.to)?range.to:Infinity});const RangePopover=({range:range,setRange:setRange,Button:Button,isOpenByCreation:isOpenByCreation,setIsOpenByCreation:setIsOpenByCreation})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=advanced_editor_slicedToArray(_useState,2),isPopoverOpen=_useState2[0],setIsPopoverOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(range),_useState4=advanced_editor_slicedToArray(_useState3,2),tempRange=_useState4[0],setTempRange=_useState4[1];const saveRangeAndReset=(newRange,resetRange=false)=>{if(resetRange){setTempRange(range)}setRange(newRange)};const from=tempRange.from,to=tempRange.to,label=tempRange.label;const lteAppendLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.lessThanOrEqualAppend",{defaultMessage:"≤"});const lteTooltipContent=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.lessThanOrEqualTooltip",{defaultMessage:"Less than or equal to"});const ltPrependLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.lessThanPrepend",{defaultMessage:"<"});const ltTooltipContent=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.lessThanTooltip",{defaultMessage:"Less than"});const onSubmit=()=>{if(isOpenByCreation){setIsOpenByCreation(false)}if(isPopoverOpen){setIsPopoverOpen(false)}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{display:"block",ownFocus:true,isOpen:isOpenByCreation||isPopoverOpen,closePopover:onSubmit,button:external_kbnSharedDeps_React_default.a.createElement(Button,{onClick:()=>{if(isOpenByCreation){setIsOpenByCreation(false)}setIsPopoverOpen(isOpen=>!isOpen)}}),"data-test-subj":"indexPattern-ranges-popover"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false,alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{className:"lnsRangesOperation__popoverNumberField",value:isValidNumber(from)?Number(from):"",onChange:({target:target})=>{const newRange=advanced_editor_objectSpread(advanced_editor_objectSpread({},tempRange),{},{from:target.value!==""?Number(target.value):-Infinity});setTempRange(newRange);saveRangeAndReset(newRange)},append:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:lteTooltipContent},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},lteAppendLabel)),compressed:true,placeholder:FROM_PLACEHOLDER,isInvalid:!isValidRange(tempRange)})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight",color:"subdued"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{className:"lnsRangesOperation__popoverNumberField",value:isValidNumber(to)?Number(to):"",onChange:({target:target})=>{const newRange=advanced_editor_objectSpread(advanced_editor_objectSpread({},tempRange),{},{to:target.value!==""?Number(target.value):Infinity});setTempRange(newRange);saveRangeAndReset(newRange)},prepend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:ltTooltipContent},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},ltPrependLabel)),compressed:true,placeholder:TO_PLACEHOLDER,isInvalid:!isValidRange(tempRange),onKeyDown:({key:key})=>{if(external_kbnSharedDeps_ElasticEui_["keys"].ENTER===key&&onSubmit){onSubmit()}}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(LabelInput,{value:label||"",onChange:newLabel=>{const newRange=advanced_editor_objectSpread(advanced_editor_objectSpread({},tempRange),{},{label:newLabel});setTempRange(newRange);saveRangeAndReset(newRange)},placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.customRangeLabelPlaceholder",{defaultMessage:"Custom label"}),onSubmit:onSubmit,compressed:true,dataTestSubj:"indexPattern-ranges-label"})))};const AdvancedRangeEditor=({ranges:ranges,setRanges:setRanges,onToggleEditor:onToggleEditor,formatter:formatter})=>{const _useState5=Object(external_kbnSharedDeps_React_["useState"])(()=>ranges.map(range=>advanced_editor_objectSpread(advanced_editor_objectSpread({},range),{},{id:advanced_editor_generateId()}))),_useState6=advanced_editor_slicedToArray(_useState5,2),localRanges=_useState6[0],setLocalRanges=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=advanced_editor_slicedToArray(_useState7,2),isOpenByCreation=_useState8[0],setIsOpenByCreation=_useState8[1];const lastIndex=localRanges.length-1;useDebounceWithOptions(()=>{setRanges(localRanges.map(_ref=>{let id=_ref.id,rest=advanced_editor_objectWithoutProperties(_ref,["id"]);return advanced_editor_objectSpread({},rest)}))},{skipFirstRender:true},TYPING_DEBOUNCE_TIME,[localRanges]);const addNewRange=()=>{setLocalRanges([...localRanges,{id:advanced_editor_generateId(),from:localRanges[localRanges.length-1].to,to:Infinity,label:""}])};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.customRanges",{defaultMessage:"Ranges"}),labelAppend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{color:"danger",onClick:onToggleEditor},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"s",type:"cross",color:"danger"})," ",external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.customRangesRemoval",{defaultMessage:"Remove custom ranges"})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(DragDropBuckets,{onDragEnd:setLocalRanges,onDragStart:()=>{if(isOpenByCreation){setIsOpenByCreation(false)}},droppableId:"RANGES_DROPPABLE_AREA",items:localRanges},localRanges.map((range,idx)=>external_kbnSharedDeps_React_default.a.createElement(DraggableBucketContainer,{key:range.id,idx:idx,id:range.id,isInvalid:!isValidRange(range),invalidMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.range.isInvalid",{defaultMessage:"This range is invalid"}),onRemoveClick:()=>{const newRanges=localRanges.filter((_,i)=>i!==idx);setLocalRanges(newRanges)},removeTitle:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.deleteRange",{defaultMessage:"Delete range"}),isNotRemovable:localRanges.length===1},external_kbnSharedDeps_React_default.a.createElement(RangePopover,{range:range,isOpenByCreation:idx===lastIndex&&isOpenByCreation,setIsOpenByCreation:setIsOpenByCreation,setRange:newRange=>{const newRanges=[...localRanges];if(newRange.id===newRanges[idx].id){newRanges[idx]=newRange}else{newRanges.push(newRange)}setLocalRanges(newRanges)},Button:({onClick:onClick})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{color:"text",onClick:onClick,className:"lnsRangesOperation__popoverButton","data-test-subj":"indexPattern-ranges-popover-trigger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",textAlign:"left",color:isValidRange(range)?"default":"danger"},getBetterLabel(range,formatter)))})))),external_kbnSharedDeps_React_default.a.createElement(NewBucketButton,{onClick:()=>{addNewRange();setIsOpenByCreation(true)},label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.addRange",{defaultMessage:"Add range"})})))};function range_editor_slicedToArray(arr,i){return range_editor_arrayWithHoles(arr)||range_editor_iterableToArrayLimit(arr,i)||range_editor_unsupportedIterableToArray(arr,i)||range_editor_nonIterableRest()}function range_editor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function range_editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return range_editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return range_editor_arrayLikeToArray(o,minLen)}function range_editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function range_editor_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function range_editor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const BaseRangeEditor=({maxBars:maxBars,step:step,maxHistogramBars:maxHistogramBars,onToggleEditor:onToggleEditor,onMaxBarsChange:onMaxBarsChange})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(String(maxBars)),_useState2=range_editor_slicedToArray(_useState,2),maxBarsValue=_useState2[0],setMaxBarsValue=_useState2[1];useDebounceWithOptions(()=>{onMaxBarsChange(Number(maxBarsValue))},{skipFirstRender:true},TYPING_DEBOUNCE_TIME,[maxBarsValue]);const granularityLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.granularity",{defaultMessage:"Intervals granularity"});const granularityLabelDescription=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.granularityDescription",{defaultMessage:"Divides the field into evenly spaced intervals."});const decreaseButtonLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.decreaseButtonLabel",{defaultMessage:"Decrease granularity"});const increaseButtonLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.increaseButtonLabel",{defaultMessage:"Increase granularity"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,granularityLabel," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{position:"right",content:granularityLabelDescription,type:"questionInCircle",color:"subdued"})),"data-test-subj":"indexPattern-ranges-section-label",labelType:"legend",fullWidth:true,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"xs",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:decreaseButtonLabel,delay:"long"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:"minusInCircle",color:"text","data-test-subj":"lns-indexPattern-range-maxBars-minus",onClick:()=>setMaxBarsValue(""+Math.max(Number(maxBarsValue)-step,MIN_HISTOGRAM_BARS)),"aria-label":decreaseButtonLabel}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRange"],{compressed:true,fullWidth:true,"aria-label":granularityLabel,"data-test-subj":"lns-indexPattern-range-maxBars-field",min:MIN_HISTOGRAM_BARS,max:maxHistogramBars,step:step,value:maxBarsValue,onChange:({currentTarget:currentTarget})=>setMaxBarsValue(currentTarget.value)})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:increaseButtonLabel,delay:"long"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:"plusInCircle",color:"text","data-test-subj":"lns-indexPattern-range-maxBars-plus",onClick:()=>setMaxBarsValue(""+Math.min(Number(maxBarsValue)+step,maxHistogramBars)),"aria-label":increaseButtonLabel}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",iconType:"controlsHorizontal",onClick:()=>onToggleEditor()},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ranges.customIntervalsToggle",{defaultMessage:"Create custom ranges"})))};const RangeEditor=({setParam:setParam,params:params,maxHistogramBars:maxHistogramBars,maxBars:maxBars,granularityStep:granularityStep,onChangeMode:onChangeMode,rangeFormatter:rangeFormatter})=>{const _useState3=Object(external_kbnSharedDeps_React_["useState"])(params.type===MODES.Range),_useState4=range_editor_slicedToArray(_useState3,2),isAdvancedEditor=_useState4[0],toggleAdvancedEditor=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isAdvancedEditor){if(params.maxBars!==maxBars){setParam("maxBars",maxBars)}}},[maxBars,params.maxBars,setParam,isAdvancedEditor]);if(isAdvancedEditor){return external_kbnSharedDeps_React_default.a.createElement(AdvancedRangeEditor,{ranges:params.ranges,setRanges:ranges=>{setParam("ranges",ranges)},onToggleEditor:()=>{onChangeMode(MODES.Histogram);toggleAdvancedEditor(false)},formatter:rangeFormatter})}return external_kbnSharedDeps_React_default.a.createElement(BaseRangeEditor,{maxBars:maxBars,step:granularityStep,maxHistogramBars:maxHistogramBars,onMaxBarsChange:newMaxBars=>{setParam("maxBars",newMaxBars)},onToggleEditor:()=>{onChangeMode(MODES.Range);toggleAdvancedEditor(true)}})};function format_column_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function format_column_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){format_column_ownKeys(Object(source),true).forEach((function(key){format_column_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{format_column_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function format_column_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const supportedFormats={number:{decimalsToPattern:(decimals=2)=>{if(decimals===0){return"0,0"}return"0,0.".concat("0".repeat(decimals))}},percent:{decimalsToPattern:(decimals=2)=>{if(decimals===0){return"0,0%"}return"0,0.".concat("0".repeat(decimals),"%")}},bytes:{decimalsToPattern:(decimals=2)=>{if(decimals===0){return"0,0b"}return"0,0.".concat("0".repeat(decimals),"b")}}};const formatColumn={name:"lens_format_column",type:"datatable",help:"",args:{format:{types:["string"],help:"",required:true},columnId:{types:["string"],help:"",required:true},decimals:{types:["number"],help:""},parentFormat:{types:["string"],help:""}},inputTypes:["datatable"],fn(input,{format:format,columnId:columnId,decimals:decimals,parentFormat:parentFormat}){return format_column_objectSpread(format_column_objectSpread({},input),{},{columns:input.columns.map(col=>{if(col.id===columnId){var _parsedParentFormat$p;if(!parentFormat){if(supportedFormats[format]){return withParams(col,{id:format,params:{pattern:supportedFormats[format].decimalsToPattern(decimals)}})}else if(format){return withParams(col,{id:format})}else{return col}}const parsedParentFormat=JSON.parse(parentFormat);const parentFormatId=parsedParentFormat.id;const parentFormatParams=(_parsedParentFormat$p=parsedParentFormat.params)!==null&&_parsedParentFormat$p!==void 0?_parsedParentFormat$p:{};if(!parentFormatId){return col}if(format&&supportedFormats[format]){return withParams(col,{id:parentFormatId,params:format_column_objectSpread({id:format,params:{pattern:supportedFormats[format].decimalsToPattern(decimals)}},parentFormatParams)})}if(parentFormatParams){var _col$meta$params,_col$meta$params2,_col$meta$params3,_col$meta$params4;const isNested=isNestedFormat(col.meta.params);const innerParams=isNested?(_col$meta$params=col.meta.params)===null||_col$meta$params===void 0?void 0:_col$meta$params.params:{id:(_col$meta$params2=col.meta.params)===null||_col$meta$params2===void 0?void 0:_col$meta$params2.id,params:(_col$meta$params3=col.meta.params)===null||_col$meta$params3===void 0?void 0:_col$meta$params3.params};const formatId=isNested?(_col$meta$params4=col.meta.params)===null||_col$meta$params4===void 0?void 0:_col$meta$params4.id:parentFormatId;return withParams(col,format_column_objectSpread(format_column_objectSpread({},col.meta.params),{},{id:formatId,params:format_column_objectSpread(format_column_objectSpread({},innerParams),parentFormatParams)}))}}return col})})}};function isNestedFormat(params){var _params$params;return!!(params===null||params===void 0?void 0:(_params$params=params.params)===null||_params$params===void 0?void 0:_params$params.id)}function withParams(col,params){return format_column_objectSpread(format_column_objectSpread({},col),{},{meta:format_column_objectSpread(format_column_objectSpread({},col.meta),{},{params:params})})}function ranges_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function ranges_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ranges_ownKeys(Object(source),true).forEach((function(key){ranges_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ranges_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function ranges_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const isValidNumber=value=>value!=null&&value!==""&&!isNaN(value)&&isFinite(value);const isRangeWithin=range=>range.from<=range.to;const isFullRange=range=>isValidNumber(range.from)&&isValidNumber(range.to);const isValidRange=range=>{if(isFullRange(range)){return isRangeWithin(range)}return true};function getFieldDefaultFormat(indexPattern,field){if(field){if(indexPattern.fieldFormatMap&&indexPattern.fieldFormatMap[field.name]){return indexPattern.fieldFormatMap[field.name]}}return undefined}function getEsAggsParams({sourceField:sourceField,params:params}){if(params.type===MODES.Range){return{field:sourceField,ranges:params.ranges.filter(isValidRange).map(range=>{if(isFullRange(range)){return range}const partialRange={label:range.label};if(isValidNumber(range.from)){partialRange.from=range.from}if(isValidNumber(range.to)){partialRange.to=range.to}return partialRange})}}return{field:sourceField,maxBars:params.maxBars===AUTO_BARS?null:params.maxBars,has_extended_bounds:false,min_doc_count:0,extended_bounds:{min:"",max:""}}}const rangeOperation={type:"range",displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.intervals",{defaultMessage:"Intervals"}),priority:4,input:"field",getPossibleOperationForField:({aggregationRestrictions:aggregationRestrictions,aggregatable:aggregatable,type:type})=>{if(type==="number"&&aggregatable&&(!aggregationRestrictions||aggregationRestrictions.range)){return{dataType:"number",isBucketed:true,scale:"interval"}}},getDefaultLabel:(column,indexPattern)=>indexPattern.getFieldByName(column.sourceField).displayName,buildColumn({field:field}){return{label:field.displayName,dataType:"number",operationType:"range",sourceField:field.name,isBucketed:true,scale:"interval",params:{type:MODES.Histogram,ranges:[{from:0,to:DEFAULT_INTERVAL,label:""}],maxBars:AUTO_BARS,format:undefined,parentFormat:undefined}}},isTransferable:(column,newIndexPattern)=>{const newField=newIndexPattern.getFieldByName(column.sourceField);return Boolean(newField&&newField.type==="number"&&newField.aggregatable&&(!newField.aggregationRestrictions||newField.aggregationRestrictions.range))},onFieldChange:(oldColumn,field)=>ranges_objectSpread(ranges_objectSpread({},oldColumn),{},{label:field.name,sourceField:field.name}),toEsAggsConfig:(column,columnId)=>{const params=getEsAggsParams(column);return{id:columnId,enabled:true,type:column.params.type,schema:"segment",params:params}},paramEditor:({state:state,setState:setState,currentColumn:currentColumn,layerId:layerId,columnId:columnId,uiSettings:uiSettings,data:data})=>{var _numberFormat$params,_currentColumn$params;const indexPattern=state.indexPatterns[state.layers[layerId].indexPatternId];const currentField=indexPattern.getFieldByName(currentColumn.sourceField);const numberFormat=currentColumn.params.format;const numberFormatterPattern=numberFormat&&supportedFormats[numberFormat.id]&&supportedFormats[numberFormat.id].decimalsToPattern(((_numberFormat$params=numberFormat.params)===null||_numberFormat$params===void 0?void 0:_numberFormat$params.decimals)||0);const rangeFormatter=data.fieldFormats.deserialize(ranges_objectSpread(ranges_objectSpread({},currentColumn.params.parentFormat),{},{params:ranges_objectSpread(ranges_objectSpread({},(_currentColumn$params=currentColumn.params.parentFormat)===null||_currentColumn$params===void 0?void 0:_currentColumn$params.params),numberFormat?{id:numberFormat.id,params:{pattern:numberFormatterPattern}}:getFieldDefaultFormat(indexPattern,currentField))}));const MAX_HISTOGRAM_BARS=uiSettings.get(common_["UI_SETTINGS"].HISTOGRAM_MAX_BARS);const granularityStep=(MAX_HISTOGRAM_BARS-MIN_HISTOGRAM_BARS)/SLICES;const maxBarsDefaultValue=(MAX_HISTOGRAM_BARS-MIN_HISTOGRAM_BARS)/2;const setParam=(paramName,value)=>{setState(updateColumnParam({state:state,layerId:layerId,currentColumn:currentColumn,paramName:paramName,value:value}))};const onChangeMode=newMode=>{const scale=newMode===MODES.Range?"ordinal":"interval";const dataType=newMode===MODES.Range?"string":"number";const parentFormat=newMode===MODES.Range?{id:"range",params:{template:"arrow_right",replaceInfinity:true}}:undefined;setState(mergeLayer({state:state,layerId:layerId,newLayer:{columns:ranges_objectSpread(ranges_objectSpread({},state.layers[layerId].columns),{},{[columnId]:ranges_objectSpread(ranges_objectSpread({},currentColumn),{},{scale:scale,dataType:dataType,params:{type:newMode,ranges:[{from:0,to:DEFAULT_INTERVAL,label:""}],maxBars:maxBarsDefaultValue,format:currentColumn.params.format,parentFormat:parentFormat}})})}}))};return external_kbnSharedDeps_React_default.a.createElement(RangeEditor,{setParam:setParam,maxBars:currentColumn.params.maxBars===AUTO_BARS?maxBarsDefaultValue:currentColumn.params.maxBars,granularityStep:granularityStep,params:currentColumn.params,onChangeMode:onChangeMode,maxHistogramBars:uiSettings.get(common_["UI_SETTINGS"].HISTOGRAM_MAX_BARS),rangeFormatter:rangeFormatter})}};var column_types=__webpack_require__(39);function definitions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function definitions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){definitions_ownKeys(Object(source),true).forEach((function(key){definitions_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{definitions_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function definitions_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const internalOperationDefinitions=[filtersOperation,termsOperation,dateHistogramOperation,minOperation,maxOperation,averageOperation,cardinalityOperation,sumOperation,medianOperation,countOperation,rangeOperation,cumulativeSumOperation,counterRateOperation,derivativeOperation,movingAverageOperation];const operationDefinitions=internalOperationDefinitions;const operationDefinitionMap=internalOperationDefinitions.reduce((definitionMap,definition)=>definitions_objectSpread(definitions_objectSpread({},definitionMap),{},{[definition.type]:definition}),{});const documentField={displayName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.records",{defaultMessage:"Records"}),name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.records",{defaultMessage:"Records"}),type:"document",aggregatable:true,searchable:true};function getOperations(){return Object.keys(operationDefinitionMap)}function getOperationDisplay(){const display={};operationDefinitions.forEach(({type:type,displayName:displayName})=>{display[type]={type:type,displayName:displayName}});return display}function getSortScoreByPriority(a,b){return(b.priority||Number.NEGATIVE_INFINITY)-(a.priority||Number.NEGATIVE_INFINITY)}function getOperationTypesForField(field){return operationDefinitions.filter(operationDefinition=>operationDefinition.input==="field"&&operationDefinition.getPossibleOperationForField(field)).sort(getSortScoreByPriority).map(({type:type})=>type)}let documentOperations;function isDocumentOperation(type){documentOperations=documentOperations||new Set(getOperationTypesForField(documentField));return documentOperations.has(type)}function getAvailableOperationsByMetadata(indexPattern){const operationByMetadata={};const addToMap=(operation,operationMetadata)=>{if(!operationMetadata)return;const key=JSON.stringify(operationMetadata);if(operationByMetadata[key]){operationByMetadata[key].operations.push(operation)}else{operationByMetadata[key]={operationMetaData:operationMetadata,operations:[operation]}}};operationDefinitions.sort(getSortScoreByPriority).forEach(operationDefinition=>{if(operationDefinition.input==="field"){indexPattern.fields.forEach(field=>{addToMap({type:"field",operationType:operationDefinition.type,field:field.name},operationDefinition.getPossibleOperationForField(field))})}else if(operationDefinition.input==="none"){addToMap({type:"none",operationType:operationDefinition.type},operationDefinition.getPossibleOperation())}else if(operationDefinition.input==="fullReference"){addToMap({type:"fullReference",operationType:operationDefinition.type},operationDefinition.getPossibleOperation())}});return Object.values(operationByMetadata)}const createMockedReferenceOperation=()=>({input:"fullReference",displayName:"Reference test",type:"testReference",selectionStyle:"full",requiredReferences:[{input:["none","field"],validateMetadata:meta=>meta.dataType==="number"&&!meta.isBucketed}],buildColumn:jest.fn(args=>({label:"Test reference",isBucketed:false,dataType:"number",operationType:"testReference",references:args.referenceIds})),isTransferable:jest.fn(),toExpression:jest.fn().mockReturnValue([]),getPossibleOperation:jest.fn().mockReturnValue({dataType:"number",isBucketed:false}),getDefaultLabel:jest.fn().mockReturnValue("Default label")});const settings_storage_STORAGE_KEY="lens-settings";const readFromStorage=(storage,key)=>{const data=storage.get(settings_storage_STORAGE_KEY);return data&&data[key]};const writeToStorage=(storage,key,value)=>{storage.set(settings_storage_STORAGE_KEY,{[key]:value})};function fieldExists(existingFields,indexPatternTitle,fieldName){return existingFields[indexPatternTitle]&&existingFields[indexPatternTitle][fieldName]}function getFieldByNameFactory(newFields){const fieldsLookup=Object(external_kbnSharedDeps_Lodash_["keyBy"])(newFields,"name");return name=>fieldsLookup[name]}function loader_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function loader_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){loader_ownKeys(Object(source),true).forEach((function(key){loader_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{loader_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function loader_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function loader_objectWithoutProperties(source,excluded){if(source==null)return{};var target=loader_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function loader_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function loader_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function loader_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){loader_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){loader_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function loadIndexPatterns(_x){return _loadIndexPatterns.apply(this,arguments)}function _loadIndexPatterns(){_loadIndexPatterns=loader_asyncToGenerator(regeneratorRuntime.mark((function _callee({indexPatternsService:indexPatternsService,patterns:patterns,cache:cache}){var missingIds,indexPatterns,indexPatternsObject;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:missingIds=patterns.filter(id=>!cache[id]);if(!(missingIds.length===0)){_context.next=3;break}return _context.abrupt("return",cache);case 3:_context.next=5;return Promise.all(missingIds.map(id=>indexPatternsService.get(id)));case 5:indexPatterns=_context.sent;indexPatternsObject=indexPatterns.reduce((acc,indexPattern)=>{const newFields=indexPattern.fields.filter(field=>!public_["indexPatterns"].isNestedField(field)&&(!!field.aggregatable||!!field.scripted)).map(field=>{const base={name:field.name,displayName:field.displayName,type:field.type,aggregatable:field.aggregatable,searchable:field.searchable,meta:indexPattern.metaFields.includes(field.name),esTypes:field.esTypes,scripted:field.scripted};return base.scripted?loader_objectSpread(loader_objectSpread({},base),{},{lang:field.lang,script:field.script}):base}).concat(documentField);const typeMeta=indexPattern.typeMeta,title=indexPattern.title,timeFieldName=indexPattern.timeFieldName,fieldFormatMap=indexPattern.fieldFormatMap;if(typeMeta===null||typeMeta===void 0?void 0:typeMeta.aggs){const aggs=Object.keys(typeMeta.aggs);newFields.forEach((field,index)=>{const restrictionsObj={};aggs.forEach(agg=>{const restriction=typeMeta.aggs&&typeMeta.aggs[agg]&&typeMeta.aggs[agg][field.name];if(restriction){restrictionsObj[agg]=restriction}});if(Object.keys(restrictionsObj).length){newFields[index]=loader_objectSpread(loader_objectSpread({},field),{},{aggregationRestrictions:restrictionsObj})}})}const currentIndexPattern={id:indexPattern.id,title:title,timeFieldName:timeFieldName,fieldFormatMap:fieldFormatMap&&Object.fromEntries(Object.entries(fieldFormatMap).map(([id,format])=>[id,"toJSON"in format?format.toJSON():format])),fields:newFields,getFieldByName:getFieldByNameFactory(newFields),hasRestrictions:!!(typeMeta===null||typeMeta===void 0?void 0:typeMeta.aggs)};return loader_objectSpread({[currentIndexPattern.id]:currentIndexPattern},acc)},loader_objectSpread({},cache));return _context.abrupt("return",indexPatternsObject);case 8:case"end":return _context.stop()}}),_callee)})));return _loadIndexPatterns.apply(this,arguments)}const getLastUsedIndexPatternId=(storage,indexPatternRefs)=>{var _indexPatternRefs$fin;const indexPattern=readFromStorage(storage,"indexPatternId");return indexPattern&&((_indexPatternRefs$fin=indexPatternRefs.find(i=>i.id===indexPattern))===null||_indexPatternRefs$fin===void 0?void 0:_indexPatternRefs$fin.id)};const setLastUsedIndexPatternId=(storage,value)=>{writeToStorage(storage,"indexPatternId",value)};const CURRENT_PATTERN_REFERENCE_NAME="indexpattern-datasource-current-indexpattern";function getLayerReferenceName(layerId){return"indexpattern-datasource-layer-".concat(layerId)}function extractReferences({currentIndexPatternId:currentIndexPatternId,layers:layers}){const savedObjectReferences=[];savedObjectReferences.push({type:"index-pattern",id:currentIndexPatternId,name:CURRENT_PATTERN_REFERENCE_NAME});const persistableLayers={};Object.entries(layers).forEach(([layerId,_ref])=>{let indexPatternId=_ref.indexPatternId,persistableLayer=loader_objectWithoutProperties(_ref,["indexPatternId"]);savedObjectReferences.push({type:"index-pattern",id:indexPatternId,name:getLayerReferenceName(layerId)});persistableLayers[layerId]=persistableLayer});return{savedObjectReferences:savedObjectReferences,state:{layers:persistableLayers}}}function injectReferences(state,references){const layers={};Object.entries(state.layers).forEach(([layerId,persistedLayer])=>{layers[layerId]=loader_objectSpread(loader_objectSpread({},persistedLayer),{},{indexPatternId:references.find(({name:name})=>name===getLayerReferenceName(layerId)).id})});return{currentIndexPatternId:references.find(({name:name})=>name===CURRENT_PATTERN_REFERENCE_NAME).id,layers:layers}}function loadInitialState(_x2){return _loadInitialState.apply(this,arguments)}function _loadInitialState(){_loadInitialState=loader_asyncToGenerator(regeneratorRuntime.mark((function _callee2({persistedState:persistedState,references:references,savedObjectsClient:savedObjectsClient,defaultIndexPatternId:defaultIndexPatternId,storage:storage,indexPatternsService:indexPatternsService,initialContext:initialContext}){var _initialContext$index;var indexPatternRefs,lastUsedIndexPatternId,state,requiredPatterns,currentIndexPatternId,indexPatterns;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return loadIndexPatternRefs(savedObjectsClient);case 2:indexPatternRefs=_context2.sent;lastUsedIndexPatternId=getLastUsedIndexPatternId(storage,indexPatternRefs);state=persistedState&&references?injectReferences(persistedState,references):undefined;requiredPatterns=external_kbnSharedDeps_Lodash_default.a.uniq(state?Object.values(state.layers).map(l=>l.indexPatternId).concat(state.currentIndexPatternId):[lastUsedIndexPatternId||defaultIndexPatternId||indexPatternRefs[0].id]);currentIndexPatternId=(_initialContext$index=initialContext===null||initialContext===void 0?void 0:initialContext.indexPatternId)!==null&&_initialContext$index!==void 0?_initialContext$index:requiredPatterns[0];setLastUsedIndexPatternId(storage,currentIndexPatternId);_context2.next=10;return loadIndexPatterns({indexPatternsService:indexPatternsService,cache:{},patterns:initialContext?[initialContext.indexPatternId]:requiredPatterns});case 10:indexPatterns=_context2.sent;if(!state){_context2.next=13;break}return _context2.abrupt("return",loader_objectSpread(loader_objectSpread({},state),{},{currentIndexPatternId:currentIndexPatternId,indexPatternRefs:indexPatternRefs,indexPatterns:indexPatterns,existingFields:{},isFirstExistenceFetch:true}));case 13:return _context2.abrupt("return",{currentIndexPatternId:currentIndexPatternId,indexPatternRefs:indexPatternRefs,indexPatterns:indexPatterns,layers:{},existingFields:{},isFirstExistenceFetch:true});case 14:case"end":return _context2.stop()}}),_callee2)})));return _loadInitialState.apply(this,arguments)}function loader_changeIndexPattern(_x3){return _changeIndexPattern.apply(this,arguments)}function _changeIndexPattern(){_changeIndexPattern=loader_asyncToGenerator(regeneratorRuntime.mark((function _callee3({id:id,state:state,setState:setState,onError:onError,storage:storage,indexPatternsService:indexPatternsService}){var indexPatterns;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return loadIndexPatterns({indexPatternsService:indexPatternsService,cache:state.indexPatterns,patterns:[id]});case 3:indexPatterns=_context3.sent;setState(s=>loader_objectSpread(loader_objectSpread({},s),{},{layers:isSingleEmptyLayer(state.layers)?external_kbnSharedDeps_Lodash_default.a.mapValues(state.layers,layer=>updateLayerIndexPattern(layer,indexPatterns[id])):state.layers,indexPatterns:loader_objectSpread(loader_objectSpread({},s.indexPatterns),{},{[id]:indexPatterns[id]}),currentIndexPatternId:id}));setLastUsedIndexPatternId(storage,id);_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3["catch"](0);onError(_context3.t0);case 11:case"end":return _context3.stop()}}),_callee3,null,[[0,8]])})));return _changeIndexPattern.apply(this,arguments)}function changeLayerIndexPattern(_x4){return _changeLayerIndexPattern.apply(this,arguments)}function _changeLayerIndexPattern(){_changeLayerIndexPattern=loader_asyncToGenerator(regeneratorRuntime.mark((function _callee4({indexPatternId:indexPatternId,layerId:layerId,state:state,setState:setState,onError:onError,replaceIfPossible:replaceIfPossible,storage:storage,indexPatternsService:indexPatternsService}){var indexPatterns;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return loadIndexPatterns({indexPatternsService:indexPatternsService,cache:state.indexPatterns,patterns:[indexPatternId]});case 3:indexPatterns=_context4.sent;setState(s=>loader_objectSpread(loader_objectSpread({},s),{},{layers:loader_objectSpread(loader_objectSpread({},s.layers),{},{[layerId]:updateLayerIndexPattern(s.layers[layerId],indexPatterns[indexPatternId])}),indexPatterns:loader_objectSpread(loader_objectSpread({},s.indexPatterns),{},{[indexPatternId]:indexPatterns[indexPatternId]}),currentIndexPatternId:replaceIfPossible?indexPatternId:s.currentIndexPatternId}));setLastUsedIndexPatternId(storage,indexPatternId);_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4["catch"](0);onError(_context4.t0);case 11:case"end":return _context4.stop()}}),_callee4,null,[[0,8]])})));return _changeLayerIndexPattern.apply(this,arguments)}function loadIndexPatternRefs(_x5){return _loadIndexPatternRefs.apply(this,arguments)}function _loadIndexPatternRefs(){_loadIndexPatternRefs=loader_asyncToGenerator(regeneratorRuntime.mark((function _callee5(savedObjectsClient){var result;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.next=2;return savedObjectsClient.find({type:"index-pattern",fields:["title"],perPage:1e4});case 2:result=_context5.sent;return _context5.abrupt("return",result.savedObjects.map(o=>({id:String(o.id),title:o.attributes.title})).sort((a,b)=>a.title.localeCompare(b.title)));case 4:case"end":return _context5.stop()}}),_callee5)})));return _loadIndexPatternRefs.apply(this,arguments)}function syncExistingFields(_x6){return _syncExistingFields.apply(this,arguments)}function _syncExistingFields(){_syncExistingFields=loader_asyncToGenerator(regeneratorRuntime.mark((function _callee6({indexPatterns:indexPatterns,dateRange:dateRange,fetchJson:fetchJson,setState:setState,isFirstExistenceFetch:isFirstExistenceFetch,currentIndexPatternTitle:currentIndexPatternTitle,dslQuery:dslQuery,showNoDataPopover:showNoDataPopover}){var existenceRequests,emptinessInfo,fieldsCurrentIndexPattern;return regeneratorRuntime.wrap((function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:existenceRequests=indexPatterns.map(pattern=>{if(pattern.hasRestrictions){return{indexPatternTitle:pattern.title,existingFieldNames:pattern.fields.map(field=>field.name)}}const body={dslQuery:dslQuery,fromDate:dateRange.fromDate,toDate:dateRange.toDate};if(pattern.timeFieldName){body.timeFieldName=pattern.timeFieldName}return fetchJson("".concat(common["BASE_API_URL"],"/existing_fields/").concat(pattern.id),{body:JSON.stringify(body)})});_context6.prev=1;_context6.next=4;return Promise.all(existenceRequests);case 4:emptinessInfo=_context6.sent;if(isFirstExistenceFetch){fieldsCurrentIndexPattern=emptinessInfo.find(info=>info.indexPatternTitle===currentIndexPatternTitle);if(fieldsCurrentIndexPattern&&fieldsCurrentIndexPattern.existingFieldNames.length===0){showNoDataPopover()}}setState(state=>loader_objectSpread(loader_objectSpread({},state),{},{isFirstExistenceFetch:false,existenceFetchFailed:false,existingFields:emptinessInfo.reduce((acc,info)=>{acc[info.indexPatternTitle]=booleanMap(info.existingFieldNames);return acc},state.existingFields)}));_context6.next=12;break;case 9:_context6.prev=9;_context6.t0=_context6["catch"](1);setState(state=>loader_objectSpread(loader_objectSpread({},state),{},{existenceFetchFailed:true,existingFields:indexPatterns.reduce((acc,pattern)=>{acc[pattern.title]=booleanMap(pattern.fields.map(field=>field.name));return acc},state.existingFields)}));case 12:case"end":return _context6.stop()}}),_callee6,null,[[1,9]])})));return _syncExistingFields.apply(this,arguments)}function booleanMap(keys){return keys.reduce((acc,key)=>{acc[key]=true;return acc},{})}function isSingleEmptyLayer(layerMap){const layers=Object.values(layerMap);return layers.length===1&&layers[0].columnOrder.length===0}function indexpattern_datasource_to_expression_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function indexpattern_datasource_to_expression_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){indexpattern_datasource_to_expression_ownKeys(Object(source),true).forEach((function(key){indexpattern_datasource_to_expression_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{indexpattern_datasource_to_expression_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function indexpattern_datasource_to_expression_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getExpressionForLayer(layer,indexPattern){const columns=layer.columns,columnOrder=layer.columnOrder;if(columnOrder.length===0){return null}const columnEntries=columnOrder.map(colId=>[colId,columns[colId]]);if(columnEntries.length){const aggs=[];const expressions=[];columnEntries.forEach(([colId,col])=>{const def=operationDefinitionMap[col.operationType];if(def.input==="fullReference"){expressions.push(...def.toExpression(layer,colId,indexPattern))}else{aggs.push(def.toEsAggsConfig(col,colId,indexPattern))}});const idMap=columnEntries.reduce((currentIdMap,[colId,column],index)=>indexpattern_datasource_to_expression_objectSpread(indexpattern_datasource_to_expression_objectSpread({},currentIdMap),{},{["col-".concat(columnEntries.length===1?0:index,"-").concat(colId)]:indexpattern_datasource_to_expression_objectSpread(indexpattern_datasource_to_expression_objectSpread({},column),{},{id:colId})}),{});const columnsWithFormatters=columnEntries.filter(([,col])=>col.params&&("format"in col.params&&col.params.format||"parentFormat"in col.params&&col.params.parentFormat));const formatterOverrides=columnsWithFormatters.map(([id,col])=>{var _format$params;const parentFormat="parentFormat"in col.params?col.params.parentFormat:undefined;const format=col.params.format;const base={type:"function",function:"lens_format_column",arguments:{format:format?[format.id]:[""],columnId:[id],decimals:typeof(format===null||format===void 0?void 0:(_format$params=format.params)===null||_format$params===void 0?void 0:_format$params.decimals)==="number"?[format.params.decimals]:[],parentFormat:parentFormat?[JSON.stringify(parentFormat)]:[]}};return base});const allDateHistogramFields=Object.values(columns).map(column=>column.operationType===dateHistogramOperation.type?column.sourceField:null).filter(field=>Boolean(field));return{type:"expression",chain:[{type:"function",function:"esaggs",arguments:{index:[indexPattern.id],metricsAtAllLevels:[false],partialRows:[false],includeFormatHints:[true],timeFields:allDateHistogramFields,aggConfigs:[JSON.stringify(aggs)]}},{type:"function",function:"lens_rename_columns",arguments:{idMap:[JSON.stringify(idMap)]}},...formatterOverrides,...expressions]}}return null}function indexpattern_datasource_to_expression_toExpression(state,layerId){if(state.layers[layerId]){return getExpressionForLayer(state.layers[layerId],state.indexPatterns[state.layers[layerId].indexPatternId])}return null}function normalizeOperationDataType(type){return type==="document"?"number":type}function hasField(column){return"sourceField"in column}function sortByField(columns){return[...columns].sort((column1,column2)=>{if(hasField(column1)&&hasField(column2)){return column1.sourceField.localeCompare(column2.sourceField)}return column1.operationType.localeCompare(column2.operationType)})}function isDraggedField(fieldCandidate){return typeof fieldCandidate==="object"&&fieldCandidate!==null&&["id","field","indexPatternId"].every(prop=>prop in fieldCandidate)}function hasInvalidFields(state){return getInvalidLayers(state).length>0}function getInvalidLayers(state){return Object.values(state.layers).filter(layer=>layer.columnOrder.some(columnId=>{const column=layer.columns[columnId];return hasField(column)&&utils_fieldIsInvalid(column.sourceField,column.operationType,state.indexPatterns[layer.indexPatternId])}))}function getInvalidFieldsForLayer(layers,indexPatternMap){return layers.map(layer=>layer.columnOrder.filter(columnId=>{const column=layer.columns[columnId];return hasField(column)&&utils_fieldIsInvalid(column.sourceField,column.operationType,indexPatternMap[layer.indexPatternId])}))}function utils_fieldIsInvalid(sourceField,operationType,indexPattern){const operationDefinition=operationType&&operationDefinitionMap[operationType];const field=sourceField?indexPattern.getFieldByName(sourceField):undefined;return Boolean(sourceField&&operationDefinition&&!(field&&(operationDefinition===null||operationDefinition===void 0?void 0:operationDefinition.input)==="field"&&operationDefinition.getPossibleOperationForField(field)!==undefined))}var dimension_editor=__webpack_require__(147);var field_select=__webpack_require__(156);var kibanaReact_public_=__webpack_require__(23);function lens_field_icon_extends(){lens_field_icon_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return lens_field_icon_extends.apply(this,arguments)}function lens_field_icon_objectWithoutProperties(source,excluded){if(source==null)return{};var target=lens_field_icon_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function lens_field_icon_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function LensFieldIcon(_ref){let type=_ref.type,rest=lens_field_icon_objectWithoutProperties(_ref,["type"]);return external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["FieldIcon"],lens_field_icon_extends({className:"lnsFieldListPanel__fieldIcon",type:normalizeOperationDataType(type)},rest))}function field_select_extends(){field_select_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return field_select_extends.apply(this,arguments)}function field_select_slicedToArray(arr,i){return field_select_arrayWithHoles(arr)||field_select_iterableToArrayLimit(arr,i)||field_select_unsupportedIterableToArray(arr,i)||field_select_nonIterableRest()}function field_select_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function field_select_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return field_select_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return field_select_arrayLikeToArray(o,minLen)}function field_select_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function field_select_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function field_select_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function field_select_objectWithoutProperties(source,excluded){if(source==null)return{};var target=field_select_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function field_select_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function FieldSelect(_ref){var _currentIndexPattern$7;let currentIndexPattern=_ref.currentIndexPattern,incompatibleSelectedOperationType=_ref.incompatibleSelectedOperationType,selectedColumnOperationType=_ref.selectedColumnOperationType,selectedColumnSourceField=_ref.selectedColumnSourceField,operationSupportMatrix=_ref.operationSupportMatrix,onChoose=_ref.onChoose,onDeleteColumn=_ref.onDeleteColumn,existingFields=_ref.existingFields,fieldIsInvalid=_ref.fieldIsInvalid,rest=field_select_objectWithoutProperties(_ref,["currentIndexPattern","incompatibleSelectedOperationType","selectedColumnOperationType","selectedColumnSourceField","operationSupportMatrix","onChoose","onDeleteColumn","existingFields","fieldIsInvalid"]);const operationByField=operationSupportMatrix.operationByField;const memoizedFieldOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const fields=Object.keys(operationByField).sort();function isCompatibleWithCurrentOperation(fieldName){if(incompatibleSelectedOperationType){return operationByField[fieldName].has(incompatibleSelectedOperationType)}return!selectedColumnOperationType||operationByField[fieldName].has(selectedColumnOperationType)}const _$partition=external_kbnSharedDeps_Lodash_default.a.partition(fields,field=>{var _currentIndexPattern$;return((_currentIndexPattern$=currentIndexPattern.getFieldByName(field))===null||_currentIndexPattern$===void 0?void 0:_currentIndexPattern$.type)==="document"}),_$partition2=field_select_slicedToArray(_$partition,2),specialFields=_$partition2[0],normalFields=_$partition2[1];const containsData=field=>{var _currentIndexPattern$2;return((_currentIndexPattern$2=currentIndexPattern.getFieldByName(field))===null||_currentIndexPattern$2===void 0?void 0:_currentIndexPattern$2.type)==="document"||fieldExists(existingFields,currentIndexPattern.title,field)};function fieldNamesToOptions(items){return items.filter(field=>{var _currentIndexPattern$3;return(_currentIndexPattern$3=currentIndexPattern.getFieldByName(field))===null||_currentIndexPattern$3===void 0?void 0:_currentIndexPattern$3.displayName}).map(field=>{var _currentIndexPattern$4,_currentIndexPattern$5;return{label:(_currentIndexPattern$4=currentIndexPattern.getFieldByName(field))===null||_currentIndexPattern$4===void 0?void 0:_currentIndexPattern$4.displayName,value:{type:"field",field:field,dataType:(_currentIndexPattern$5=currentIndexPattern.getFieldByName(field))===null||_currentIndexPattern$5===void 0?void 0:_currentIndexPattern$5.type,operationType:selectedColumnOperationType&&isCompatibleWithCurrentOperation(field)?selectedColumnOperationType:undefined},exists:containsData(field),compatible:isCompatibleWithCurrentOperation(field)}}).sort((a,b)=>{if(a.compatible&&!b.compatible){return-1}if(!a.compatible&&b.compatible){return 1}return 0}).map(({label:label,value:value,compatible:compatible,exists:exists})=>({label:label,value:value,className:classnames_default()({"lnFieldSelect__option--incompatible":!compatible,"lnFieldSelect__option--nonExistant":!exists}),"data-test-subj":"lns-fieldOption".concat(compatible?"":"Incompatible","-").concat(value.field)}))}const _$partition3=external_kbnSharedDeps_Lodash_default.a.partition(normalFields,field=>{var _currentIndexPattern$6;return(_currentIndexPattern$6=currentIndexPattern.getFieldByName(field))===null||_currentIndexPattern$6===void 0?void 0:_currentIndexPattern$6.meta}),_$partition4=field_select_slicedToArray(_$partition3,2),metaFields=_$partition4[0],nonMetaFields=_$partition4[1];const _$partition5=external_kbnSharedDeps_Lodash_default.a.partition(nonMetaFields,containsData),_$partition6=field_select_slicedToArray(_$partition5,2),availableFields=_$partition6[0],emptyFields=_$partition6[1];const constructFieldsOptions=(fieldsArr,label)=>fieldsArr.length>0&&{label:label,options:fieldNamesToOptions(fieldsArr)};const availableFieldsOptions=constructFieldsOptions(availableFields,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.availableFieldsLabel",{defaultMessage:"Available fields"}));const emptyFieldsOptions=constructFieldsOptions(emptyFields,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.emptyFieldsLabel",{defaultMessage:"Empty fields"}));const metaFieldsOptions=constructFieldsOptions(metaFields,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.metaFieldsLabel",{defaultMessage:"Meta fields"}));return[...fieldNamesToOptions(specialFields),availableFieldsOptions,emptyFieldsOptions,metaFieldsOptions].filter(Boolean)},[incompatibleSelectedOperationType,selectedColumnOperationType,currentIndexPattern,operationByField,existingFields]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],field_select_extends({fullWidth:true,compressed:true,isClearable:false,"data-test-subj":"indexPattern-dimension-field",placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldPlaceholder",{defaultMessage:"Field"}),options:memoizedFieldOptions,isInvalid:Boolean(incompatibleSelectedOperationType||fieldIsInvalid),selectedOptions:selectedColumnOperationType&&selectedColumnSourceField?[{label:fieldIsInvalid?selectedColumnSourceField:(_currentIndexPattern$7=currentIndexPattern.getFieldByName(selectedColumnSourceField))===null||_currentIndexPattern$7===void 0?void 0:_currentIndexPattern$7.displayName,value:{type:"field",field:selectedColumnSourceField}}]:[],singleSelection:{asPlainText:true},onChange:choices=>{if(choices.length===0){onDeleteColumn();return}factory_trackUiEvent("indexpattern_dimension_field_changed");onChoose(choices[0].value)},renderOption:(option,searchValue)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:null},external_kbnSharedDeps_React_default.a.createElement(LensFieldIcon,{type:option.value.dataType,fill:"none"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHighlight"],{search:searchValue},option.label)))},rest))}function bucket_nesting_editor_slicedToArray(arr,i){return bucket_nesting_editor_arrayWithHoles(arr)||bucket_nesting_editor_iterableToArrayLimit(arr,i)||bucket_nesting_editor_unsupportedIterableToArray(arr,i)||bucket_nesting_editor_nonIterableRest()}function bucket_nesting_editor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bucket_nesting_editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return bucket_nesting_editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bucket_nesting_editor_arrayLikeToArray(o,minLen)}function bucket_nesting_editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function bucket_nesting_editor_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function bucket_nesting_editor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function nestColumn(columnOrder,outer,inner){const result=columnOrder.filter(c=>c!==inner);const outerPosition=result.indexOf(outer);result.splice(outerPosition+1,0,inner);return result}function getFieldName(column,getFieldByName){var _getFieldByName;return hasField(column)?((_getFieldByName=getFieldByName(column.sourceField))===null||_getFieldByName===void 0?void 0:_getFieldByName.displayName)||column.sourceField:""}function BucketNestingEditor({columnId:columnId,layer:layer,setColumns:setColumns,getFieldByName:getFieldByName}){const column=layer.columns[columnId];const columns=Object.entries(layer.columns);const aggColumns=columns.filter(([id,c])=>id!==columnId&&c.isBucketed).map(([value,c])=>({value:value,text:c.label,fieldName:getFieldName(c,getFieldByName),operationType:c.operationType}));if(!column||!column.isBucketed||!aggColumns.length){return null}const prevColumn=layer.columnOrder[layer.columnOrder.indexOf(columnId)-1];if(aggColumns.length===1){const _aggColumns=bucket_nesting_editor_slicedToArray(aggColumns,1),target=_aggColumns[0];const useAsTopLevelAggCopy=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.useAsTopLevelAgg",{defaultMessage:"Group by this field first"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:useAsTopLevelAggCopy,display:"columnCompressedSwitch"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{compressed:true,label:useAsTopLevelAggCopy,showLabel:false,"data-test-subj":"indexPattern-nesting-switch",name:"nestingSwitch",checked:!prevColumn,onChange:()=>{if(prevColumn){setColumns(nestColumn(layer.columnOrder,columnId,target.value))}else{setColumns(nestColumn(layer.columnOrder,target.value,columnId))}}}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.groupByDropdown",{defaultMessage:"Group by"}),display:"columnCompressed",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,"data-test-subj":"indexPattern-nesting-select",options:[{value:"",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.nestUnderRoot",{defaultMessage:"Entire data set"})},...aggColumns.map(({value:value,text:text})=>({value:value,text:text}))],value:prevColumn,onChange:e=>setColumns(nestColumn(layer.columnOrder,e.target.value,columnId))}))}function format_selector_slicedToArray(arr,i){return format_selector_arrayWithHoles(arr)||format_selector_iterableToArrayLimit(arr,i)||format_selector_unsupportedIterableToArray(arr,i)||format_selector_nonIterableRest()}function format_selector_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function format_selector_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return format_selector_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return format_selector_arrayLikeToArray(o,minLen)}function format_selector_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function format_selector_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function format_selector_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const format_selector_supportedFormats={number:{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.numberFormatLabel",{defaultMessage:"Number"})},percent:{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.percentFormatLabel",{defaultMessage:"Percent"})},bytes:{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.bytesFormatLabel",{defaultMessage:"Bytes (1024)"})}};function FormatSelector(props){var _currentFormat$params,_selectedFormat$title;const selectedColumn=props.selectedColumn,_onChange=props.onChange;const currentFormat="params"in selectedColumn&&selectedColumn.params&&"format"in selectedColumn.params?selectedColumn.params.format:undefined;const _useState=Object(external_kbnSharedDeps_React_["useState"])({decimalPlaces:typeof(currentFormat===null||currentFormat===void 0?void 0:(_currentFormat$params=currentFormat.params)===null||_currentFormat$params===void 0?void 0:_currentFormat$params.decimals)==="number"?currentFormat.params.decimals:2}),_useState2=format_selector_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];const selectedFormat=(currentFormat===null||currentFormat===void 0?void 0:currentFormat.id)?format_selector_supportedFormats[currentFormat.id]:undefined;const defaultOption={value:"",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.defaultFormatLabel",{defaultMessage:"Default"})};const label=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.columnFormatLabel",{defaultMessage:"Value format"});const decimalsLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.decimalPlacesLabel",{defaultMessage:"Decimals"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,display:"columnCompressed",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{fullWidth:true,compressed:true,isClearable:false,"data-test-subj":"indexPattern-dimension-format","aria-label":label,singleSelection:{asPlainText:true},options:[defaultOption,...Object.entries(format_selector_supportedFormats).map(([id,format])=>{var _format$title;return{value:id,label:(_format$title=format.title)!==null&&_format$title!==void 0?_format$title:id}})],selectedOptions:currentFormat?[{value:currentFormat.id,label:(_selectedFormat$title=selectedFormat===null||selectedFormat===void 0?void 0:selectedFormat.title)!==null&&_selectedFormat$title!==void 0?_selectedFormat$title:currentFormat.id}]:[defaultOption],onChange:choices=>{if(choices.length===0){return}if(!choices[0].value){_onChange();return}_onChange({id:choices[0].value,params:{decimals:state.decimalPlaces}})}}),currentFormat?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRange"],{showInput:"inputWithPopover",min:0,max:20,value:state.decimalPlaces,onChange:e=>{setState({decimalPlaces:Number(e.currentTarget.value)});_onChange({id:selectedColumn.params.format.id,params:{decimals:Number(e.currentTarget.value)}})},"data-test-subj":"indexPattern-dimension-formatDecimals",compressed:true,fullWidth:true,prepend:decimalsLabel,"aria-label":decimalsLabel})):null)))}function dimension_editor_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function dimension_editor_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){dimension_editor_ownKeys(Object(source),true).forEach((function(key){dimension_editor_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{dimension_editor_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function dimension_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function dimension_editor_slicedToArray(arr,i){return dimension_editor_arrayWithHoles(arr)||dimension_editor_iterableToArrayLimit(arr,i)||dimension_editor_unsupportedIterableToArray(arr,i)||dimension_editor_nonIterableRest()}function dimension_editor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dimension_editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return dimension_editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dimension_editor_arrayLikeToArray(o,minLen)}function dimension_editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function dimension_editor_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function dimension_editor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const operationPanels=getOperationDisplay();const dimension_editor_LabelInput=({value:value,onChange:onChange})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(value),_useState2=dimension_editor_slicedToArray(_useState,2),inputValue=_useState2[0],setInputValue=_useState2[1];const onChangeDebounced=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_Lodash_default.a.debounce(onChange,256),[onChange]);const handleInputChange=e=>{const val=String(e.target.value);setInputValue(val);onChangeDebounced(val)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.columnLabel",{defaultMessage:"Display name",description:"Display name of a column of data"}),display:"columnCompressed",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{compressed:true,"data-test-subj":"indexPattern-label-edit",value:inputValue,onChange:handleInputChange}))};function dimension_editor_DimensionEditor(props){const selectedColumn=props.selectedColumn,operationSupportMatrix=props.operationSupportMatrix,state=props.state,columnId=props.columnId,setState=props.setState,layerId=props.layerId,currentIndexPattern=props.currentIndexPattern,hideGrouping=props.hideGrouping;const fieldByOperation=operationSupportMatrix.fieldByOperation,operationWithoutField=operationSupportMatrix.operationWithoutField;const _useState3=Object(external_kbnSharedDeps_React_["useState"])(null),_useState4=dimension_editor_slicedToArray(_useState3,2),incompatibleSelectedOperationType=_useState4[0],setInvalidOperationType=_useState4[1];const selectedOperationDefinition=selectedColumn&&operationDefinitionMap[selectedColumn.operationType];const ParamEditor=selectedOperationDefinition===null||selectedOperationDefinition===void 0?void 0:selectedOperationDefinition.paramEditor;const possibleOperations=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object.values(operationDefinitionMap).sort((op1,op2)=>op1.displayName.localeCompare(op2.displayName)).map(def=>def.type).filter(type=>{var _fieldByOperation$typ;return((_fieldByOperation$typ=fieldByOperation[type])===null||_fieldByOperation$typ===void 0?void 0:_fieldByOperation$typ.size)||operationWithoutField.has(type)}),[fieldByOperation,operationWithoutField]);const operationsWithCompatibility=[...possibleOperations].map(operationType=>{var _fieldByOperation$ope;const definition=operationDefinitionMap[operationType];return{operationType:operationType,compatibleWithCurrentField:!selectedColumn||selectedColumn&&hasField(selectedColumn)&&definition.input==="field"&&((_fieldByOperation$ope=fieldByOperation[operationType])===null||_fieldByOperation$ope===void 0?void 0:_fieldByOperation$ope.has(selectedColumn.sourceField))||selectedColumn&&!hasField(selectedColumn)&&definition.input!=="field"}});const selectedColumnSourceField=selectedColumn&&"sourceField"in selectedColumn?selectedColumn.sourceField:undefined;const currentFieldIsInvalid=Object(external_kbnSharedDeps_React_["useMemo"])(()=>utils_fieldIsInvalid(selectedColumnSourceField,selectedColumn===null||selectedColumn===void 0?void 0:selectedColumn.operationType,currentIndexPattern),[selectedColumnSourceField,selectedColumn===null||selectedColumn===void 0?void 0:selectedColumn.operationType,currentIndexPattern]);const sideNavItems=operationsWithCompatibility.map(({operationType:operationType,compatibleWithCurrentField:compatibleWithCurrentField})=>{const isActive=Boolean(incompatibleSelectedOperationType===operationType||!incompatibleSelectedOperationType&&selectedColumn&&selectedColumn.operationType===operationType);let color="primary";if(isActive){color="text"}else if(!compatibleWithCurrentField){color="subdued"}let label=operationPanels[operationType].displayName;if(isActive){label=external_kbnSharedDeps_React_default.a.createElement("strong",null,operationPanels[operationType].displayName)}return{id:operationType,label:label,color:color,isActive:isActive,size:"s",className:"lnsIndexPatternDimensionEditor__operation","data-test-subj":"lns-indexPatternDimension-".concat(operationType).concat(compatibleWithCurrentField?"":" incompatible"),onClick(){if(operationDefinitionMap[operationType].input==="none"){setInvalidOperationType(null);if((selectedColumn===null||selectedColumn===void 0?void 0:selectedColumn.operationType)===operationType){return}const newLayer=insertOrReplaceColumn({layer:props.state.layers[props.layerId],indexPattern:currentIndexPattern,columnId:columnId,op:operationType});setState(mergeLayer({state:state,layerId:layerId,newLayer:newLayer}));factory_trackUiEvent("indexpattern_dimension_operation_".concat(operationType));return}else if(!selectedColumn||!compatibleWithCurrentField){const possibleFields=fieldByOperation[operationType]||new Set;if(possibleFields.size===1){setState(mergeLayer({state:state,layerId:layerId,newLayer:insertOrReplaceColumn({layer:props.state.layers[props.layerId],indexPattern:currentIndexPattern,columnId:columnId,op:operationType,field:currentIndexPattern.getFieldByName(possibleFields.values().next().value)})}))}else{setInvalidOperationType(operationType)}factory_trackUiEvent("indexpattern_dimension_operation_".concat(operationType));return}setInvalidOperationType(null);if(selectedColumn.operationType===operationType){return}const newLayer=replaceColumn({layer:props.state.layers[props.layerId],indexPattern:currentIndexPattern,columnId:columnId,op:operationType,field:hasField(selectedColumn)?currentIndexPattern.getFieldByName(selectedColumn.sourceField):undefined});setState(mergeLayer({state:state,layerId:layerId,newLayer:newLayer}))}}});return external_kbnSharedDeps_React_default.a.createElement("div",{id:columnId},external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsIndexPatternDimensionEditor__section lnsIndexPatternDimensionEditor__section--shaded"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.functionsLabel",{defaultMessage:"Select a function"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiListGroup"],{className:sideNavItems.length>3?"lnsIndexPatternDimensionEditor__columns":"",gutterSize:"none",listItems:sideNavItems.length%2===1?[...sideNavItems,{label:" "}]:sideNavItems,maxWidth:false})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsIndexPatternDimensionEditor__section lnsIndexPatternDimensionEditor__section--shaded"},!selectedColumn||(selectedOperationDefinition===null||selectedOperationDefinition===void 0?void 0:selectedOperationDefinition.input)==="field"||incompatibleSelectedOperationType&&operationDefinitionMap[incompatibleSelectedOperationType].input==="field"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{"data-test-subj":"indexPattern-field-selection-row",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.chooseField",{defaultMessage:"Select a field"}),fullWidth:true,isInvalid:Boolean(incompatibleSelectedOperationType||currentFieldIsInvalid),error:getErrorMessage(selectedColumn,Boolean(incompatibleSelectedOperationType),selectedOperationDefinition===null||selectedOperationDefinition===void 0?void 0:selectedOperationDefinition.input,currentFieldIsInvalid)},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{fieldIsInvalid:currentFieldIsInvalid,currentIndexPattern:currentIndexPattern,existingFields:state.existingFields,operationSupportMatrix:operationSupportMatrix,selectedColumnOperationType:selectedColumn&&selectedColumn.operationType,selectedColumnSourceField:selectedColumn&&hasField(selectedColumn)?selectedColumn.sourceField:undefined,incompatibleSelectedOperationType:incompatibleSelectedOperationType,onDeleteColumn:()=>{setState(mergeLayer({state:state,layerId:layerId,newLayer:deleteColumn({layer:state.layers[layerId],columnId:columnId})}))},onChoose:choice=>{let newLayer;if(!incompatibleSelectedOperationType&&selectedColumn&&"field"in choice&&choice.operationType===selectedColumn.operationType){newLayer=replaceColumn({layer:state.layers[layerId],columnId:columnId,indexPattern:currentIndexPattern,op:choice.operationType,field:currentIndexPattern.getFieldByName(choice.field)})}else{const compatibleOperations="field"in choice&&operationSupportMatrix.operationByField[choice.field]||new Set;let operation;if(compatibleOperations.size>0){operation=incompatibleSelectedOperationType&&compatibleOperations.has(incompatibleSelectedOperationType)?incompatibleSelectedOperationType:compatibleOperations.values().next().value}else if("field"in choice){operation=choice.operationType}newLayer=insertOrReplaceColumn({layer:state.layers[layerId],columnId:columnId,field:currentIndexPattern.getFieldByName(choice.field),indexPattern:currentIndexPattern,op:operation})}setState(mergeLayer({state:state,layerId:layerId,newLayer:newLayer}));setInvalidOperationType(null)}})):null,!currentFieldIsInvalid&&!incompatibleSelectedOperationType&&selectedColumn&&ParamEditor&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ParamEditor,{state:state,setState:setState,columnId:columnId,currentColumn:state.layers[layerId].columns[columnId],storage:props.storage,uiSettings:props.uiSettings,savedObjectsClient:props.savedObjectsClient,layerId:layerId,http:props.http,dateRange:props.dateRange,data:props.data}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),!currentFieldIsInvalid&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsIndexPatternDimensionEditor__section"},!incompatibleSelectedOperationType&&selectedColumn&&external_kbnSharedDeps_React_default.a.createElement(dimension_editor_LabelInput,{value:selectedColumn.label,onChange:value=>{setState(mergeLayer({state:state,layerId:layerId,newLayer:{columns:dimension_editor_objectSpread(dimension_editor_objectSpread({},state.layers[layerId].columns),{},{[columnId]:dimension_editor_objectSpread(dimension_editor_objectSpread({},selectedColumn),{},{label:value,customLabel:true})})}}))}}),!incompatibleSelectedOperationType&&!hideGrouping&&external_kbnSharedDeps_React_default.a.createElement(BucketNestingEditor,{layer:state.layers[props.layerId],columnId:props.columnId,setColumns:columnOrder=>setState(mergeLayer({state:state,layerId:layerId,newLayer:{columnOrder:columnOrder}})),getFieldByName:currentIndexPattern.getFieldByName}),selectedColumn&&(selectedColumn.dataType==="number"||selectedColumn.operationType==="range")?external_kbnSharedDeps_React_default.a.createElement(FormatSelector,{selectedColumn:selectedColumn,onChange:newFormat=>{setState(updateColumnParam({state:state,layerId:layerId,currentColumn:selectedColumn,paramName:"format",value:newFormat}))}}):null))}function getErrorMessage(selectedColumn,incompatibleSelectedOperationType,input,fieldInvalid){if(selectedColumn&&incompatibleSelectedOperationType){if(input==="field"){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.invalidOperationLabel",{defaultMessage:"To use this function, select a different field."})}return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.chooseFieldLabel",{defaultMessage:"To use this function, select a field."})}if(fieldInvalid){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.invalidFieldLabel",{defaultMessage:"Invalid field. Check your index pattern or pick another field."})}}const getOperationSupportMatrix=props=>{const layerId=props.layerId;const currentIndexPattern=props.state.indexPatterns[props.state.layers[layerId].indexPatternId];const filteredOperationsByMetadata=getAvailableOperationsByMetadata(currentIndexPattern).filter(operation=>props.filterOperations(operation.operationMetaData));const supportedOperationsByField={};const supportedOperationsWithoutField=new Set;const supportedFieldsByOperation={};filteredOperationsByMetadata.forEach(({operations:operations})=>{operations.forEach(operation=>{if(operation.type==="field"){var _supportedOperationsB,_supportedFieldsByOpe;if(!supportedOperationsByField[operation.field]){supportedOperationsByField[operation.field]=new Set}(_supportedOperationsB=supportedOperationsByField[operation.field])===null||_supportedOperationsB===void 0?void 0:_supportedOperationsB.add(operation.operationType);if(!supportedFieldsByOperation[operation.operationType]){supportedFieldsByOperation[operation.operationType]=new Set}(_supportedFieldsByOpe=supportedFieldsByOperation[operation.operationType])===null||_supportedFieldsByOpe===void 0?void 0:_supportedFieldsByOpe.add(operation.field)}else if(operation.type==="none"){supportedOperationsWithoutField.add(operation.operationType)}})});return{operationByField:supportedOperationsByField,operationWithoutField:supportedOperationsWithoutField,fieldByOperation:supportedFieldsByOperation}};function dimension_panel_extends(){dimension_panel_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return dimension_panel_extends.apply(this,arguments)}function wrapOnDot(str){return str?str.replace(/\./g,".​"):""}const IndexPatternDimensionTriggerComponent=function IndexPatternDimensionTrigger(props){const layerId=props.layerId;const layer=props.state.layers[layerId];const selectedColumn=layer.columns[props.columnId]||null;const currentIndexPattern=props.state.indexPatterns[layer.indexPatternId];const selectedColumnSourceField=selectedColumn&&"sourceField"in selectedColumn?selectedColumn.sourceField:undefined;const currentFieldIsInvalid=Object(external_kbnSharedDeps_React_["useMemo"])(()=>utils_fieldIsInvalid(selectedColumnSourceField,selectedColumn===null||selectedColumn===void 0?void 0:selectedColumn.operationType,currentIndexPattern),[selectedColumnSourceField,selectedColumn===null||selectedColumn===void 0?void 0:selectedColumn.operationType,currentIndexPattern]);const columnId=props.columnId,uniqueLabel=props.uniqueLabel;if(!selectedColumn){return null}const formattedLabel=wrapOnDot(uniqueLabel);if(currentFieldIsInvalid){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.configure.invalidConfigTooltip",{defaultMessage:"Invalid configuration."}),external_kbnSharedDeps_React_default.a.createElement("br",null),external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.configure.invalidConfigTooltipClick",{defaultMessage:"Click for more details."})),anchorClassName:"eui-displayBlock"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"danger",id:columnId,className:"lnsLayerPanel__triggerText","data-test-subj":"lns-dimensionTrigger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"s",type:"alert"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},selectedColumn.label))))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",id:columnId,className:"lnsLayerPanel__triggerText","data-test-subj":"lns-dimensionTrigger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"lnsLayerPanel__triggerTextLabel"},formattedLabel))))};const IndexPatternDimensionEditorComponent=function IndexPatternDimensionPanel(props){var _props$state$layers$l;const layerId=props.layerId;const currentIndexPattern=props.state.indexPatterns[(_props$state$layers$l=props.state.layers[layerId])===null||_props$state$layers$l===void 0?void 0:_props$state$layers$l.indexPatternId];const operationSupportMatrix=getOperationSupportMatrix(props);const selectedColumn=props.state.layers[layerId].columns[props.columnId]||null;return external_kbnSharedDeps_React_default.a.createElement(dimension_editor_DimensionEditor,dimension_panel_extends({},props,{currentIndexPattern:currentIndexPattern,selectedColumn:selectedColumn,operationSupportMatrix:operationSupportMatrix}))};const dimension_panel_IndexPatternDimensionTrigger=Object(external_kbnSharedDeps_React_["memo"])(IndexPatternDimensionTriggerComponent);const IndexPatternDimensionEditor=Object(external_kbnSharedDeps_React_["memo"])(IndexPatternDimensionEditorComponent);var types=__webpack_require__(10);function droppable_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function droppable_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){droppable_ownKeys(Object(source),true).forEach((function(key){droppable_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{droppable_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function droppable_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function canHandleDrop(props){const operationSupportMatrix=getOperationSupportMatrix(props);const dragging=props.dragDropContext.dragging;const layerIndexPatternId=props.state.layers[props.layerId].indexPatternId;function hasOperationForField(field){return Boolean(operationSupportMatrix.operationByField[field.name])}if(isDraggedField(dragging)){const currentColumn=props.state.layers[props.layerId].columns[props.columnId];return layerIndexPatternId===dragging.indexPatternId&&Boolean(hasOperationForField(dragging.field))&&(!currentColumn||hasField(currentColumn)&&currentColumn.sourceField!==dragging.field.name)}if(Object(types["a"])(dragging)&&dragging.layerId===props.layerId&&props.columnId!==dragging.columnId){const op=props.state.layers[props.layerId].columns[dragging.columnId];return props.filterOperations(op)}return false}function reorderElements(items,dest,src){const result=items.filter(c=>c!==src);const destIndex=items.findIndex(c=>c===src);const destPosition=result.indexOf(dest);const srcIndex=items.findIndex(c=>c===dest);result.splice(destIndex<srcIndex?destPosition+1:destPosition,0,src);return result}function droppable_onDrop(props){var _operationSupportMatr;const operationSupportMatrix=getOperationSupportMatrix(props);const setState=props.setState,state=props.state,layerId=props.layerId,columnId=props.columnId,droppedItem=props.droppedItem;if(Object(types["a"])(droppedItem)&&props.isReorder){const dropEl=columnId;setState(mergeLayer({state:state,layerId:layerId,newLayer:{columnOrder:reorderElements(state.layers[layerId].columnOrder,dropEl,droppedItem.columnId)}}));return true}function hasOperationForField(field){return Boolean(operationSupportMatrix.operationByField[field.name])}if(Object(types["a"])(droppedItem)&&droppedItem.layerId===layerId){const layer=state.layers[layerId];const op=droppable_objectSpread({},layer.columns[droppedItem.columnId]);if(!props.filterOperations(op)){return false}const newColumns=droppable_objectSpread({},layer.columns);delete newColumns[droppedItem.columnId];newColumns[columnId]=op;const newColumnOrder=[...layer.columnOrder];const oldIndex=newColumnOrder.findIndex(c=>c===droppedItem.columnId);const newIndex=newColumnOrder.findIndex(c=>c===columnId);if(newIndex===-1){newColumnOrder[oldIndex]=columnId}else{newColumnOrder.splice(oldIndex,1)}setState(mergeLayer({state:state,layerId:layerId,newLayer:{columnOrder:newColumnOrder,columns:newColumns}}));return{deleted:droppedItem.columnId}}if(!isDraggedField(droppedItem)||!hasOperationForField(droppedItem.field)){return false}const operationsForNewField=operationSupportMatrix.operationByField[droppedItem.field.name];if(!operationsForNewField||operationsForNewField.size===0){return false}const layer=state.layers[layerId];const selectedColumn=layer.columns[columnId]||null;const currentIndexPattern=state.indexPatterns[layer.indexPatternId];const fieldIsCompatibleWithCurrent=selectedColumn&&((_operationSupportMatr=operationSupportMatrix.operationByField[droppedItem.field.name])===null||_operationSupportMatr===void 0?void 0:_operationSupportMatr.has(selectedColumn.operationType));const newLayer=insertOrReplaceColumn({layer:layer,columnId:columnId,indexPattern:currentIndexPattern,op:fieldIsCompatibleWithCurrent?selectedColumn.operationType:operationsForNewField.values().next().value,field:droppedItem.field});factory_trackUiEvent("drop_onto_dimension");const hasData=Object.values(state.layers).some(({columns:columns})=>columns.length);factory_trackUiEvent(hasData?"drop_non_empty":"drop_empty");setState(mergeLayer({state:state,layerId:layerId,newLayer:newLayer}));return true}var datapanel=__webpack_require__(40);function providers_slicedToArray(arr,i){return providers_arrayWithHoles(arr)||providers_iterableToArrayLimit(arr,i)||providers_unsupportedIterableToArray(arr,i)||providers_nonIterableRest()}function providers_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function providers_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return providers_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return providers_arrayLikeToArray(o,minLen)}function providers_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function providers_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function providers_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const DragContext=external_kbnSharedDeps_React_default.a.createContext({dragging:undefined,setDragging:()=>{}});function RootDragDropProvider({children:children}){const _useState=Object(external_kbnSharedDeps_React_["useState"])({dragging:undefined}),_useState2=providers_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];const setDragging=Object(external_kbnSharedDeps_React_["useMemo"])(()=>dragging=>setState({dragging:dragging}),[setState]);return external_kbnSharedDeps_React_default.a.createElement(ChildDragDropProvider,{dragging:state.dragging,setDragging:setDragging},children)}function ChildDragDropProvider({dragging:dragging,setDragging:setDragging,children:children}){const value=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({dragging:dragging,setDragging:setDragging}),[setDragging,dragging]);return external_kbnSharedDeps_React_default.a.createElement(DragContext.Provider,{value:value},children)}const ReorderContext=external_kbnSharedDeps_React_default.a.createContext({reorderState:{reorderedItems:[],direction:"-",draggingHeight:40,isReorderOn:false,keyboardReorderMessage:"",groupId:""},setReorderState:()=>()=>{}});function ReorderProvider({id:id,children:children,className:className}){const _useState3=Object(external_kbnSharedDeps_React_["useState"])({reorderedItems:[],direction:"-",draggingHeight:40,isReorderOn:false,keyboardReorderMessage:"",groupId:id}),_useState4=providers_slicedToArray(_useState3,2),state=_useState4[0],setState=_useState4[1];const setReorderState=Object(external_kbnSharedDeps_React_["useMemo"])(()=>dispatch=>setState(dispatch),[setState]);return external_kbnSharedDeps_React_default.a.createElement("div",{className:classnames_default()(className,{"lnsDragDrop-isActiveGroup":state.isReorderOn})},external_kbnSharedDeps_React_default.a.createElement(ReorderContext.Provider,{value:{reorderState:state,setReorderState:setReorderState}},children),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiScreenReaderOnly"],null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement("p",{id:"lnsDragDrop-reorderAnnouncement","aria-live":"assertive","aria-atomic":true},state.keyboardReorderMessage),external_kbnSharedDeps_React_default.a.createElement("p",{id:"lnsDragDrop-reorderInstructions-".concat(id)},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.dragDrop.reorderInstructions",{defaultMessage:"Press space bar to start a drag. When dragging, use arrow keys to reorder. Press space bar again to finish."}))))))}var drag_drop=__webpack_require__(173);function drag_drop_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function drag_drop_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){drag_drop_ownKeys(Object(source),true).forEach((function(key){drag_drop_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{drag_drop_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function drag_drop_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function drag_drop_slicedToArray(arr,i){return drag_drop_arrayWithHoles(arr)||drag_drop_iterableToArrayLimit(arr,i)||drag_drop_unsupportedIterableToArray(arr,i)||drag_drop_nonIterableRest()}function drag_drop_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function drag_drop_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return drag_drop_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return drag_drop_arrayLikeToArray(o,minLen)}function drag_drop_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function drag_drop_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function drag_drop_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function drag_drop_extends(){drag_drop_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return drag_drop_extends.apply(this,arguments)}const DragDrop=props=>{const _useContext=Object(external_kbnSharedDeps_React_["useContext"])(DragContext),dragging=_useContext.dragging,setDragging=_useContext.setDragging;const value=props.value,draggable=props.draggable,droppable=props.droppable,isValueEqual=props.isValueEqual;return external_kbnSharedDeps_React_default.a.createElement(drag_drop_DragDropInner,drag_drop_extends({},props,{dragging:droppable?dragging:undefined,setDragging:setDragging,isDragging:!!(draggable&&(isValueEqual&&isValueEqual(value,dragging)||value===dragging)),isNotDroppable:droppable===false&&Boolean(dragging)&&value!==dragging}))};const drag_drop_DragDropInner=external_kbnSharedDeps_React_default.a.memo((function DragDropInner(props){const _useState=Object(external_kbnSharedDeps_React_["useState"])({isActive:false,dragEnterClassNames:""}),_useState2=drag_drop_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];const className=props.className,onDrop=props.onDrop,value=props.value,children=props.children,droppable=props.droppable,draggable=props.draggable,dragging=props.dragging,setDragging=props.setDragging,isDragging=props.isDragging,isNotDroppable=props.isNotDroppable,_props$dragType=props.dragType,dragType=_props$dragType===void 0?"copy":_props$dragType,_props$dropType=props.dropType,dropType=_props$dropType===void 0?"add":_props$dropType,dropTo=props.dropTo,itemsInGroup=props.itemsInGroup;const isMoveDragging=isDragging&&dragType==="move";const classes=classnames_default()("lnsDragDrop",{"lnsDragDrop-isDraggable":draggable,"lnsDragDrop-isDragging":isDragging,"lnsDragDrop-isHidden":isMoveDragging,"lnsDragDrop-isDroppable":!draggable,"lnsDragDrop-isDropTarget":droppable&&dragType!=="reorder","lnsDragDrop-isActiveDropTarget":droppable&&state.isActive&&dragType!=="reorder","lnsDragDrop-isNotDroppable":!isMoveDragging&&isNotDroppable,"lnsDragDrop-isReplacing":droppable&&state.isActive&&dropType==="replace"},state.dragEnterClassNames);const dragStart=e=>{if(e.dataTransfer.getData("text")){return}e.dataTransfer.setData("text",props.label);setState(drag_drop_objectSpread({},state));setTimeout(()=>setDragging(value))};const dragEnd=e=>{e.stopPropagation();setDragging(undefined)};const dragOver=e=>{if(!droppable){return}e.preventDefault();if(!state.isActive){setState(drag_drop_objectSpread(drag_drop_objectSpread({},state),{},{isActive:true,dragEnterClassNames:props.getAdditionalClassesOnEnter?props.getAdditionalClassesOnEnter():""}))}};const dragLeave=()=>{setState(drag_drop_objectSpread(drag_drop_objectSpread({},state),{},{isActive:false,dragEnterClassNames:""}))};const drop=e=>{e.preventDefault();e.stopPropagation();setState(drag_drop_objectSpread(drag_drop_objectSpread({},state),{},{isActive:false,dragEnterClassNames:""}));setDragging(undefined);if(onDrop&&droppable){factory_trackUiEvent("drop_total");onDrop(dragging)}};const isReorderDragging=!!(dragging&&(itemsInGroup===null||itemsInGroup===void 0?void 0:itemsInGroup.includes(dragging.id)));if(draggable&&(itemsInGroup===null||itemsInGroup===void 0?void 0:itemsInGroup.length)&&itemsInGroup.length>1&&(value===null||value===void 0?void 0:value.id)&&dropTo&&(!dragging||isReorderDragging)){const _ref=props,label=_ref.label;return external_kbnSharedDeps_React_default.a.createElement(ReorderableDragDrop,{dropTo:dropTo,label:label,className:className,dataTestSubj:props["data-test-subj"]||"lnsDragDrop",draggingProps:{className:classnames_default()(children.props.className,classes),draggable:draggable,onDragEnd:dragEnd,onDragStart:dragStart,isReorderDragging:isReorderDragging},dropProps:{onDrop:drop,onDragOver:dragOver,onDragLeave:dragLeave,dragging:dragging,droppable:droppable,itemsInGroup:itemsInGroup,id:value.id,isActive:state.isActive}},children)}return external_kbnSharedDeps_React_default.a.cloneElement(children,{"data-test-subj":props["data-test-subj"]||"lnsDragDrop",className:classnames_default()(children.props.className,classes,className),onDragOver:dragOver,onDragLeave:dragLeave,onDrop:drop,draggable:draggable,onDragEnd:dragEnd,onDragStart:dragStart})}));const getKeyboardReorderMessageMoved=(itemLabel,position,prevPosition)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.dragDrop.elementMoved",{defaultMessage:"You have moved the item {itemLabel} from position {prevPosition} to position {position}",values:{itemLabel:itemLabel,position:position,prevPosition:prevPosition}});const getKeyboardReorderMessageLifted=(itemLabel,position)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.dragDrop.elementLifted",{defaultMessage:"You have lifted an item {itemLabel} in position {position}",values:{itemLabel:itemLabel,position:position}});const lnsLayerPanelDimensionMargin=8;const ReorderableDragDrop=({draggingProps:draggingProps,dropProps:dropProps,children:children,label:label,dropTo:dropTo,className:className,dataTestSubj:dataTestSubj})=>{const itemsInGroup=dropProps.itemsInGroup,dragging=dropProps.dragging,id=dropProps.id,droppable=dropProps.droppable;const _useContext2=Object(external_kbnSharedDeps_React_["useContext"])(ReorderContext),reorderState=_useContext2.reorderState,setReorderState=_useContext2.setReorderState;const isReorderOn=reorderState.isReorderOn,reorderedItems=reorderState.reorderedItems,draggingHeight=reorderState.draggingHeight,direction=reorderState.direction,groupId=reorderState.groupId;const currentIndex=itemsInGroup.indexOf(id);Object(external_kbnSharedDeps_React_["useEffect"])(()=>setReorderState(s=>drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{isReorderOn:draggingProps.isReorderDragging})),[draggingProps.isReorderDragging,setReorderState]);return external_kbnSharedDeps_React_default.a.createElement("div",{className:classnames_default()("lnsDragDrop__reorderableContainer",className),"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiScreenReaderOnly"],{showOnFocus:true},external_kbnSharedDeps_React_default.a.createElement("button",{"aria-label":label,"aria-describedby":"lnsDragDrop-reorderInstructions-".concat(groupId),className:"lnsDragDrop__keyboardHandler","data-test-subj":"lnsDragDrop-keyboardHandler",onBlur:()=>{setReorderState(s=>drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{isReorderOn:false,keyboardReorderMessage:""}))},onKeyDown:e=>{if(e.key===external_kbnSharedDeps_ElasticEui_["keys"].ENTER||e.key===external_kbnSharedDeps_ElasticEui_["keys"].SPACE){setReorderState(s=>drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{isReorderOn:!isReorderOn,keyboardReorderMessage:isReorderOn?"":getKeyboardReorderMessageLifted(label,currentIndex+1)}))}else if(e.key===external_kbnSharedDeps_ElasticEui_["keys"].ESCAPE){setReorderState(s=>drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{isReorderOn:false,keyboardReorderMessage:""}))}if(isReorderOn){e.stopPropagation();e.preventDefault();if(external_kbnSharedDeps_ElasticEui_["keys"].ARROW_DOWN===e.key){if(currentIndex<itemsInGroup.length-1){setReorderState(s=>drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{keyboardReorderMessage:getKeyboardReorderMessageMoved(label,currentIndex+2,currentIndex+1)}));dropTo(itemsInGroup[currentIndex+1])}}else if(external_kbnSharedDeps_ElasticEui_["keys"].ARROW_UP===e.key){if(currentIndex>0){setReorderState(s=>drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{keyboardReorderMessage:getKeyboardReorderMessageMoved(label,currentIndex,currentIndex+1)}));dropTo(itemsInGroup[currentIndex-1])}}}}})),external_kbnSharedDeps_React_default.a.cloneElement(children,{["data-test-subj"]:"lnsDragDrop-reorderableDrag",draggable:draggingProps.draggable,onDragEnd:draggingProps.onDragEnd,onDragStart:e=>{const height=e.currentTarget.offsetHeight+lnsLayerPanelDimensionMargin;setReorderState(s=>drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{draggingHeight:height}));draggingProps.onDragStart(e)},className:classnames_default()(draggingProps.className,{"lnsDragDrop-isKeyboardModeActive":isReorderOn},{"lnsDragDrop-isReorderable":draggingProps.isReorderDragging}),style:reorderedItems.includes(id)?{transform:"translateY(".concat(direction).concat(draggingHeight,"px)")}:{}}),external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"lnsDragDrop-reorderableDrop",className:classnames_default()("lnsDragDrop",{["lnsDragDrop__reorderableDrop"]:dragging&&droppable}),onDrop:e=>{dropProps.onDrop(e);setReorderState(s=>drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{reorderedItems:[]}))},onDragOver:e=>{if(!droppable){return}dropProps.onDragOver(e);if(!dropProps.isActive){if(!dragging){return}const draggingIndex=itemsInGroup.indexOf(dragging.id);const droppingIndex=currentIndex;if(draggingIndex===droppingIndex){setReorderState(s=>drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{reorderedItems:[]}))}setReorderState(s=>draggingIndex<droppingIndex?drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{reorderedItems:itemsInGroup.slice(draggingIndex+1,droppingIndex+1),direction:"-"}):drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{reorderedItems:itemsInGroup.slice(droppingIndex,draggingIndex),direction:"+"}))}},onDragLeave:()=>{dropProps.onDragLeave();setReorderState(s=>drag_drop_objectSpread(drag_drop_objectSpread({},s),{},{reorderedItems:[]}))}}))};function loader_slicedToArray(arr,i){return loader_arrayWithHoles(arr)||loader_iterableToArrayLimit(arr,i)||loader_unsupportedIterableToArray(arr,i)||loader_nonIterableRest()}function loader_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function loader_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return loader_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return loader_arrayLikeToArray(o,minLen)}function loader_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function loader_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function loader_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function Loader(props){const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=loader_slicedToArray(_useState,2),isProcessing=_useState2[0],setIsProcessing=_useState2[1];const prevRequest=Object(external_kbnSharedDeps_React_["useRef"])(undefined);const nextRequest=Object(external_kbnSharedDeps_React_["useRef"])(undefined);Object(external_kbnSharedDeps_React_["useEffect"])((function performLoad(){if(prevRequest.current){nextRequest.current=performLoad;return}setIsProcessing(true);prevRequest.current=props.load().catch(()=>{}).then(()=>{const reload=nextRequest.current;prevRequest.current=undefined;nextRequest.current=undefined;if(reload){reload()}else{setIsProcessing(false)}})}),props.loadDeps);if(!isProcessing){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{size:"xs",color:"accent",position:"absolute"})}function change_indexpattern_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function change_indexpattern_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){change_indexpattern_ownKeys(Object(source),true).forEach((function(key){change_indexpattern_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{change_indexpattern_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function change_indexpattern_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function change_indexpattern_extends(){change_indexpattern_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return change_indexpattern_extends.apply(this,arguments)}function change_indexpattern_objectWithoutProperties(source,excluded){if(source==null)return{};var target=change_indexpattern_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function change_indexpattern_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function change_indexpattern_slicedToArray(arr,i){return change_indexpattern_arrayWithHoles(arr)||change_indexpattern_iterableToArrayLimit(arr,i)||change_indexpattern_unsupportedIterableToArray(arr,i)||change_indexpattern_nonIterableRest()}function change_indexpattern_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function change_indexpattern_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return change_indexpattern_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return change_indexpattern_arrayLikeToArray(o,minLen)}function change_indexpattern_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function change_indexpattern_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function change_indexpattern_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function ChangeIndexPattern({indexPatternRefs:indexPatternRefs,indexPatternId:indexPatternId,onChangeIndexPattern:onChangeIndexPattern,trigger:trigger,selectableProps:selectableProps}){const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=change_indexpattern_slicedToArray(_useState,2),isPopoverOpen=_useState2[0],setPopoverIsOpen=_useState2[1];const createTrigger=function createTrigger(){const label=trigger.label,title=trigger.title,rest=change_indexpattern_objectWithoutProperties(trigger,["label","title"]);return external_kbnSharedDeps_React_default.a.createElement(ToolbarButton,change_indexpattern_extends({title:title,onClick:()=>setPopoverIsOpen(!isPopoverOpen),fullWidth:true},rest),label)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{style:{width:"100%"},button:createTrigger(),isOpen:isPopoverOpen,closePopover:()=>setPopoverIsOpen(false),display:"block",panelPaddingSize:"s",ownFocus:true},external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:320},"data-test-subj":"lnsChangeIndexPatternPopup"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.changeIndexPatternTitle",{defaultMessage:"Change index pattern"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelectable"],change_indexpattern_extends({},selectableProps,{searchable:true,singleSelection:"always",options:indexPatternRefs.map(({title:title,id:id})=>({key:id,label:title,value:id,checked:id===indexPatternId?"on":undefined})),onChange:choices=>{const choice=choices.find(({checked:checked})=>checked);factory_trackUiEvent("indexpattern_changed");onChangeIndexPattern(choice.value);setPopoverIsOpen(false)},searchProps:change_indexpattern_objectSpread({compressed:true},selectableProps?selectableProps.searchProps:undefined)}),(list,search)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,search,list)))))}var field_list=__webpack_require__(182);var field_item=__webpack_require__(191);var elastic_datemath=__webpack_require__(200);var elastic_datemath_default=__webpack_require__.n(elastic_datemath);function debounced_component_slicedToArray(arr,i){return debounced_component_arrayWithHoles(arr)||debounced_component_iterableToArrayLimit(arr,i)||debounced_component_unsupportedIterableToArray(arr,i)||debounced_component_nonIterableRest()}function debounced_component_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function debounced_component_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return debounced_component_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return debounced_component_arrayLikeToArray(o,minLen)}function debounced_component_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function debounced_component_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function debounced_component_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function debouncedComponent(component,delay=256){const MemoizedComponent=Object(external_kbnSharedDeps_React_["memo"])(component);return props=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(props),_useState2=debounced_component_slicedToArray(_useState,2),cachedProps=_useState2[0],setCachedProps=_useState2[1];const debouncePropsChange=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(external_kbnSharedDeps_Lodash_["debounce"])(setCachedProps,delay),[setCachedProps]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>debouncePropsChange.cancel(),[debouncePropsChange]);debouncePropsChange(props);return external_kbnSharedDeps_React_default.a.createElement(MemoizedComponent,cachedProps)}}function field_item_extends(){field_item_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return field_item_extends.apply(this,arguments)}function field_item_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function field_item_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){field_item_ownKeys(Object(source),true).forEach((function(key){field_item_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{field_item_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function field_item_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function field_item_slicedToArray(arr,i){return field_item_arrayWithHoles(arr)||field_item_iterableToArrayLimit(arr,i)||field_item_unsupportedIterableToArray(arr,i)||field_item_nonIterableRest()}function field_item_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function field_item_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return field_item_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return field_item_arrayLikeToArray(o,minLen)}function field_item_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function field_item_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function field_item_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function field_item_wrapOnDot(str){return str?str.replace(/\./g,".​"):""}const field_item_InnerFieldItem=function InnerFieldItem(props){const core=props.core,field=props.field,indexPattern=props.indexPattern,highlight=props.highlight,exists=props.exists,query=props.query,dateRange=props.dateRange,filters=props.filters,hideDetails=props.hideDetails;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=field_item_slicedToArray(_useState,2),infoIsOpen=_useState2[0],setOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])({isLoading:false}),_useState4=field_item_slicedToArray(_useState3,2),state=_useState4[0],setState=_useState4[1];function fetchData(){if(state.isLoading){return}setState(s=>field_item_objectSpread(field_item_objectSpread({},s),{},{isLoading:true}));core.http.post("/api/lens/index_stats/".concat(indexPattern.title,"/field"),{body:JSON.stringify({dslQuery:public_["esQuery"].buildEsQuery(indexPattern,query,filters,public_["esQuery"].getEsQueryConfig(core.uiSettings)),fromDate:dateRange.fromDate,toDate:dateRange.toDate,timeFieldName:indexPattern.timeFieldName,field:field})}).then(results=>{setState(s=>field_item_objectSpread(field_item_objectSpread({},s),{},{isLoading:false,totalDocuments:results.totalDocuments,sampledDocuments:results.sampledDocuments,sampledValues:results.sampledValues,histogram:results.histogram,topValues:results.topValues}))}).catch(()=>{setState(s=>field_item_objectSpread(field_item_objectSpread({},s),{},{isLoading:false}))})}function togglePopover(){if(hideDetails){return}setOpen(!infoIsOpen);if(!infoIsOpen){factory_trackUiEvent("indexpattern_field_info_click");fetchData()}}const value=external_kbnSharedDeps_React_default.a.useMemo(()=>({field:field,indexPatternId:indexPattern.id,id:field.name}),[field,indexPattern.id]);const lensFieldIcon=external_kbnSharedDeps_React_default.a.createElement(LensFieldIcon,{type:field.type});const lensInfoIcon=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{anchorClassName:"lnsFieldItem__infoIcon",content:hideDetails?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldItemTooltip",{defaultMessage:"Drag and drop to visualize."}):exists?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldStatsButtonLabel",{defaultMessage:"Click for a field preview, or drag and drop to visualize."}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldStatsButtonEmptyLabel",{defaultMessage:"This field doesn’t have any data but you can still drag and drop to visualize."}),type:"iInCircle",color:"subdued",size:"s"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{ownFocus:true,className:"lnsFieldItem__popoverAnchor",display:"block","data-test-subj":"lnsFieldListPanelField",container:document.querySelector(".application")||undefined,button:external_kbnSharedDeps_React_default.a.createElement(DragDrop,{label:field.displayName,value:value,"data-test-subj":"lnsFieldListPanelField-".concat(field.name),draggable:true},external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["FieldButton"],{className:"lnsFieldItem lnsFieldItem--".concat(field.type," lnsFieldItem--").concat(exists?"exists":"missing"),isActive:infoIsOpen,onClick:togglePopover,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldStatsButtonAriaLabel",{defaultMessage:"{fieldName}: {fieldType}. Hit enter for a field preview.",values:{fieldName:field.displayName,fieldType:field.type}}),fieldIcon:lensFieldIcon,fieldName:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHighlight"],{search:field_item_wrapOnDot(highlight)},field_item_wrapOnDot(field.displayName)),fieldInfoIcon:lensInfoIcon})),isOpen:infoIsOpen,closePopover:()=>setOpen(false),anchorPosition:"rightUp",panelClassName:"lnsFieldItem__fieldPanel"},external_kbnSharedDeps_React_default.a.createElement(FieldItemPopoverContents,field_item_extends({},state,props)))};const FieldItem=debouncedComponent(field_item_InnerFieldItem);function FieldItemPopoverContents(props){const histogram=props.histogram,topValues=props.topValues,indexPattern=props.indexPattern,field=props.field,dateRange=props.dateRange,core=props.core,sampledValues=props.sampledValues,chartsThemeService=props.chartsThemeService,fieldFormats=props.data.fieldFormats;const chartTheme=chartsThemeService.useChartsTheme();const chartBaseTheme=chartsThemeService.useChartsBaseTheme();let histogramDefault=!!props.histogram;const totalValuesCount=topValues&&topValues.buckets.reduce((prev,bucket)=>bucket.count+prev,0);const otherCount=sampledValues&&totalValuesCount?sampledValues-totalValuesCount:0;if(totalValuesCount&&histogram&&histogram.buckets.length&&topValues&&topValues.buckets.length){histogramDefault=otherCount/totalValuesCount>.9}const _useState5=Object(external_kbnSharedDeps_React_["useState"])(histogramDefault),_useState6=field_item_slicedToArray(_useState5,2),showingHistogram=_useState6[0],setShowingHistogram=_useState6[1];let formatter;if(indexPattern.fieldFormatMap&&indexPattern.fieldFormatMap[field.name]){const FormatType=fieldFormats.getType(indexPattern.fieldFormatMap[field.name].id);if(FormatType){formatter=new FormatType(indexPattern.fieldFormatMap[field.name].params,core.uiSettings.get.bind(core.uiSettings))}else{formatter={convert:data=>JSON.stringify(data)}}}else{formatter=fieldFormats.getDefaultInstance(field.type,field.esTypes)}const fromDate=elastic_datemath_default.a.parse(dateRange.fromDate);const toDate=elastic_datemath_default.a.parse(dateRange.toDate);let title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null);if(props.isLoading){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],null)}else if((!props.histogram||props.histogram.buckets.length===0)&&(!props.topValues||props.topValues.buckets.length===0)){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldStatsNoData",{defaultMessage:"This field is empty because it doesn’t exist in the 500 sampled documents. Adding this field to the configuration may result in a blank chart."}))}if(histogram&&histogram.buckets.length&&topValues&&topValues.buckets.length){title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{className:"lnsFieldItem__buttonGroup",buttonSize:"compressed",isFullWidth:true,legend:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldStatsDisplayToggle",{defaultMessage:"Toggle either the"}),options:[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldTopValuesLabel",{defaultMessage:"Top values"}),id:"topValues"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldDistributionLabel",{defaultMessage:"Distribution"}),id:"histogram"}],onChange:optionId=>{setShowingHistogram(optionId==="histogram")},idSelected:showingHistogram?"histogram":"topValues"})}else if(field.type==="date"){title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldTimeDistributionLabel",{defaultMessage:"Time distribution"}))}else if(topValues&&topValues.buckets.length){title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldTopValuesLabel",{defaultMessage:"Top values"}))}function wrapInPopover(el){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,title?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,title):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null),el,props.totalDocuments?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",textAlign:"center"},props.sampledDocuments&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.percentageOfLabel",{defaultMessage:"{percentage}% of",values:{percentage:Math.round(props.sampledDocuments/props.totalDocuments*100)}}))," ",external_kbnSharedDeps_React_default.a.createElement("strong",null,fieldFormats.getDefaultInstance(public_["KBN_FIELD_TYPES"].NUMBER,[public_["ES_FIELD_TYPES"].INTEGER]).convert(props.totalDocuments))," ",external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.ofDocumentsLabel",{defaultMessage:"documents"}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null))}if(histogram&&histogram.buckets.length){const specId=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldStatsCountLabel",{defaultMessage:"Count"});if(field.type==="date"){return wrapInPopover(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],{"data-test-subj":"lnsFieldListPanel-histogram",size:{height:200,width:300-32}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],{tooltip:{type:external_kbnSharedDeps_ElasticCharts_["TooltipType"].None},theme:chartTheme,baseTheme:chartBaseTheme,xDomain:fromDate&&toDate?{min:fromDate.valueOf(),max:toDate.valueOf(),minInterval:Math.round((toDate.valueOf()-fromDate.valueOf())/10)}:undefined}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:"key",position:external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,tickFormat:fromDate&&toDate?Object(external_kbnSharedDeps_ElasticCharts_["niceTimeFormatter"])([fromDate.valueOf(),toDate.valueOf()]):undefined,showOverlappingTicks:true}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["BarSeries"],{data:histogram.buckets,id:specId,xAccessor:"key",yAccessors:["count"],xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,timeZone:"local"})))}else if(showingHistogram||!topValues||!topValues.buckets.length){return wrapInPopover(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],{"data-test-subj":"lnsFieldListPanel-histogram",size:{height:200,width:"100%"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],{rotation:90,tooltip:{type:external_kbnSharedDeps_ElasticCharts_["TooltipType"].None},theme:chartTheme,baseTheme:chartBaseTheme}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:"key",position:external_kbnSharedDeps_ElasticCharts_["Position"].Left,showOverlappingTicks:true,tickFormat:d=>formatter.convert(d)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["BarSeries"],{data:histogram.buckets,id:specId,xAccessor:"key",yAccessors:["count"],xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear})))}}if(props.topValues&&props.topValues.buckets.length){return wrapInPopover(external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"lnsFieldListPanel-topValues"},props.topValues.buckets.map(topValue=>{const formatted=formatter.convert(topValue.key);return external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsFieldItem__topValue",key:topValue.key},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"stretch",key:topValue.key,gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true,className:"eui-textTruncate"},formatted===""?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("em",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.fieldPanelEmptyStringValue",{defaultMessage:"Empty string"}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:formatted,delay:"long"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued",className:"eui-textTruncate"},formatted))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",textAlign:"left",color:"accent"},Math.round(topValue.count/props.sampledValues*100),"%"))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{className:"lnsFieldItem__topValueProgress",value:topValue.count/props.sampledValues,max:1,size:"s",color:"accent"}))}),otherCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"stretch",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true,className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",className:"eui-textTruncate",color:"subdued"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.otherDocsLabel",{defaultMessage:"Other"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},Math.round(otherCount/props.sampledValues*100),"%"))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{className:"lnsFieldItem__topValueProgress",value:otherCount/props.sampledValues,max:1,size:"s",color:"subdued"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null)))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null)}const defaultNoFieldsMessageCopy=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.noDataLabel",{defaultMessage:"There are no fields."});const NoFieldsCallout=({existFieldsInIndex:existFieldsInIndex,defaultNoFieldsMessage:defaultNoFieldsMessage=defaultNoFieldsMessageCopy,isAffectedByFieldFilter:isAffectedByFieldFilter=false,isAffectedByTimerange:isAffectedByTimerange=false,isAffectedByGlobalFilter:isAffectedByGlobalFilter=false})=>{if(!existFieldsInIndex){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{size:"s",color:"warning",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.noFieldsLabel",{defaultMessage:"No fields exist in this index pattern."})})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{size:"s",color:"warning",title:isAffectedByFieldFilter?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.noFilteredFieldsLabel",{defaultMessage:"No fields match the selected filters."}):defaultNoFieldsMessage},(isAffectedByTimerange||isAffectedByFieldFilter||isAffectedByGlobalFilter)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.noFields.tryText",{defaultMessage:"Try:"})),external_kbnSharedDeps_React_default.a.createElement("ul",null,isAffectedByTimerange&&external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.noFields.extendTimeBullet",{defaultMessage:"Extending the time range"})),isAffectedByFieldFilter&&external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.noFields.fieldTypeFilterBullet",{defaultMessage:"Using different field filters"})),isAffectedByGlobalFilter&&external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.noFields.globalFiltersBullet",{defaultMessage:"Changing the global filters"})))))};function fields_accordion_extends(){fields_accordion_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return fields_accordion_extends.apply(this,arguments)}const fields_accordion_InnerFieldsAccordion=function InnerFieldsAccordion({initialIsOpen:initialIsOpen,onToggle:onToggle,id:id,label:label,hasLoaded:hasLoaded,fieldsCount:fieldsCount,isFiltered:isFiltered,paginatedFields:paginatedFields,fieldProps:fieldProps,renderCallout:renderCallout,exists:exists,hideDetails:hideDetails,showExistenceFetchError:showExistenceFetchError}){const renderField=Object(external_kbnSharedDeps_React_["useCallback"])(field=>external_kbnSharedDeps_React_default.a.createElement(FieldItem,fields_accordion_extends({},fieldProps,{key:field.name,field:field,exists:exists(field),hideDetails:hideDetails})),[fieldProps,exists,hideDetails]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{initialIsOpen:initialIsOpen,onToggle:onToggle,"data-test-subj":id,id:id,buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("strong",null,label)),extraAction:showExistenceFetchError?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.existenceErrorAriaLabel",{defaultMessage:"Existence fetch failed"}),type:"alert",color:"warning",content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.existenceErrorLabel",{defaultMessage:"Field information can't be loaded"})}):hasLoaded?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiNotificationBadge"],{size:"m",color:isFiltered?"accent":"subdued"},fieldsCount):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),hasLoaded&&(!!fieldsCount?external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsInnerIndexPatternDataPanel__fieldItems"},paginatedFields&&paginatedFields.map(renderField)):renderCallout))};const FieldsAccordion=Object(external_kbnSharedDeps_React_["memo"])(fields_accordion_InnerFieldsAccordion);function field_list_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function field_list_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){field_list_ownKeys(Object(source),true).forEach((function(key){field_list_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{field_list_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function field_list_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function field_list_extends(){field_list_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return field_list_extends.apply(this,arguments)}function field_list_slicedToArray(arr,i){return field_list_arrayWithHoles(arr)||field_list_iterableToArrayLimit(arr,i)||field_list_unsupportedIterableToArray(arr,i)||field_list_nonIterableRest()}function field_list_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function field_list_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return field_list_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return field_list_arrayLikeToArray(o,minLen)}function field_list_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function field_list_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function field_list_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const PAGINATION_SIZE=50;function getDisplayedFieldsLength(fieldGroups,accordionState){return Object.entries(fieldGroups).filter(([key])=>accordionState[key]).reduce((allFieldCount,[,{fields:fields}])=>allFieldCount+fields.length,0)}function FieldList({exists:exists,fieldGroups:fieldGroups,existenceFetchFailed:existenceFetchFailed,fieldProps:fieldProps,hasSyncedExistingFields:hasSyncedExistingFields,filter:filter,currentIndexPatternId:currentIndexPatternId,existFieldsInIndex:existFieldsInIndex}){const _useState=Object(external_kbnSharedDeps_React_["useState"])(PAGINATION_SIZE),_useState2=field_list_slicedToArray(_useState,2),pageSize=_useState2[0],setPageSize=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState4=field_list_slicedToArray(_useState3,2),scrollContainer=_useState4[0],setScrollContainer=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(()=>Object.fromEntries(Object.entries(fieldGroups).filter(([,{showInAccordion:showInAccordion}])=>showInAccordion).map(([key,{isInitiallyOpen:isInitiallyOpen}])=>[key,isInitiallyOpen]))),_useState6=field_list_slicedToArray(_useState5,2),accordionState=_useState6[0],setAccordionState=_useState6[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(scrollContainer){scrollContainer.scrollTop=0;setPageSize(PAGINATION_SIZE)}},[filter.nameFilter,filter.typeFilter,currentIndexPatternId,scrollContainer]);const lazyScroll=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(scrollContainer){const nearBottom=scrollContainer.scrollTop+scrollContainer.clientHeight>scrollContainer.scrollHeight*.9;if(nearBottom){setPageSize(Math.max(PAGINATION_SIZE,Math.min(pageSize+PAGINATION_SIZE*.5,getDisplayedFieldsLength(fieldGroups,accordionState))))}}},[scrollContainer,pageSize,setPageSize,fieldGroups,accordionState]);const paginatedFields=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{let remainingItems=pageSize;return Object.fromEntries(Object.entries(fieldGroups).filter(([,{showInAccordion:showInAccordion}])=>showInAccordion).map(([key,fieldGroup])=>{if(!accordionState[key]||remainingItems<=0){return[key,[]]}const slicedFieldList=fieldGroup.fields.slice(0,remainingItems);remainingItems=remainingItems-slicedFieldList.length;return[key,slicedFieldList]}))},[pageSize,fieldGroups,accordionState]);return external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsIndexPatternFieldList",ref:el=>{if(el&&!el.dataset.dynamicScroll){el.dataset.dynamicScroll="true";setScrollContainer(el)}},onScroll:Object(external_kbnSharedDeps_Lodash_["throttle"])(lazyScroll,100)},external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsIndexPatternFieldList__accordionContainer"},Object.entries(fieldGroups).filter(([,{showInAccordion:showInAccordion}])=>!showInAccordion).flatMap(([,{fields:fields}])=>fields.map(field=>external_kbnSharedDeps_React_default.a.createElement(FieldItem,field_list_extends({},fieldProps,{exists:exists(field),field:field,hideDetails:true,key:field.name})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),Object.entries(fieldGroups).filter(([,{showInAccordion:showInAccordion}])=>showInAccordion).map(([key,fieldGroup])=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:key},external_kbnSharedDeps_React_default.a.createElement(FieldsAccordion,{initialIsOpen:Boolean(accordionState[key]),key:key,id:"lnsIndexPattern".concat(key),label:fieldGroup.title,exists:exists,hideDetails:fieldGroup.hideDetails,hasLoaded:!!hasSyncedExistingFields,fieldsCount:fieldGroup.fields.length,isFiltered:fieldGroup.fieldCount!==fieldGroup.fields.length,paginatedFields:paginatedFields[key],fieldProps:fieldProps,onToggle:open=>{setAccordionState(s=>field_list_objectSpread(field_list_objectSpread({},s),{},{[key]:open}));const displayedFieldLength=getDisplayedFieldsLength(fieldGroups,field_list_objectSpread(field_list_objectSpread({},accordionState),{},{[key]:open}));setPageSize(Math.max(PAGINATION_SIZE,Math.min(pageSize*1.5,displayedFieldLength)))},showExistenceFetchError:existenceFetchFailed,renderCallout:external_kbnSharedDeps_React_default.a.createElement(NoFieldsCallout,{isAffectedByGlobalFilter:fieldGroup.isAffectedByGlobalFilter,isAffectedByTimerange:fieldGroup.isAffectedByTimeFilter,isAffectedByFieldFilter:fieldGroup.fieldCount!==fieldGroup.fields.length,existFieldsInIndex:!!existFieldsInIndex,defaultNoFieldsMessage:fieldGroup.defaultNoFieldsMessage})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"})))))}function datapanel_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function datapanel_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){datapanel_ownKeys(Object(source),true).forEach((function(key){datapanel_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{datapanel_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function datapanel_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function datapanel_slicedToArray(arr,i){return datapanel_arrayWithHoles(arr)||datapanel_iterableToArrayLimit(arr,i)||datapanel_unsupportedIterableToArray(arr,i)||datapanel_nonIterableRest()}function datapanel_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function datapanel_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return datapanel_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return datapanel_arrayLikeToArray(o,minLen)}function datapanel_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function datapanel_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function datapanel_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function sortFields(fieldA,fieldB){return fieldA.displayName.localeCompare(fieldB.displayName,undefined,{sensitivity:"base"})}const supportedFieldTypes=new Set(["string","number","boolean","date","ip","document"]);const fieldTypeNames={document:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatypes.record",{defaultMessage:"record"}),string:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatypes.string",{defaultMessage:"string"}),number:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatypes.number",{defaultMessage:"number"}),boolean:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatypes.boolean",{defaultMessage:"boolean"}),date:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatypes.date",{defaultMessage:"date"}),ip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.datatypes.ipAddress",{defaultMessage:"IP"})};function buildSafeEsQuery(indexPattern,query,filters,queryConfig){try{return public_["esQuery"].buildEsQuery(indexPattern,query,filters,queryConfig)}catch(e){return{bool:{must_not:{match_all:{}}}}}}function IndexPatternDataPanel({setState:setState,state:state,dragDropContext:dragDropContext,core:core,data:data,query:query,filters:filters,dateRange:dateRange,changeIndexPattern:changeIndexPattern,charts:charts,showNoDataPopover:showNoDataPopover}){const indexPatternRefs=state.indexPatternRefs,indexPatterns=state.indexPatterns,currentIndexPatternId=state.currentIndexPatternId;const onChangeIndexPattern=Object(external_kbnSharedDeps_React_["useCallback"])(id=>changeIndexPattern(id,state,setState),[state,setState,changeIndexPattern]);const indexPatternList=Object(external_kbnSharedDeps_Lodash_["uniq"])(Object.values(state.layers).map(l=>l.indexPatternId).concat(currentIndexPatternId)).sort((a,b)=>a.localeCompare(b)).filter(id=>!!indexPatterns[id]).map(id=>({id:id,title:indexPatterns[id].title,timeFieldName:indexPatterns[id].timeFieldName,fields:indexPatterns[id].fields,hasRestrictions:indexPatterns[id].hasRestrictions}));const dslQuery=buildSafeEsQuery(indexPatterns[currentIndexPatternId],query,filters,public_["esQuery"].getEsQueryConfig(core.uiSettings));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Loader,{load:()=>syncExistingFields({dateRange:dateRange,setState:setState,isFirstExistenceFetch:state.isFirstExistenceFetch,currentIndexPatternTitle:indexPatterns[currentIndexPatternId].title,showNoDataPopover:showNoDataPopover,indexPatterns:indexPatternList,fetchJson:core.http.post,dslQuery:dslQuery}),loadDeps:[query,filters,dateRange.fromDate,dateRange.toDate,indexPatternList.map(x=>"".concat(x.title,":").concat(x.timeFieldName)).join(",")]}),Object.keys(indexPatterns).length===0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",className:"lnsInnerIndexPatternDataPanel",direction:"column",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:null},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{"data-test-subj":"indexPattern-no-indexpatterns",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.noPatternsLabel",{defaultMessage:"No index patterns"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.indexPattern.noPatternsDescription",defaultMessage:"Please create an index pattern or switch to another data source"}))))):external_kbnSharedDeps_React_default.a.createElement(MemoizedDataPanel,{currentIndexPatternId:currentIndexPatternId,indexPatternRefs:indexPatternRefs,indexPatterns:indexPatterns,query:query,dateRange:dateRange,filters:filters,dragDropContext:dragDropContext,core:core,data:data,charts:charts,onChangeIndexPattern:onChangeIndexPattern,existingFields:state.existingFields,existenceFetchFailed:state.existenceFetchFailed}))}const defaultFieldGroups={specialFields:[],availableFields:[],emptyFields:[],metaFields:[]};const fieldFiltersLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.fieldFiltersLabel",{defaultMessage:"Field filters"});const htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])("datapanel");const fieldSearchDescriptionId=htmlId();const datapanel_InnerIndexPatternDataPanel=function InnerIndexPatternDataPanel({currentIndexPatternId:currentIndexPatternId,indexPatternRefs:indexPatternRefs,indexPatterns:indexPatterns,existenceFetchFailed:existenceFetchFailed,query:query,dateRange:dateRange,filters:filters,dragDropContext:dragDropContext,onChangeIndexPattern:_onChangeIndexPattern,core:core,data:data,existingFields:existingFields,charts:charts}){const _useState=Object(external_kbnSharedDeps_React_["useState"])({nameFilter:"",typeFilter:[],isTypeFilterOpen:false,isAvailableAccordionOpen:true,isEmptyAccordionOpen:false,isMetaAccordionOpen:false}),_useState2=datapanel_slicedToArray(_useState,2),localState=_useState2[0],setLocalState=_useState2[1];const currentIndexPattern=indexPatterns[currentIndexPatternId];const allFields=currentIndexPattern.fields;const clearLocalState=()=>setLocalState(s=>datapanel_objectSpread(datapanel_objectSpread({},s),{},{nameFilter:"",typeFilter:[]}));const hasSyncedExistingFields=existingFields[currentIndexPattern.title];const availableFieldTypes=Object(external_kbnSharedDeps_Lodash_["uniq"])(allFields.map(({type:type})=>type)).filter(type=>type in fieldTypeNames);const fieldInfoUnavailable=existenceFetchFailed||currentIndexPattern.hasRestrictions;const unfilteredFieldGroups=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const containsData=field=>{const overallField=currentIndexPattern.getFieldByName(field.name);return overallField&&fieldExists(existingFields,currentIndexPattern.title,overallField.name)};const allSupportedTypesFields=allFields.filter(field=>supportedFieldTypes.has(field.type));const sorted=allSupportedTypesFields.sort(sortFields);let groupedFields;if(!hasSyncedExistingFields){groupedFields=datapanel_objectSpread(datapanel_objectSpread({},defaultFieldGroups),Object(external_kbnSharedDeps_Lodash_["groupBy"])(sorted,field=>{if(field.type==="document"){return"specialFields"}else if(field.meta){return"metaFields"}else{return"emptyFields"}}))}groupedFields=datapanel_objectSpread(datapanel_objectSpread({},defaultFieldGroups),Object(external_kbnSharedDeps_Lodash_["groupBy"])(sorted,field=>{if(field.type==="document"){return"specialFields"}else if(field.meta){return"metaFields"}else if(containsData(field)){return"availableFields"}else return"emptyFields"}));const fieldGroupDefinitions={SpecialFields:{fields:groupedFields.specialFields,fieldCount:1,isAffectedByGlobalFilter:false,isAffectedByTimeFilter:false,isInitiallyOpen:false,showInAccordion:false,title:"",hideDetails:true},AvailableFields:{fields:groupedFields.availableFields,fieldCount:groupedFields.availableFields.length,isInitiallyOpen:true,showInAccordion:true,title:fieldInfoUnavailable?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.allFieldsLabel",{defaultMessage:"All fields"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.availableFieldsLabel",{defaultMessage:"Available fields"}),isAffectedByGlobalFilter:!!filters.length,isAffectedByTimeFilter:true,hideDetails:fieldInfoUnavailable,defaultNoFieldsMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.noAvailableDataLabel",{defaultMessage:"There are no available fields that contain data."})},EmptyFields:{fields:groupedFields.emptyFields,fieldCount:groupedFields.emptyFields.length,isAffectedByGlobalFilter:false,isAffectedByTimeFilter:false,isInitiallyOpen:false,showInAccordion:true,hideDetails:false,title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.emptyFieldsLabel",{defaultMessage:"Empty fields"}),defaultNoFieldsMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.noEmptyDataLabel",{defaultMessage:"There are no empty fields."})},MetaFields:{fields:groupedFields.metaFields,fieldCount:groupedFields.metaFields.length,isAffectedByGlobalFilter:false,isAffectedByTimeFilter:false,isInitiallyOpen:false,showInAccordion:true,hideDetails:false,title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.metaFieldsLabel",{defaultMessage:"Meta fields"}),defaultNoFieldsMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.noMetaDataLabel",{defaultMessage:"There are no meta fields."})}};if(fieldInfoUnavailable){delete fieldGroupDefinitions.EmptyFields}return fieldGroupDefinitions},[allFields,existingFields,currentIndexPattern,hasSyncedExistingFields,fieldInfoUnavailable,filters.length]);const fieldGroups=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const filterFieldGroup=fieldGroup=>fieldGroup.filter(field=>{if(localState.nameFilter.length&&!field.name.toLowerCase().includes(localState.nameFilter.toLowerCase())&&!field.displayName.toLowerCase().includes(localState.nameFilter.toLowerCase())){return false}if(localState.typeFilter.length>0){return localState.typeFilter.includes(field.type)}return true});return Object.fromEntries(Object.entries(unfilteredFieldGroups).map(([name,group])=>[name,datapanel_objectSpread(datapanel_objectSpread({},group),{},{fields:filterFieldGroup(group.fields)})]))},[unfilteredFieldGroups,localState.nameFilter,localState.typeFilter]);const fieldProps=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({core:core,data:data,indexPattern:currentIndexPattern,highlight:localState.nameFilter.toLowerCase(),dateRange:dateRange,query:query,filters:filters,chartsThemeService:charts.theme}),[core,data,currentIndexPattern,dateRange,query,filters,localState.nameFilter,charts.theme]);return external_kbnSharedDeps_React_default.a.createElement(ChildDragDropProvider,dragDropContext,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",className:"lnsInnerIndexPatternDataPanel",direction:"column",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsInnerIndexPatternDataPanel__header"},external_kbnSharedDeps_React_default.a.createElement(ChangeIndexPattern,{"data-test-subj":"indexPattern-switcher",trigger:{label:currentIndexPattern.title,title:currentIndexPattern.title,"data-test-subj":"indexPattern-switch-link",fontWeight:"bold"},indexPatternId:currentIndexPatternId,indexPatternRefs:indexPatternRefs,onChangeIndexPattern:newId=>{_onChangeIndexPattern(newId);clearLocalState()}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormControlLayout"],{icon:"search",fullWidth:true,clear:{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.clearFiltersLabel",{defaultMessage:"Clear name and type filters"}),"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.clearFiltersLabel",{defaultMessage:"Clear name and type filters"}),onClick:()=>{factory_trackUiEvent("indexpattern_filters_cleared");clearLocalState()}}},external_kbnSharedDeps_React_default.a.createElement("input",{className:"euiFieldText euiFieldText--fullWidth lnsInnerIndexPatternDataPanel__textField","data-test-subj":"lnsIndexPatternFieldSearch",placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.filterByNameLabel",{defaultMessage:"Search field names",description:"Search the list of fields in the index pattern for the provided text"}),value:localState.nameFilter,onChange:e=>{setLocalState(datapanel_objectSpread(datapanel_objectSpread({},localState),{},{nameFilter:e.target.value}))},"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.filterByNameAriaLabel",{defaultMessage:"Search fields"}),"aria-describedby":fieldSearchDescriptionId})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"dataPanelTypeFilter",panelClassName:"euiFilterGroup__popoverPanel",panelPaddingSize:"none",anchorPosition:"rightUp",display:"block",isOpen:localState.isTypeFilterOpen,closePopover:()=>setLocalState(()=>datapanel_objectSpread(datapanel_objectSpread({},localState),{},{isTypeFilterOpen:false})),button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{iconType:"arrowDown",isSelected:localState.isTypeFilterOpen,numFilters:localState.typeFilter.length,hasActiveFilters:!!localState.typeFilter.length,numActiveFilters:localState.typeFilter.length,"data-test-subj":"lnsIndexPatternFiltersToggle",onClick:()=>{setLocalState(s=>datapanel_objectSpread(datapanel_objectSpread({},s),{},{isTypeFilterOpen:!localState.isTypeFilterOpen}))}},fieldFiltersLabel)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{watchedItemProps:["icon","disabled"],"data-test-subj":"lnsIndexPatternTypeFilterOptions",items:availableFieldTypes.map(type=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{className:"lnsInnerIndexPatternDataPanel__filterType",key:type,icon:localState.typeFilter.includes(type)?"check":"empty","data-test-subj":"typeFilter-".concat(type),onClick:()=>{factory_trackUiEvent("indexpattern_type_filter_toggled");setLocalState(s=>datapanel_objectSpread(datapanel_objectSpread({},s),{},{typeFilter:localState.typeFilter.includes(type)?localState.typeFilter.filter(t=>t!==type):[...localState.typeFilter,type]}))}},external_kbnSharedDeps_React_default.a.createElement("span",{className:"lnsInnerIndexPatternDataPanel__filterTypeInner"},external_kbnSharedDeps_React_default.a.createElement(LensFieldIcon,{type:type})," ",fieldTypeNames[type])))})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiScreenReaderOnly"],null,external_kbnSharedDeps_React_default.a.createElement("div",{"aria-live":"polite",id:fieldSearchDescriptionId},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatterns.fieldSearchLiveRegion",{defaultMessage:"{availableFields} available {availableFields, plural, one {field} other {fields}}. {emptyFields} empty {emptyFields, plural, one {field} other {fields}}. {metaFields} meta {metaFields, plural, one {field} other {fields}}.",values:{availableFields:fieldGroups.AvailableFields.fields.length,emptyFields:fieldGroups.EmptyFields.fields.length,metaFields:fieldGroups.MetaFields.fields.length}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(FieldList,{exists:field=>field.type==="document"||fieldExists(existingFields,currentIndexPattern.title,field.name),fieldProps:fieldProps,fieldGroups:fieldGroups,hasSyncedExistingFields:!!hasSyncedExistingFields,filter:{nameFilter:localState.nameFilter,typeFilter:localState.typeFilter},currentIndexPatternId:currentIndexPatternId,existenceFetchFailed:existenceFetchFailed,existFieldsInIndex:!!allFields.length}))))};const MemoizedDataPanel=Object(external_kbnSharedDeps_React_["memo"])(datapanel_InnerIndexPatternDataPanel);function _toArray(arr){return indexpattern_suggestions_arrayWithHoles(arr)||_iterableToArray(arr)||indexpattern_suggestions_unsupportedIterableToArray(arr)||indexpattern_suggestions_nonIterableRest()}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function indexpattern_suggestions_slicedToArray(arr,i){return indexpattern_suggestions_arrayWithHoles(arr)||indexpattern_suggestions_iterableToArrayLimit(arr,i)||indexpattern_suggestions_unsupportedIterableToArray(arr,i)||indexpattern_suggestions_nonIterableRest()}function indexpattern_suggestions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function indexpattern_suggestions_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return indexpattern_suggestions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return indexpattern_suggestions_arrayLikeToArray(o,minLen)}function indexpattern_suggestions_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function indexpattern_suggestions_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function indexpattern_suggestions_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function indexpattern_suggestions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function indexpattern_suggestions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){indexpattern_suggestions_ownKeys(Object(source),true).forEach((function(key){indexpattern_suggestions_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{indexpattern_suggestions_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function indexpattern_suggestions_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function indexpattern_suggestions_buildSuggestion({state:state,updatedLayer:updatedLayer,layerId:layerId,label:label,changeType:changeType}){const updatedState=updatedLayer?indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},state),{},{layers:indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},state.layers),{},{[layerId]:updatedLayer})}):state;const layers=external_kbnSharedDeps_Lodash_default.a.mapValues(updatedState.layers,layer=>indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},layer),{},{columns:external_kbnSharedDeps_Lodash_default.a.pick(layer.columns,layer.columnOrder)}));const columnOrder=layers[layerId].columnOrder;const columnMap=layers[layerId].columns;const isMultiRow=Object.values(columnMap).some(column=>column.isBucketed);return{state:indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},updatedState),{},{layers:layers}),table:{columns:columnOrder.map(columnId=>({columnId:columnId,operation:columnToOperation(columnMap[columnId])})),isMultiRow:isMultiRow,layerId:layerId,changeType:changeType,label:label},keptLayerIds:Object.keys(state.layers)}}function getDatasourceSuggestionsForField(state,indexPatternId,field){if(hasInvalidFields(state))return[];const layers=Object.keys(state.layers);const layerIds=layers.filter(id=>state.layers[id].indexPatternId===indexPatternId);if(layerIds.length===0){const newId=generateId();return getEmptyLayerSuggestionsForField(state,newId,indexPatternId,field).concat(getEmptyLayerSuggestionsForField(indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},state),{},{layers:{}}),newId,indexPatternId,field))}else{const mostEmptyLayerId=external_kbnSharedDeps_Lodash_default.a.minBy(layerIds,layerId=>state.layers[layerId].columnOrder.length);if(state.layers[mostEmptyLayerId].columnOrder.length===0){return getEmptyLayerSuggestionsForField(state,mostEmptyLayerId,indexPatternId,field)}else{return getExistingLayerSuggestionsForField(state,mostEmptyLayerId,field)}}}function getDatasourceSuggestionsForVisualizeField(state,indexPatternId,fieldName){const layers=Object.keys(state.layers);const layerIds=layers.filter(id=>state.layers[id].indexPatternId===indexPatternId);const indexPattern=state.indexPatterns[indexPatternId];const field=indexPattern.getFieldByName(fieldName);if(layerIds.length!==0||!field)return[];const newId=generateId();return getEmptyLayerSuggestionsForField(state,newId,indexPatternId,field).concat(getEmptyLayerSuggestionsForField(indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},state),{},{layers:{}}),newId,indexPatternId,field))}function getBucketOperation(field){if(field.type!=="number"){return getOperationTypesForField(field).find(op=>op==="date_histogram"||op==="terms")}}function getExistingLayerSuggestionsForField(state,layerId,field){const layer=state.layers[layerId];const indexPattern=state.indexPatterns[layer.indexPatternId];const operations=getOperationTypesForField(field);const usableAsBucketOperation=getBucketOperation(field);const fieldInUse=Object.values(layer.columns).some(column=>hasField(column)&&column.sourceField===field.name);const suggestions=[];if(usableAsBucketOperation&&!fieldInUse){if(usableAsBucketOperation==="date_histogram"&&layer.columnOrder.some(colId=>layer.columns[colId].operationType==="date_histogram")){const previousDate=layer.columnOrder.find(colId=>layer.columns[colId].operationType==="date_histogram");suggestions.push(indexpattern_suggestions_buildSuggestion({state:state,updatedLayer:replaceColumn({layer:layer,indexPattern:indexPattern,field:field,op:usableAsBucketOperation,columnId:previousDate}),layerId:layerId,changeType:"initial"}))}else{suggestions.push(indexpattern_suggestions_buildSuggestion({state:state,updatedLayer:insertNewColumn({layer:layer,indexPattern:indexPattern,field:field,op:usableAsBucketOperation,columnId:generateId()}),layerId:layerId,changeType:"extended"}))}}if(!usableAsBucketOperation&&operations.length>0&&!fieldInUse){const _getMetricOperationTy=getMetricOperationTypes(field),_getMetricOperationTy2=indexpattern_suggestions_slicedToArray(_getMetricOperationTy,1),metricOperation=_getMetricOperationTy2[0];if(metricOperation){const layerWithNewMetric=insertNewColumn({layer:layer,indexPattern:indexPattern,field:field,columnId:generateId(),op:metricOperation.type});if(layerWithNewMetric){suggestions.push(indexpattern_suggestions_buildSuggestion({state:state,layerId:layerId,updatedLayer:layerWithNewMetric,changeType:"extended"}))}const _separateBucketColumn=indexpattern_suggestions_separateBucketColumns(layer),_separateBucketColumn2=indexpattern_suggestions_slicedToArray(_separateBucketColumn,2),metrics=_separateBucketColumn2[1];if(metrics.length===1){const layerWithReplacedMetric=replaceColumn({layer:layer,indexPattern:indexPattern,field:field,columnId:metrics[0],op:metricOperation.type});if(layerWithReplacedMetric){suggestions.push(indexpattern_suggestions_buildSuggestion({state:state,layerId:layerId,updatedLayer:layerWithReplacedMetric,changeType:"extended"}))}}}}const metricSuggestion=createMetricSuggestion(indexPattern,layerId,state,field);if(metricSuggestion){suggestions.push(metricSuggestion)}return suggestions}function getEmptyLayerSuggestionsForField(state,layerId,indexPatternId,field){const indexPattern=state.indexPatterns[indexPatternId];let newLayer;const bucketOperation=getBucketOperation(field);if(bucketOperation){newLayer=createNewLayerWithBucketAggregation(indexPattern,field,bucketOperation)}else if(indexPattern.timeFieldName&&getOperationTypesForField(field).length>0){newLayer=createNewLayerWithMetricAggregation(indexPattern,field)}const newLayerSuggestions=newLayer?[indexpattern_suggestions_buildSuggestion({state:state,updatedLayer:newLayer,layerId:layerId,changeType:"initial"})]:[];const metricLayer=createMetricSuggestion(indexPattern,layerId,state,field);return metricLayer?newLayerSuggestions.concat(metricLayer):newLayerSuggestions}function createNewLayerWithBucketAggregation(indexPattern,field,operation){return insertNewColumn({op:operation,layer:insertNewColumn({op:"count",layer:{indexPatternId:indexPattern.id,columns:{},columnOrder:[]},columnId:generateId(),field:documentField,indexPattern:indexPattern}),columnId:generateId(),field:field,indexPattern:indexPattern})}function createNewLayerWithMetricAggregation(indexPattern,field){const dateField=indexPattern.getFieldByName(indexPattern.timeFieldName);const _getMetricOperationTy3=getMetricOperationTypes(field),_getMetricOperationTy4=indexpattern_suggestions_slicedToArray(_getMetricOperationTy3,1),metricOperation=_getMetricOperationTy4[0];if(!metricOperation){return}return insertNewColumn({op:"date_histogram",layer:insertNewColumn({op:metricOperation.type,layer:{indexPatternId:indexPattern.id,columns:{},columnOrder:[]},columnId:generateId(),field:field,indexPattern:indexPattern}),columnId:generateId(),field:dateField,indexPattern:indexPattern})}function getDatasourceSuggestionsFromCurrentState(state){if(hasInvalidFields(state))return[];const layers=Object.entries(state.layers||{});if(layers.length>1){return layers.map(([layerId,layer],index)=>{const hasMatchingLayer=layers.some(([otherLayerId,otherLayer])=>otherLayerId!==layerId&&otherLayer.indexPatternId===layer.indexPatternId);const suggestionTitle=hasMatchingLayer?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatternSuggestion.removeLayerPositionLabel",{defaultMessage:"Show only layer {layerNumber}",values:{layerNumber:index+1}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPatternSuggestion.removeLayerLabel",{defaultMessage:"Show only {indexPatternTitle}",values:{indexPatternTitle:state.indexPatterns[layer.indexPatternId].title}});return indexpattern_suggestions_buildSuggestion({state:indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},state),{},{layers:{[layerId]:layer}}),layerId:layerId,changeType:"layers",label:suggestionTitle})}).concat([indexpattern_suggestions_buildSuggestion({state:state,layerId:layers[0][0],changeType:"unchanged"})])}return external_kbnSharedDeps_Lodash_default.a.flatten(Object.entries(state.layers||{}).filter(([_id,layer])=>layer.columnOrder.length&&layer.indexPatternId).map(([layerId,layer])=>{const indexPattern=state.indexPatterns[layer.indexPatternId];const _separateBucketColumn3=indexpattern_suggestions_separateBucketColumns(layer),_separateBucketColumn4=indexpattern_suggestions_slicedToArray(_separateBucketColumn3,2),buckets=_separateBucketColumn4[0],metrics=_separateBucketColumn4[1];const timeDimension=layer.columnOrder.find(columnId=>layer.columns[columnId].isBucketed&&layer.columns[columnId].dataType==="date");const timeField=indexPattern.timeFieldName&&indexPattern.getFieldByName(indexPattern.timeFieldName);const hasNumericDimension=buckets.length===1&&buckets.some(columnId=>layer.columns[columnId].dataType==="number");const suggestions=[];if(metrics.length===0){suggestions.push(indexpattern_suggestions_buildSuggestion({state:state,layerId:layerId,changeType:"unchanged"}))}else if(buckets.length===0){if(timeField){suggestions.push(createSuggestionWithDefaultDateHistogram(state,layerId,timeField))}suggestions.push(...createAlternativeMetricSuggestions(indexPattern,layerId,state));suggestions.push(indexpattern_suggestions_buildSuggestion({state:state,layerId:layerId,changeType:"unchanged"}))}else{suggestions.push(...createSimplifiedTableSuggestions(state,layerId));if(!timeDimension&&timeField&&!hasNumericDimension){suggestions.push(createSuggestionWithDefaultDateHistogram(state,layerId,timeField))}if(buckets.length===2){suggestions.push(createChangedNestingSuggestion(state,layerId))}}return suggestions}))}function createChangedNestingSuggestion(state,layerId){var _indexPattern$getFiel,_indexPattern$getFiel2;const layer=state.layers[layerId];const _layer$columnOrder=_toArray(layer.columnOrder),firstBucket=_layer$columnOrder[0],secondBucket=_layer$columnOrder[1],rest=_layer$columnOrder.slice(2);const updatedLayer=indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},layer),{},{columnOrder:[secondBucket,firstBucket,...rest]});const indexPattern=state.indexPatterns[state.currentIndexPatternId];const firstBucketColumn=layer.columns[firstBucket];const firstBucketLabel=hasField(firstBucketColumn)&&((_indexPattern$getFiel=indexPattern.getFieldByName(firstBucketColumn.sourceField))===null||_indexPattern$getFiel===void 0?void 0:_indexPattern$getFiel.displayName)||"";const secondBucketColumn=layer.columns[secondBucket];const secondBucketLabel=hasField(secondBucketColumn)&&((_indexPattern$getFiel2=indexPattern.getFieldByName(secondBucketColumn.sourceField))===null||_indexPattern$getFiel2===void 0?void 0:_indexPattern$getFiel2.displayName)||"";return indexpattern_suggestions_buildSuggestion({state:state,layerId:layerId,updatedLayer:updatedLayer,label:getNestedTitle([secondBucketLabel,firstBucketLabel]),changeType:"reorder"})}function createMetricSuggestion(indexPattern,layerId,state,field){const _getMetricOperationTy5=getMetricOperationTypes(field),_getMetricOperationTy6=indexpattern_suggestions_slicedToArray(_getMetricOperationTy5,1),operation=_getMetricOperationTy6[0];if(!operation){return}return indexpattern_suggestions_buildSuggestion({layerId:layerId,state:state,changeType:"initial",updatedLayer:insertNewColumn({layer:{indexPatternId:indexPattern.id,columns:{},columnOrder:[]},columnId:generateId(),op:operation.type,field:operation.type==="count"?documentField:field,indexPattern:indexPattern})})}function getNestedTitle([outerBucketLabel,innerBucketLabel]){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexpattern.suggestions.nestingChangeLabel",{defaultMessage:"{innerOperation} for each {outerOperation}",values:{innerOperation:innerBucketLabel,outerOperation:outerBucketLabel}})}function createAlternativeMetricSuggestions(indexPattern,layerId,state){const layer=state.layers[layerId];const suggestions=[];layer.columnOrder.forEach(columnId=>{const column=layer.columns[columnId];if(!hasField(column)){return}const field=indexPattern.getFieldByName(column.sourceField);if(!field){return}const possibleOperations=getMetricOperationTypes(field).filter(({type:type})=>type!==column.operationType);if(possibleOperations.length){const layerWithNewMetric=replaceColumn({layer:layer,indexPattern:indexPattern,field:field,columnId:columnId,op:possibleOperations[0].type});if(layerWithNewMetric){suggestions.push(indexpattern_suggestions_buildSuggestion({state:state,layerId:layerId,updatedLayer:layerWithNewMetric,changeType:"initial"}))}}});return suggestions}function createSuggestionWithDefaultDateHistogram(state,layerId,timeField){const layer=state.layers[layerId];const indexPattern=state.indexPatterns[layer.indexPatternId];return indexpattern_suggestions_buildSuggestion({state:state,layerId:layerId,updatedLayer:insertNewColumn({layer:layer,indexPattern:indexPattern,field:timeField,op:"date_histogram",columnId:generateId()}),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexpattern.suggestions.overTimeLabel",{defaultMessage:"Over time"}),changeType:"extended"})}function createSimplifiedTableSuggestions(state,layerId){const layer=state.layers[layerId];const _separateBucketColumn5=indexpattern_suggestions_separateBucketColumns(layer),_separateBucketColumn6=indexpattern_suggestions_slicedToArray(_separateBucketColumn5,2),availableBucketedColumns=_separateBucketColumn6[0],availableMetricColumns=_separateBucketColumn6[1];return external_kbnSharedDeps_Lodash_default.a.flatten(availableBucketedColumns.map((_col,index)=>{const bucketedColumns=availableBucketedColumns.slice(0,index+1);const allMetricsSuggestion=indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},layer),{},{columnOrder:[...bucketedColumns,...availableMetricColumns]});if(availableMetricColumns.length>1){return[allMetricsSuggestion,indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},layer),{},{columnOrder:[...bucketedColumns,availableMetricColumns[0]]})]}else{return allMetricsSuggestion}})).concat(availableMetricColumns.map(columnId=>indexpattern_suggestions_objectSpread(indexpattern_suggestions_objectSpread({},layer),{},{columnOrder:[columnId]}))).map(updatedLayer=>indexpattern_suggestions_buildSuggestion({state:state,layerId:layerId,updatedLayer:updatedLayer,changeType:layer.columnOrder.length===updatedLayer.columnOrder.length?"unchanged":"reduced",label:updatedLayer.columnOrder.length===1?getMetricSuggestionTitle(updatedLayer,availableMetricColumns.length===1):undefined}))}function getMetricSuggestionTitle(layer,onlyMetric){const _layer$columns$layer$=layer.columns[layer.columnOrder[0]],operationType=_layer$columns$layer$.operationType,label=_layer$columns$layer$.label;return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexpattern.suggestions.overallLabel",{defaultMessage:"{operation} overall",values:{operation:onlyMetric?operationDefinitionMap[operationType].displayName:label},description:"Title of a suggested chart containing only a single numerical metric calculated over all available data"})}function indexpattern_suggestions_separateBucketColumns(layer){return Object(external_kbnSharedDeps_Lodash_["partition"])(layer.columnOrder,columnId=>layer.columns[columnId].isBucketed)}function LayerPanel({state:state,layerId:layerId,onChangeIndexPattern:onChangeIndexPattern}){const layer=state.layers[layerId];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(ChangeIndexPattern,{"data-test-subj":"indexPattern-switcher",trigger:{label:state.indexPatterns[layer.indexPatternId].title,title:state.indexPatterns[layer.indexPatternId].title,"data-test-subj":"lns_layerIndexPatternLabel",size:"s",fontWeight:"normal"},indexPatternId:layer.indexPatternId,indexPatternRefs:state.indexPatternRefs,onChangeIndexPattern:onChangeIndexPattern}))}function rename_columns_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function rename_columns_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){rename_columns_ownKeys(Object(source),true).forEach((function(key){rename_columns_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{rename_columns_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function rename_columns_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const renameColumns={name:"lens_rename_columns",type:"datatable",help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.functions.renameColumns.help",{defaultMessage:"A helper to rename the columns of a datatable"}),args:{idMap:{types:["string"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.functions.renameColumns.idMap.help",{defaultMessage:"A JSON encoded object in which keys are the old column ids and values are the corresponding new ones. All other columns ids are kept."})}},inputTypes:["datatable"],fn(data,{idMap:encodedIdMap}){const idMap=JSON.parse(encodedIdMap);return{type:"datatable",rows:data.rows.map(row=>{const mappedRow={};Object.entries(idMap).forEach(([fromId,toId])=>{mappedRow[toId.id]=row[fromId]});Object.entries(row).forEach(([id,value])=>{if(id in idMap){mappedRow[idMap[id].id]=sanitizeValue(value)}else{mappedRow[id]=sanitizeValue(value)}});return mappedRow}),columns:data.columns.map(column=>{const mappedItem=idMap[column.id];if(!mappedItem){return column}return rename_columns_objectSpread(rename_columns_objectSpread({},column),{},{id:mappedItem.id,name:getColumnName(mappedItem,column)})})}}};function getColumnName(originalColumn,newColumn){if(originalColumn&&originalColumn.operationType==="date_histogram"){const fieldName=originalColumn.sourceField;return newColumn.name.replace(fieldName,originalColumn.label)}return originalColumn.label}function sanitizeValue(value){if(value===""){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexpattern.emptyTextColumnValue",{defaultMessage:"(empty)"})}return value}var external_kbnSharedDeps_MomentTimezone_=__webpack_require__(14);var external_kbnSharedDeps_MomentTimezone_default=__webpack_require__.n(external_kbnSharedDeps_MomentTimezone_);var expressions_common_=__webpack_require__(26);function time_scale_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function time_scale_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){time_scale_ownKeys(Object(source),true).forEach((function(key){time_scale_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{time_scale_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function time_scale_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function time_scale_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function time_scale_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){time_scale_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){time_scale_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const unitInMs={s:1e3,m:1e3*60,h:1e3*60*60,d:1e3*60*60*24};function getTimeScaleFunction(data){const timeScale={name:"lens_time_scale",type:"datatable",help:"",args:{dateColumnId:{types:["string"],help:"",required:true},inputColumnId:{types:["string"],help:"",required:true},outputColumnId:{types:["string"],help:"",required:true},outputColumnName:{types:["string"],help:""},targetUnit:{types:["string"],options:["s","m","h","d"],help:"",required:true}},inputTypes:["datatable"],fn(input,{dateColumnId:dateColumnId,inputColumnId:inputColumnId,outputColumnId:outputColumnId,outputColumnName:outputColumnName,targetUnit:targetUnit}){return time_scale_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var dateColumnDefinition,resultColumns,targetUnitInMs,timeInfo,intervalDuration,defaultTimezone,timeBounds,result;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:dateColumnDefinition=input.columns.find(column=>column.id===dateColumnId);if(dateColumnDefinition){_context.next=3;break}throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.functions.timeScale.dateColumnMissingMessage",{defaultMessage:"Specified dateColumnId {columnId} does not exist.",values:{columnId:dateColumnId}}));case 3:resultColumns=Object(expressions_common_["buildResultColumns"])(input,outputColumnId,inputColumnId,outputColumnName);if(resultColumns){_context.next=6;break}return _context.abrupt("return",input);case 6:targetUnitInMs=unitInMs[targetUnit];_context.next=9;return data.search.aggs.getDateMetaByDatatableColumn(dateColumnDefinition);case 9:timeInfo=_context.sent;intervalDuration=timeInfo&&public_["search"].aggs.parseInterval(timeInfo.interval);if(!(!timeInfo||!intervalDuration)){_context.next=13;break}throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.functions.timeScale.timeInfoMissingMessage",{defaultMessage:"Could not fetch date histogram information"}));case 13:defaultTimezone=external_kbnSharedDeps_MomentTimezone_default()().zoneName();external_kbnSharedDeps_MomentTimezone_default.a.tz.setDefault(timeInfo.timeZone);timeBounds=timeInfo.timeRange&&data.query.timefilter.timefilter.calculateBounds(timeInfo.timeRange);result=time_scale_objectSpread(time_scale_objectSpread({},input),{},{columns:resultColumns,rows:input.rows.map(row=>{const newRow=time_scale_objectSpread({},row);let startOfBucket=external_kbnSharedDeps_MomentTimezone_default()(row[dateColumnId]);let endOfBucket=startOfBucket.clone().add(intervalDuration);if(timeBounds&&timeBounds.min){startOfBucket=external_kbnSharedDeps_MomentTimezone_default.a.max(startOfBucket,timeBounds.min)}if(timeBounds&&timeBounds.max){endOfBucket=external_kbnSharedDeps_MomentTimezone_default.a.min(endOfBucket,timeBounds.max)}const bucketSize=endOfBucket.diff(startOfBucket);const factor=bucketSize/targetUnitInMs;const currentValue=newRow[inputColumnId];if(currentValue!=null){newRow[outputColumnId]=Number(currentValue)/factor}return newRow})});external_kbnSharedDeps_MomentTimezone_default.a.tz.setDefault(defaultTimezone);return _context.abrupt("return",result);case 19:case"end":return _context.stop()}}),_callee)})))()}};return timeScale}function counter_rate_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function counter_rate_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){counter_rate_ownKeys(Object(source),true).forEach((function(key){counter_rate_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{counter_rate_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function counter_rate_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const counterRate={name:"lens_counter_rate",type:"datatable",inputTypes:["datatable"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.functions.counterRate.help",{defaultMessage:"Calculates the counter rate of a column in a data table"}),args:{by:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.functions.counterRate.args.byHelpText",{defaultMessage:"Column to split the counter rate calculation by"}),multi:true,types:["string"],required:false},inputColumnId:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.functions.counterRate.args.inputColumnIdHelpText",{defaultMessage:"Column to calculate the counter rate of"}),types:["string"],required:true},outputColumnId:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.functions.counterRate.args.outputColumnIdHelpText",{defaultMessage:"Column to store the resulting counter rate in"}),types:["string"],required:true},outputColumnName:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.functions.counterRate.args.outputColumnNameHelpText",{defaultMessage:"Name of the column to store the resulting counter rate in"}),types:["string"],required:false}},fn(input,{by:by,inputColumnId:inputColumnId,outputColumnId:outputColumnId,outputColumnName:outputColumnName}){const resultColumns=Object(expressions_common_["buildResultColumns"])(input,outputColumnId,inputColumnId,outputColumnName);if(!resultColumns){return input}const previousValues={};return counter_rate_objectSpread(counter_rate_objectSpread({},input),{},{columns:resultColumns,rows:input.rows.map(row=>{const newRow=counter_rate_objectSpread({},row);const bucketIdentifier=Object(expressions_common_["getBucketIdentifier"])(row,by);const previousValue=previousValues[bucketIdentifier];const currentValue=newRow[inputColumnId];if(currentValue!=null&&previousValue!=null){const currentValueAsNumber=Number(currentValue);if(currentValueAsNumber>=previousValue){newRow[outputColumnId]=currentValueAsNumber-previousValue}else{newRow[outputColumnId]=currentValueAsNumber}}else{newRow[outputColumnId]=undefined}if(currentValue!=null){previousValues[bucketIdentifier]=Number(currentValue)}else{previousValues[bucketIdentifier]=undefined}return newRow})})}};function suffix_formatter_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const unitSuffixes={s:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fieldFormats.suffix.s",{defaultMessage:"/h"}),m:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fieldFormats.suffix.m",{defaultMessage:"/m"}),h:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fieldFormats.suffix.h",{defaultMessage:"/h"}),d:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fieldFormats.suffix.d",{defaultMessage:"/d"})};function getSuffixFormatter(formatFactory){var _class,_temp;return _temp=_class=class SuffixFormatter extends public_["FieldFormat"]{constructor(...args){super(...args);suffix_formatter_defineProperty(this,"allowsNumericalAggregations",true);suffix_formatter_defineProperty(this,"textConvert",val=>{const unit=this.param("unit");const suffix=unit?unitSuffixes[unit]:undefined;const nestedFormatter=this.param("id");const nestedParams=this.param("params");const formattedValue=formatFactory({id:nestedFormatter,params:nestedParams}).convert(val);if(suffix){return"".concat(formattedValue).concat(suffix)}return formattedValue})}getParamDefaults(){return{unit:undefined,nestedParams:{}}}},suffix_formatter_defineProperty(_class,"id","suffix"),suffix_formatter_defineProperty(_class,"title",external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.fieldFormats.suffix.title",{defaultMessage:"Suffix"})),suffix_formatter_defineProperty(_class,"fieldType",public_["KBN_FIELD_TYPES"].NUMBER),_temp}function indexpattern_extends(){indexpattern_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return indexpattern_extends.apply(this,arguments)}function indexpattern_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function indexpattern_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){indexpattern_ownKeys(Object(source),true).forEach((function(key){indexpattern_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{indexpattern_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function indexpattern_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function indexpattern_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function indexpattern_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){indexpattern_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){indexpattern_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function columnToOperation(column,uniqueLabel){const dataType=column.dataType,label=column.label,isBucketed=column.isBucketed,scale=column.scale;return{dataType:normalizeOperationDataType(dataType),isBucketed:isBucketed,scale:scale,label:uniqueLabel||label}}function getIndexPatternDatasource({core:core,storage:storage,data:data,charts:charts}){const savedObjectsClient=core.savedObjects.client;const uiSettings=core.uiSettings;const onIndexPatternLoadError=err=>core.notifications.toasts.addError(err,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.indexPatternLoadError",{defaultMessage:"Error loading index pattern"})});const indexPatternsService=data.indexPatterns;const indexPatternDatasource={id:"indexpattern",initialize(persistedState,references,initialContext){return indexpattern_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.t0=loadInitialState;_context.t1=persistedState;_context.t2=references;_context.next=5;return savedObjectsClient;case 5:_context.t3=_context.sent;_context.t4=core.uiSettings.get("defaultIndex");_context.t5=storage;_context.t6=indexPatternsService;_context.t7=initialContext;_context.t8={persistedState:_context.t1,references:_context.t2,savedObjectsClient:_context.t3,defaultIndexPatternId:_context.t4,storage:_context.t5,indexPatternsService:_context.t6,initialContext:_context.t7};return _context.abrupt("return",(0,_context.t0)(_context.t8));case 12:case"end":return _context.stop()}}),_callee)})))()},getPersistableState(state){return extractReferences(state)},insertLayer(state,newLayerId){return indexpattern_objectSpread(indexpattern_objectSpread({},state),{},{layers:indexpattern_objectSpread(indexpattern_objectSpread({},state.layers),{},{[newLayerId]:blankLayer(state.currentIndexPatternId)})})},removeLayer(state,layerId){const newLayers=indexpattern_objectSpread({},state.layers);delete newLayers[layerId];return indexpattern_objectSpread(indexpattern_objectSpread({},state),{},{layers:newLayers})},clearLayer(state,layerId){return indexpattern_objectSpread(indexpattern_objectSpread({},state),{},{layers:indexpattern_objectSpread(indexpattern_objectSpread({},state.layers),{},{[layerId]:blankLayer(state.currentIndexPatternId)})})},getLayers(state){return Object.keys(state.layers)},removeColumn({prevState:prevState,layerId:layerId,columnId:columnId}){return mergeLayer({state:prevState,layerId:layerId,newLayer:deleteColumn({layer:prevState.layers[layerId],columnId:columnId})})},toExpression:indexpattern_datasource_to_expression_toExpression,renderDataPanel(domElement,props){Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(IndexPatternDataPanel,indexpattern_extends({changeIndexPattern:(id,state,setState)=>{loader_changeIndexPattern({id:id,state:state,setState:setState,onError:onIndexPatternLoadError,storage:storage,indexPatternsService:indexPatternsService})},data:data,charts:charts},props))),domElement)},uniqueLabels(state){const layers=state.layers;const columnLabelMap={};const counts={};const makeUnique=label=>{let uniqueLabel=label;while(counts[uniqueLabel]>=0){const num=++counts[uniqueLabel];uniqueLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.uniqueLabel",{defaultMessage:"{label} [{num}]",values:{label:label,num:num}})}counts[uniqueLabel]=0;return uniqueLabel};Object.values(layers).forEach(layer=>{if(!layer.columns){return}Object.entries(layer.columns).forEach(([columnId,column])=>{columnLabelMap[columnId]=makeUnique(column.label)})});return columnLabelMap},renderDimensionTrigger:(domElement,props)=>{const columnLabelMap=indexPatternDatasource.uniqueLabels(props.state);Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["KibanaContextProvider"],{services:{appName:"lens",storage:storage,uiSettings:uiSettings,data:data,savedObjects:core.savedObjects,docLinks:core.docLinks}},external_kbnSharedDeps_React_default.a.createElement(dimension_panel_IndexPatternDimensionTrigger,indexpattern_extends({uniqueLabel:columnLabelMap[props.columnId]},props)))),domElement)},renderDimensionEditor:(domElement,props)=>{const columnLabelMap=indexPatternDatasource.uniqueLabels(props.state);Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["KibanaContextProvider"],{services:{appName:"lens",storage:storage,uiSettings:uiSettings,data:data,savedObjects:core.savedObjects,docLinks:core.docLinks,http:core.http}},external_kbnSharedDeps_React_default.a.createElement(IndexPatternDimensionEditor,indexpattern_extends({uiSettings:uiSettings,storage:storage,savedObjectsClient:core.savedObjects.client,http:core.http,data:data,uniqueLabel:columnLabelMap[props.columnId]},props)))),domElement)},renderLayerPanel:(domElement,props)=>{Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(LayerPanel,indexpattern_extends({onChangeIndexPattern:indexPatternId=>{changeLayerIndexPattern({indexPatternId:indexPatternId,setState:props.setState,state:props.state,layerId:props.layerId,onError:onIndexPatternLoadError,replaceIfPossible:true,storage:storage,indexPatternsService:indexPatternsService})}},props)),domElement)},canHandleDrop:canHandleDrop,onDrop:droppable_onDrop,getPublicAPI({state:state,layerId:layerId}){const columnLabelMap=indexPatternDatasource.uniqueLabels(state);return{datasourceId:"indexpattern",getTableSpec:()=>state.layers[layerId].columnOrder.filter(colId=>!isReferenced(state.layers[layerId],colId)).map(colId=>({columnId:colId})),getOperationForColumnId:columnId=>{const layer=state.layers[layerId];if(layer&&layer.columns[columnId]){return columnToOperation(layer.columns[columnId],columnLabelMap[columnId])}return null}}},getDatasourceSuggestionsForField(state,draggedField){return isDraggedField(draggedField)?getDatasourceSuggestionsForField(state,draggedField.indexPatternId,draggedField.field):[]},getDatasourceSuggestionsFromCurrentState:getDatasourceSuggestionsFromCurrentState,getDatasourceSuggestionsForVisualizeField:getDatasourceSuggestionsForVisualizeField,getErrorMessages(state,layersGroups){if(!state){return}const invalidLayers=getInvalidLayers(state);const layerErrors=Object.values(state.layers).flatMap(layer=>{var _getErrorMessages;return((_getErrorMessages=getErrorMessages(layer))!==null&&_getErrorMessages!==void 0?_getErrorMessages:[]).map(message=>({shortMessage:message,longMessage:""}))});if(invalidLayers.length===0){return layerErrors.length?layerErrors:undefined}const realIndex=Object.values(state.layers).map((layer,i)=>{const filteredIndex=invalidLayers.indexOf(layer);if(filteredIndex>-1){return[filteredIndex,i+1]}}).filter(Boolean);const invalidFieldsPerLayer=getInvalidFieldsForLayer(invalidLayers,state.indexPatterns);const originalLayersList=Object.keys(state.layers);if(layerErrors.length||realIndex.length){return[...layerErrors,...realIndex.map(([filteredIndex,layerIndex])=>{const fieldsWithBrokenReferences=invalidFieldsPerLayer[filteredIndex].map(columnId=>{const column=invalidLayers[filteredIndex].columns[columnId];return column.sourceField});if(originalLayersList.length===1){return{shortMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dataReferenceFailureShortSingleLayer",{defaultMessage:"Invalid {fields, plural, one {reference} other {references}}.",values:{fields:fieldsWithBrokenReferences.length}}),longMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dataReferenceFailureLongSingleLayer",{defaultMessage:'{fieldsLength, plural, one {Field} other {Fields}} "{fields}" {fieldsLength, plural, one {has an} other {have}} invalid reference.',values:{fields:fieldsWithBrokenReferences.join('", "'),fieldsLength:fieldsWithBrokenReferences.length}})}}return{shortMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dataReferenceFailureShort",{defaultMessage:"Invalid {fieldsLength, plural, one {reference} other {references}} on Layer {layer}.",values:{layer:layerIndex,fieldsLength:fieldsWithBrokenReferences.length}}),longMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.dataReferenceFailureLong",{defaultMessage:'Layer {layer} has {fieldsLength, plural, one {an invalid} other {invalid}} {fieldsLength, plural, one {reference} other {references}} in {fieldsLength, plural, one {field} other {fields}} "{fields}".',values:{layer:layerIndex,fields:fieldsWithBrokenReferences.join('", "'),fieldsLength:fieldsWithBrokenReferences.length}})}})]}}};return indexPatternDatasource}function blankLayer(indexPatternId){return{indexPatternId:indexPatternId,columns:{},columnOrder:[]}}function state_management_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function state_management_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){state_management_ownKeys(Object(source),true).forEach((function(key){state_management_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{state_management_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function state_management_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function state_management_slicedToArray(arr,i){return state_management_arrayWithHoles(arr)||state_management_iterableToArrayLimit(arr,i)||state_management_unsupportedIterableToArray(arr,i)||state_management_nonIterableRest()}function state_management_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function state_management_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return state_management_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return state_management_arrayLikeToArray(o,minLen)}function state_management_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function state_management_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function state_management_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function getActiveDatasourceIdFromDoc(doc){if(!doc){return null}const _Object$keys=Object.keys(doc.state.datasourceStates),_Object$keys2=state_management_slicedToArray(_Object$keys,1),initialDatasourceId=_Object$keys2[0];return initialDatasourceId||null}function getInitialDatasourceId(props){return props.initialDatasourceId?props.initialDatasourceId:getActiveDatasourceIdFromDoc(props.doc)}const getInitialState=props=>{const datasourceStates={};if(props.doc){Object.entries(props.doc.state.datasourceStates).forEach(([datasourceId,state])=>{datasourceStates[datasourceId]={isLoading:true,state:state}})}else if(props.initialDatasourceId){datasourceStates[props.initialDatasourceId]={state:null,isLoading:true}}return{title:"",datasourceStates:datasourceStates,activeDatasourceId:getInitialDatasourceId(props),visualization:{state:null,activeId:props.initialVisualizationId}}};const reducer=(state,action)=>{switch(action.type){case"RESET":return action.state;case"UPDATE_TITLE":return state_management_objectSpread(state_management_objectSpread({},state),{},{title:action.title});case"UPDATE_STATE":return action.updater(state);case"UPDATE_ACTIVE_DATA":return state_management_objectSpread(state_management_objectSpread({},state),{},{activeData:state_management_objectSpread({},action.tables)});case"UPDATE_LAYER":return state_management_objectSpread(state_management_objectSpread({},state),{},{datasourceStates:state_management_objectSpread(state_management_objectSpread({},state.datasourceStates),{},{[action.datasourceId]:state_management_objectSpread(state_management_objectSpread({},state.datasourceStates[action.datasourceId]),{},{state:action.updater(state.datasourceStates[action.datasourceId].state,action.layerId)})})});case"VISUALIZATION_LOADED":return state_management_objectSpread(state_management_objectSpread({},state),{},{persistedId:action.doc.savedObjectId,title:action.doc.title,description:action.doc.description,datasourceStates:Object.entries(action.doc.state.datasourceStates).reduce((stateMap,[datasourceId,datasourceState])=>state_management_objectSpread(state_management_objectSpread({},stateMap),{},{[datasourceId]:{isLoading:true,state:datasourceState}}),{}),activeDatasourceId:getActiveDatasourceIdFromDoc(action.doc),visualization:state_management_objectSpread(state_management_objectSpread({},state.visualization),{},{activeId:action.doc.visualizationType,state:action.doc.state.visualization})});case"SWITCH_DATASOURCE":return state_management_objectSpread(state_management_objectSpread({},state),{},{datasourceStates:state_management_objectSpread(state_management_objectSpread({},state.datasourceStates),{},{[action.newDatasourceId]:state.datasourceStates[action.newDatasourceId]||{state:null,isLoading:true}}),activeDatasourceId:action.newDatasourceId});case"SWITCH_VISUALIZATION":return state_management_objectSpread(state_management_objectSpread({},state),{},{datasourceStates:"datasourceId"in action&&action.datasourceId?state_management_objectSpread(state_management_objectSpread({},state.datasourceStates),{},{[action.datasourceId]:state_management_objectSpread(state_management_objectSpread({},state.datasourceStates[action.datasourceId]),{},{state:action.datasourceState})}):state.datasourceStates,visualization:state_management_objectSpread(state_management_objectSpread({},state.visualization),{},{activeId:action.newVisualizationId,state:action.initialState}),stagedPreview:undefined});case"SELECT_SUGGESTION":return state_management_objectSpread(state_management_objectSpread({},state),{},{datasourceStates:"datasourceId"in action&&action.datasourceId?state_management_objectSpread(state_management_objectSpread({},state.datasourceStates),{},{[action.datasourceId]:state_management_objectSpread(state_management_objectSpread({},state.datasourceStates[action.datasourceId]),{},{state:action.datasourceState})}):state.datasourceStates,visualization:state_management_objectSpread(state_management_objectSpread({},state.visualization),{},{activeId:action.newVisualizationId,state:action.initialState}),stagedPreview:state.stagedPreview||{datasourceStates:state.datasourceStates,visualization:state.visualization}});case"ROLLBACK_SUGGESTION":return state_management_objectSpread(state_management_objectSpread(state_management_objectSpread({},state),state.stagedPreview||{}),{},{stagedPreview:undefined});case"SUBMIT_SUGGESTION":return state_management_objectSpread(state_management_objectSpread({},state),{},{stagedPreview:undefined});case"UPDATE_DATASOURCE_STATE":return state_management_objectSpread(state_management_objectSpread({},state),{},{datasourceStates:state_management_objectSpread(state_management_objectSpread({},state.datasourceStates),{},{[action.datasourceId]:{state:typeof action.updater==="function"?action.updater(state.datasourceStates[action.datasourceId].state):action.updater,isLoading:false}}),stagedPreview:action.clearStagedPreview?undefined:state.stagedPreview});case"UPDATE_VISUALIZATION_STATE":if(!state.visualization.activeId){throw new Error("Invariant: visualization state got updated without active visualization")}if(state.visualization.activeId!==action.visualizationId){return state}return state_management_objectSpread(state_management_objectSpread({},state),{},{visualization:state_management_objectSpread(state_management_objectSpread({},state.visualization),{},{state:action.newState}),stagedPreview:action.clearStagedPreview?undefined:state.stagedPreview});default:return state}};var data_panel_wrapper=__webpack_require__(201);function data_panel_wrapper_slicedToArray(arr,i){return data_panel_wrapper_arrayWithHoles(arr)||data_panel_wrapper_iterableToArrayLimit(arr,i)||data_panel_wrapper_unsupportedIterableToArray(arr,i)||data_panel_wrapper_nonIterableRest()}function data_panel_wrapper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function data_panel_wrapper_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return data_panel_wrapper_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return data_panel_wrapper_arrayLikeToArray(o,minLen)}function data_panel_wrapper_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function data_panel_wrapper_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function data_panel_wrapper_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const DataPanelWrapper=Object(external_kbnSharedDeps_React_["memo"])(props=>{const dispatch=props.dispatch,activeDatasource=props.activeDatasource;const setDatasourceState=Object(external_kbnSharedDeps_React_["useMemo"])(()=>updater=>{dispatch({type:"UPDATE_DATASOURCE_STATE",updater:updater,datasourceId:activeDatasource,clearStagedPreview:true})},[dispatch,activeDatasource]);const datasourceProps={dragDropContext:Object(external_kbnSharedDeps_React_["useContext"])(DragContext),state:props.datasourceState,setState:setDatasourceState,core:props.core,query:props.query,dateRange:props.dateRange,filters:props.filters,showNoDataPopover:props.showNoDataPopover};const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=data_panel_wrapper_slicedToArray(_useState,2),showDatasourceSwitcher=_useState2[0],setDatasourceSwitcher=_useState2[1];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,Object.keys(props.datasourceMap).length>1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"datasource-switch",className:"lnsDataPanelWrapper__switchSource",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.dataPanelWrapper.switchDatasource",{defaultMessage:"Switch to datasource"}),title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.dataPanelWrapper.switchDatasource",{defaultMessage:"Switch to datasource"}),"data-test-subj":"datasource-switch",onClick:()=>setDatasourceSwitcher(true),iconType:"gear"}),isOpen:showDatasourceSwitcher,closePopover:()=>setDatasourceSwitcher(false),panelPaddingSize:"none",anchorPosition:"rightUp"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.dataPanelWrapper.switchDatasource",{defaultMessage:"Switch to datasource"}),items:Object.keys(props.datasourceMap).map(datasourceId=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:datasourceId,"data-test-subj":"datasource-switch-".concat(datasourceId),icon:props.activeDatasource===datasourceId?"check":"empty",onClick:()=>{setDatasourceSwitcher(false);props.dispatch({type:"SWITCH_DATASOURCE",newDatasourceId:datasourceId})}},datasourceId))})),props.activeDatasource&&!props.datasourceIsLoading&&external_kbnSharedDeps_React_default.a.createElement(NativeRenderer,{className:"lnsDataPanelWrapper",render:props.datasourceMap[props.activeDatasource].renderDataPanel,nativeProps:datasourceProps}))});var config_panel=__webpack_require__(210);var layer_panel=__webpack_require__(219);function layer_settings_slicedToArray(arr,i){return layer_settings_arrayWithHoles(arr)||layer_settings_iterableToArrayLimit(arr,i)||layer_settings_unsupportedIterableToArray(arr,i)||layer_settings_nonIterableRest()}function layer_settings_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function layer_settings_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return layer_settings_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return layer_settings_arrayLikeToArray(o,minLen)}function layer_settings_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function layer_settings_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function layer_settings_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function LayerSettings({layerId:layerId,activeVisualization:activeVisualization,layerConfigProps:layerConfigProps}){var _activeVisualization$;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=layer_settings_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];if(!activeVisualization.renderLayerContextMenu){return null}const a11yText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editLayerSettings",{defaultMessage:"Edit layer settings"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"lnsLayerPopover_".concat(layerId),panelPaddingSize:"m",ownFocus:true,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editLayerSettings",{defaultMessage:"Edit layer settings"})},external_kbnSharedDeps_React_default.a.createElement(ToolbarButton,{size:"s",iconType:((_activeVisualization$=activeVisualization.getLayerContextMenuIcon)===null||_activeVisualization$===void 0?void 0:_activeVisualization$.call(activeVisualization,layerConfigProps))||"gear","aria-label":a11yText,title:a11yText,onClick:()=>setIsOpen(!isOpen),"data-test-subj":"lns_layer_settings"})),isOpen:isOpen,closePopover:()=>setIsOpen(false),anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(NativeRenderer,{render:activeVisualization.renderLayerContextMenu,nativeProps:layerConfigProps}))}var dimension_container=__webpack_require__(228);function dimension_container_slicedToArray(arr,i){return dimension_container_arrayWithHoles(arr)||dimension_container_iterableToArrayLimit(arr,i)||dimension_container_unsupportedIterableToArray(arr,i)||dimension_container_nonIterableRest()}function dimension_container_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dimension_container_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return dimension_container_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dimension_container_arrayLikeToArray(o,minLen)}function dimension_container_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function dimension_container_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function dimension_container_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function DimensionContainer({isOpen:isOpen,groupLabel:groupLabel,handleClose:handleClose,panel:panel}){const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=dimension_container_slicedToArray(_useState,2),focusTrapIsEnabled=_useState2[0],setFocusTrapIsEnabled=_useState2[1];const closeFlyout=()=>{handleClose();setFocusTrapIsEnabled(false)};Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isOpen){setTimeout(()=>{setFocusTrapIsEnabled(true)},255)}},[isOpen]);return isOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFocusTrap"],{disabled:!focusTrapIsEnabled,clickOutsideDisables:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOutsideClickDetector"],{onOutsideClick:closeFlyout,isDisabled:!isOpen},external_kbnSharedDeps_React_default.a.createElement("div",{role:"dialog","aria-labelledby":"lnsDimensionContainerTitle",className:"lnsDimensionContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true,className:"lnsDimensionContainer__header"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:closeFlyout,"data-test-subj":"lns-indexPattern-dimensionContainerTitle",id:"lnsDimensionContainerTitle",iconType:"sortLeft",flush:"left"},external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.configure.configurePanelTitle",{defaultMessage:"{groupLabel} configuration",values:{groupLabel:groupLabel}}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"eui-yScrollWithShadows",grow:1},panel),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutFooter"],{className:"lnsDimensionContainer__footer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{flush:"left",size:"s",iconType:"cross",onClick:closeFlyout},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.dimensionContainer.close",{defaultMessage:"Close"})))))):null}function color_indicator_extends(){color_indicator_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return color_indicator_extends.apply(this,arguments)}function ColorIndicator({accessorConfig:accessorConfig,children:children}){let indicatorIcon=null;if(accessorConfig.triggerIcon&&accessorConfig.triggerIcon!=="none"){const baseIconProps={size:"s",className:"lnsLayerPanel__colorIndicator"};indicatorIcon=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},accessorConfig.triggerIcon==="color"&&accessorConfig.color&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],color_indicator_extends({},baseIconProps,{color:accessorConfig.color,type:"stopFilled","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.colorIndicatorLabel",{defaultMessage:"Color of this dimension: {hex}",values:{hex:accessorConfig.color}})})),accessorConfig.triggerIcon==="disabled"&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],color_indicator_extends({},baseIconProps,{type:"stopSlash",color:"subdued","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.noColorIndicatorLabel",{defaultMessage:"This dimension does not have an individual color"})})),accessorConfig.triggerIcon==="colorBy"&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],color_indicator_extends({},baseIconProps,{type:"brush",color:"text","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.paletteColorIndicatorLabel",{defaultMessage:"This dimension is using a palette"})})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",alignItems:"center"},indicatorIcon,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,children))}function PaletteIndicator({accessorConfig:accessorConfig}){if(accessorConfig.triggerIcon!=="colorBy"||!accessorConfig.palette)return null;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{className:"lnsLayerPanel__paletteContainer",gutterSize:"none",alignItems:"center"},accessorConfig.palette.map(color=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:color,className:"lnsLayerPanel__paletteColor",grow:true,style:{backgroundColor:color}})))}function layer_panel_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function layer_panel_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){layer_panel_ownKeys(Object(source),true).forEach((function(key){layer_panel_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{layer_panel_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function layer_panel_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function layer_panel_slicedToArray(arr,i){return layer_panel_arrayWithHoles(arr)||layer_panel_iterableToArrayLimit(arr,i)||layer_panel_unsupportedIterableToArray(arr,i)||layer_panel_nonIterableRest()}function layer_panel_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function layer_panel_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return layer_panel_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return layer_panel_arrayLikeToArray(o,minLen)}function layer_panel_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function layer_panel_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function layer_panel_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const initialActiveDimensionState={isNew:false};function isConfiguration(value){return Boolean(value)&&typeof value==="object"&&"columnId"in value&&"groupId"in value&&"layerId"in value}function isSameConfiguration(config1,config2){return isConfiguration(config1)&&isConfiguration(config2)&&config1.columnId===config2.columnId&&config1.groupId===config2.groupId&&config1.layerId===config2.layerId}function layer_panel_LayerPanel(props){const dragDropContext=Object(external_kbnSharedDeps_React_["useContext"])(DragContext);const _useState=Object(external_kbnSharedDeps_React_["useState"])(initialActiveDimensionState),_useState2=layer_panel_slicedToArray(_useState,2),activeDimension=_useState2[0],setActiveDimension=_useState2[1];const framePublicAPI=props.framePublicAPI,layerId=props.layerId,isOnlyLayer=props.isOnlyLayer,onRemoveLayer=props.onRemoveLayer,dataTestSubj=props.dataTestSubj;const datasourcePublicAPI=framePublicAPI.datasourceLayers[layerId];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setActiveDimension(initialActiveDimensionState)},[props.activeVisualizationId]);if(!datasourcePublicAPI||!props.activeVisualizationId||!props.visualizationMap[props.activeVisualizationId]){return null}const activeVisualization=props.visualizationMap[props.activeVisualizationId];const layerVisualizationConfigProps={layerId:layerId,dragDropContext:dragDropContext,state:props.visualizationState,frame:props.framePublicAPI,dateRange:props.framePublicAPI.dateRange,activeData:props.framePublicAPI.activeData};const datasourceId=datasourcePublicAPI.datasourceId;const layerDatasourceState=props.datasourceStates[datasourceId].state;const layerDatasource=props.datasourceMap[datasourceId];const layerDatasourceDropProps={layerId:layerId,dragDropContext:dragDropContext,state:layerDatasourceState,setState:newState=>{props.updateDatasource(datasourceId,newState)}};const layerDatasourceConfigProps=layer_panel_objectSpread(layer_panel_objectSpread({},layerDatasourceDropProps),{},{frame:props.framePublicAPI,dateRange:props.framePublicAPI.dateRange,activeData:props.framePublicAPI.activeData});const _activeVisualization$=activeVisualization.getConfiguration(layerVisualizationConfigProps),groups=_activeVisualization$.groups;const isEmptyLayer=!groups.some(d=>d.accessors.length>0);const activeId=activeDimension.activeId,activeGroup=activeDimension.activeGroup;const columnLabelMap=layerDatasource.uniqueLabels(layerDatasourceConfigProps.state);return external_kbnSharedDeps_React_default.a.createElement(ChildDragDropProvider,dragDropContext,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{"data-test-subj":dataTestSubj,className:"lnsLayerPanel",paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"flexStart",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"lnsLayerPanel__settingsFlexItem"},external_kbnSharedDeps_React_default.a.createElement(LayerSettings,{layerId:layerId,layerConfigProps:layer_panel_objectSpread(layer_panel_objectSpread({},layerVisualizationConfigProps),{},{setState:props.updateVisualization}),activeVisualization:activeVisualization})),layerDatasource&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"lnsLayerPanel__sourceFlexItem"},external_kbnSharedDeps_React_default.a.createElement(NativeRenderer,{render:layerDatasource.renderLayerPanel,nativeProps:{layerId:layerId,state:layerDatasourceState,activeData:props.framePublicAPI.activeData,setState:updater=>{const newState=typeof updater==="function"?updater(layerDatasourceState):updater;const nextPublicAPI=layerDatasource.getPublicAPI({state:newState,layerId:layerId});const nextTable=new Set(nextPublicAPI.getTableSpec().map(({columnId:columnId})=>columnId));const removed=datasourcePublicAPI.getTableSpec().map(({columnId:columnId})=>columnId).filter(columnId=>!nextTable.has(columnId));let nextVisState=props.visualizationState;removed.forEach(columnId=>{nextVisState=activeVisualization.removeDimension({layerId:layerId,columnId:columnId,prevState:nextVisState})});props.updateAll(datasourceId,newState,nextVisState)}}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),groups.map((group,index)=>{const newId=generateId();const isMissing=!isEmptyLayer&&group.required&&group.accessors.length===0;const triggerLinkA11yText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.configure.editConfig",{defaultMessage:"Click to edit configuration or drag to move"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{className:group.supportsMoreColumns?"lnsLayerPanel__row":"lnsLayerPanel__row lnsLayerPanel__row--notSupportsMoreColumns",fullWidth:true,label:external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsLayerPanel__groupLabel"},group.groupLabel),labelType:"legend",key:index,isInvalid:isMissing,error:isMissing?external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsLayerPanel__error"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.requiredDimensionWarningLabel",{defaultMessage:"Required dimension"})):[]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ReorderProvider,{id:group.groupId,className:"lnsLayerPanel__group"},group.accessors.map(accessorConfig=>{const accessor=accessorConfig.columnId;const dragging=dragDropContext.dragging;const dragType=Object(types["a"])(dragging)&&accessor===dragging.columnId?"move":Object(types["a"])(dragging)&&group.groupId===dragging.groupId?"reorder":"copy";const dropType=Object(types["a"])(dragging)?group.groupId!==dragging.groupId?"replace":"reorder":"add";const isFromCompatibleGroup=(dragging===null||dragging===void 0?void 0:dragging.groupId)!==group.groupId&&layerDatasource.canHandleDrop(layer_panel_objectSpread(layer_panel_objectSpread({},layerDatasourceDropProps),{},{columnId:accessor,filterOperations:group.filterOperations}));const isFromTheSameGroup=Object(types["a"])(dragging)&&dragging.groupId===group.groupId&&dragging.columnId!==accessor&&dragging.groupId!=="y";const isDroppable=Object(types["a"])(dragging)?dragType==="reorder"?isFromTheSameGroup:isFromCompatibleGroup:layerDatasource.canHandleDrop(layer_panel_objectSpread(layer_panel_objectSpread({},layerDatasourceDropProps),{},{columnId:accessor,filterOperations:group.filterOperations}));return external_kbnSharedDeps_React_default.a.createElement(DragDrop,{key:accessor,draggable:!activeId,dragType:dragType,dropType:dropType,"data-test-subj":group.dataTestSubj,itemsInGroup:group.accessors.map(a=>typeof a==="string"?a:a.columnId),className:"lnsLayerPanel__dimensionContainer",value:{columnId:accessor,groupId:group.groupId,layerId:layerId,id:accessor},isValueEqual:isSameConfiguration,label:columnLabelMap[accessor],droppable:dragging&&isDroppable,dropTo:dropTargetId=>{layerDatasource.onDrop(layer_panel_objectSpread(layer_panel_objectSpread({isReorder:true},layerDatasourceDropProps),{},{droppedItem:{columnId:accessor,groupId:group.groupId,layerId:layerId,id:accessor},columnId:dropTargetId,filterOperations:group.filterOperations}))},onDrop:droppedItem=>{const isReorder=Object(types["a"])(droppedItem)&&droppedItem.groupId===group.groupId&&droppedItem.columnId!==accessor;const dropResult=layerDatasource.onDrop(layer_panel_objectSpread(layer_panel_objectSpread({isReorder:isReorder},layerDatasourceDropProps),{},{droppedItem:droppedItem,columnId:accessor,filterOperations:group.filterOperations}));if(typeof dropResult==="object"){props.updateVisualization(activeVisualization.removeDimension({layerId:layerId,columnId:dropResult.deleted,prevState:props.visualizationState}))}}},external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsLayerPanel__dimension"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{className:"lnsLayerPanel__dimensionLink",onClick:()=>{if(activeId){setActiveDimension(initialActiveDimensionState)}else{setActiveDimension({isNew:false,activeGroup:group,activeId:accessor})}},"aria-label":triggerLinkA11yText,title:triggerLinkA11yText},external_kbnSharedDeps_React_default.a.createElement(ColorIndicator,{accessorConfig:accessorConfig},external_kbnSharedDeps_React_default.a.createElement(NativeRenderer,{render:props.datasourceMap[datasourceId].renderDimensionTrigger,nativeProps:layer_panel_objectSpread(layer_panel_objectSpread({},layerDatasourceConfigProps),{},{columnId:accessor,filterOperations:group.filterOperations})}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{className:"lnsLayerPanel__dimensionRemove","data-test-subj":"indexPattern-dimension-remove",iconType:"cross",iconSize:"s",size:"s",color:"danger","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.removeColumnLabel",{defaultMessage:"Remove configuration"}),title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.indexPattern.removeColumnLabel",{defaultMessage:"Remove configuration"}),onClick:()=>{factory_trackUiEvent("indexpattern_dimension_removed");props.updateAll(datasourceId,layerDatasource.removeColumn({layerId:layerId,columnId:accessor,prevState:layerDatasourceState}),activeVisualization.removeDimension({layerId:layerId,columnId:accessor,prevState:props.visualizationState}))}}),external_kbnSharedDeps_React_default.a.createElement(PaletteIndicator,{accessorConfig:accessorConfig})))})),group.supportsMoreColumns?external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsLayerPanel__dimensionContainer"},external_kbnSharedDeps_React_default.a.createElement(DragDrop,{"data-test-subj":group.dataTestSubj,droppable:Boolean(dragDropContext.dragging)&&(!Object(types["a"])(dragDropContext.dragging)||dragDropContext.dragging.groupId!==group.groupId)&&layerDatasource.canHandleDrop(layer_panel_objectSpread(layer_panel_objectSpread({},layerDatasourceDropProps),{},{columnId:newId,filterOperations:group.filterOperations})),onDrop:droppedItem=>{const dropResult=layerDatasource.onDrop(layer_panel_objectSpread(layer_panel_objectSpread({},layerDatasourceDropProps),{},{droppedItem:droppedItem,columnId:newId,filterOperations:group.filterOperations}));if(dropResult){props.updateVisualization(activeVisualization.setDimension({layerId:layerId,groupId:group.groupId,columnId:newId,prevState:props.visualizationState}));if(typeof dropResult==="object"){props.updateVisualization(activeVisualization.removeDimension({layerId:layerId,columnId:dropResult.deleted,prevState:props.visualizationState}))}}}},external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsLayerPanel__dimension lnsLayerPanel__dimension--empty"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{className:"lnsLayerPanel__triggerText",color:"text",size:"xs",iconType:"plusInCircleFilled",contentProps:{className:"lnsLayerPanel__triggerTextContent"},"data-test-subj":"lns-empty-dimension",onClick:()=>{if(activeId){setActiveDimension(initialActiveDimensionState)}else{setActiveDimension({isNew:true,activeGroup:group,activeId:newId})}}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.configure.emptyConfig",defaultMessage:"Drop a field or click to add"}))))):null))}),external_kbnSharedDeps_React_default.a.createElement(DimensionContainer,{isOpen:!!activeId,groupLabel:(activeGroup===null||activeGroup===void 0?void 0:activeGroup.groupLabel)||"",handleClose:()=>setActiveDimension(initialActiveDimensionState),panel:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,activeGroup&&activeId&&external_kbnSharedDeps_React_default.a.createElement(NativeRenderer,{render:props.datasourceMap[datasourceId].renderDimensionEditor,nativeProps:layer_panel_objectSpread(layer_panel_objectSpread({},layerDatasourceConfigProps),{},{core:props.core,columnId:activeId,filterOperations:activeGroup.filterOperations,dimensionGroups:groups,setState:newState=>{props.updateAll(datasourceId,newState,activeVisualization.setDimension({layerId:layerId,groupId:activeGroup.groupId,columnId:activeId,prevState:props.visualizationState}));setActiveDimension(layer_panel_objectSpread(layer_panel_objectSpread({},activeDimension),{},{isNew:false}))}})}),activeGroup&&activeId&&!activeDimension.isNew&&activeVisualization.renderDimensionEditor&&(activeGroup===null||activeGroup===void 0?void 0:activeGroup.enableDimensionEditor)&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsLayerPanel__styleEditor"},external_kbnSharedDeps_React_default.a.createElement(NativeRenderer,{render:activeVisualization.renderDimensionEditor,nativeProps:layer_panel_objectSpread(layer_panel_objectSpread({},layerVisualizationConfigProps),{},{groupId:activeGroup.groupId,accessor:activeId,setState:props.updateVisualization})})))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",iconType:"trash",color:"danger","data-test-subj":"lnsLayerRemove",onClick:()=>{const el=document.activeElement;if(el===null||el===void 0?void 0:el.blur){el.blur()}onRemoveLayer()}},isOnlyLayer?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.resetLayer",{defaultMessage:"Reset layer"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.deleteLayer",{defaultMessage:"Delete layer"}))))))}function layer_actions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function layer_actions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){layer_actions_ownKeys(Object(source),true).forEach((function(key){layer_actions_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{layer_actions_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function layer_actions_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function removeLayer(opts){const state=opts.state,trackUiEvent=opts.trackUiEvent,activeVisualization=opts.activeVisualization,layerId=opts.layerId,datasourceMap=opts.datasourceMap;const isOnlyLayer=activeVisualization.getLayerIds(state.visualization.state).every(id=>id===opts.layerId);trackUiEvent(isOnlyLayer?"layer_cleared":"layer_removed");return layer_actions_objectSpread(layer_actions_objectSpread({},state),{},{datasourceStates:external_kbnSharedDeps_Lodash_default.a.mapValues(state.datasourceStates,(datasourceState,datasourceId)=>{const datasource=datasourceMap[datasourceId];return layer_actions_objectSpread(layer_actions_objectSpread({},datasourceState),{},{state:isOnlyLayer?datasource.clearLayer(datasourceState.state,layerId):datasource.removeLayer(datasourceState.state,layerId)})}),visualization:layer_actions_objectSpread(layer_actions_objectSpread({},state.visualization),{},{state:isOnlyLayer||!activeVisualization.removeLayer?activeVisualization.clearLayer(state.visualization.state,layerId):activeVisualization.removeLayer(state.visualization.state,layerId)}),stagedPreview:undefined})}function appendLayer({trackUiEvent:trackUiEvent,activeVisualization:activeVisualization,state:state,generateId:generateId,activeDatasource:activeDatasource}){trackUiEvent("layer_added");if(!activeVisualization.appendLayer){return state}const layerId=generateId();return layer_actions_objectSpread(layer_actions_objectSpread({},state),{},{datasourceStates:layer_actions_objectSpread(layer_actions_objectSpread({},state.datasourceStates),{},{[activeDatasource.id]:layer_actions_objectSpread(layer_actions_objectSpread({},state.datasourceStates[activeDatasource.id]),{},{state:activeDatasource.insertLayer(state.datasourceStates[activeDatasource.id].state,layerId)})}),visualization:layer_actions_objectSpread(layer_actions_objectSpread({},state.visualization),{},{state:activeVisualization.appendLayer(state.visualization.state,layerId)}),stagedPreview:undefined})}function config_panel_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function config_panel_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){config_panel_ownKeys(Object(source),true).forEach((function(key){config_panel_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{config_panel_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function config_panel_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function config_panel_extends(){config_panel_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return config_panel_extends.apply(this,arguments)}const config_panel_ConfigPanelWrapper=Object(external_kbnSharedDeps_React_["memo"])((function ConfigPanelWrapper(props){const activeVisualization=props.visualizationMap[props.activeVisualizationId||""];const visualizationState=props.visualizationState;return activeVisualization&&visualizationState?external_kbnSharedDeps_React_default.a.createElement(LayerPanels,config_panel_extends({},props,{activeVisualization:activeVisualization})):null}));function LayerPanels(props){const activeVisualization=props.activeVisualization,visualizationState=props.visualizationState,dispatch=props.dispatch,activeDatasourceId=props.activeDatasourceId,datasourceMap=props.datasourceMap;const setVisualizationState=Object(external_kbnSharedDeps_React_["useMemo"])(()=>newState=>{dispatch({type:"UPDATE_VISUALIZATION_STATE",visualizationId:activeVisualization.id,newState:newState,clearStagedPreview:false})},[dispatch,activeVisualization]);const updateDatasource=Object(external_kbnSharedDeps_React_["useMemo"])(()=>(datasourceId,newState)=>{dispatch({type:"UPDATE_DATASOURCE_STATE",updater:()=>newState,datasourceId:datasourceId,clearStagedPreview:false})},[dispatch]);const updateAll=Object(external_kbnSharedDeps_React_["useMemo"])(()=>(datasourceId,newDatasourceState,newVisualizationState)=>{dispatch({type:"UPDATE_STATE",subType:"UPDATE_ALL_STATES",updater:prevState=>config_panel_objectSpread(config_panel_objectSpread({},prevState),{},{datasourceStates:config_panel_objectSpread(config_panel_objectSpread({},prevState.datasourceStates),{},{[datasourceId]:{state:newDatasourceState,isLoading:false}}),visualization:config_panel_objectSpread(config_panel_objectSpread({},prevState.visualization),{},{state:newVisualizationState}),stagedPreview:undefined})})},[dispatch]);const layerIds=activeVisualization.getLayerIds(visualizationState);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],{className:"lnsConfigPanel"},layerIds.map((layerId,index)=>external_kbnSharedDeps_React_default.a.createElement(layer_panel_LayerPanel,config_panel_extends({},props,{key:layerId,layerId:layerId,dataTestSubj:"lns-layerPanel-".concat(index),visualizationState:visualizationState,updateVisualization:setVisualizationState,updateDatasource:updateDatasource,updateAll:updateAll,isOnlyLayer:layerIds.length===1,onRemoveLayer:()=>{dispatch({type:"UPDATE_STATE",subType:"REMOVE_OR_CLEAR_LAYER",updater:state=>removeLayer({activeVisualization:activeVisualization,layerId:layerId,trackUiEvent:factory_trackUiEvent,datasourceMap:datasourceMap,state:state})})}}))),activeVisualization.appendLayer&&visualizationState&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{className:"eui-fullWidth",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.addLayer",{defaultMessage:"Add a layer"}),content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.addLayerTooltip",{defaultMessage:"Use multiple layers to combine chart types or visualize different index patterns."}),position:"bottom"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{className:"lnsConfigPanel__addLayerBtn",fullWidth:true,size:"s","data-test-subj":"lnsLayerAddButton","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.xyChart.addLayerButton",{defaultMessage:"Add layer"}),onClick:()=>{dispatch({type:"UPDATE_STATE",subType:"ADD_LAYER",updater:state=>appendLayer({activeVisualization:activeVisualization,generateId:generateId,trackUiEvent:factory_trackUiEvent,activeDatasource:datasourceMap[activeDatasourceId],state:state})})},iconType:"plusInCircleFilled"}))))}var frame_layout=__webpack_require__(237);function FrameLayout(props){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPage"],{className:"lnsFrameLayout"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsFrameLayout__pageContent"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageSideBar"],{className:"lnsFrameLayout__sidebar"},props.dataPanel),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageBody"],{className:"lnsFrameLayout__pageBody",restrictWidth:false},props.workspacePanel,props.suggestionsPanel),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageSideBar"],{className:"lnsFrameLayout__sidebar lnsFrameLayout__sidebar--right"},props.configPanel)))}var suggestion_panel=__webpack_require__(246);var target_common=__webpack_require__(37);function suggestion_helpers_objectWithoutProperties(source,excluded){if(source==null)return{};var target=suggestion_helpers_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function suggestion_helpers_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function suggestion_helpers_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function suggestion_helpers_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){suggestion_helpers_ownKeys(Object(source),true).forEach((function(key){suggestion_helpers_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{suggestion_helpers_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function suggestion_helpers_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function suggestion_helpers_getSuggestions({datasourceMap:datasourceMap,datasourceStates:datasourceStates,visualizationMap:visualizationMap,activeVisualizationId:activeVisualizationId,subVisualizationId:subVisualizationId,visualizationState:visualizationState,field:field,visualizeTriggerFieldContext:visualizeTriggerFieldContext,activeData:activeData,mainPalette:mainPalette}){const datasources=Object.entries(datasourceMap).filter(([datasourceId])=>datasourceStates[datasourceId]&&!datasourceStates[datasourceId].isLoading);const datasourceTableSuggestions=external_kbnSharedDeps_Lodash_default.a.flatten(datasources.map(([datasourceId,datasource])=>{const datasourceState=datasourceStates[datasourceId].state;let dataSourceSuggestions;if(visualizeTriggerFieldContext){dataSourceSuggestions=datasource.getDatasourceSuggestionsForVisualizeField(datasourceState,visualizeTriggerFieldContext.indexPatternId,visualizeTriggerFieldContext.fieldName)}else if(field){dataSourceSuggestions=datasource.getDatasourceSuggestionsForField(datasourceState,field)}else{dataSourceSuggestions=datasource.getDatasourceSuggestionsFromCurrentState(datasourceState,activeData)}return dataSourceSuggestions.map(suggestion=>suggestion_helpers_objectSpread(suggestion_helpers_objectSpread({},suggestion),{},{datasourceId:datasourceId}))}));return external_kbnSharedDeps_Lodash_default.a.flatten(Object.entries(visualizationMap).map(([visualizationId,visualization])=>external_kbnSharedDeps_Lodash_default.a.flatten(datasourceTableSuggestions.map(datasourceSuggestion=>{const table=datasourceSuggestion.table;const currentVisualizationState=visualizationId===activeVisualizationId?visualizationState:undefined;const palette=mainPalette||(activeVisualizationId&&visualizationMap[activeVisualizationId]&&visualizationMap[activeVisualizationId].getMainPalette?visualizationMap[activeVisualizationId].getMainPalette(visualizationState):undefined);return getVisualizationSuggestions(visualization,table,visualizationId,datasourceSuggestion,currentVisualizationState,subVisualizationId,palette)})))).sort((a,b)=>b.score-a.score)}function applyVisualizeFieldSuggestions({datasourceMap:datasourceMap,datasourceStates:datasourceStates,visualizationMap:visualizationMap,activeVisualizationId:activeVisualizationId,visualizationState:visualizationState,visualizeTriggerFieldContext:visualizeTriggerFieldContext,dispatch:dispatch}){const suggestions=suggestion_helpers_getSuggestions({datasourceMap:datasourceMap,datasourceStates:datasourceStates,visualizationMap:visualizationMap,activeVisualizationId:activeVisualizationId,visualizationState:visualizationState,visualizeTriggerFieldContext:visualizeTriggerFieldContext});if(suggestions.length){const selectedSuggestion=suggestions.find(s=>s.visualizationId===activeVisualizationId)||suggestions[0];switchToSuggestion(dispatch,selectedSuggestion,"SWITCH_VISUALIZATION")}}function getVisualizationSuggestions(visualization,table,visualizationId,datasourceSuggestion,currentVisualizationState,subVisualizationId,mainPalette){return visualization.getSuggestions({table:table,state:currentVisualizationState,keptLayerIds:datasourceSuggestion.keptLayerIds,subVisualizationId:subVisualizationId,mainPalette:mainPalette}).map(_ref=>{let state=_ref.state,visualizationSuggestion=suggestion_helpers_objectWithoutProperties(_ref,["state"]);return suggestion_helpers_objectSpread(suggestion_helpers_objectSpread({},visualizationSuggestion),{},{visualizationId:visualizationId,visualizationState:state,keptLayerIds:datasourceSuggestion.keptLayerIds,datasourceState:datasourceSuggestion.state,datasourceId:datasourceSuggestion.datasourceId,columns:table.columns.length,changeType:table.changeType})})}function switchToSuggestion(dispatch,suggestion,type="SELECT_SUGGESTION"){const action={type:type,newVisualizationId:suggestion.visualizationId,initialState:suggestion.visualizationState,datasourceState:suggestion.datasourceState,datasourceId:suggestion.datasourceId};dispatch(action)}function prependDatasourceExpression(visualizationExpression,datasourceMap,datasourceStates){const datasourceExpressions=[];Object.entries(datasourceMap).forEach(([datasourceId,datasource])=>{const state=datasourceStates[datasourceId].state;const layers=datasource.getLayers(datasourceStates[datasourceId].state);layers.forEach(layerId=>{const result=datasource.toExpression(state,layerId);if(result){datasourceExpressions.push([layerId,result])}})});if(datasourceExpressions.length===0||visualizationExpression===null){return null}const parsedDatasourceExpressions=datasourceExpressions.map(([layerId,expr])=>[layerId,typeof expr==="string"?Object(target_common["fromExpression"])(expr):expr]);const datafetchExpression={type:"function",function:"lens_merge_tables",arguments:{layerIds:parsedDatasourceExpressions.map(([id])=>id),tables:parsedDatasourceExpressions.map(([id,expr])=>expr)}};const parsedVisualizationExpression=typeof visualizationExpression==="string"?Object(target_common["fromExpression"])(visualizationExpression):visualizationExpression;return{type:"expression",chain:[{type:"function",function:"kibana",arguments:{}},datafetchExpression,...parsedVisualizationExpression.chain]}}function expression_helpers_buildExpression({visualization:visualization,visualizationState:visualizationState,datasourceMap:datasourceMap,datasourceStates:datasourceStates,datasourceLayers:datasourceLayers,title:title,description:description}){if(visualization===null){return null}const visualizationExpression=visualization.toExpression(visualizationState,datasourceLayers,{title:title,description:description});const completeExpression=prependDatasourceExpression(visualizationExpression,datasourceMap,datasourceStates);return completeExpression}function state_helpers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function state_helpers_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){state_helpers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){state_helpers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function initializeDatasources(_x,_x2,_x3,_x4){return _initializeDatasources.apply(this,arguments)}function _initializeDatasources(){_initializeDatasources=state_helpers_asyncToGenerator(regeneratorRuntime.mark((function _callee(datasourceMap,datasourceStates,references,initialContext){var states;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:states={};_context.next=3;return Promise.all(Object.entries(datasourceMap).map(([datasourceId,datasource])=>{if(datasourceStates[datasourceId]){return datasource.initialize(datasourceStates[datasourceId].state||undefined,references,initialContext).then(datasourceState=>{states[datasourceId]={isLoading:false,state:datasourceState}})}}));case 3:return _context.abrupt("return",states);case 4:case"end":return _context.stop()}}),_callee)})));return _initializeDatasources.apply(this,arguments)}function createDatasourceLayers(datasourceMap,datasourceStates){const datasourceLayers={};Object.keys(datasourceMap).filter(id=>datasourceStates[id]&&!datasourceStates[id].isLoading).forEach(id=>{const datasourceState=datasourceStates[id].state;const datasource=datasourceMap[id];const layers=datasource.getLayers(datasourceState);layers.forEach(layer=>{datasourceLayers[layer]=datasourceMap[id].getPublicAPI({state:datasourceState,layerId:layer})})});return datasourceLayers}function persistedStateToExpression(_x5,_x6,_x7){return _persistedStateToExpression.apply(this,arguments)}function _persistedStateToExpression(){_persistedStateToExpression=state_helpers_asyncToGenerator(regeneratorRuntime.mark((function _callee2(datasources,visualizations,doc){var _doc$state,visualizationState,persistedDatasourceStates,visualizationType,references,title,description,visualization,datasourceStates,datasourceLayers;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_doc$state=doc.state,visualizationState=_doc$state.visualization,persistedDatasourceStates=_doc$state.datasourceStates,visualizationType=doc.visualizationType,references=doc.references,title=doc.title,description=doc.description;if(visualizationType){_context2.next=3;break}return _context2.abrupt("return",null);case 3:visualization=visualizations[visualizationType];_context2.next=6;return initializeDatasources(datasources,Object.fromEntries(Object.entries(persistedDatasourceStates).map(([id,state])=>[id,{isLoading:false,state:state}])),references);case 6:datasourceStates=_context2.sent;datasourceLayers=createDatasourceLayers(datasources,datasourceStates);return _context2.abrupt("return",expression_helpers_buildExpression({title:title,description:description,visualization:visualization,visualizationState:visualizationState,datasourceMap:datasources,datasourceStates:datasourceStates,datasourceLayers:datasourceLayers}));case 9:case"end":return _context2.stop()}}),_callee2)})));return _persistedStateToExpression.apply(this,arguments)}const validateDatasourceAndVisualization=(currentDataSource,currentDatasourceState,currentVisualization,currentVisualizationState,frameAPI)=>{const layersGroups=currentVisualizationState?currentVisualization===null||currentVisualization===void 0?void 0:currentVisualization.getLayerIds(currentVisualizationState).reduce((memo,layerId)=>{const groups=currentVisualization===null||currentVisualization===void 0?void 0:currentVisualization.getConfiguration({frame:frameAPI,layerId:layerId,state:currentVisualizationState}).groups;if(groups){memo[layerId]=groups}return memo},{}):undefined;const datasourceValidationErrors=currentDatasourceState?currentDataSource===null||currentDataSource===void 0?void 0:currentDataSource.getErrorMessages(currentDatasourceState,layersGroups):undefined;const visualizationValidationErrors=currentVisualizationState?currentVisualization===null||currentVisualization===void 0?void 0:currentVisualization.getErrorMessages(currentVisualizationState,frameAPI):undefined;if((datasourceValidationErrors===null||datasourceValidationErrors===void 0?void 0:datasourceValidationErrors.length)||(visualizationValidationErrors===null||visualizationValidationErrors===void 0?void 0:visualizationValidationErrors.length)){return[...datasourceValidationErrors||[],...visualizationValidationErrors||[]]}return undefined};function suggestion_panel_slicedToArray(arr,i){return suggestion_panel_arrayWithHoles(arr)||suggestion_panel_iterableToArrayLimit(arr,i)||suggestion_panel_unsupportedIterableToArray(arr,i)||suggestion_panel_nonIterableRest()}function suggestion_panel_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function suggestion_panel_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return suggestion_panel_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return suggestion_panel_arrayLikeToArray(o,minLen)}function suggestion_panel_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function suggestion_panel_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function suggestion_panel_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function suggestion_panel_extends(){suggestion_panel_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return suggestion_panel_extends.apply(this,arguments)}function suggestion_panel_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function suggestion_panel_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){suggestion_panel_ownKeys(Object(source),true).forEach((function(key){suggestion_panel_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{suggestion_panel_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function suggestion_panel_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const MAX_SUGGESTIONS_DISPLAYED=5;const PreviewRenderer=({withLabel:withLabel,ExpressionRendererComponent:ExpressionRendererComponent,expression:expression,hasError:hasError})=>{const onErrorMessage=external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsSuggestionPanel__suggestionIcon"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{size:"xl",color:"danger",type:"alert","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.previewErrorLabel",{defaultMessage:"Preview rendering failed"}),content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.previewErrorLabel",{defaultMessage:"Preview rendering failed"})}));return external_kbnSharedDeps_React_default.a.createElement("div",{className:classnames_default()("lnsSuggestionPanel__chartWrapper",{"lnsSuggestionPanel__chartWrapper--withLabel":withLabel})},!expression||hasError?onErrorMessage:external_kbnSharedDeps_React_default.a.createElement(ExpressionRendererComponent,{className:"lnsSuggestionPanel__expressionRenderer",padding:"s",expression:expression,debounce:2e3,renderError:()=>onErrorMessage}))};const SuggestionPreview=({preview:preview,ExpressionRenderer:ExpressionRendererComponent,selected:selected,onSelect:onSelect,showTitleAsLabel:showTitleAsLabel})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:preview.title},external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"lnsSuggestion-".concat(Object(external_kbnSharedDeps_Lodash_["camelCase"])(preview.title))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{className:classnames_default()("lnsSuggestionPanel__button",{"lnsSuggestionPanel__button-isSelected":selected}),paddingSize:"none","data-test-subj":"lnsSuggestion",onClick:onSelect},preview.expression||preview.error?external_kbnSharedDeps_React_default.a.createElement(PreviewRenderer,{ExpressionRendererComponent:ExpressionRendererComponent,expression:preview.expression&&Object(target_common["toExpression"])(preview.expression),withLabel:Boolean(showTitleAsLabel),hasError:Boolean(preview.error)}):external_kbnSharedDeps_React_default.a.createElement("span",{className:"lnsSuggestionPanel__suggestionIcon"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"xxl",type:preview.icon})),showTitleAsLabel&&external_kbnSharedDeps_React_default.a.createElement("span",{className:"lnsSuggestionPanel__buttonLabel"},preview.title))));function SuggestionPanel({activeDatasourceId:activeDatasourceId,datasourceMap:datasourceMap,datasourceStates:datasourceStates,activeVisualizationId:activeVisualizationId,visualizationMap:visualizationMap,visualizationState:visualizationState,dispatch:dispatch,frame:frame,ExpressionRenderer:ExpressionRendererComponent,stagedPreview:stagedPreview,plugins:plugins}){const currentDatasourceStates=stagedPreview?stagedPreview.datasourceStates:datasourceStates;const currentVisualizationState=stagedPreview?stagedPreview.visualization.state:visualizationState;const currentVisualizationId=stagedPreview?stagedPreview.visualization.activeId:activeVisualizationId;const _useMemo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _currentDatasourceSta;const newSuggestions=suggestion_helpers_getSuggestions({datasourceMap:datasourceMap,datasourceStates:currentDatasourceStates,visualizationMap:visualizationMap,activeVisualizationId:currentVisualizationId,visualizationState:currentVisualizationState,activeData:frame.activeData}).filter(suggestion=>!suggestion.hide).filter(({visualizationId:visualizationId,visualizationState:suggestionVisualizationState,datasourceState:suggestionDatasourceState,datasourceId:suggetionDatasourceId})=>validateDatasourceAndVisualization(suggetionDatasourceId?datasourceMap[suggetionDatasourceId]:null,suggestionDatasourceState,visualizationMap[visualizationId],suggestionVisualizationState,frame)==null).slice(0,MAX_SUGGESTIONS_DISPLAYED).map(suggestion=>suggestion_panel_objectSpread(suggestion_panel_objectSpread({},suggestion),{},{previewExpression:preparePreviewExpression(suggestion,visualizationMap[suggestion.visualizationId],datasourceMap,currentDatasourceStates,frame)}));const validationErrors=validateDatasourceAndVisualization(activeDatasourceId?datasourceMap[activeDatasourceId]:null,activeDatasourceId&&((_currentDatasourceSta=currentDatasourceStates[activeDatasourceId])===null||_currentDatasourceSta===void 0?void 0:_currentDatasourceSta.state),currentVisualizationId?visualizationMap[currentVisualizationId]:null,currentVisualizationState,frame);const newStateExpression=currentVisualizationState&&currentVisualizationId&&!validationErrors?preparePreviewExpression({visualizationState:currentVisualizationState},visualizationMap[currentVisualizationId],datasourceMap,currentDatasourceStates,frame):undefined;return{suggestions:newSuggestions,currentStateExpression:newStateExpression,currentStateError:validationErrors}},[currentDatasourceStates,currentVisualizationState,currentVisualizationId,activeDatasourceId,datasourceMap,visualizationMap]),suggestions=_useMemo.suggestions,currentStateExpression=_useMemo.currentStateExpression,currentStateError=_useMemo.currentStateError;const context=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({query:frame.query,timeRange:{from:frame.dateRange.fromDate,to:frame.dateRange.toDate},filters:frame.filters}),[frame.query,frame.dateRange.fromDate,frame.dateRange.toDate,frame.filters]);const AutoRefreshExpressionRenderer=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const autoRefreshFetch$=plugins.data.query.timefilter.timefilter.getAutoRefreshFetch$();return props=>external_kbnSharedDeps_React_default.a.createElement(ExpressionRendererComponent,suggestion_panel_extends({},props,{searchContext:context,reload$:autoRefreshFetch$}))},[plugins.data.query.timefilter.timefilter,context]);const _useState=Object(external_kbnSharedDeps_React_["useState"])(-1),_useState2=suggestion_panel_slicedToArray(_useState,2),lastSelectedSuggestion=_useState2[0],setLastSelectedSuggestion=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!stagedPreview&&lastSelectedSuggestion!==-1){setLastSelectedSuggestion(-1)}},[stagedPreview]);if(!activeDatasourceId){return null}if(suggestions.length===0){return null}function rollbackToCurrentVisualization(){if(lastSelectedSuggestion!==-1){trackSuggestionEvent("back_to_current");setLastSelectedSuggestion(-1);dispatch({type:"ROLLBACK_SUGGESTION"})}}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsSuggestionPanel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{className:"lnsSuggestionPanel__title",size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.editorFrame.suggestionPanelTitle",defaultMessage:"Suggestions"})))),stagedPreview&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.suggestion.refreshSuggestionTooltip",{defaultMessage:"Refresh the suggestions based on the selected visualization."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"lensSubmitSuggestion",size:"xs",iconType:"refresh",onClick:()=>{factory_trackUiEvent("suggestion_confirmed");dispatch({type:"SUBMIT_SUGGESTION"})}},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.sugegstion.refreshSuggestionLabel",{defaultMessage:"Refresh"}))))),external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsSuggestionPanel__suggestions"},currentVisualizationId&&external_kbnSharedDeps_React_default.a.createElement(SuggestionPreview,{preview:{error:currentStateError!=null,expression:currentStateExpression,icon:visualizationMap[currentVisualizationId].getDescription(currentVisualizationState).icon||"empty",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.suggestions.currentVisLabel",{defaultMessage:"Current"})},ExpressionRenderer:AutoRefreshExpressionRenderer,onSelect:rollbackToCurrentVisualization,selected:lastSelectedSuggestion===-1,showTitleAsLabel:true}),suggestions.map((suggestion,index)=>external_kbnSharedDeps_React_default.a.createElement(SuggestionPreview,{preview:{expression:suggestion.previewExpression,icon:suggestion.previewIcon,title:suggestion.title},ExpressionRenderer:AutoRefreshExpressionRenderer,key:index,onSelect:()=>{factory_trackUiEvent("suggestion_clicked");if(lastSelectedSuggestion===index){rollbackToCurrentVisualization()}else{setLastSelectedSuggestion(index);switchToSuggestion(dispatch,suggestion)}},selected:index===lastSelectedSuggestion}))))}function getPreviewExpression(visualizableState,visualization,datasources,frame){if(!visualization.toPreviewExpression){return null}const suggestionFrameApi=suggestion_panel_objectSpread(suggestion_panel_objectSpread({},frame),{},{datasourceLayers:suggestion_panel_objectSpread({},frame.datasourceLayers)});if(visualizableState.keptLayerIds&&visualizableState.datasourceId&&visualizableState.datasourceState){const datasource=datasources[visualizableState.datasourceId];const datasourceState=visualizableState.datasourceState;const updatedLayerApis=external_kbnSharedDeps_Lodash_default.a.pick(frame.datasourceLayers,visualizableState.keptLayerIds);const changedLayers=datasource.getLayers(visualizableState.datasourceState);changedLayers.forEach(layerId=>{if(updatedLayerApis[layerId]){updatedLayerApis[layerId]=datasource.getPublicAPI({layerId:layerId,state:datasourceState})}})}return visualization.toPreviewExpression(visualizableState.visualizationState,suggestionFrameApi.datasourceLayers)}function preparePreviewExpression(visualizableState,visualization,datasourceMap,datasourceStates,framePublicAPI){const suggestionDatasourceId=visualizableState.datasourceId;const suggestionDatasourceState=visualizableState.datasourceState;const expression=getPreviewExpression(visualizableState,visualization,datasourceMap,framePublicAPI);if(!expression){return}const expressionWithDatasource=prependDatasourceExpression(expression,datasourceMap,suggestionDatasourceId?suggestion_panel_objectSpread(suggestion_panel_objectSpread({},datasourceStates),{},{[suggestionDatasourceId]:{isLoading:false,state:suggestionDatasourceState}}):datasourceStates);return expressionWithDatasource}var visualizations_public_=__webpack_require__(27);var workspace_panel_wrapper=__webpack_require__(262);var chart_switch=__webpack_require__(271);function chart_switch_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function chart_switch_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){chart_switch_ownKeys(Object(source),true).forEach((function(key){chart_switch_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{chart_switch_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function chart_switch_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function chart_switch_slicedToArray(arr,i){return chart_switch_arrayWithHoles(arr)||chart_switch_iterableToArrayLimit(arr,i)||chart_switch_unsupportedIterableToArray(arr,i)||chart_switch_nonIterableRest()}function chart_switch_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function chart_switch_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return chart_switch_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return chart_switch_arrayLikeToArray(o,minLen)}function chart_switch_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function chart_switch_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function chart_switch_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function VisualizationSummary(props){const visualization=props.visualizationMap[props.visualizationId||""];if(!visualization){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.configPanel.selectVisualization",{defaultMessage:"Select a visualization"}))}const description=visualization.getDescription(props.visualizationState);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,description.icon&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"l",className:"lnsChartSwitch__summaryIcon",type:description.icon}),description.label)}function ChartSwitch(props){const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=chart_switch_slicedToArray(_useState,2),flyoutOpen=_useState2[0],setFlyoutOpen=_useState2[1];const commitSelection=selection=>{setFlyoutOpen(false);factory_trackUiEvent("chart_switch");switchToSuggestion(props.dispatch,chart_switch_objectSpread(chart_switch_objectSpread({},selection),{},{visualizationState:selection.getVisualizationState()}),"SWITCH_VISUALIZATION");if(!selection.datasourceId&&!selection.sameDatasources||selection.dataLoss==="everything"){props.framePublicAPI.removeLayers(Object.keys(props.framePublicAPI.datasourceLayers))}};function getSelection(visualizationId,subVisualizationId){const newVisualization=props.visualizationMap[visualizationId];const switchVisType=props.visualizationMap[visualizationId].switchVisualizationType||((_type,initialState)=>initialState);const layers=Object.entries(props.framePublicAPI.datasourceLayers);const containsData=layers.some(([_layerId,datasource])=>datasource.getTableSpec().length>0);if(props.visualizationId===visualizationId&&props.visualizationState&&newVisualization.getVisualizationTypeId(props.visualizationState)===subVisualizationId){return{visualizationId:visualizationId,subVisualizationId:subVisualizationId,dataLoss:"nothing",keptLayerIds:Object.keys(props.framePublicAPI.datasourceLayers),getVisualizationState:()=>switchVisType(subVisualizationId,props.visualizationState),sameDatasources:true}}const topSuggestion=getTopSuggestion(props,visualizationId,newVisualization,subVisualizationId);let dataLoss;if(!containsData){dataLoss="nothing"}else if(!topSuggestion){dataLoss="everything"}else if(layers.length>1&&layers.length!==topSuggestion.keptLayerIds.length){dataLoss="layers"}else if(topSuggestion.columns!==layers[0][1].getTableSpec().length){dataLoss="columns"}else{dataLoss="nothing"}return{visualizationId:visualizationId,subVisualizationId:subVisualizationId,dataLoss:dataLoss,getVisualizationState:topSuggestion?()=>switchVisType(subVisualizationId,newVisualization.initialize(props.framePublicAPI,topSuggestion.visualizationState)):()=>switchVisType(subVisualizationId,newVisualization.initialize(props.framePublicAPI,props.visualizationId===newVisualization.id?props.visualizationState:undefined,props.visualizationId&&props.visualizationMap[props.visualizationId].getMainPalette?props.visualizationMap[props.visualizationId].getMainPalette(props.visualizationState):undefined)),keptLayerIds:topSuggestion?topSuggestion.keptLayerIds:[],datasourceState:topSuggestion?topSuggestion.datasourceState:undefined,datasourceId:topSuggestion?topSuggestion.datasourceId:undefined,sameDatasources:dataLoss==="nothing"&&props.visualizationId===newVisualization.id}}const _useState3=Object(external_kbnSharedDeps_React_["useState"])(""),_useState4=chart_switch_slicedToArray(_useState3,2),searchTerm=_useState4[0],setSearchTerm=_useState4[1];const visualizationTypes=Object(external_kbnSharedDeps_React_["useMemo"])(()=>flyoutOpen&&Object(external_kbnSharedDeps_Lodash_["flatten"])(Object.values(props.visualizationMap).map(v=>v.visualizationTypes.map(t=>chart_switch_objectSpread(chart_switch_objectSpread({visualizationId:v.id},t),{},{icon:t.icon})))).filter(visualizationType=>visualizationType.label.toLowerCase().includes(searchTerm.toLowerCase())||visualizationType.fullLabel&&visualizationType.fullLabel.toLowerCase().includes(searchTerm.toLowerCase())).map(visualizationType=>chart_switch_objectSpread(chart_switch_objectSpread({},visualizationType),{},{selection:getSelection(visualizationType.visualizationId,visualizationType.id)})),[flyoutOpen,props.visualizationMap,props.framePublicAPI,props.visualizationId,props.visualizationState,searchTerm]);const popover=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"lnsChartSwitchPopover",ownFocus:true,initialFocus:".lnsChartSwitch__popoverPanel",panelClassName:"lnsChartSwitch__popoverPanel",panelPaddingSize:"s",button:external_kbnSharedDeps_React_default.a.createElement(ToolbarButton,{onClick:()=>setFlyoutOpen(!flyoutOpen),"data-test-subj":"lnsChartSwitchPopover",fontWeight:"bold"},external_kbnSharedDeps_React_default.a.createElement(VisualizationSummary,props)),isOpen:flyoutOpen,closePopover:()=>setFlyoutOpen(false),anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.configPanel.chartType",{defaultMessage:"Chart type"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldSearch"],{compressed:true,fullWidth:false,className:"lnsChartSwitch__search",value:searchTerm,"data-test-subj":"lnsChartSwitchSearch",onChange:e=>setSearchTerm(e.target.value)})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiKeyPadMenu"],null,(visualizationTypes||[]).map(v=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiKeyPadMenuItem"],{key:"".concat(v.visualizationId,":").concat(v.id),label:external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"visTypeTitle"},v.label),title:v.fullLabel,role:"menuitem","data-test-subj":"lnsChartSwitchPopover_".concat(v.id),onClick:()=>commitSelection(v.selection),betaBadgeLabel:v.selection.dataLoss!=="nothing"?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.chartSwitch.dataLossLabel",{defaultMessage:"Data loss"}):undefined,betaBadgeTooltipContent:v.selection.dataLoss!=="nothing"?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.chartSwitch.dataLossDescription",{defaultMessage:"Switching to this chart will lose some of the configuration"}):undefined,betaBadgeIconType:v.selection.dataLoss!=="nothing"?"alert":undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{className:"lnsChartSwitch__chartIcon",type:v.icon||"empty",size:"l"})))),searchTerm&&(visualizationTypes||[]).length===0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelectableMessage"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.chartSwitch.noResults",defaultMessage:"No results found for {term}.",values:{term:external_kbnSharedDeps_React_default.a.createElement("strong",null,searchTerm)}})));return external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsChartSwitch__header"},popover)}function getTopSuggestion(props,visualizationId,newVisualization,subVisualizationId){const mainPalette=props.visualizationId&&props.visualizationMap[props.visualizationId]&&props.visualizationMap[props.visualizationId].getMainPalette?props.visualizationMap[props.visualizationId].getMainPalette(props.visualizationState):undefined;const unfilteredSuggestions=suggestion_helpers_getSuggestions({datasourceMap:props.datasourceMap,datasourceStates:props.datasourceStates,visualizationMap:{[visualizationId]:newVisualization},activeVisualizationId:props.visualizationId,visualizationState:props.visualizationState,subVisualizationId:subVisualizationId,activeData:props.framePublicAPI.activeData,mainPalette:mainPalette});const suggestions=unfilteredSuggestions.filter(suggestion=>suggestion.changeType!=="extended"&&newVisualization.getVisualizationTypeId(suggestion.visualizationState)===subVisualizationId);return suggestions.find(s=>s.changeType==="unchanged")||suggestions.find(s=>s.changeType==="reduced")||suggestions[0]}function WorkspacePanelWrapper({children:children,framePublicAPI:framePublicAPI,visualizationState:visualizationState,dispatch:dispatch,title:title,visualizationId:visualizationId,visualizationMap:visualizationMap,datasourceMap:datasourceMap,datasourceStates:datasourceStates}){const activeVisualization=visualizationId?visualizationMap[visualizationId]:null;const setVisualizationState=Object(external_kbnSharedDeps_React_["useCallback"])(newState=>{if(!activeVisualization){return}dispatch({type:"UPDATE_VISUALIZATION_STATE",visualizationId:activeVisualization.id,newState:newState,clearStagedPreview:false})},[dispatch,activeVisualization]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",direction:"row",responsive:false,wrap:true,className:"lnsWorkspacePanelWrapper__toolbar"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ChartSwitch,{"data-test-subj":"lnsChartSwitcher",visualizationMap:visualizationMap,visualizationId:visualizationId,visualizationState:visualizationState,datasourceMap:datasourceMap,datasourceStates:datasourceStates,dispatch:dispatch,framePublicAPI:framePublicAPI})),activeVisualization&&activeVisualization.renderToolbar&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(NativeRenderer,{render:activeVisualization.renderToolbar,nativeProps:{frame:framePublicAPI,state:visualizationState,setState:setVisualizationState}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],{className:"lnsWorkspacePanelWrapper"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiScreenReaderOnly"],null,external_kbnSharedDeps_React_default.a.createElement("h1",{"data-test-subj":"lns_ChartTitle"},title||external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.chartTitle.unsaved",{defaultMessage:"Unsaved"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentBody"],{className:"lnsWorkspacePanelWrapper__pageContentBody"},children)))}function drop_illustration_extends(){drop_illustration_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return drop_illustration_extends.apply(this,arguments)}function drop_illustration_objectWithoutProperties(source,excluded){if(source==null)return{};var target=drop_illustration_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function drop_illustration_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const DropIllustration=_ref=>{let title=_ref.title,titleId=_ref.titleId,props=drop_illustration_objectWithoutProperties(_ref,["title","titleId"]);return external_kbnSharedDeps_React_["createElement"]("svg",drop_illustration_extends({width:176,height:176,viewBox:"0 0 176 176",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":titleId},props),title?external_kbnSharedDeps_React_["createElement"]("title",{id:titleId},title):null,external_kbnSharedDeps_React_["createElement"]("path",{d:"M122.155 89.485H12.389v40.796h109.766V89.485z",fill:"#58C5A7"}),external_kbnSharedDeps_React_["createElement"]("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.471 91.253c.358-.28.786-.454 1.236-.503A1.664 1.664 0 0122 92.647a1.842 1.842 0 01-1.801 1.375 1.65 1.65 0 01-1.513-1.69c.156-.426.428-.8.785-1.08zm-6.188 3.1c.137 0 .618-.07.646-.275.027-.207-.358-.482-.509-.496a.482.482 0 00-.495.317c-.041.22.206.412.357.454zm-.908 5.197v1.952c.097.108.22.188.357.234a1.156 1.156 0 001.376-1.086c.096-.536-.372-1.018-1.142-1.141-.197-.03-.4-.016-.591.041zm34.375 9.213a.797.797 0 00-.921.371c-.385.619-.33.921.275 1.54-.041.549-.041 1.101 0 1.65a.548.548 0 00.376.522.557.557 0 00.614-.192c.076-.103.16-.203.245-.304.314-.373.64-.759.607-1.332l-.591-.605c.041-.798-.192-1.527-.605-1.65zm-33.096 5.211a.727.727 0 00-.646-.88 2.289 2.289 0 00-.62 0v2.131h.152a.715.715 0 00-.165.275v.468a.44.44 0 00.316.343c.385.097.578-.44.591-.618.014-.179 0-.564-.357-.605h-.055c.395-.257.676-.656.784-1.114zm.261 1.952c-.165-.041-.165-.206-.165-.33a.348.348 0 01.22-.124c.082.042.289.193.192.262a.263.263 0 00-.074.097c-.035.063-.067.122-.173.095zm-1.54 2.613v.632a1.71 1.71 0 001.169.853 1.062 1.062 0 001.107-.45c.078-.118.132-.25.158-.389a1.376 1.376 0 00-1.059-1.568 1.536 1.536 0 00-1.375.922zm1.293 4.304a1.38 1.38 0 001.457-.894 1.513 1.513 0 00-1.182-1.595c-.427 0-.95.522-1.045 1.169a1.112 1.112 0 00.77 1.32zm11.809-1.457c.158.123.29.277.387.453.962.247 1.553.948 1.347 1.705a1.966 1.966 0 01-1.925 1.471 1.898 1.898 0 01-1.375-1.746 1.225 1.225 0 01-.234-.894c.11-.66.784-1.334 1.265-1.251.195.05.377.139.535.262zm4.91.989a1.376 1.376 0 00-1.265.701 1.16 1.16 0 00-.357.151c.038.136.066.274.082.413a2.842 2.842 0 00-.082.33 1.155 1.155 0 001.072 1.375 1.374 1.374 0 001.664-1.375 1.472 1.472 0 00-1.113-1.595zm-4.262 7.164a1.004 1.004 0 00.523.632c.343.124.838-.371.756-.756-.06-.28-.186-.378-.281-.453a.473.473 0 01-.09-.083c-.633-.028-1.032.371-.908.66zm4.386-1.059c.232.136.433.319.591.536.174-.022.349-.026.523-.014a1.01 1.01 0 01.839.935.806.806 0 01-.096.33h-4.126a1.378 1.378 0 01.124-.605c.454-1.045 1.375-1.54 2.145-1.182zm-5.514.536a.904.904 0 00.908-.838c0-.468-.289-.674-.729-.715a.83.83 0 00-.864.43.828.828 0 00-.098.326.75.75 0 00.216.572.753.753 0 00.568.225zm11.688.344c.041-.853.44-1.251 1.127-1.251.757.055 1.458.646 1.43 1.21 0 .288-.453.701-.92.948h-1.156a1.202 1.202 0 01-.481-.907zm14.286-7.205c.124-.22.097-.385-.137-.495-.234-.11-.372-.082-.495.138a.314.314 0 00.01.396c.03.037.07.065.114.085a.316.316 0 00.509-.124zM13.2 130.267h-.825v-6.985c.072-.015.154-.046.245-.08h.001v-.001c.394-.148.945-.355 1.514.37.333.425-.1.878-.317 1.105a1.2 1.2 0 00-.095.105.78.78 0 01.646-.151.74.74 0 01.674.866v.151a1.87 1.87 0 012.447 0 1.702 1.702 0 01-.11-.907.851.851 0 01.839-.784c.742-.055 1.595.701 1.375 1.155-.18.42-.488.771-.88 1.004h.192a.866.866 0 01.77.839 1.55 1.55 0 01-.33 1.003c.66-.151 1.471.702 1.279 1.637-.047.232-.14.452-.275.646h-3.3c-.137-.206-.275-1.664.151-1.898.326-.178.716.077.943.226.07.045.125.081.157.091.113.033.18-.043.283-.163.023-.026.047-.055.075-.085h-.138a2.187 2.187 0 01-.976-.852c-.27.371-.675.622-1.128.701a2.637 2.637 0 01-.632.261 1.628 1.628 0 01-.371-.399 1.841 1.841 0 01-.825-1.636c.02-.123.057-.244.11-.357a.765.765 0 01-.234.123c.12.29-.057.572-.2.8-.055.086-.104.164-.13.232-.045.116.03.18.153.285.14.12.34.291.493.65.289.673-.632 1.595-1.609 1.375h-.096c.098.21.14.442.124.673zm4.895-4.056h-.082a.58.58 0 01-.317-.192c.052.109.089.225.11.343.092-.058.189-.109.289-.151zm22.358-1.87c-.633-.068-1.018.317-1.114 1.073a.179.179 0 00-.083.069 1.374 1.374 0 00.316 1.375 1.23 1.23 0 001.306-.385.782.782 0 00.62-.605 1.843 1.843 0 00-1.045-1.527zm-19.345 1.893a.813.813 0 01-.208-.573.906.906 0 01.963-.77.827.827 0 01.715.977.736.736 0 01-.318.525.75.75 0 01-.604.107.813.813 0 01-.548-.266zm28.575-6.065a1.195 1.195 0 01-.073-.709 1.374 1.374 0 011.32-.426.962.962 0 01.426 1.169.885.885 0 01-.49.525.877.877 0 01-.72-.017 1.192 1.192 0 01-.463-.542zm-32.358-1.919a.55.55 0 00-.605.66c0 .275.151 1.004.536.976.385-.027.756-.646.798-.921.041-.275-.275-.715-.729-.715zm5.795 8.839c.213.248.34.557.365.882-.041.481-.564.812-1.306.812h-.33a1.09 1.09 0 01-.756-1.018c.04-.55.742-1.169 1.21-1.169.318.073.604.246.817.493zm-.937 1.694h-.004.041H22.183zm0 0c-.675.012-1.338.366-1.338.866-.007.206.04.409.138.591h2.392a.734.734 0 000-.165c0-.837-.315-1.222-1.192-1.292zm-2.15-12.114c0 .605.317 1.003.674.907a1.05 1.05 0 00.633-.522c.124-.344-.371-.839-.756-.757-.272.059-.373.179-.452.273a.502.502 0 01-.098.099zm5.34 9.231c.028.082.037.17.023.256-.027.454-.44.756-.715.715-.275-.041-.88-.412-.907-.797-.028-.385.701-.523.976-.523a.535.535 0 01.623.349zm2.127 4.312h.481a.62.62 0 00-.481 0zm-4.648-6.366c.138.083.33.33.234.536-.082.193-.398.22-.55.179-.151-.041-.454-.412-.371-.605.082-.192.55-.192.688-.11zm25.617 6.422l.192-.33a2.2 2.2 0 00.454-.097.856.856 0 00-.083.413h2.984a1.2 1.2 0 00-.445-1.285 1.207 1.207 0 00-.435-.2 1.943 1.943 0 00-1.059 0 .8.8 0 00-.563-.536c-.688-.22-.963-.083-1.375.646-.543.098-1.08.226-1.609.385a.582.582 0 00-.34.318.59.59 0 00-.004.466 2.012 2.012 0 00-1.1.275l3.383-.055zm7.38-16.424a.77.77 0 01-.01-.393c.811-.426 1.1-.426 1.292-.041a.783.783 0 01-.343.963.77.77 0 01-.94-.529zm-3.795 1.45a.885.885 0 01.334.206c.508.316.536.646.412.853-.124.206.316.261.481.123.165-.137.592-.316.99.262.399.577-.233 1.058-.66 1.292-.426.234-.728.33-1.072 0-.16-.154-.321-.182-.505-.215-.21-.037-.452-.079-.76-.321a1.376 1.376 0 01-.261-1.843.9.9 0 01.651-.401.875.875 0 01.39.044zm-17.074 1.155c0-.165-.22-.427-.357-.44-.138-.014-.537 0-.55.412-.013.378.31.398.49.41l.046.003c.165.013.385-.262.371-.385zm4.318 2.447c-.798-.275-1.032-.756-.798-1.375.248-.284.59-.47.962-.522a.756.756 0 01-.618-.605 1.032 1.032 0 01.88-.99.353.353 0 01.268.109.342.342 0 01.09.276c.002.092.012.196.022.302.031.34.065.71-.091.825a.766.766 0 01.316 0c.343.165.522.633.343 1.169-.288.811-.577 1.086-1.374.811zm15.014-7.755c0-.044.009-.093.018-.144.026-.155.055-.326-.141-.419a.303.303 0 00-.44.165c-.069.165-.179.577 0 .687.178.11.55-.192.563-.289zm-5.898 14.011c.07.029.132.077.178.138a1.1 1.1 0 01.798-.124c.536.138.962 1.238.536 1.513a.933.933 0 01-.715 0 .77.77 0 010 .275c-.178.509-.756.66-1.457.371a.955.955 0 01-.206-.11c.027.082-.042.536-.386.468-.343-.069-.343-.427-.343-.592a.315.315 0 01.22-.302.908.908 0 010-.88 1.116 1.116 0 011.375-.757zm-3.685 4.098c.082-.344-.426-.962-.853-1.059a.674.674 0 00-.524.136.668.668 0 00-.246.483c-.096.701 0 1.196.399 1.279a1.38 1.38 0 001.224-.839zm13.166-11.052a.757.757 0 01-.31-.031.849.849 0 01-.481-1.127.685.685 0 01.595-.549.688.688 0 01.285.026.897.897 0 01.577 1.1.767.767 0 01-.666.581zm-22.806 4.809a1.372 1.372 0 01-.81.014 1.168 1.168 0 01-.413-1.499.661.661 0 01.633-.467c.27-.143.576-.201.88-.165.426.082.632.303.632.77-.03.264-.119.518-.261.742v.138c-.169.219-.4.381-.661.467zm-5.169-11.852c.22 0 .412-.206.454-.357.041-.152-.083-.619-.289-.647-.206-.027-.481.358-.481.509 0 .151.096.468.316.495zm.591 2.805c-.096.412-1.058.66-1.375.412-.261-.247-.261-1.402.578-1.416a.932.932 0 01.289 0c.068-.165.26-.412.426-.412a.448.448 0 01.289.398 1.103 1.103 0 01-.207.427 1.22 1.22 0 010 .591zm22.44 7.04c-.027-1.224.426-2.516 2.214-2.228.342.056.672-.045.99-.142.386-.118.753-.231 1.1-.05a2.116 2.116 0 01.949 1.774 2.6 2.6 0 01-1.746 2.598 1.111 1.111 0 01-.867 0c-.19.191-.402.357-.632.495a.987.987 0 01-.564-.756 1.69 1.69 0 01-1.031-.577A1.899 1.899 0 0152.95 121zm-31.061-3.383c0 .495.619.674.907.743.29.069.564-.289.592-.646.027-.358-.275-.825-.633-.729-.048.013-.1.025-.155.038-.344.081-.758.178-.711.594zm-1.733-10.546c.07-.371 1.403-1.059 1.61-.783.233.275.467 1.154-.235 1.347-.7.192-1.443-.192-1.375-.564zm6.958 19.127a1.25 1.25 0 00.77 1.746 1.182 1.182 0 001.526-.536 1.775 1.775 0 00-.949-1.994 1.254 1.254 0 00-1.347.784zm.99-3.658c.027 0 .124.22.124.22-.041.069-.193.289-.261.192-.024-.032-.055-.055-.085-.078-.059-.043-.112-.083-.094-.183.027-.151.288-.151.316-.151zM33 127.077a1.38 1.38 0 00-1.375.674c-.124.317.289 1.004.701 1.155a.6.6 0 00.702-.22 1.512 1.512 0 00.948.757.829.829 0 00.922-.784c.08.046.162.088.247.124a1.148 1.148 0 00.939.009 1.13 1.13 0 00.628-.697 1.372 1.372 0 00-.32-1.666 1.375 1.375 0 00-.532-.287 1.488 1.488 0 00-1.856.661 1.195 1.195 0 00.11 1.045 1.448 1.448 0 00-.866.33c.068-.605-.014-1.004-.248-1.101zm-9.996-16.747c.069.124.22.467.069.591a.533.533 0 01-.592.055c-.179-.069-.344-.467-.179-.646a.634.634 0 01.702 0zm-8.195 2.984h-.275a.809.809 0 00-.44.866c-.006.256.071.507.22.715.239-.06.483-.102.729-.124a.695.695 0 00-.262.523 1.732 1.732 0 001.375 1.622 1.276 1.276 0 001.045-1.182 1.089 1.089 0 00-1.114-1.279 1.74 1.74 0 00-.538-.002c.02-.005.06-.026.071-.108.044-.228-.208-.45-.454-.666-.14-.124-.277-.245-.357-.365zm1.99-6.431c.043.175.044.357.003.532a.897.897 0 01-1.03.585.897.897 0 01-.386-.186 1.04 1.04 0 01-.222-.83 1.036 1.036 0 01.484-.71.99.99 0 01.907.137c.117.136.2.298.244.472zm.884 16.619c.49.176.881.032 1.14-.063.145-.053.248-.091.303-.047.022.018.052.048.089.085.22.218.688.681 1.135.328a1.074 1.074 0 00.426-1.375 1.06 1.06 0 00.949-.743 1.76 1.76 0 000-.66c.162-.105.31-.229.44-.371a1.376 1.376 0 00-.165-2.117 1.538 1.538 0 00-2.255.371c-.394.54-.25.955-.133 1.295.104.3.187.541-.142.754-.316.205-.51.146-.712.085-.247-.075-.508-.154-1.02.231-.936.701-.84 1.939-.055 2.227zm.893-9.377c.206-.096.537.124.537.289.055.178-.014.536-.22.563a.637.637 0 01-.578-.343.441.441 0 01.261-.509zm2.186 1.581a.605.605 0 00.66.715 1.062 1.062 0 00.757-.412c.11-.206-.179-.99-.564-1.031a.796.796 0 00-.852.728zm11.804 8.348c.05-.002.1.007.145.026.087.019.184.035.283.052.343.058.715.121.79.292a.77.77 0 01-.798 1.003 1.043 1.043 0 01-.728-1.1.33.33 0 01.308-.273zm37.311-5.226c-.77-.11-1.636.412-1.677 1.003-.041.592.564 1.114 1.182 1.169a1.208 1.208 0 001.21-1.114c.07-.618-.178-.99-.715-1.058zm-1.503 4.809c.014-.231.082-.456.197-.657a1.38 1.38 0 01.704-.862 1.368 1.368 0 011.111-.059 2.063 2.063 0 011.238 2.103 1.691 1.691 0 01-2.131 1.032 1.521 1.521 0 01-1.006-.88 1.516 1.516 0 01-.113-.677zm4.075-14.325a1.376 1.376 0 00-1.636.413c-.248.481.15 1.182.866 1.526a1.004 1.004 0 001.182-.44 1.209 1.209 0 00-.412-1.499zm-12.26 19.874a1.61 1.61 0 01-.789-.899 1.555 1.555 0 011.251-1.581c.88-.014 1.843.371 1.843 1.004a1.57 1.57 0 01-1.114 1.581 1.613 1.613 0 01-1.19-.105zm6.54-4.707a1.868 1.868 0 00-2.132.866 1.567 1.567 0 00.702 2.062 2.48 2.48 0 002.406-.907 1.608 1.608 0 00-.976-2.021zm-3.819-8.983a1.583 1.583 0 011.11-.092 1.539 1.539 0 01.605 1.884 1.58 1.58 0 01-1.815.385 1.086 1.086 0 01-.674-1.375c.152-.353.427-.637.774-.802zm6.362-1.77c-.577-.275-1.058 0-1.375.743a1.375 1.375 0 00.358 1.526 1.51 1.51 0 001.76-.646 1.375 1.375 0 00-.743-1.623zm-10.725 16.033c.22-.344.674-.344 1.197 0 .149.114.31.211.481.288.17.052.332.126.481.22h-2.269a.633.633 0 01.11-.508zm13.503-2.558a1.183 1.183 0 002.2.674 1.457 1.457 0 00-.578-1.774c-.398-.151-1.443.537-1.622 1.1zm-58.74-17.545a.88.88 0 01.261 0 1.623 1.623 0 011.1 1.581 1.225 1.225 0 01-1.375.784 1.651 1.651 0 01-.921-.357v-1.375c.034-.04.066-.082.097-.123.044-.059.088-.117.137-.166H12.375v-5.115a1.113 1.113 0 011.114 1.54 1.279 1.279 0 000 .715 2.75 2.75 0 01.178 1.87 1.47 1.47 0 01-.357.646zm-.935-4.771v-.66a.55.55 0 010 .66zm1.705-.22a.893.893 0 00.674 1.031.909.909 0 001.017-.701 1.03 1.03 0 00-.756-1.114.883.883 0 00-.935.784zm60.76 13.21c.166.323.21.695.125 1.049a1.508 1.508 0 01-.773.947 1.508 1.508 0 01-1.221.057 1.174 1.174 0 01-.876-1.048c-.012-.163.01-.326.065-.479a1.663 1.663 0 011.898-1.237c.337.135.615.387.781.711zm-10.394 3.551c-.09.552.336.793.785 1.046l.095.054.165-.114c.398-.272.797-.544.591-1.123a.347.347 0 00-.082-.151 2.024 2.024 0 001.155-1.073.853.853 0 00-.605-1.045 1.213 1.213 0 00-.955-.053 1.218 1.218 0 00-.695.658 1.375 1.375 0 00.11 1.183.835.835 0 00-.564.618zm22.15.271c.038.097.049.204.029.307 0 .206-.426.137-.605.082a.549.549 0 01-.316-.522c.055-.206.564-.193.701-.11a.547.547 0 01.19.243zm1.968 5.669a1.195 1.195 0 00-1.375.77c-.22.592-.083 1.004.426 1.21a1.472 1.472 0 001.76-.563 1.377 1.377 0 00-.811-1.417zm-4.895-8.772c.398.069.412.509.288.825-.082.316-.398.564-1.003.316a2.784 2.784 0 00-.06-.228c-.062-.221-.137-.486-.078-.624.083-.193.454-.358.853-.289zm6.325 3.781a.466.466 0 00-.234-.591.5.5 0 00-.426-.027.513.513 0 00-.322.524.509.509 0 00.418.452.527.527 0 00.564-.358zm2.224-2.268a.685.685 0 01.292-.015c.069.014.247.275.151.427l-.038.064c-.103.175-.273.466-.54.321-.237-.13-.177-.396-.14-.557v-.001a.562.562 0 00.017-.102.671.671 0 01.258-.137zm-31.086-.482a.76.76 0 00.423-.446.77.77 0 00-.038-.613c-.123-.247-.48-.563-.728-.55-.619 0-.839.523-.908 1.128l.007.006c.328.301.712.653 1.245.475zm15.712 6.117c-.285-.221-.688-.535-.518-.933.168-.432.608-.341 1.019-.256l.177.036c.454.082.55.481.372.88-.179.398-.647.618-.894.398a3.96 3.96 0 00-.156-.125zm-18.049-18.217c-.22.674.564 1.073.949.921a.809.809 0 00.343-.962.742.742 0 00-1.292.041zm3.892 1.969c.25-.043.506 0 .728.121a1.378 1.378 0 01.66 1.306c-.069.619-.316.88-.963.88h-1.044v.564a1.565 1.565 0 01-.949 1.482 1.574 1.574 0 01-.605.127.975.975 0 01-.715-.248 2.022 2.022 0 01-.591-1.87 1.76 1.76 0 011.553-1.127h.564c.204-.32.444-.615.715-.88.17-.188.398-.313.647-.355zm19.14 10.131c-.798-.481-1.21-.385-1.65.44-.334.624-.556 1.012-.794 1.426l-.238.417c-1.182-.55-1.375-.482-1.554.604.44.509.908.454 1.375 0 1.279.963 2.104.523 2.324-1.168.103-.047.209-.089.316-.124.468-.069.605-.399.647-.811a.85.85 0 00-.427-.784zm-2.198 9.221c.004-.179.045-.355.121-.517.399-.963 1.196-1.444 1.911-1.155a1.757 1.757 0 01.963 1.883 1.733 1.733 0 01-2.145 1.032 1.3 1.3 0 01-.751-.72 1.294 1.294 0 01-.099-.523zm-1.68-15.312a1.084 1.084 0 00-.811.233c-.427.523-.152.99.357 1.472.084-.03.17-.055.253-.081.427-.128.824-.248.847-.799a.757.757 0 00-.646-.825zM28.6 116.641c-.179-.014-.715-.206-.619-.591.11-.371.619-.371.798-.33a.55.55 0 01.426.564c-.041.357-.426.371-.605.357zm11.866-3.891a.82.82 0 00-.632.454.55.55 0 00.495.729c.233 0 .866-.083.907-.606.042-.522-.563-.577-.77-.577zm-3.011 9.57c-.082-.234-.014-.715.151-.811.383-.15.704-.427.908-.784.041-.096.247-.179.357-.179.413.124.468.564.413.715a11.73 11.73 0 01-.192.481 1.228 1.228 0 01.66 1.004c-.015.33-.716.756-1.128.756a.918.918 0 01-.688-.715 1.055 1.055 0 01-.481-.467zm3.699-3.52a.647.647 0 00.481.852.196.196 0 00.096 0 1.6 1.6 0 00.784.495 1.207 1.207 0 001.306-.618 2.025 2.025 0 00-.701-1.884 1.376 1.376 0 00-1.279.619.618.618 0 00-.687.536zM15.252 96.463a.963.963 0 01.67-.213.949.949 0 01.84 1.017.894.894 0 01-.936.784 1.059 1.059 0 01-.921-.976.963.963 0 01.347-.612zm21.53 21.333a1.226 1.226 0 00-1.307.66.866.866 0 00.591 1.059.975.975 0 001.169-.426c.151-.399-.11-1.197-.454-1.293zm-1.238 6.683c.206-.083.687-.138.825 0 .272.314.638.531 1.045.619.083.01.15.122.207.217.02.032.037.061.054.085-.027.413-.192.578-.578.578a7.28 7.28 0 01-1.375-.234c-.206-.069-.522-.316-.522-.495.01-.292.133-.569.344-.77zm9.061-10.354a1.016 1.016 0 00-1.114.577c-.261.839-.096 1.513.426 1.678a1.182 1.182 0 10.688-2.255zm1.99 2.892c.142-.042.285-.085.416-.142a1.378 1.378 0 011.252.303 1.124 1.124 0 01.44 1.072 1.376 1.376 0 01-.936 1.059 1.84 1.84 0 01-1.54-.344c-.219-.179-.272-.366-.321-.539-.019-.065-.037-.129-.063-.19a.839.839 0 010-.756c.106-.27.422-.364.753-.463zm-4.809-1.256a.441.441 0 00.413.371.626.626 0 00.495-.467c0-.206-.303-.358-.509-.358-.206 0-.44.193-.399.454zm2.136 5.613a1.525 1.525 0 01.174-1.075 1.99 1.99 0 012.407-.592 1.667 1.667 0 01.247 2.324 1.373 1.373 0 01-2.241.261 1.525 1.525 0 01-.587-.918zm-7.828-6.534a.65.65 0 00-.547.016.655.655 0 00-.347.424.605.605 0 00.33.839.643.643 0 00.777-.031.645.645 0 00.172-.217.754.754 0 00-.385-1.031zm6.448-3.121c.097-.248.344-.248.523-.248.096 0 .509.206.358.481-.126.229-.385.211-.564.198a1.22 1.22 0 00-.096-.005.325.325 0 01-.208-.163.316.316 0 01-.013-.263zm-1.003-2.585c-.248.509 0 1.265.426 1.375.426.11 1.375-1.004 1.169-1.485-.206-.481-1.348-.399-1.595.11zm-23.224-4.125a.633.633 0 00.577.343c.207 0 .276-.385.22-.563-.054-.179-.33-.385-.536-.289a.442.442 0 00-.261.509zm-2.14-4.767a.815.815 0 01.614-.046c.572.149.582.574.593 1.037.003.094.005.189.012.283-.839.385-1.238.426-1.513 0a1.046 1.046 0 01-.11-.811.815.815 0 01.405-.463zm1.205 11.326c0 .398.124.715.495.797a4.88 4.88 0 002.874-.082c.137-.073.262-.165.371-.275a1.091 1.091 0 00.297-1.148 1.081 1.081 0 00-.93-.736h-.11c.092-.127.153-.273.18-.426a.798.798 0 00-.784-.908.752.752 0 00-.798.366.751.751 0 00-.096.294c-.004.202.034.404.11.591h-.317a1.707 1.707 0 00-1.292 1.527zm4.473-11.346a1.47 1.47 0 011-.342c.742.028 1.512 1.155 1.36 2.062a1.248 1.248 0 01-.992 1.036c-.167.033-.34.031-.506-.004a1.575 1.575 0 01-1.079-.62 1.588 1.588 0 01-.296-1.209c.05-.361.234-.69.513-.923zm2.608 8.829c.138.358 1.375.537 1.54 0a.837.837 0 00-.357-1.058c-.481-.138-1.32.701-1.183 1.058zm2.187 8.451c.176-.041.359-.044.536-.008.563.041 1.155.632 1.1 1.168a1.758 1.758 0 01-1.691 1.375c-.51 0-.908-.687-.908-1.375a1.253 1.253 0 01.963-1.16zm22.398-2.937a.88.88 0 00-1.072.413.736.736 0 00-.054.602.744.744 0 00.411.443.88.88 0 001.073-.413.724.724 0 00-.1-.87.73.73 0 00-.258-.175zM25.878 97.611c-.083-.151-.083-.756.165-.839a.77.77 0 01.7.358.689.689 0 01-.22.632.673.673 0 01-.645-.15zm-2.063 16.156c-.413 0-.921.482-1.045 1.265.033.034.07.081.112.133.113.143.257.326.438.376a.67.67 0 00.289 0c.165.096.398 0 .577-.206a.837.837 0 00.385-.495 1.06 1.06 0 00-.756-1.073zm6.29 6.069c.127-.249.333-.449.585-.569.32-.143.65-.258.99-.343a1.634 1.634 0 01.468 2.268c-.184.267-.466.45-.784.509a1.371 1.371 0 01-1.375-1.059 1.262 1.262 0 01.116-.806z",fill:"#54B399"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M135.905 24.86H26.139v40.796h109.766V24.86z",fill:"#58C5A7"}),external_kbnSharedDeps_React_["createElement"]("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M33.218 26.624c.358-.28.788-.453 1.24-.499a1.664 1.664 0 011.292 1.898 1.842 1.842 0 01-1.801 1.375 1.65 1.65 0 01-1.513-1.692c.154-.427.425-.802.782-1.082zm-6.186 3.104c.138 0 .62-.07.647-.276.027-.206-.358-.48-.509-.495a.482.482 0 00-.495.317c-.041.22.206.412.357.453zm-.907 5.197v1.953c.097.107.22.188.358.233a1.153 1.153 0 001.375-1.086c.11-.536-.372-1.017-1.142-1.141-.198-.03-.4-.016-.591.041zM60.5 44.138a.798.798 0 00-.921.37c-.385.62-.33.922.275 1.54-.04.55-.04 1.102 0 1.65a.55.55 0 00.99.33c.076-.102.16-.202.245-.303.314-.373.64-.759.607-1.333l-.591-.605c.041-.797-.192-1.526-.605-1.65zm-33.096 4.905c.022.1.022.205 0 .306a1.87 1.87 0 01-.798 1.114h.069c.357.04.371.426.357.605-.013.178-.206.715-.59.618a.44.44 0 01-.317-.357v-.454a.715.715 0 01.165-.275h-.151v-2.131c.205-.028.413-.028.619 0a.727.727 0 01.646.574zm.096 1.928c0 .124 0 .289.165.33.106.027.138-.032.173-.095.02-.036.04-.073.075-.097.096-.069-.11-.22-.193-.262a.344.344 0 00-.22.124zm-1.375 3.575v-.632a1.54 1.54 0 011.375-.922 1.374 1.374 0 011.059 1.568 1.06 1.06 0 01-1.265.839 1.72 1.72 0 01-1.169-.853zm2.177 3.479c-.265.162-.576.23-.884.193a1.113 1.113 0 01-.77-1.32c.096-.647.618-1.17 1.044-1.17a1.513 1.513 0 011.183 1.596 1.375 1.375 0 01-.573.7zm11.312-.811a1.373 1.373 0 00-.921-.715c-.482-.083-1.155.591-1.265 1.251-.042.317.042.638.233.894a1.898 1.898 0 001.375 1.746 1.967 1.967 0 001.925-1.471c.206-.756-.385-1.458-1.347-1.705zm3.791.707c.224-.124.477-.183.733-.171a1.47 1.47 0 011.113 1.595 1.374 1.374 0 01-1.663 1.375 1.155 1.155 0 01-1.073-1.375c.021-.112.048-.222.082-.33a2.746 2.746 0 00-.082-.413c.11-.07.23-.121.358-.15.124-.224.309-.407.532-.531zm-3.336 7.365a1.002 1.002 0 01-.194-.372c-.124-.289.275-.688.907-.66.023.03.055.055.09.083.096.075.222.173.282.453.082.385-.413.88-.757.756a1.004 1.004 0 01-.328-.26zm4.783-.895c-.158-.217-.36-.4-.59-.536-.77-.357-1.692.138-2.146 1.182-.086.19-.129.397-.123.605h4.124a.812.812 0 00.097-.33 1.004 1.004 0 00-.839-.934 2.615 2.615 0 00-.523.013zm-5.486-.24a.908.908 0 01-.618.24.758.758 0 01-.784-.797.838.838 0 01.962-.757c.44.042.729.248.729.715a.908.908 0 01-.289.598zm12.197-.667c-.688 0-1.087.398-1.128 1.251a1.21 1.21 0 00.481.907h1.155c.468-.247.922-.66.922-.948.027-.564-.674-1.155-1.43-1.21zm13.02-6.449c.234.11.262.275.138.495a.316.316 0 01-.508.124.316.316 0 01-.124-.482c.124-.22.261-.247.495-.137zm-38.458 8.608h.811a1.376 1.376 0 00-.123-.674h.096c.976.22 1.897-.701 1.608-1.375a1.635 1.635 0 00-.493-.65c-.122-.105-.198-.17-.153-.285.027-.068.076-.146.13-.232.143-.228.32-.51.2-.8a.77.77 0 00.234-.123c-.053.113-.09.234-.11.357a1.841 1.841 0 00.825 1.637c.1.152.226.287.371.398.221-.06.434-.147.633-.261.452-.079.856-.33 1.127-.701.232.376.572.673.977.852h.137l-.075.085c-.103.12-.17.196-.282.163-.033-.01-.087-.046-.157-.091-.228-.149-.618-.404-.944-.225-.426.233-.288 1.69-.15 1.897h3.3c.134-.194.228-.414.274-.646.193-.935-.618-1.788-1.278-1.636.223-.286.34-.641.33-1.004a.852.852 0 00-.77-.839.91.91 0 00-.193 0c.393-.232.7-.584.88-1.004.22-.453-.633-1.21-1.375-1.155a.853.853 0 00-.839.784c-.046.307-.008.62.11.907a1.65 1.65 0 00-1.045-.467 1.677 1.677 0 00-1.375.426v-.151a.77.77 0 00-.674-.88.84.84 0 00-.646.165 1.54 1.54 0 01.085-.09c.219-.22.68-.685.328-1.12-.57-.725-1.12-.518-1.514-.37h-.001c-.09.035-.173.066-.245.081l-.014 7.026zm5.624-4.126h.096c-.03.013-.06.026-.088.04l-.008-.04zm-.303-.192a.577.577 0 00.28.247 1.9 1.9 0 00-.17.097 1.005 1.005 0 00-.11-.344zm21.643-.536c.096-.757.481-1.073 1.114-1.073a1.842 1.842 0 011.044 1.526.783.783 0 01-.618.605 1.224 1.224 0 01-1.306.386 1.375 1.375 0 01-.317-1.444.18.18 0 01.083 0zm-18.439.247a.812.812 0 00.756.839.742.742 0 00.922-.633.853.853 0 00-.716-.99.935.935 0 00-.962.784zm28.71-6.201a1.197 1.197 0 00.536 1.251.88.88 0 001.21-.508.962.962 0 00-.426-1.17 1.374 1.374 0 00-1.32.427zm-32.542-1.18a.55.55 0 01.257-.03c.454 0 .77.44.729.715-.041.275-.413.894-.798.921-.385.028-.536-.701-.536-.976a.55.55 0 01.348-.63zm6.417 9.691a1.526 1.526 0 00-1.182-1.375c-.468-.068-1.17.619-1.21 1.169a1.086 1.086 0 00.756 1.017h.334c-.675.013-1.338.367-1.338.853-.008.21.04.419.138.605h2.392a.723.723 0 000-.165c0-.837-.315-1.222-1.192-1.292h.037-.041c.742 0 1.265-.33 1.306-.812zm-2.777-10.395c-.358.096-.674-.302-.674-.907a.495.495 0 00.098-.099.705.705 0 01.452-.273c.385-.082.88.413.756.757a1.044 1.044 0 01-.633.522zm4.688 8.58a.535.535 0 00-.646-.605c-.275 0-1.004.138-.976.523.027.385.632.756.907.797.275.041.688-.261.715-.715zm2.585 4.057h-.481a.605.605 0 01.481 0zm-4.895-5.83a.468.468 0 00-.233-.537c-.023 0-.057-.002-.099-.006-.187-.015-.521-.041-.589.116-.082.193.22.564.371.605.151.041.468.014.55-.178zM69.6 49.218a.77.77 0 01-.01-.393c.811-.426 1.1-.44 1.292-.041a.783.783 0 01-.344.963.77.77 0 01-.938-.529zm-3.795 1.45a.895.895 0 01.334.206c.508.316.536.646.412.852-.124.207.316.262.481.124.165-.137.591-.316.99.261.399.578-.234 1.06-.66 1.293-.426.234-.729.33-1.072 0-.16-.153-.318-.182-.5-.215a1.493 1.493 0 01-.765-.335 1.375 1.375 0 01-.261-1.829.893.893 0 011.041-.357zM48.73 51.824c0-.165-.22-.426-.357-.44-.138-.014-.537 0-.55.412-.013.378.31.398.49.41.017 0 .032.002.046.003.165.013.385-.262.371-.385zm4.318 2.447c-.798-.275-1.032-.756-.798-1.375.23-.27.545-.454.894-.522a.756.756 0 01-.619-.605 1.031 1.031 0 01.88-.99.331.331 0 01.358.371l.004.02c.082.398.198.96-.005 1.121a.77.77 0 01.317 0c.343.165.632.358.343 1.169-.288.811-.577 1.086-1.374.811zm15.014-7.755c0-.044.009-.093.018-.144.026-.155.055-.326-.141-.42a.303.303 0 00-.44.166c-.069.164-.179.577 0 .687.178.11.55-.193.564-.289zm3.583 7.057a.77.77 0 01-.31-.03.853.853 0 01-.481-1.128.688.688 0 01.88-.523.894.894 0 01.577 1.1.772.772 0 01-.666.581zm-22.806 4.81c-.263.085-.545.09-.81.013a1.169 1.169 0 01-.413-1.498.66.66 0 01.633-.468c.27-.143.576-.201.88-.165.426.082.632.303.632.77a1.76 1.76 0 01-.261.743v.137c-.169.219-.4.382-.661.467zM43.67 46.53c.22 0 .413-.206.454-.358.041-.15-.083-.618-.289-.646-.206-.027-.481.358-.481.509a.481.481 0 00.316.495zm.591 2.805c-.096.413-1.059.66-1.375.413-.261-.248-.261-1.403.578-1.417a.939.939 0 01.288 0c.07-.165.262-.412.427-.412a.454.454 0 01.288.399 1.1 1.1 0 01-.206.426c.049.194.049.397 0 .591zm22.44 7.04c-.027-1.224.427-2.516 2.214-2.227.342.055.672-.046.99-.143.386-.118.753-.231 1.1-.05a2.117 2.117 0 01.949 1.774 2.599 2.599 0 01-1.746 2.599 1.115 1.115 0 01-.867 0c-.19.19-.402.356-.632.494a.99.99 0 01-.564-.756 1.69 1.69 0 01-1.031-.577 1.897 1.897 0 01-.413-1.114zM35.64 52.992c0 .495.619.674.907.743.29.069.564-.289.592-.646.027-.358-.275-.825-.633-.73-.048.014-.1.026-.155.039-.344.081-.758.178-.711.594zm-1.733-10.546c.07-.371 1.403-1.058 1.61-.783.233.275.467 1.155-.235 1.347-.7.193-1.443-.192-1.374-.564zm6.958 19.127a1.253 1.253 0 00.77 1.746 1.182 1.182 0 001.526-.537 1.773 1.773 0 00-.935-1.993 1.266 1.266 0 00-1.361.783zm.99-3.658c.028 0 .124.22.124.22-.041.069-.193.289-.261.193-.024-.033-.055-.056-.085-.079-.059-.043-.112-.083-.094-.183.027-.151.288-.151.316-.151zm4.895 4.538a1.375 1.375 0 00-1.375.673c-.124.317.289 1.004.701 1.155a.605.605 0 00.702-.22 1.499 1.499 0 00.948.756.825.825 0 00.922-.783l.247.123a1.14 1.14 0 001.567-.687 1.375 1.375 0 00-.852-1.953 1.485 1.485 0 00-1.856.66 1.196 1.196 0 00.11 1.045 1.458 1.458 0 00-.866.33c.068-.605-.014-1.003-.248-1.1zm-9.996-16.748c.069.124.22.468.069.591a.535.535 0 01-.592.055c-.178-.069-.343-.467-.178-.646a.633.633 0 01.7 0zm-8.195 2.984h-.275a.811.811 0 00-.44.866c-.006.256.071.507.22.715.239-.06.483-.102.729-.124a.689.689 0 00-.262.523 1.732 1.732 0 001.375 1.622 1.278 1.278 0 001.045-1.182 1.088 1.088 0 00-1.114-1.279 1.734 1.734 0 00-.538-.002c.02-.005.06-.026.071-.108.044-.228-.208-.45-.454-.666-.14-.124-.277-.245-.357-.365zm1.99-6.43c.043.174.044.356.003.531a.893.893 0 01-1.416.399 1.032 1.032 0 01.262-1.54.99.99 0 01.907.137c.117.136.2.298.244.472zm.884 16.618c.49.176.882.032 1.14-.063.145-.053.248-.091.303-.047.022.018.052.048.089.084.22.219.688.682 1.135.329a1.073 1.073 0 00.426-1.375 1.059 1.059 0 00.949-.742 1.76 1.76 0 000-.66c.161-.105.31-.23.44-.372a1.375 1.375 0 00-.165-2.117 1.54 1.54 0 00-2.255.371c-.394.54-.25.957-.132 1.294.104.298.186.535-.143.741-.314.197-.507.143-.709.086-.247-.07-.508-.143-1.024.244-.934.701-.838 1.939-.054 2.227zm.893-9.377c.206-.096.536.124.536.289.055.178-.013.536-.22.563a.62.62 0 01-.577-.357.44.44 0 01.261-.495zm2.187 1.581a.604.604 0 00.66.715 1.058 1.058 0 00.756-.412c.11-.206-.179-.99-.564-1.032a.798.798 0 00-.852.73zm11.803 8.348a.33.33 0 01.145.026c.087.019.184.035.283.052.343.058.715.121.79.292a.772.772 0 01-.798 1.004 1.045 1.045 0 01-.728-1.1.33.33 0 01.308-.274zm37.311-5.227c-.77-.11-1.636.413-1.677 1.004-.041.591.564 1.114 1.182 1.169a1.21 1.21 0 001.21-1.114c.07-.619-.178-.99-.715-1.059zm1.683-9.589c.296-.075.609-.048.889.075a1.21 1.21 0 01.412 1.498 1.004 1.004 0 01-1.182.44c-.715-.343-1.114-1.045-.867-1.526.189-.24.452-.412.748-.487zm-7.54 6.166a1.581 1.581 0 00-1.884.893 1.086 1.086 0 00.674 1.376 1.58 1.58 0 001.815-.386 1.54 1.54 0 00-.605-1.883zm3.877-.935c.317-.743.798-1.018 1.375-.743a1.375 1.375 0 01.743 1.623 1.513 1.513 0 01-1.76.646 1.375 1.375 0 01-.358-1.526zM27.321 45.03h-.261c.174-.175.297-.393.358-.632a2.75 2.75 0 00-.18-1.884 1.224 1.224 0 010-.701 1.114 1.114 0 00-1.113-1.554.55.55 0 000-.66v5.775H26.359a1.559 1.559 0 00-.137.166 2.463 2.463 0 01-.097.123v1.375c.263.21.585.335.921.357.591 0 1.279-.33 1.375-.784a1.623 1.623 0 00-1.1-1.58zm.64-4.34a.894.894 0 01-.131-.651.88.88 0 01.935-.784 1.03 1.03 0 01.756 1.114.907.907 0 01-1.017.701.894.894 0 01-.543-.38zm60.754 13.608a1.512 1.512 0 00-.907-1.76 1.664 1.664 0 00-1.898 1.237 1.17 1.17 0 00.811 1.526 1.497 1.497 0 001.994-1.003zm-9.734 3.548c-.449-.253-.875-.494-.785-1.046a.839.839 0 01.564-.619A1.375 1.375 0 0178.65 55a1.21 1.21 0 011.65-.605.84.84 0 01.605 1.045 2.022 2.022 0 01-1.155 1.073c.04.043.068.094.082.15.206.58-.193.852-.591 1.124l-.165.114-.042-.024-.053-.03zm21.394-.468a.547.547 0 00-.22-.55c-.138-.083-.646-.096-.701.11a.55.55 0 00.316.522c.179.055.605.124.605-.082zm-2.956-3.41c.398.069.412.508.288.825-.082.316-.398.564-1.003.316a2.85 2.85 0 00-.06-.228c-.062-.22-.137-.486-.078-.624.083-.193.454-.358.853-.29zm6.325 3.781a.471.471 0 00-.234-.591.512.512 0 00-.608.094.507.507 0 00.076.771c.061.042.129.07.202.084a.521.521 0 00.564-.358zm2.224-2.268a.675.675 0 01.292-.014c.069.013.247.274.151.426l-.041.07c-.103.177-.273.47-.536.315a.48.48 0 01-.124-.66.673.673 0 01.258-.137zM74.882 55a.769.769 0 00.385-1.059c-.123-.247-.48-.564-.728-.55-.619 0-.839.523-.908 1.128l.007.006c.328.301.712.653 1.244.475zm-1.388-11.179c-.385.151-1.169-.247-.949-.921a.742.742 0 011.293-.041.812.812 0 01-.344.962zm3.671 1.169a1.128 1.128 0 00-1.375.234c-.271.265-.51.56-.715.88h-.564a1.76 1.76 0 00-1.553 1.127 2.021 2.021 0 00.59 1.87.977.977 0 00.716.248 1.567 1.567 0 001.553-1.609v-.564c.127 0 .25.008.37.016.234.015.458.03.675-.016.647 0 .894-.261.963-.88a1.375 1.375 0 00-.66-1.306zm16.761 10.45c.44-.825.853-.921 1.65-.44a.853.853 0 01.427.797c-.042.413-.18.812-.647.812a3.015 3.015 0 00-.316.123c-.22 1.692-1.045 2.132-2.324 1.156-.467.453-.935.508-1.375 0 .179-1.087.372-1.155 1.554-.62l.142-.243c.276-.474.512-.878.89-1.585zM91.7 48.909a1.084 1.084 0 00-.811.233c-.427.523-.152.99.357 1.472.084-.03.17-.055.253-.08.427-.13.824-.25.847-.8a.756.756 0 00-.646-.825zM42.35 52.016c-.179-.014-.715-.22-.619-.591.11-.371.619-.371.798-.33a.55.55 0 01.426.564c-.041.357-.426.371-.605.357zm11.866-3.891a.824.824 0 00-.632.454.55.55 0 00.495.728c.233 0 .866-.082.907-.605.042-.522-.563-.577-.77-.577zm-3.011 9.57c-.082-.234-.014-.715.151-.811a1.8 1.8 0 00.908-.784c.041-.179.247-.179.357-.179.413.124.468.564.413.715-.02.054-.05.109-.08.165-.055.103-.113.21-.113.316a1.223 1.223 0 01.66.99c-.014.344-.715.77-1.127.77a.922.922 0 01-.688-.715 1.06 1.06 0 01-.481-.467zm3.699-3.52a.646.646 0 00.481.853h.096c.207.238.48.41.784.495a1.21 1.21 0 001.306-.62 2.021 2.021 0 00-.701-1.883 1.375 1.375 0 00-1.279.619.619.619 0 00-.687.536zM29.002 31.838a.963.963 0 01.67-.213.949.949 0 01.84 1.017.894.894 0 01-.936.784 1.059 1.059 0 01-.921-.976.963.963 0 01.347-.612zm21.53 21.333a1.224 1.224 0 00-1.376.647.866.866 0 00.592 1.072.977.977 0 001.168-.426c.22-.399-.041-1.197-.385-1.293zm-1.238 6.683c.206-.083.687-.138.825 0 .272.314.638.531 1.045.618.11.014.261.207.261.303-.027.413-.192.578-.578.578a7.184 7.184 0 01-1.375-.234c-.206-.069-.522-.316-.522-.495.01-.292.133-.569.344-.77zM58.355 49.5a1.018 1.018 0 00-1.114.578c-.261.838-.096 1.512.426 1.677a1.512 1.512 0 001.554-.88 1.5 1.5 0 00-.866-1.375zm1.99 2.892c.142-.042.285-.085.416-.142a1.375 1.375 0 011.252.303 1.127 1.127 0 01.44 1.072 1.375 1.375 0 01-.936 1.059 1.842 1.842 0 01-1.54-.344c-.219-.18-.272-.366-.321-.539a1.485 1.485 0 00-.063-.19.84.84 0 010-.756c.106-.27.422-.364.753-.463zm-4.809-1.256a.44.44 0 00.413.371.66.66 0 00.495-.467c0-.206-.303-.358-.509-.358-.206 0-.44.193-.399.454zm2.136 5.613a1.527 1.527 0 01.174-1.075 1.994 1.994 0 012.407-.591 1.663 1.663 0 01.247 2.323 1.376 1.376 0 01-2.241.261 1.527 1.527 0 01-.587-.918zm-7.828-6.534a.66.66 0 00-.894.44.605.605 0 00.33.839.646.646 0 00.949-.248.757.757 0 00-.385-1.031zm6.448-3.121c.097-.248.344-.248.523-.248.096 0 .509.207.358.482-.126.228-.385.21-.564.197-.036-.003-.069-.005-.096-.005a.316.316 0 01-.22-.426zm-1.003-2.585c-.248.508 0 1.265.426 1.375.426.11 1.375-1.004 1.169-1.485-.206-.482-1.348-.399-1.595.11zM32.065 40.37a.619.619 0 00.578.358c.206 0 .274-.386.22-.578-.056-.192-.33-.371-.537-.275a.44.44 0 00-.261.495zm-2.14-4.753a.811.811 0 01.614-.046c.572.149.582.574.593 1.038.003.093.005.188.012.282-.839.385-1.238.427-1.513 0a1.045 1.045 0 01-.11-.811.81.81 0 01.405-.463zm1.205 11.326c0 .398.124.715.495.797a4.88 4.88 0 002.874-.083 1.51 1.51 0 00.371-.274 1.087 1.087 0 00-.633-1.884h-.11c.092-.127.153-.273.18-.427a.797.797 0 00-.785-.907.755.755 0 00-.893.66 1.5 1.5 0 00.11.591h-.316a1.704 1.704 0 00-1.293 1.527zm4.473-11.346a1.47 1.47 0 011-.342c.742.027 1.512 1.155 1.36 2.063a1.253 1.253 0 01-1.498 1.03 1.58 1.58 0 01-1.375-1.828c.05-.36.234-.69.513-.923zm2.608 8.83c.138.357 1.375.535 1.54 0a.866.866 0 00-.357-1.073c-.481-.124-1.32.715-1.183 1.072zm2.187 8.45a1.25 1.25 0 01.536-.008c.564.041 1.155.632 1.1 1.169a1.76 1.76 0 01-1.691 1.375c-.51 0-.908-.688-.908-1.375a1.25 1.25 0 01.963-1.161zm22.398-2.937a.894.894 0 00-1.072.399.754.754 0 00.357 1.059.88.88 0 001.073-.413.729.729 0 00-.358-1.045zM39.627 32.986c-.082-.151-.082-.756.165-.839a.77.77 0 01.702.358.689.689 0 01-.22.632.673.673 0 01-.647-.15zm-2.062 16.157c-.412 0-.921.48-1.045 1.264.033.034.07.08.112.133.113.143.257.326.438.376.096.014.193.014.289 0 .165.097.398 0 .577-.206a.838.838 0 00.385-.495 1.058 1.058 0 00-.756-1.073zm6.29 6.068c.127-.25.333-.449.585-.569.32-.143.65-.258.99-.343a1.639 1.639 0 01.468 2.269c-.184.266-.466.449-.784.508a1.375 1.375 0 01-1.375-1.059 1.265 1.265 0 01.116-.806z",fill:"#54B399"}),external_kbnSharedDeps_React_["createElement"]("path",{d:"M162.085 56.072H50.999V96.87h111.086V56.072z",fill:"#8ADFC8"}),external_kbnSharedDeps_React_["createElement"]("path",{className:"lnsDropIllustration__adjustFill",fillRule:"evenodd",clipRule:"evenodd",d:"M43.574 36.575a8.91 8.91 0 110 17.82 8.91 8.91 0 010-17.82zM23.98 103.166h14.946v14.947H23.98v-14.947zm45.306-34.072L59.14 85.388h20.295L69.286 69.094zm54.288 4.224a2.901 2.901 0 012.197-.292 2.902 2.902 0 011.898 3.589l-3.96 13.516-4.125 12.691c-2.186 7.467-10.326 11.647-18.576 9.227-5.17-1.513-11.564-7.109-12.692-11.592l-3.575-16.156a3.066 3.066 0 011.953-3.712 2.75 2.75 0 013.52 1.939l2.062 6.874.207-.715 1.663-5.65 5.541-19.168a2.864 2.864 0 015.259-.583 2.86 2.86 0 01.242 2.178l-5.212 17.792 2.475.715 6.174-21.134a2.868 2.868 0 012.434-2.048 2.868 2.868 0 012.105.61 2.852 2.852 0 011.057 1.92c.041.374.009.752-.096 1.114l-6.242 21.133 2.475.715L115.5 68.53a2.868 2.868 0 012.434-2.048 2.868 2.868 0 012.105.61 2.852 2.852 0 011.057 1.92c.041.374.009.752-.096 1.113l-5.225 17.751 2.475.715 3.974-13.516c.2-.742.685-1.374 1.35-1.758z"}),external_kbnSharedDeps_React_["createElement"]("path",{className:"lnsDropIllustration__adjustFill lnsDropIllustration__hand",id:"lnsDropIllustrationArrow",d:"M84.688 156.577v-31.021c0-1.17.853-2.118 1.906-2.118s1.906.948 1.906 2.118v31.021l15.617-15.617a1.907 1.907 0 012.696 2.696l-16.175 16.175a5.695 5.695 0 01-3.525 1.652 1.725 1.725 0 01-1.039 0 5.695 5.695 0 01-3.524-1.652l-16.175-16.175a1.907 1.907 0 012.696-2.696l15.617 15.617z"}))};const isRequestError=e=>{if("body"in e){var _e$body,_e$body$attributes,_e$body$attributes$er;return((_e$body=e.body)===null||_e$body===void 0?void 0:(_e$body$attributes=_e$body.attributes)===null||_e$body$attributes===void 0?void 0:(_e$body$attributes$er=_e$body$attributes.error)===null||_e$body$attributes$er===void 0?void 0:_e$body$attributes$er.caused_by)!==undefined}return false};function getNestedErrorClause({type:type,reason:reason,caused_by:causedBy}){if(causedBy){return getNestedErrorClause(causedBy)}return{type:type,reason:reason}}function getOriginalRequestErrorMessage(error){if(error&&"original"in error&&error.original&&isRequestError(error.original)){const rootError=getNestedErrorClause(error.original.body.attributes.error);if(rootError.reason&&rootError.type){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.expressionFailureMessage",{defaultMessage:"Request error: {type}, {reason}",values:{reason:rootError.reason,type:rootError.type}})}}}function workspace_panel_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function workspace_panel_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){workspace_panel_ownKeys(Object(source),true).forEach((function(key){workspace_panel_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{workspace_panel_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function workspace_panel_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function workspace_panel_slicedToArray(arr,i){return workspace_panel_arrayWithHoles(arr)||workspace_panel_iterableToArrayLimit(arr,i)||workspace_panel_unsupportedIterableToArray(arr,i)||workspace_panel_nonIterableRest()}function workspace_panel_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function workspace_panel_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return workspace_panel_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return workspace_panel_arrayLikeToArray(o,minLen)}function workspace_panel_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function workspace_panel_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function workspace_panel_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function WorkspacePanel({activeDatasourceId:activeDatasourceId,activeVisualizationId:activeVisualizationId,visualizationMap:visualizationMap,visualizationState:visualizationState,datasourceMap:datasourceMap,datasourceStates:datasourceStates,framePublicAPI:framePublicAPI,dispatch:dispatch,core:core,plugins:plugins,ExpressionRenderer:ExpressionRendererComponent,title:title,visualizeTriggerFieldContext:visualizeTriggerFieldContext}){const dragDropContext=Object(external_kbnSharedDeps_React_["useContext"])(DragContext);const suggestionForDraggedField=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(!dragDropContext.dragging||!activeDatasourceId){return}const hasData=Object.values(framePublicAPI.datasourceLayers).some(datasource=>datasource.getTableSpec().length>0);const mainPalette=activeVisualizationId&&visualizationMap[activeVisualizationId]&&visualizationMap[activeVisualizationId].getMainPalette?visualizationMap[activeVisualizationId].getMainPalette(visualizationState):undefined;const suggestions=suggestion_helpers_getSuggestions({datasourceMap:{[activeDatasourceId]:datasourceMap[activeDatasourceId]},datasourceStates:datasourceStates,visualizationMap:hasData&&activeVisualizationId?{[activeVisualizationId]:visualizationMap[activeVisualizationId]}:visualizationMap,activeVisualizationId:activeVisualizationId,visualizationState:visualizationState,field:dragDropContext.dragging,mainPalette:mainPalette});return suggestions.find(s=>s.visualizationId===activeVisualizationId)||suggestions[0]},[dragDropContext.dragging]);const _useState=Object(external_kbnSharedDeps_React_["useState"])({expressionBuildError:undefined,expandError:false}),_useState2=workspace_panel_slicedToArray(_useState,2),localState=_useState2[0],setLocalState=_useState2[1];const activeVisualization=activeVisualizationId?visualizationMap[activeVisualizationId]:null;const configurationValidationError=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _datasourceStates$act;return validateDatasourceAndVisualization(activeDatasourceId?datasourceMap[activeDatasourceId]:null,activeDatasourceId&&((_datasourceStates$act=datasourceStates[activeDatasourceId])===null||_datasourceStates$act===void 0?void 0:_datasourceStates$act.state),activeVisualization,visualizationState,framePublicAPI)},[activeVisualization,visualizationState,activeDatasourceId,datasourceMap,datasourceStates]);const expression=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(!configurationValidationError||configurationValidationError.length===0){try{return expression_helpers_buildExpression({visualization:activeVisualization,visualizationState:visualizationState,datasourceMap:datasourceMap,datasourceStates:datasourceStates,datasourceLayers:framePublicAPI.datasourceLayers})}catch(e){const buildMessages=activeVisualization===null||activeVisualization===void 0?void 0:activeVisualization.getErrorMessages(visualizationState,framePublicAPI);const defaultMessage={shortMessage:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.buildExpressionError",{defaultMessage:"An unexpected error occurred while preparing the chart"}),longMessage:e.toString()};setLocalState(s=>workspace_panel_objectSpread(workspace_panel_objectSpread({},s),{},{expressionBuildError:buildMessages!==null&&buildMessages!==void 0?buildMessages:[defaultMessage]}))}}},[activeVisualization,visualizationState,datasourceMap,datasourceStates,framePublicAPI.dateRange,framePublicAPI.query,framePublicAPI.filters]);const onEvent=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{if(!plugins.uiActions){return}if(Object(types["b"])(event)){plugins.uiActions.getTrigger(visualizations_public_["VIS_EVENT_TO_TRIGGER"][event.name]).exec({data:event.data})}if(Object(types["c"])(event)){plugins.uiActions.getTrigger(visualizations_public_["VIS_EVENT_TO_TRIGGER"][event.name]).exec({data:event.data})}},[plugins.uiActions]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(expression&&localState.expressionBuildError){setLocalState(s=>workspace_panel_objectSpread(workspace_panel_objectSpread({},s),{},{expressionBuildError:undefined}))}},[expression,localState.expressionBuildError]);function onDrop(){if(suggestionForDraggedField){factory_trackUiEvent("drop_onto_workspace");factory_trackUiEvent(expression?"drop_non_empty":"drop_empty");switchToSuggestion(dispatch,suggestionForDraggedField,"SWITCH_VISUALIZATION")}}function renderEmptyWorkspace(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{className:classnames_default()("lnsWorkspacePanel__emptyContent"),textAlign:"center",color:"subdued","data-test-subj":"empty-workspace",size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement("strong",null,expression===null?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.emptyWorkspace",{defaultMessage:"Drop some fields here to start"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.emptyWorkspaceSimple",{defaultMessage:"Drop field here"}))),external_kbnSharedDeps_React_default.a.createElement(DropIllustration,{"aria-hidden":true,className:"lnsWorkspacePanel__dropIllustration"}),expression===null&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.emptyWorkspaceHeading",{defaultMessage:"Lens is a new tool for creating visualization"})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement("small",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://www.elastic.co/products/kibana/feedback",target:"_blank",external:true},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.goToForums",{defaultMessage:"Make requests and give feedback"}))))))}function renderVisualization(){if(expression===null&&!visualizeTriggerFieldContext){return renderEmptyWorkspace()}return external_kbnSharedDeps_React_default.a.createElement(VisualizationWrapper,{expression:expression,framePublicAPI:framePublicAPI,timefilter:plugins.data.query.timefilter.timefilter,dispatch:dispatch,onEvent:onEvent,setLocalState:setLocalState,localState:workspace_panel_objectSpread(workspace_panel_objectSpread({},localState),{},{configurationValidationError:configurationValidationError}),ExpressionRendererComponent:ExpressionRendererComponent})}return external_kbnSharedDeps_React_default.a.createElement(WorkspacePanelWrapper,{title:title,framePublicAPI:framePublicAPI,dispatch:dispatch,visualizationState:visualizationState,visualizationId:activeVisualizationId,datasourceStates:datasourceStates,datasourceMap:datasourceMap,visualizationMap:visualizationMap},external_kbnSharedDeps_React_default.a.createElement(DragDrop,{className:"lnsWorkspacePanel__dragDrop","data-test-subj":"lnsWorkspace",draggable:false,droppable:Boolean(suggestionForDraggedField),onDrop:onDrop},external_kbnSharedDeps_React_default.a.createElement("div",null,renderVisualization(),Boolean(suggestionForDraggedField)&&expression!==null&&renderEmptyWorkspace())))}const InnerVisualizationWrapper=({expression:expression,framePublicAPI:framePublicAPI,timefilter:timefilter,onEvent:onEvent,setLocalState:setLocalState,localState:localState,ExpressionRendererComponent:ExpressionRendererComponent,dispatch:dispatch})=>{var _localState$configura,_localState$expressio;const autoRefreshFetch$=Object(external_kbnSharedDeps_React_["useMemo"])(()=>timefilter.getAutoRefreshFetch$(),[timefilter]);const context=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({query:framePublicAPI.query,timeRange:{from:framePublicAPI.dateRange.fromDate,to:framePublicAPI.dateRange.toDate},filters:framePublicAPI.filters}),[framePublicAPI.query,framePublicAPI.dateRange.fromDate,framePublicAPI.dateRange.toDate,framePublicAPI.filters]);const onData$=Object(external_kbnSharedDeps_React_["useCallback"])((data,inspectorAdapters)=>{if(inspectorAdapters&&inspectorAdapters.tables){dispatch({type:"UPDATE_ACTIVE_DATA",tables:inspectorAdapters.tables})}},[dispatch]);if((_localState$configura=localState.configurationValidationError)===null||_localState$configura===void 0?void 0:_localState$configura.length){let showExtraErrors=null;if(localState.configurationValidationError.length>1){if(localState.expandError){showExtraErrors=localState.configurationValidationError.slice(1).map(({longMessage:longMessage})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:longMessage,className:"eui-textBreakAll"},longMessage))}else{showExtraErrors=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"configuration-failure-more-errors"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:()=>{setLocalState(prevState=>workspace_panel_objectSpread(workspace_panel_objectSpread({},prevState),{},{expandError:!prevState.expandError}))}},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.configurationFailureMoreErrors",{defaultMessage:" +{errors} {errors, plural, one {error} other {errors}}",values:{errors:localState.configurationValidationError.length-1}})))}}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{style:{maxWidth:"100%"},direction:"column",alignItems:"center","data-test-subj":"configuration-failure"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert",size:"xl",color:"danger"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.editorFrame.configurationFailure",defaultMessage:"Invalid configuration"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"eui-textBreakAll"},localState.configurationValidationError[0].longMessage),showExtraErrors)}if((_localState$expressio=localState.expressionBuildError)===null||_localState$expressio===void 0?void 0:_localState$expressio.length){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{style:{maxWidth:"100%"},direction:"column",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert",size:"xl",color:"danger"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"expression-failure"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.editorFrame.expressionFailure",defaultMessage:"An error occurred in the expression"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},localState.expressionBuildError[0].longMessage))}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsExpressionRenderer"},external_kbnSharedDeps_React_default.a.createElement(ExpressionRendererComponent,{className:"lnsExpressionRenderer__component",padding:"m",expression:expression,searchContext:context,reload$:autoRefreshFetch$,onEvent:onEvent,onData$:onData$,renderError:(errorMessage,error)=>{const visibleErrorMessage=getOriginalRequestErrorMessage(error)||errorMessage;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{style:{maxWidth:"100%"},direction:"column",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert",size:"xl",color:"danger"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"expression-failure"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.editorFrame.dataFailure",defaultMessage:"An error occurred when loading data."})),visibleErrorMessage?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"eui-textBreakAll",grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:()=>{setLocalState(prevState=>workspace_panel_objectSpread(workspace_panel_objectSpread({},prevState),{},{expandError:!prevState.expandError}))}},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.editorFrame.expandRenderingErrorButton",{defaultMessage:"Show details of error"})),localState.expandError?visibleErrorMessage:null):null)}}))};const VisualizationWrapper=debouncedComponent(InnerVisualizationWrapper);function saved_object_store_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function saved_object_store_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){saved_object_store_ownKeys(Object(source),true).forEach((function(key){saved_object_store_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{saved_object_store_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function saved_object_store_objectWithoutProperties(source,excluded){if(source==null)return{};var target=saved_object_store_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function saved_object_store_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function saved_object_store_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function saved_object_store_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){saved_object_store_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){saved_object_store_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function saved_object_store_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class saved_object_store_SavedObjectIndexStore{constructor(client){var _this=this;saved_object_store_defineProperty(this,"client",void 0);saved_object_store_defineProperty(this,"save",function(){var _ref=saved_object_store_asyncToGenerator(regeneratorRuntime.mark((function _callee(vis){var savedObjectId,type,references,rest,attributes,result;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:savedObjectId=vis.savedObjectId,type=vis.type,references=vis.references,rest=saved_object_store_objectWithoutProperties(vis,["savedObjectId","type","references"]);attributes=rest;_context.next=4;return savedObjectId?_this.safeUpdate(savedObjectId,attributes,references):_this.client.create(common["DOC_TYPE"],attributes,{references:references});case 4:result=_context.sent;return _context.abrupt("return",saved_object_store_objectSpread(saved_object_store_objectSpread({},vis),{},{savedObjectId:result.id}));case 6:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}());this.client=client}safeUpdate(savedObjectId,attributes,references){var _this2=this;return saved_object_store_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var resetAttributes;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:resetAttributes={};Object.keys(attributes).forEach(key=>{resetAttributes[key]=null});_context2.next=4;return _this2.client.bulkUpdate([{type:common["DOC_TYPE"],id:savedObjectId,attributes:resetAttributes,references:references},{type:common["DOC_TYPE"],id:savedObjectId,attributes:attributes,references:references}]);case 4:return _context2.abrupt("return",_context2.sent.savedObjects[1]);case 5:case"end":return _context2.stop()}}),_callee2)})))()}load(savedObjectId){var _this3=this;return saved_object_store_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _yield$_this3$client$,type,attributes,references,error;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _this3.client.get(common["DOC_TYPE"],savedObjectId);case 2:_yield$_this3$client$=_context3.sent;type=_yield$_this3$client$.type;attributes=_yield$_this3$client$.attributes;references=_yield$_this3$client$.references;error=_yield$_this3$client$.error;if(!error){_context3.next=9;break}throw error;case 9:return _context3.abrupt("return",saved_object_store_objectSpread(saved_object_store_objectSpread({},attributes),{},{references:references,savedObjectId:savedObjectId,type:type}));case 10:case"end":return _context3.stop()}}),_callee3)})))()}}function filter_references_objectWithoutProperties(source,excluded){if(source==null)return{};var target=filter_references_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function filter_references_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function filter_references_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function filter_references_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){filter_references_ownKeys(Object(source),true).forEach((function(key){filter_references_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{filter_references_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function filter_references_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function extractFilterReferences(filters){const references=[];const persistableFilters=filters.map((filterRow,i)=>{if(!filterRow.meta||!filterRow.meta.index){return filterRow}const refName="filter-index-pattern-".concat(i);references.push({name:refName,type:"index-pattern",id:filterRow.meta.index});return filter_references_objectSpread(filter_references_objectSpread({},filterRow),{},{meta:filter_references_objectSpread(filter_references_objectSpread({},filterRow.meta),{},{indexRefName:refName,index:undefined})})});return{persistableFilters:persistableFilters,references:references}}function injectFilterReferences(filters,references){return filters.map(filterRow=>{if(!filterRow.meta||!filterRow.meta.indexRefName){return filterRow}const _filterRow$meta=filterRow.meta,indexRefName=_filterRow$meta.indexRefName,metaRest=filter_references_objectWithoutProperties(_filterRow$meta,["indexRefName"]);const reference=references.find(ref=>ref.name===indexRefName);if(!reference){throw new Error("Could not find reference for ".concat(indexRefName))}return filter_references_objectSpread(filter_references_objectSpread({},filterRow),{},{meta:filter_references_objectSpread(filter_references_objectSpread({},metaRest),{},{index:reference.id})})})}function getSavedObjectFormat({activeDatasources:activeDatasources,state:state,visualization:visualization,framePublicAPI:framePublicAPI}){const datasourceStates={};const references=[];Object.entries(activeDatasources).forEach(([id,datasource])=>{const _datasource$getPersis=datasource.getPersistableState(state.datasourceStates[id].state),persistableState=_datasource$getPersis.state,savedObjectReferences=_datasource$getPersis.savedObjectReferences;datasourceStates[id]=persistableState;references.push(...savedObjectReferences)});const uniqueFilterableIndexPatternIds=external_kbnSharedDeps_Lodash_default.a.uniq(references.filter(({type:type})=>type==="index-pattern").map(({id:id})=>id));const _extractFilterReferen=extractFilterReferences(framePublicAPI.filters),persistableFilters=_extractFilterReferen.persistableFilters,filterReferences=_extractFilterReferen.references;references.push(...filterReferences);const expression=expression_helpers_buildExpression({visualization:visualization,visualizationState:state.visualization.state,datasourceMap:activeDatasources,datasourceStates:state.datasourceStates,datasourceLayers:framePublicAPI.datasourceLayers});return{doc:{savedObjectId:state.persistedId,title:state.title,description:state.description,type:"lens",visualizationType:state.visualization.activeId,state:{datasourceStates:datasourceStates,visualization:state.visualization.state,query:framePublicAPI.query,filters:persistableFilters},references:references},filterableIndexPatterns:uniqueFilterableIndexPatternIds,isSaveable:expression!==null,activeData:state.activeData}}function editor_frame_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function editor_frame_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){editor_frame_ownKeys(Object(source),true).forEach((function(key){editor_frame_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{editor_frame_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function editor_frame_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function editor_frame_slicedToArray(arr,i){return editor_frame_arrayWithHoles(arr)||editor_frame_iterableToArrayLimit(arr,i)||editor_frame_unsupportedIterableToArray(arr,i)||editor_frame_nonIterableRest()}function editor_frame_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function editor_frame_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return editor_frame_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return editor_frame_arrayLikeToArray(o,minLen)}function editor_frame_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function editor_frame_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function editor_frame_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function EditorFrame(props){const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(reducer,props,getInitialState),_useReducer2=editor_frame_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];const _useState=Object(external_kbnSharedDeps_React_["useState"])(props.initialContext),_useState2=editor_frame_slicedToArray(_useState,2),visualizeTriggerFieldContext=_useState2[0],setVisualizeTriggerFieldContext=_useState2[1];const onError=props.onError;const activeVisualization=state.visualization.activeId&&props.visualizationMap[state.visualization.activeId];const allLoaded=Object.values(state.datasourceStates).every(({isLoading:isLoading})=>typeof isLoading==="boolean"&&!isLoading);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isUnmounted=false;if(!allLoaded){var _props$doc;initializeDatasources(props.datasourceMap,state.datasourceStates,(_props$doc=props.doc)===null||_props$doc===void 0?void 0:_props$doc.references,visualizeTriggerFieldContext).then(result=>{if(!isUnmounted){Object.entries(result).forEach(([datasourceId,{state:datasourceState}])=>{dispatch({type:"UPDATE_DATASOURCE_STATE",updater:datasourceState,datasourceId:datasourceId})})}}).catch(onError)}return()=>{isUnmounted=true}},[allLoaded,onError]);const datasourceLayers=createDatasourceLayers(props.datasourceMap,state.datasourceStates);const framePublicAPI={datasourceLayers:datasourceLayers,activeData:state.activeData,dateRange:props.dateRange,query:props.query,filters:props.filters,availablePalettes:props.palettes,addNewLayer(){const newLayerId=generateId();dispatch({type:"UPDATE_LAYER",datasourceId:state.activeDatasourceId,layerId:newLayerId,updater:props.datasourceMap[state.activeDatasourceId].insertLayer});return newLayerId},removeLayers(layerIds){if(activeVisualization&&activeVisualization.removeLayer&&state.visualization.state){dispatch({type:"UPDATE_VISUALIZATION_STATE",visualizationId:activeVisualization.id,newState:layerIds.reduce((acc,layerId)=>activeVisualization.removeLayer?activeVisualization.removeLayer(acc,layerId):acc,state.visualization.state)})}layerIds.forEach(layerId=>{const layerDatasourceId=Object.entries(props.datasourceMap).find(([datasourceId,datasource])=>state.datasourceStates[datasourceId]&&datasource.getLayers(state.datasourceStates[datasourceId].state).includes(layerId))[0];dispatch({type:"UPDATE_LAYER",layerId:layerId,datasourceId:layerDatasourceId,updater:props.datasourceMap[layerDatasourceId].removeLayer})})}};Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(props.doc){dispatch({type:"VISUALIZATION_LOADED",doc:editor_frame_objectSpread(editor_frame_objectSpread({},props.doc),{},{state:editor_frame_objectSpread(editor_frame_objectSpread({},props.doc.state),{},{visualization:props.doc.visualizationType?props.visualizationMap[props.doc.visualizationType].initialize(framePublicAPI,props.doc.state.visualization):props.doc.state.visualization})})})}else{dispatch({type:"RESET",state:getInitialState(props)})}},[props.doc]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(allLoaded&&state.visualization.state===null&&activeVisualization){const initialVisualizationState=activeVisualization.initialize(framePublicAPI);dispatch({type:"UPDATE_VISUALIZATION_STATE",visualizationId:activeVisualization.id,newState:initialVisualizationState})}},[allLoaded,activeVisualization,state.visualization.state]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(allLoaded&&visualizeTriggerFieldContext&&!props.doc){applyVisualizeFieldSuggestions({datasourceMap:props.datasourceMap,datasourceStates:state.datasourceStates,visualizationMap:props.visualizationMap,activeVisualizationId:state.visualization.activeId,visualizationState:state.visualization.state,visualizeTriggerFieldContext:visualizeTriggerFieldContext,dispatch:dispatch});setVisualizeTriggerFieldContext(undefined)}},[allLoaded]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const activeDatasource=state.activeDatasourceId&&!state.datasourceStates[state.activeDatasourceId].isLoading?props.datasourceMap[state.activeDatasourceId]:undefined;if(!activeDatasource||!activeVisualization){return}props.onChange(getSavedObjectFormat({activeDatasources:Object.keys(state.datasourceStates).reduce((datasourceMap,datasourceId)=>editor_frame_objectSpread(editor_frame_objectSpread({},datasourceMap),{},{[datasourceId]:props.datasourceMap[datasourceId]}),{}),visualization:activeVisualization,state:state,framePublicAPI:framePublicAPI}))},[activeVisualization,state.datasourceStates,state.visualization,state.activeData,props.query,props.dateRange,props.filters,props.savedQuery,state.title]);return external_kbnSharedDeps_React_default.a.createElement(RootDragDropProvider,null,external_kbnSharedDeps_React_default.a.createElement(FrameLayout,{dataPanel:external_kbnSharedDeps_React_default.a.createElement(DataPanelWrapper,{datasourceMap:props.datasourceMap,activeDatasource:state.activeDatasourceId,datasourceState:state.activeDatasourceId?state.datasourceStates[state.activeDatasourceId].state:null,datasourceIsLoading:state.activeDatasourceId?state.datasourceStates[state.activeDatasourceId].isLoading:true,dispatch:dispatch,core:props.core,query:props.query,dateRange:props.dateRange,filters:props.filters,showNoDataPopover:props.showNoDataPopover}),configPanel:allLoaded&&external_kbnSharedDeps_React_default.a.createElement(config_panel_ConfigPanelWrapper,{activeDatasourceId:state.activeDatasourceId,datasourceMap:props.datasourceMap,datasourceStates:state.datasourceStates,visualizationMap:props.visualizationMap,activeVisualizationId:state.visualization.activeId,dispatch:dispatch,visualizationState:state.visualization.state,framePublicAPI:framePublicAPI,core:props.core}),workspacePanel:allLoaded&&external_kbnSharedDeps_React_default.a.createElement(WorkspacePanel,{title:state.title,activeDatasourceId:state.activeDatasourceId,activeVisualizationId:state.visualization.activeId,datasourceMap:props.datasourceMap,datasourceStates:state.datasourceStates,framePublicAPI:framePublicAPI,visualizationState:state.visualization.state,visualizationMap:props.visualizationMap,dispatch:dispatch,ExpressionRenderer:props.ExpressionRenderer,core:props.core,plugins:props.plugins,visualizeTriggerFieldContext:visualizeTriggerFieldContext}),suggestionsPanel:allLoaded&&external_kbnSharedDeps_React_default.a.createElement(SuggestionPanel,{frame:framePublicAPI,activeDatasourceId:state.activeDatasourceId,activeVisualizationId:state.visualization.activeId,datasourceMap:props.datasourceMap,datasourceStates:state.datasourceStates,visualizationState:state.visualization.state,visualizationMap:props.visualizationMap,dispatch:dispatch,ExpressionRenderer:props.ExpressionRenderer,stagedPreview:state.stagedPreview,plugins:props.plugins})}))}var embeddable_public_=__webpack_require__(30);function ExpressionWrapper({ExpressionRenderer:ExpressionRendererComponent,expression:expression,searchContext:searchContext,variables:variables,handleEvent:handleEvent,searchSessionId:searchSessionId,renderMode:renderMode}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,expression===null||expression===""?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",alignItems:"center",justifyContent:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert",color:"danger"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.embeddable.failure",defaultMessage:"Visualization couldn't be displayed"})))):external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsExpressionRenderer"},external_kbnSharedDeps_React_default.a.createElement(ExpressionRendererComponent,{className:"lnsExpressionRenderer__component",padding:"s",variables:variables,expression:expression,searchContext:searchContext,searchSessionId:searchSessionId,renderMode:renderMode,renderError:(errorMessage,error)=>external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"expression-renderer-error"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",alignItems:"center",justifyContent:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert",color:"danger"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},getOriginalRequestErrorMessage(error)||errorMessage)))),onEvent:handleEvent})))}function embeddable_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function embeddable_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){embeddable_ownKeys(Object(source),true).forEach((function(key){embeddable_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{embeddable_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function embeddable_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function embeddable_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){embeddable_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){embeddable_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function embeddable_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class embeddable_Embeddable extends embeddable_public_["Embeddable"]{constructor(deps,initialInput,parent){var _this;super(initialInput,{editApp:"lens",editable:deps.editable},parent);_this=this;this.deps=deps;embeddable_defineProperty(this,"type",common["DOC_TYPE"]);embeddable_defineProperty(this,"expressionRenderer",void 0);embeddable_defineProperty(this,"savedVis",void 0);embeddable_defineProperty(this,"expression",void 0);embeddable_defineProperty(this,"domNode",void 0);embeddable_defineProperty(this,"subscription",void 0);embeddable_defineProperty(this,"autoRefreshFetchSubscription",void 0);embeddable_defineProperty(this,"isInitialized",false);embeddable_defineProperty(this,"externalSearchContext",{});embeddable_defineProperty(this,"handleEvent",event=>{if(!this.deps.getTrigger||this.input.disableTriggers){return}if(Object(types["b"])(event)){this.deps.getTrigger(visualizations_public_["VIS_EVENT_TO_TRIGGER"][event.name]).exec({data:event.data,embeddable:this})}if(Object(types["c"])(event)){this.deps.getTrigger(visualizations_public_["VIS_EVENT_TO_TRIGGER"][event.name]).exec({data:event.data,embeddable:this})}});embeddable_defineProperty(this,"inputIsRefType",input=>this.deps.attributeService.inputIsRefType(input));embeddable_defineProperty(this,"getInputAsRefType",embeddable_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var input;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:input=_this.deps.attributeService.getExplicitInputFromEmbeddable(_this);return _context.abrupt("return",_this.deps.attributeService.getInputAsRefType(input,{showSaveModal:true,saveModalTitle:_this.getTitle()}));case 2:case"end":return _context.stop()}}),_callee)}))));embeddable_defineProperty(this,"getInputAsValueType",embeddable_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var input;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:input=_this.deps.attributeService.getExplicitInputFromEmbeddable(_this);return _context2.abrupt("return",_this.deps.attributeService.getInputAsValueType(input));case 2:case"end":return _context2.stop()}}),_callee2)}))));this.expressionRenderer=deps.expressionRenderer;this.initializeSavedVis(initialInput).then(()=>this.onContainerStateChanged(initialInput));this.subscription=this.getInput$().subscribe(input=>this.onContainerStateChanged(input));this.autoRefreshFetchSubscription=deps.timefilter.getAutoRefreshFetch$().subscribe(this.reload.bind(this))}supportedTriggers(){if(!this.savedVis){return[]}switch(this.savedVis.visualizationType){case"lnsXY":return[visualizations_public_["VIS_EVENT_TO_TRIGGER"].filter,visualizations_public_["VIS_EVENT_TO_TRIGGER"].brush];case"lnsDatatable":case"lnsPie":return[visualizations_public_["VIS_EVENT_TO_TRIGGER"].filter];case"lnsMetric":default:return[]}}initializeSavedVis(input){var _this2=this;return embeddable_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var attributes,expression;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _this2.deps.attributeService.unwrapAttributes(input).catch(e=>{_this2.onFatalError(e);return false});case 2:attributes=_context3.sent;if(attributes){_context3.next=5;break}return _context3.abrupt("return");case 5:_this2.savedVis=embeddable_objectSpread(embeddable_objectSpread({},attributes),{},{type:_this2.type,savedObjectId:input===null||input===void 0?void 0:input.savedObjectId});_context3.next=8;return _this2.deps.documentToExpression(_this2.savedVis);case 8:expression=_context3.sent;_this2.expression=expression?Object(target_common["toExpression"])(expression):null;_context3.next=12;return _this2.initializeOutput();case 12:_this2.isInitialized=true;if(_this2.domNode){_this2.render(_this2.domNode)}case 14:case"end":return _context3.stop()}}),_callee3)})))()}onContainerStateChanged(containerState){const cleanedFilters=containerState.filters?containerState.filters.filter(filter=>!filter.meta.disabled):undefined;if(!external_kbnSharedDeps_Lodash_default.a.isEqual(containerState.timeRange,this.externalSearchContext.timeRange)||!external_kbnSharedDeps_Lodash_default.a.isEqual(containerState.query,this.externalSearchContext.query)||!external_kbnSharedDeps_Lodash_default.a.isEqual(cleanedFilters,this.externalSearchContext.filters)){this.externalSearchContext={timeRange:containerState.timeRange,query:containerState.query,lastReloadRequestTime:this.externalSearchContext.lastReloadRequestTime,filters:cleanedFilters};this.reload()}}render(domNode){this.domNode=domNode;if(!this.savedVis||!this.isInitialized){return}const input=this.getInput();Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(ExpressionWrapper,{ExpressionRenderer:this.expressionRenderer,expression:this.expression||null,searchContext:this.getMergedSearchContext(),variables:input.palette?{theme:{palette:input.palette}}:{},searchSessionId:this.input.searchSessionId,handleEvent:this.handleEvent,renderMode:input.renderMode}),domNode)}getMergedSearchContext(){var _this$externalSearchC;if(!this.savedVis){throw new Error("savedVis is required for getMergedSearchContext")}const output={timeRange:this.externalSearchContext.timeRange};if(this.externalSearchContext.query){output.query=[this.externalSearchContext.query,this.savedVis.state.query]}else{output.query=[this.savedVis.state.query]}if((_this$externalSearchC=this.externalSearchContext.filters)===null||_this$externalSearchC===void 0?void 0:_this$externalSearchC.length){output.filters=[...this.externalSearchContext.filters,...this.savedVis.state.filters]}else{output.filters=[...this.savedVis.state.filters]}output.filters=injectFilterReferences(output.filters,this.savedVis.references);return output}reload(){var _this3=this;return embeddable_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var currentTime;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:currentTime=Date.now();if(_this3.externalSearchContext.lastReloadRequestTime!==currentTime){_this3.externalSearchContext=embeddable_objectSpread(embeddable_objectSpread({},_this3.externalSearchContext),{},{lastReloadRequestTime:currentTime});if(_this3.domNode){_this3.render(_this3.domNode)}}case 2:case"end":return _context4.stop()}}),_callee4)})))()}initializeOutput(){var _this4=this;return embeddable_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){var promises,indexPatterns,input,title,savedObjectId;return regeneratorRuntime.wrap((function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:if(_this4.savedVis){_context6.next=2;break}return _context6.abrupt("return");case 2:promises=external_kbnSharedDeps_Lodash_default.a.uniqBy(_this4.savedVis.references.filter(({type:type})=>type==="index-pattern"),"id").map(function(){var _ref3=embeddable_asyncToGenerator(regeneratorRuntime.mark((function _callee5({id:id}){return regeneratorRuntime.wrap((function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return _this4.deps.indexPatternService.get(id);case 3:return _context5.abrupt("return",_context5.sent);case 6:_context5.prev=6;_context5.t0=_context5["catch"](0);return _context5.abrupt("return",null);case 9:case"end":return _context5.stop()}}),_callee5,null,[[0,6]])})));return function(_x){return _ref3.apply(this,arguments)}}()).filter(promise=>Boolean(promise));_context6.next=5;return Promise.all(promises);case 5:indexPatterns=_context6.sent;input=_this4.getInput();title=input.hidePanelTitles?"":input.title||_this4.savedVis.title;savedObjectId=input.savedObjectId;_this4.updateOutput(embeddable_objectSpread(embeddable_objectSpread({},_this4.getOutput()),{},{defaultTitle:_this4.savedVis.title,title:title,editPath:Object(common["getEditPath"])(savedObjectId),editUrl:_this4.deps.basePath.prepend("/app/lens".concat(Object(common["getEditPath"])(savedObjectId))),indexPatterns:indexPatterns}));case 10:case"end":return _context6.stop()}}),_callee6)})))()}getDescription(){return this.savedVis&&this.savedVis.description}destroy(){super.destroy();if(this.domNode){Object(external_kbnSharedDeps_ReactDom_["unmountComponentAtNode"])(this.domNode)}if(this.subscription){this.subscription.unsubscribe()}this.autoRefreshFetchSubscription.unsubscribe()}}var external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(31);var kibanaUtils_public_=__webpack_require__(11);var app=__webpack_require__(280);var share_public_=__webpack_require__(32);var savedObjects_public_=__webpack_require__(24);function getLensTopNavConfig(options){const showSaveAndReturn=options.showSaveAndReturn,showCancel=options.showCancel,actions=options.actions,savingPermitted=options.savingPermitted,enableExportToCSV=options.enableExportToCSV;const topNavMenu=[];const saveButtonLabel=options.isByValueMode?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.addToLibrary",{defaultMessage:"Save to library"}):options.showSaveAndReturn?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.saveAs",{defaultMessage:"Save as"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.save",{defaultMessage:"Save"});topNavMenu.push({label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.downloadCSV",{defaultMessage:"Download as CSV"}),run:actions.exportToCSV,testId:"lnsApp_downloadCSVButton",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.downloadButtonAriaLabel",{defaultMessage:"Download the data as CSV file"}),disableButton:!enableExportToCSV});if(showCancel){topNavMenu.push({label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.cancel",{defaultMessage:"cancel"}),run:actions.cancel,testId:"lnsApp_cancelButton",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.cancelButtonAriaLabel",{defaultMessage:"Return to the last app without saving changes"})})}topNavMenu.push({label:saveButtonLabel,iconType:!showSaveAndReturn?"save":undefined,emphasize:!showSaveAndReturn,run:actions.showSaveModal,testId:"lnsApp_saveButton",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.saveButtonAriaLabel",{defaultMessage:"Save the current lens visualization"}),disableButton:!savingPermitted});if(showSaveAndReturn){topNavMenu.push({label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.saveAndReturn",{defaultMessage:"Save and return"}),emphasize:true,iconType:"checkInCircleFilled",run:actions.saveAndReturn,testId:"lnsApp_saveAndReturnButton",disableButton:!savingPermitted,description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.saveAndReturnButtonAriaLabel",{defaultMessage:"Save the current lens visualization and return to the last app"})})}return topNavMenu}function tags_saved_object_save_modal_origin_wrapper_extends(){tags_saved_object_save_modal_origin_wrapper_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return tags_saved_object_save_modal_origin_wrapper_extends.apply(this,arguments)}function tags_saved_object_save_modal_origin_wrapper_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function tags_saved_object_save_modal_origin_wrapper_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){tags_saved_object_save_modal_origin_wrapper_ownKeys(Object(source),true).forEach((function(key){tags_saved_object_save_modal_origin_wrapper_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{tags_saved_object_save_modal_origin_wrapper_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function tags_saved_object_save_modal_origin_wrapper_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function tags_saved_object_save_modal_origin_wrapper_slicedToArray(arr,i){return tags_saved_object_save_modal_origin_wrapper_arrayWithHoles(arr)||tags_saved_object_save_modal_origin_wrapper_iterableToArrayLimit(arr,i)||tags_saved_object_save_modal_origin_wrapper_unsupportedIterableToArray(arr,i)||tags_saved_object_save_modal_origin_wrapper_nonIterableRest()}function tags_saved_object_save_modal_origin_wrapper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tags_saved_object_save_modal_origin_wrapper_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return tags_saved_object_save_modal_origin_wrapper_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tags_saved_object_save_modal_origin_wrapper_arrayLikeToArray(o,minLen)}function tags_saved_object_save_modal_origin_wrapper_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function tags_saved_object_save_modal_origin_wrapper_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function tags_saved_object_save_modal_origin_wrapper_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function tags_saved_object_save_modal_origin_wrapper_objectWithoutProperties(source,excluded){if(source==null)return{};var target=tags_saved_object_save_modal_origin_wrapper_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function tags_saved_object_save_modal_origin_wrapper_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const TagEnhancedSavedObjectSaveModalOrigin=_ref=>{let initialTags=_ref.initialTags,onSave=_ref.onSave,savedObjectsTagging=_ref.savedObjectsTagging,options=_ref.options,otherProps=tags_saved_object_save_modal_origin_wrapper_objectWithoutProperties(_ref,["initialTags","onSave","savedObjectsTagging","options"]);const _useState=Object(external_kbnSharedDeps_React_["useState"])(initialTags),_useState2=tags_saved_object_save_modal_origin_wrapper_slicedToArray(_useState,2),selectedTags=_useState2[0],setSelectedTags=_useState2[1];const tagSelectorOption=Object(external_kbnSharedDeps_React_["useMemo"])(()=>savedObjectsTagging?external_kbnSharedDeps_React_default.a.createElement(savedObjectsTagging.ui.components.SavedObjectSaveModalTagSelector,{initialSelection:initialTags,onTagsSelected:setSelectedTags}):undefined,[savedObjectsTagging,initialTags]);const tagEnhancedOptions=typeof options==="function"?state=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,tagSelectorOption,options(state)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,tagSelectorOption,options);const tagEnhancedOnSave=Object(external_kbnSharedDeps_React_["useCallback"])(saveOptions=>{onSave(tags_saved_object_save_modal_origin_wrapper_objectSpread(tags_saved_object_save_modal_origin_wrapper_objectSpread({},saveOptions),{},{newTags:selectedTags}))},[onSave,selectedTags]);return external_kbnSharedDeps_React_default.a.createElement(savedObjects_public_["SavedObjectSaveModalOrigin"],tags_saved_object_save_modal_origin_wrapper_extends({},otherProps,{onSave:tagEnhancedOnSave,options:tagEnhancedOptions}))};function app_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function app_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){app_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){app_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function app_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function app_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){app_ownKeys(Object(source),true).forEach((function(key){app_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{app_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function app_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function app_slicedToArray(arr,i){return app_arrayWithHoles(arr)||app_iterableToArrayLimit(arr,i)||app_unsupportedIterableToArray(arr,i)||app_nonIterableRest()}function app_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function app_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return app_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return app_arrayLikeToArray(o,minLen)}function app_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function app_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function app_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function App({history:history,onAppLeave:onAppLeave,redirectTo:redirectTo,editorFrame:editorFrame,initialInput:initialInput,incomingState:incomingState,redirectToOrigin:redirectToOrigin,setHeaderActionMenu:setHeaderActionMenu,initialContext:initialContext}){var _state$persistedDoc3,_state$persistedDoc4;const _useKibana$services=Object(kibanaReact_public_["useKibana"])().services,data=_useKibana$services.data,chrome=_useKibana$services.chrome,overlays=_useKibana$services.overlays,navigation=_useKibana$services.navigation,uiSettings=_useKibana$services.uiSettings,application=_useKibana$services.application,notifications=_useKibana$services.notifications,attributeService=_useKibana$services.attributeService,savedObjectsClient=_useKibana$services.savedObjectsClient,savedObjectsTagging=_useKibana$services.savedObjectsTagging,getOriginatingAppName=_useKibana$services.getOriginatingAppName,dashboardFeatureFlag=_useKibana$services.dashboardFeatureFlag;const _useState=Object(external_kbnSharedDeps_React_["useState"])(()=>{const currentRange=data.query.timefilter.timefilter.getTime();return{query:data.query.queryString.getQuery(),filters:!initialContext?data.query.filterManager.getGlobalFilters():data.query.filterManager.getFilters(),isLoading:Boolean(initialInput),indexPatternsForTopNav:[],dateRange:{fromDate:currentRange.from,toDate:currentRange.to},isLinkedToOriginatingApp:Boolean(incomingState===null||incomingState===void 0?void 0:incomingState.originatingApp),isSaveModalVisible:false,indicateNoData:false,isSaveable:false}}),_useState2=app_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];const lastKnownDoc=state.lastKnownDoc;const showNoDataPopover=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setState(prevState=>app_objectSpread(app_objectSpread({},prevState),{},{indicateNoData:true}))},[setState]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(state.indicateNoData){setState(prevState=>app_objectSpread(app_objectSpread({},prevState),{},{indicateNoData:false}))}},[setState,state.indicateNoData,state.query,state.filters,state.dateRange,state.indexPatternsForTopNav]);const onError=Object(external_kbnSharedDeps_React_["useCallback"])(e=>notifications.toasts.addDanger({title:e.message}),[notifications.toasts]);const getLastKnownDocWithoutPinnedFilters=Object(external_kbnSharedDeps_React_["useCallback"])((function(){var _lastKnownDoc$state;if(!lastKnownDoc)return undefined;const _$partition=external_kbnSharedDeps_Lodash_default.a.partition(injectFilterReferences(((_lastKnownDoc$state=lastKnownDoc.state)===null||_lastKnownDoc$state===void 0?void 0:_lastKnownDoc$state.filters)||[],lastKnownDoc.references),public_["esFilters"].isFilterPinned),_$partition2=app_slicedToArray(_$partition,2),pinnedFilters=_$partition2[0],appFilters=_$partition2[1];return(pinnedFilters===null||pinnedFilters===void 0?void 0:pinnedFilters.length)?app_objectSpread(app_objectSpread({},lastKnownDoc),{},{state:app_objectSpread(app_objectSpread({},lastKnownDoc.state),{},{filters:appFilters})}):lastKnownDoc}),[lastKnownDoc]);const getIsByValueMode=Object(external_kbnSharedDeps_React_["useCallback"])(()=>Boolean(dashboardFeatureFlag.allowByValueEmbeddables&&state.isLinkedToOriginatingApp&&!(initialInput===null||initialInput===void 0?void 0:initialInput.savedObjectId)),[dashboardFeatureFlag.allowByValueEmbeddables,state.isLinkedToOriginatingApp,initialInput]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!initialContext){data.query.filterManager.setAppFilters([])}const filterSubscription=data.query.filterManager.getUpdates$().subscribe({next:()=>{setState(s=>app_objectSpread(app_objectSpread({},s),{},{filters:data.query.filterManager.getFilters()}));factory_trackUiEvent("app_filters_updated")}});const timeSubscription=data.query.timefilter.timefilter.getTimeUpdate$().subscribe({next:()=>{const currentRange=data.query.timefilter.timefilter.getTime();setState(s=>app_objectSpread(app_objectSpread({},s),{},{dateRange:{fromDate:currentRange.from,toDate:currentRange.to}}))}});const kbnUrlStateStorage=Object(kibanaUtils_public_["createKbnUrlStateStorage"])(app_objectSpread({history:history,useHash:uiSettings.get("state:storeInSessionStorage")},Object(kibanaUtils_public_["withNotifyOnErrors"])(notifications.toasts)));const _syncQueryStateWithUr=Object(public_["syncQueryStateWithUrl"])(data.query,kbnUrlStateStorage),stopSyncingQueryServiceStateWithUrl=_syncQueryStateWithUr.stop;return()=>{stopSyncingQueryServiceStateWithUrl();filterSubscription.unsubscribe();timeSubscription.unsubscribe()}},[data.query.filterManager,data.query.timefilter.timefilter,notifications.toasts,uiSettings,data.query,history,initialContext]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{onAppLeave(actions=>{var _state$persistedDoc,_getLastKnownDocWitho;if(application.capabilities.visualize.save&&!external_kbnSharedDeps_Lodash_default.a.isEqual((_state$persistedDoc=state.persistedDoc)===null||_state$persistedDoc===void 0?void 0:_state$persistedDoc.state,(_getLastKnownDocWitho=getLastKnownDocWithoutPinnedFilters())===null||_getLastKnownDocWitho===void 0?void 0:_getLastKnownDocWitho.state)&&(state.isSaveable||state.persistedDoc)){return actions.confirm(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.unsavedWorkMessage",{defaultMessage:"Leave Lens with unsaved work?"}),external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.unsavedWorkTitle",{defaultMessage:"Unsaved changes"}))}else{return actions.default()}})},[onAppLeave,lastKnownDoc,state.isSaveable,state.persistedDoc,getLastKnownDocWithoutPinnedFilters,application.capabilities.visualize.save]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const isByValueMode=getIsByValueMode();const breadcrumbs=[];if(state.isLinkedToOriginatingApp&&getOriginatingAppName()&&redirectToOrigin){breadcrumbs.push({onClick:()=>{redirectToOrigin()},text:getOriginatingAppName()})}if(!isByValueMode){breadcrumbs.push({href:application.getUrlForApp("visualize"),onClick:e=>{application.navigateToApp("visualize",{path:"/"});e.preventDefault()},text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.breadcrumbsTitle",{defaultMessage:"Visualize"})})}let currentDocTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.breadcrumbsCreate",{defaultMessage:"Create"});if(state.persistedDoc){currentDocTitle=isByValueMode?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.breadcrumbsByValue",{defaultMessage:"Edit visualization"}):state.persistedDoc.title}breadcrumbs.push({text:currentDocTitle});chrome.setBreadcrumbs(breadcrumbs)},[dashboardFeatureFlag.allowByValueEmbeddables,state.isLinkedToOriginatingApp,getOriginatingAppName,state.persistedDoc,redirectToOrigin,getIsByValueMode,initialInput,application,chrome]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{var _state$persistedDoc2;if(!initialInput||attributeService.inputIsRefType(initialInput)&&initialInput.savedObjectId===((_state$persistedDoc2=state.persistedDoc)===null||_state$persistedDoc2===void 0?void 0:_state$persistedDoc2.savedObjectId)){return}setState(s=>app_objectSpread(app_objectSpread({},s),{},{isLoading:true}));attributeService.unwrapAttributes(initialInput).then(attributes=>{if(!initialInput){return}const doc=app_objectSpread(app_objectSpread(app_objectSpread({},initialInput),attributes),{},{type:common["LENS_EMBEDDABLE_TYPE"]});if(attributeService.inputIsRefType(initialInput)){chrome.recentlyAccessed.add(Object(common["getFullPath"])(initialInput.savedObjectId),attributes.title,initialInput.savedObjectId)}getAllIndexPatterns(external_kbnSharedDeps_Lodash_default.a.uniq(doc.references.filter(({type:type})=>type==="index-pattern").map(({id:id})=>id)),data.indexPatterns,notifications).then(indexPatterns=>{data.query.filterManager.setAppFilters(injectFilterReferences(doc.state.filters,doc.references));setState(s=>app_objectSpread(app_objectSpread({},s),{},{isLoading:false,persistedDoc:doc,lastKnownDoc:doc,query:doc.state.query,indexPatternsForTopNav:indexPatterns}))}).catch(e=>{setState(s=>app_objectSpread(app_objectSpread({},s),{},{isLoading:false}));redirectTo()})}).catch(e=>{setState(s=>app_objectSpread(app_objectSpread({},s),{},{isLoading:false}));notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.docLoadingError",{defaultMessage:"Error loading saved document"}));redirectTo()})},[notifications,data.indexPatterns,data.query.filterManager,initialInput,attributeService,redirectTo,chrome.recentlyAccessed,(_state$persistedDoc3=state.persistedDoc)===null||_state$persistedDoc3===void 0?void 0:_state$persistedDoc3.savedObjectId,(_state$persistedDoc4=state.persistedDoc)===null||_state$persistedDoc4===void 0?void 0:_state$persistedDoc4.state]);const runSave=function(){var _ref=app_asyncToGenerator(regeneratorRuntime.mark((function _callee(saveProps,options){var references,docToSave,originalInput,originalSavedObjectId,newInput,newDoc;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(lastKnownDoc){_context.next=2;break}return _context.abrupt("return");case 2:references=lastKnownDoc.references;if(savedObjectsTagging&&saveProps.newTags){references=savedObjectsTagging.ui.updateTagsReferences(references,saveProps.newTags)}docToSave=app_objectSpread(app_objectSpread({},getLastKnownDocWithoutPinnedFilters()),{},{description:saveProps.newDescription,title:saveProps.newTitle,references:references});if(getIsByValueMode()){docToSave.state.filters.forEach(filter=>{if(typeof filter.meta.value==="function"){delete filter.meta.value}})}originalInput=saveProps.newCopyOnSave?undefined:initialInput;originalSavedObjectId=originalInput===null||originalInput===void 0?void 0:originalInput.savedObjectId;if(!options.saveToLibrary){_context.next=17;break}_context.prev=9;_context.next=12;return Object(savedObjects_public_["checkForDuplicateTitle"])({id:originalSavedObjectId,title:docToSave.title,copyOnSave:saveProps.newCopyOnSave,lastSavedTitle:lastKnownDoc.title,getEsType:()=>"lens",getDisplayName:()=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.saveModalType",{defaultMessage:"Lens visualization"})},saveProps.isTitleDuplicateConfirmed,saveProps.onTitleDuplicate,{savedObjectsClient:savedObjectsClient,overlays:overlays});case 12:_context.next=17;break;case 14:_context.prev=14;_context.t0=_context["catch"](9);return _context.abrupt("return");case 17:_context.prev=17;_context.next=20;return attributeService.wrapAttributes(docToSave,options.saveToLibrary,originalInput);case 20:newInput=_context.sent;if(!(saveProps.returnToOrigin&&redirectToOrigin)){_context.next=25;break}onAppLeave(actions=>actions.default());redirectToOrigin({input:newInput,isCopied:saveProps.newCopyOnSave});return _context.abrupt("return");case 25:notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.saveVisualization.successNotificationText",{defaultMessage:"Saved '{visTitle}'",values:{visTitle:docToSave.title}}));if(!(attributeService.inputIsRefType(newInput)&&newInput.savedObjectId!==originalSavedObjectId)){_context.next=31;break}chrome.recentlyAccessed.add(Object(common["getFullPath"])(newInput.savedObjectId),docToSave.title,newInput.savedObjectId);setState(s=>app_objectSpread(app_objectSpread({},s),{},{isSaveModalVisible:false,isLinkedToOriginatingApp:false}));redirectTo(newInput.savedObjectId);return _context.abrupt("return");case 31:newDoc=app_objectSpread(app_objectSpread({},docToSave),newInput);setState(s=>app_objectSpread(app_objectSpread({},s),{},{persistedDoc:newDoc,lastKnownDoc:newDoc,isSaveModalVisible:false,isLinkedToOriginatingApp:false}));_context.next=40;break;case 35:_context.prev=35;_context.t1=_context["catch"](17);console.dir(_context.t1);factory_trackUiEvent("save_failed");setState(s=>app_objectSpread(app_objectSpread({},s),{},{isSaveModalVisible:false}));case 40:case"end":return _context.stop()}}),_callee,null,[[9,14],[17,35]])})));return function runSave(_x,_x2){return _ref.apply(this,arguments)}}();const TopNavMenu=navigation.ui.TopNavMenu;const savingPermitted=Boolean(state.isSaveable&&application.capabilities.visualize.save);const unsavedTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.unsavedFilename",{defaultMessage:"unsaved"});const topNavConfig=getLensTopNavConfig({showSaveAndReturn:Boolean(state.isLinkedToOriginatingApp&&(dashboardFeatureFlag.allowByValueEmbeddables||Boolean(initialInput))),enableExportToCSV:Boolean(state.isSaveable&&state.activeData&&Object.keys(state.activeData).length),isByValueMode:getIsByValueMode(),showCancel:Boolean(state.isLinkedToOriginatingApp),savingPermitted:savingPermitted,actions:{exportToCSV:()=>{if(!state.activeData){return}const datatables=Object.values(state.activeData);const content=datatables.reduce((memo,datatable,i)=>{if(datatable){const postFix=datatables.length>1?"-".concat(i+1):"";memo["".concat((lastKnownDoc===null||lastKnownDoc===void 0?void 0:lastKnownDoc.title)||unsavedTitle).concat(postFix,".csv")]={content:public_["exporters"].datatableToCSV(datatable,{csvSeparator:uiSettings.get("csv:separator",","),quoteValues:uiSettings.get("csv:quoteValues",true),formatFactory:data.fieldFormats.deserialize}),type:public_["exporters"].CSV_MIME_TYPE}}return memo},{});if(content){Object(share_public_["downloadMultipleAs"])(content)}},saveAndReturn:()=>{if(savingPermitted&&lastKnownDoc){var _ref2;onAppLeave(actions=>actions.default());runSave({newTitle:lastKnownDoc.title,newCopyOnSave:false,isTitleDuplicateConfirmed:false,returnToOrigin:true},{saveToLibrary:(_ref2=initialInput&&attributeService.inputIsRefType(initialInput))!==null&&_ref2!==void 0?_ref2:false})}},showSaveModal:()=>{if(savingPermitted){setState(s=>app_objectSpread(app_objectSpread({},s),{},{isSaveModalVisible:true}))}},cancel:()=>{if(redirectToOrigin){redirectToOrigin()}}}});const tagsIds=state.persistedDoc&&savedObjectsTagging?savedObjectsTagging.ui.getTagIdsFromReferences(state.persistedDoc.references):[];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsApp"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"lnsApp__header"},external_kbnSharedDeps_React_default.a.createElement(TopNavMenu,{setMenuMountPoint:setHeaderActionMenu,config:topNavConfig,showSearchBar:true,showDatePicker:true,showQueryBar:true,showFilterBar:true,indexPatterns:state.indexPatternsForTopNav,showSaveQuery:Boolean(application.capabilities.visualize.saveQuery),savedQuery:state.savedQuery,"data-test-subj":"lnsApp_topNav",screenTitle:"lens",appName:"lens",onQuerySubmit:payload=>{const dateRange=payload.dateRange,query=payload.query;if(dateRange.from!==state.dateRange.fromDate||dateRange.to!==state.dateRange.toDate){data.query.timefilter.timefilter.setTime(dateRange);factory_trackUiEvent("app_date_change")}else{factory_trackUiEvent("app_query_change")}setState(s=>app_objectSpread(app_objectSpread({},s),{},{dateRange:{fromDate:dateRange.from,toDate:dateRange.to},query:query||s.query}))},onSaved:savedQuery=>{setState(s=>app_objectSpread(app_objectSpread({},s),{},{savedQuery:savedQuery}))},onSavedQueryUpdated:savedQuery=>{const savedQueryFilters=savedQuery.attributes.filters||[];const globalFilters=data.query.filterManager.getGlobalFilters();data.query.filterManager.setFilters([...globalFilters,...savedQueryFilters]);setState(s=>app_objectSpread(app_objectSpread({},s),{},{savedQuery:app_objectSpread({},savedQuery),dateRange:savedQuery.attributes.timefilter?{fromDate:savedQuery.attributes.timefilter.from,toDate:savedQuery.attributes.timefilter.to}:s.dateRange}))},onClearSavedQuery:()=>{data.query.filterManager.setFilters(data.query.filterManager.getGlobalFilters());setState(s=>app_objectSpread(app_objectSpread({},s),{},{savedQuery:undefined,filters:data.query.filterManager.getGlobalFilters(),query:data.query.queryString.getDefaultQuery()}))},query:state.query,dateRangeFrom:state.dateRange.fromDate,dateRangeTo:state.dateRange.toDate,indicateNoData:state.indicateNoData})),(!state.isLoading||state.persistedDoc)&&external_kbnSharedDeps_React_default.a.createElement(NativeRenderer,{className:"lnsApp__frame",render:editorFrame.mount,nativeProps:{dateRange:state.dateRange,query:state.query,filters:state.filters,savedQuery:state.savedQuery,doc:state.persistedDoc,onError:onError,showNoDataPopover:showNoDataPopover,initialContext:initialContext,onChange:({filterableIndexPatterns:filterableIndexPatterns,doc:doc,isSaveable:isSaveable,activeData:activeData})=>{if(isSaveable!==state.isSaveable){setState(s=>app_objectSpread(app_objectSpread({},s),{},{isSaveable:isSaveable}))}if(!external_kbnSharedDeps_Lodash_default.a.isEqual(state.persistedDoc,doc)){setState(s=>app_objectSpread(app_objectSpread({},s),{},{lastKnownDoc:doc}))}if(!external_kbnSharedDeps_Lodash_default.a.isEqual(state.activeData,activeData)){setState(s=>app_objectSpread(app_objectSpread({},s),{},{activeData:activeData}))}if(state.indexPatternsForTopNav.length!==filterableIndexPatterns.length||filterableIndexPatterns.some(id=>!state.indexPatternsForTopNav.find(indexPattern=>indexPattern.id===id))){getAllIndexPatterns(filterableIndexPatterns,data.indexPatterns,notifications).then(indexPatterns=>{if(indexPatterns){setState(s=>app_objectSpread(app_objectSpread({},s),{},{indexPatternsForTopNav:indexPatterns}))}})}}}})),lastKnownDoc&&state.isSaveModalVisible&&external_kbnSharedDeps_React_default.a.createElement(TagEnhancedSavedObjectSaveModalOrigin,{savedObjectsTagging:savedObjectsTagging,initialTags:tagsIds,originatingApp:incomingState===null||incomingState===void 0?void 0:incomingState.originatingApp,onSave:props=>runSave(props,{saveToLibrary:true}),onClose:()=>{setState(s=>app_objectSpread(app_objectSpread({},s),{},{isSaveModalVisible:false}))},getAppNameFromId:()=>getOriginatingAppName(),documentInfo:{id:lastKnownDoc.savedObjectId,title:lastKnownDoc.title||"",description:lastKnownDoc.description||""},returnToOriginSwitchLabel:getIsByValueMode()&&initialInput?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.updatePanel",{defaultMessage:"Update panel on {originatingAppName}",values:{originatingAppName:getOriginatingAppName()}}):undefined,objectType:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.saveModalType",{defaultMessage:"Lens visualization"}),"data-test-subj":"lnsApp_saveModalOrigin"}))}function getAllIndexPatterns(_x3,_x4,_x5){return _getAllIndexPatterns.apply(this,arguments)}function _getAllIndexPatterns(){_getAllIndexPatterns=app_asyncToGenerator(regeneratorRuntime.mark((function _callee2(ids,indexPatternsService,notifications){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return Promise.all(ids.map(id=>indexPatternsService.get(id)));case 3:return _context2.abrupt("return",_context2.sent);case 6:_context2.prev=6;_context2.t0=_context2["catch"](0);notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.app.indexPatternLoadingError",{defaultMessage:"Error loading index patterns"}));throw new Error(_context2.t0);case 10:case"end":return _context2.stop()}}),_callee2,null,[[0,6]])})));return _getAllIndexPatterns.apply(this,arguments)}function addHelpMenuToAppChrome(chrome,docLinks){chrome.setHelpExtension({appName:"Lens",links:[{linkType:"documentation",href:"".concat(docLinks.ELASTIC_WEBSITE_URL,"guide/en/kibana/").concat(docLinks.DOC_LINK_VERSION,"/lens.html")},{linkType:"github",title:"[Lens]",labels:["Feature:Lens"]}]})}var uiActions_public_=__webpack_require__(2);function mounter_slicedToArray(arr,i){return mounter_arrayWithHoles(arr)||mounter_iterableToArrayLimit(arr,i)||mounter_unsupportedIterableToArray(arr,i)||mounter_nonIterableRest()}function mounter_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mounter_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return mounter_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mounter_arrayLikeToArray(o,minLen)}function mounter_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function mounter_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function mounter_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function mounter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function mounter_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){mounter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){mounter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function mountApp(_x,_x2,_x3){return _mountApp.apply(this,arguments)}function _mountApp(){_mountApp=mounter_asyncToGenerator(regeneratorRuntime.mark((function _callee(core,params,mountProps){var createEditorFrame,getByValueFeatureFlag,attributeService,_yield$core$getStartS,_yield$core$getStartS2,coreStart,startDependencies,data,navigation,embeddable,savedObjectsTagging,instance,storage,stateTransfer,historyLocationState,embeddableEditorIncomingState,lensServices,getInitialInput,_redirectTo,redirectToOrigin,renderEditor,NotFound,unlistenParentHistory;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:NotFound=function _NotFound(){factory_trackUiEvent("loaded_404");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.lens.app404",defaultMessage:"404 Not Found"})};createEditorFrame=mountProps.createEditorFrame,getByValueFeatureFlag=mountProps.getByValueFeatureFlag,attributeService=mountProps.attributeService;_context.next=4;return core.getStartServices();case 4:_yield$core$getStartS=_context.sent;_yield$core$getStartS2=mounter_slicedToArray(_yield$core$getStartS,2);coreStart=_yield$core$getStartS2[0];startDependencies=_yield$core$getStartS2[1];data=startDependencies.data,navigation=startDependencies.navigation,embeddable=startDependencies.embeddable,savedObjectsTagging=startDependencies.savedObjectsTagging;_context.next=11;return createEditorFrame();case 11:instance=_context.sent;storage=new kibanaUtils_public_["Storage"](localStorage);stateTransfer=embeddable===null||embeddable===void 0?void 0:embeddable.getStateTransfer(params.history);historyLocationState=params.history.location.state;embeddableEditorIncomingState=stateTransfer===null||stateTransfer===void 0?void 0:stateTransfer.getIncomingEditorState();_context.t0=data;_context.t1=storage;_context.t2=navigation;_context.t3=savedObjectsTagging;_context.next=22;return attributeService();case 22:_context.t4=_context.sent;_context.t5=coreStart.http;_context.t6=coreStart.chrome;_context.t7=coreStart.overlays;_context.t8=coreStart.uiSettings;_context.t9=coreStart.application;_context.t10=coreStart.notifications;_context.t11=coreStart.savedObjects.client;_context.t12=()=>(embeddableEditorIncomingState===null||embeddableEditorIncomingState===void 0?void 0:embeddableEditorIncomingState.originatingApp)?stateTransfer===null||stateTransfer===void 0?void 0:stateTransfer.getAppNameFromId(embeddableEditorIncomingState.originatingApp):undefined;_context.next=33;return getByValueFeatureFlag();case 33:_context.t13=_context.sent;lensServices={data:_context.t0,storage:_context.t1,navigation:_context.t2,savedObjectsTagging:_context.t3,attributeService:_context.t4,http:_context.t5,chrome:_context.t6,overlays:_context.t7,uiSettings:_context.t8,application:_context.t9,notifications:_context.t10,savedObjectsClient:_context.t11,getOriginatingAppName:_context.t12,dashboardFeatureFlag:_context.t13};addHelpMenuToAppChrome(coreStart.chrome,coreStart.docLinks);coreStart.chrome.docTitle.change(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.pageTitle",{defaultMessage:"Lens"}));setReportManager(new factory_LensReportManager({http:core.http,storage:storage}));getInitialInput=routeProps=>{if(routeProps.match.params.id){return{savedObjectId:routeProps.match.params.id}}if(embeddableEditorIncomingState===null||embeddableEditorIncomingState===void 0?void 0:embeddableEditorIncomingState.valueInput){return embeddableEditorIncomingState===null||embeddableEditorIncomingState===void 0?void 0:embeddableEditorIncomingState.valueInput}};_redirectTo=(routeProps,savedObjectId)=>{if(!savedObjectId){routeProps.history.push({pathname:"/",search:routeProps.history.location.search})}else{routeProps.history.push({pathname:"/edit/".concat(savedObjectId),search:routeProps.history.location.search})}};redirectToOrigin=props=>{if(!(embeddableEditorIncomingState===null||embeddableEditorIncomingState===void 0?void 0:embeddableEditorIncomingState.originatingApp)){throw new Error("redirectToOrigin called without an originating app")}if(stateTransfer&&(props===null||props===void 0?void 0:props.input)){const input=props.input,isCopied=props.isCopied;stateTransfer.navigateToWithEmbeddablePackage(embeddableEditorIncomingState===null||embeddableEditorIncomingState===void 0?void 0:embeddableEditorIncomingState.originatingApp,{state:{embeddableId:isCopied?undefined:embeddableEditorIncomingState.embeddableId,type:common["LENS_EMBEDDABLE_TYPE"],input:input}})}else{coreStart.application.navigateToApp(embeddableEditorIncomingState===null||embeddableEditorIncomingState===void 0?void 0:embeddableEditorIncomingState.originatingApp)}};renderEditor=routeProps=>{factory_trackUiEvent("loaded");return external_kbnSharedDeps_React_default.a.createElement(App,{incomingState:embeddableEditorIncomingState,editorFrame:instance,initialInput:getInitialInput(routeProps),redirectTo:savedObjectId=>_redirectTo(routeProps,savedObjectId),redirectToOrigin:redirectToOrigin,onAppLeave:params.onAppLeave,setHeaderActionMenu:params.setHeaderActionMenu,history:routeProps.history,initialContext:historyLocationState&&historyLocationState.type===uiActions_public_["ACTION_VISUALIZE_LENS_FIELD"]?historyLocationState.payload:undefined})};unlistenParentHistory=params.history.listen(()=>{window.dispatchEvent(new HashChangeEvent("hashchange"))});params.element.classList.add("lnsAppWrapper");Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["KibanaContextProvider"],{services:lensServices},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["HashRouter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:"/edit/:id",render:renderEditor}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:"/".concat(common["LENS_EDIT_BY_VALUE"]),render:renderEditor}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:"/",render:renderEditor}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",component:NotFound}))))),params.element);return _context.abrupt("return",()=>{instance.unmount();Object(external_kbnSharedDeps_ReactDom_["unmountComponentAtNode"])(params.element);unlistenParentHistory()});case 46:case"end":return _context.stop()}}),_callee)})));return _mountApp.apply(this,arguments)}function lens_attribute_service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function lens_attribute_service_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){lens_attribute_service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){lens_attribute_service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function lens_attribute_service_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function lens_attribute_service_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){lens_attribute_service_ownKeys(Object(source),true).forEach((function(key){lens_attribute_service_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{lens_attribute_service_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function lens_attribute_service_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function documentToAttributes(doc){delete doc.savedObjectId;delete doc.type;return lens_attribute_service_objectSpread({},doc)}function getLensAttributeService(core,startDependencies){const savedObjectStore=new saved_object_store_SavedObjectIndexStore(core.savedObjects.client);return startDependencies.embeddable.getAttributeService(common["DOC_TYPE"],{saveMethod:function(){var _saveMethod=lens_attribute_service_asyncToGenerator(regeneratorRuntime.mark((function _callee(attributes,savedObjectId){var savedDoc;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return savedObjectStore.save(lens_attribute_service_objectSpread(lens_attribute_service_objectSpread({},attributes),{},{savedObjectId:savedObjectId,type:common["DOC_TYPE"]}));case 2:savedDoc=_context.sent;return _context.abrupt("return",{id:savedDoc.savedObjectId});case 4:case"end":return _context.stop()}}),_callee)})));function saveMethod(_x,_x2){return _saveMethod.apply(this,arguments)}return saveMethod}(),unwrapMethod:function(){var _unwrapMethod=lens_attribute_service_asyncToGenerator(regeneratorRuntime.mark((function _callee2(savedObjectId){var attributes;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.t0=documentToAttributes;_context2.next=3;return savedObjectStore.load(savedObjectId);case 3:_context2.t1=_context2.sent;attributes=(0,_context2.t0)(_context2.t1);return _context2.abrupt("return",attributes);case 6:case"end":return _context2.stop()}}),_callee2)})));function unwrapMethod(_x3){return _unwrapMethod.apply(this,arguments)}return unwrapMethod}(),checkForDuplicateTitle:props=>{const savedObjectsClient=core.savedObjects.client;const overlays=core.overlays;return Object(savedObjects_public_["checkForDuplicateTitle"])({title:props.newTitle,copyOnSave:false,lastSavedTitle:"",getEsType:()=>common["DOC_TYPE"],getDisplayName:()=>common["DOC_TYPE"]},props.isTitleDuplicateConfirmed,props.onTitleDuplicate,{savedObjectsClient:savedObjectsClient,overlays:overlays})}})}}])]);