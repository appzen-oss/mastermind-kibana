/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */(function(modules){function webpackJsonpCallback(data){var chunkIds=data[0];var moreModules=data[1];var moduleId,chunkId,i=0,resolves=[];for(;i<chunkIds.length;i++){chunkId=chunkIds[i];if(Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]){resolves.push(installedChunks[chunkId][0])}installedChunks[chunkId]=0}for(moduleId in moreModules){if(Object.prototype.hasOwnProperty.call(moreModules,moduleId)){modules[moduleId]=moreModules[moduleId]}}if(parentJsonpFunction)parentJsonpFunction(data);while(resolves.length){resolves.shift()()}}var installedModules={};var installedChunks={0:0};function jsonpScriptSrc(chunkId){return __webpack_require__.p+"crossClusterReplication.chunk."+chunkId+".js"}function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.e=function requireEnsure(chunkId){var promises=[];var installedChunkData=installedChunks[chunkId];if(installedChunkData!==0){if(installedChunkData){promises.push(installedChunkData[2])}else{var promise=new Promise((function(resolve,reject){installedChunkData=installedChunks[chunkId]=[resolve,reject]}));promises.push(installedChunkData[2]=promise);var script=document.createElement("script");var onScriptComplete;script.charset="utf-8";script.timeout=120;if(__webpack_require__.nc){script.setAttribute("nonce",__webpack_require__.nc)}script.src=jsonpScriptSrc(chunkId);var error=new Error;onScriptComplete=function(event){script.onerror=script.onload=null;clearTimeout(timeout);var chunk=installedChunks[chunkId];if(chunk!==0){if(chunk){var errorType=event&&(event.type==="load"?"missing":event.type);var realSrc=event&&event.target&&event.target.src;error.message="Loading chunk "+chunkId+" failed.\n("+errorType+": "+realSrc+")";error.name="ChunkLoadError";error.type=errorType;error.request=realSrc;chunk[1](error)}installedChunks[chunkId]=undefined}};var timeout=setTimeout((function(){onScriptComplete({type:"timeout",target:script})}),12e4);script.onerror=script.onload=onScriptComplete;document.head.appendChild(script)}}return Promise.all(promises)};__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";__webpack_require__.oe=function(err){console.error(err);throw err};var jsonpArray=window["crossClusterReplication_bundle_jsonpfunction"]=window["crossClusterReplication_bundle_jsonpfunction"]||[];var oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback;jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;return __webpack_require__(__webpack_require__.s=12)})([function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",(function(){return PLUGIN}));__webpack_require__.d(__webpack_exports__,"f",(function(){return MANAGEMENT_ID}));__webpack_require__.d(__webpack_exports__,"d",(function(){return BASE_PATH_REMOTE_CLUSTERS}));__webpack_require__.d(__webpack_exports__,"a",(function(){return API_BASE_PATH}));__webpack_require__.d(__webpack_exports__,"c",(function(){return API_REMOTE_CLUSTERS_BASE_PATH}));__webpack_require__.d(__webpack_exports__,"b",(function(){return API_INDEX_MANAGEMENT_BASE_PATH}));__webpack_require__.d(__webpack_exports__,"e",(function(){return FOLLOWER_INDEX_ADVANCED_SETTINGS}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);const platinumLicense="platinum";const PLUGIN={ID:"crossClusterReplication",TITLE:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.crossClusterReplication.appTitle",{defaultMessage:"Cross-Cluster Replication"}),minimumLicenseType:platinumLicense};const APPS={CCR_APP:"ccr",REMOTE_CLUSTER_APP:"remote_cluster"};const MANAGEMENT_ID="cross_cluster_replication";const BASE_PATH_REMOTE_CLUSTERS="data/remote_clusters";const API_BASE_PATH="/api/cross_cluster_replication";const API_REMOTE_CLUSTERS_BASE_PATH="/api/remote_clusters";const API_INDEX_MANAGEMENT_BASE_PATH="/api/index_management";const FOLLOWER_INDEX_ADVANCED_SETTINGS={maxReadRequestOperationCount:5120,maxOutstandingReadRequests:12,maxReadRequestSize:"32mb",maxWriteRequestOperationCount:5120,maxWriteRequestSize:"9223372036854775807b",maxOutstandingWriteRequests:9,maxWriteBufferCount:2147483647,maxWriteBufferSize:"512mb",maxRetryDelay:"500ms",readPollTimeout:"1m"}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return API_STATUS}));__webpack_require__.d(__webpack_exports__,"b",(function(){return SECTIONS}));__webpack_require__.d(__webpack_exports__,"c",(function(){return UIM_APP_NAME}));__webpack_require__.d(__webpack_exports__,"o",(function(){return UIM_FOLLOWER_INDEX_LIST_LOAD}));__webpack_require__.d(__webpack_exports__,"n",(function(){return UIM_FOLLOWER_INDEX_CREATE}));__webpack_require__.d(__webpack_exports__,"w",(function(){return UIM_FOLLOWER_INDEX_UPDATE}));__webpack_require__.d(__webpack_exports__,"p",(function(){return UIM_FOLLOWER_INDEX_PAUSE}));__webpack_require__.d(__webpack_exports__,"q",(function(){return UIM_FOLLOWER_INDEX_PAUSE_MANY}));__webpack_require__.d(__webpack_exports__,"r",(function(){return UIM_FOLLOWER_INDEX_RESUME}));__webpack_require__.d(__webpack_exports__,"s",(function(){return UIM_FOLLOWER_INDEX_RESUME_MANY}));__webpack_require__.d(__webpack_exports__,"u",(function(){return UIM_FOLLOWER_INDEX_UNFOLLOW}));__webpack_require__.d(__webpack_exports__,"v",(function(){return UIM_FOLLOWER_INDEX_UNFOLLOW_MANY}));__webpack_require__.d(__webpack_exports__,"x",(function(){return UIM_FOLLOWER_INDEX_USE_ADVANCED_OPTIONS}));__webpack_require__.d(__webpack_exports__,"t",(function(){return UIM_FOLLOWER_INDEX_SHOW_DETAILS_CLICK}));__webpack_require__.d(__webpack_exports__,"g",(function(){return UIM_AUTO_FOLLOW_PATTERN_LIST_LOAD}));__webpack_require__.d(__webpack_exports__,"d",(function(){return UIM_AUTO_FOLLOW_PATTERN_CREATE}));__webpack_require__.d(__webpack_exports__,"m",(function(){return UIM_AUTO_FOLLOW_PATTERN_UPDATE}));__webpack_require__.d(__webpack_exports__,"e",(function(){return UIM_AUTO_FOLLOW_PATTERN_DELETE}));__webpack_require__.d(__webpack_exports__,"f",(function(){return UIM_AUTO_FOLLOW_PATTERN_DELETE_MANY}));__webpack_require__.d(__webpack_exports__,"h",(function(){return UIM_AUTO_FOLLOW_PATTERN_PAUSE}));__webpack_require__.d(__webpack_exports__,"i",(function(){return UIM_AUTO_FOLLOW_PATTERN_PAUSE_MANY}));__webpack_require__.d(__webpack_exports__,"j",(function(){return UIM_AUTO_FOLLOW_PATTERN_RESUME}));__webpack_require__.d(__webpack_exports__,"k",(function(){return UIM_AUTO_FOLLOW_PATTERN_RESUME_MANY}));__webpack_require__.d(__webpack_exports__,"l",(function(){return UIM_AUTO_FOLLOW_PATTERN_SHOW_DETAILS_CLICK}));const API_STATUS={IDLE:"idle",LOADING:"loading",UPDATING:"updating",SAVING:"saving",DELETING:"deleting"};const SECTIONS={AUTO_FOLLOW_PATTERN:"autoFollowPattern",FOLLOWER_INDEX:"followerIndex",REMOTE_CLUSTER:"remoteCluster",CCR_STATS:"ccrStats"};const UIM_APP_NAME="cross_cluster_replication";const UIM_FOLLOWER_INDEX_LIST_LOAD="follower_index_list_load";const UIM_FOLLOWER_INDEX_CREATE="follower_index_create";const UIM_FOLLOWER_INDEX_UPDATE="follower_index_update";const UIM_FOLLOWER_INDEX_PAUSE="follower_index_pause";const UIM_FOLLOWER_INDEX_PAUSE_MANY="follower_index_pause_many";const UIM_FOLLOWER_INDEX_RESUME="follower_index_resume";const UIM_FOLLOWER_INDEX_RESUME_MANY="follower_index_resume_many";const UIM_FOLLOWER_INDEX_UNFOLLOW="follower_index_unfollow";const UIM_FOLLOWER_INDEX_UNFOLLOW_MANY="follower_index_unfollow_many";const UIM_FOLLOWER_INDEX_USE_ADVANCED_OPTIONS="follower_index_use_advanced_options";const UIM_FOLLOWER_INDEX_SHOW_DETAILS_CLICK="follower_index_show_details_click";const UIM_AUTO_FOLLOW_PATTERN_LIST_LOAD="auto_follow_patter_list_load";const UIM_AUTO_FOLLOW_PATTERN_CREATE="auto_follow_pattern_create";const UIM_AUTO_FOLLOW_PATTERN_UPDATE="auto_follow_pattern_update";const UIM_AUTO_FOLLOW_PATTERN_DELETE="auto_follow_pattern_delete";const UIM_AUTO_FOLLOW_PATTERN_DELETE_MANY="auto_follow_pattern_delete_many";const UIM_AUTO_FOLLOW_PATTERN_PAUSE="auto_follow_pattern_pause";const UIM_AUTO_FOLLOW_PATTERN_PAUSE_MANY="auto_follow_pattern_pause_many";const UIM_AUTO_FOLLOW_PATTERN_RESUME="auto_follow_pattern_resume";const UIM_AUTO_FOLLOW_PATTERN_RESUME_MANY="auto_follow_pattern_resume_many";const UIM_AUTO_FOLLOW_PATTERN_SHOW_DETAILS_CLICK="auto_follow_pattern_show_details_click"},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return METRIC_TYPE}));__webpack_require__.d(__webpack_exports__,"c",(function(){return trackUiMetric}));__webpack_require__.d(__webpack_exports__,"b",(function(){return init}));__webpack_require__.d(__webpack_exports__,"d",(function(){return trackUserRequest}));function wrapArray(subj){return Array.isArray(subj)?subj:[subj]}class UnreachableCaseError extends Error{constructor(val){super("Unreachable case: ".concat(val))}}function createUiStatsMetric({type:type,appName:appName,eventName:eventName,count:count=1}){return{type:type,appName:appName,eventName:eventName,count:count}}var external_kbnSharedDeps_MomentTimezone_=__webpack_require__(5);var external_kbnSharedDeps_MomentTimezone_default=__webpack_require__.n(external_kbnSharedDeps_MomentTimezone_);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class application_usage_ApplicationUsage{constructor(){_defineProperty(this,"currentUsage",void 0)}start(){if(window)window.addEventListener("click",()=>this.currentUsage&&this.currentUsage.numberOfClicks++)}appChanged(appId){const currentUsage=this.currentUsage;if(appId){this.currentUsage={type:METRIC_TYPE.APPLICATION_USAGE,appId:appId,startTime:external_kbnSharedDeps_MomentTimezone_default()(),numberOfClicks:0}}else{this.currentUsage=void 0}return currentUsage}}var stats=__webpack_require__(10);function trackUsageAgent(appName){const userAgent=window&&window.navigator&&window.navigator.userAgent||"";return{type:METRIC_TYPE.USER_AGENT,appName:appName,userAgent:userAgent}}let METRIC_TYPE;(function(METRIC_TYPE){METRIC_TYPE["COUNT"]="count";METRIC_TYPE["LOADED"]="loaded";METRIC_TYPE["CLICK"]="click";METRIC_TYPE["USER_AGENT"]="user_agent";METRIC_TYPE["APPLICATION_USAGE"]="application_usage"})(METRIC_TYPE||(METRIC_TYPE={}));function storage_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class ReportStorageManager{constructor(storageKey,storage){storage_defineProperty(this,"storageKey",void 0);storage_defineProperty(this,"storage",void 0);this.storageKey=storageKey;this.storage=storage}get(){if(!this.storage)return;return this.storage.get(this.storageKey)}store(report){if(!this.storage)return;this.storage.set(this.storageKey,report)}}function report_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const REPORT_VERSION=1;class report_ReportManager{constructor(report){report_defineProperty(this,"report",void 0);this.report=report||report_ReportManager.createReport()}static createReport(){return{reportVersion:REPORT_VERSION}}clearReport(){this.report=report_ReportManager.createReport()}isReportEmpty(){const _this$report=this.report,uiStatsMetrics=_this$report.uiStatsMetrics,userAgent=_this$report.userAgent,appUsage=_this$report.application_usage;const noUiStats=!uiStatsMetrics||Object.keys(uiStatsMetrics).length===0;const noUserAgent=!userAgent||Object.keys(userAgent).length===0;const noAppUsage=!appUsage||Object.keys(appUsage).length===0;return noUiStats&&noUserAgent&&noAppUsage}incrementStats(count,stats){const _ref=stats||{},_ref$min=_ref.min,min=_ref$min===void 0?0:_ref$min,_ref$max=_ref.max,max=_ref$max===void 0?0:_ref$max,_ref$sum=_ref.sum,sum=_ref$sum===void 0?0:_ref$sum;const newMin=Math.min(min,count);const newMax=Math.max(max,count);const newAvg=newMin+newMax/2;const newSum=sum+count;return{min:newMin,max:newMax,avg:newAvg,sum:newSum}}assignReports(newMetrics){wrapArray(newMetrics).forEach(newMetric=>this.assignReport(this.report,newMetric));return{report:this.report}}static createMetricKey(metric){switch(metric.type){case METRIC_TYPE.USER_AGENT:{const appName=metric.appName,type=metric.type;return"".concat(appName,"-").concat(type)}case METRIC_TYPE.CLICK:case METRIC_TYPE.LOADED:case METRIC_TYPE.COUNT:{const appName=metric.appName,eventName=metric.eventName,type=metric.type;return"".concat(appName,"-").concat(type,"-").concat(eventName)}case METRIC_TYPE.APPLICATION_USAGE:return metric.appId;default:throw new UnreachableCaseError(metric)}}assignReport(report,metric){const key=report_ReportManager.createMetricKey(metric);switch(metric.type){case METRIC_TYPE.USER_AGENT:{const appName=metric.appName,type=metric.type,userAgent=metric.userAgent;if(userAgent){report.userAgent={[key]:{key:key,appName:appName,type:type,userAgent:metric.userAgent}}}return}case METRIC_TYPE.CLICK:case METRIC_TYPE.LOADED:case METRIC_TYPE.COUNT:{const appName=metric.appName,type=metric.type,eventName=metric.eventName,count=metric.count;report.uiStatsMetrics=report.uiStatsMetrics||{};const existingStats=(report.uiStatsMetrics[key]||{}).stats;report.uiStatsMetrics[key]={key:key,appName:appName,eventName:eventName,type:type,stats:this.incrementStats(count,existingStats)};return}case METRIC_TYPE.APPLICATION_USAGE:const numberOfClicks=metric.numberOfClicks,startTime=metric.startTime;const minutesOnScreen=external_kbnSharedDeps_MomentTimezone_default()().diff(startTime,"minutes",true);report.application_usage=report.application_usage||{};const appExistingData=report.application_usage[key]||{minutesOnScreen:0,numberOfClicks:0};report.application_usage[key]={minutesOnScreen:appExistingData.minutesOnScreen+minutesOnScreen,numberOfClicks:appExistingData.numberOfClicks+numberOfClicks};break;default:throw new UnreachableCaseError(metric)}}}report_defineProperty(report_ReportManager,"REPORT_VERSION",REPORT_VERSION);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function reporter_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class reporter_Reporter{constructor(config){var _this=this;reporter_defineProperty(this,"checkInterval",void 0);reporter_defineProperty(this,"interval",void 0);reporter_defineProperty(this,"lastAppId",void 0);reporter_defineProperty(this,"http",void 0);reporter_defineProperty(this,"reportManager",void 0);reporter_defineProperty(this,"storageManager",void 0);reporter_defineProperty(this,"applicationUsage",void 0);reporter_defineProperty(this,"debug",void 0);reporter_defineProperty(this,"retryCount",0);reporter_defineProperty(this,"maxRetries",3);reporter_defineProperty(this,"started",false);reporter_defineProperty(this,"start",()=>{if(!this.interval){this.interval=setTimeout(()=>{this.interval=undefined;this.sendReports()},this.checkInterval)}if(this.started){return}if(window&&document){window.addEventListener("beforeunload",()=>this.reportApplicationUsage());document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"&&this.lastAppId){this.reportApplicationUsage(this.lastAppId)}else if(document.visibilityState==="hidden"){this.reportApplicationUsage()}})}this.started=true;this.applicationUsage.start()});reporter_defineProperty(this,"reportUiStats",(appName,type,eventNames,count)=>{const metrics=wrapArray(eventNames).map(eventName=>{this.log("".concat(type," Metric -> (").concat(appName,":").concat(eventName,"):"));const report=createUiStatsMetric({type:type,appName:appName,eventName:eventName,count:count});this.log(report);return report});this.saveToReport(metrics)});reporter_defineProperty(this,"reportUserAgent",appName=>{this.log("Reporting user-agent.");const report=trackUsageAgent(appName);this.saveToReport([report])});reporter_defineProperty(this,"sendReports",_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var versionMismatch;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this.reportManager.isReportEmpty()){_context.next=13;break}_context.prev=1;_context.next=4;return _this.http(_this.reportManager.report);case 4:_this.flushReport();_context.next=13;break;case 7:_context.prev=7;_context.t0=_context["catch"](1);_this.log("Error Sending Metrics Report ".concat(_context.t0));_this.retryCount=_this.retryCount+1;versionMismatch=_this.reportManager.report.reportVersion!==report_ReportManager.REPORT_VERSION;if(versionMismatch||_this.retryCount>_this.maxRetries){_this.flushReport()}case 13:_this.start();case 14:case"end":return _context.stop()}}),_callee,null,[[1,7]])}))));const http=config.http,storage=config.storage,debug=config.debug,_config$checkInterval=config.checkInterval,checkInterval=_config$checkInterval===void 0?9e4:_config$checkInterval,_config$storageKey=config.storageKey,storageKey=_config$storageKey===void 0?"analytics":_config$storageKey;this.http=http;this.checkInterval=checkInterval;this.applicationUsage=new application_usage_ApplicationUsage;this.storageManager=new ReportStorageManager(storageKey,storage);const storedReport=this.storageManager.get();this.reportManager=new report_ReportManager(storedReport);this.debug=!!debug}saveToReport(newMetrics){this.reportManager.assignReports(newMetrics);this.storageManager.store(this.reportManager.report)}flushReport(){this.retryCount=0;this.reportManager.clearReport();this.storageManager.store(this.reportManager.report)}log(message){if(this.debug){console.debug(message)}}reportApplicationUsage(appId){this.log("Reporting application changed to ".concat(appId));this.lastAppId=appId||this.lastAppId;const appChangedReport=this.applicationUsage.appChanged(appId);if(appChangedReport)this.saveToReport([appChangedReport])}}var constants=__webpack_require__(1);let trackUiMetric=(metricType,eventName)=>{};function init(usageCollection){trackUiMetric=usageCollection.reportUiStats.bind(usageCollection,constants["c"])}function trackUserRequest(request,actionType){return request.then(response=>{trackUiMetric(METRIC_TYPE.LOADED,actionType);return response})}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return arrify}));const arrify=val=>Array.isArray(val)?val:[val];const wait=(time=1e3)=>data=>new Promise(resolve=>{setTimeout(()=>resolve(data),time)});const removeEmptyFields=body=>Object.entries(body).reduce((acc,[key,value])=>{if(value!==""){acc[key]=value}return acc},{})},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,exports){module.exports=__kbnSharedDeps__.MomentTimezone},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return getSettingDefault}));__webpack_require__.d(__webpack_exports__,"a",(function(){return areAllSettingsDefault}));var _common_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);const getSettingDefault=name=>{if(!_common_constants__WEBPACK_IMPORTED_MODULE_0__["e"][name]){throw new Error("Unknown setting ".concat(name))}return _common_constants__WEBPACK_IMPORTED_MODULE_0__["e"][name]};const isSettingDefault=(name,value)=>getSettingDefault(name)===value;const areAllSettingsDefault=settings=>Object.keys(_common_constants__WEBPACK_IMPORTED_MODULE_0__["e"]).every(name=>isSettingDefault(name,settings[name]))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"p",(function(){return setHttpClient}));__webpack_require__.d(__webpack_exports__,"f",(function(){return loadAutoFollowPatterns}));__webpack_require__.d(__webpack_exports__,"d",(function(){return getAutoFollowPattern}));__webpack_require__.d(__webpack_exports__,"k",(function(){return loadRemoteClusters}));__webpack_require__.d(__webpack_exports__,"a",(function(){return createAutoFollowPattern}));__webpack_require__.d(__webpack_exports__,"r",(function(){return updateAutoFollowPattern}));__webpack_require__.d(__webpack_exports__,"c",(function(){return deleteAutoFollowPattern}));__webpack_require__.d(__webpack_exports__,"l",(function(){return pauseAutoFollowPattern}));__webpack_require__.d(__webpack_exports__,"n",(function(){return resumeAutoFollowPattern}));__webpack_require__.d(__webpack_exports__,"h",(function(){return loadFollowerIndices}));__webpack_require__.d(__webpack_exports__,"e",(function(){return getFollowerIndex}));__webpack_require__.d(__webpack_exports__,"b",(function(){return createFollowerIndex}));__webpack_require__.d(__webpack_exports__,"m",(function(){return pauseFollowerIndex}));__webpack_require__.d(__webpack_exports__,"o",(function(){return resumeFollowerIndex}));__webpack_require__.d(__webpack_exports__,"q",(function(){return unfollowLeaderIndex}));__webpack_require__.d(__webpack_exports__,"s",(function(){return updateFollowerIndex}));__webpack_require__.d(__webpack_exports__,"g",(function(){return loadAutoFollowStats}));__webpack_require__.d(__webpack_exports__,"i",(function(){return loadIndices}));__webpack_require__.d(__webpack_exports__,"j",(function(){return loadPermissions}));var _common_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var _common_services_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3);var _constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1);var _track_ui_metric__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2);var _follower_index_default_settings__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6);let httpClient;function setHttpClient(client){httpClient=client}const getHttpClient=()=>httpClient;const createIdString=ids=>ids.map(id=>encodeURIComponent(id)).join(",");const loadAutoFollowPatterns=()=>httpClient.get("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/auto_follow_patterns"));const getAutoFollowPattern=id=>httpClient.get("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/auto_follow_patterns/").concat(encodeURIComponent(id)));const loadRemoteClusters=()=>httpClient.get(_common_constants__WEBPACK_IMPORTED_MODULE_0__["c"]);const createAutoFollowPattern=autoFollowPattern=>{const request=httpClient.post("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/auto_follow_patterns"),{body:JSON.stringify(autoFollowPattern)});return Object(_track_ui_metric__WEBPACK_IMPORTED_MODULE_3__["d"])(request,_constants__WEBPACK_IMPORTED_MODULE_2__["d"])};const updateAutoFollowPattern=(id,autoFollowPattern)=>{const request=httpClient.put("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/auto_follow_patterns/").concat(encodeURIComponent(id)),{body:JSON.stringify(autoFollowPattern)});return Object(_track_ui_metric__WEBPACK_IMPORTED_MODULE_3__["d"])(request,_constants__WEBPACK_IMPORTED_MODULE_2__["m"])};const deleteAutoFollowPattern=id=>{const ids=Object(_common_services_utils__WEBPACK_IMPORTED_MODULE_1__["a"])(id);const idString=ids.map(_id=>encodeURIComponent(_id)).join(",");const request=httpClient.delete("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/auto_follow_patterns/").concat(idString));const uiMetric=ids.length>1?_constants__WEBPACK_IMPORTED_MODULE_2__["f"]:_constants__WEBPACK_IMPORTED_MODULE_2__["e"];return Object(_track_ui_metric__WEBPACK_IMPORTED_MODULE_3__["d"])(request,uiMetric)};const pauseAutoFollowPattern=id=>{const ids=Object(_common_services_utils__WEBPACK_IMPORTED_MODULE_1__["a"])(id);const idString=ids.map(encodeURIComponent).join(",");const request=httpClient.post("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/auto_follow_patterns/").concat(idString,"/pause"));const uiMetric=ids.length>1?_constants__WEBPACK_IMPORTED_MODULE_2__["i"]:_constants__WEBPACK_IMPORTED_MODULE_2__["h"];return Object(_track_ui_metric__WEBPACK_IMPORTED_MODULE_3__["d"])(request,uiMetric)};const resumeAutoFollowPattern=id=>{const ids=Object(_common_services_utils__WEBPACK_IMPORTED_MODULE_1__["a"])(id);const idString=ids.map(encodeURIComponent).join(",");const request=httpClient.post("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/auto_follow_patterns/").concat(idString,"/resume"));const uiMetric=ids.length>1?_constants__WEBPACK_IMPORTED_MODULE_2__["k"]:_constants__WEBPACK_IMPORTED_MODULE_2__["j"];return Object(_track_ui_metric__WEBPACK_IMPORTED_MODULE_3__["d"])(request,uiMetric)};const loadFollowerIndices=()=>httpClient.get("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/follower_indices"));const getFollowerIndex=id=>httpClient.get("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/follower_indices/").concat(encodeURIComponent(id)));const createFollowerIndex=followerIndex=>{const uiMetrics=[_constants__WEBPACK_IMPORTED_MODULE_2__["n"]];const isUsingAdvancedSettings=!Object(_follower_index_default_settings__WEBPACK_IMPORTED_MODULE_4__["a"])(followerIndex);if(isUsingAdvancedSettings){uiMetrics.push(_constants__WEBPACK_IMPORTED_MODULE_2__["x"])}const request=httpClient.post("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/follower_indices"),{body:JSON.stringify(followerIndex)});return Object(_track_ui_metric__WEBPACK_IMPORTED_MODULE_3__["d"])(request,uiMetrics)};const pauseFollowerIndex=id=>{const ids=Object(_common_services_utils__WEBPACK_IMPORTED_MODULE_1__["a"])(id);const idString=createIdString(ids);const request=httpClient.put("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/follower_indices/").concat(idString,"/pause"));const uiMetric=ids.length>1?_constants__WEBPACK_IMPORTED_MODULE_2__["q"]:_constants__WEBPACK_IMPORTED_MODULE_2__["p"];return Object(_track_ui_metric__WEBPACK_IMPORTED_MODULE_3__["d"])(request,uiMetric)};const resumeFollowerIndex=id=>{const ids=Object(_common_services_utils__WEBPACK_IMPORTED_MODULE_1__["a"])(id);const idString=createIdString(ids);const request=httpClient.put("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/follower_indices/").concat(idString,"/resume"));const uiMetric=ids.length>1?_constants__WEBPACK_IMPORTED_MODULE_2__["s"]:_constants__WEBPACK_IMPORTED_MODULE_2__["r"];return Object(_track_ui_metric__WEBPACK_IMPORTED_MODULE_3__["d"])(request,uiMetric)};const unfollowLeaderIndex=id=>{const ids=Object(_common_services_utils__WEBPACK_IMPORTED_MODULE_1__["a"])(id);const idString=createIdString(ids);const request=httpClient.put("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/follower_indices/").concat(idString,"/unfollow"));const uiMetric=ids.length>1?_constants__WEBPACK_IMPORTED_MODULE_2__["v"]:_constants__WEBPACK_IMPORTED_MODULE_2__["u"];return Object(_track_ui_metric__WEBPACK_IMPORTED_MODULE_3__["d"])(request,uiMetric)};const updateFollowerIndex=(id,followerIndex)=>{const uiMetrics=[_constants__WEBPACK_IMPORTED_MODULE_2__["w"]];const isUsingAdvancedSettings=!Object(_follower_index_default_settings__WEBPACK_IMPORTED_MODULE_4__["a"])(followerIndex);if(isUsingAdvancedSettings){uiMetrics.push(_constants__WEBPACK_IMPORTED_MODULE_2__["x"])}const maxReadRequestOperationCount=followerIndex.maxReadRequestOperationCount,maxOutstandingReadRequests=followerIndex.maxOutstandingReadRequests,maxReadRequestSize=followerIndex.maxReadRequestSize,maxWriteRequestOperationCount=followerIndex.maxWriteRequestOperationCount,maxWriteRequestSize=followerIndex.maxWriteRequestSize,maxOutstandingWriteRequests=followerIndex.maxOutstandingWriteRequests,maxWriteBufferCount=followerIndex.maxWriteBufferCount,maxWriteBufferSize=followerIndex.maxWriteBufferSize,maxRetryDelay=followerIndex.maxRetryDelay,readPollTimeout=followerIndex.readPollTimeout;const request=httpClient.put("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/follower_indices/").concat(encodeURIComponent(id)),{body:JSON.stringify({maxReadRequestOperationCount:maxReadRequestOperationCount,maxOutstandingReadRequests:maxOutstandingReadRequests,maxReadRequestSize:maxReadRequestSize,maxWriteRequestOperationCount:maxWriteRequestOperationCount,maxWriteRequestSize:maxWriteRequestSize,maxOutstandingWriteRequests:maxOutstandingWriteRequests,maxWriteBufferCount:maxWriteBufferCount,maxWriteBufferSize:maxWriteBufferSize,maxRetryDelay:maxRetryDelay,readPollTimeout:readPollTimeout})});return Object(_track_ui_metric__WEBPACK_IMPORTED_MODULE_3__["d"])(request,uiMetrics)};const loadAutoFollowStats=()=>httpClient.get("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/stats/auto_follow"));let abortController=null;const loadIndices=()=>{if(abortController){abortController.abort();abortController=null}abortController=new AbortController;const _abortController=abortController,signal=_abortController.signal;return httpClient.get("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["b"],"/indices"),{signal:signal}).then(response=>{abortController=null;return response})};const loadPermissions=()=>httpClient.get("".concat(_common_constants__WEBPACK_IMPORTED_MODULE_0__["a"],"/permissions"))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return init}));__webpack_require__.d(__webpack_exports__,"b",(function(){return getToasts}));__webpack_require__.d(__webpack_exports__,"a",(function(){return getFatalErrors}));let _toasts;let _fatalErrors;const init=(toasts,fatalErrors)=>{_toasts=toasts;_fatalErrors=fatalErrors};const getToasts=()=>_toasts;const getFatalErrors=()=>_fatalErrors},function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,exports){},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_val_loader_dist_cjs_js_key_crossClusterReplication_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(13);var _node_modules_val_loader_dist_cjs_js_key_crossClusterReplication_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_val_loader_dist_cjs_js_key_crossClusterReplication_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__);__kbnBundles__.define("plugin/crossClusterReplication/public",__webpack_require__,14)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__["crossClusterReplication"]},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var external_kbnSharedDeps_KbnI18n_=__webpack_require__(4);var external_kbnSharedDeps_Lodash_=__webpack_require__(9);var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(11);var constants=__webpack_require__(0);var track_ui_metric=__webpack_require__(2);var notifications=__webpack_require__(8);var api=__webpack_require__(7);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}class plugin_CrossClusterReplicationPlugin{constructor(initializerContext){this.initializerContext=initializerContext}setup(coreSetup,plugins){const licensing=plugins.licensing,remoteClusters=plugins.remoteClusters,usageCollection=plugins.usageCollection,management=plugins.management,indexManagement=plugins.indexManagement;const esSection=management.sections.section.data;const http=coreSetup.http,toasts=coreSetup.notifications.toasts,fatalErrors=coreSetup.fatalErrors,getStartServices=coreSetup.getStartServices;Object(api["p"])(http);Object(track_ui_metric["b"])(usageCollection);Object(notifications["c"])(toasts,fatalErrors);const ccrApp=esSection.registerApp({id:constants["f"],title:constants["g"].TITLE,order:6,mount:function(){var _mount=_asyncToGenerator(regeneratorRuntime.mark((function _callee({element:element,setBreadcrumbs:setBreadcrumbs,history:history}){var _yield$import,mountApp,_yield$getStartServic,_yield$getStartServic2,coreStart,docTitle,I18nContext,_coreStart$docLinks,ELASTIC_WEBSITE_URL,DOC_LINK_VERSION,getUrlForApp,unmountAppCallback;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return __webpack_require__.e(1).then(__webpack_require__.bind(null,71));case 2:_yield$import=_context.sent;mountApp=_yield$import.mountApp;_context.next=6;return getStartServices();case 6:_yield$getStartServic=_context.sent;_yield$getStartServic2=_slicedToArray(_yield$getStartServic,1);coreStart=_yield$getStartServic2[0];docTitle=coreStart.chrome.docTitle,I18nContext=coreStart.i18n.Context,_coreStart$docLinks=coreStart.docLinks,ELASTIC_WEBSITE_URL=_coreStart$docLinks.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=_coreStart$docLinks.DOC_LINK_VERSION,getUrlForApp=coreStart.application.getUrlForApp;docTitle.change(constants["g"].TITLE);_context.next=13;return mountApp({element:element,setBreadcrumbs:setBreadcrumbs,I18nContext:I18nContext,ELASTIC_WEBSITE_URL:ELASTIC_WEBSITE_URL,DOC_LINK_VERSION:DOC_LINK_VERSION,history:history,getUrlForApp:getUrlForApp});case 13:unmountAppCallback=_context.sent;return _context.abrupt("return",()=>{docTitle.reset();unmountAppCallback()});case 15:case"end":return _context.stop()}}),_callee)})));function mount(_x){return _mount.apply(this,arguments)}return mount}()});licensing.license$.pipe(Object(external_kbnSharedDeps_RxjsOperators_["first"])()).toPromise().then(license=>{const licenseStatus=license.check(constants["g"].ID,constants["g"].minimumLicenseType);const isLicenseOk=licenseStatus.state==="valid";const config=this.initializerContext.config.get();const isCcrUiEnabled=config.ui.enabled&&remoteClusters.isUiEnabled;if(isLicenseOk&&isCcrUiEnabled){if(indexManagement){const propertyPath="isFollowerIndex";const followerBadgeExtension={matchIndex:index=>Object(external_kbnSharedDeps_Lodash_["get"])(index,propertyPath),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.crossClusterReplication.indexMgmtBadge.followerLabel",{defaultMessage:"Follower"}),color:"default",filterExpression:"isFollowerIndex:true"};indexManagement.extensionsService.addBadge(followerBadgeExtension)}}else{ccrApp.disable()}})}start(){}stop(){}}const public_plugin=initializerContext=>new plugin_CrossClusterReplicationPlugin(initializerContext)},function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,exports){module.exports=__kbnSharedDeps__.ReactRouterDom},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.Moment},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/indexManagement/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))}]);