/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["securitySolution_bundle_jsonpfunction"]=window["securitySolution_bundle_jsonpfunction"]||[]).push([[4],{1008:function(module,exports){module.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},1009:function(module,exports){module.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjYiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNiAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE3LjA2OTkgMTUuNTY5OUMxOC4yNzg3IDE0LjAzNzcgMTkgMTIuMTAzMSAxOSAxMEMxOSA1LjAyOTQ0IDE0Ljk3MDYgMSAxMCAxQzUuMDI5NDQgMSAxIDUuMDI5NDQgMSAxMEMxIDE0Ljk3MDYgNS4wMjk0NCAxOSAxMCAxOUMxMS43MTY1IDE5IDEzLjMyMDggMTguNTE5NSAxNC42ODU2IDE3LjY4NTZMMjAgMjNIMjQuNUwxNy4wNjk5IDE1LjU2OTlaIiBmaWxsPSJ3aGl0ZSIvPgogIDxwYXRoIGQ9Ik0xNy4wNjk5IDE1LjU2OTlMMTYuNjc3MyAxNS4yNjAyTDE2LjQwMiAxNS42MDkxTDE2LjcxNjMgMTUuOTIzNEwxNy4wNjk5IDE1LjU2OTlaTTE0LjY4NTYgMTcuNjg1NkwxNS4wMzkyIDE3LjMzMkwxNC43NjA4IDE3LjA1MzdMMTQuNDI0OSAxNy4yNTg5TDE0LjY4NTYgMTcuNjg1NlpNMjAgMjNMMTkuNjQ2NCAyMy4zNTM2TDE5Ljc5MjkgMjMuNUgyMFYyM1pNMjQuNSAyM1YyMy41SDI1LjcwNzFMMjQuODUzNiAyMi42NDY0TDI0LjUgMjNaTTE4LjUgMTBDMTguNSAxMS45ODY4IDE3LjgxOSAxMy44MTMxIDE2LjY3NzMgMTUuMjYwMkwxNy40NjI0IDE1Ljg3OTZDMTguNzM4MyAxNC4yNjIzIDE5LjUgMTIuMjE5NCAxOS41IDEwSDE4LjVaTTEwIDEuNUMxNC42OTQ0IDEuNSAxOC41IDUuMzA1NTggMTguNSAxMEgxOS41QzE5LjUgNC43NTMyOSAxNS4yNDY3IDAuNSAxMCAwLjVWMS41Wk0xLjUgMTBDMS41IDUuMzA1NTggNS4zMDU1OCAxLjUgMTAgMS41VjAuNUM0Ljc1MzI5IDAuNSAwLjUgNC43NTMyOSAwLjUgMTBIMS41Wk0xMCAxOC41QzUuMzA1NTggMTguNSAxLjUgMTQuNjk0NCAxLjUgMTBIMC41QzAuNSAxNS4yNDY3IDQuNzUzMjkgMTkuNSAxMCAxOS41VjE4LjVaTTE0LjQyNDkgMTcuMjU4OUMxMy4xMzYzIDE4LjA0NjIgMTEuNjIxOSAxOC41IDEwIDE4LjVWMTkuNUMxMS44MTExIDE5LjUgMTMuNTA1MiAxOC45OTI3IDE0Ljk0NjMgMTguMTEyM0wxNC40MjQ5IDE3LjI1ODlaTTIwLjM1MzYgMjIuNjQ2NEwxNS4wMzkyIDE3LjMzMkwxNC4zMzIgMTguMDM5MkwxOS42NDY0IDIzLjM1MzZMMjAuMzUzNiAyMi42NDY0Wk0yNC41IDIyLjVIMjBWMjMuNUgyNC41VjIyLjVaTTE2LjcxNjMgMTUuOTIzNEwyNC4xNDY0IDIzLjM1MzZMMjQuODUzNiAyMi42NDY0TDE3LjQyMzQgMTUuMjE2M0wxNi43MTYzIDE1LjkyMzRaIiBmaWxsPSJibGFjayIvPgogIDxjaXJjbGUgY3g9IjEwIiBjeT0iMTAiIHI9IjUuNSIgc3Ryb2tlPSJibGFjayIvPgogIDxwYXRoIGQ9Ik04IDExLjIxNjlWOC43ODMxTDEwIDcuNTgzMUwxMiA4Ljc4MzFWMTEuMjE2OUwxMCAxMi40MTY5TDggMTEuMjE2OVoiIHN0cm9rZT0iYmxhY2siLz4KPC9zdmc+Cg=="},1010:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var xtend=__webpack_require__(175);var unified=__webpack_require__(1011);var parse=__webpack_require__(1023);var PropTypes=__webpack_require__(274);var addListMetadata=__webpack_require__(1079);var naiveHtml=__webpack_require__(1081);var disallowNode=__webpack_require__(1082);var astToReact=__webpack_require__(1083);var wrapTableRows=__webpack_require__(1084);var getDefinitions=__webpack_require__(1085);var uriTransformer=__webpack_require__(1086);var defaultRenderers=__webpack_require__(1087);var symbols=__webpack_require__(1088);var allTypes=Object.keys(defaultRenderers);var ReactMarkdown=function ReactMarkdown(props){var src=props.source||props.children||"";var parserOptions=props.parserOptions;if(props.allowedTypes&&props.disallowedTypes){throw new Error("Only one of `allowedTypes` and `disallowedTypes` should be defined")}var renderers=xtend(defaultRenderers,props.renderers);var plugins=[[parse,parserOptions]].concat(props.plugins||[]);var parser=plugins.reduce(applyParserPlugin,unified());var rawAst=parser.parse(src);var renderProps=xtend(props,{renderers:renderers,definitions:getDefinitions(rawAst)});var astPlugins=determineAstPlugins(props);var transformedAst=parser.runSync(rawAst);var ast=astPlugins.reduce((function(node,plugin){return plugin(node,renderProps)}),transformedAst);return astToReact(ast,renderProps)};function applyParserPlugin(parser,plugin){return Array.isArray(plugin)?parser.use.apply(parser,_toConsumableArray(plugin)):parser.use(plugin)}function determineAstPlugins(props){var plugins=[wrapTableRows,addListMetadata()];var disallowedTypes=props.disallowedTypes;if(props.allowedTypes){disallowedTypes=allTypes.filter((function(type){return type!=="root"&&props.allowedTypes.indexOf(type)===-1}))}var removalMethod=props.unwrapDisallowed?"unwrap":"remove";if(disallowedTypes&&disallowedTypes.length>0){plugins.push(disallowNode.ofType(disallowedTypes,removalMethod))}if(props.allowNode){plugins.push(disallowNode.ifNotMatch(props.allowNode,removalMethod))}var renderHtml=!props.escapeHtml&&!props.skipHtml;var hasHtmlParser=(props.astPlugins||[]).some((function(item){var plugin=Array.isArray(item)?item[0]:item;return plugin.identity===symbols.HtmlParser}));if(renderHtml&&!hasHtmlParser){plugins.push(naiveHtml)}return props.astPlugins?plugins.concat(props.astPlugins):plugins}ReactMarkdown.defaultProps={renderers:{},escapeHtml:true,skipHtml:false,sourcePos:false,rawSourcePos:false,transformLinkUri:uriTransformer,astPlugins:[],plugins:[],parserOptions:{}};ReactMarkdown.propTypes={className:PropTypes.string,source:PropTypes.string,children:PropTypes.string,sourcePos:PropTypes.bool,rawSourcePos:PropTypes.bool,escapeHtml:PropTypes.bool,skipHtml:PropTypes.bool,allowNode:PropTypes.func,allowedTypes:PropTypes.arrayOf(PropTypes.oneOf(allTypes)),disallowedTypes:PropTypes.arrayOf(PropTypes.oneOf(allTypes)),transformLinkUri:PropTypes.oneOfType([PropTypes.func,PropTypes.bool]),linkTarget:PropTypes.oneOfType([PropTypes.func,PropTypes.string]),transformImageUri:PropTypes.func,astPlugins:PropTypes.arrayOf(PropTypes.func),unwrapDisallowed:PropTypes.bool,renderers:PropTypes.object,plugins:PropTypes.array,parserOptions:PropTypes.object};ReactMarkdown.types=allTypes;ReactMarkdown.renderers=defaultRenderers;ReactMarkdown.uriTransformer=uriTransformer;module.exports=ReactMarkdown},1011:function(module,exports,__webpack_require__){"use strict";var extend=__webpack_require__(1012);var bail=__webpack_require__(1013);var vfile=__webpack_require__(1014);var trough=__webpack_require__(1019);var string=__webpack_require__(1020);var func=__webpack_require__(1021);var plain=__webpack_require__(1022);module.exports=unified().freeze();var slice=[].slice;var own={}.hasOwnProperty;var pipeline=trough().use(pipelineParse).use(pipelineRun).use(pipelineStringify);function pipelineParse(p,ctx){ctx.tree=p.parse(ctx.file)}function pipelineRun(p,ctx,next){p.run(ctx.tree,ctx.file,done);function done(err,tree,file){if(err){next(err)}else{ctx.tree=tree;ctx.file=file;next()}}}function pipelineStringify(p,ctx){ctx.file.contents=p.stringify(ctx.tree,ctx.file)}function unified(){var attachers=[];var transformers=trough();var namespace={};var frozen=false;var freezeIndex=-1;processor.data=data;processor.freeze=freeze;processor.attachers=attachers;processor.use=use;processor.parse=parse;processor.stringify=stringify;processor.run=run;processor.runSync=runSync;processor.process=process;processor.processSync=processSync;return processor;function processor(){var destination=unified();var length=attachers.length;var index=-1;while(++index<length){destination.use.apply(null,attachers[index])}destination.data(extend(true,{},namespace));return destination}function freeze(){var values;var plugin;var options;var transformer;if(frozen){return processor}while(++freezeIndex<attachers.length){values=attachers[freezeIndex];plugin=values[0];options=values[1];transformer=null;if(options===false){continue}if(options===true){values[1]=undefined}transformer=plugin.apply(processor,values.slice(1));if(func(transformer)){transformers.use(transformer)}}frozen=true;freezeIndex=Infinity;return processor}function data(key,value){if(string(key)){if(arguments.length===2){assertUnfrozen("data",frozen);namespace[key]=value;return processor}return own.call(namespace,key)&&namespace[key]||null}if(key){assertUnfrozen("data",frozen);namespace=key;return processor}return namespace}function use(value){var settings;assertUnfrozen("use",frozen);if(value===null||value===undefined){}else if(func(value)){addPlugin.apply(null,arguments)}else if(typeof value==="object"){if("length"in value){addList(value)}else{addPreset(value)}}else{throw new Error("Expected usable value, not `"+value+"`")}if(settings){namespace.settings=extend(namespace.settings||{},settings)}return processor;function addPreset(result){addList(result.plugins);if(result.settings){settings=extend(settings||{},result.settings)}}function add(value){if(func(value)){addPlugin(value)}else if(typeof value==="object"){if("length"in value){addPlugin.apply(null,value)}else{addPreset(value)}}else{throw new Error("Expected usable value, not `"+value+"`")}}function addList(plugins){var length;var index;if(plugins===null||plugins===undefined){}else if(typeof plugins==="object"&&"length"in plugins){length=plugins.length;index=-1;while(++index<length){add(plugins[index])}}else{throw new Error("Expected a list of plugins, not `"+plugins+"`")}}function addPlugin(plugin,value){var entry=find(plugin);if(entry){if(plain(entry[1])&&plain(value)){value=extend(entry[1],value)}entry[1]=value}else{attachers.push(slice.call(arguments))}}}function find(plugin){var length=attachers.length;var index=-1;var entry;while(++index<length){entry=attachers[index];if(entry[0]===plugin){return entry}}}function parse(doc){var file=vfile(doc);var Parser;freeze();Parser=processor.Parser;assertParser("parse",Parser);if(newable(Parser)){return new Parser(String(file),file).parse()}return Parser(String(file),file)}function run(node,file,cb){assertNode(node);freeze();if(!cb&&func(file)){cb=file;file=null}if(!cb){return new Promise(executor)}executor(null,cb);function executor(resolve,reject){transformers.run(node,vfile(file),done);function done(err,tree,file){tree=tree||node;if(err){reject(err)}else if(resolve){resolve(tree)}else{cb(null,tree,file)}}}}function runSync(node,file){var complete=false;var result;run(node,file,done);assertDone("runSync","run",complete);return result;function done(err,tree){complete=true;bail(err);result=tree}}function stringify(node,doc){var file=vfile(doc);var Compiler;freeze();Compiler=processor.Compiler;assertCompiler("stringify",Compiler);assertNode(node);if(newable(Compiler)){return new Compiler(node,file).compile()}return Compiler(node,file)}function process(doc,cb){freeze();assertParser("process",processor.Parser);assertCompiler("process",processor.Compiler);if(!cb){return new Promise(executor)}executor(null,cb);function executor(resolve,reject){var file=vfile(doc);pipeline.run(processor,{file:file},done);function done(err){if(err){reject(err)}else if(resolve){resolve(file)}else{cb(null,file)}}}}function processSync(doc){var complete=false;var file;freeze();assertParser("processSync",processor.Parser);assertCompiler("processSync",processor.Compiler);file=vfile(doc);process(file,done);assertDone("processSync","process",complete);return file;function done(err){complete=true;bail(err)}}}function newable(value){return func(value)&&keys(value.prototype)}function keys(value){var key;for(key in value){return true}return false}function assertParser(name,Parser){if(!func(Parser)){throw new Error("Cannot `"+name+"` without `Parser`")}}function assertCompiler(name,Compiler){if(!func(Compiler)){throw new Error("Cannot `"+name+"` without `Compiler`")}}function assertUnfrozen(name,frozen){if(frozen){throw new Error("Cannot invoke `"+name+"` on a frozen processor.\n"+"Create a new processor first, by invoking it: "+"use `processor()` instead of `processor`.")}}function assertNode(node){if(!node||!string(node.type)){throw new Error("Expected node, got `"+node+"`")}}function assertDone(name,asyncName,complete){if(!complete){throw new Error("`"+name+"` finished async. Use `"+asyncName+"` instead")}}},1012:function(module,exports,__webpack_require__){"use strict";var hasOwn=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var defineProperty=Object.defineProperty;var gOPD=Object.getOwnPropertyDescriptor;var isArray=function isArray(arr){if(typeof Array.isArray==="function"){return Array.isArray(arr)}return toStr.call(arr)==="[object Array]"};var isPlainObject=function isPlainObject(obj){if(!obj||toStr.call(obj)!=="[object Object]"){return false}var hasOwnConstructor=hasOwn.call(obj,"constructor");var hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf){return false}var key;for(key in obj){}return typeof key==="undefined"||hasOwn.call(obj,key)};var setProperty=function setProperty(target,options){if(defineProperty&&options.name==="__proto__"){defineProperty(target,options.name,{enumerable:true,configurable:true,value:options.newValue,writable:true})}else{target[options.name]=options.newValue}};var getProperty=function getProperty(obj,name){if(name==="__proto__"){if(!hasOwn.call(obj,name)){return void 0}else if(gOPD){return gOPD(obj,name).value}}return obj[name]};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone;var target=arguments[0];var i=1;var length=arguments.length;var deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(target==null||typeof target!=="object"&&typeof target!=="function"){target={}}for(;i<length;++i){options=arguments[i];if(options!=null){for(name in options){src=getProperty(target,name);copy=getProperty(options,name);if(target!==copy){if(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&isArray(src)?src:[]}else{clone=src&&isPlainObject(src)?src:{}}setProperty(target,{name:name,newValue:extend(deep,clone,copy)})}else if(typeof copy!=="undefined"){setProperty(target,{name:name,newValue:copy})}}}}}return target}},1013:function(module,exports,__webpack_require__){"use strict";module.exports=bail;function bail(err){if(err){throw err}}},1014:function(module,exports,__webpack_require__){"use strict";var VMessage=__webpack_require__(1015);var VFile=__webpack_require__(1017);module.exports=VFile;var proto=VFile.prototype;proto.message=message;proto.info=info;proto.fail=fail;proto.warn=message;function message(reason,position,origin){var filePath=this.path;var message=new VMessage(reason,position,origin);if(filePath){message.name=filePath+":"+message.name;message.file=filePath}message.fatal=false;this.messages.push(message);return message}function fail(){var message=this.message.apply(this,arguments);message.fatal=true;throw message}function info(){var message=this.message.apply(this,arguments);message.fatal=null;return message}},1015:function(module,exports,__webpack_require__){"use strict";var stringify=__webpack_require__(1016);module.exports=VMessage;function VMessagePrototype(){}VMessagePrototype.prototype=Error.prototype;VMessage.prototype=new VMessagePrototype;var proto=VMessage.prototype;proto.file="";proto.name="";proto.reason="";proto.message="";proto.stack="";proto.fatal=null;proto.column=null;proto.line=null;function VMessage(reason,position,origin){var parts;var range;var location;if(typeof position==="string"){origin=position;position=null}parts=parseOrigin(origin);range=stringify(position)||"1:1";location={start:{line:null,column:null},end:{line:null,column:null}};if(position&&position.position){position=position.position}if(position){if(position.start){location=position;position=position.start}else{location.start=position}}if(reason.stack){this.stack=reason.stack;reason=reason.message}this.message=reason;this.name=range;this.reason=reason;this.line=position?position.line:null;this.column=position?position.column:null;this.location=location;this.source=parts[0];this.ruleId=parts[1]}function parseOrigin(origin){var result=[null,null];var index;if(typeof origin==="string"){index=origin.indexOf(":");if(index===-1){result[1]=origin}else{result[0]=origin.slice(0,index);result[1]=origin.slice(index+1)}}return result}},1016:function(module,exports,__webpack_require__){"use strict";var own={}.hasOwnProperty;module.exports=stringify;function stringify(value){if(!value||typeof value!=="object"){return null}if(own.call(value,"position")||own.call(value,"type")){return location(value.position)}if(own.call(value,"start")||own.call(value,"end")){return location(value)}if(own.call(value,"line")||own.call(value,"column")){return position(value)}return null}function position(pos){if(!pos||typeof pos!=="object"){pos={}}return index(pos.line)+":"+index(pos.column)}function location(loc){if(!loc||typeof loc!=="object"){loc={}}return position(loc.start)+"-"+position(loc.end)}function index(value){return value&&typeof value==="number"?value:1}},1017:function(module,exports,__webpack_require__){"use strict";(function(process){var path=__webpack_require__(431);var replace=__webpack_require__(1018);var buffer=__webpack_require__(634);module.exports=VFile;var own={}.hasOwnProperty;var proto=VFile.prototype;proto.toString=toString;var order=["history","path","basename","stem","extname","dirname"];function VFile(options){var prop;var index;var length;if(!options){options={}}else if(typeof options==="string"||buffer(options)){options={contents:options}}else if("message"in options&&"messages"in options){return options}if(!(this instanceof VFile)){return new VFile(options)}this.data={};this.messages=[];this.history=[];this.cwd=process.cwd();index=-1;length=order.length;while(++index<length){prop=order[index];if(own.call(options,prop)){this[prop]=options[prop]}}for(prop in options){if(order.indexOf(prop)===-1){this[prop]=options[prop]}}}Object.defineProperty(proto,"path",{get:function(){return this.history[this.history.length-1]},set:function(path){assertNonEmpty(path,"path");if(path!==this.path){this.history.push(path)}}});Object.defineProperty(proto,"dirname",{get:function(){return typeof this.path==="string"?path.dirname(this.path):undefined},set:function(dirname){assertPath(this.path,"dirname");this.path=path.join(dirname||"",this.basename)}});Object.defineProperty(proto,"basename",{get:function(){return typeof this.path==="string"?path.basename(this.path):undefined},set:function(basename){assertNonEmpty(basename,"basename");assertPart(basename,"basename");this.path=path.join(this.dirname||"",basename)}});Object.defineProperty(proto,"extname",{get:function(){return typeof this.path==="string"?path.extname(this.path):undefined},set:function(extname){var ext=extname||"";assertPart(ext,"extname");assertPath(this.path,"extname");if(ext){if(ext.charAt(0)!=="."){throw new Error("`extname` must start with `.`")}if(ext.indexOf(".",1)!==-1){throw new Error("`extname` cannot contain multiple dots")}}this.path=replace(this.path,ext)}});Object.defineProperty(proto,"stem",{get:function(){return typeof this.path==="string"?path.basename(this.path,this.extname):undefined},set:function(stem){assertNonEmpty(stem,"stem");assertPart(stem,"stem");this.path=path.join(this.dirname||"",stem+(this.extname||""))}});function toString(encoding){var value=this.contents||"";return buffer(value)?value.toString(encoding):String(value)}function assertPart(part,name){if(part.indexOf(path.sep)!==-1){throw new Error("`"+name+"` cannot be a path: did not expect `"+path.sep+"`")}}function assertNonEmpty(part,name){if(!part){throw new Error("`"+name+"` cannot be empty")}}function assertPath(path,name){if(!path){throw new Error("Setting `"+name+"` requires `path` to be set too")}}}).call(this,__webpack_require__(180))},1018:function(module,exports,__webpack_require__){"use strict";var path=__webpack_require__(431);function replaceExt(npath,ext){if(typeof npath!=="string"){return npath}if(npath.length===0){return npath}var nFileName=path.basename(npath,path.extname(npath))+ext;return path.join(path.dirname(npath),nFileName)}module.exports=replaceExt},1019:function(module,exports,__webpack_require__){"use strict";module.exports=trough;var slice=[].slice;function trough(){var fns=[];var middleware={};middleware.run=run;middleware.use=use;return middleware;function run(){var index=-1;var input=slice.call(arguments,0,-1);var done=arguments[arguments.length-1];if(typeof done!=="function"){throw new Error("Expected function as last argument, not "+done)}next.apply(null,[null].concat(input));function next(err){var fn=fns[++index];var params=slice.call(arguments,0);var values=params.slice(1);var length=input.length;var pos=-1;if(err){done(err);return}while(++pos<length){if(values[pos]===null||values[pos]===undefined){values[pos]=input[pos]}}input=values;if(fn){wrap(fn,next).apply(null,input)}else{done.apply(null,[null].concat(input))}}}function use(fn){if(typeof fn!=="function"){throw new Error("Expected `fn` to be a function, not "+fn)}fns.push(fn);return middleware}}function wrap(fn,next){var invoked;return wrapped;function wrapped(){var params=slice.call(arguments,0);var callback=fn.length>params.length;var result;if(callback){params.push(done)}try{result=fn.apply(null,params)}catch(err){if(callback&&invoked){throw err}return done(err)}if(!callback){if(result&&typeof result.then==="function"){result.then(then,done)}else if(result instanceof Error){done(result)}else{then(result)}}}function done(){if(!invoked){invoked=true;next.apply(null,arguments)}}function then(value){done(null,value)}}},1020:function(module,exports){var toString=Object.prototype.toString;module.exports=isString;function isString(obj){return toString.call(obj)==="[object String]"}},1021:function(module,exports){module.exports=function isFunction(fn){return Object.prototype.toString.call(fn)==="[object Function]"}},1022:function(module,exports,__webpack_require__){"use strict";var toString=Object.prototype.toString;module.exports=function(x){var prototype;return toString.call(x)==="[object Object]"&&(prototype=Object.getPrototypeOf(x),prototype===null||prototype===Object.getPrototypeOf({}))}},1023:function(module,exports,__webpack_require__){"use strict";var unherit=__webpack_require__(1024);var xtend=__webpack_require__(175);var Parser=__webpack_require__(1026);module.exports=parse;parse.Parser=Parser;function parse(options){var Local=unherit(Parser);Local.prototype.options=xtend(Local.prototype.options,this.data("settings"),options);this.Parser=Local}},1024:function(module,exports,__webpack_require__){"use strict";
/**
 * @author Titus Wormer
 * @copyright 2015 Titus Wormer
 * @license MIT
 * @module unherit
 * @fileoverview Create a custom constructor which can be modified
 *   without affecting the original class.
 */var xtend=__webpack_require__(175);var inherits=__webpack_require__(1025);module.exports=unherit;function unherit(Super){var result;var key;var value;inherits(Of,Super);inherits(From,Of);result=Of.prototype;for(key in result){value=result[key];if(value&&typeof value==="object"){result[key]="concat"in value?value.concat():xtend(value)}}return Of;function From(parameters){return Super.apply(this,parameters)}function Of(){if(!(this instanceof Of)){return new From(arguments)}return Super.apply(this,arguments)}}},1025:function(module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}}else{module.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}}},1026:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(175);var toggle=__webpack_require__(1027);var vfileLocation=__webpack_require__(1028);var unescape=__webpack_require__(1029);var decode=__webpack_require__(1030);var tokenizer=__webpack_require__(1036);module.exports=Parser;function Parser(doc,file){this.file=file;this.offset={};this.options=xtend(this.options);this.setOptions({});this.inList=false;this.inBlock=false;this.inLink=false;this.atStart=true;this.toOffset=vfileLocation(file).toOffset;this.unescape=unescape(this,"escape");this.decode=decode(this)}var proto=Parser.prototype;proto.setOptions=__webpack_require__(1037);proto.parse=__webpack_require__(1040);proto.options=__webpack_require__(662);proto.exitStart=toggle("atStart",true);proto.enterList=toggle("inList",false);proto.enterLink=toggle("inLink",false);proto.enterBlock=toggle("inBlock",false);proto.interruptParagraph=[["thematicBreak"],["atxHeading"],["fencedCode"],["blockquote"],["html"],["setextHeading",{commonmark:false}],["definition",{commonmark:false}],["footnote",{commonmark:false}]];proto.interruptList=[["atxHeading",{pedantic:false}],["fencedCode",{pedantic:false}],["thematicBreak",{pedantic:false}],["definition",{commonmark:false}],["footnote",{commonmark:false}]];proto.interruptBlockquote=[["indentedCode",{commonmark:true}],["fencedCode",{commonmark:true}],["atxHeading",{commonmark:true}],["setextHeading",{commonmark:true}],["thematicBreak",{commonmark:true}],["html",{commonmark:true}],["list",{commonmark:true}],["definition",{commonmark:false}],["footnote",{commonmark:false}]];proto.blockTokenizers={newline:__webpack_require__(1044),indentedCode:__webpack_require__(1045),fencedCode:__webpack_require__(1046),blockquote:__webpack_require__(1047),atxHeading:__webpack_require__(1048),thematicBreak:__webpack_require__(1049),list:__webpack_require__(1050),setextHeading:__webpack_require__(1052),html:__webpack_require__(1053),footnote:__webpack_require__(1054),definition:__webpack_require__(1056),table:__webpack_require__(1057),paragraph:__webpack_require__(1058)};proto.inlineTokenizers={escape:__webpack_require__(1059),autoLink:__webpack_require__(1061),url:__webpack_require__(1062),html:__webpack_require__(1064),link:__webpack_require__(1065),reference:__webpack_require__(1066),strong:__webpack_require__(1067),emphasis:__webpack_require__(1069),deletion:__webpack_require__(1072),code:__webpack_require__(1074),break:__webpack_require__(1076),text:__webpack_require__(1078)};proto.blockMethods=keys(proto.blockTokenizers);proto.inlineMethods=keys(proto.inlineTokenizers);proto.tokenizeBlock=tokenizer("block");proto.tokenizeInline=tokenizer("inline");proto.tokenizeFactory=tokenizer;function keys(value){var result=[];var key;for(key in value){result.push(key)}return result}},1027:function(module,exports,__webpack_require__){"use strict";
/**
 * @author Titus Wormer
 * @copyright 2016 Titus Wormer
 * @license MIT
 * @module state-toggle
 * @fileoverview Enter/exit a state.
 */module.exports=factory;function factory(key,state,ctx){return function(){var context=ctx||this;var current=context[key];context[key]=!state;return function(){context[key]=current}}}},1028:function(module,exports,__webpack_require__){"use strict";module.exports=factory;function factory(file){var contents=indices(String(file));return{toPosition:offsetToPositionFactory(contents),toOffset:positionToOffsetFactory(contents)}}function offsetToPositionFactory(indices){return offsetToPosition;function offsetToPosition(offset){var index=-1;var length=indices.length;if(offset<0){return{}}while(++index<length){if(indices[index]>offset){return{line:index+1,column:offset-(indices[index-1]||0)+1,offset:offset}}}return{}}}function positionToOffsetFactory(indices){return positionToOffset;function positionToOffset(position){var line=position&&position.line;var column=position&&position.column;if(!isNaN(line)&&!isNaN(column)&&line-1 in indices){return(indices[line-2]||0)+column-1||0}return-1}}function indices(value){var result=[];var index=value.indexOf("\n");while(index!==-1){result.push(index+1);index=value.indexOf("\n",index+1)}result.push(value.length+1);return result}},1029:function(module,exports,__webpack_require__){"use strict";module.exports=factory;function factory(ctx,key){return unescape;function unescape(value){var prev=0;var index=value.indexOf("\\");var escape=ctx[key];var queue=[];var character;while(index!==-1){queue.push(value.slice(prev,index));prev=index+1;character=value.charAt(prev);if(!character||escape.indexOf(character)===-1){queue.push("\\")}index=value.indexOf("\\",prev)}queue.push(value.slice(prev));return queue.join("")}}},1030:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(175);var entities=__webpack_require__(432);module.exports=factory;function factory(ctx){decoder.raw=decodeRaw;return decoder;function normalize(position){var offsets=ctx.offset;var line=position.line;var result=[];while(++line){if(!(line in offsets)){break}result.push((offsets[line]||0)+1)}return{start:position,indent:result}}function handleWarning(reason,position,code){if(code===3){return}ctx.file.message(reason,position)}function decoder(value,position,handler){entities(value,{position:normalize(position),warning:handleWarning,text:handler,reference:handler,textContext:ctx,referenceContext:ctx})}function decodeRaw(value,position,options){return entities(value,xtend(options,{position:normalize(position),warning:handleWarning}))}}},1031:function(module){module.exports=JSON.parse('{"AElig":"Æ","AMP":"&","Aacute":"Á","Acirc":"Â","Agrave":"À","Aring":"Å","Atilde":"Ã","Auml":"Ä","COPY":"©","Ccedil":"Ç","ETH":"Ð","Eacute":"É","Ecirc":"Ê","Egrave":"È","Euml":"Ë","GT":">","Iacute":"Í","Icirc":"Î","Igrave":"Ì","Iuml":"Ï","LT":"<","Ntilde":"Ñ","Oacute":"Ó","Ocirc":"Ô","Ograve":"Ò","Oslash":"Ø","Otilde":"Õ","Ouml":"Ö","QUOT":"\\"","REG":"®","THORN":"Þ","Uacute":"Ú","Ucirc":"Û","Ugrave":"Ù","Uuml":"Ü","Yacute":"Ý","aacute":"á","acirc":"â","acute":"´","aelig":"æ","agrave":"à","amp":"&","aring":"å","atilde":"ã","auml":"ä","brvbar":"¦","ccedil":"ç","cedil":"¸","cent":"¢","copy":"©","curren":"¤","deg":"°","divide":"÷","eacute":"é","ecirc":"ê","egrave":"è","eth":"ð","euml":"ë","frac12":"½","frac14":"¼","frac34":"¾","gt":">","iacute":"í","icirc":"î","iexcl":"¡","igrave":"ì","iquest":"¿","iuml":"ï","laquo":"«","lt":"<","macr":"¯","micro":"µ","middot":"·","nbsp":" ","not":"¬","ntilde":"ñ","oacute":"ó","ocirc":"ô","ograve":"ò","ordf":"ª","ordm":"º","oslash":"ø","otilde":"õ","ouml":"ö","para":"¶","plusmn":"±","pound":"£","quot":"\\"","raquo":"»","reg":"®","sect":"§","shy":"­","sup1":"¹","sup2":"²","sup3":"³","szlig":"ß","thorn":"þ","times":"×","uacute":"ú","ucirc":"û","ugrave":"ù","uml":"¨","uuml":"ü","yacute":"ý","yen":"¥","yuml":"ÿ"}')},1032:function(module){module.exports=JSON.parse('{"0":"�","128":"€","130":"‚","131":"ƒ","132":"„","133":"…","134":"†","135":"‡","136":"ˆ","137":"‰","138":"Š","139":"‹","140":"Œ","142":"Ž","145":"‘","146":"’","147":"“","148":"”","149":"•","150":"–","151":"—","152":"˜","153":"™","154":"š","155":"›","156":"œ","158":"ž","159":"Ÿ"}')},1033:function(module,exports,__webpack_require__){"use strict";module.exports=hexadecimal;function hexadecimal(character){var code=typeof character==="string"?character.charCodeAt(0):character;return code>=97&&code<=102||code>=65&&code<=70||code>=48&&code<=57}},1034:function(module,exports,__webpack_require__){"use strict";var alphabetical=__webpack_require__(661);var decimal=__webpack_require__(343);module.exports=alphanumerical;function alphanumerical(character){return alphabetical(character)||decimal(character)}},1035:function(module,exports,__webpack_require__){"use strict";var el;module.exports=decodeEntity;function decodeEntity(characters){var entity="&"+characters+";";var char;el=el||document.createElement("i");el.innerHTML=entity;char=el.textContent;if(char.slice(-1)===";"&&characters!=="semi"){return false}return char===entity?false:char}},1036:function(module,exports,__webpack_require__){"use strict";module.exports=factory;var MERGEABLE_NODES={text:mergeText,blockquote:mergeBlockquote};function mergeable(node){var start;var end;if(node.type!=="text"||!node.position){return true}start=node.position.start;end=node.position.end;return start.line!==end.line||end.column-start.column===node.value.length}function mergeText(prev,node){prev.value+=node.value;return prev}function mergeBlockquote(prev,node){if(this.options.commonmark){return node}prev.children=prev.children.concat(node.children);return prev}function factory(type){return tokenize;function tokenize(value,location){var self=this;var offset=self.offset;var tokens=[];var methods=self[type+"Methods"];var tokenizers=self[type+"Tokenizers"];var line=location.line;var column=location.column;var index;var length;var method;var name;var matched;var valueLength;if(!value){return tokens}eat.now=now;eat.file=self.file;updatePosition("");while(value){index=-1;length=methods.length;matched=false;while(++index<length){name=methods[index];method=tokenizers[name];if(method&&(!method.onlyAtStart||self.atStart)&&(!method.notInList||!self.inList)&&(!method.notInBlock||!self.inBlock)&&(!method.notInLink||!self.inLink)){valueLength=value.length;method.apply(self,[eat,value]);matched=valueLength!==value.length;if(matched){break}}}if(!matched){self.file.fail(new Error("Infinite loop"),eat.now())}}self.eof=now();return tokens;function updatePosition(subvalue){var lastIndex=-1;var index=subvalue.indexOf("\n");while(index!==-1){line++;lastIndex=index;index=subvalue.indexOf("\n",index+1)}if(lastIndex===-1){column+=subvalue.length}else{column=subvalue.length-lastIndex}if(line in offset){if(lastIndex!==-1){column+=offset[line]}else if(column<=offset[line]){column=offset[line]+1}}}function getOffset(){var indentation=[];var pos=line+1;return function(){var last=line+1;while(pos<last){indentation.push((offset[pos]||0)+1);pos++}return indentation}}function now(){var pos={line:line,column:column};pos.offset=self.toOffset(pos);return pos}function Position(start){this.start=start;this.end=now()}function validateEat(subvalue){if(value.substring(0,subvalue.length)!==subvalue){self.file.fail(new Error("Incorrectly eaten value: please report this "+"warning on http://git.io/vg5Ft"),now())}}function position(){var before=now();return update;function update(node,indent){var prev=node.position;var start=prev?prev.start:before;var combined=[];var n=prev&&prev.end.line;var l=before.line;node.position=new Position(start);if(prev&&indent&&prev.indent){combined=prev.indent;if(n<l){while(++n<l){combined.push((offset[n]||0)+1)}combined.push(before.column)}indent=combined.concat(indent)}node.position.indent=indent||[];return node}}function add(node,parent){var children=parent?parent.children:tokens;var prev=children[children.length-1];if(prev&&node.type===prev.type&&node.type in MERGEABLE_NODES&&mergeable(prev)&&mergeable(node)){node=MERGEABLE_NODES[node.type].call(self,prev,node)}if(node!==prev){children.push(node)}if(self.atStart&&tokens.length!==0){self.exitStart()}return node}function eat(subvalue){var indent=getOffset();var pos=position();var current=now();validateEat(subvalue);apply.reset=reset;reset.test=test;apply.test=test;value=value.substring(subvalue.length);updatePosition(subvalue);indent=indent();return apply;function apply(node,parent){return pos(add(pos(node),parent),indent)}function reset(){var node=apply.apply(null,arguments);line=current.line;column=current.column;value=subvalue+value;return node}function test(){var result=pos({});line=current.line;column=current.column;value=subvalue+value;return result.position}}}}},1037:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(175);var escapes=__webpack_require__(1038);var defaults=__webpack_require__(662);module.exports=setOptions;function setOptions(options){var self=this;var current=self.options;var key;var value;if(options==null){options={}}else if(typeof options==="object"){options=xtend(options)}else{throw new Error("Invalid value `"+options+"` "+"for setting `options`")}for(key in defaults){value=options[key];if(value==null){value=current[key]}if(key!=="blocks"&&typeof value!=="boolean"||key==="blocks"&&typeof value!=="object"){throw new Error("Invalid value `"+value+"` for setting `options."+key+"`")}options[key]=value}self.options=options;self.escape=escapes(options);return self}},1038:function(module,exports,__webpack_require__){"use strict";module.exports=escapes;var defaults=["\\","`","*","{","}","[","]","(",")","#","+","-",".","!","_",">"];var gfm=defaults.concat(["~","|"]);var commonmark=gfm.concat(["\n",'"',"$","%","&","'",",","/",":",";","<","=","?","@","^"]);escapes.default=defaults;escapes.gfm=gfm;escapes.commonmark=commonmark;function escapes(options){var settings=options||{};if(settings.commonmark){return commonmark}return settings.gfm?gfm:defaults}},1039:function(module){module.exports=JSON.parse('["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","legend","li","link","main","menu","menuitem","meta","nav","noframes","ol","optgroup","option","p","param","pre","section","source","title","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]')},1040:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(175);var removePosition=__webpack_require__(1041);module.exports=parse;var C_NEWLINE="\n";var EXPRESSION_LINE_BREAKS=/\r\n|\r/g;function parse(){var self=this;var value=String(self.file);var start={line:1,column:1,offset:0};var content=xtend(start);var node;value=value.replace(EXPRESSION_LINE_BREAKS,C_NEWLINE);if(value.charCodeAt(0)===65279){value=value.slice(1);content.column++;content.offset++}node={type:"root",children:self.tokenizeBlock(value,content),position:{start:start,end:self.eof||xtend(start)}};if(!self.options.position){removePosition(node,true)}return node}},1041:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(344);module.exports=removePosition;function removePosition(node,force){visit(node,force?hard:soft);return node}function hard(node){delete node.position}function soft(node){node.position=undefined}},1042:function(module,exports,__webpack_require__){"use strict";module.exports=visitParents;var convert=__webpack_require__(1043);var CONTINUE=true;var SKIP="skip";var EXIT=false;visitParents.CONTINUE=CONTINUE;visitParents.SKIP=SKIP;visitParents.EXIT=EXIT;function visitParents(tree,test,visitor,reverse){var is;if(typeof test==="function"&&typeof visitor!=="function"){reverse=visitor;visitor=test;test=null}is=convert(test);one(tree,null,[]);function one(node,index,parents){var result=[];var subresult;if(!test||is(node,index,parents[parents.length-1]||null)){result=toResult(visitor(node,parents));if(result[0]===EXIT){return result}}if(node.children&&result[0]!==SKIP){subresult=toResult(all(node.children,parents.concat(node)));return subresult[0]===EXIT?subresult:result}return result}function all(children,parents){var min=-1;var step=reverse?-1:1;var index=(reverse?children.length:min)+step;var result;while(index>min&&index<children.length){result=one(children[index],index,parents);if(result[0]===EXIT){return result}index=typeof result[1]==="number"?result[1]:index+step}}}function toResult(value){if(value!==null&&typeof value==="object"&&"length"in value){return value}if(typeof value==="number"){return[CONTINUE,value]}return[value]}},1043:function(module,exports,__webpack_require__){"use strict";module.exports=convert;function convert(test){if(typeof test==="string"){return typeFactory(test)}if(test===null||test===undefined){return ok}if(typeof test==="object"){return("length"in test?anyFactory:matchesFactory)(test)}if(typeof test==="function"){return test}throw new Error("Expected function, string, or object as test")}function convertAll(tests){var results=[];var length=tests.length;var index=-1;while(++index<length){results[index]=convert(tests[index])}return results}function matchesFactory(test){return matches;function matches(node){var key;for(key in test){if(node[key]!==test[key]){return false}}return true}}function anyFactory(tests){var checks=convertAll(tests);var length=checks.length;return matches;function matches(){var index=-1;while(++index<length){if(checks[index].apply(this,arguments)){return true}}return false}}function typeFactory(test){return type;function type(node){return Boolean(node&&node.type===test)}}function ok(){return true}},1044:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(147);module.exports=newline;function newline(eat,value,silent){var character=value.charAt(0);var length;var subvalue;var queue;var index;if(character!=="\n"){return}if(silent){return true}index=1;length=value.length;subvalue=character;queue="";while(index<length){character=value.charAt(index);if(!whitespace(character)){break}queue+=character;if(character==="\n"){subvalue+=queue;queue=""}index++}eat(subvalue)}},1045:function(module,exports,__webpack_require__){"use strict";var repeat=__webpack_require__(433);var trim=__webpack_require__(434);module.exports=indentedCode;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var CODE_INDENT_COUNT=4;var CODE_INDENT=repeat(C_SPACE,CODE_INDENT_COUNT);function indentedCode(eat,value,silent){var index=-1;var length=value.length;var subvalue="";var content="";var subvalueQueue="";var contentQueue="";var character;var blankQueue;var indent;while(++index<length){character=value.charAt(index);if(indent){indent=false;subvalue+=subvalueQueue;content+=contentQueue;subvalueQueue="";contentQueue="";if(character===C_NEWLINE){subvalueQueue=character;contentQueue=character}else{subvalue+=character;content+=character;while(++index<length){character=value.charAt(index);if(!character||character===C_NEWLINE){contentQueue=character;subvalueQueue=character;break}subvalue+=character;content+=character}}}else if(character===C_SPACE&&value.charAt(index+1)===character&&value.charAt(index+2)===character&&value.charAt(index+3)===character){subvalueQueue+=CODE_INDENT;index+=3;indent=true}else if(character===C_TAB){subvalueQueue+=character;indent=true}else{blankQueue="";while(character===C_TAB||character===C_SPACE){blankQueue+=character;character=value.charAt(++index)}if(character!==C_NEWLINE){break}subvalueQueue+=blankQueue+character;contentQueue+=character}}if(content){if(silent){return true}return eat(subvalue)({type:"code",lang:null,value:trim(content)})}}},1046:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(434);module.exports=fencedCode;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_TILDE="~";var C_TICK="`";var MIN_FENCE_COUNT=3;var CODE_INDENT_COUNT=4;function fencedCode(eat,value,silent){var self=this;var settings=self.options;var length=value.length+1;var index=0;var subvalue="";var fenceCount;var marker;var character;var flag;var queue;var content;var exdentedContent;var closing;var exdentedClosing;var indent;var now;if(!settings.gfm){return}while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}subvalue+=character;index++}indent=index;character=value.charAt(index);if(character!==C_TILDE&&character!==C_TICK){return}index++;marker=character;fenceCount=1;subvalue+=character;while(index<length){character=value.charAt(index);if(character!==marker){break}subvalue+=character;fenceCount++;index++}if(fenceCount<MIN_FENCE_COUNT){return}while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}subvalue+=character;index++}flag="";queue="";while(index<length){character=value.charAt(index);if(character===C_NEWLINE||character===C_TILDE||character===C_TICK){break}if(character===C_SPACE||character===C_TAB){queue+=character}else{flag+=queue+character;queue=""}index++}character=value.charAt(index);if(character&&character!==C_NEWLINE){return}if(silent){return true}now=eat.now();now.column+=subvalue.length;now.offset+=subvalue.length;subvalue+=flag;flag=self.decode.raw(self.unescape(flag),now);if(queue){subvalue+=queue}queue="";closing="";exdentedClosing="";content="";exdentedContent="";while(index<length){character=value.charAt(index);content+=closing;exdentedContent+=exdentedClosing;closing="";exdentedClosing="";if(character!==C_NEWLINE){content+=character;exdentedClosing+=character;index++;continue}if(content){closing+=character;exdentedClosing+=character}else{subvalue+=character}queue="";index++;while(index<length){character=value.charAt(index);if(character!==C_SPACE){break}queue+=character;index++}closing+=queue;exdentedClosing+=queue.slice(indent);if(queue.length>=CODE_INDENT_COUNT){continue}queue="";while(index<length){character=value.charAt(index);if(character!==marker){break}queue+=character;index++}closing+=queue;exdentedClosing+=queue;if(queue.length<fenceCount){continue}queue="";while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}closing+=character;exdentedClosing+=character;index++}if(!character||character===C_NEWLINE){break}}subvalue+=content+closing;return eat(subvalue)({type:"code",lang:flag||null,value:trim(exdentedContent)})}},1047:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(240);var interrupt=__webpack_require__(435);module.exports=blockquote;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_GT=">";function blockquote(eat,value,silent){var self=this;var offsets=self.offset;var tokenizers=self.blockTokenizers;var interruptors=self.interruptBlockquote;var now=eat.now();var currentLine=now.line;var length=value.length;var values=[];var contents=[];var indents=[];var add;var index=0;var character;var rest;var nextIndex;var content;var line;var startIndex;var prefixed;var exit;while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}index++}if(value.charAt(index)!==C_GT){return}if(silent){return true}index=0;while(index<length){nextIndex=value.indexOf(C_NEWLINE,index);startIndex=index;prefixed=false;if(nextIndex===-1){nextIndex=length}while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}index++}if(value.charAt(index)===C_GT){index++;prefixed=true;if(value.charAt(index)===C_SPACE){index++}}else{index=startIndex}content=value.slice(index,nextIndex);if(!prefixed&&!trim(content)){index=startIndex;break}if(!prefixed){rest=value.slice(index);if(interrupt(interruptors,tokenizers,self,[eat,rest,true])){break}}line=startIndex===index?content:value.slice(startIndex,nextIndex);indents.push(index-startIndex);values.push(line);contents.push(content);index=nextIndex+1}index=-1;length=indents.length;add=eat(values.join(C_NEWLINE));while(++index<length){offsets[currentLine]=(offsets[currentLine]||0)+indents[index];currentLine++}exit=self.enterBlock();contents=self.tokenizeBlock(contents.join(C_NEWLINE),now);exit();return add({type:"blockquote",children:contents})}},1048:function(module,exports,__webpack_require__){"use strict";module.exports=atxHeading;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_HASH="#";var MAX_ATX_COUNT=6;function atxHeading(eat,value,silent){var self=this;var settings=self.options;var length=value.length+1;var index=-1;var now=eat.now();var subvalue="";var content="";var character;var queue;var depth;while(++index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){index--;break}subvalue+=character}depth=0;while(++index<=length){character=value.charAt(index);if(character!==C_HASH){index--;break}subvalue+=character;depth++}if(depth>MAX_ATX_COUNT){return}if(!depth||!settings.pedantic&&value.charAt(index+1)===C_HASH){return}length=value.length+1;queue="";while(++index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){index--;break}queue+=character}if(!settings.pedantic&&queue.length===0&&character&&character!==C_NEWLINE){return}if(silent){return true}subvalue+=queue;queue="";content="";while(++index<length){character=value.charAt(index);if(!character||character===C_NEWLINE){break}if(character!==C_SPACE&&character!==C_TAB&&character!==C_HASH){content+=queue+character;queue="";continue}while(character===C_SPACE||character===C_TAB){queue+=character;character=value.charAt(++index)}while(character===C_HASH){queue+=character;character=value.charAt(++index)}while(character===C_SPACE||character===C_TAB){queue+=character;character=value.charAt(++index)}index--}now.column+=subvalue.length;now.offset+=subvalue.length;subvalue+=content+queue;return eat(subvalue)({type:"heading",depth:depth,children:self.tokenizeInline(content,now)})}},1049:function(module,exports,__webpack_require__){"use strict";module.exports=thematicBreak;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_ASTERISK="*";var C_UNDERSCORE="_";var C_DASH="-";var THEMATIC_BREAK_MARKER_COUNT=3;function thematicBreak(eat,value,silent){var index=-1;var length=value.length+1;var subvalue="";var character;var marker;var markerCount;var queue;while(++index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}subvalue+=character}if(character!==C_ASTERISK&&character!==C_DASH&&character!==C_UNDERSCORE){return}marker=character;subvalue+=character;markerCount=1;queue="";while(++index<length){character=value.charAt(index);if(character===marker){markerCount++;subvalue+=queue+marker;queue=""}else if(character===C_SPACE){queue+=character}else if(markerCount>=THEMATIC_BREAK_MARKER_COUNT&&(!character||character===C_NEWLINE)){subvalue+=queue;if(silent){return true}return eat(subvalue)({type:"thematicBreak"})}else{return}}}},1050:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(240);var repeat=__webpack_require__(433);var decimal=__webpack_require__(343);var getIndent=__webpack_require__(663);var removeIndent=__webpack_require__(1051);var interrupt=__webpack_require__(435);module.exports=list;var C_ASTERISK="*";var C_UNDERSCORE="_";var C_PLUS="+";var C_DASH="-";var C_DOT=".";var C_SPACE=" ";var C_NEWLINE="\n";var C_TAB="\t";var C_PAREN_CLOSE=")";var C_X_LOWER="x";var TAB_SIZE=4;var EXPRESSION_LOOSE_LIST_ITEM=/\n\n(?!\s*$)/;var EXPRESSION_TASK_ITEM=/^\[([ \t]|x|X)][ \t]/;var EXPRESSION_BULLET=/^([ \t]*)([*+-]|\d+[.)])( {1,4}(?! )| |\t|$|(?=\n))([^\n]*)/;var EXPRESSION_PEDANTIC_BULLET=/^([ \t]*)([*+-]|\d+[.)])([ \t]+)/;var EXPRESSION_INITIAL_INDENT=/^( {1,4}|\t)?/gm;var LIST_UNORDERED_MARKERS={};LIST_UNORDERED_MARKERS[C_ASTERISK]=true;LIST_UNORDERED_MARKERS[C_PLUS]=true;LIST_UNORDERED_MARKERS[C_DASH]=true;var LIST_ORDERED_MARKERS={};LIST_ORDERED_MARKERS[C_DOT]=true;var LIST_ORDERED_COMMONMARK_MARKERS={};LIST_ORDERED_COMMONMARK_MARKERS[C_DOT]=true;LIST_ORDERED_COMMONMARK_MARKERS[C_PAREN_CLOSE]=true;function list(eat,value,silent){var self=this;var commonmark=self.options.commonmark;var pedantic=self.options.pedantic;var tokenizers=self.blockTokenizers;var interuptors=self.interruptList;var markers;var index=0;var length=value.length;var start=null;var size=0;var queue;var ordered;var character;var marker;var nextIndex;var startIndex;var prefixed;var currentMarker;var content;var line;var prevEmpty;var empty;var items;var allLines;var emptyLines;var item;var enterTop;var exitBlockquote;var isLoose;var node;var now;var end;var indented;while(index<length){character=value.charAt(index);if(character===C_TAB){size+=TAB_SIZE-size%TAB_SIZE}else if(character===C_SPACE){size++}else{break}index++}if(size>=TAB_SIZE){return}character=value.charAt(index);markers=commonmark?LIST_ORDERED_COMMONMARK_MARKERS:LIST_ORDERED_MARKERS;if(LIST_UNORDERED_MARKERS[character]===true){marker=character;ordered=false}else{ordered=true;queue="";while(index<length){character=value.charAt(index);if(!decimal(character)){break}queue+=character;index++}character=value.charAt(index);if(!queue||markers[character]!==true){return}start=parseInt(queue,10);marker=character}character=value.charAt(++index);if(character!==C_SPACE&&character!==C_TAB){return}if(silent){return true}index=0;items=[];allLines=[];emptyLines=[];while(index<length){nextIndex=value.indexOf(C_NEWLINE,index);startIndex=index;prefixed=false;indented=false;if(nextIndex===-1){nextIndex=length}end=index+TAB_SIZE;size=0;while(index<length){character=value.charAt(index);if(character===C_TAB){size+=TAB_SIZE-size%TAB_SIZE}else if(character===C_SPACE){size++}else{break}index++}if(size>=TAB_SIZE){indented=true}if(item&&size>=item.indent){indented=true}character=value.charAt(index);currentMarker=null;if(!indented){if(LIST_UNORDERED_MARKERS[character]===true){currentMarker=character;index++;size++}else{queue="";while(index<length){character=value.charAt(index);if(!decimal(character)){break}queue+=character;index++}character=value.charAt(index);index++;if(queue&&markers[character]===true){currentMarker=character;size+=queue.length+1}}if(currentMarker){character=value.charAt(index);if(character===C_TAB){size+=TAB_SIZE-size%TAB_SIZE;index++}else if(character===C_SPACE){end=index+TAB_SIZE;while(index<end){if(value.charAt(index)!==C_SPACE){break}index++;size++}if(index===end&&value.charAt(index)===C_SPACE){index-=TAB_SIZE-1;size-=TAB_SIZE-1}}else if(character!==C_NEWLINE&&character!==""){currentMarker=null}}}if(currentMarker){if(!pedantic&&marker!==currentMarker){break}prefixed=true}else{if(!commonmark&&!indented&&value.charAt(startIndex)===C_SPACE){indented=true}else if(commonmark&&item){indented=size>=item.indent||size>TAB_SIZE}prefixed=false;index=startIndex}line=value.slice(startIndex,nextIndex);content=startIndex===index?line:value.slice(index,nextIndex);if(currentMarker===C_ASTERISK||currentMarker===C_UNDERSCORE||currentMarker===C_DASH){if(tokenizers.thematicBreak.call(self,eat,line,true)){break}}prevEmpty=empty;empty=!trim(content).length;if(indented&&item){item.value=item.value.concat(emptyLines,line);allLines=allLines.concat(emptyLines,line);emptyLines=[]}else if(prefixed){if(emptyLines.length!==0){item.value.push("");item.trail=emptyLines.concat()}item={value:[line],indent:size,trail:[]};items.push(item);allLines=allLines.concat(emptyLines,line);emptyLines=[]}else if(empty){if(prevEmpty){break}emptyLines.push(line)}else{if(prevEmpty){break}if(interrupt(interuptors,tokenizers,self,[eat,line,true])){break}item.value=item.value.concat(emptyLines,line);allLines=allLines.concat(emptyLines,line);emptyLines=[]}index=nextIndex+1}node=eat(allLines.join(C_NEWLINE)).reset({type:"list",ordered:ordered,start:start,loose:null,children:[]});enterTop=self.enterList();exitBlockquote=self.enterBlock();isLoose=false;index=-1;length=items.length;while(++index<length){item=items[index].value.join(C_NEWLINE);now=eat.now();item=eat(item)(listItem(self,item,now),node);if(item.loose){isLoose=true}item=items[index].trail.join(C_NEWLINE);if(index!==length-1){item+=C_NEWLINE}eat(item)}enterTop();exitBlockquote();node.loose=isLoose;return node}function listItem(ctx,value,position){var offsets=ctx.offset;var fn=ctx.options.pedantic?pedanticListItem:normalListItem;var checked=null;var task;var indent;value=fn.apply(null,arguments);if(ctx.options.gfm){task=value.match(EXPRESSION_TASK_ITEM);if(task){indent=task[0].length;checked=task[1].toLowerCase()===C_X_LOWER;offsets[position.line]+=indent;value=value.slice(indent)}}return{type:"listItem",loose:EXPRESSION_LOOSE_LIST_ITEM.test(value)||value.charAt(value.length-1)===C_NEWLINE,checked:checked,children:ctx.tokenizeBlock(value,position)}}function pedanticListItem(ctx,value,position){var offsets=ctx.offset;var line=position.line;value=value.replace(EXPRESSION_PEDANTIC_BULLET,replacer);line=position.line;return value.replace(EXPRESSION_INITIAL_INDENT,replacer);function replacer($0){offsets[line]=(offsets[line]||0)+$0.length;line++;return""}}function normalListItem(ctx,value,position){var offsets=ctx.offset;var line=position.line;var max;var bullet;var rest;var lines;var trimmedLines;var index;var length;value=value.replace(EXPRESSION_BULLET,replacer);lines=value.split(C_NEWLINE);trimmedLines=removeIndent(value,getIndent(max).indent).split(C_NEWLINE);trimmedLines[0]=rest;offsets[line]=(offsets[line]||0)+bullet.length;line++;index=0;length=lines.length;while(++index<length){offsets[line]=(offsets[line]||0)+lines[index].length-trimmedLines[index].length;line++}return trimmedLines.join(C_NEWLINE);function replacer($0,$1,$2,$3,$4){bullet=$1+$2+$3;rest=$4;if(Number($2)<10&&bullet.length%2===1){$2=C_SPACE+$2}max=$1+repeat(C_SPACE,$2.length)+$3;return max+rest}}},1051:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(240);var repeat=__webpack_require__(433);var getIndent=__webpack_require__(663);module.exports=indentation;var C_SPACE=" ";var C_NEWLINE="\n";var C_TAB="\t";function indentation(value,maximum){var values=value.split(C_NEWLINE);var position=values.length+1;var minIndent=Infinity;var matrix=[];var index;var indentation;var stops;var padding;values.unshift(repeat(C_SPACE,maximum)+"!");while(position--){indentation=getIndent(values[position]);matrix[position]=indentation.stops;if(trim(values[position]).length===0){continue}if(indentation.indent){if(indentation.indent>0&&indentation.indent<minIndent){minIndent=indentation.indent}}else{minIndent=Infinity;break}}if(minIndent!==Infinity){position=values.length;while(position--){stops=matrix[position];index=minIndent;while(index&&!(index in stops)){index--}if(trim(values[position]).length!==0&&minIndent&&index!==minIndent){padding=C_TAB}else{padding=""}values[position]=padding+values[position].slice(index in stops?stops[index]+1:0)}}values.shift();return values.join(C_NEWLINE)}},1052:function(module,exports,__webpack_require__){"use strict";module.exports=setextHeading;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_EQUALS="=";var C_DASH="-";var MAX_HEADING_INDENT=3;var SETEXT_MARKERS={};SETEXT_MARKERS[C_EQUALS]=1;SETEXT_MARKERS[C_DASH]=2;function setextHeading(eat,value,silent){var self=this;var now=eat.now();var length=value.length;var index=-1;var subvalue="";var content;var queue;var character;var marker;var depth;while(++index<length){character=value.charAt(index);if(character!==C_SPACE||index>=MAX_HEADING_INDENT){index--;break}subvalue+=character}content="";queue="";while(++index<length){character=value.charAt(index);if(character===C_NEWLINE){index--;break}if(character===C_SPACE||character===C_TAB){queue+=character}else{content+=queue+character;queue=""}}now.column+=subvalue.length;now.offset+=subvalue.length;subvalue+=content+queue;character=value.charAt(++index);marker=value.charAt(++index);if(character!==C_NEWLINE||!SETEXT_MARKERS[marker]){return}subvalue+=character;queue=marker;depth=SETEXT_MARKERS[marker];while(++index<length){character=value.charAt(index);if(character!==marker){if(character!==C_NEWLINE){return}index--;break}queue+=character}if(silent){return true}return eat(subvalue+queue)({type:"heading",depth:depth,children:self.tokenizeInline(content,now)})}},1053:function(module,exports,__webpack_require__){"use strict";var openCloseTag=__webpack_require__(664).openCloseTag;module.exports=blockHTML;var C_TAB="\t";var C_SPACE=" ";var C_NEWLINE="\n";var C_LT="<";function blockHTML(eat,value,silent){var self=this;var blocks=self.options.blocks;var length=value.length;var index=0;var next;var line;var offset;var character;var count;var sequence;var subvalue;var sequences=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,true],[/^<!--/,/-->/,true],[/^<\?/,/\?>/,true],[/^<![A-Za-z]/,/>/,true],[/^<!\[CDATA\[/,/\]\]>/,true],[new RegExp("^</?("+blocks.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,true],[new RegExp(openCloseTag.source+"\\s*$"),/^$/,false]];while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}index++}if(value.charAt(index)!==C_LT){return}next=value.indexOf(C_NEWLINE,index+1);next=next===-1?length:next;line=value.slice(index,next);offset=-1;count=sequences.length;while(++offset<count){if(sequences[offset][0].test(line)){sequence=sequences[offset];break}}if(!sequence){return}if(silent){return sequence[2]}index=next;if(!sequence[1].test(line)){while(index<length){next=value.indexOf(C_NEWLINE,index+1);next=next===-1?length:next;line=value.slice(index+1,next);if(sequence[1].test(line)){if(line){index=next}break}index=next}}subvalue=value.slice(0,index);return eat(subvalue)({type:"html",value:subvalue})}},1054:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(147);var normalize=__webpack_require__(436);module.exports=footnoteDefinition;footnoteDefinition.notInList=true;footnoteDefinition.notInBlock=true;var C_BACKSLASH="\\";var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_CARET="^";var C_COLON=":";var EXPRESSION_INITIAL_TAB=/^( {4}|\t)?/gm;function footnoteDefinition(eat,value,silent){var self=this;var offsets=self.offset;var index;var length;var subvalue;var now;var currentLine;var content;var queue;var subqueue;var character;var identifier;var add;var exit;if(!self.options.footnotes){return}index=0;length=value.length;subvalue="";now=eat.now();currentLine=now.line;while(index<length){character=value.charAt(index);if(!whitespace(character)){break}subvalue+=character;index++}if(value.charAt(index)!==C_BRACKET_OPEN||value.charAt(index+1)!==C_CARET){return}subvalue+=C_BRACKET_OPEN+C_CARET;index=subvalue.length;queue="";while(index<length){character=value.charAt(index);if(character===C_BRACKET_CLOSE){break}else if(character===C_BACKSLASH){queue+=character;index++;character=value.charAt(index)}queue+=character;index++}if(!queue||value.charAt(index)!==C_BRACKET_CLOSE||value.charAt(index+1)!==C_COLON){return}if(silent){return true}identifier=normalize(queue);subvalue+=queue+C_BRACKET_CLOSE+C_COLON;index=subvalue.length;while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}subvalue+=character;index++}now.column+=subvalue.length;now.offset+=subvalue.length;queue="";content="";subqueue="";while(index<length){character=value.charAt(index);if(character===C_NEWLINE){subqueue=character;index++;while(index<length){character=value.charAt(index);if(character!==C_NEWLINE){break}subqueue+=character;index++}queue+=subqueue;subqueue="";while(index<length){character=value.charAt(index);if(character!==C_SPACE){break}subqueue+=character;index++}if(subqueue.length===0){break}queue+=subqueue}if(queue){content+=queue;queue=""}content+=character;index++}subvalue+=content;content=content.replace(EXPRESSION_INITIAL_TAB,(function(line){offsets[currentLine]=(offsets[currentLine]||0)+line.length;currentLine++;return""}));add=eat(subvalue);exit=self.enterBlock();content=self.tokenizeBlock(content,now);exit();return add({type:"footnoteDefinition",identifier:identifier,children:content})}},1055:function(module,exports,__webpack_require__){"use strict";module.exports=collapse;function collapse(value){return String(value).replace(/\s+/g," ")}},1056:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(147);var normalize=__webpack_require__(436);module.exports=definition;definition.notInList=true;definition.notInBlock=true;var C_DOUBLE_QUOTE='"';var C_SINGLE_QUOTE="'";var C_BACKSLASH="\\";var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_PAREN_OPEN="(";var C_PAREN_CLOSE=")";var C_COLON=":";var C_LT="<";var C_GT=">";function definition(eat,value,silent){var self=this;var commonmark=self.options.commonmark;var index=0;var length=value.length;var subvalue="";var beforeURL;var beforeTitle;var queue;var character;var test;var identifier;var url;var title;while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}subvalue+=character;index++}character=value.charAt(index);if(character!==C_BRACKET_OPEN){return}index++;subvalue+=character;queue="";while(index<length){character=value.charAt(index);if(character===C_BRACKET_CLOSE){break}else if(character===C_BACKSLASH){queue+=character;index++;character=value.charAt(index)}queue+=character;index++}if(!queue||value.charAt(index)!==C_BRACKET_CLOSE||value.charAt(index+1)!==C_COLON){return}identifier=queue;subvalue+=queue+C_BRACKET_CLOSE+C_COLON;index=subvalue.length;queue="";while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE&&character!==C_NEWLINE){break}subvalue+=character;index++}character=value.charAt(index);queue="";beforeURL=subvalue;if(character===C_LT){index++;while(index<length){character=value.charAt(index);if(!isEnclosedURLCharacter(character)){break}queue+=character;index++}character=value.charAt(index);if(character===isEnclosedURLCharacter.delimiter){subvalue+=C_LT+queue+character;index++}else{if(commonmark){return}index-=queue.length+1;queue=""}}if(!queue){while(index<length){character=value.charAt(index);if(!isUnclosedURLCharacter(character)){break}queue+=character;index++}subvalue+=queue}if(!queue){return}url=queue;queue="";while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE&&character!==C_NEWLINE){break}queue+=character;index++}character=value.charAt(index);test=null;if(character===C_DOUBLE_QUOTE){test=C_DOUBLE_QUOTE}else if(character===C_SINGLE_QUOTE){test=C_SINGLE_QUOTE}else if(character===C_PAREN_OPEN){test=C_PAREN_CLOSE}if(!test){queue="";index=subvalue.length}else if(queue){subvalue+=queue+character;index=subvalue.length;queue="";while(index<length){character=value.charAt(index);if(character===test){break}if(character===C_NEWLINE){index++;character=value.charAt(index);if(character===C_NEWLINE||character===test){return}queue+=C_NEWLINE}queue+=character;index++}character=value.charAt(index);if(character!==test){return}beforeTitle=subvalue;subvalue+=queue+character;index++;title=queue;queue=""}else{return}while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}subvalue+=character;index++}character=value.charAt(index);if(!character||character===C_NEWLINE){if(silent){return true}beforeURL=eat(beforeURL).test().end;url=self.decode.raw(self.unescape(url),beforeURL,{nonTerminated:false});if(title){beforeTitle=eat(beforeTitle).test().end;title=self.decode.raw(self.unescape(title),beforeTitle)}return eat(subvalue)({type:"definition",identifier:normalize(identifier),title:title||null,url:url})}}function isEnclosedURLCharacter(character){return character!==C_GT&&character!==C_BRACKET_OPEN&&character!==C_BRACKET_CLOSE}isEnclosedURLCharacter.delimiter=C_GT;function isUnclosedURLCharacter(character){return character!==C_BRACKET_OPEN&&character!==C_BRACKET_CLOSE&&!whitespace(character)}},1057:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(147);module.exports=table;var C_BACKSLASH="\\";var C_TICK="`";var C_DASH="-";var C_PIPE="|";var C_COLON=":";var C_SPACE=" ";var C_NEWLINE="\n";var C_TAB="\t";var MIN_TABLE_COLUMNS=1;var MIN_TABLE_ROWS=2;var TABLE_ALIGN_LEFT="left";var TABLE_ALIGN_CENTER="center";var TABLE_ALIGN_RIGHT="right";var TABLE_ALIGN_NONE=null;function table(eat,value,silent){var self=this;var index;var alignments;var alignment;var subvalue;var row;var length;var lines;var queue;var character;var hasDash;var align;var cell;var preamble;var count;var opening;var now;var position;var lineCount;var line;var rows;var table;var lineIndex;var pipeIndex;var first;if(!self.options.gfm){return}index=0;lineCount=0;length=value.length+1;lines=[];while(index<length){lineIndex=value.indexOf(C_NEWLINE,index);pipeIndex=value.indexOf(C_PIPE,index+1);if(lineIndex===-1){lineIndex=value.length}if(pipeIndex===-1||pipeIndex>lineIndex){if(lineCount<MIN_TABLE_ROWS){return}break}lines.push(value.slice(index,lineIndex));lineCount++;index=lineIndex+1}subvalue=lines.join(C_NEWLINE);alignments=lines.splice(1,1)[0]||[];index=0;length=alignments.length;lineCount--;alignment=false;align=[];while(index<length){character=alignments.charAt(index);if(character===C_PIPE){hasDash=null;if(alignment===false){if(first===false){return}}else{align.push(alignment);alignment=false}first=false}else if(character===C_DASH){hasDash=true;alignment=alignment||TABLE_ALIGN_NONE}else if(character===C_COLON){if(alignment===TABLE_ALIGN_LEFT){alignment=TABLE_ALIGN_CENTER}else if(hasDash&&alignment===TABLE_ALIGN_NONE){alignment=TABLE_ALIGN_RIGHT}else{alignment=TABLE_ALIGN_LEFT}}else if(!whitespace(character)){return}index++}if(alignment!==false){align.push(alignment)}if(align.length<MIN_TABLE_COLUMNS){return}if(silent){return true}position=-1;rows=[];table=eat(subvalue).reset({type:"table",align:align,children:rows});while(++position<lineCount){line=lines[position];row={type:"tableRow",children:[]};if(position){eat(C_NEWLINE)}eat(line).reset(row,table);length=line.length+1;index=0;queue="";cell="";preamble=true;count=null;opening=null;while(index<length){character=line.charAt(index);if(character===C_TAB||character===C_SPACE){if(cell){queue+=character}else{eat(character)}index++;continue}if(character===""||character===C_PIPE){if(preamble){eat(character)}else{if(character&&opening){queue+=character;index++;continue}if((cell||character)&&!preamble){subvalue=cell;if(queue.length>1){if(character){subvalue+=queue.slice(0,queue.length-1);queue=queue.charAt(queue.length-1)}else{subvalue+=queue;queue=""}}now=eat.now();eat(subvalue)({type:"tableCell",children:self.tokenizeInline(cell,now)},row)}eat(queue+character);queue="";cell=""}}else{if(queue){cell+=queue;queue=""}cell+=character;if(character===C_BACKSLASH&&index!==length-2){cell+=line.charAt(index+1);index++}if(character===C_TICK){count=1;while(line.charAt(index+1)===character){cell+=character;index++;count++}if(!opening){opening=count}else if(count>=opening){opening=0}}}preamble=false;index++}if(!position){eat(C_NEWLINE+alignments)}}return table}},1058:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(240);var decimal=__webpack_require__(343);var trimTrailingLines=__webpack_require__(434);var interrupt=__webpack_require__(435);module.exports=paragraph;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var TAB_SIZE=4;function paragraph(eat,value,silent){var self=this;var settings=self.options;var commonmark=settings.commonmark;var gfm=settings.gfm;var tokenizers=self.blockTokenizers;var interruptors=self.interruptParagraph;var index=value.indexOf(C_NEWLINE);var length=value.length;var position;var subvalue;var character;var size;var now;while(index<length){if(index===-1){index=length;break}if(value.charAt(index+1)===C_NEWLINE){break}if(commonmark){size=0;position=index+1;while(position<length){character=value.charAt(position);if(character===C_TAB){size=TAB_SIZE;break}else if(character===C_SPACE){size++}else{break}position++}if(size>=TAB_SIZE){index=value.indexOf(C_NEWLINE,index+1);continue}}subvalue=value.slice(index+1);if(interrupt(interruptors,tokenizers,self,[eat,subvalue,true])){break}if(tokenizers.list.call(self,eat,subvalue,true)&&(self.inList||commonmark||gfm&&!decimal(trim.left(subvalue).charAt(0)))){break}position=index;index=value.indexOf(C_NEWLINE,index+1);if(index!==-1&&trim(value.slice(position,index))===""){index=position;break}}subvalue=value.slice(0,index);if(trim(subvalue)===""){eat(subvalue);return null}if(silent){return true}now=eat.now();subvalue=trimTrailingLines(subvalue);return eat(subvalue)({type:"paragraph",children:self.tokenizeInline(subvalue,now)})}},1059:function(module,exports,__webpack_require__){"use strict";var locate=__webpack_require__(1060);module.exports=escape;escape.locator=locate;function escape(eat,value,silent){var self=this;var character;var node;if(value.charAt(0)==="\\"){character=value.charAt(1);if(self.escape.indexOf(character)!==-1){if(silent){return true}if(character==="\n"){node={type:"break"}}else{node={type:"text",value:character}}return eat("\\"+character)(node)}}}},1060:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("\\",fromIndex)}},1061:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(147);var decode=__webpack_require__(432);var locate=__webpack_require__(665);module.exports=autoLink;autoLink.locator=locate;autoLink.notInLink=true;var C_LT="<";var C_GT=">";var C_AT_SIGN="@";var C_SLASH="/";var MAILTO="mailto:";var MAILTO_LENGTH=MAILTO.length;function autoLink(eat,value,silent){var self;var subvalue;var length;var index;var queue;var character;var hasAtCharacter;var link;var now;var content;var tokenizers;var exit;if(value.charAt(0)!==C_LT){return}self=this;subvalue="";length=value.length;index=0;queue="";hasAtCharacter=false;link="";index++;subvalue=C_LT;while(index<length){character=value.charAt(index);if(whitespace(character)||character===C_GT||character===C_AT_SIGN||character===":"&&value.charAt(index+1)===C_SLASH){break}queue+=character;index++}if(!queue){return}link+=queue;queue="";character=value.charAt(index);link+=character;index++;if(character===C_AT_SIGN){hasAtCharacter=true}else{if(character!==":"||value.charAt(index+1)!==C_SLASH){return}link+=C_SLASH;index++}while(index<length){character=value.charAt(index);if(whitespace(character)||character===C_GT){break}queue+=character;index++}character=value.charAt(index);if(!queue||character!==C_GT){return}if(silent){return true}link+=queue;content=link;subvalue+=link+character;now=eat.now();now.column++;now.offset++;if(hasAtCharacter){if(link.slice(0,MAILTO_LENGTH).toLowerCase()===MAILTO){content=content.substr(MAILTO_LENGTH);now.column+=MAILTO_LENGTH;now.offset+=MAILTO_LENGTH}else{link=MAILTO+link}}tokenizers=self.inlineTokenizers;self.inlineTokenizers={text:tokenizers.text};exit=self.enterLink();content=self.tokenizeInline(content,now);self.inlineTokenizers=tokenizers;exit();return eat(subvalue)({type:"link",title:null,url:decode(link,{nonTerminated:false}),children:content})}},1062:function(module,exports,__webpack_require__){"use strict";var decode=__webpack_require__(432);var whitespace=__webpack_require__(147);var locate=__webpack_require__(1063);module.exports=url;url.locator=locate;url.notInLink=true;var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_PAREN_OPEN="(";var C_PAREN_CLOSE=")";var C_LT="<";var C_AT_SIGN="@";var HTTP_PROTOCOL="http://";var HTTPS_PROTOCOL="https://";var MAILTO_PROTOCOL="mailto:";var PROTOCOLS=[HTTP_PROTOCOL,HTTPS_PROTOCOL,MAILTO_PROTOCOL];var PROTOCOLS_LENGTH=PROTOCOLS.length;function url(eat,value,silent){var self=this;var subvalue;var content;var character;var index;var position;var protocol;var match;var length;var queue;var parenCount;var nextCharacter;var exit;if(!self.options.gfm){return}subvalue="";index=-1;length=PROTOCOLS_LENGTH;while(++index<length){protocol=PROTOCOLS[index];match=value.slice(0,protocol.length);if(match.toLowerCase()===protocol){subvalue=match;break}}if(!subvalue){return}index=subvalue.length;length=value.length;queue="";parenCount=0;while(index<length){character=value.charAt(index);if(whitespace(character)||character===C_LT){break}if(character==="."||character===","||character===":"||character===";"||character==='"'||character==="'"||character===")"||character==="]"){nextCharacter=value.charAt(index+1);if(!nextCharacter||whitespace(nextCharacter)){break}}if(character===C_PAREN_OPEN||character===C_BRACKET_OPEN){parenCount++}if(character===C_PAREN_CLOSE||character===C_BRACKET_CLOSE){parenCount--;if(parenCount<0){break}}queue+=character;index++}if(!queue){return}subvalue+=queue;content=subvalue;if(protocol===MAILTO_PROTOCOL){position=queue.indexOf(C_AT_SIGN);if(position===-1||position===length-1){return}content=content.substr(MAILTO_PROTOCOL.length)}if(silent){return true}exit=self.enterLink();content=self.tokenizeInline(content,eat.now());exit();return eat(subvalue)({type:"link",title:null,url:decode(subvalue,{nonTerminated:false}),children:content})}},1063:function(module,exports,__webpack_require__){"use strict";module.exports=locate;var PROTOCOLS=["https://","http://","mailto:"];function locate(value,fromIndex){var length=PROTOCOLS.length;var index=-1;var min=-1;var position;if(!this.options.gfm){return-1}while(++index<length){position=value.indexOf(PROTOCOLS[index],fromIndex);if(position!==-1&&(position<min||min===-1)){min=position}}return min}},1064:function(module,exports,__webpack_require__){"use strict";var alphabetical=__webpack_require__(661);var locate=__webpack_require__(665);var tag=__webpack_require__(664).tag;module.exports=inlineHTML;inlineHTML.locator=locate;var EXPRESSION_HTML_LINK_OPEN=/^<a /i;var EXPRESSION_HTML_LINK_CLOSE=/^<\/a>/i;function inlineHTML(eat,value,silent){var self=this;var length=value.length;var character;var subvalue;if(value.charAt(0)!=="<"||length<3){return}character=value.charAt(1);if(!alphabetical(character)&&character!=="?"&&character!=="!"&&character!=="/"){return}subvalue=value.match(tag);if(!subvalue){return}if(silent){return true}subvalue=subvalue[0];if(!self.inLink&&EXPRESSION_HTML_LINK_OPEN.test(subvalue)){self.inLink=true}else if(self.inLink&&EXPRESSION_HTML_LINK_CLOSE.test(subvalue)){self.inLink=false}return eat(subvalue)({type:"html",value:subvalue})}},1065:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(147);var locate=__webpack_require__(666);module.exports=link;link.locator=locate;var own={}.hasOwnProperty;var C_BACKSLASH="\\";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_PAREN_OPEN="(";var C_PAREN_CLOSE=")";var C_LT="<";var C_GT=">";var C_TICK="`";var C_DOUBLE_QUOTE='"';var C_SINGLE_QUOTE="'";var LINK_MARKERS={};LINK_MARKERS[C_DOUBLE_QUOTE]=C_DOUBLE_QUOTE;LINK_MARKERS[C_SINGLE_QUOTE]=C_SINGLE_QUOTE;var COMMONMARK_LINK_MARKERS={};COMMONMARK_LINK_MARKERS[C_DOUBLE_QUOTE]=C_DOUBLE_QUOTE;COMMONMARK_LINK_MARKERS[C_SINGLE_QUOTE]=C_SINGLE_QUOTE;COMMONMARK_LINK_MARKERS[C_PAREN_OPEN]=C_PAREN_CLOSE;function link(eat,value,silent){var self=this;var subvalue="";var index=0;var character=value.charAt(0);var pedantic=self.options.pedantic;var commonmark=self.options.commonmark;var gfm=self.options.gfm;var closed;var count;var opening;var beforeURL;var beforeTitle;var subqueue;var hasMarker;var markers;var isImage;var content;var marker;var length;var title;var depth;var queue;var url;var now;var exit;var node;if(character==="!"){isImage=true;subvalue=character;character=value.charAt(++index)}if(character!==C_BRACKET_OPEN){return}if(!isImage&&self.inLink){return}subvalue+=character;queue="";index++;length=value.length;now=eat.now();depth=0;now.column+=index;now.offset+=index;while(index<length){character=value.charAt(index);subqueue=character;if(character===C_TICK){count=1;while(value.charAt(index+1)===C_TICK){subqueue+=character;index++;count++}if(!opening){opening=count}else if(count>=opening){opening=0}}else if(character===C_BACKSLASH){index++;subqueue+=value.charAt(index)}else if((!opening||gfm)&&character===C_BRACKET_OPEN){depth++}else if((!opening||gfm)&&character===C_BRACKET_CLOSE){if(depth){depth--}else{if(!pedantic){while(index<length){character=value.charAt(index+1);if(!whitespace(character)){break}subqueue+=character;index++}}if(value.charAt(index+1)!==C_PAREN_OPEN){return}subqueue+=C_PAREN_OPEN;closed=true;index++;break}}queue+=subqueue;subqueue="";index++}if(!closed){return}content=queue;subvalue+=queue+subqueue;index++;while(index<length){character=value.charAt(index);if(!whitespace(character)){break}subvalue+=character;index++}character=value.charAt(index);markers=commonmark?COMMONMARK_LINK_MARKERS:LINK_MARKERS;queue="";beforeURL=subvalue;if(character===C_LT){index++;beforeURL+=C_LT;while(index<length){character=value.charAt(index);if(character===C_GT){break}if(commonmark&&character==="\n"){return}queue+=character;index++}if(value.charAt(index)!==C_GT){return}subvalue+=C_LT+queue+C_GT;url=queue;index++}else{character=null;subqueue="";while(index<length){character=value.charAt(index);if(subqueue&&own.call(markers,character)){break}if(whitespace(character)){if(!pedantic){break}subqueue+=character}else{if(character===C_PAREN_OPEN){depth++}else if(character===C_PAREN_CLOSE){if(depth===0){break}depth--}queue+=subqueue;subqueue="";if(character===C_BACKSLASH){queue+=C_BACKSLASH;character=value.charAt(++index)}queue+=character}index++}subvalue+=queue;url=queue;index=subvalue.length}queue="";while(index<length){character=value.charAt(index);if(!whitespace(character)){break}queue+=character;index++}character=value.charAt(index);subvalue+=queue;if(queue&&own.call(markers,character)){index++;subvalue+=character;queue="";marker=markers[character];beforeTitle=subvalue;if(commonmark){while(index<length){character=value.charAt(index);if(character===marker){break}if(character===C_BACKSLASH){queue+=C_BACKSLASH;character=value.charAt(++index)}index++;queue+=character}character=value.charAt(index);if(character!==marker){return}title=queue;subvalue+=queue+character;index++;while(index<length){character=value.charAt(index);if(!whitespace(character)){break}subvalue+=character;index++}}else{subqueue="";while(index<length){character=value.charAt(index);if(character===marker){if(hasMarker){queue+=marker+subqueue;subqueue=""}hasMarker=true}else if(!hasMarker){queue+=character}else if(character===C_PAREN_CLOSE){subvalue+=queue+marker+subqueue;title=queue;break}else if(whitespace(character)){subqueue+=character}else{queue+=marker+subqueue+character;subqueue="";hasMarker=false}index++}}}if(value.charAt(index)!==C_PAREN_CLOSE){return}if(silent){return true}subvalue+=C_PAREN_CLOSE;url=self.decode.raw(self.unescape(url),eat(beforeURL).test().end,{nonTerminated:false});if(title){beforeTitle=eat(beforeTitle).test().end;title=self.decode.raw(self.unescape(title),beforeTitle)}node={type:isImage?"image":"link",title:title||null,url:url};if(isImage){node.alt=self.decode.raw(self.unescape(content),now)||null}else{exit=self.enterLink();node.children=self.tokenizeInline(content,now);exit()}return eat(subvalue)(node)}},1066:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(147);var locate=__webpack_require__(666);var normalize=__webpack_require__(436);module.exports=reference;reference.locator=locate;var T_LINK="link";var T_IMAGE="image";var T_FOOTNOTE="footnote";var REFERENCE_TYPE_SHORTCUT="shortcut";var REFERENCE_TYPE_COLLAPSED="collapsed";var REFERENCE_TYPE_FULL="full";var C_CARET="^";var C_BACKSLASH="\\";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";function reference(eat,value,silent){var self=this;var character=value.charAt(0);var index=0;var length=value.length;var subvalue="";var intro="";var type=T_LINK;var referenceType=REFERENCE_TYPE_SHORTCUT;var content;var identifier;var now;var node;var exit;var queue;var bracketed;var depth;if(character==="!"){type=T_IMAGE;intro=character;character=value.charAt(++index)}if(character!==C_BRACKET_OPEN){return}index++;intro+=character;queue="";if(self.options.footnotes&&value.charAt(index)===C_CARET){if(type===T_IMAGE){return}intro+=C_CARET;index++;type=T_FOOTNOTE}depth=0;while(index<length){character=value.charAt(index);if(character===C_BRACKET_OPEN){bracketed=true;depth++}else if(character===C_BRACKET_CLOSE){if(!depth){break}depth--}if(character===C_BACKSLASH){queue+=C_BACKSLASH;character=value.charAt(++index)}queue+=character;index++}subvalue=queue;content=queue;character=value.charAt(index);if(character!==C_BRACKET_CLOSE){return}index++;subvalue+=character;queue="";while(index<length){character=value.charAt(index);if(!whitespace(character)){break}queue+=character;index++}character=value.charAt(index);if(type!==T_FOOTNOTE&&character===C_BRACKET_OPEN){identifier="";queue+=character;index++;while(index<length){character=value.charAt(index);if(character===C_BRACKET_OPEN||character===C_BRACKET_CLOSE){break}if(character===C_BACKSLASH){identifier+=C_BACKSLASH;character=value.charAt(++index)}identifier+=character;index++}character=value.charAt(index);if(character===C_BRACKET_CLOSE){referenceType=identifier?REFERENCE_TYPE_FULL:REFERENCE_TYPE_COLLAPSED;queue+=identifier+character;index++}else{identifier=""}subvalue+=queue;queue=""}else{if(!content){return}identifier=content}if(referenceType!==REFERENCE_TYPE_FULL&&bracketed){return}subvalue=intro+subvalue;if(type===T_LINK&&self.inLink){return null}if(silent){return true}if(type===T_FOOTNOTE&&content.indexOf(" ")!==-1){return eat(subvalue)({type:"footnote",children:this.tokenizeInline(content,eat.now())})}now=eat.now();now.column+=intro.length;now.offset+=intro.length;identifier=referenceType===REFERENCE_TYPE_FULL?identifier:content;node={type:type+"Reference",identifier:normalize(identifier)};if(type===T_LINK||type===T_IMAGE){node.referenceType=referenceType}if(type===T_LINK){exit=self.enterLink();node.children=self.tokenizeInline(content,now);exit()}else if(type===T_IMAGE){node.alt=self.decode.raw(self.unescape(content),now)||null}return eat(subvalue)(node)}},1067:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(240);var whitespace=__webpack_require__(147);var locate=__webpack_require__(1068);module.exports=strong;strong.locator=locate;var C_ASTERISK="*";var C_UNDERSCORE="_";function strong(eat,value,silent){var self=this;var index=0;var character=value.charAt(index);var now;var pedantic;var marker;var queue;var subvalue;var length;var prev;if(character!==C_ASTERISK&&character!==C_UNDERSCORE||value.charAt(++index)!==character){return}pedantic=self.options.pedantic;marker=character;subvalue=marker+marker;length=value.length;index++;queue="";character="";if(pedantic&&whitespace(value.charAt(index))){return}while(index<length){prev=character;character=value.charAt(index);if(character===marker&&value.charAt(index+1)===marker&&(!pedantic||!whitespace(prev))){character=value.charAt(index+2);if(character!==marker){if(!trim(queue)){return}if(silent){return true}now=eat.now();now.column+=2;now.offset+=2;return eat(subvalue+queue+subvalue)({type:"strong",children:self.tokenizeInline(queue,now)})}}if(!pedantic&&character==="\\"){queue+=character;character=value.charAt(++index)}queue+=character;index++}}},1068:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var asterisk=value.indexOf("**",fromIndex);var underscore=value.indexOf("__",fromIndex);if(underscore===-1){return asterisk}if(asterisk===-1){return underscore}return underscore<asterisk?underscore:asterisk}},1069:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(240);var word=__webpack_require__(1070);var whitespace=__webpack_require__(147);var locate=__webpack_require__(1071);module.exports=emphasis;emphasis.locator=locate;var C_ASTERISK="*";var C_UNDERSCORE="_";function emphasis(eat,value,silent){var self=this;var index=0;var character=value.charAt(index);var now;var pedantic;var marker;var queue;var subvalue;var length;var prev;if(character!==C_ASTERISK&&character!==C_UNDERSCORE){return}pedantic=self.options.pedantic;subvalue=character;marker=character;length=value.length;index++;queue="";character="";if(pedantic&&whitespace(value.charAt(index))){return}while(index<length){prev=character;character=value.charAt(index);if(character===marker&&(!pedantic||!whitespace(prev))){character=value.charAt(++index);if(character!==marker){if(!trim(queue)||prev===marker){return}if(!pedantic&&marker===C_UNDERSCORE&&word(character)){queue+=marker;continue}if(silent){return true}now=eat.now();now.column++;now.offset++;return eat(subvalue+queue+marker)({type:"emphasis",children:self.tokenizeInline(queue,now)})}queue+=marker}if(!pedantic&&character==="\\"){queue+=character;character=value.charAt(++index)}queue+=character;index++}}},1070:function(module,exports,__webpack_require__){"use strict";module.exports=wordCharacter;var fromCode=String.fromCharCode;var re=/\w/;function wordCharacter(character){return re.test(typeof character==="number"?fromCode(character):character.charAt(0))}},1071:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var asterisk=value.indexOf("*",fromIndex);var underscore=value.indexOf("_",fromIndex);if(underscore===-1){return asterisk}if(asterisk===-1){return underscore}return underscore<asterisk?underscore:asterisk}},1072:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(147);var locate=__webpack_require__(1073);module.exports=strikethrough;strikethrough.locator=locate;var C_TILDE="~";var DOUBLE="~~";function strikethrough(eat,value,silent){var self=this;var character="";var previous="";var preceding="";var subvalue="";var index;var length;var now;if(!self.options.gfm||value.charAt(0)!==C_TILDE||value.charAt(1)!==C_TILDE||whitespace(value.charAt(2))){return}index=1;length=value.length;now=eat.now();now.column+=2;now.offset+=2;while(++index<length){character=value.charAt(index);if(character===C_TILDE&&previous===C_TILDE&&(!preceding||!whitespace(preceding))){if(silent){return true}return eat(DOUBLE+subvalue+DOUBLE)({type:"delete",children:self.tokenizeInline(subvalue,now)})}subvalue+=previous;preceding=previous;previous=character}}},1073:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("~~",fromIndex)}},1074:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(147);var locate=__webpack_require__(1075);module.exports=inlineCode;inlineCode.locator=locate;var C_TICK="`";function inlineCode(eat,value,silent){var length=value.length;var index=0;var queue="";var tickQueue="";var contentQueue;var subqueue;var count;var openingCount;var subvalue;var character;var found;var next;while(index<length){if(value.charAt(index)!==C_TICK){break}queue+=C_TICK;index++}if(!queue){return}subvalue=queue;openingCount=index;queue="";next=value.charAt(index);count=0;while(index<length){character=next;next=value.charAt(index+1);if(character===C_TICK){count++;tickQueue+=character}else{count=0;queue+=character}if(count&&next!==C_TICK){if(count===openingCount){subvalue+=queue+tickQueue;found=true;break}queue+=tickQueue;tickQueue=""}index++}if(!found){if(openingCount%2!==0){return}queue=""}if(silent){return true}contentQueue="";subqueue="";length=queue.length;index=-1;while(++index<length){character=queue.charAt(index);if(whitespace(character)){subqueue+=character;continue}if(subqueue){if(contentQueue){contentQueue+=subqueue}subqueue=""}contentQueue+=character}return eat(subvalue)({type:"inlineCode",value:contentQueue})}},1075:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("`",fromIndex)}},1076:function(module,exports,__webpack_require__){"use strict";var locate=__webpack_require__(1077);module.exports=hardBreak;hardBreak.locator=locate;var MIN_BREAK_LENGTH=2;function hardBreak(eat,value,silent){var length=value.length;var index=-1;var queue="";var character;while(++index<length){character=value.charAt(index);if(character==="\n"){if(index<MIN_BREAK_LENGTH){return}if(silent){return true}queue+=character;return eat(queue)({type:"break"})}if(character!==" "){return}queue+=character}}},1077:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var index=value.indexOf("\n",fromIndex);while(index>fromIndex){if(value.charAt(index-1)!==" "){break}index--}return index}},1078:function(module,exports,__webpack_require__){"use strict";module.exports=text;function text(eat,value,silent){var self=this;var methods;var tokenizers;var index;var length;var subvalue;var position;var tokenizer;var name;var min;var now;if(silent){return true}methods=self.inlineMethods;length=methods.length;tokenizers=self.inlineTokenizers;index=-1;min=value.length;while(++index<length){name=methods[index];if(name==="text"||!tokenizers[name]){continue}tokenizer=tokenizers[name].locator;if(!tokenizer){eat.file.fail("Missing locator: `"+name+"`")}position=tokenizer.call(self,value,1);if(position!==-1&&position<min){min=position}}subvalue=value.slice(0,min);now=eat.now();self.decode(subvalue,now,(function(content,position,source){eat(source||content)({type:"text",value:content})}))}},1079:function(module,exports,__webpack_require__){var visitWithParents=__webpack_require__(1080);function addListMetadata(){return function(ast){visitWithParents(ast,"list",(function(listNode,parents){var depth=0,i,n;for(i=0,n=parents.length;i<n;i++){if(parents[i].type==="list")depth+=1}for(i=0,n=listNode.children.length;i<n;i++){var child=listNode.children[i];child.index=i;child.ordered=listNode.ordered}listNode.depth=depth}));return ast}}module.exports=addListMetadata},1080:function(module,exports,__webpack_require__){"use strict";module.exports=visitParents;function visitParents(tree,type,visitor){var stack=[];if(typeof type==="function"){visitor=type;type=null}one(tree);function one(node){var result;if(!type||node.type===type){result=visitor(node,stack.concat())}if(node.children&&result!==false){return all(node.children,node)}return result}function all(children,parent){var length=children.length;var index=-1;var child;stack.push(parent);while(++index<length){child=children[index];if(child&&one(child)===false){return false}}stack.pop();return true}}},1081:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(344);var type="virtualHtml";var selfClosingRe=/^<(area|base|br|col|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)\s*\/?>$/i;var simpleTagRe=/^<(\/?)([a-z]+)\s*>$/;module.exports=function(tree){var open;var currentParent;visit(tree,"html",(function(node,index,parent){if(currentParent!==parent){open=[];currentParent=parent}var selfClosing=getSelfClosing(node);if(selfClosing){parent.children.splice(index,1,{type:type,tag:selfClosing,position:node.position});return true}var current=getSimpleTag(node,parent);if(!current){return true}var matching=findAndPull(open,current.tag);if(matching){parent.children.splice(index,0,virtual(current,matching,parent))}else if(!current.opening){open.push(current)}return true}),true);return tree};function findAndPull(open,matchingTag){var i=open.length;while(i--){if(open[i].tag===matchingTag){return open.splice(i,1)[0]}}return false}function getSimpleTag(node,parent){var match=node.value.match(simpleTagRe);return match?{tag:match[2],opening:!match[1],node:node}:false}function getSelfClosing(node){var match=node.value.match(selfClosingRe);return match?match[1]:false}function virtual(fromNode,toNode,parent){var fromIndex=parent.children.indexOf(fromNode.node);var toIndex=parent.children.indexOf(toNode.node);var extracted=parent.children.splice(fromIndex,toIndex-fromIndex+1);var children=extracted.slice(1,-1);return{type:type,children:children,tag:fromNode.tag,position:{start:fromNode.node.position.start,end:toNode.node.position.end,indent:[]}}}},1082:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(344);exports.ofType=function(types,mode){return function(node){types.forEach((function(type){return visit(node,type,disallow,true)}));return node};function disallow(node,index,parent){if(parent){untangle(node,index,parent,mode)}}};exports.ifNotMatch=function(allowNode,mode){return function(node){visit(node,disallow,true);return node};function disallow(node,index,parent){if(parent&&!allowNode(node,index,parent)){untangle(node,index,parent,mode)}}};function untangle(node,index,parent,mode){if(mode==="remove"){parent.children.splice(index,1)}else if(mode==="unwrap"){var args=[index,1];if(node.children){args=args.concat(node.children)}Array.prototype.splice.apply(parent.children,args)}}},1083:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(14);var xtend=__webpack_require__(175);var ReactIs=__webpack_require__(354);var defaultNodePosition={start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}};function astToReact(node,options){var parent=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var index=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var renderer=options.renderers[node.type];if(node.position===undefined){node.position=parent.node&&parent.node.position||defaultNodePosition}var pos=node.position.start;var key=[node.type,pos.line,pos.column,index].join("-");if(!ReactIs.isValidElementType(renderer)){throw new Error("Renderer for type `".concat(node.type,"` not defined or is not renderable"))}var nodeProps=getNodeProps(node,key,options,renderer,parent,index);return React.createElement(renderer,nodeProps,nodeProps.children||resolveChildren()||undefined);function resolveChildren(){return node.children&&node.children.map((function(childNode,i){return astToReact(childNode,options,{node:node,props:nodeProps},i)}))}}function getNodeProps(node,key,opts,renderer,parent,index){var props={key:key};var isTagRenderer=typeof renderer==="string";if(opts.sourcePos&&node.position){props["data-sourcepos"]=flattenPosition(node.position)}if(opts.rawSourcePos&&!isTagRenderer){props.sourcePosition=node.position}if(opts.includeNodeIndex&&parent.node&&parent.node.children&&!isTagRenderer){props.index=parent.node.children.indexOf(node);props.parentChildCount=parent.node.children.length}var ref=node.identifier!==null&&node.identifier!==undefined?opts.definitions[node.identifier]||{}:null;switch(node.type){case"root":assignDefined(props,{className:opts.className});break;case"text":props.nodeKey=key;props.children=node.value;break;case"heading":props.level=node.depth;break;case"list":props.start=node.start;props.ordered=node.ordered;props.tight=!node.loose;props.depth=node.depth;break;case"listItem":props.checked=node.checked;props.tight=!node.loose;props.ordered=node.ordered;props.index=node.index;props.children=getListItemChildren(node,parent).map((function(childNode,i){return astToReact(childNode,opts,{node:node,props:props},i)}));break;case"definition":assignDefined(props,{identifier:node.identifier,title:node.title,url:node.url});break;case"code":assignDefined(props,{language:node.lang&&node.lang.split(/\s/,1)[0]});break;case"inlineCode":props.children=node.value;props.inline=true;break;case"link":assignDefined(props,{title:node.title||undefined,target:typeof opts.linkTarget==="function"?opts.linkTarget(node.url,node.children,node.title):opts.linkTarget,href:opts.transformLinkUri?opts.transformLinkUri(node.url,node.children,node.title):node.url});break;case"image":assignDefined(props,{alt:node.alt||undefined,title:node.title||undefined,src:opts.transformImageUri?opts.transformImageUri(node.url,node.children,node.title,node.alt):node.url});break;case"linkReference":assignDefined(props,xtend(ref,{href:opts.transformLinkUri?opts.transformLinkUri(ref.href):ref.href}));break;case"imageReference":assignDefined(props,{src:opts.transformImageUri&&ref.href?opts.transformImageUri(ref.href,node.children,ref.title,node.alt):ref.href,title:ref.title||undefined,alt:node.alt||undefined});break;case"table":case"tableHead":case"tableBody":props.columnAlignment=node.align;break;case"tableRow":props.isHeader=parent.node.type==="tableHead";props.columnAlignment=parent.props.columnAlignment;break;case"tableCell":assignDefined(props,{isHeader:parent.props.isHeader,align:parent.props.columnAlignment[index]});break;case"virtualHtml":props.tag=node.tag;break;case"html":props.isBlock=node.position.start.line!==node.position.end.line;props.escapeHtml=opts.escapeHtml;props.skipHtml=opts.skipHtml;break;case"parsedHtml":{var parsedChildren;if(node.children){parsedChildren=node.children.map((function(child,i){return astToReact(child,opts,{node:node,props:props},i)}))}props.escapeHtml=opts.escapeHtml;props.skipHtml=opts.skipHtml;props.element=mergeNodeChildren(node,parsedChildren);break}default:assignDefined(props,xtend(node,{type:undefined,position:undefined,children:undefined}))}if(!isTagRenderer&&node.value){props.value=node.value}return props}function assignDefined(target,attrs){for(var key in attrs){if(typeof attrs[key]!=="undefined"){target[key]=attrs[key]}}}function mergeNodeChildren(node,parsedChildren){var el=node.element;if(Array.isArray(el)){var Fragment=React.Fragment||"div";return React.createElement(Fragment,null,el)}if(el.props.children||parsedChildren){var children=React.Children.toArray(el.props.children).concat(parsedChildren);return React.cloneElement(el,null,children)}return React.cloneElement(el,null)}function flattenPosition(pos){return[pos.start.line,":",pos.start.column,"-",pos.end.line,":",pos.end.column].map(String).join("")}function getListItemChildren(node,parent){if(node.loose){return node.children}if(parent.node&&node.index>0&&parent.node.children[node.index-1].loose){return node.children}return unwrapParagraphs(node)}function unwrapParagraphs(node){return node.children.reduce((function(array,child){return array.concat(child.type==="paragraph"?child.children||[]:[child])}),[])}module.exports=astToReact},1084:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(344);module.exports=function(node){visit(node,"table",wrap);return node};function wrap(table){var children=table.children;table.children=[{type:"tableHead",align:table.align,children:[children[0]],position:children[0].position}];if(children.length>1){table.children.push({type:"tableBody",align:table.align,children:children.slice(1),position:{start:children[1].position.start,end:children[children.length-1].position.end}})}}},1085:function(module,exports,__webpack_require__){"use strict";module.exports=function getDefinitions(node){var defs=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return(node.children||[]).reduce((function(definitions,child){if(child.type==="definition"){definitions[child.identifier]={href:child.url,title:child.title}}return getDefinitions(child,definitions)}),defs)}},1086:function(module,exports,__webpack_require__){"use strict";var protocols=["http","https","mailto","tel"];module.exports=function uriTransformer(uri){var url=(uri||"").trim();var first=url.charAt(0);if(first==="#"||first==="/"){return url}var colon=url.indexOf(":");if(colon===-1){return url}var length=protocols.length;var index=-1;while(++index<length){var protocol=protocols[index];if(colon===protocol.length&&url.slice(0,protocol.length).toLowerCase()===protocol){return url}}index=url.indexOf("?");if(index!==-1&&colon>index){return url}index=url.indexOf("#");if(index!==-1&&colon>index){return url}return"javascript:void(0)"}},1087:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(175);var React=__webpack_require__(14);var supportsStringRender=parseInt((React.version||"16").slice(0,2),10)>=16;var createElement=React.createElement;module.exports={break:"br",paragraph:"p",emphasis:"em",strong:"strong",thematicBreak:"hr",blockquote:"blockquote",delete:"del",link:"a",image:"img",linkReference:"a",imageReference:"img",table:SimpleRenderer.bind(null,"table"),tableHead:SimpleRenderer.bind(null,"thead"),tableBody:SimpleRenderer.bind(null,"tbody"),tableRow:SimpleRenderer.bind(null,"tr"),tableCell:TableCell,root:Root,text:TextRenderer,list:List,listItem:ListItem,definition:NullRenderer,heading:Heading,inlineCode:InlineCode,code:CodeBlock,html:Html,virtualHtml:VirtualHtml,parsedHtml:ParsedHtml};function TextRenderer(props){return supportsStringRender?props.children:createElement("span",null,props.children)}function Root(props){var useFragment=!props.className;var root=useFragment?React.Fragment||"div":"div";return createElement(root,useFragment?null:props,props.children)}function SimpleRenderer(tag,props){return createElement(tag,getCoreProps(props),props.children)}function TableCell(props){var style=props.align?{textAlign:props.align}:undefined;var coreProps=getCoreProps(props);return createElement(props.isHeader?"th":"td",style?xtend({style:style},coreProps):coreProps,props.children)}function Heading(props){return createElement("h".concat(props.level),getCoreProps(props),props.children)}function List(props){var attrs=getCoreProps(props);if(props.start!==null&&props.start!==1&&props.start!==undefined){attrs.start=props.start.toString()}return createElement(props.ordered?"ol":"ul",attrs,props.children)}function ListItem(props){var checkbox=null;if(props.checked!==null&&props.checked!==undefined){var checked=props.checked;checkbox=createElement("input",{type:"checkbox",checked:checked,readOnly:true})}return createElement("li",getCoreProps(props),checkbox,props.children)}function CodeBlock(props){var className=props.language&&"language-".concat(props.language);var code=createElement("code",className?{className:className}:null,props.value);return createElement("pre",getCoreProps(props),code)}function InlineCode(props){return createElement("code",getCoreProps(props),props.children)}function Html(props){if(props.skipHtml){return null}var tag=props.isBlock?"div":"span";if(props.escapeHtml){var comp=React.Fragment||tag;return createElement(comp,null,props.value)}var nodeProps={dangerouslySetInnerHTML:{__html:props.value}};return createElement(tag,nodeProps)}function ParsedHtml(props){return props["data-sourcepos"]?React.cloneElement(props.element,{"data-sourcepos":props["data-sourcepos"]}):props.element}function VirtualHtml(props){return createElement(props.tag,getCoreProps(props),props.children)}function NullRenderer(){return null}function getCoreProps(props){return props["data-sourcepos"]?{"data-sourcepos":props["data-sourcepos"]}:{}}},1088:function(module,exports,__webpack_require__){"use strict";var HtmlParser="__RMD_HTML_PARSER__";exports.HtmlParser=typeof Symbol==="undefined"?HtmlParser:Symbol(HtmlParser)},1089:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */(function defineMustache(global,factory){if(true&&exports&&typeof exports.nodeName!=="string"){factory(exports)}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[exports],__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{}})(this,(function mustacheFactory(mustache){var objectToString=Object.prototype.toString;var isArray=Array.isArray||function isArrayPolyfill(object){return objectToString.call(object)==="[object Array]"};function isFunction(object){return typeof object==="function"}function typeStr(obj){return isArray(obj)?"array":typeof obj}function escapeRegExp(string){return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(obj,propName){return obj!=null&&typeof obj==="object"&&propName in obj}var regExpTest=RegExp.prototype.test;function testRegExp(re,string){return regExpTest.call(re,string)}var nonSpaceRe=/\S/;function isWhitespace(string){return!testRegExp(nonSpaceRe,string)}var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function escapeHtml(string){return String(string).replace(/[&<>"'`=\/]/g,(function fromEntityMap(s){return entityMap[s]}))}var whiteRe=/\s*/;var spaceRe=/\s+/;var equalsRe=/\s*=/;var curlyRe=/\s*\}/;var tagRe=/#|\^|\/|>|\{|&|=|!/;function parseTemplate(template,tags){if(!template)return[];var sections=[];var tokens=[];var spaces=[];var hasTag=false;var nonSpace=false;function stripSpace(){if(hasTag&&!nonSpace){while(spaces.length)delete tokens[spaces.pop()]}else{spaces=[]}hasTag=false;nonSpace=false}var openingTagRe,closingTagRe,closingCurlyRe;function compileTags(tagsToCompile){if(typeof tagsToCompile==="string")tagsToCompile=tagsToCompile.split(spaceRe,2);if(!isArray(tagsToCompile)||tagsToCompile.length!==2)throw new Error("Invalid tags: "+tagsToCompile);openingTagRe=new RegExp(escapeRegExp(tagsToCompile[0])+"\\s*");closingTagRe=new RegExp("\\s*"+escapeRegExp(tagsToCompile[1]));closingCurlyRe=new RegExp("\\s*"+escapeRegExp("}"+tagsToCompile[1]))}compileTags(tags||mustache.tags);var scanner=new Scanner(template);var start,type,value,chr,token,openSection;while(!scanner.eos()){start=scanner.pos;value=scanner.scanUntil(openingTagRe);if(value){for(var i=0,valueLength=value.length;i<valueLength;++i){chr=value.charAt(i);if(isWhitespace(chr)){spaces.push(tokens.length)}else{nonSpace=true}tokens.push(["text",chr,start,start+1]);start+=1;if(chr==="\n")stripSpace()}}if(!scanner.scan(openingTagRe))break;hasTag=true;type=scanner.scan(tagRe)||"name";scanner.scan(whiteRe);if(type==="="){value=scanner.scanUntil(equalsRe);scanner.scan(equalsRe);scanner.scanUntil(closingTagRe)}else if(type==="{"){value=scanner.scanUntil(closingCurlyRe);scanner.scan(curlyRe);scanner.scanUntil(closingTagRe);type="&"}else{value=scanner.scanUntil(closingTagRe)}if(!scanner.scan(closingTagRe))throw new Error("Unclosed tag at "+scanner.pos);token=[type,value,start,scanner.pos];tokens.push(token);if(type==="#"||type==="^"){sections.push(token)}else if(type==="/"){openSection=sections.pop();if(!openSection)throw new Error('Unopened section "'+value+'" at '+start);if(openSection[1]!==value)throw new Error('Unclosed section "'+openSection[1]+'" at '+start)}else if(type==="name"||type==="{"||type==="&"){nonSpace=true}else if(type==="="){compileTags(value)}}openSection=sections.pop();if(openSection)throw new Error('Unclosed section "'+openSection[1]+'" at '+scanner.pos);return nestTokens(squashTokens(tokens))}function squashTokens(tokens){var squashedTokens=[];var token,lastToken;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];if(token){if(token[0]==="text"&&lastToken&&lastToken[0]==="text"){lastToken[1]+=token[1];lastToken[3]=token[3]}else{squashedTokens.push(token);lastToken=token}}}return squashedTokens}function nestTokens(tokens){var nestedTokens=[];var collector=nestedTokens;var sections=[];var token,section;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];switch(token[0]){case"#":case"^":collector.push(token);sections.push(token);collector=token[4]=[];break;case"/":section=sections.pop();section[5]=token[2];collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}}return nestedTokens}function Scanner(string){this.string=string;this.tail=string;this.pos=0}Scanner.prototype.eos=function eos(){return this.tail===""};Scanner.prototype.scan=function scan(re){var match=this.tail.match(re);if(!match||match.index!==0)return"";var string=match[0];this.tail=this.tail.substring(string.length);this.pos+=string.length;return string};Scanner.prototype.scanUntil=function scanUntil(re){var index=this.tail.search(re),match;switch(index){case-1:match=this.tail;this.tail="";break;case 0:match="";break;default:match=this.tail.substring(0,index);this.tail=this.tail.substring(index)}this.pos+=match.length;return match};function Context(view,parentContext){this.view=view;this.cache={".":this.view};this.parent=parentContext}Context.prototype.push=function push(view){return new Context(view,this)};Context.prototype.lookup=function lookup(name){var cache=this.cache;var value;if(cache.hasOwnProperty(name)){value=cache[name]}else{var context=this,names,index,lookupHit=false;while(context){if(name.indexOf(".")>0){value=context.view;names=name.split(".");index=0;while(value!=null&&index<names.length){if(index===names.length-1)lookupHit=hasProperty(value,names[index]);value=value[names[index++]]}}else{value=context.view[name];lookupHit=hasProperty(context.view,name)}if(lookupHit)break;context=context.parent}cache[name]=value}if(isFunction(value))value=value.call(this.view);return value};function Writer(){this.cache={}}Writer.prototype.clearCache=function clearCache(){this.cache={}};Writer.prototype.parse=function parse(template,tags){var cache=this.cache;var tokens=cache[template];if(tokens==null)tokens=cache[template]=parseTemplate(template,tags);return tokens};Writer.prototype.render=function render(template,view,partials){var tokens=this.parse(template);var context=view instanceof Context?view:new Context(view);return this.renderTokens(tokens,context,partials,template)};Writer.prototype.renderTokens=function renderTokens(tokens,context,partials,originalTemplate){var buffer="";var token,symbol,value;for(var i=0,numTokens=tokens.length;i<numTokens;++i){value=undefined;token=tokens[i];symbol=token[0];if(symbol==="#")value=this.renderSection(token,context,partials,originalTemplate);else if(symbol==="^")value=this.renderInverted(token,context,partials,originalTemplate);else if(symbol===">")value=this.renderPartial(token,context,partials,originalTemplate);else if(symbol==="&")value=this.unescapedValue(token,context);else if(symbol==="name")value=this.escapedValue(token,context);else if(symbol==="text")value=this.rawValue(token);if(value!==undefined)buffer+=value}return buffer};Writer.prototype.renderSection=function renderSection(token,context,partials,originalTemplate){var self=this;var buffer="";var value=context.lookup(token[1]);function subRender(template){return self.render(template,context,partials)}if(!value)return;if(isArray(value)){for(var j=0,valueLength=value.length;j<valueLength;++j){buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate)}}else if(typeof value==="object"||typeof value==="string"||typeof value==="number"){buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate)}else if(isFunction(value)){if(typeof originalTemplate!=="string")throw new Error("Cannot use higher-order sections without the original template");value=value.call(context.view,originalTemplate.slice(token[3],token[5]),subRender);if(value!=null)buffer+=value}else{buffer+=this.renderTokens(token[4],context,partials,originalTemplate)}return buffer};Writer.prototype.renderInverted=function renderInverted(token,context,partials,originalTemplate){var value=context.lookup(token[1]);if(!value||isArray(value)&&value.length===0)return this.renderTokens(token[4],context,partials,originalTemplate)};Writer.prototype.renderPartial=function renderPartial(token,context,partials){if(!partials)return;var value=isFunction(partials)?partials(token[1]):partials[token[1]];if(value!=null)return this.renderTokens(this.parse(value),context,partials,value)};Writer.prototype.unescapedValue=function unescapedValue(token,context){var value=context.lookup(token[1]);if(value!=null)return value};Writer.prototype.escapedValue=function escapedValue(token,context){var value=context.lookup(token[1]);if(value!=null)return mustache.escape(value)};Writer.prototype.rawValue=function rawValue(token){return token[1]};mustache.name="mustache.js";mustache.version="2.3.2";mustache.tags=["{{","}}"];var defaultWriter=new Writer;mustache.clearCache=function clearCache(){return defaultWriter.clearCache()};mustache.parse=function parse(template,tags){return defaultWriter.parse(template,tags)};mustache.render=function render(template,view,partials){if(typeof template!=="string"){throw new TypeError('Invalid template! Template should be a "string" '+'but "'+typeStr(template)+'" was given as the first '+"argument for mustache#render(template, view, partials)")}return defaultWriter.render(template,view,partials)};mustache.to_html=function to_html(template,view,partials,send){var result=mustache.render(template,view,partials);if(isFunction(send)){send(result)}else{return result}};mustache.escape=escapeHtml;mustache.Scanner=Scanner;mustache.Context=Context;mustache.Writer=Writer;return mustache}))},1090:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"getCaseSetting",(function(){return getCaseSetting}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _translations__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(213);var _types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(667);var _types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_types__WEBPACK_IMPORTED_MODULE_2__);const getCaseSetting=()=>({id:".jira",caseSettingFieldsComponent:Object(react__WEBPACK_IMPORTED_MODULE_0__["lazy"])(()=>__webpack_require__.e(7).then(__webpack_require__.bind(null,1096)))});const fieldLabels={issueType:_translations__WEBPACK_IMPORTED_MODULE_1__["d"],priority:_translations__WEBPACK_IMPORTED_MODULE_1__["g"],parent:_translations__WEBPACK_IMPORTED_MODULE_1__["f"]}},1091:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"getCaseSetting",(function(){return getCaseSetting}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _translations__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(345);var _types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(668);var _types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_types__WEBPACK_IMPORTED_MODULE_2__);const getCaseSetting=()=>({id:".resilient",caseSettingFieldsComponent:Object(react__WEBPACK_IMPORTED_MODULE_0__["lazy"])(()=>__webpack_require__.e(8).then(__webpack_require__.bind(null,1097)))});const fieldLabels={incidentTypes:_translations__WEBPACK_IMPORTED_MODULE_1__["b"],severityCode:_translations__WEBPACK_IMPORTED_MODULE_1__["e"]}},1092:function(module,exports,__webpack_require__){module.exports=minimatch;minimatch.Minimatch=Minimatch;var path={sep:"/"};try{path=__webpack_require__(431)}catch(er){}var GLOBSTAR=minimatch.GLOBSTAR=Minimatch.GLOBSTAR={};var expand=__webpack_require__(1093);var plTypes={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}};var qmark="[^/]";var star=qmark+"*?";var twoStarDot="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?";var twoStarNoDot="(?:(?!(?:\\/|^)\\.).)*?";var reSpecials=charSet("().*{}+?[]^$\\!");function charSet(s){return s.split("").reduce((function(set,c){set[c]=true;return set}),{})}var slashSplit=/\/+/;minimatch.filter=filter;function filter(pattern,options){options=options||{};return function(p,i,list){return minimatch(p,pattern,options)}}function ext(a,b){a=a||{};b=b||{};var t={};Object.keys(b).forEach((function(k){t[k]=b[k]}));Object.keys(a).forEach((function(k){t[k]=a[k]}));return t}minimatch.defaults=function(def){if(!def||!Object.keys(def).length)return minimatch;var orig=minimatch;var m=function minimatch(p,pattern,options){return orig.minimatch(p,pattern,ext(def,options))};m.Minimatch=function Minimatch(pattern,options){return new orig.Minimatch(pattern,ext(def,options))};return m};Minimatch.defaults=function(def){if(!def||!Object.keys(def).length)return Minimatch;return minimatch.defaults(def).Minimatch};function minimatch(p,pattern,options){if(typeof pattern!=="string"){throw new TypeError("glob pattern string required")}if(!options)options={};if(!options.nocomment&&pattern.charAt(0)==="#"){return false}if(pattern.trim()==="")return p==="";return new Minimatch(pattern,options).match(p)}function Minimatch(pattern,options){if(!(this instanceof Minimatch)){return new Minimatch(pattern,options)}if(typeof pattern!=="string"){throw new TypeError("glob pattern string required")}if(!options)options={};pattern=pattern.trim();if(path.sep!=="/"){pattern=pattern.split(path.sep).join("/")}this.options=options;this.set=[];this.pattern=pattern;this.regexp=null;this.negate=false;this.comment=false;this.empty=false;this.make()}Minimatch.prototype.debug=function(){};Minimatch.prototype.make=make;function make(){if(this._made)return;var pattern=this.pattern;var options=this.options;if(!options.nocomment&&pattern.charAt(0)==="#"){this.comment=true;return}if(!pattern){this.empty=true;return}this.parseNegate();var set=this.globSet=this.braceExpand();if(options.debug)this.debug=console.error;this.debug(this.pattern,set);set=this.globParts=set.map((function(s){return s.split(slashSplit)}));this.debug(this.pattern,set);set=set.map((function(s,si,set){return s.map(this.parse,this)}),this);this.debug(this.pattern,set);set=set.filter((function(s){return s.indexOf(false)===-1}));this.debug(this.pattern,set);this.set=set}Minimatch.prototype.parseNegate=parseNegate;function parseNegate(){var pattern=this.pattern;var negate=false;var options=this.options;var negateOffset=0;if(options.nonegate)return;for(var i=0,l=pattern.length;i<l&&pattern.charAt(i)==="!";i++){negate=!negate;negateOffset++}if(negateOffset)this.pattern=pattern.substr(negateOffset);this.negate=negate}minimatch.braceExpand=function(pattern,options){return braceExpand(pattern,options)};Minimatch.prototype.braceExpand=braceExpand;function braceExpand(pattern,options){if(!options){if(this instanceof Minimatch){options=this.options}else{options={}}}pattern=typeof pattern==="undefined"?this.pattern:pattern;if(typeof pattern==="undefined"){throw new TypeError("undefined pattern")}if(options.nobrace||!pattern.match(/\{.*\}/)){return[pattern]}return expand(pattern)}Minimatch.prototype.parse=parse;var SUBPARSE={};function parse(pattern,isSub){if(pattern.length>1024*64){throw new TypeError("pattern is too long")}var options=this.options;if(!options.noglobstar&&pattern==="**")return GLOBSTAR;if(pattern==="")return"";var re="";var hasMagic=!!options.nocase;var escaping=false;var patternListStack=[];var negativeLists=[];var stateChar;var inClass=false;var reClassStart=-1;var classStart=-1;var patternStart=pattern.charAt(0)==="."?"":options.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)";var self=this;function clearStateChar(){if(stateChar){switch(stateChar){case"*":re+=star;hasMagic=true;break;case"?":re+=qmark;hasMagic=true;break;default:re+="\\"+stateChar;break}self.debug("clearStateChar %j %j",stateChar,re);stateChar=false}}for(var i=0,len=pattern.length,c;i<len&&(c=pattern.charAt(i));i++){this.debug("%s\t%s %s %j",pattern,i,re,c);if(escaping&&reSpecials[c]){re+="\\"+c;escaping=false;continue}switch(c){case"/":return false;case"\\":clearStateChar();escaping=true;continue;case"?":case"*":case"+":case"@":case"!":this.debug("%s\t%s %s %j <-- stateChar",pattern,i,re,c);if(inClass){this.debug("  in class");if(c==="!"&&i===classStart+1)c="^";re+=c;continue}self.debug("call clearStateChar %j",stateChar);clearStateChar();stateChar=c;if(options.noext)clearStateChar();continue;case"(":if(inClass){re+="(";continue}if(!stateChar){re+="\\(";continue}patternListStack.push({type:stateChar,start:i-1,reStart:re.length,open:plTypes[stateChar].open,close:plTypes[stateChar].close});re+=stateChar==="!"?"(?:(?!(?:":"(?:";this.debug("plType %j %j",stateChar,re);stateChar=false;continue;case")":if(inClass||!patternListStack.length){re+="\\)";continue}clearStateChar();hasMagic=true;var pl=patternListStack.pop();re+=pl.close;if(pl.type==="!"){negativeLists.push(pl)}pl.reEnd=re.length;continue;case"|":if(inClass||!patternListStack.length||escaping){re+="\\|";escaping=false;continue}clearStateChar();re+="|";continue;case"[":clearStateChar();if(inClass){re+="\\"+c;continue}inClass=true;classStart=i;reClassStart=re.length;re+=c;continue;case"]":if(i===classStart+1||!inClass){re+="\\"+c;escaping=false;continue}if(inClass){var cs=pattern.substring(classStart+1,i);try{RegExp("["+cs+"]")}catch(er){var sp=this.parse(cs,SUBPARSE);re=re.substr(0,reClassStart)+"\\["+sp[0]+"\\]";hasMagic=hasMagic||sp[1];inClass=false;continue}}hasMagic=true;inClass=false;re+=c;continue;default:clearStateChar();if(escaping){escaping=false}else if(reSpecials[c]&&!(c==="^"&&inClass)){re+="\\"}re+=c}}if(inClass){cs=pattern.substr(classStart+1);sp=this.parse(cs,SUBPARSE);re=re.substr(0,reClassStart)+"\\["+sp[0];hasMagic=hasMagic||sp[1]}for(pl=patternListStack.pop();pl;pl=patternListStack.pop()){var tail=re.slice(pl.reStart+pl.open.length);this.debug("setting tail",re,pl);tail=tail.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(_,$1,$2){if(!$2){$2="\\"}return $1+$1+$2+"|"}));this.debug("tail=%j\n   %s",tail,tail,pl,re);var t=pl.type==="*"?star:pl.type==="?"?qmark:"\\"+pl.type;hasMagic=true;re=re.slice(0,pl.reStart)+t+"\\("+tail}clearStateChar();if(escaping){re+="\\\\"}var addPatternStart=false;switch(re.charAt(0)){case".":case"[":case"(":addPatternStart=true}for(var n=negativeLists.length-1;n>-1;n--){var nl=negativeLists[n];var nlBefore=re.slice(0,nl.reStart);var nlFirst=re.slice(nl.reStart,nl.reEnd-8);var nlLast=re.slice(nl.reEnd-8,nl.reEnd);var nlAfter=re.slice(nl.reEnd);nlLast+=nlAfter;var openParensBefore=nlBefore.split("(").length-1;var cleanAfter=nlAfter;for(i=0;i<openParensBefore;i++){cleanAfter=cleanAfter.replace(/\)[+*?]?/,"")}nlAfter=cleanAfter;var dollar="";if(nlAfter===""&&isSub!==SUBPARSE){dollar="$"}var newRe=nlBefore+nlFirst+nlAfter+dollar+nlLast;re=newRe}if(re!==""&&hasMagic){re="(?=.)"+re}if(addPatternStart){re=patternStart+re}if(isSub===SUBPARSE){return[re,hasMagic]}if(!hasMagic){return globUnescape(pattern)}var flags=options.nocase?"i":"";try{var regExp=new RegExp("^"+re+"$",flags)}catch(er){return new RegExp("$.")}regExp._glob=pattern;regExp._src=re;return regExp}minimatch.makeRe=function(pattern,options){return new Minimatch(pattern,options||{}).makeRe()};Minimatch.prototype.makeRe=makeRe;function makeRe(){if(this.regexp||this.regexp===false)return this.regexp;var set=this.set;if(!set.length){this.regexp=false;return this.regexp}var options=this.options;var twoStar=options.noglobstar?star:options.dot?twoStarDot:twoStarNoDot;var flags=options.nocase?"i":"";var re=set.map((function(pattern){return pattern.map((function(p){return p===GLOBSTAR?twoStar:typeof p==="string"?regExpEscape(p):p._src})).join("\\/")})).join("|");re="^(?:"+re+")$";if(this.negate)re="^(?!"+re+").*$";try{this.regexp=new RegExp(re,flags)}catch(ex){this.regexp=false}return this.regexp}minimatch.match=function(list,pattern,options){options=options||{};var mm=new Minimatch(pattern,options);list=list.filter((function(f){return mm.match(f)}));if(mm.options.nonull&&!list.length){list.push(pattern)}return list};Minimatch.prototype.match=match;function match(f,partial){this.debug("match",f,this.pattern);if(this.comment)return false;if(this.empty)return f==="";if(f==="/"&&partial)return true;var options=this.options;if(path.sep!=="/"){f=f.split(path.sep).join("/")}f=f.split(slashSplit);this.debug(this.pattern,"split",f);var set=this.set;this.debug(this.pattern,"set",set);var filename;var i;for(i=f.length-1;i>=0;i--){filename=f[i];if(filename)break}for(i=0;i<set.length;i++){var pattern=set[i];var file=f;if(options.matchBase&&pattern.length===1){file=[filename]}var hit=this.matchOne(file,pattern,partial);if(hit){if(options.flipNegate)return true;return!this.negate}}if(options.flipNegate)return false;return this.negate}Minimatch.prototype.matchOne=function(file,pattern,partial){var options=this.options;this.debug("matchOne",{this:this,file:file,pattern:pattern});this.debug("matchOne",file.length,pattern.length);for(var fi=0,pi=0,fl=file.length,pl=pattern.length;fi<fl&&pi<pl;fi++,pi++){this.debug("matchOne loop");var p=pattern[pi];var f=file[fi];this.debug(pattern,p,f);if(p===false)return false;if(p===GLOBSTAR){this.debug("GLOBSTAR",[pattern,p,f]);var fr=fi;var pr=pi+1;if(pr===pl){this.debug("** at the end");for(;fi<fl;fi++){if(file[fi]==="."||file[fi]===".."||!options.dot&&file[fi].charAt(0)===".")return false}return true}while(fr<fl){var swallowee=file[fr];this.debug("\nglobstar while",file,fr,pattern,pr,swallowee);if(this.matchOne(file.slice(fr),pattern.slice(pr),partial)){this.debug("globstar found match!",fr,fl,swallowee);return true}else{if(swallowee==="."||swallowee===".."||!options.dot&&swallowee.charAt(0)==="."){this.debug("dot detected!",file,fr,pattern,pr);break}this.debug("globstar swallow a segment, and continue");fr++}}if(partial){this.debug("\n>>> no match, partial?",file,fr,pattern,pr);if(fr===fl)return true}return false}var hit;if(typeof p==="string"){if(options.nocase){hit=f.toLowerCase()===p.toLowerCase()}else{hit=f===p}this.debug("string match",p,f,hit)}else{hit=f.match(p);this.debug("pattern match",p,f,hit)}if(!hit)return false}if(fi===fl&&pi===pl){return true}else if(fi===fl){return partial}else if(pi===pl){var emptyFileEnd=fi===fl-1&&file[fi]==="";return emptyFileEnd}throw new Error("wtf?")};function globUnescape(s){return s.replace(/\\(.)/g,"$1")}function regExpEscape(s){return s.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}},1093:function(module,exports,__webpack_require__){var concatMap=__webpack_require__(1094);var balanced=__webpack_require__(1095);module.exports=expandTop;var escSlash="\0SLASH"+Math.random()+"\0";var escOpen="\0OPEN"+Math.random()+"\0";var escClose="\0CLOSE"+Math.random()+"\0";var escComma="\0COMMA"+Math.random()+"\0";var escPeriod="\0PERIOD"+Math.random()+"\0";function numeric(str){return parseInt(str,10)==str?parseInt(str,10):str.charCodeAt(0)}function escapeBraces(str){return str.split("\\\\").join(escSlash).split("\\{").join(escOpen).split("\\}").join(escClose).split("\\,").join(escComma).split("\\.").join(escPeriod)}function unescapeBraces(str){return str.split(escSlash).join("\\").split(escOpen).join("{").split(escClose).join("}").split(escComma).join(",").split(escPeriod).join(".")}function parseCommaParts(str){if(!str)return[""];var parts=[];var m=balanced("{","}",str);if(!m)return str.split(",");var pre=m.pre;var body=m.body;var post=m.post;var p=pre.split(",");p[p.length-1]+="{"+body+"}";var postParts=parseCommaParts(post);if(post.length){p[p.length-1]+=postParts.shift();p.push.apply(p,postParts)}parts.push.apply(parts,p);return parts}function expandTop(str){if(!str)return[];if(str.substr(0,2)==="{}"){str="\\{\\}"+str.substr(2)}return expand(escapeBraces(str),true).map(unescapeBraces)}function identity(e){return e}function embrace(str){return"{"+str+"}"}function isPadded(el){return/^-?0\d/.test(el)}function lte(i,y){return i<=y}function gte(i,y){return i>=y}function expand(str,isTop){var expansions=[];var m=balanced("{","}",str);if(!m||/\$$/.test(m.pre))return[str];var isNumericSequence=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(m.body);var isAlphaSequence=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(m.body);var isSequence=isNumericSequence||isAlphaSequence;var isOptions=m.body.indexOf(",")>=0;if(!isSequence&&!isOptions){if(m.post.match(/,.*\}/)){str=m.pre+"{"+m.body+escClose+m.post;return expand(str)}return[str]}var n;if(isSequence){n=m.body.split(/\.\./)}else{n=parseCommaParts(m.body);if(n.length===1){n=expand(n[0],false).map(embrace);if(n.length===1){var post=m.post.length?expand(m.post,false):[""];return post.map((function(p){return m.pre+n[0]+p}))}}}var pre=m.pre;var post=m.post.length?expand(m.post,false):[""];var N;if(isSequence){var x=numeric(n[0]);var y=numeric(n[1]);var width=Math.max(n[0].length,n[1].length);var incr=n.length==3?Math.abs(numeric(n[2])):1;var test=lte;var reverse=y<x;if(reverse){incr*=-1;test=gte}var pad=n.some(isPadded);N=[];for(var i=x;test(i,y);i+=incr){var c;if(isAlphaSequence){c=String.fromCharCode(i);if(c==="\\")c=""}else{c=String(i);if(pad){var need=width-c.length;if(need>0){var z=new Array(need+1).join("0");if(i<0)c="-"+z+c.slice(1);else c=z+c}}}N.push(c)}}else{N=concatMap(n,(function(el){return expand(el,false)}))}for(var j=0;j<N.length;j++){for(var k=0;k<post.length;k++){var expansion=pre+N[j]+post[k];if(!isTop||isSequence||expansion)expansions.push(expansion)}}return expansions}},1094:function(module,exports){module.exports=function(xs,fn){var res=[];for(var i=0;i<xs.length;i++){var x=fn(xs[i],i);if(isArray(x))res.push.apply(res,x);else res.push(x)}return res};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},1095:function(module,exports,__webpack_require__){"use strict";module.exports=balanced;function balanced(a,b,str){if(a instanceof RegExp)a=maybeMatch(a,str);if(b instanceof RegExp)b=maybeMatch(b,str);var r=range(a,b,str);return r&&{start:r[0],end:r[1],pre:str.slice(0,r[0]),body:str.slice(r[0]+a.length,r[1]),post:str.slice(r[1]+b.length)}}function maybeMatch(reg,str){var m=str.match(reg);return m?m[0]:null}balanced.range=range;function range(a,b,str){var begs,beg,left,right,result;var ai=str.indexOf(a);var bi=str.indexOf(b,ai+1);var i=ai;if(ai>=0&&bi>0){begs=[];left=str.length;while(i>=0&&!result){if(i==ai){begs.push(i);ai=str.indexOf(a,i+1)}else if(begs.length==1){result=[begs.pop(),bi]}else{beg=begs.pop();if(beg<left){left=beg;right=bi}bi=str.indexOf(b,i+1)}i=ai<bi&&ai>=0?ai:bi}if(begs.length){result=[left,right]}}return result}},1101:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"subPluginClasses",(function(){return subPluginClasses}));var local_storage=__webpack_require__(307);var types_timeline=__webpack_require__(82);var external_kbnSharedDeps_React_=__webpack_require__(14);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(53);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(51);var external_kbnSharedDeps_StyledComponents_=__webpack_require__(52);var external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_);var api=__webpack_require__(145);var toasters=__webpack_require__(84);var translations=__webpack_require__(193);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useUpdateRule=()=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=_slicedToArray(_useState,2),rule=_useState2[0],setRule=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=_slicedToArray(_useState3,2),isSaved=_useState4[0],setIsSaved=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;setIsSaved(false);function saveRule(){return _saveRule.apply(this,arguments)}function _saveRule(){_saveRule=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(rule!=null)){_context.next=12;break}_context.prev=1;setIsLoading(true);_context.next=5;return Object(api["p"])({rule:rule,signal:abortCtrl.signal});case 5:if(isSubscribed){setIsSaved(true)}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);if(isSubscribed){Object(toasters["g"])({title:translations["g"],error:_context.t0,dispatchToaster:dispatchToaster})}case 11:if(isSubscribed){setIsLoading(false)}case 12:case"end":return _context.stop()}}),_callee,null,[[1,8]])})));return _saveRule.apply(this,arguments)}saveRule();return()=>{isSubscribed=false;abortCtrl.abort()}},[rule]);return[{isLoading:isLoading,isSaved:isSaved},setRule]};function use_create_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_create_rule_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_create_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_create_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_create_rule_slicedToArray(arr,i){return use_create_rule_arrayWithHoles(arr)||use_create_rule_iterableToArrayLimit(arr,i)||use_create_rule_unsupportedIterableToArray(arr,i)||use_create_rule_nonIterableRest()}function use_create_rule_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_create_rule_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_create_rule_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_create_rule_arrayLikeToArray(o,minLen)}function use_create_rule_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_create_rule_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_create_rule_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useCreateRule=()=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=use_create_rule_slicedToArray(_useState,2),rule=_useState2[0],setRule=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=use_create_rule_slicedToArray(_useState3,2),isSaved=_useState4[0],setIsSaved=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=use_create_rule_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_create_rule_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;setIsSaved(false);function saveRule(){return _saveRule.apply(this,arguments)}function _saveRule(){_saveRule=use_create_rule_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(rule!=null)){_context.next=12;break}_context.prev=1;setIsLoading(true);_context.next=5;return Object(api["b"])({rule:rule,signal:abortCtrl.signal});case 5:if(isSubscribed){setIsSaved(true)}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);if(isSubscribed){Object(toasters["g"])({title:translations["g"],error:_context.t0,dispatchToaster:dispatchToaster})}case 11:if(isSubscribed){setIsLoading(false)}case 12:case"end":return _context.stop()}}),_callee,null,[[1,8]])})));return _saveRule.apply(this,arguments)}saveRule();return()=>{isSubscribed=false;abortCtrl.abort()}},[rule]);return[{isLoading:isLoading,isSaved:isSaved},setRule]};var lib=__webpack_require__(0);var schemas=__webpack_require__(19);var types=__webpack_require__(437);const types_action=lib["exact"](lib["type"]({group:lib["string"],id:lib["string"],action_type_id:lib["string"],params:lib["record"](lib["string"],lib["any"])}));const MetaRule=lib["intersection"]([lib["type"]({from:lib["string"]}),lib["partial"]({throttle:lib["string"],kibana_siem_app_url:lib["string"]})]);const RuleSchema=lib["intersection"]([lib["type"]({author:schemas["b"],created_at:lib["string"],created_by:lib["string"],description:lib["string"],enabled:lib["boolean"],false_positives:lib["array"](lib["string"]),from:lib["string"],id:lib["string"],interval:lib["string"],immutable:lib["boolean"],name:lib["string"],max_signals:lib["number"],references:lib["array"](lib["string"]),risk_score:lib["number"],risk_score_mapping:schemas["i"],rule_id:lib["string"],severity:lib["string"],severity_mapping:schemas["l"],tags:lib["array"](lib["string"]),type:schemas["t"],to:lib["string"],threat:lib["array"](lib["unknown"]),updated_at:lib["string"],updated_by:lib["string"],actions:lib["array"](types_action),throttle:lib["union"]([lib["string"],lib["null"]])}),lib["partial"]({building_block_type:schemas["c"],anomaly_threshold:lib["number"],filters:lib["array"](lib["unknown"]),index:lib["array"](lib["string"]),language:lib["string"],license:schemas["f"],last_failure_at:lib["string"],last_failure_message:lib["string"],meta:MetaRule,machine_learning_job_id:lib["string"],output_index:lib["string"],query:lib["string"],rule_name_override:schemas["k"],saved_id:lib["string"],status:lib["string"],status_date:lib["string"],threshold:schemas["q"],threat_query:types["h"],threat_filters:types["d"],threat_index:types["e"],threat_mapping:types["g"],threat_language:types["f"],timeline_id:lib["string"],timeline_title:lib["string"],timestamp_override:schemas["s"],note:lib["string"],exceptions_list:types["b"],version:lib["number"]})]);const RulesSchema=lib["array"](RuleSchema);function use_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_rule_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_rule_slicedToArray(arr,i){return use_rule_arrayWithHoles(arr)||use_rule_iterableToArrayLimit(arr,i)||use_rule_unsupportedIterableToArray(arr,i)||use_rule_nonIterableRest()}function use_rule_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_rule_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_rule_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_rule_arrayLikeToArray(o,minLen)}function use_rule_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_rule_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_rule_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useRule=id=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=use_rule_slicedToArray(_useState,2),rule=_useState2[0],setRule=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(true),_useState4=use_rule_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_rule_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;function fetchData(_x){return _fetchData.apply(this,arguments)}function _fetchData(){_fetchData=use_rule_asyncToGenerator(regeneratorRuntime.mark((function _callee(idToFetch){var ruleResponse;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return Object(api["g"])({id:idToFetch,signal:abortCtrl.signal});case 4:ruleResponse=_context.sent;if(isSubscribed){setRule(ruleResponse)}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](0);if(isSubscribed){setRule(null);Object(toasters["g"])({title:translations["h"],error:_context.t0,dispatchToaster:dispatchToaster})}case 11:if(isSubscribed){setLoading(false)}case 12:case"end":return _context.stop()}}),_callee,null,[[0,8]])})));return _fetchData.apply(this,arguments)}if(id!=null){fetchData(id)}return()=>{isSubscribed=false;abortCtrl.abort()}},[id]);return[loading,rule]};var external_kbnSharedDeps_LodashFp_=__webpack_require__(6);function use_rules_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_rules_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_rules_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_rules_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_rules_slicedToArray(arr,i){return use_rules_arrayWithHoles(arr)||use_rules_iterableToArrayLimit(arr,i)||use_rules_unsupportedIterableToArray(arr,i)||use_rules_nonIterableRest()}function use_rules_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_rules_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_rules_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_rules_arrayLikeToArray(o,minLen)}function use_rules_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_rules_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_rules_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useRules=({pagination:pagination,filterOptions:filterOptions,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,dispatchRulesInReducer:dispatchRulesInReducer})=>{var _filterOptions$tags;const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=use_rules_slicedToArray(_useState,2),rules=_useState2[0],setRules=_useState2[1];const reFetchRules=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const _useState3=Object(external_kbnSharedDeps_React_["useState"])(true),_useState4=use_rules_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_rules_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const filterTags=(_filterOptions$tags=filterOptions.tags)===null||_filterOptions$tags===void 0?void 0:_filterOptions$tags.sort().join();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;function fetchData(){return _fetchData.apply(this,arguments)}function _fetchData(){_fetchData=use_rules_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var fetchRulesResult;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return Object(api["h"])({filterOptions:filterOptions,pagination:pagination,signal:abortCtrl.signal});case 4:fetchRulesResult=_context.sent;if(isSubscribed){setRules(fetchRulesResult);if(dispatchRulesInReducer!=null){dispatchRulesInReducer(fetchRulesResult.data,{page:fetchRulesResult.page,perPage:fetchRulesResult.perPage,total:fetchRulesResult.total})}}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](0);if(isSubscribed){Object(toasters["g"])({title:translations["h"],error:_context.t0,dispatchToaster:dispatchToaster});if(dispatchRulesInReducer!=null){dispatchRulesInReducer([],{})}}case 11:if(isSubscribed){setLoading(false)}case 12:case"end":return _context.stop()}}),_callee,null,[[0,8]])})));return _fetchData.apply(this,arguments)}fetchData();reFetchRules.current=(refreshPrePackagedRule=false)=>{fetchData();if(refreshPrePackagedRule&&refetchPrePackagedRulesStatus!=null){refetchPrePackagedRulesStatus()}};return()=>{isSubscribed=false;abortCtrl.abort()}},[pagination.page,pagination.perPage,filterOptions.filter,filterOptions.sortField,filterOptions.sortOrder,filterTags,filterOptions.showCustomRules,filterOptions.showElasticRules,refetchPrePackagedRulesStatus]);return[loading,rules,reFetchRules.current]};var elastic_datemath=__webpack_require__(30);var elastic_datemath_default=__webpack_require__.n(elastic_datemath);var external_kbnSharedDeps_Moment_=__webpack_require__(18);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var memoize_one_cjs=__webpack_require__(202);var memoize_one_cjs_default=__webpack_require__.n(memoize_one_cjs);var utility_types=__webpack_require__(169);const transformRuleToAlertAction=({group:group,id:id,action_type_id:action_type_id,params:params})=>({group:group,id:id,params:params,actionTypeId:action_type_id});const transformAlertToRuleAction=({group:group,id:id,actionTypeId:actionTypeId,params:params})=>({group:group,id:id,params:params,action_type_id:actionTypeId});var shared_imports=__webpack_require__(86);var external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(65);var external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(3);const ADVANCED_SETTINGS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"});const ADD_REFERENCE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"});const ADD_FALSE_POSITIVE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"});const GLOBAL_ENDPOINT_EXCEPTION_LIST=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"});const BUILDING_BLOCK=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"});const LOW=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"});const MEDIUM=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"});const HIGH=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"});const CRITICAL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"});const CUSTOM_MITRE_ATTACK_TECHNIQUES_REQUIRED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customMitreAttackTechniquesFieldRequiredError",{defaultMessage:"At least one Technique is required with a Tactic."});const URL_FORMAT_INVALID=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"Url is invalid format"});const ADD_RULE_NOTE_HELP_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."});const StyledEuiHealth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiHealth"]).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1mv5h4i-0"})(["line-height:inherit;"]);const severityOptions=[{value:"low",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis0},LOW)},{value:"medium",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis5},MEDIUM)},{value:"high",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis7},HIGH)},{value:"critical",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis9},CRITICAL)}];const defaultRiskScoreBySeverity={low:21,medium:47,high:73,critical:99};const getStepsData=({rule:rule,detailsView:detailsView=false})=>{const defineRuleData=getDefineStepsData(rule);const aboutRuleData=getAboutStepsData(rule,detailsView);const modifiedAboutRuleDetailsData=getModifiedAboutDetailsData(rule);const scheduleRuleData=getScheduleStepsData(rule);const ruleActionsData=getActionsStepsData(rule);return{aboutRuleData:aboutRuleData,modifiedAboutRuleDetailsData:modifiedAboutRuleDetailsData,defineRuleData:defineRuleData,scheduleRuleData:scheduleRuleData,ruleActionsData:ruleActionsData}};const getActionsStepsData=rule=>{const enabled=rule.enabled,throttle=rule.throttle,meta=rule.meta,_rule$actions=rule.actions,actions=_rule$actions===void 0?[]:_rule$actions;return{actions:actions===null||actions===void 0?void 0:actions.map(transformRuleToAlertAction),throttle:throttle,kibanaSiemAppUrl:meta===null||meta===void 0?void 0:meta.kibana_siem_app_url,enabled:enabled}};const getDefineStepsData=rule=>{var _rule$anomaly_thresho,_rule$machine_learnin,_rule$index,_rule$threat_index,_rule$threat_query,_rule$threat_language,_rule$threat_filters,_rule$threat_mapping,_rule$query,_rule$language,_rule$filters,_rule$timeline_id,_rule$timeline_title,_rule$threshold,_rule$threshold2;return{ruleType:rule.type,anomalyThreshold:(_rule$anomaly_thresho=rule.anomaly_threshold)!==null&&_rule$anomaly_thresho!==void 0?_rule$anomaly_thresho:50,machineLearningJobId:(_rule$machine_learnin=rule.machine_learning_job_id)!==null&&_rule$machine_learnin!==void 0?_rule$machine_learnin:"",index:(_rule$index=rule.index)!==null&&_rule$index!==void 0?_rule$index:[],threatIndex:(_rule$threat_index=rule.threat_index)!==null&&_rule$threat_index!==void 0?_rule$threat_index:[],threatQueryBar:{query:{query:(_rule$threat_query=rule.threat_query)!==null&&_rule$threat_query!==void 0?_rule$threat_query:"",language:(_rule$threat_language=rule.threat_language)!==null&&_rule$threat_language!==void 0?_rule$threat_language:""},filters:(_rule$threat_filters=rule.threat_filters)!==null&&_rule$threat_filters!==void 0?_rule$threat_filters:[],saved_id:undefined},threatMapping:(_rule$threat_mapping=rule.threat_mapping)!==null&&_rule$threat_mapping!==void 0?_rule$threat_mapping:[],queryBar:{query:{query:(_rule$query=rule.query)!==null&&_rule$query!==void 0?_rule$query:"",language:(_rule$language=rule.language)!==null&&_rule$language!==void 0?_rule$language:""},filters:(_rule$filters=rule.filters)!==null&&_rule$filters!==void 0?_rule$filters:[],saved_id:rule.saved_id},timeline:{id:(_rule$timeline_id=rule.timeline_id)!==null&&_rule$timeline_id!==void 0?_rule$timeline_id:null,title:(_rule$timeline_title=rule.timeline_title)!==null&&_rule$timeline_title!==void 0?_rule$timeline_title:null},threshold:{field:((_rule$threshold=rule.threshold)===null||_rule$threshold===void 0?void 0:_rule$threshold.field)?[rule.threshold.field]:[],value:"".concat(((_rule$threshold2=rule.threshold)===null||_rule$threshold2===void 0?void 0:_rule$threshold2.value)||100)}}};const getScheduleStepsData=rule=>{const interval=rule.interval,from=rule.from;const fromHumanizedValue=getHumanizedDuration(from,interval);return{interval:interval,from:fromHumanizedValue}};const getHumanizedDuration=(from,interval)=>{var _dateMath$parse,_dateMath$parse2;const fromValue=(_dateMath$parse=elastic_datemath_default.a.parse(from))!==null&&_dateMath$parse!==void 0?_dateMath$parse:external_kbnSharedDeps_Moment_default()();const intervalValue=(_dateMath$parse2=elastic_datemath_default.a.parse("now-".concat(interval)))!==null&&_dateMath$parse2!==void 0?_dateMath$parse2:external_kbnSharedDeps_Moment_default()();const fromDuration=external_kbnSharedDeps_Moment_default.a.duration(intervalValue.diff(fromValue));const intervalDuration=Math.floor(fromDuration.asSeconds());if(intervalDuration===0){return"0s"}if(intervalDuration%3600===0){return"".concat(intervalDuration/3600,"h")}else if(intervalDuration%60===0){return"".concat(intervalDuration/60,"m")}else{return"".concat(intervalDuration,"s")}};const getAboutStepsData=(rule,detailsView)=>{var _exceptionsList$some;const _determineDetailsValu=determineDetailsValue(rule,detailsView),name=_determineDetailsValu.name,description=_determineDetailsValu.description,note=_determineDetailsValu.note;const author=rule.author,buildingBlockType=rule.building_block_type,exceptionsList=rule.exceptions_list,license=rule.license,riskScoreMapping=rule.risk_score_mapping,ruleNameOverride=rule.rule_name_override,severityMapping=rule.severity_mapping,timestampOverride=rule.timestamp_override,references=rule.references,severity=rule.severity,falsePositives=rule.false_positives,riskScore=rule.risk_score,tags=rule.tags,threat=rule.threat;return{author:author,isAssociatedToEndpointList:(_exceptionsList$some=exceptionsList===null||exceptionsList===void 0?void 0:exceptionsList.some(({id:id})=>id===shared_imports["a"]))!==null&&_exceptionsList$some!==void 0?_exceptionsList$some:false,isBuildingBlock:buildingBlockType!==undefined,license:license!==null&&license!==void 0?license:"",ruleNameOverride:ruleNameOverride!==null&&ruleNameOverride!==void 0?ruleNameOverride:"",timestampOverride:timestampOverride!==null&&timestampOverride!==void 0?timestampOverride:"",name:name,description:description,note:note,references:references,severity:{value:severity,mapping:fillEmptySeverityMappings(severityMapping),isMappingChecked:severityMapping.length>0},tags:tags,riskScore:{value:riskScore,mapping:riskScoreMapping,isMappingChecked:riskScoreMapping.length>0},falsePositives:falsePositives,threat:threat}};const severitySortMapping={low:0,medium:1,high:2,critical:3};const fillEmptySeverityMappings=mappings=>{const missingMappings=severityOptions.flatMap(so=>mappings.find(mapping=>mapping.severity===so.value)==null?[{field:"",value:"",operator:"equals",severity:so.value}]:[]);return[...mappings,...missingMappings].sort((a,b)=>severitySortMapping[a.severity]-severitySortMapping[b.severity])};const determineDetailsValue=(rule,detailsView)=>{const name=rule.name,description=rule.description,note=rule.note;if(detailsView){return{name:"",description:"",note:""}}return{name:name,description:description,note:note!==null&&note!==void 0?note:""}};const getModifiedAboutDetailsData=rule=>{var _rule$note;return{note:(_rule$note=rule.note)!==null&&_rule$note!==void 0?_rule$note:"",description:rule.description}};const useQuery=()=>new URLSearchParams(Object(external_kbnSharedDeps_ReactRouterDom_["useLocation"])().search);const getPrePackagedRuleStatus=(rulesInstalled,rulesNotInstalled,rulesNotUpdated)=>{if(rulesNotInstalled!=null&&rulesInstalled===0&&rulesNotInstalled>0&&rulesNotUpdated===0){return"ruleNotInstalled"}else if(rulesInstalled!=null&&rulesInstalled>0&&rulesNotInstalled===0&&rulesNotUpdated===0){return"ruleInstalled"}else if(rulesInstalled!=null&&rulesNotInstalled!=null&&rulesInstalled>0&&rulesNotInstalled>0&&rulesNotUpdated===0){return"someRuleUninstall"}else if(rulesInstalled!=null&&rulesNotInstalled!=null&&rulesNotUpdated!=null&&rulesInstalled>0&&rulesNotInstalled>=0&&rulesNotUpdated>0){return"ruleNeedUpdate"}return"unknown"};const getPrePackagedTimelineStatus=(timelinesInstalled,timelinesNotInstalled,timelinesNotUpdated)=>{if(timelinesNotInstalled!=null&&timelinesInstalled===0&&timelinesNotInstalled>0&&timelinesNotUpdated===0){return"timelinesNotInstalled"}else if(timelinesInstalled!=null&&timelinesInstalled>0&&timelinesNotInstalled===0&&timelinesNotUpdated===0){return"timelinesInstalled"}else if(timelinesInstalled!=null&&timelinesNotInstalled!=null&&timelinesInstalled>0&&timelinesNotInstalled>0&&timelinesNotUpdated===0){return"someTimelineUninstall"}else if(timelinesInstalled!=null&&timelinesNotInstalled!=null&&timelinesNotUpdated!=null&&timelinesInstalled>0&&timelinesNotInstalled>=0&&timelinesNotUpdated>0){return"timelineNeedUpdate"}return"unknown"};const redirectToDetections=(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)=>isSignalIndexExists===false||isAuthenticated===false||hasEncryptionKey===false||needsListsConfiguration;const getRuleSpecificRuleParamKeys=ruleType=>{const queryRuleParams=["index","filters","language","query","saved_id"];switch(ruleType){case"machine_learning":return["anomaly_threshold","machine_learning_job_id"];case"threshold":return["threshold",...queryRuleParams];case"threat_match":case"query":case"saved_query":case"eql":return queryRuleParams}Object(utility_types["a"])(ruleType)};const getActionMessageRuleParams=ruleType=>{const commonRuleParamsKeys=["id","name","description","false_positives","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version"];const ruleParamsKeys=[...commonRuleParamsKeys,...getRuleSpecificRuleParamKeys(ruleType)].sort();return ruleParamsKeys};const getActionMessageParams=memoize_one_cjs_default()(ruleType=>{if(!ruleType){return{state:[],params:[]}}const actionMessageRuleParams=getActionMessageRuleParams(ruleType);return{state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link"},...actionMessageRuleParams.map(param=>{const extendedParam="rule.".concat(param);return{name:extendedParam,description:"context.".concat(extendedParam)}})]}});const helpers_userHasNoPermissions=canUserCRUD=>canUserCRUD!=null?!canUserCRUD:false;const MaxWidthEuiFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-97v502-0"})(["max-width:1000px;overflow:hidden;"]);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_pre_packaged_rules_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_pre_packaged_rules_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_pre_packaged_rules_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_pre_packaged_rules_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_pre_packaged_rules_slicedToArray(arr,i){return use_pre_packaged_rules_arrayWithHoles(arr)||use_pre_packaged_rules_iterableToArrayLimit(arr,i)||use_pre_packaged_rules_unsupportedIterableToArray(arr,i)||use_pre_packaged_rules_nonIterableRest()}function use_pre_packaged_rules_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_pre_packaged_rules_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_pre_packaged_rules_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_pre_packaged_rules_arrayLikeToArray(o,minLen)}function use_pre_packaged_rules_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_pre_packaged_rules_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_pre_packaged_rules_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const usePrePackagedRules=({canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,isSignalIndexExists:isSignalIndexExists})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])({createPrePackagedRules:null,refetchPrePackagedRulesStatus:null,rulesCustomInstalled:null,rulesInstalled:null,rulesNotInstalled:null,rulesNotUpdated:null,timelinesInstalled:null,timelinesNotInstalled:null,timelinesNotUpdated:null}),_useState2=use_pre_packaged_rules_slicedToArray(_useState,2),prepackagedDataStatus=_useState2[0],setPrepackagedDataStatus=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=use_pre_packaged_rules_slicedToArray(_useState3,2),loadingCreatePrePackagedRules=_useState4[0],setLoadingCreatePrePackagedRules=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(true),_useState6=use_pre_packaged_rules_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_pre_packaged_rules_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const getSuccessToastMessage=result=>{const rulesInstalled=result.rules_installed,rulesUpdated=result.rules_updated,timelinesInstalled=result.timelines_installed,timelinesUpdated=result.timelines_updated;if(rulesInstalled===0&&(timelinesInstalled>0||timelinesUpdated>0)){return translations["m"]}else if((rulesInstalled>0||rulesUpdated>0)&&timelinesInstalled===0){return translations["k"]}else{return translations["j"]}};Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchPrePackagedRules=function(){var _ref=use_pre_packaged_rules_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var prePackagedRuleStatusResponse;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return Object(api["j"])({signal:abortCtrl.signal});case 4:prePackagedRuleStatusResponse=_context.sent;if(isSubscribed){setPrepackagedDataStatus({createPrePackagedRules:createElasticRules,refetchPrePackagedRulesStatus:fetchPrePackagedRules,rulesCustomInstalled:prePackagedRuleStatusResponse.rules_custom_installed,rulesInstalled:prePackagedRuleStatusResponse.rules_installed,rulesNotInstalled:prePackagedRuleStatusResponse.rules_not_installed,rulesNotUpdated:prePackagedRuleStatusResponse.rules_not_updated,timelinesInstalled:prePackagedRuleStatusResponse.timelines_installed,timelinesNotInstalled:prePackagedRuleStatusResponse.timelines_not_installed,timelinesNotUpdated:prePackagedRuleStatusResponse.timelines_not_updated})}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](0);if(isSubscribed){setPrepackagedDataStatus({createPrePackagedRules:null,refetchPrePackagedRulesStatus:null,rulesCustomInstalled:null,rulesInstalled:null,rulesNotInstalled:null,rulesNotUpdated:null,timelinesInstalled:null,timelinesNotInstalled:null,timelinesNotUpdated:null});Object(toasters["g"])({title:translations["h"],error:_context.t0,dispatchToaster:dispatchToaster})}case 11:if(isSubscribed){setLoading(false)}case 12:case"end":return _context.stop()}}),_callee,null,[[0,8]])})));return function fetchPrePackagedRules(){return _ref.apply(this,arguments)}}();const createElasticRules=function(){var _ref2=use_pre_packaged_rules_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.abrupt("return",new Promise(function(){var _ref3=use_pre_packaged_rules_asyncToGenerator(regeneratorRuntime.mark((function _callee3(resolve){var result,iterationTryOfFetchingPrePackagedCount,timeoutId,stopTimeOut,reFetch;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;if(!(canUserCRUD&&hasIndexWrite&&isAuthenticated&&hasEncryptionKey&&isSignalIndexExists)){_context3.next=9;break}setLoadingCreatePrePackagedRules(true);_context3.next=5;return Object(api["a"])({signal:abortCtrl.signal});case 5:result=_context3.sent;if(isSubscribed){iterationTryOfFetchingPrePackagedCount=0;timeoutId=-1;stopTimeOut=()=>{if(timeoutId!==-1){window.clearTimeout(timeoutId)}};reFetch=()=>window.setTimeout(use_pre_packaged_rules_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var prePackagedRuleStatusResponse;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:iterationTryOfFetchingPrePackagedCount=iterationTryOfFetchingPrePackagedCount+1;_context2.next=3;return Object(api["j"])({signal:abortCtrl.signal});case 3:prePackagedRuleStatusResponse=_context2.sent;if(isSubscribed&&(prePackagedRuleStatusResponse.rules_not_installed===0&&prePackagedRuleStatusResponse.rules_not_updated===0&&prePackagedRuleStatusResponse.timelines_not_installed===0&&prePackagedRuleStatusResponse.timelines_not_updated===0||iterationTryOfFetchingPrePackagedCount>100)){setLoadingCreatePrePackagedRules(false);setPrepackagedDataStatus({createPrePackagedRules:createElasticRules,refetchPrePackagedRulesStatus:fetchPrePackagedRules,rulesCustomInstalled:prePackagedRuleStatusResponse.rules_custom_installed,rulesInstalled:prePackagedRuleStatusResponse.rules_installed,rulesNotInstalled:prePackagedRuleStatusResponse.rules_not_installed,rulesNotUpdated:prePackagedRuleStatusResponse.rules_not_updated,timelinesInstalled:prePackagedRuleStatusResponse.timelines_installed,timelinesNotInstalled:prePackagedRuleStatusResponse.timelines_not_installed,timelinesNotUpdated:prePackagedRuleStatusResponse.timelines_not_updated});Object(toasters["e"])(getSuccessToastMessage(result),dispatchToaster);stopTimeOut();resolve(true)}else{timeoutId=reFetch()}case 5:case"end":return _context2.stop()}}),_callee2)}))),300);timeoutId=reFetch()}_context3.next=10;break;case 9:resolve(false);case 10:_context3.next=15;break;case 12:_context3.prev=12;_context3.t0=_context3["catch"](0);if(isSubscribed){setLoadingCreatePrePackagedRules(false);Object(toasters["g"])({title:translations["i"],error:_context3.t0,dispatchToaster:dispatchToaster});resolve(false)}case 15:case"end":return _context3.stop()}}),_callee3,null,[[0,12]])})));return function(_x){return _ref3.apply(this,arguments)}}()));case 1:case"end":return _context4.stop()}}),_callee4)})));return function createElasticRules(){return _ref2.apply(this,arguments)}}();fetchPrePackagedRules();return()=>{isSubscribed=false;abortCtrl.abort()}},[canUserCRUD,hasIndexWrite,isAuthenticated,hasEncryptionKey,isSignalIndexExists]);const prePackagedRuleStatus=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getPrePackagedRuleStatus(prepackagedDataStatus.rulesInstalled,prepackagedDataStatus.rulesNotInstalled,prepackagedDataStatus.rulesNotUpdated),[prepackagedDataStatus.rulesInstalled,prepackagedDataStatus.rulesNotInstalled,prepackagedDataStatus.rulesNotUpdated]);const prePackagedTimelineStatus=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getPrePackagedTimelineStatus(prepackagedDataStatus.timelinesInstalled,prepackagedDataStatus.timelinesNotInstalled,prepackagedDataStatus.timelinesNotUpdated),[prepackagedDataStatus.timelinesInstalled,prepackagedDataStatus.timelinesNotInstalled,prepackagedDataStatus.timelinesNotUpdated]);const getLoadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_["useCallback"])(({isDisabled:isDisabled,onClick:onClick,fill:fill,"data-test-subj":dataTestSubj="loadPrebuiltRulesBtn"})=>(prePackagedRuleStatus==="ruleNotInstalled"||prePackagedTimelineStatus==="timelinesNotInstalled")&&prePackagedRuleStatus!=="someRuleUninstall"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:fill,iconType:"indexOpen",isLoading:loadingCreatePrePackagedRules,isDisabled:isDisabled,onClick:onClick,"data-test-subj":dataTestSubj},prePackagedRuleStatus==="ruleNotInstalled"&&prePackagedTimelineStatus==="timelinesNotInstalled"&&translations["b"],prePackagedRuleStatus==="ruleNotInstalled"&&prePackagedTimelineStatus!=="timelinesNotInstalled"&&translations["a"],prePackagedRuleStatus!=="ruleNotInstalled"&&prePackagedTimelineStatus==="timelinesNotInstalled"&&translations["c"]):null,[loadingCreatePrePackagedRules,prePackagedRuleStatus,prePackagedTimelineStatus]);const getMissingRulesOrTimelinesButtonTitle=Object(external_kbnSharedDeps_React_["useCallback"])((missingRules,missingTimelines)=>{if(missingRules>0&&missingTimelines===0)return translations["d"](missingRules);else if(missingRules===0&&missingTimelines>0)return translations["f"](missingTimelines);else if(missingRules>0&&missingTimelines>0)return translations["e"](missingRules,missingTimelines)},[]);const getReloadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_["useCallback"])(({isDisabled:isDisabled,onClick:onClick,fill:fill=false})=>{var _prepackagedDataStatu,_prepackagedDataStatu2;return prePackagedRuleStatus==="someRuleUninstall"||prePackagedTimelineStatus==="someTimelineUninstall"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:fill,iconType:"plusInCircle",isLoading:loadingCreatePrePackagedRules,isDisabled:isDisabled,onClick:onClick,"data-test-subj":"reloadPrebuiltRulesBtn"},getMissingRulesOrTimelinesButtonTitle((_prepackagedDataStatu=prepackagedDataStatus.rulesNotInstalled)!==null&&_prepackagedDataStatu!==void 0?_prepackagedDataStatu:0,(_prepackagedDataStatu2=prepackagedDataStatus.timelinesNotInstalled)!==null&&_prepackagedDataStatu2!==void 0?_prepackagedDataStatu2:0)):null},[getMissingRulesOrTimelinesButtonTitle,loadingCreatePrePackagedRules,prePackagedRuleStatus,prePackagedTimelineStatus,prepackagedDataStatus.rulesNotInstalled,prepackagedDataStatus.timelinesNotInstalled]);return _objectSpread(_objectSpread({loading:loading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules},prepackagedDataStatus),{},{getLoadPrebuiltRulesAndTemplatesButton:getLoadPrebuiltRulesAndTemplatesButton,getReloadPrebuiltRulesAndTemplatesButton:getReloadPrebuiltRulesAndTemplatesButton})};function use_rule_status_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_rule_status_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_rule_status_ownKeys(Object(source),true).forEach((function(key){use_rule_status_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_rule_status_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_rule_status_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_rule_status_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_rule_status_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_rule_status_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_rule_status_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_rule_status_slicedToArray(arr,i){return use_rule_status_arrayWithHoles(arr)||use_rule_status_iterableToArrayLimit(arr,i)||use_rule_status_unsupportedIterableToArray(arr,i)||use_rule_status_nonIterableRest()}function use_rule_status_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_rule_status_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_rule_status_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_rule_status_arrayLikeToArray(o,minLen)}function use_rule_status_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_rule_status_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_rule_status_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useRuleStatus=id=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=use_rule_status_slicedToArray(_useState,2),ruleStatus=_useState2[0],setRuleStatus=_useState2[1];const fetchRuleStatus=Object(external_kbnSharedDeps_React_["useRef"])(null);const _useState3=Object(external_kbnSharedDeps_React_["useState"])(true),_useState4=use_rule_status_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_rule_status_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchData=function(){var _ref=use_rule_status_asyncToGenerator(regeneratorRuntime.mark((function _callee(idToFetch){var ruleStatusResponse;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return Object(api["k"])({id:idToFetch,signal:abortCtrl.signal});case 4:ruleStatusResponse=_context.sent;if(isSubscribed){setRuleStatus(ruleStatusResponse[id!==null&&id!==void 0?id:""])}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](0);if(isSubscribed){setRuleStatus(null);Object(toasters["g"])({title:translations["h"],error:_context.t0,dispatchToaster:dispatchToaster})}case 11:if(isSubscribed){setLoading(false)}case 12:case"end":return _context.stop()}}),_callee,null,[[0,8]])})));return function fetchData(_x){return _ref.apply(this,arguments)}}();if(id!=null){fetchData(id)}fetchRuleStatus.current=fetchData;return()=>{isSubscribed=false;abortCtrl.abort()}},[id]);return[loading,ruleStatus,fetchRuleStatus.current]};const useRulesStatuses=rules=>{const _useState5=Object(external_kbnSharedDeps_React_["useState"])([]),_useState6=use_rule_status_slicedToArray(_useState5,2),rulesStatuses=_useState6[0],setRuleStatuses=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=use_rule_status_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];const _useStateToaster3=Object(toasters["h"])(),_useStateToaster4=use_rule_status_slicedToArray(_useStateToaster3,2),dispatchToaster=_useStateToaster4[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchData=function(){var _ref2=use_rule_status_asyncToGenerator(regeneratorRuntime.mark((function _callee2(ids){var ruleStatusesResponse;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setLoading(true);_context2.next=4;return Object(api["l"])({ids:ids,signal:abortCtrl.signal});case 4:ruleStatusesResponse=_context2.sent;if(isSubscribed){setRuleStatuses(rules.map(rule=>use_rule_status_objectSpread({id:rule.id,activate:rule.enabled,name:rule.name},ruleStatusesResponse[rule.id])))}_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2["catch"](0);if(isSubscribed){setRuleStatuses([]);Object(toasters["g"])({title:translations["h"],error:_context2.t0,dispatchToaster:dispatchToaster})}case 11:if(isSubscribed){setLoading(false)}case 12:case"end":return _context2.stop()}}),_callee2,null,[[0,8]])})));return function fetchData(_x2){return _ref2.apply(this,arguments)}}();if(rules!=null&&rules.length>0){fetchData(rules.map(r=>r.id))}return()=>{isSubscribed=false;abortCtrl.abort()}},[rules]);return{loading:loading,rulesStatuses:rulesStatuses}};var lib_kibana=__webpack_require__(80);var utils_api=__webpack_require__(288);const LISTS_INDEX_FETCH_FAILURE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.containers.detectionEngine.alerts.fetchListsIndex.errorDescription",{defaultMessage:"Failed to retrieve the lists index"});const LISTS_INDEX_CREATE_FAILURE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.containers.detectionEngine.alerts.createListsIndex.errorDescription",{defaultMessage:"Failed to create the lists index"});const LISTS_PRIVILEGES_READ_FAILURE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.containers.detectionEngine.alerts.readListsPrivileges.errorDescription",{defaultMessage:"Failed to retrieve lists privileges"});var use_app_toasts=__webpack_require__(127);function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function use_lists_index_slicedToArray(arr,i){return use_lists_index_arrayWithHoles(arr)||use_lists_index_iterableToArrayLimit(arr,i)||use_lists_index_unsupportedIterableToArray(arr,i)||use_lists_index_nonIterableRest()}function use_lists_index_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_lists_index_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_lists_index_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_lists_index_arrayLikeToArray(o,minLen)}function use_lists_index_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_lists_index_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_lists_index_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useListsIndex=()=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=use_lists_index_slicedToArray(_useState,2),indexExists=_useState2[0],setIndexExists=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(null),_useState4=use_lists_index_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];const lists=Object(lib_kibana["h"])().services.lists;const http=Object(lib_kibana["g"])();const _useAppToasts=Object(use_app_toasts["a"])(),addError=_useAppToasts.addError;const _useReadListIndex=Object(shared_imports["L"])(),readLoading=_useReadListIndex.loading,readListIndex=_useReadListIndex.start,readListIndexState=_objectWithoutProperties(_useReadListIndex,["loading","start"]);const _useCreateListIndex=Object(shared_imports["C"])(),createLoading=_useCreateListIndex.loading,createListIndex=_useCreateListIndex.start,createListIndexState=_objectWithoutProperties(_useCreateListIndex,["loading","start"]);const loading=readLoading||createLoading;const readIndex=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(lists){readListIndex({http:http})}},[http,lists,readListIndex]);const createIndex=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(lists){createListIndex({http:http})}},[createListIndex,http,lists]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!readLoading&&!error&&indexExists===null){readIndex()}},[error,indexExists,readIndex,readLoading]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(readListIndexState.result!=null){setIndexExists(readListIndexState.result.list_index&&readListIndexState.result.list_item_index)}},[readListIndexState.result]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(createListIndexState.result!=null){readIndex()}},[createListIndexState.result,readIndex]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const err=readListIndexState.error;if(err!=null){if(Object(utils_api["b"])(err)&&err.body.status_code===404){setIndexExists(false)}else{setError(err);addError(err,{title:LISTS_INDEX_FETCH_FAILURE})}}},[addError,readListIndexState.error]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const err=createListIndexState.error;if(err!=null){setError(err);addError(err,{title:LISTS_INDEX_CREATE_FAILURE})}},[addError,createListIndexState.error]);return{createIndex:createIndex,error:error,indexExists:indexExists,loading:loading}};function use_lists_privileges_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_lists_privileges_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_lists_privileges_ownKeys(Object(source),true).forEach((function(key){use_lists_privileges_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_lists_privileges_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_lists_privileges_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_lists_privileges_objectWithoutProperties(source,excluded){if(source==null)return{};var target=use_lists_privileges_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function use_lists_privileges_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function use_lists_privileges_slicedToArray(arr,i){return use_lists_privileges_arrayWithHoles(arr)||use_lists_privileges_iterableToArrayLimit(arr,i)||use_lists_privileges_unsupportedIterableToArray(arr,i)||use_lists_privileges_nonIterableRest()}function use_lists_privileges_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_lists_privileges_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_lists_privileges_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_lists_privileges_arrayLikeToArray(o,minLen)}function use_lists_privileges_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_lists_privileges_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_lists_privileges_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const use_lists_privileges_canManageIndex=indexPrivileges=>{const _Object$keys=Object.keys(indexPrivileges),_Object$keys2=use_lists_privileges_slicedToArray(_Object$keys,1),indexName=_Object$keys2[0];const privileges=indexPrivileges[indexName];if(privileges==null){return false}return privileges.manage};const use_lists_privileges_canWriteIndex=indexPrivileges=>{const _Object$keys3=Object.keys(indexPrivileges),_Object$keys4=use_lists_privileges_slicedToArray(_Object$keys3,1),indexName=_Object$keys4[0];const privileges=indexPrivileges[indexName];if(privileges==null){return false}return privileges.create||privileges.create_doc||privileges.index||privileges.write};const useListsPrivileges=()=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])({isAuthenticated:null,canManageIndex:null,canWriteIndex:null}),_useState2=use_lists_privileges_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];const lists=Object(lib_kibana["h"])().services.lists;const http=Object(lib_kibana["g"])();const _useAppToasts=Object(use_app_toasts["a"])(),addError=_useAppToasts.addError;const _useReadListPrivilege=Object(shared_imports["M"])(),loading=_useReadListPrivilege.loading,readListPrivileges=_useReadListPrivilege.start,readState=use_lists_privileges_objectWithoutProperties(_useReadListPrivilege,["loading","start"]);const readPrivileges=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(lists){readListPrivileges({http:http})}},[http,lists,readListPrivileges]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!loading&&!readState.error&&state.isAuthenticated===null){readPrivileges()}},[loading,readState.error,readPrivileges,state.isAuthenticated]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(readState.result!=null){try{const _ref=readState.result,isAuthenticated=_ref.is_authenticated,listsPrivileges=_ref.lists.index,listItemsPrivileges=_ref.listItems.index;setState({isAuthenticated:isAuthenticated,canManageIndex:use_lists_privileges_canManageIndex(listsPrivileges)&&use_lists_privileges_canManageIndex(listItemsPrivileges),canWriteIndex:use_lists_privileges_canWriteIndex(listsPrivileges)&&use_lists_privileges_canWriteIndex(listItemsPrivileges)})}catch(e){setState({isAuthenticated:null,canManageIndex:false,canWriteIndex:false})}}},[readState.result]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const error=readState.error;if(error!=null){setState({isAuthenticated:false,canManageIndex:false,canWriteIndex:false});addError(error,{title:LISTS_PRIVILEGES_READ_FAILURE})}},[addError,readState.error]);return use_lists_privileges_objectSpread({loading:loading},state)};const useListsConfig=()=>{const _useListsIndex=useListsIndex(),createIndex=_useListsIndex.createIndex,indexExists=_useListsIndex.indexExists,indexLoading=_useListsIndex.loading,indexError=_useListsIndex.error;const _useListsPrivileges=useListsPrivileges(),canManageIndex=_useListsPrivileges.canManageIndex,canWriteIndex=_useListsPrivileges.canWriteIndex,privilegesLoading=_useListsPrivileges.loading;const lists=Object(lib_kibana["h"])().services.lists;const enabled=lists!=null;const loading=indexLoading||privilegesLoading;const needsIndex=indexExists===false;const hasIndexError=indexError!=null;const needsIndexConfiguration=needsIndex&&(canManageIndex===false||canManageIndex===true&&hasIndexError);const needsConfiguration=!enabled||needsIndexConfiguration;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(needsIndex&&canManageIndex){createIndex()}},[canManageIndex,createIndex,needsIndex]);return{canManageIndex:canManageIndex,canWriteIndex:canWriteIndex,enabled:enabled,loading:loading,needsConfiguration:needsConfiguration}};var redirect_to_detection_engine=__webpack_require__(135);var wrapper_page=__webpack_require__(111);var spy_routes=__webpack_require__(107);var user_info=__webpack_require__(178);var external_kbnSharedDeps_Theme_euiDarkVars_=__webpack_require__(67);var external_kbnSharedDeps_Theme_euiDarkVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiDarkVars_);var constants=__webpack_require__(1);function use_eui_theme_slicedToArray(arr,i){return use_eui_theme_arrayWithHoles(arr)||use_eui_theme_iterableToArrayLimit(arr,i)||use_eui_theme_unsupportedIterableToArray(arr,i)||use_eui_theme_nonIterableRest()}function use_eui_theme_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_eui_theme_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_eui_theme_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_eui_theme_arrayLikeToArray(o,minLen)}function use_eui_theme_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_eui_theme_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_eui_theme_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useEuiTheme=()=>{const _useUiSetting$=Object(lib_kibana["l"])(constants["q"]),_useUiSetting$2=use_eui_theme_slicedToArray(_useUiSetting$,1),darkMode=_useUiSetting$2[0];return darkMode?external_kbnSharedDeps_Theme_euiDarkVars_default.a:external_kbnSharedDeps_Theme_euiLightVars_default.a};const RuleStatusIconStyled=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"RuleStatusIconStyled",componentId:"sc-1sbrlhw-0"})(["position:relative;svg{position:absolute;top:8px;left:9px;}"]);const RuleStatusIconComponent=({name:name,type:type})=>{const theme=useEuiTheme();const color=type==="passive"?theme.euiColorLightestShade:theme.euiColorPrimary;return external_kbnSharedDeps_React_default.a.createElement(RuleStatusIconStyled,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAvatar"],{color:color,name:type==="valid"?"":name,size:"l"}),type==="valid"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"check",color:theme.euiColorEmptyShade,size:"l"}):null)};const RuleStatusIcon=Object(external_kbnSharedDeps_React_["memo"])(RuleStatusIconComponent);const AccordionTitleComponent=({name:name,title:title,type:type})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(RuleStatusIcon,{name:name,type:type})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s",className:"euiAccordionForm__title"},external_kbnSharedDeps_React_default.a.createElement("h6",null,title))));const AccordionTitle=external_kbnSharedDeps_React_default.a.memo(AccordionTitleComponent);var isEqual=__webpack_require__(531);var isEqual_default=__webpack_require__.n(isEqual);var timeline_translations=__webpack_require__(250);var helpers=__webpack_require__(144);var has_ml_admin_permissions=__webpack_require__(332);var has_ml_license=__webpack_require__(267);var use_ml_capabilities=__webpack_require__(146);var cjs=__webpack_require__(229);var cjs_default=__webpack_require__.n(cjs);function helpers_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function helpers_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){helpers_ownKeys(Object(source),true).forEach((function(key){helpers_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{helpers_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function helpers_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function helpers_objectWithoutProperties(source,excluded){if(source==null)return{};var target=helpers_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function helpers_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const getTimeTypeValue=time=>{const timeObj={unit:"",value:0};const filterTimeVal=time.match(/\d+/g);const filterTimeType=time.match(/[a-zA-Z]+/g);if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(filterTimeVal)&&filterTimeVal!=null&&!isNaN(Number(filterTimeVal[0]))){timeObj.value=Number(filterTimeVal[0])}if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(filterTimeType)&&filterTimeType!=null&&["s","m","h"].includes(filterTimeType[0])){timeObj.unit=filterTimeType[0]}return timeObj};const stepIsValid=formData=>!!(formData===null||formData===void 0?void 0:formData.isValid)&&!!formData.data;const isDefineStep=input=>Object(external_kbnSharedDeps_LodashFp_["has"])("data.ruleType",input);const isAboutStep=input=>Object(external_kbnSharedDeps_LodashFp_["has"])("data.name",input);const isScheduleStep=input=>Object(external_kbnSharedDeps_LodashFp_["has"])("data.interval",input);const isActionsStep=input=>Object(external_kbnSharedDeps_LodashFp_["has"])("data.actions",input);const isMlFields=fields=>Object(external_kbnSharedDeps_LodashFp_["has"])("anomalyThreshold",fields);const isThresholdFields=fields=>Object(external_kbnSharedDeps_LodashFp_["has"])("threshold",fields);const isThreatMatchFields=fields=>Object(external_kbnSharedDeps_LodashFp_["has"])("threatIndex",fields);const filterRuleFieldsForType=(fields,type)=>{switch(type){case"machine_learning":const index=fields.index,queryBar=fields.queryBar,threshold=fields.threshold,threatIndex=fields.threatIndex,threatQueryBar=fields.threatQueryBar,threatMapping=fields.threatMapping,mlRuleFields=helpers_objectWithoutProperties(fields,["index","queryBar","threshold","threatIndex","threatQueryBar","threatMapping"]);return mlRuleFields;case"threshold":const anomalyThreshold=fields.anomalyThreshold,machineLearningJobId=fields.machineLearningJobId,_removedThreatIndex=fields.threatIndex,_removedThreatQueryBar=fields.threatQueryBar,_removedThreatMapping=fields.threatMapping,thresholdRuleFields=helpers_objectWithoutProperties(fields,["anomalyThreshold","machineLearningJobId","threatIndex","threatQueryBar","threatMapping"]);return thresholdRuleFields;case"threat_match":const _removedAnomalyThreshold=fields.anomalyThreshold,_removedMachineLearningJobId=fields.machineLearningJobId,_removedThreshold=fields.threshold,threatMatchRuleFields=helpers_objectWithoutProperties(fields,["anomalyThreshold","machineLearningJobId","threshold"]);return threatMatchRuleFields;case"query":case"saved_query":case"eql":const _a=fields.anomalyThreshold,_m=fields.machineLearningJobId,_t=fields.threshold,__removedThreatIndex=fields.threatIndex,__removedThreatQueryBar=fields.threatQueryBar,__removedThreatMapping=fields.threatMapping,queryRuleFields=helpers_objectWithoutProperties(fields,["anomalyThreshold","machineLearningJobId","threshold","threatIndex","threatQueryBar","threatMapping"]);return queryRuleFields}Object(utility_types["a"])(type)};const formatDefineStepData=defineStepData=>{var _ruleFields$queryBar,_ruleFields$queryBar2,_ruleFields$queryBar3,_ruleFields$queryBar4,_ruleFields$queryBar5,_ruleFields$queryBar6,_ruleFields$threshold,_ruleFields$threshold2,_parseInt,_ruleFields$threshold3,_ruleFields$queryBar7,_ruleFields$queryBar8,_ruleFields$queryBar9,_ruleFields$queryBar10,_ruleFields$queryBar11,_ruleFields$queryBar12,_ruleFields$threatQue,_ruleFields$threatQue2,_ruleFields$threatQue3,_ruleFields$threatQue4,_ruleFields$queryBar13,_ruleFields$queryBar14,_ruleFields$queryBar15,_ruleFields$queryBar16,_ruleFields$queryBar17,_ruleFields$queryBar18,_ruleFields$queryBar19;const ruleFields=filterRuleFieldsForType(defineStepData,defineStepData.ruleType);const ruleType=ruleFields.ruleType,timeline=ruleFields.timeline;const baseFields=helpers_objectSpread({type:ruleType},timeline.id!=null&&timeline.title!=null&&{timeline_id:timeline.id,timeline_title:timeline.title});const typeFields=isMlFields(ruleFields)?{anomaly_threshold:ruleFields.anomalyThreshold,machine_learning_job_id:ruleFields.machineLearningJobId}:isThresholdFields(ruleFields)?helpers_objectSpread({index:ruleFields.index,filters:(_ruleFields$queryBar=ruleFields.queryBar)===null||_ruleFields$queryBar===void 0?void 0:_ruleFields$queryBar.filters,language:(_ruleFields$queryBar2=ruleFields.queryBar)===null||_ruleFields$queryBar2===void 0?void 0:(_ruleFields$queryBar3=_ruleFields$queryBar2.query)===null||_ruleFields$queryBar3===void 0?void 0:_ruleFields$queryBar3.language,query:(_ruleFields$queryBar4=ruleFields.queryBar)===null||_ruleFields$queryBar4===void 0?void 0:(_ruleFields$queryBar5=_ruleFields$queryBar4.query)===null||_ruleFields$queryBar5===void 0?void 0:_ruleFields$queryBar5.query,saved_id:(_ruleFields$queryBar6=ruleFields.queryBar)===null||_ruleFields$queryBar6===void 0?void 0:_ruleFields$queryBar6.saved_id},ruleType==="threshold"&&{threshold:{field:(_ruleFields$threshold=(_ruleFields$threshold2=ruleFields.threshold)===null||_ruleFields$threshold2===void 0?void 0:_ruleFields$threshold2.field[0])!==null&&_ruleFields$threshold!==void 0?_ruleFields$threshold:"",value:(_parseInt=parseInt((_ruleFields$threshold3=ruleFields.threshold)===null||_ruleFields$threshold3===void 0?void 0:_ruleFields$threshold3.value,10))!==null&&_parseInt!==void 0?_parseInt:0}}):isThreatMatchFields(ruleFields)?{index:ruleFields.index,filters:(_ruleFields$queryBar7=ruleFields.queryBar)===null||_ruleFields$queryBar7===void 0?void 0:_ruleFields$queryBar7.filters,language:(_ruleFields$queryBar8=ruleFields.queryBar)===null||_ruleFields$queryBar8===void 0?void 0:(_ruleFields$queryBar9=_ruleFields$queryBar8.query)===null||_ruleFields$queryBar9===void 0?void 0:_ruleFields$queryBar9.language,query:(_ruleFields$queryBar10=ruleFields.queryBar)===null||_ruleFields$queryBar10===void 0?void 0:(_ruleFields$queryBar11=_ruleFields$queryBar10.query)===null||_ruleFields$queryBar11===void 0?void 0:_ruleFields$queryBar11.query,saved_id:(_ruleFields$queryBar12=ruleFields.queryBar)===null||_ruleFields$queryBar12===void 0?void 0:_ruleFields$queryBar12.saved_id,threat_index:ruleFields.threatIndex,threat_query:(_ruleFields$threatQue=ruleFields.threatQueryBar)===null||_ruleFields$threatQue===void 0?void 0:(_ruleFields$threatQue2=_ruleFields$threatQue.query)===null||_ruleFields$threatQue2===void 0?void 0:_ruleFields$threatQue2.query,threat_mapping:ruleFields.threatMapping,threat_language:(_ruleFields$threatQue3=ruleFields.threatQueryBar)===null||_ruleFields$threatQue3===void 0?void 0:(_ruleFields$threatQue4=_ruleFields$threatQue3.query)===null||_ruleFields$threatQue4===void 0?void 0:_ruleFields$threatQue4.language}:helpers_objectSpread({index:ruleFields.index,filters:(_ruleFields$queryBar13=ruleFields.queryBar)===null||_ruleFields$queryBar13===void 0?void 0:_ruleFields$queryBar13.filters,language:(_ruleFields$queryBar14=ruleFields.queryBar)===null||_ruleFields$queryBar14===void 0?void 0:(_ruleFields$queryBar15=_ruleFields$queryBar14.query)===null||_ruleFields$queryBar15===void 0?void 0:_ruleFields$queryBar15.language,query:(_ruleFields$queryBar16=ruleFields.queryBar)===null||_ruleFields$queryBar16===void 0?void 0:(_ruleFields$queryBar17=_ruleFields$queryBar16.query)===null||_ruleFields$queryBar17===void 0?void 0:_ruleFields$queryBar17.query,saved_id:(_ruleFields$queryBar18=ruleFields.queryBar)===null||_ruleFields$queryBar18===void 0?void 0:_ruleFields$queryBar18.saved_id},ruleType==="query"&&((_ruleFields$queryBar19=ruleFields.queryBar)===null||_ruleFields$queryBar19===void 0?void 0:_ruleFields$queryBar19.saved_id)&&{type:"saved_query"});return helpers_objectSpread(helpers_objectSpread({},baseFields),typeFields)};const formatScheduleStepData=scheduleData=>{const formatScheduleData=Object.assign({},scheduleData);if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(formatScheduleData.interval)&&!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(formatScheduleData.from)){const _getTimeTypeValue=getTimeTypeValue(formatScheduleData.interval),intervalUnit=_getTimeTypeValue.unit,intervalValue=_getTimeTypeValue.value;const _getTimeTypeValue2=getTimeTypeValue(formatScheduleData.from),fromUnit=_getTimeTypeValue2.unit,fromValue=_getTimeTypeValue2.value;const duration=external_kbnSharedDeps_Moment_default.a.duration(intervalValue,intervalUnit);duration.add(fromValue,fromUnit);formatScheduleData.from="now-".concat(duration.asSeconds(),"s");formatScheduleData.to="now"}return helpers_objectSpread(helpers_objectSpread({},formatScheduleData),{},{meta:{from:scheduleData.from}})};const formatAboutStepData=(aboutStepData,exceptionsList)=>{const author=aboutStepData.author,falsePositives=aboutStepData.falsePositives,references=aboutStepData.references,riskScore=aboutStepData.riskScore,severity=aboutStepData.severity,threat=aboutStepData.threat,isAssociatedToEndpointList=aboutStepData.isAssociatedToEndpointList,isBuildingBlock=aboutStepData.isBuildingBlock,note=aboutStepData.note,ruleNameOverride=aboutStepData.ruleNameOverride,timestampOverride=aboutStepData.timestampOverride,rest=helpers_objectWithoutProperties(aboutStepData,["author","falsePositives","references","riskScore","severity","threat","isAssociatedToEndpointList","isBuildingBlock","note","ruleNameOverride","timestampOverride"]);const detectionExceptionLists=exceptionsList!=null?exceptionsList.filter(list=>list.type!=="endpoint"):[];const resp=helpers_objectSpread(helpers_objectSpread(helpers_objectSpread(helpers_objectSpread({author:author.filter(item=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(item))},isBuildingBlock?{building_block_type:"default"}:{}),isAssociatedToEndpointList?{exceptions_list:[{id:shared_imports["a"],list_id:shared_imports["a"],namespace_type:"agnostic",type:"endpoint"},...detectionExceptionLists]}:exceptionsList!=null?{exceptions_list:[...detectionExceptionLists]}:{}),{},{false_positives:falsePositives.filter(item=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(item)),references:references.filter(item=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(item)),risk_score:riskScore.value,risk_score_mapping:riskScore.isMappingChecked?riskScore.mapping.filter(m=>m.field!=null&&m.field!==""):[],rule_name_override:ruleNameOverride!==""?ruleNameOverride:undefined,severity:severity.value,severity_mapping:severity.isMappingChecked?severity.mapping.filter(m=>m.field!=null&&m.field!==""&&m.value!=null):[],threat:threat.filter(singleThreat=>singleThreat.tactic.name!=="none").map(singleThreat=>helpers_objectSpread(helpers_objectSpread({},singleThreat),{},{framework:"MITRE ATT&CK",technique:singleThreat.technique.map(technique=>{const id=technique.id,name=technique.name,reference=technique.reference;return{id:id,name:name,reference:reference}})})),timestamp_override:timestampOverride!==""?timestampOverride:undefined},!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(note)?{note:note}:{}),rest);return resp};const formatActionsStepData=actionsStepData=>{const _actionsStepData$acti=actionsStepData.actions,actions=_actionsStepData$acti===void 0?[]:_actionsStepData$acti,enabled=actionsStepData.enabled,kibanaSiemAppUrl=actionsStepData.kibanaSiemAppUrl,_actionsStepData$thro=actionsStepData.throttle,throttle=_actionsStepData$thro===void 0?constants["X"]:_actionsStepData$thro;return{actions:actions.map(transformAlertToRuleAction),enabled:enabled,throttle:actions.length?throttle:constants["X"],meta:{kibana_siem_app_url:kibanaSiemAppUrl}}};const formatRule=(defineStepData,aboutStepData,scheduleData,actionsData,rule)=>cjs_default.a.all([formatDefineStepData(defineStepData),formatAboutStepData(aboutStepData,rule===null||rule===void 0?void 0:rule.exceptions_list),formatScheduleStepData(scheduleData),formatActionsStepData(actionsData)]);var rules_types=__webpack_require__(211);var public_=__webpack_require__(56);const FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"});const THREAT_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"});const FIELD_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"});const MATCHES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"});const AND=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"});const OR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"});const SEVERITY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"});const DEFAULT_SEVERITY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"});const SOURCE_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"});const SOURCE_VALUE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"});const SEVERITY_MAPPING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"});const SEVERITY_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."});const SEVERITY_MAPPING_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."});const SEVERITY_MAPPING_DETAILS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."});const RISK_SCORE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"});const DEFAULT_RISK_SCORE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"});const RISK_SCORE_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"signal.rule.risk_score"});const translations_SOURCE_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"});const RISK_SCORE_MAPPING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"});const RISK_SCORE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."});const RISK_SCORE_MAPPING_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."});const RISK_SCORE_MAPPING_DETAILS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."});const tactics=[{name:"Collection",id:"TA0009",reference:"https://attack.mitre.org/tactics/TA0009"},{name:"Command and Control",id:"TA0011",reference:"https://attack.mitre.org/tactics/TA0011"},{name:"Credential Access",id:"TA0006",reference:"https://attack.mitre.org/tactics/TA0006"},{name:"Defense Evasion",id:"TA0005",reference:"https://attack.mitre.org/tactics/TA0005"},{name:"Discovery",id:"TA0007",reference:"https://attack.mitre.org/tactics/TA0007"},{name:"Execution",id:"TA0002",reference:"https://attack.mitre.org/tactics/TA0002"},{name:"Exfiltration",id:"TA0010",reference:"https://attack.mitre.org/tactics/TA0010"},{name:"Impact",id:"TA0040",reference:"https://attack.mitre.org/tactics/TA0040"},{name:"Initial Access",id:"TA0001",reference:"https://attack.mitre.org/tactics/TA0001"},{name:"Lateral Movement",id:"TA0008",reference:"https://attack.mitre.org/tactics/TA0008"},{name:"Persistence",id:"TA0003",reference:"https://attack.mitre.org/tactics/TA0003"},{name:"Privilege Escalation",id:"TA0004",reference:"https://attack.mitre.org/tactics/TA0004"}];const tacticsOptions=[{id:"TA0009",name:"Collection",reference:"https://attack.mitre.org/tactics/TA0009",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.collectionDescription",{defaultMessage:"Collection (TA0009)"}),value:"collection"},{id:"TA0011",name:"Command and Control",reference:"https://attack.mitre.org/tactics/TA0011",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.commandAndControlDescription",{defaultMessage:"Command and Control (TA0011)"}),value:"commandAndControl"},{id:"TA0006",name:"Credential Access",reference:"https://attack.mitre.org/tactics/TA0006",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.credentialAccessDescription",{defaultMessage:"Credential Access (TA0006)"}),value:"credentialAccess"},{id:"TA0005",name:"Defense Evasion",reference:"https://attack.mitre.org/tactics/TA0005",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.defenseEvasionDescription",{defaultMessage:"Defense Evasion (TA0005)"}),value:"defenseEvasion"},{id:"TA0007",name:"Discovery",reference:"https://attack.mitre.org/tactics/TA0007",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.discoveryDescription",{defaultMessage:"Discovery (TA0007)"}),value:"discovery"},{id:"TA0002",name:"Execution",reference:"https://attack.mitre.org/tactics/TA0002",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.executionDescription",{defaultMessage:"Execution (TA0002)"}),value:"execution"},{id:"TA0010",name:"Exfiltration",reference:"https://attack.mitre.org/tactics/TA0010",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.exfiltrationDescription",{defaultMessage:"Exfiltration (TA0010)"}),value:"exfiltration"},{id:"TA0040",name:"Impact",reference:"https://attack.mitre.org/tactics/TA0040",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.impactDescription",{defaultMessage:"Impact (TA0040)"}),value:"impact"},{id:"TA0001",name:"Initial Access",reference:"https://attack.mitre.org/tactics/TA0001",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.initialAccessDescription",{defaultMessage:"Initial Access (TA0001)"}),value:"initialAccess"},{id:"TA0008",name:"Lateral Movement",reference:"https://attack.mitre.org/tactics/TA0008",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.lateralMovementDescription",{defaultMessage:"Lateral Movement (TA0008)"}),value:"lateralMovement"},{id:"TA0003",name:"Persistence",reference:"https://attack.mitre.org/tactics/TA0003",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.persistenceDescription",{defaultMessage:"Persistence (TA0003)"}),value:"persistence"},{id:"TA0004",name:"Privilege Escalation",reference:"https://attack.mitre.org/tactics/TA0004",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.privilegeEscalationDescription",{defaultMessage:"Privilege Escalation (TA0004)"}),value:"privilegeEscalation"}];const mitre_tactics_techniques_technique=[{name:".bash_profile and .bashrc",id:"T1156",reference:"https://attack.mitre.org/techniques/T1156",tactics:["persistence"]},{name:"Access Token Manipulation",id:"T1134",reference:"https://attack.mitre.org/techniques/T1134",tactics:["defense-evasion","privilege-escalation"]},{name:"Accessibility Features",id:"T1015",reference:"https://attack.mitre.org/techniques/T1015",tactics:["persistence","privilege-escalation"]},{name:"Account Access Removal",id:"T1531",reference:"https://attack.mitre.org/techniques/T1531",tactics:["impact"]},{name:"Account Discovery",id:"T1087",reference:"https://attack.mitre.org/techniques/T1087",tactics:["discovery"]},{name:"Account Manipulation",id:"T1098",reference:"https://attack.mitre.org/techniques/T1098",tactics:["credential-access","persistence"]},{name:"AppCert DLLs",id:"T1182",reference:"https://attack.mitre.org/techniques/T1182",tactics:["persistence","privilege-escalation"]},{name:"AppInit DLLs",id:"T1103",reference:"https://attack.mitre.org/techniques/T1103",tactics:["persistence","privilege-escalation"]},{name:"AppleScript",id:"T1155",reference:"https://attack.mitre.org/techniques/T1155",tactics:["execution","lateral-movement"]},{name:"Application Access Token",id:"T1527",reference:"https://attack.mitre.org/techniques/T1527",tactics:["defense-evasion","lateral-movement"]},{name:"Application Deployment Software",id:"T1017",reference:"https://attack.mitre.org/techniques/T1017",tactics:["lateral-movement"]},{name:"Application Shimming",id:"T1138",reference:"https://attack.mitre.org/techniques/T1138",tactics:["persistence","privilege-escalation"]},{name:"Application Window Discovery",id:"T1010",reference:"https://attack.mitre.org/techniques/T1010",tactics:["discovery"]},{name:"Audio Capture",id:"T1123",reference:"https://attack.mitre.org/techniques/T1123",tactics:["collection"]},{name:"Authentication Package",id:"T1131",reference:"https://attack.mitre.org/techniques/T1131",tactics:["persistence"]},{name:"Automated Collection",id:"T1119",reference:"https://attack.mitre.org/techniques/T1119",tactics:["collection"]},{name:"Automated Exfiltration",id:"T1020",reference:"https://attack.mitre.org/techniques/T1020",tactics:["exfiltration"]},{name:"BITS Jobs",id:"T1197",reference:"https://attack.mitre.org/techniques/T1197",tactics:["defense-evasion","persistence"]},{name:"Bash History",id:"T1139",reference:"https://attack.mitre.org/techniques/T1139",tactics:["credential-access"]},{name:"Binary Padding",id:"T1009",reference:"https://attack.mitre.org/techniques/T1009",tactics:["defense-evasion"]},{name:"Bootkit",id:"T1067",reference:"https://attack.mitre.org/techniques/T1067",tactics:["persistence"]},{name:"Browser Bookmark Discovery",id:"T1217",reference:"https://attack.mitre.org/techniques/T1217",tactics:["discovery"]},{name:"Browser Extensions",id:"T1176",reference:"https://attack.mitre.org/techniques/T1176",tactics:["persistence"]},{name:"Brute Force",id:"T1110",reference:"https://attack.mitre.org/techniques/T1110",tactics:["credential-access"]},{name:"Bypass User Account Control",id:"T1088",reference:"https://attack.mitre.org/techniques/T1088",tactics:["defense-evasion","privilege-escalation"]},{name:"CMSTP",id:"T1191",reference:"https://attack.mitre.org/techniques/T1191",tactics:["defense-evasion","execution"]},{name:"Change Default File Association",id:"T1042",reference:"https://attack.mitre.org/techniques/T1042",tactics:["persistence"]},{name:"Clear Command History",id:"T1146",reference:"https://attack.mitre.org/techniques/T1146",tactics:["defense-evasion"]},{name:"Clipboard Data",id:"T1115",reference:"https://attack.mitre.org/techniques/T1115",tactics:["collection"]},{name:"Cloud Instance Metadata API",id:"T1522",reference:"https://attack.mitre.org/techniques/T1522",tactics:["credential-access"]},{name:"Cloud Service Dashboard",id:"T1538",reference:"https://attack.mitre.org/techniques/T1538",tactics:["discovery"]},{name:"Cloud Service Discovery",id:"T1526",reference:"https://attack.mitre.org/techniques/T1526",tactics:["discovery"]},{name:"Code Signing",id:"T1116",reference:"https://attack.mitre.org/techniques/T1116",tactics:["defense-evasion"]},{name:"Command-Line Interface",id:"T1059",reference:"https://attack.mitre.org/techniques/T1059",tactics:["execution"]},{name:"Commonly Used Port",id:"T1043",reference:"https://attack.mitre.org/techniques/T1043",tactics:["command-and-control"]},{name:"Communication Through Removable Media",id:"T1092",reference:"https://attack.mitre.org/techniques/T1092",tactics:["command-and-control"]},{name:"Compile After Delivery",id:"T1500",reference:"https://attack.mitre.org/techniques/T1500",tactics:["defense-evasion"]},{name:"Compiled HTML File",id:"T1223",reference:"https://attack.mitre.org/techniques/T1223",tactics:["defense-evasion","execution"]},{name:"Component Firmware",id:"T1109",reference:"https://attack.mitre.org/techniques/T1109",tactics:["defense-evasion","persistence"]},{name:"Component Object Model Hijacking",id:"T1122",reference:"https://attack.mitre.org/techniques/T1122",tactics:["defense-evasion","persistence"]},{name:"Component Object Model and Distributed COM",id:"T1175",reference:"https://attack.mitre.org/techniques/T1175",tactics:["lateral-movement","execution"]},{name:"Connection Proxy",id:"T1090",reference:"https://attack.mitre.org/techniques/T1090",tactics:["command-and-control","defense-evasion"]},{name:"Control Panel Items",id:"T1196",reference:"https://attack.mitre.org/techniques/T1196",tactics:["defense-evasion","execution"]},{name:"Create Account",id:"T1136",reference:"https://attack.mitre.org/techniques/T1136",tactics:["persistence"]},{name:"Credential Dumping",id:"T1003",reference:"https://attack.mitre.org/techniques/T1003",tactics:["credential-access"]},{name:"Credentials from Web Browsers",id:"T1503",reference:"https://attack.mitre.org/techniques/T1503",tactics:["credential-access"]},{name:"Credentials in Files",id:"T1081",reference:"https://attack.mitre.org/techniques/T1081",tactics:["credential-access"]},{name:"Credentials in Registry",id:"T1214",reference:"https://attack.mitre.org/techniques/T1214",tactics:["credential-access"]},{name:"Custom Command and Control Protocol",id:"T1094",reference:"https://attack.mitre.org/techniques/T1094",tactics:["command-and-control"]},{name:"Custom Cryptographic Protocol",id:"T1024",reference:"https://attack.mitre.org/techniques/T1024",tactics:["command-and-control"]},{name:"DCShadow",id:"T1207",reference:"https://attack.mitre.org/techniques/T1207",tactics:["defense-evasion"]},{name:"DLL Search Order Hijacking",id:"T1038",reference:"https://attack.mitre.org/techniques/T1038",tactics:["persistence","privilege-escalation","defense-evasion"]},{name:"DLL Side-Loading",id:"T1073",reference:"https://attack.mitre.org/techniques/T1073",tactics:["defense-evasion"]},{name:"Data Compressed",id:"T1002",reference:"https://attack.mitre.org/techniques/T1002",tactics:["exfiltration"]},{name:"Data Destruction",id:"T1485",reference:"https://attack.mitre.org/techniques/T1485",tactics:["impact"]},{name:"Data Encoding",id:"T1132",reference:"https://attack.mitre.org/techniques/T1132",tactics:["command-and-control"]},{name:"Data Encrypted",id:"T1022",reference:"https://attack.mitre.org/techniques/T1022",tactics:["exfiltration"]},{name:"Data Encrypted for Impact",id:"T1486",reference:"https://attack.mitre.org/techniques/T1486",tactics:["impact"]},{name:"Data Obfuscation",id:"T1001",reference:"https://attack.mitre.org/techniques/T1001",tactics:["command-and-control"]},{name:"Data Staged",id:"T1074",reference:"https://attack.mitre.org/techniques/T1074",tactics:["collection"]},{name:"Data Transfer Size Limits",id:"T1030",reference:"https://attack.mitre.org/techniques/T1030",tactics:["exfiltration"]},{name:"Data from Cloud Storage Object",id:"T1530",reference:"https://attack.mitre.org/techniques/T1530",tactics:["collection"]},{name:"Data from Information Repositories",id:"T1213",reference:"https://attack.mitre.org/techniques/T1213",tactics:["collection"]},{name:"Data from Local System",id:"T1005",reference:"https://attack.mitre.org/techniques/T1005",tactics:["collection"]},{name:"Data from Network Shared Drive",id:"T1039",reference:"https://attack.mitre.org/techniques/T1039",tactics:["collection"]},{name:"Data from Removable Media",id:"T1025",reference:"https://attack.mitre.org/techniques/T1025",tactics:["collection"]},{name:"Defacement",id:"T1491",reference:"https://attack.mitre.org/techniques/T1491",tactics:["impact"]},{name:"Deobfuscate/Decode Files or Information",id:"T1140",reference:"https://attack.mitre.org/techniques/T1140",tactics:["defense-evasion"]},{name:"Disabling Security Tools",id:"T1089",reference:"https://attack.mitre.org/techniques/T1089",tactics:["defense-evasion"]},{name:"Disk Content Wipe",id:"T1488",reference:"https://attack.mitre.org/techniques/T1488",tactics:["impact"]},{name:"Disk Structure Wipe",id:"T1487",reference:"https://attack.mitre.org/techniques/T1487",tactics:["impact"]},{name:"Domain Fronting",id:"T1172",reference:"https://attack.mitre.org/techniques/T1172",tactics:["command-and-control"]},{name:"Domain Generation Algorithms",id:"T1483",reference:"https://attack.mitre.org/techniques/T1483",tactics:["command-and-control"]},{name:"Domain Trust Discovery",id:"T1482",reference:"https://attack.mitre.org/techniques/T1482",tactics:["discovery"]},{name:"Drive-by Compromise",id:"T1189",reference:"https://attack.mitre.org/techniques/T1189",tactics:["initial-access"]},{name:"Dylib Hijacking",id:"T1157",reference:"https://attack.mitre.org/techniques/T1157",tactics:["persistence","privilege-escalation"]},{name:"Dynamic Data Exchange",id:"T1173",reference:"https://attack.mitre.org/techniques/T1173",tactics:["execution"]},{name:"Elevated Execution with Prompt",id:"T1514",reference:"https://attack.mitre.org/techniques/T1514",tactics:["privilege-escalation"]},{name:"Email Collection",id:"T1114",reference:"https://attack.mitre.org/techniques/T1114",tactics:["collection"]},{name:"Emond",id:"T1519",reference:"https://attack.mitre.org/techniques/T1519",tactics:["persistence","privilege-escalation"]},{name:"Endpoint Denial of Service",id:"T1499",reference:"https://attack.mitre.org/techniques/T1499",tactics:["impact"]},{name:"Execution Guardrails",id:"T1480",reference:"https://attack.mitre.org/techniques/T1480",tactics:["defense-evasion"]},{name:"Execution through API",id:"T1106",reference:"https://attack.mitre.org/techniques/T1106",tactics:["execution"]},{name:"Execution through Module Load",id:"T1129",reference:"https://attack.mitre.org/techniques/T1129",tactics:["execution"]},{name:"Exfiltration Over Alternative Protocol",id:"T1048",reference:"https://attack.mitre.org/techniques/T1048",tactics:["exfiltration"]},{name:"Exfiltration Over Command and Control Channel",id:"T1041",reference:"https://attack.mitre.org/techniques/T1041",tactics:["exfiltration"]},{name:"Exfiltration Over Other Network Medium",id:"T1011",reference:"https://attack.mitre.org/techniques/T1011",tactics:["exfiltration"]},{name:"Exfiltration Over Physical Medium",id:"T1052",reference:"https://attack.mitre.org/techniques/T1052",tactics:["exfiltration"]},{name:"Exploit Public-Facing Application",id:"T1190",reference:"https://attack.mitre.org/techniques/T1190",tactics:["initial-access"]},{name:"Exploitation for Client Execution",id:"T1203",reference:"https://attack.mitre.org/techniques/T1203",tactics:["execution"]},{name:"Exploitation for Credential Access",id:"T1212",reference:"https://attack.mitre.org/techniques/T1212",tactics:["credential-access"]},{name:"Exploitation for Defense Evasion",id:"T1211",reference:"https://attack.mitre.org/techniques/T1211",tactics:["defense-evasion"]},{name:"Exploitation for Privilege Escalation",id:"T1068",reference:"https://attack.mitre.org/techniques/T1068",tactics:["privilege-escalation"]},{name:"Exploitation of Remote Services",id:"T1210",reference:"https://attack.mitre.org/techniques/T1210",tactics:["lateral-movement"]},{name:"External Remote Services",id:"T1133",reference:"https://attack.mitre.org/techniques/T1133",tactics:["persistence","initial-access"]},{name:"Extra Window Memory Injection",id:"T1181",reference:"https://attack.mitre.org/techniques/T1181",tactics:["defense-evasion","privilege-escalation"]},{name:"Fallback Channels",id:"T1008",reference:"https://attack.mitre.org/techniques/T1008",tactics:["command-and-control"]},{name:"File Deletion",id:"T1107",reference:"https://attack.mitre.org/techniques/T1107",tactics:["defense-evasion"]},{name:"File System Logical Offsets",id:"T1006",reference:"https://attack.mitre.org/techniques/T1006",tactics:["defense-evasion"]},{name:"File System Permissions Weakness",id:"T1044",reference:"https://attack.mitre.org/techniques/T1044",tactics:["persistence","privilege-escalation"]},{name:"File and Directory Discovery",id:"T1083",reference:"https://attack.mitre.org/techniques/T1083",tactics:["discovery"]},{name:"File and Directory Permissions Modification",id:"T1222",reference:"https://attack.mitre.org/techniques/T1222",tactics:["defense-evasion"]},{name:"Firmware Corruption",id:"T1495",reference:"https://attack.mitre.org/techniques/T1495",tactics:["impact"]},{name:"Forced Authentication",id:"T1187",reference:"https://attack.mitre.org/techniques/T1187",tactics:["credential-access"]},{name:"Gatekeeper Bypass",id:"T1144",reference:"https://attack.mitre.org/techniques/T1144",tactics:["defense-evasion"]},{name:"Graphical User Interface",id:"T1061",reference:"https://attack.mitre.org/techniques/T1061",tactics:["execution"]},{name:"Group Policy Modification",id:"T1484",reference:"https://attack.mitre.org/techniques/T1484",tactics:["defense-evasion"]},{name:"HISTCONTROL",id:"T1148",reference:"https://attack.mitre.org/techniques/T1148",tactics:["defense-evasion"]},{name:"Hardware Additions",id:"T1200",reference:"https://attack.mitre.org/techniques/T1200",tactics:["initial-access"]},{name:"Hidden Files and Directories",id:"T1158",reference:"https://attack.mitre.org/techniques/T1158",tactics:["defense-evasion","persistence"]},{name:"Hidden Users",id:"T1147",reference:"https://attack.mitre.org/techniques/T1147",tactics:["defense-evasion"]},{name:"Hidden Window",id:"T1143",reference:"https://attack.mitre.org/techniques/T1143",tactics:["defense-evasion"]},{name:"Hooking",id:"T1179",reference:"https://attack.mitre.org/techniques/T1179",tactics:["persistence","privilege-escalation","credential-access"]},{name:"Hypervisor",id:"T1062",reference:"https://attack.mitre.org/techniques/T1062",tactics:["persistence"]},{name:"Image File Execution Options Injection",id:"T1183",reference:"https://attack.mitre.org/techniques/T1183",tactics:["privilege-escalation","persistence","defense-evasion"]},{name:"Implant Container Image",id:"T1525",reference:"https://attack.mitre.org/techniques/T1525",tactics:["persistence"]},{name:"Indicator Blocking",id:"T1054",reference:"https://attack.mitre.org/techniques/T1054",tactics:["defense-evasion"]},{name:"Indicator Removal from Tools",id:"T1066",reference:"https://attack.mitre.org/techniques/T1066",tactics:["defense-evasion"]},{name:"Indicator Removal on Host",id:"T1070",reference:"https://attack.mitre.org/techniques/T1070",tactics:["defense-evasion"]},{name:"Indirect Command Execution",id:"T1202",reference:"https://attack.mitre.org/techniques/T1202",tactics:["defense-evasion"]},{name:"Inhibit System Recovery",id:"T1490",reference:"https://attack.mitre.org/techniques/T1490",tactics:["impact"]},{name:"Input Capture",id:"T1056",reference:"https://attack.mitre.org/techniques/T1056",tactics:["collection","credential-access"]},{name:"Input Prompt",id:"T1141",reference:"https://attack.mitre.org/techniques/T1141",tactics:["credential-access"]},{name:"Install Root Certificate",id:"T1130",reference:"https://attack.mitre.org/techniques/T1130",tactics:["defense-evasion"]},{name:"InstallUtil",id:"T1118",reference:"https://attack.mitre.org/techniques/T1118",tactics:["defense-evasion","execution"]},{name:"Internal Spearphishing",id:"T1534",reference:"https://attack.mitre.org/techniques/T1534",tactics:["lateral-movement"]},{name:"Kerberoasting",id:"T1208",reference:"https://attack.mitre.org/techniques/T1208",tactics:["credential-access"]},{name:"Kernel Modules and Extensions",id:"T1215",reference:"https://attack.mitre.org/techniques/T1215",tactics:["persistence"]},{name:"Keychain",id:"T1142",reference:"https://attack.mitre.org/techniques/T1142",tactics:["credential-access"]},{name:"LC_LOAD_DYLIB Addition",id:"T1161",reference:"https://attack.mitre.org/techniques/T1161",tactics:["persistence"]},{name:"LC_MAIN Hijacking",id:"T1149",reference:"https://attack.mitre.org/techniques/T1149",tactics:["defense-evasion"]},{name:"LLMNR/NBT-NS Poisoning and Relay",id:"T1171",reference:"https://attack.mitre.org/techniques/T1171",tactics:["credential-access"]},{name:"LSASS Driver",id:"T1177",reference:"https://attack.mitre.org/techniques/T1177",tactics:["execution","persistence"]},{name:"Launch Agent",id:"T1159",reference:"https://attack.mitre.org/techniques/T1159",tactics:["persistence"]},{name:"Launch Daemon",id:"T1160",reference:"https://attack.mitre.org/techniques/T1160",tactics:["persistence","privilege-escalation"]},{name:"Launchctl",id:"T1152",reference:"https://attack.mitre.org/techniques/T1152",tactics:["defense-evasion","execution","persistence"]},{name:"Local Job Scheduling",id:"T1168",reference:"https://attack.mitre.org/techniques/T1168",tactics:["persistence","execution"]},{name:"Login Item",id:"T1162",reference:"https://attack.mitre.org/techniques/T1162",tactics:["persistence"]},{name:"Logon Scripts",id:"T1037",reference:"https://attack.mitre.org/techniques/T1037",tactics:["lateral-movement","persistence"]},{name:"Man in the Browser",id:"T1185",reference:"https://attack.mitre.org/techniques/T1185",tactics:["collection"]},{name:"Masquerading",id:"T1036",reference:"https://attack.mitre.org/techniques/T1036",tactics:["defense-evasion"]},{name:"Modify Existing Service",id:"T1031",reference:"https://attack.mitre.org/techniques/T1031",tactics:["persistence"]},{name:"Modify Registry",id:"T1112",reference:"https://attack.mitre.org/techniques/T1112",tactics:["defense-evasion"]},{name:"Mshta",id:"T1170",reference:"https://attack.mitre.org/techniques/T1170",tactics:["defense-evasion","execution"]},{name:"Multi-Stage Channels",id:"T1104",reference:"https://attack.mitre.org/techniques/T1104",tactics:["command-and-control"]},{name:"Multi-hop Proxy",id:"T1188",reference:"https://attack.mitre.org/techniques/T1188",tactics:["command-and-control"]},{name:"Multiband Communication",id:"T1026",reference:"https://attack.mitre.org/techniques/T1026",tactics:["command-and-control"]},{name:"Multilayer Encryption",id:"T1079",reference:"https://attack.mitre.org/techniques/T1079",tactics:["command-and-control"]},{name:"NTFS File Attributes",id:"T1096",reference:"https://attack.mitre.org/techniques/T1096",tactics:["defense-evasion"]},{name:"Netsh Helper DLL",id:"T1128",reference:"https://attack.mitre.org/techniques/T1128",tactics:["persistence"]},{name:"Network Denial of Service",id:"T1498",reference:"https://attack.mitre.org/techniques/T1498",tactics:["impact"]},{name:"Network Service Scanning",id:"T1046",reference:"https://attack.mitre.org/techniques/T1046",tactics:["discovery"]},{name:"Network Share Connection Removal",id:"T1126",reference:"https://attack.mitre.org/techniques/T1126",tactics:["defense-evasion"]},{name:"Network Share Discovery",id:"T1135",reference:"https://attack.mitre.org/techniques/T1135",tactics:["discovery"]},{name:"Network Sniffing",id:"T1040",reference:"https://attack.mitre.org/techniques/T1040",tactics:["credential-access","discovery"]},{name:"New Service",id:"T1050",reference:"https://attack.mitre.org/techniques/T1050",tactics:["persistence","privilege-escalation"]},{name:"Obfuscated Files or Information",id:"T1027",reference:"https://attack.mitre.org/techniques/T1027",tactics:["defense-evasion"]},{name:"Office Application Startup",id:"T1137",reference:"https://attack.mitre.org/techniques/T1137",tactics:["persistence"]},{name:"Parent PID Spoofing",id:"T1502",reference:"https://attack.mitre.org/techniques/T1502",tactics:["defense-evasion","privilege-escalation"]},{name:"Pass the Hash",id:"T1075",reference:"https://attack.mitre.org/techniques/T1075",tactics:["lateral-movement"]},{name:"Pass the Ticket",id:"T1097",reference:"https://attack.mitre.org/techniques/T1097",tactics:["lateral-movement"]},{name:"Password Filter DLL",id:"T1174",reference:"https://attack.mitre.org/techniques/T1174",tactics:["credential-access"]},{name:"Password Policy Discovery",id:"T1201",reference:"https://attack.mitre.org/techniques/T1201",tactics:["discovery"]},{name:"Path Interception",id:"T1034",reference:"https://attack.mitre.org/techniques/T1034",tactics:["persistence","privilege-escalation"]},{name:"Peripheral Device Discovery",id:"T1120",reference:"https://attack.mitre.org/techniques/T1120",tactics:["discovery"]},{name:"Permission Groups Discovery",id:"T1069",reference:"https://attack.mitre.org/techniques/T1069",tactics:["discovery"]},{name:"Plist Modification",id:"T1150",reference:"https://attack.mitre.org/techniques/T1150",tactics:["defense-evasion","persistence","privilege-escalation"]},{name:"Port Knocking",id:"T1205",reference:"https://attack.mitre.org/techniques/T1205",tactics:["defense-evasion","persistence","command-and-control"]},{name:"Port Monitors",id:"T1013",reference:"https://attack.mitre.org/techniques/T1013",tactics:["persistence","privilege-escalation"]},{name:"PowerShell",id:"T1086",reference:"https://attack.mitre.org/techniques/T1086",tactics:["execution"]},{name:"PowerShell Profile",id:"T1504",reference:"https://attack.mitre.org/techniques/T1504",tactics:["persistence","privilege-escalation"]},{name:"Private Keys",id:"T1145",reference:"https://attack.mitre.org/techniques/T1145",tactics:["credential-access"]},{name:"Process Discovery",id:"T1057",reference:"https://attack.mitre.org/techniques/T1057",tactics:["discovery"]},{name:"Process Doppelgänging",id:"T1186",reference:"https://attack.mitre.org/techniques/T1186",tactics:["defense-evasion"]},{name:"Process Hollowing",id:"T1093",reference:"https://attack.mitre.org/techniques/T1093",tactics:["defense-evasion"]},{name:"Process Injection",id:"T1055",reference:"https://attack.mitre.org/techniques/T1055",tactics:["defense-evasion","privilege-escalation"]},{name:"Query Registry",id:"T1012",reference:"https://attack.mitre.org/techniques/T1012",tactics:["discovery"]},{name:"Rc.common",id:"T1163",reference:"https://attack.mitre.org/techniques/T1163",tactics:["persistence"]},{name:"Re-opened Applications",id:"T1164",reference:"https://attack.mitre.org/techniques/T1164",tactics:["persistence"]},{name:"Redundant Access",id:"T1108",reference:"https://attack.mitre.org/techniques/T1108",tactics:["defense-evasion","persistence"]},{name:"Registry Run Keys / Startup Folder",id:"T1060",reference:"https://attack.mitre.org/techniques/T1060",tactics:["persistence"]},{name:"Regsvcs/Regasm",id:"T1121",reference:"https://attack.mitre.org/techniques/T1121",tactics:["defense-evasion","execution"]},{name:"Regsvr32",id:"T1117",reference:"https://attack.mitre.org/techniques/T1117",tactics:["defense-evasion","execution"]},{name:"Remote Access Tools",id:"T1219",reference:"https://attack.mitre.org/techniques/T1219",tactics:["command-and-control"]},{name:"Remote Desktop Protocol",id:"T1076",reference:"https://attack.mitre.org/techniques/T1076",tactics:["lateral-movement"]},{name:"Remote File Copy",id:"T1105",reference:"https://attack.mitre.org/techniques/T1105",tactics:["command-and-control","lateral-movement"]},{name:"Remote Services",id:"T1021",reference:"https://attack.mitre.org/techniques/T1021",tactics:["lateral-movement"]},{name:"Remote System Discovery",id:"T1018",reference:"https://attack.mitre.org/techniques/T1018",tactics:["discovery"]},{name:"Replication Through Removable Media",id:"T1091",reference:"https://attack.mitre.org/techniques/T1091",tactics:["lateral-movement","initial-access"]},{name:"Resource Hijacking",id:"T1496",reference:"https://attack.mitre.org/techniques/T1496",tactics:["impact"]},{name:"Revert Cloud Instance",id:"T1536",reference:"https://attack.mitre.org/techniques/T1536",tactics:["defense-evasion"]},{name:"Rootkit",id:"T1014",reference:"https://attack.mitre.org/techniques/T1014",tactics:["defense-evasion"]},{name:"Rundll32",id:"T1085",reference:"https://attack.mitre.org/techniques/T1085",tactics:["defense-evasion","execution"]},{name:"Runtime Data Manipulation",id:"T1494",reference:"https://attack.mitre.org/techniques/T1494",tactics:["impact"]},{name:"SID-History Injection",id:"T1178",reference:"https://attack.mitre.org/techniques/T1178",tactics:["privilege-escalation"]},{name:"SIP and Trust Provider Hijacking",id:"T1198",reference:"https://attack.mitre.org/techniques/T1198",tactics:["defense-evasion","persistence"]},{name:"SSH Hijacking",id:"T1184",reference:"https://attack.mitre.org/techniques/T1184",tactics:["lateral-movement"]},{name:"Scheduled Task",id:"T1053",reference:"https://attack.mitre.org/techniques/T1053",tactics:["execution","persistence","privilege-escalation"]},{name:"Scheduled Transfer",id:"T1029",reference:"https://attack.mitre.org/techniques/T1029",tactics:["exfiltration"]},{name:"Screen Capture",id:"T1113",reference:"https://attack.mitre.org/techniques/T1113",tactics:["collection"]},{name:"Screensaver",id:"T1180",reference:"https://attack.mitre.org/techniques/T1180",tactics:["persistence"]},{name:"Scripting",id:"T1064",reference:"https://attack.mitre.org/techniques/T1064",tactics:["defense-evasion","execution"]},{name:"Security Software Discovery",id:"T1063",reference:"https://attack.mitre.org/techniques/T1063",tactics:["discovery"]},{name:"Security Support Provider",id:"T1101",reference:"https://attack.mitre.org/techniques/T1101",tactics:["persistence"]},{name:"Securityd Memory",id:"T1167",reference:"https://attack.mitre.org/techniques/T1167",tactics:["credential-access"]},{name:"Server Software Component",id:"T1505",reference:"https://attack.mitre.org/techniques/T1505",tactics:["persistence"]},{name:"Service Execution",id:"T1035",reference:"https://attack.mitre.org/techniques/T1035",tactics:["execution"]},{name:"Service Registry Permissions Weakness",id:"T1058",reference:"https://attack.mitre.org/techniques/T1058",tactics:["persistence","privilege-escalation"]},{name:"Service Stop",id:"T1489",reference:"https://attack.mitre.org/techniques/T1489",tactics:["impact"]},{name:"Setuid and Setgid",id:"T1166",reference:"https://attack.mitre.org/techniques/T1166",tactics:["privilege-escalation","persistence"]},{name:"Shared Webroot",id:"T1051",reference:"https://attack.mitre.org/techniques/T1051",tactics:["lateral-movement"]},{name:"Shortcut Modification",id:"T1023",reference:"https://attack.mitre.org/techniques/T1023",tactics:["persistence"]},{name:"Signed Binary Proxy Execution",id:"T1218",reference:"https://attack.mitre.org/techniques/T1218",tactics:["defense-evasion","execution"]},{name:"Signed Script Proxy Execution",id:"T1216",reference:"https://attack.mitre.org/techniques/T1216",tactics:["defense-evasion","execution"]},{name:"Software Discovery",id:"T1518",reference:"https://attack.mitre.org/techniques/T1518",tactics:["discovery"]},{name:"Software Packing",id:"T1045",reference:"https://attack.mitre.org/techniques/T1045",tactics:["defense-evasion"]},{name:"Source",id:"T1153",reference:"https://attack.mitre.org/techniques/T1153",tactics:["execution"]},{name:"Space after Filename",id:"T1151",reference:"https://attack.mitre.org/techniques/T1151",tactics:["defense-evasion","execution"]},{name:"Spearphishing Attachment",id:"T1193",reference:"https://attack.mitre.org/techniques/T1193",tactics:["initial-access"]},{name:"Spearphishing Link",id:"T1192",reference:"https://attack.mitre.org/techniques/T1192",tactics:["initial-access"]},{name:"Spearphishing via Service",id:"T1194",reference:"https://attack.mitre.org/techniques/T1194",tactics:["initial-access"]},{name:"Standard Application Layer Protocol",id:"T1071",reference:"https://attack.mitre.org/techniques/T1071",tactics:["command-and-control"]},{name:"Standard Cryptographic Protocol",id:"T1032",reference:"https://attack.mitre.org/techniques/T1032",tactics:["command-and-control"]},{name:"Standard Non-Application Layer Protocol",id:"T1095",reference:"https://attack.mitre.org/techniques/T1095",tactics:["command-and-control"]},{name:"Startup Items",id:"T1165",reference:"https://attack.mitre.org/techniques/T1165",tactics:["persistence","privilege-escalation"]},{name:"Steal Application Access Token",id:"T1528",reference:"https://attack.mitre.org/techniques/T1528",tactics:["credential-access"]},{name:"Steal Web Session Cookie",id:"T1539",reference:"https://attack.mitre.org/techniques/T1539",tactics:["credential-access"]},{name:"Stored Data Manipulation",id:"T1492",reference:"https://attack.mitre.org/techniques/T1492",tactics:["impact"]},{name:"Sudo",id:"T1169",reference:"https://attack.mitre.org/techniques/T1169",tactics:["privilege-escalation"]},{name:"Sudo Caching",id:"T1206",reference:"https://attack.mitre.org/techniques/T1206",tactics:["privilege-escalation"]},{name:"Supply Chain Compromise",id:"T1195",reference:"https://attack.mitre.org/techniques/T1195",tactics:["initial-access"]},{name:"System Firmware",id:"T1019",reference:"https://attack.mitre.org/techniques/T1019",tactics:["persistence"]},{name:"System Information Discovery",id:"T1082",reference:"https://attack.mitre.org/techniques/T1082",tactics:["discovery"]},{name:"System Network Configuration Discovery",id:"T1016",reference:"https://attack.mitre.org/techniques/T1016",tactics:["discovery"]},{name:"System Network Connections Discovery",id:"T1049",reference:"https://attack.mitre.org/techniques/T1049",tactics:["discovery"]},{name:"System Owner/User Discovery",id:"T1033",reference:"https://attack.mitre.org/techniques/T1033",tactics:["discovery"]},{name:"System Service Discovery",id:"T1007",reference:"https://attack.mitre.org/techniques/T1007",tactics:["discovery"]},{name:"System Shutdown/Reboot",id:"T1529",reference:"https://attack.mitre.org/techniques/T1529",tactics:["impact"]},{name:"System Time Discovery",id:"T1124",reference:"https://attack.mitre.org/techniques/T1124",tactics:["discovery"]},{name:"Systemd Service",id:"T1501",reference:"https://attack.mitre.org/techniques/T1501",tactics:["persistence"]},{name:"Taint Shared Content",id:"T1080",reference:"https://attack.mitre.org/techniques/T1080",tactics:["lateral-movement"]},{name:"Template Injection",id:"T1221",reference:"https://attack.mitre.org/techniques/T1221",tactics:["defense-evasion"]},{name:"Third-party Software",id:"T1072",reference:"https://attack.mitre.org/techniques/T1072",tactics:["execution","lateral-movement"]},{name:"Time Providers",id:"T1209",reference:"https://attack.mitre.org/techniques/T1209",tactics:["persistence"]},{name:"Timestomp",id:"T1099",reference:"https://attack.mitre.org/techniques/T1099",tactics:["defense-evasion"]},{name:"Transfer Data to Cloud Account",id:"T1537",reference:"https://attack.mitre.org/techniques/T1537",tactics:["exfiltration"]},{name:"Transmitted Data Manipulation",id:"T1493",reference:"https://attack.mitre.org/techniques/T1493",tactics:["impact"]},{name:"Trap",id:"T1154",reference:"https://attack.mitre.org/techniques/T1154",tactics:["execution","persistence"]},{name:"Trusted Developer Utilities",id:"T1127",reference:"https://attack.mitre.org/techniques/T1127",tactics:["defense-evasion","execution"]},{name:"Trusted Relationship",id:"T1199",reference:"https://attack.mitre.org/techniques/T1199",tactics:["initial-access"]},{name:"Two-Factor Authentication Interception",id:"T1111",reference:"https://attack.mitre.org/techniques/T1111",tactics:["credential-access"]},{name:"Uncommonly Used Port",id:"T1065",reference:"https://attack.mitre.org/techniques/T1065",tactics:["command-and-control"]},{name:"Unused/Unsupported Cloud Regions",id:"T1535",reference:"https://attack.mitre.org/techniques/T1535",tactics:["defense-evasion"]},{name:"User Execution",id:"T1204",reference:"https://attack.mitre.org/techniques/T1204",tactics:["execution"]},{name:"Valid Accounts",id:"T1078",reference:"https://attack.mitre.org/techniques/T1078",tactics:["defense-evasion","persistence","privilege-escalation","initial-access"]},{name:"Video Capture",id:"T1125",reference:"https://attack.mitre.org/techniques/T1125",tactics:["collection"]},{name:"Virtualization/Sandbox Evasion",id:"T1497",reference:"https://attack.mitre.org/techniques/T1497",tactics:["defense-evasion","discovery"]},{name:"Web Service",id:"T1102",reference:"https://attack.mitre.org/techniques/T1102",tactics:["command-and-control","defense-evasion"]},{name:"Web Session Cookie",id:"T1506",reference:"https://attack.mitre.org/techniques/T1506",tactics:["defense-evasion","lateral-movement"]},{name:"Web Shell",id:"T1100",reference:"https://attack.mitre.org/techniques/T1100",tactics:["persistence","privilege-escalation"]},{name:"Windows Admin Shares",id:"T1077",reference:"https://attack.mitre.org/techniques/T1077",tactics:["lateral-movement"]},{name:"Windows Management Instrumentation",id:"T1047",reference:"https://attack.mitre.org/techniques/T1047",tactics:["execution"]},{name:"Windows Management Instrumentation Event Subscription",id:"T1084",reference:"https://attack.mitre.org/techniques/T1084",tactics:["persistence"]},{name:"Windows Remote Management",id:"T1028",reference:"https://attack.mitre.org/techniques/T1028",tactics:["execution","lateral-movement"]},{name:"Winlogon Helper DLL",id:"T1004",reference:"https://attack.mitre.org/techniques/T1004",tactics:["persistence"]},{name:"XSL Script Processing",id:"T1220",reference:"https://attack.mitre.org/techniques/T1220",tactics:["defense-evasion","execution"]}];const techniquesOptions=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bashProfileAndBashrcDescription",{defaultMessage:".bash_profile and .bashrc (T1156)"}),id:"T1156",name:".bash_profile and .bashrc",reference:"https://attack.mitre.org/techniques/T1156",tactics:"persistence",value:"bashProfileAndBashrc"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accessTokenManipulationDescription",{defaultMessage:"Access Token Manipulation (T1134)"}),id:"T1134",name:"Access Token Manipulation",reference:"https://attack.mitre.org/techniques/T1134",tactics:"defense-evasion,privilege-escalation",value:"accessTokenManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accessibilityFeaturesDescription",{defaultMessage:"Accessibility Features (T1015)"}),id:"T1015",name:"Accessibility Features",reference:"https://attack.mitre.org/techniques/T1015",tactics:"persistence,privilege-escalation",value:"accessibilityFeatures"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountAccessRemovalDescription",{defaultMessage:"Account Access Removal (T1531)"}),id:"T1531",name:"Account Access Removal",reference:"https://attack.mitre.org/techniques/T1531",tactics:"impact",value:"accountAccessRemoval"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountDiscoveryDescription",{defaultMessage:"Account Discovery (T1087)"}),id:"T1087",name:"Account Discovery",reference:"https://attack.mitre.org/techniques/T1087",tactics:"discovery",value:"accountDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountManipulationDescription",{defaultMessage:"Account Manipulation (T1098)"}),id:"T1098",name:"Account Manipulation",reference:"https://attack.mitre.org/techniques/T1098",tactics:"credential-access,persistence",value:"accountManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.appCertDlLsDescription",{defaultMessage:"AppCert DLLs (T1182)"}),id:"T1182",name:"AppCert DLLs",reference:"https://attack.mitre.org/techniques/T1182",tactics:"persistence,privilege-escalation",value:"appCertDlLs"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.appInitDlLsDescription",{defaultMessage:"AppInit DLLs (T1103)"}),id:"T1103",name:"AppInit DLLs",reference:"https://attack.mitre.org/techniques/T1103",tactics:"persistence,privilege-escalation",value:"appInitDlLs"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.appleScriptDescription",{defaultMessage:"AppleScript (T1155)"}),id:"T1155",name:"AppleScript",reference:"https://attack.mitre.org/techniques/T1155",tactics:"execution,lateral-movement",value:"appleScript"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationAccessTokenDescription",{defaultMessage:"Application Access Token (T1527)"}),id:"T1527",name:"Application Access Token",reference:"https://attack.mitre.org/techniques/T1527",tactics:"defense-evasion,lateral-movement",value:"applicationAccessToken"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationDeploymentSoftwareDescription",{defaultMessage:"Application Deployment Software (T1017)"}),id:"T1017",name:"Application Deployment Software",reference:"https://attack.mitre.org/techniques/T1017",tactics:"lateral-movement",value:"applicationDeploymentSoftware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationShimmingDescription",{defaultMessage:"Application Shimming (T1138)"}),id:"T1138",name:"Application Shimming",reference:"https://attack.mitre.org/techniques/T1138",tactics:"persistence,privilege-escalation",value:"applicationShimming"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationWindowDiscoveryDescription",{defaultMessage:"Application Window Discovery (T1010)"}),id:"T1010",name:"Application Window Discovery",reference:"https://attack.mitre.org/techniques/T1010",tactics:"discovery",value:"applicationWindowDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.audioCaptureDescription",{defaultMessage:"Audio Capture (T1123)"}),id:"T1123",name:"Audio Capture",reference:"https://attack.mitre.org/techniques/T1123",tactics:"collection",value:"audioCapture"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.authenticationPackageDescription",{defaultMessage:"Authentication Package (T1131)"}),id:"T1131",name:"Authentication Package",reference:"https://attack.mitre.org/techniques/T1131",tactics:"persistence",value:"authenticationPackage"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedCollectionDescription",{defaultMessage:"Automated Collection (T1119)"}),id:"T1119",name:"Automated Collection",reference:"https://attack.mitre.org/techniques/T1119",tactics:"collection",value:"automatedCollection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedExfiltrationDescription",{defaultMessage:"Automated Exfiltration (T1020)"}),id:"T1020",name:"Automated Exfiltration",reference:"https://attack.mitre.org/techniques/T1020",tactics:"exfiltration",value:"automatedExfiltration"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bitsJobsDescription",{defaultMessage:"BITS Jobs (T1197)"}),id:"T1197",name:"BITS Jobs",reference:"https://attack.mitre.org/techniques/T1197",tactics:"defense-evasion,persistence",value:"bitsJobs"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bashHistoryDescription",{defaultMessage:"Bash History (T1139)"}),id:"T1139",name:"Bash History",reference:"https://attack.mitre.org/techniques/T1139",tactics:"credential-access",value:"bashHistory"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.binaryPaddingDescription",{defaultMessage:"Binary Padding (T1009)"}),id:"T1009",name:"Binary Padding",reference:"https://attack.mitre.org/techniques/T1009",tactics:"defense-evasion",value:"binaryPadding"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootkitDescription",{defaultMessage:"Bootkit (T1067)"}),id:"T1067",name:"Bootkit",reference:"https://attack.mitre.org/techniques/T1067",tactics:"persistence",value:"bootkit"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserBookmarkDiscoveryDescription",{defaultMessage:"Browser Bookmark Discovery (T1217)"}),id:"T1217",name:"Browser Bookmark Discovery",reference:"https://attack.mitre.org/techniques/T1217",tactics:"discovery",value:"browserBookmarkDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserExtensionsDescription",{defaultMessage:"Browser Extensions (T1176)"}),id:"T1176",name:"Browser Extensions",reference:"https://attack.mitre.org/techniques/T1176",tactics:"persistence",value:"browserExtensions"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bruteForceDescription",{defaultMessage:"Brute Force (T1110)"}),id:"T1110",name:"Brute Force",reference:"https://attack.mitre.org/techniques/T1110",tactics:"credential-access",value:"bruteForce"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bypassUserAccountControlDescription",{defaultMessage:"Bypass User Account Control (T1088)"}),id:"T1088",name:"Bypass User Account Control",reference:"https://attack.mitre.org/techniques/T1088",tactics:"defense-evasion,privilege-escalation",value:"bypassUserAccountControl"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cmstpDescription",{defaultMessage:"CMSTP (T1191)"}),id:"T1191",name:"CMSTP",reference:"https://attack.mitre.org/techniques/T1191",tactics:"defense-evasion,execution",value:"cmstp"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.changeDefaultFileAssociationDescription",{defaultMessage:"Change Default File Association (T1042)"}),id:"T1042",name:"Change Default File Association",reference:"https://attack.mitre.org/techniques/T1042",tactics:"persistence",value:"changeDefaultFileAssociation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.clearCommandHistoryDescription",{defaultMessage:"Clear Command History (T1146)"}),id:"T1146",name:"Clear Command History",reference:"https://attack.mitre.org/techniques/T1146",tactics:"defense-evasion",value:"clearCommandHistory"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.clipboardDataDescription",{defaultMessage:"Clipboard Data (T1115)"}),id:"T1115",name:"Clipboard Data",reference:"https://attack.mitre.org/techniques/T1115",tactics:"collection",value:"clipboardData"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudInstanceMetadataApiDescription",{defaultMessage:"Cloud Instance Metadata API (T1522)"}),id:"T1522",name:"Cloud Instance Metadata API",reference:"https://attack.mitre.org/techniques/T1522",tactics:"credential-access",value:"cloudInstanceMetadataApi"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDashboardDescription",{defaultMessage:"Cloud Service Dashboard (T1538)"}),id:"T1538",name:"Cloud Service Dashboard",reference:"https://attack.mitre.org/techniques/T1538",tactics:"discovery",value:"cloudServiceDashboard"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDiscoveryDescription",{defaultMessage:"Cloud Service Discovery (T1526)"}),id:"T1526",name:"Cloud Service Discovery",reference:"https://attack.mitre.org/techniques/T1526",tactics:"discovery",value:"cloudServiceDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.codeSigningDescription",{defaultMessage:"Code Signing (T1116)"}),id:"T1116",name:"Code Signing",reference:"https://attack.mitre.org/techniques/T1116",tactics:"defense-evasion",value:"codeSigning"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commandLineInterfaceDescription",{defaultMessage:"Command-Line Interface (T1059)"}),id:"T1059",name:"Command-Line Interface",reference:"https://attack.mitre.org/techniques/T1059",tactics:"execution",value:"commandLineInterface"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commonlyUsedPortDescription",{defaultMessage:"Commonly Used Port (T1043)"}),id:"T1043",name:"Commonly Used Port",reference:"https://attack.mitre.org/techniques/T1043",tactics:"command-and-control",value:"commonlyUsedPort"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.communicationThroughRemovableMediaDescription",{defaultMessage:"Communication Through Removable Media (T1092)"}),id:"T1092",name:"Communication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1092",tactics:"command-and-control",value:"communicationThroughRemovableMedia"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compileAfterDeliveryDescription",{defaultMessage:"Compile After Delivery (T1500)"}),id:"T1500",name:"Compile After Delivery",reference:"https://attack.mitre.org/techniques/T1500",tactics:"defense-evasion",value:"compileAfterDelivery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compiledHtmlFileDescription",{defaultMessage:"Compiled HTML File (T1223)"}),id:"T1223",name:"Compiled HTML File",reference:"https://attack.mitre.org/techniques/T1223",tactics:"defense-evasion,execution",value:"compiledHtmlFile"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.componentFirmwareDescription",{defaultMessage:"Component Firmware (T1109)"}),id:"T1109",name:"Component Firmware",reference:"https://attack.mitre.org/techniques/T1109",tactics:"defense-evasion,persistence",value:"componentFirmware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.componentObjectModelHijackingDescription",{defaultMessage:"Component Object Model Hijacking (T1122)"}),id:"T1122",name:"Component Object Model Hijacking",reference:"https://attack.mitre.org/techniques/T1122",tactics:"defense-evasion,persistence",value:"componentObjectModelHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.componentObjectModelAndDistributedComDescription",{defaultMessage:"Component Object Model and Distributed COM (T1175)"}),id:"T1175",name:"Component Object Model and Distributed COM",reference:"https://attack.mitre.org/techniques/T1175",tactics:"lateral-movement,execution",value:"componentObjectModelAndDistributedCom"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.connectionProxyDescription",{defaultMessage:"Connection Proxy (T1090)"}),id:"T1090",name:"Connection Proxy",reference:"https://attack.mitre.org/techniques/T1090",tactics:"command-and-control,defense-evasion",value:"connectionProxy"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.controlPanelItemsDescription",{defaultMessage:"Control Panel Items (T1196)"}),id:"T1196",name:"Control Panel Items",reference:"https://attack.mitre.org/techniques/T1196",tactics:"defense-evasion,execution",value:"controlPanelItems"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createAccountDescription",{defaultMessage:"Create Account (T1136)"}),id:"T1136",name:"Create Account",reference:"https://attack.mitre.org/techniques/T1136",tactics:"persistence",value:"createAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialDumpingDescription",{defaultMessage:"Credential Dumping (T1003)"}),id:"T1003",name:"Credential Dumping",reference:"https://attack.mitre.org/techniques/T1003",tactics:"credential-access",value:"credentialDumping"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsFromWebBrowsersDescription",{defaultMessage:"Credentials from Web Browsers (T1503)"}),id:"T1503",name:"Credentials from Web Browsers",reference:"https://attack.mitre.org/techniques/T1503",tactics:"credential-access",value:"credentialsFromWebBrowsers"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsInFilesDescription",{defaultMessage:"Credentials in Files (T1081)"}),id:"T1081",name:"Credentials in Files",reference:"https://attack.mitre.org/techniques/T1081",tactics:"credential-access",value:"credentialsInFiles"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsInRegistryDescription",{defaultMessage:"Credentials in Registry (T1214)"}),id:"T1214",name:"Credentials in Registry",reference:"https://attack.mitre.org/techniques/T1214",tactics:"credential-access",value:"credentialsInRegistry"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.customCommandAndControlProtocolDescription",{defaultMessage:"Custom Command and Control Protocol (T1094)"}),id:"T1094",name:"Custom Command and Control Protocol",reference:"https://attack.mitre.org/techniques/T1094",tactics:"command-and-control",value:"customCommandAndControlProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.customCryptographicProtocolDescription",{defaultMessage:"Custom Cryptographic Protocol (T1024)"}),id:"T1024",name:"Custom Cryptographic Protocol",reference:"https://attack.mitre.org/techniques/T1024",tactics:"command-and-control",value:"customCryptographicProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dcShadowDescription",{defaultMessage:"DCShadow (T1207)"}),id:"T1207",name:"DCShadow",reference:"https://attack.mitre.org/techniques/T1207",tactics:"defense-evasion",value:"dcShadow"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dllSearchOrderHijackingDescription",{defaultMessage:"DLL Search Order Hijacking (T1038)"}),id:"T1038",name:"DLL Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1038",tactics:"persistence,privilege-escalation,defense-evasion",value:"dllSearchOrderHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dllSideLoadingDescription",{defaultMessage:"DLL Side-Loading (T1073)"}),id:"T1073",name:"DLL Side-Loading",reference:"https://attack.mitre.org/techniques/T1073",tactics:"defense-evasion",value:"dllSideLoading"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataCompressedDescription",{defaultMessage:"Data Compressed (T1002)"}),id:"T1002",name:"Data Compressed",reference:"https://attack.mitre.org/techniques/T1002",tactics:"exfiltration",value:"dataCompressed"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataDestructionDescription",{defaultMessage:"Data Destruction (T1485)"}),id:"T1485",name:"Data Destruction",reference:"https://attack.mitre.org/techniques/T1485",tactics:"impact",value:"dataDestruction"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncodingDescription",{defaultMessage:"Data Encoding (T1132)"}),id:"T1132",name:"Data Encoding",reference:"https://attack.mitre.org/techniques/T1132",tactics:"command-and-control",value:"dataEncoding"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncryptedDescription",{defaultMessage:"Data Encrypted (T1022)"}),id:"T1022",name:"Data Encrypted",reference:"https://attack.mitre.org/techniques/T1022",tactics:"exfiltration",value:"dataEncrypted"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncryptedForImpactDescription",{defaultMessage:"Data Encrypted for Impact (T1486)"}),id:"T1486",name:"Data Encrypted for Impact",reference:"https://attack.mitre.org/techniques/T1486",tactics:"impact",value:"dataEncryptedForImpact"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataObfuscationDescription",{defaultMessage:"Data Obfuscation (T1001)"}),id:"T1001",name:"Data Obfuscation",reference:"https://attack.mitre.org/techniques/T1001",tactics:"command-and-control",value:"dataObfuscation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataStagedDescription",{defaultMessage:"Data Staged (T1074)"}),id:"T1074",name:"Data Staged",reference:"https://attack.mitre.org/techniques/T1074",tactics:"collection",value:"dataStaged"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataTransferSizeLimitsDescription",{defaultMessage:"Data Transfer Size Limits (T1030)"}),id:"T1030",name:"Data Transfer Size Limits",reference:"https://attack.mitre.org/techniques/T1030",tactics:"exfiltration",value:"dataTransferSizeLimits"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromCloudStorageObjectDescription",{defaultMessage:"Data from Cloud Storage Object (T1530)"}),id:"T1530",name:"Data from Cloud Storage Object",reference:"https://attack.mitre.org/techniques/T1530",tactics:"collection",value:"dataFromCloudStorageObject"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromInformationRepositoriesDescription",{defaultMessage:"Data from Information Repositories (T1213)"}),id:"T1213",name:"Data from Information Repositories",reference:"https://attack.mitre.org/techniques/T1213",tactics:"collection",value:"dataFromInformationRepositories"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromLocalSystemDescription",{defaultMessage:"Data from Local System (T1005)"}),id:"T1005",name:"Data from Local System",reference:"https://attack.mitre.org/techniques/T1005",tactics:"collection",value:"dataFromLocalSystem"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromNetworkSharedDriveDescription",{defaultMessage:"Data from Network Shared Drive (T1039)"}),id:"T1039",name:"Data from Network Shared Drive",reference:"https://attack.mitre.org/techniques/T1039",tactics:"collection",value:"dataFromNetworkSharedDrive"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromRemovableMediaDescription",{defaultMessage:"Data from Removable Media (T1025)"}),id:"T1025",name:"Data from Removable Media",reference:"https://attack.mitre.org/techniques/T1025",tactics:"collection",value:"dataFromRemovableMedia"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.defacementDescription",{defaultMessage:"Defacement (T1491)"}),id:"T1491",name:"Defacement",reference:"https://attack.mitre.org/techniques/T1491",tactics:"impact",value:"defacement"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.deobfuscateDecodeFilesOrInformationDescription",{defaultMessage:"Deobfuscate/Decode Files or Information (T1140)"}),id:"T1140",name:"Deobfuscate/Decode Files or Information",reference:"https://attack.mitre.org/techniques/T1140",tactics:"defense-evasion",value:"deobfuscateDecodeFilesOrInformation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.disablingSecurityToolsDescription",{defaultMessage:"Disabling Security Tools (T1089)"}),id:"T1089",name:"Disabling Security Tools",reference:"https://attack.mitre.org/techniques/T1089",tactics:"defense-evasion",value:"disablingSecurityTools"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.diskContentWipeDescription",{defaultMessage:"Disk Content Wipe (T1488)"}),id:"T1488",name:"Disk Content Wipe",reference:"https://attack.mitre.org/techniques/T1488",tactics:"impact",value:"diskContentWipe"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.diskStructureWipeDescription",{defaultMessage:"Disk Structure Wipe (T1487)"}),id:"T1487",name:"Disk Structure Wipe",reference:"https://attack.mitre.org/techniques/T1487",tactics:"impact",value:"diskStructureWipe"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainFrontingDescription",{defaultMessage:"Domain Fronting (T1172)"}),id:"T1172",name:"Domain Fronting",reference:"https://attack.mitre.org/techniques/T1172",tactics:"command-and-control",value:"domainFronting"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainGenerationAlgorithmsDescription",{defaultMessage:"Domain Generation Algorithms (T1483)"}),id:"T1483",name:"Domain Generation Algorithms",reference:"https://attack.mitre.org/techniques/T1483",tactics:"command-and-control",value:"domainGenerationAlgorithms"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainTrustDiscoveryDescription",{defaultMessage:"Domain Trust Discovery (T1482)"}),id:"T1482",name:"Domain Trust Discovery",reference:"https://attack.mitre.org/techniques/T1482",tactics:"discovery",value:"domainTrustDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.driveByCompromiseDescription",{defaultMessage:"Drive-by Compromise (T1189)"}),id:"T1189",name:"Drive-by Compromise",reference:"https://attack.mitre.org/techniques/T1189",tactics:"initial-access",value:"driveByCompromise"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dylibHijackingDescription",{defaultMessage:"Dylib Hijacking (T1157)"}),id:"T1157",name:"Dylib Hijacking",reference:"https://attack.mitre.org/techniques/T1157",tactics:"persistence,privilege-escalation",value:"dylibHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dynamicDataExchangeDescription",{defaultMessage:"Dynamic Data Exchange (T1173)"}),id:"T1173",name:"Dynamic Data Exchange",reference:"https://attack.mitre.org/techniques/T1173",tactics:"execution",value:"dynamicDataExchange"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.elevatedExecutionWithPromptDescription",{defaultMessage:"Elevated Execution with Prompt (T1514)"}),id:"T1514",name:"Elevated Execution with Prompt",reference:"https://attack.mitre.org/techniques/T1514",tactics:"privilege-escalation",value:"elevatedExecutionWithPrompt"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.emailCollectionDescription",{defaultMessage:"Email Collection (T1114)"}),id:"T1114",name:"Email Collection",reference:"https://attack.mitre.org/techniques/T1114",tactics:"collection",value:"emailCollection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.emondDescription",{defaultMessage:"Emond (T1519)"}),id:"T1519",name:"Emond",reference:"https://attack.mitre.org/techniques/T1519",tactics:"persistence,privilege-escalation",value:"emond"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.endpointDenialOfServiceDescription",{defaultMessage:"Endpoint Denial of Service (T1499)"}),id:"T1499",name:"Endpoint Denial of Service",reference:"https://attack.mitre.org/techniques/T1499",tactics:"impact",value:"endpointDenialOfService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.executionGuardrailsDescription",{defaultMessage:"Execution Guardrails (T1480)"}),id:"T1480",name:"Execution Guardrails",reference:"https://attack.mitre.org/techniques/T1480",tactics:"defense-evasion",value:"executionGuardrails"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.executionThroughApiDescription",{defaultMessage:"Execution through API (T1106)"}),id:"T1106",name:"Execution through API",reference:"https://attack.mitre.org/techniques/T1106",tactics:"execution",value:"executionThroughApi"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.executionThroughModuleLoadDescription",{defaultMessage:"Execution through Module Load (T1129)"}),id:"T1129",name:"Execution through Module Load",reference:"https://attack.mitre.org/techniques/T1129",tactics:"execution",value:"executionThroughModuleLoad"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverAlternativeProtocolDescription",{defaultMessage:"Exfiltration Over Alternative Protocol (T1048)"}),id:"T1048",name:"Exfiltration Over Alternative Protocol",reference:"https://attack.mitre.org/techniques/T1048",tactics:"exfiltration",value:"exfiltrationOverAlternativeProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverCommandAndControlChannelDescription",{defaultMessage:"Exfiltration Over Command and Control Channel (T1041)"}),id:"T1041",name:"Exfiltration Over Command and Control Channel",reference:"https://attack.mitre.org/techniques/T1041",tactics:"exfiltration",value:"exfiltrationOverCommandAndControlChannel"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverOtherNetworkMediumDescription",{defaultMessage:"Exfiltration Over Other Network Medium (T1011)"}),id:"T1011",name:"Exfiltration Over Other Network Medium",reference:"https://attack.mitre.org/techniques/T1011",tactics:"exfiltration",value:"exfiltrationOverOtherNetworkMedium"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverPhysicalMediumDescription",{defaultMessage:"Exfiltration Over Physical Medium (T1052)"}),id:"T1052",name:"Exfiltration Over Physical Medium",reference:"https://attack.mitre.org/techniques/T1052",tactics:"exfiltration",value:"exfiltrationOverPhysicalMedium"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitPublicFacingApplicationDescription",{defaultMessage:"Exploit Public-Facing Application (T1190)"}),id:"T1190",name:"Exploit Public-Facing Application",reference:"https://attack.mitre.org/techniques/T1190",tactics:"initial-access",value:"exploitPublicFacingApplication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForClientExecutionDescription",{defaultMessage:"Exploitation for Client Execution (T1203)"}),id:"T1203",name:"Exploitation for Client Execution",reference:"https://attack.mitre.org/techniques/T1203",tactics:"execution",value:"exploitationForClientExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForCredentialAccessDescription",{defaultMessage:"Exploitation for Credential Access (T1212)"}),id:"T1212",name:"Exploitation for Credential Access",reference:"https://attack.mitre.org/techniques/T1212",tactics:"credential-access",value:"exploitationForCredentialAccess"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForDefenseEvasionDescription",{defaultMessage:"Exploitation for Defense Evasion (T1211)"}),id:"T1211",name:"Exploitation for Defense Evasion",reference:"https://attack.mitre.org/techniques/T1211",tactics:"defense-evasion",value:"exploitationForDefenseEvasion"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForPrivilegeEscalationDescription",{defaultMessage:"Exploitation for Privilege Escalation (T1068)"}),id:"T1068",name:"Exploitation for Privilege Escalation",reference:"https://attack.mitre.org/techniques/T1068",tactics:"privilege-escalation",value:"exploitationForPrivilegeEscalation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationOfRemoteServicesDescription",{defaultMessage:"Exploitation of Remote Services (T1210)"}),id:"T1210",name:"Exploitation of Remote Services",reference:"https://attack.mitre.org/techniques/T1210",tactics:"lateral-movement",value:"exploitationOfRemoteServices"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.externalRemoteServicesDescription",{defaultMessage:"External Remote Services (T1133)"}),id:"T1133",name:"External Remote Services",reference:"https://attack.mitre.org/techniques/T1133",tactics:"persistence,initial-access",value:"externalRemoteServices"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.extraWindowMemoryInjectionDescription",{defaultMessage:"Extra Window Memory Injection (T1181)"}),id:"T1181",name:"Extra Window Memory Injection",reference:"https://attack.mitre.org/techniques/T1181",tactics:"defense-evasion,privilege-escalation",value:"extraWindowMemoryInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fallbackChannelsDescription",{defaultMessage:"Fallback Channels (T1008)"}),id:"T1008",name:"Fallback Channels",reference:"https://attack.mitre.org/techniques/T1008",tactics:"command-and-control",value:"fallbackChannels"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileDeletionDescription",{defaultMessage:"File Deletion (T1107)"}),id:"T1107",name:"File Deletion",reference:"https://attack.mitre.org/techniques/T1107",tactics:"defense-evasion",value:"fileDeletion"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileSystemLogicalOffsetsDescription",{defaultMessage:"File System Logical Offsets (T1006)"}),id:"T1006",name:"File System Logical Offsets",reference:"https://attack.mitre.org/techniques/T1006",tactics:"defense-evasion",value:"fileSystemLogicalOffsets"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileSystemPermissionsWeaknessDescription",{defaultMessage:"File System Permissions Weakness (T1044)"}),id:"T1044",name:"File System Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1044",tactics:"persistence,privilege-escalation",value:"fileSystemPermissionsWeakness"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryDiscoveryDescription",{defaultMessage:"File and Directory Discovery (T1083)"}),id:"T1083",name:"File and Directory Discovery",reference:"https://attack.mitre.org/techniques/T1083",tactics:"discovery",value:"fileAndDirectoryDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryPermissionsModificationDescription",{defaultMessage:"File and Directory Permissions Modification (T1222)"}),id:"T1222",name:"File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222",tactics:"defense-evasion",value:"fileAndDirectoryPermissionsModification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.firmwareCorruptionDescription",{defaultMessage:"Firmware Corruption (T1495)"}),id:"T1495",name:"Firmware Corruption",reference:"https://attack.mitre.org/techniques/T1495",tactics:"impact",value:"firmwareCorruption"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.forcedAuthenticationDescription",{defaultMessage:"Forced Authentication (T1187)"}),id:"T1187",name:"Forced Authentication",reference:"https://attack.mitre.org/techniques/T1187",tactics:"credential-access",value:"forcedAuthentication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatekeeperBypassDescription",{defaultMessage:"Gatekeeper Bypass (T1144)"}),id:"T1144",name:"Gatekeeper Bypass",reference:"https://attack.mitre.org/techniques/T1144",tactics:"defense-evasion",value:"gatekeeperBypass"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.graphicalUserInterfaceDescription",{defaultMessage:"Graphical User Interface (T1061)"}),id:"T1061",name:"Graphical User Interface",reference:"https://attack.mitre.org/techniques/T1061",tactics:"execution",value:"graphicalUserInterface"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.groupPolicyModificationDescription",{defaultMessage:"Group Policy Modification (T1484)"}),id:"T1484",name:"Group Policy Modification",reference:"https://attack.mitre.org/techniques/T1484",tactics:"defense-evasion",value:"groupPolicyModification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.histcontrolDescription",{defaultMessage:"HISTCONTROL (T1148)"}),id:"T1148",name:"HISTCONTROL",reference:"https://attack.mitre.org/techniques/T1148",tactics:"defense-evasion",value:"histcontrol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hardwareAdditionsDescription",{defaultMessage:"Hardware Additions (T1200)"}),id:"T1200",name:"Hardware Additions",reference:"https://attack.mitre.org/techniques/T1200",tactics:"initial-access",value:"hardwareAdditions"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hiddenFilesAndDirectoriesDescription",{defaultMessage:"Hidden Files and Directories (T1158)"}),id:"T1158",name:"Hidden Files and Directories",reference:"https://attack.mitre.org/techniques/T1158",tactics:"defense-evasion,persistence",value:"hiddenFilesAndDirectories"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hiddenUsersDescription",{defaultMessage:"Hidden Users (T1147)"}),id:"T1147",name:"Hidden Users",reference:"https://attack.mitre.org/techniques/T1147",tactics:"defense-evasion",value:"hiddenUsers"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hiddenWindowDescription",{defaultMessage:"Hidden Window (T1143)"}),id:"T1143",name:"Hidden Window",reference:"https://attack.mitre.org/techniques/T1143",tactics:"defense-evasion",value:"hiddenWindow"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hookingDescription",{defaultMessage:"Hooking (T1179)"}),id:"T1179",name:"Hooking",reference:"https://attack.mitre.org/techniques/T1179",tactics:"persistence,privilege-escalation,credential-access",value:"hooking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hypervisorDescription",{defaultMessage:"Hypervisor (T1062)"}),id:"T1062",name:"Hypervisor",reference:"https://attack.mitre.org/techniques/T1062",tactics:"persistence",value:"hypervisor"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.imageFileExecutionOptionsInjectionDescription",{defaultMessage:"Image File Execution Options Injection (T1183)"}),id:"T1183",name:"Image File Execution Options Injection",reference:"https://attack.mitre.org/techniques/T1183",tactics:"privilege-escalation,persistence,defense-evasion",value:"imageFileExecutionOptionsInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.implantContainerImageDescription",{defaultMessage:"Implant Container Image (T1525)"}),id:"T1525",name:"Implant Container Image",reference:"https://attack.mitre.org/techniques/T1525",tactics:"persistence",value:"implantContainerImage"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indicatorBlockingDescription",{defaultMessage:"Indicator Blocking (T1054)"}),id:"T1054",name:"Indicator Blocking",reference:"https://attack.mitre.org/techniques/T1054",tactics:"defense-evasion",value:"indicatorBlocking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indicatorRemovalFromToolsDescription",{defaultMessage:"Indicator Removal from Tools (T1066)"}),id:"T1066",name:"Indicator Removal from Tools",reference:"https://attack.mitre.org/techniques/T1066",tactics:"defense-evasion",value:"indicatorRemovalFromTools"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indicatorRemovalOnHostDescription",{defaultMessage:"Indicator Removal on Host (T1070)"}),id:"T1070",name:"Indicator Removal on Host",reference:"https://attack.mitre.org/techniques/T1070",tactics:"defense-evasion",value:"indicatorRemovalOnHost"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indirectCommandExecutionDescription",{defaultMessage:"Indirect Command Execution (T1202)"}),id:"T1202",name:"Indirect Command Execution",reference:"https://attack.mitre.org/techniques/T1202",tactics:"defense-evasion",value:"indirectCommandExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inhibitSystemRecoveryDescription",{defaultMessage:"Inhibit System Recovery (T1490)"}),id:"T1490",name:"Inhibit System Recovery",reference:"https://attack.mitre.org/techniques/T1490",tactics:"impact",value:"inhibitSystemRecovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inputCaptureDescription",{defaultMessage:"Input Capture (T1056)"}),id:"T1056",name:"Input Capture",reference:"https://attack.mitre.org/techniques/T1056",tactics:"collection,credential-access",value:"inputCapture"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inputPromptDescription",{defaultMessage:"Input Prompt (T1141)"}),id:"T1141",name:"Input Prompt",reference:"https://attack.mitre.org/techniques/T1141",tactics:"credential-access",value:"inputPrompt"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.installRootCertificateDescription",{defaultMessage:"Install Root Certificate (T1130)"}),id:"T1130",name:"Install Root Certificate",reference:"https://attack.mitre.org/techniques/T1130",tactics:"defense-evasion",value:"installRootCertificate"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.installUtilDescription",{defaultMessage:"InstallUtil (T1118)"}),id:"T1118",name:"InstallUtil",reference:"https://attack.mitre.org/techniques/T1118",tactics:"defense-evasion,execution",value:"installUtil"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.internalSpearphishingDescription",{defaultMessage:"Internal Spearphishing (T1534)"}),id:"T1534",name:"Internal Spearphishing",reference:"https://attack.mitre.org/techniques/T1534",tactics:"lateral-movement",value:"internalSpearphishing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.kerberoastingDescription",{defaultMessage:"Kerberoasting (T1208)"}),id:"T1208",name:"Kerberoasting",reference:"https://attack.mitre.org/techniques/T1208",tactics:"credential-access",value:"kerberoasting"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.kernelModulesAndExtensionsDescription",{defaultMessage:"Kernel Modules and Extensions (T1215)"}),id:"T1215",name:"Kernel Modules and Extensions",reference:"https://attack.mitre.org/techniques/T1215",tactics:"persistence",value:"kernelModulesAndExtensions"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.keychainDescription",{defaultMessage:"Keychain (T1142)"}),id:"T1142",name:"Keychain",reference:"https://attack.mitre.org/techniques/T1142",tactics:"credential-access",value:"keychain"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lcLoadDylibAdditionDescription",{defaultMessage:"LC_LOAD_DYLIB Addition (T1161)"}),id:"T1161",name:"LC_LOAD_DYLIB Addition",reference:"https://attack.mitre.org/techniques/T1161",tactics:"persistence",value:"lcLoadDylibAddition"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lcMainHijackingDescription",{defaultMessage:"LC_MAIN Hijacking (T1149)"}),id:"T1149",name:"LC_MAIN Hijacking",reference:"https://attack.mitre.org/techniques/T1149",tactics:"defense-evasion",value:"lcMainHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.llmnrNbtNsPoisoningAndRelayDescription",{defaultMessage:"LLMNR/NBT-NS Poisoning and Relay (T1171)"}),id:"T1171",name:"LLMNR/NBT-NS Poisoning and Relay",reference:"https://attack.mitre.org/techniques/T1171",tactics:"credential-access",value:"llmnrNbtNsPoisoningAndRelay"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lsassDriverDescription",{defaultMessage:"LSASS Driver (T1177)"}),id:"T1177",name:"LSASS Driver",reference:"https://attack.mitre.org/techniques/T1177",tactics:"execution,persistence",value:"lsassDriver"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.launchAgentDescription",{defaultMessage:"Launch Agent (T1159)"}),id:"T1159",name:"Launch Agent",reference:"https://attack.mitre.org/techniques/T1159",tactics:"persistence",value:"launchAgent"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.launchDaemonDescription",{defaultMessage:"Launch Daemon (T1160)"}),id:"T1160",name:"Launch Daemon",reference:"https://attack.mitre.org/techniques/T1160",tactics:"persistence,privilege-escalation",value:"launchDaemon"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.launchctlDescription",{defaultMessage:"Launchctl (T1152)"}),id:"T1152",name:"Launchctl",reference:"https://attack.mitre.org/techniques/T1152",tactics:"defense-evasion,execution,persistence",value:"launchctl"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.localJobSchedulingDescription",{defaultMessage:"Local Job Scheduling (T1168)"}),id:"T1168",name:"Local Job Scheduling",reference:"https://attack.mitre.org/techniques/T1168",tactics:"persistence,execution",value:"localJobScheduling"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.loginItemDescription",{defaultMessage:"Login Item (T1162)"}),id:"T1162",name:"Login Item",reference:"https://attack.mitre.org/techniques/T1162",tactics:"persistence",value:"loginItem"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.logonScriptsDescription",{defaultMessage:"Logon Scripts (T1037)"}),id:"T1037",name:"Logon Scripts",reference:"https://attack.mitre.org/techniques/T1037",tactics:"lateral-movement,persistence",value:"logonScripts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.manInTheBrowserDescription",{defaultMessage:"Man in the Browser (T1185)"}),id:"T1185",name:"Man in the Browser",reference:"https://attack.mitre.org/techniques/T1185",tactics:"collection",value:"manInTheBrowser"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.masqueradingDescription",{defaultMessage:"Masquerading (T1036)"}),id:"T1036",name:"Masquerading",reference:"https://attack.mitre.org/techniques/T1036",tactics:"defense-evasion",value:"masquerading"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyExistingServiceDescription",{defaultMessage:"Modify Existing Service (T1031)"}),id:"T1031",name:"Modify Existing Service",reference:"https://attack.mitre.org/techniques/T1031",tactics:"persistence",value:"modifyExistingService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyRegistryDescription",{defaultMessage:"Modify Registry (T1112)"}),id:"T1112",name:"Modify Registry",reference:"https://attack.mitre.org/techniques/T1112",tactics:"defense-evasion",value:"modifyRegistry"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.mshtaDescription",{defaultMessage:"Mshta (T1170)"}),id:"T1170",name:"Mshta",reference:"https://attack.mitre.org/techniques/T1170",tactics:"defense-evasion,execution",value:"mshta"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multiStageChannelsDescription",{defaultMessage:"Multi-Stage Channels (T1104)"}),id:"T1104",name:"Multi-Stage Channels",reference:"https://attack.mitre.org/techniques/T1104",tactics:"command-and-control",value:"multiStageChannels"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multiHopProxyDescription",{defaultMessage:"Multi-hop Proxy (T1188)"}),id:"T1188",name:"Multi-hop Proxy",reference:"https://attack.mitre.org/techniques/T1188",tactics:"command-and-control",value:"multiHopProxy"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multibandCommunicationDescription",{defaultMessage:"Multiband Communication (T1026)"}),id:"T1026",name:"Multiband Communication",reference:"https://attack.mitre.org/techniques/T1026",tactics:"command-and-control",value:"multibandCommunication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multilayerEncryptionDescription",{defaultMessage:"Multilayer Encryption (T1079)"}),id:"T1079",name:"Multilayer Encryption",reference:"https://attack.mitre.org/techniques/T1079",tactics:"command-and-control",value:"multilayerEncryption"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.ntfsFileAttributesDescription",{defaultMessage:"NTFS File Attributes (T1096)"}),id:"T1096",name:"NTFS File Attributes",reference:"https://attack.mitre.org/techniques/T1096",tactics:"defense-evasion",value:"ntfsFileAttributes"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.netshHelperDllDescription",{defaultMessage:"Netsh Helper DLL (T1128)"}),id:"T1128",name:"Netsh Helper DLL",reference:"https://attack.mitre.org/techniques/T1128",tactics:"persistence",value:"netshHelperDll"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkDenialOfServiceDescription",{defaultMessage:"Network Denial of Service (T1498)"}),id:"T1498",name:"Network Denial of Service",reference:"https://attack.mitre.org/techniques/T1498",tactics:"impact",value:"networkDenialOfService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkServiceScanningDescription",{defaultMessage:"Network Service Scanning (T1046)"}),id:"T1046",name:"Network Service Scanning",reference:"https://attack.mitre.org/techniques/T1046",tactics:"discovery",value:"networkServiceScanning"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkShareConnectionRemovalDescription",{defaultMessage:"Network Share Connection Removal (T1126)"}),id:"T1126",name:"Network Share Connection Removal",reference:"https://attack.mitre.org/techniques/T1126",tactics:"defense-evasion",value:"networkShareConnectionRemoval"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkShareDiscoveryDescription",{defaultMessage:"Network Share Discovery (T1135)"}),id:"T1135",name:"Network Share Discovery",reference:"https://attack.mitre.org/techniques/T1135",tactics:"discovery",value:"networkShareDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkSniffingDescription",{defaultMessage:"Network Sniffing (T1040)"}),id:"T1040",name:"Network Sniffing",reference:"https://attack.mitre.org/techniques/T1040",tactics:"credential-access,discovery",value:"networkSniffing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.newServiceDescription",{defaultMessage:"New Service (T1050)"}),id:"T1050",name:"New Service",reference:"https://attack.mitre.org/techniques/T1050",tactics:"persistence,privilege-escalation",value:"newService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obfuscatedFilesOrInformationDescription",{defaultMessage:"Obfuscated Files or Information (T1027)"}),id:"T1027",name:"Obfuscated Files or Information",reference:"https://attack.mitre.org/techniques/T1027",tactics:"defense-evasion",value:"obfuscatedFilesOrInformation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.officeApplicationStartupDescription",{defaultMessage:"Office Application Startup (T1137)"}),id:"T1137",name:"Office Application Startup",reference:"https://attack.mitre.org/techniques/T1137",tactics:"persistence",value:"officeApplicationStartup"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.parentPidSpoofingDescription",{defaultMessage:"Parent PID Spoofing (T1502)"}),id:"T1502",name:"Parent PID Spoofing",reference:"https://attack.mitre.org/techniques/T1502",tactics:"defense-evasion,privilege-escalation",value:"parentPidSpoofing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passTheHashDescription",{defaultMessage:"Pass the Hash (T1075)"}),id:"T1075",name:"Pass the Hash",reference:"https://attack.mitre.org/techniques/T1075",tactics:"lateral-movement",value:"passTheHash"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passTheTicketDescription",{defaultMessage:"Pass the Ticket (T1097)"}),id:"T1097",name:"Pass the Ticket",reference:"https://attack.mitre.org/techniques/T1097",tactics:"lateral-movement",value:"passTheTicket"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passwordFilterDllDescription",{defaultMessage:"Password Filter DLL (T1174)"}),id:"T1174",name:"Password Filter DLL",reference:"https://attack.mitre.org/techniques/T1174",tactics:"credential-access",value:"passwordFilterDll"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passwordPolicyDiscoveryDescription",{defaultMessage:"Password Policy Discovery (T1201)"}),id:"T1201",name:"Password Policy Discovery",reference:"https://attack.mitre.org/techniques/T1201",tactics:"discovery",value:"passwordPolicyDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.pathInterceptionDescription",{defaultMessage:"Path Interception (T1034)"}),id:"T1034",name:"Path Interception",reference:"https://attack.mitre.org/techniques/T1034",tactics:"persistence,privilege-escalation",value:"pathInterception"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.peripheralDeviceDiscoveryDescription",{defaultMessage:"Peripheral Device Discovery (T1120)"}),id:"T1120",name:"Peripheral Device Discovery",reference:"https://attack.mitre.org/techniques/T1120",tactics:"discovery",value:"peripheralDeviceDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.permissionGroupsDiscoveryDescription",{defaultMessage:"Permission Groups Discovery (T1069)"}),id:"T1069",name:"Permission Groups Discovery",reference:"https://attack.mitre.org/techniques/T1069",tactics:"discovery",value:"permissionGroupsDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.plistModificationDescription",{defaultMessage:"Plist Modification (T1150)"}),id:"T1150",name:"Plist Modification",reference:"https://attack.mitre.org/techniques/T1150",tactics:"defense-evasion,persistence,privilege-escalation",value:"plistModification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.portKnockingDescription",{defaultMessage:"Port Knocking (T1205)"}),id:"T1205",name:"Port Knocking",reference:"https://attack.mitre.org/techniques/T1205",tactics:"defense-evasion,persistence,command-and-control",value:"portKnocking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.portMonitorsDescription",{defaultMessage:"Port Monitors (T1013)"}),id:"T1013",name:"Port Monitors",reference:"https://attack.mitre.org/techniques/T1013",tactics:"persistence,privilege-escalation",value:"portMonitors"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.powerShellDescription",{defaultMessage:"PowerShell (T1086)"}),id:"T1086",name:"PowerShell",reference:"https://attack.mitre.org/techniques/T1086",tactics:"execution",value:"powerShell"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.powerShellProfileDescription",{defaultMessage:"PowerShell Profile (T1504)"}),id:"T1504",name:"PowerShell Profile",reference:"https://attack.mitre.org/techniques/T1504",tactics:"persistence,privilege-escalation",value:"powerShellProfile"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.privateKeysDescription",{defaultMessage:"Private Keys (T1145)"}),id:"T1145",name:"Private Keys",reference:"https://attack.mitre.org/techniques/T1145",tactics:"credential-access",value:"privateKeys"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processDiscoveryDescription",{defaultMessage:"Process Discovery (T1057)"}),id:"T1057",name:"Process Discovery",reference:"https://attack.mitre.org/techniques/T1057",tactics:"discovery",value:"processDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processDoppelgangingDescription",{defaultMessage:"Process Doppelgänging (T1186)"}),id:"T1186",name:"Process Doppelgänging",reference:"https://attack.mitre.org/techniques/T1186",tactics:"defense-evasion",value:"processDoppelganging"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processHollowingDescription",{defaultMessage:"Process Hollowing (T1093)"}),id:"T1093",name:"Process Hollowing",reference:"https://attack.mitre.org/techniques/T1093",tactics:"defense-evasion",value:"processHollowing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processInjectionDescription",{defaultMessage:"Process Injection (T1055)"}),id:"T1055",name:"Process Injection",reference:"https://attack.mitre.org/techniques/T1055",tactics:"defense-evasion,privilege-escalation",value:"processInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.queryRegistryDescription",{defaultMessage:"Query Registry (T1012)"}),id:"T1012",name:"Query Registry",reference:"https://attack.mitre.org/techniques/T1012",tactics:"discovery",value:"queryRegistry"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rcCommonDescription",{defaultMessage:"Rc.common (T1163)"}),id:"T1163",name:"Rc.common",reference:"https://attack.mitre.org/techniques/T1163",tactics:"persistence",value:"rcCommon"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.reOpenedApplicationsDescription",{defaultMessage:"Re-opened Applications (T1164)"}),id:"T1164",name:"Re-opened Applications",reference:"https://attack.mitre.org/techniques/T1164",tactics:"persistence",value:"reOpenedApplications"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.redundantAccessDescription",{defaultMessage:"Redundant Access (T1108)"}),id:"T1108",name:"Redundant Access",reference:"https://attack.mitre.org/techniques/T1108",tactics:"defense-evasion,persistence",value:"redundantAccess"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.registryRunKeysStartupFolderDescription",{defaultMessage:"Registry Run Keys / Startup Folder (T1060)"}),id:"T1060",name:"Registry Run Keys / Startup Folder",reference:"https://attack.mitre.org/techniques/T1060",tactics:"persistence",value:"registryRunKeysStartupFolder"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.regsvcsRegasmDescription",{defaultMessage:"Regsvcs/Regasm (T1121)"}),id:"T1121",name:"Regsvcs/Regasm",reference:"https://attack.mitre.org/techniques/T1121",tactics:"defense-evasion,execution",value:"regsvcsRegasm"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.regsvr32Description",{defaultMessage:"Regsvr32 (T1117)"}),id:"T1117",name:"Regsvr32",reference:"https://attack.mitre.org/techniques/T1117",tactics:"defense-evasion,execution",value:"regsvr32"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteAccessToolsDescription",{defaultMessage:"Remote Access Tools (T1219)"}),id:"T1219",name:"Remote Access Tools",reference:"https://attack.mitre.org/techniques/T1219",tactics:"command-and-control",value:"remoteAccessTools"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteDesktopProtocolDescription",{defaultMessage:"Remote Desktop Protocol (T1076)"}),id:"T1076",name:"Remote Desktop Protocol",reference:"https://attack.mitre.org/techniques/T1076",tactics:"lateral-movement",value:"remoteDesktopProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteFileCopyDescription",{defaultMessage:"Remote File Copy (T1105)"}),id:"T1105",name:"Remote File Copy",reference:"https://attack.mitre.org/techniques/T1105",tactics:"command-and-control,lateral-movement",value:"remoteFileCopy"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServicesDescription",{defaultMessage:"Remote Services (T1021)"}),id:"T1021",name:"Remote Services",reference:"https://attack.mitre.org/techniques/T1021",tactics:"lateral-movement",value:"remoteServices"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteSystemDiscoveryDescription",{defaultMessage:"Remote System Discovery (T1018)"}),id:"T1018",name:"Remote System Discovery",reference:"https://attack.mitre.org/techniques/T1018",tactics:"discovery",value:"remoteSystemDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.replicationThroughRemovableMediaDescription",{defaultMessage:"Replication Through Removable Media (T1091)"}),id:"T1091",name:"Replication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1091",tactics:"lateral-movement,initial-access",value:"replicationThroughRemovableMedia"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.resourceHijackingDescription",{defaultMessage:"Resource Hijacking (T1496)"}),id:"T1496",name:"Resource Hijacking",reference:"https://attack.mitre.org/techniques/T1496",tactics:"impact",value:"resourceHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.revertCloudInstanceDescription",{defaultMessage:"Revert Cloud Instance (T1536)"}),id:"T1536",name:"Revert Cloud Instance",reference:"https://attack.mitre.org/techniques/T1536",tactics:"defense-evasion",value:"revertCloudInstance"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rootkitDescription",{defaultMessage:"Rootkit (T1014)"}),id:"T1014",name:"Rootkit",reference:"https://attack.mitre.org/techniques/T1014",tactics:"defense-evasion",value:"rootkit"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rundll32Description",{defaultMessage:"Rundll32 (T1085)"}),id:"T1085",name:"Rundll32",reference:"https://attack.mitre.org/techniques/T1085",tactics:"defense-evasion,execution",value:"rundll32"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.runtimeDataManipulationDescription",{defaultMessage:"Runtime Data Manipulation (T1494)"}),id:"T1494",name:"Runtime Data Manipulation",reference:"https://attack.mitre.org/techniques/T1494",tactics:"impact",value:"runtimeDataManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sidHistoryInjectionDescription",{defaultMessage:"SID-History Injection (T1178)"}),id:"T1178",name:"SID-History Injection",reference:"https://attack.mitre.org/techniques/T1178",tactics:"privilege-escalation",value:"sidHistoryInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sipAndTrustProviderHijackingDescription",{defaultMessage:"SIP and Trust Provider Hijacking (T1198)"}),id:"T1198",name:"SIP and Trust Provider Hijacking",reference:"https://attack.mitre.org/techniques/T1198",tactics:"defense-evasion,persistence",value:"sipAndTrustProviderHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sshHijackingDescription",{defaultMessage:"SSH Hijacking (T1184)"}),id:"T1184",name:"SSH Hijacking",reference:"https://attack.mitre.org/techniques/T1184",tactics:"lateral-movement",value:"sshHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTaskDescription",{defaultMessage:"Scheduled Task (T1053)"}),id:"T1053",name:"Scheduled Task",reference:"https://attack.mitre.org/techniques/T1053",tactics:"execution,persistence,privilege-escalation",value:"scheduledTask"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTransferDescription",{defaultMessage:"Scheduled Transfer (T1029)"}),id:"T1029",name:"Scheduled Transfer",reference:"https://attack.mitre.org/techniques/T1029",tactics:"exfiltration",value:"scheduledTransfer"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.screenCaptureDescription",{defaultMessage:"Screen Capture (T1113)"}),id:"T1113",name:"Screen Capture",reference:"https://attack.mitre.org/techniques/T1113",tactics:"collection",value:"screenCapture"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.screensaverDescription",{defaultMessage:"Screensaver (T1180)"}),id:"T1180",name:"Screensaver",reference:"https://attack.mitre.org/techniques/T1180",tactics:"persistence",value:"screensaver"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scriptingDescription",{defaultMessage:"Scripting (T1064)"}),id:"T1064",name:"Scripting",reference:"https://attack.mitre.org/techniques/T1064",tactics:"defense-evasion,execution",value:"scripting"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.securitySoftwareDiscoveryDescription",{defaultMessage:"Security Software Discovery (T1063)"}),id:"T1063",name:"Security Software Discovery",reference:"https://attack.mitre.org/techniques/T1063",tactics:"discovery",value:"securitySoftwareDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.securitySupportProviderDescription",{defaultMessage:"Security Support Provider (T1101)"}),id:"T1101",name:"Security Support Provider",reference:"https://attack.mitre.org/techniques/T1101",tactics:"persistence",value:"securitySupportProvider"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.securitydMemoryDescription",{defaultMessage:"Securityd Memory (T1167)"}),id:"T1167",name:"Securityd Memory",reference:"https://attack.mitre.org/techniques/T1167",tactics:"credential-access",value:"securitydMemory"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serverSoftwareComponentDescription",{defaultMessage:"Server Software Component (T1505)"}),id:"T1505",name:"Server Software Component",reference:"https://attack.mitre.org/techniques/T1505",tactics:"persistence",value:"serverSoftwareComponent"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serviceExecutionDescription",{defaultMessage:"Service Execution (T1035)"}),id:"T1035",name:"Service Execution",reference:"https://attack.mitre.org/techniques/T1035",tactics:"execution",value:"serviceExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serviceRegistryPermissionsWeaknessDescription",{defaultMessage:"Service Registry Permissions Weakness (T1058)"}),id:"T1058",name:"Service Registry Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1058",tactics:"persistence,privilege-escalation",value:"serviceRegistryPermissionsWeakness"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serviceStopDescription",{defaultMessage:"Service Stop (T1489)"}),id:"T1489",name:"Service Stop",reference:"https://attack.mitre.org/techniques/T1489",tactics:"impact",value:"serviceStop"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.setuidAndSetgidDescription",{defaultMessage:"Setuid and Setgid (T1166)"}),id:"T1166",name:"Setuid and Setgid",reference:"https://attack.mitre.org/techniques/T1166",tactics:"privilege-escalation,persistence",value:"setuidAndSetgid"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedWebrootDescription",{defaultMessage:"Shared Webroot (T1051)"}),id:"T1051",name:"Shared Webroot",reference:"https://attack.mitre.org/techniques/T1051",tactics:"lateral-movement",value:"sharedWebroot"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.shortcutModificationDescription",{defaultMessage:"Shortcut Modification (T1023)"}),id:"T1023",name:"Shortcut Modification",reference:"https://attack.mitre.org/techniques/T1023",tactics:"persistence",value:"shortcutModification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.signedBinaryProxyExecutionDescription",{defaultMessage:"Signed Binary Proxy Execution (T1218)"}),id:"T1218",name:"Signed Binary Proxy Execution",reference:"https://attack.mitre.org/techniques/T1218",tactics:"defense-evasion,execution",value:"signedBinaryProxyExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.signedScriptProxyExecutionDescription",{defaultMessage:"Signed Script Proxy Execution (T1216)"}),id:"T1216",name:"Signed Script Proxy Execution",reference:"https://attack.mitre.org/techniques/T1216",tactics:"defense-evasion,execution",value:"signedScriptProxyExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDiscoveryDescription",{defaultMessage:"Software Discovery (T1518)"}),id:"T1518",name:"Software Discovery",reference:"https://attack.mitre.org/techniques/T1518",tactics:"discovery",value:"softwareDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwarePackingDescription",{defaultMessage:"Software Packing (T1045)"}),id:"T1045",name:"Software Packing",reference:"https://attack.mitre.org/techniques/T1045",tactics:"defense-evasion",value:"softwarePacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sourceDescription",{defaultMessage:"Source (T1153)"}),id:"T1153",name:"Source",reference:"https://attack.mitre.org/techniques/T1153",tactics:"execution",value:"source"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.spaceAfterFilenameDescription",{defaultMessage:"Space after Filename (T1151)"}),id:"T1151",name:"Space after Filename",reference:"https://attack.mitre.org/techniques/T1151",tactics:"defense-evasion,execution",value:"spaceAfterFilename"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.spearphishingAttachmentDescription",{defaultMessage:"Spearphishing Attachment (T1193)"}),id:"T1193",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1193",tactics:"initial-access",value:"spearphishingAttachment"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.spearphishingLinkDescription",{defaultMessage:"Spearphishing Link (T1192)"}),id:"T1192",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1192",tactics:"initial-access",value:"spearphishingLink"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.spearphishingViaServiceDescription",{defaultMessage:"Spearphishing via Service (T1194)"}),id:"T1194",name:"Spearphishing via Service",reference:"https://attack.mitre.org/techniques/T1194",tactics:"initial-access",value:"spearphishingViaService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.standardApplicationLayerProtocolDescription",{defaultMessage:"Standard Application Layer Protocol (T1071)"}),id:"T1071",name:"Standard Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1071",tactics:"command-and-control",value:"standardApplicationLayerProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.standardCryptographicProtocolDescription",{defaultMessage:"Standard Cryptographic Protocol (T1032)"}),id:"T1032",name:"Standard Cryptographic Protocol",reference:"https://attack.mitre.org/techniques/T1032",tactics:"command-and-control",value:"standardCryptographicProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.standardNonApplicationLayerProtocolDescription",{defaultMessage:"Standard Non-Application Layer Protocol (T1095)"}),id:"T1095",name:"Standard Non-Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1095",tactics:"command-and-control",value:"standardNonApplicationLayerProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.startupItemsDescription",{defaultMessage:"Startup Items (T1165)"}),id:"T1165",name:"Startup Items",reference:"https://attack.mitre.org/techniques/T1165",tactics:"persistence,privilege-escalation",value:"startupItems"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealApplicationAccessTokenDescription",{defaultMessage:"Steal Application Access Token (T1528)"}),id:"T1528",name:"Steal Application Access Token",reference:"https://attack.mitre.org/techniques/T1528",tactics:"credential-access",value:"stealApplicationAccessToken"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealWebSessionCookieDescription",{defaultMessage:"Steal Web Session Cookie (T1539)"}),id:"T1539",name:"Steal Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1539",tactics:"credential-access",value:"stealWebSessionCookie"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.storedDataManipulationDescription",{defaultMessage:"Stored Data Manipulation (T1492)"}),id:"T1492",name:"Stored Data Manipulation",reference:"https://attack.mitre.org/techniques/T1492",tactics:"impact",value:"storedDataManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sudoDescription",{defaultMessage:"Sudo (T1169)"}),id:"T1169",name:"Sudo",reference:"https://attack.mitre.org/techniques/T1169",tactics:"privilege-escalation",value:"sudo"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sudoCachingDescription",{defaultMessage:"Sudo Caching (T1206)"}),id:"T1206",name:"Sudo Caching",reference:"https://attack.mitre.org/techniques/T1206",tactics:"privilege-escalation",value:"sudoCaching"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.supplyChainCompromiseDescription",{defaultMessage:"Supply Chain Compromise (T1195)"}),id:"T1195",name:"Supply Chain Compromise",reference:"https://attack.mitre.org/techniques/T1195",tactics:"initial-access",value:"supplyChainCompromise"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemFirmwareDescription",{defaultMessage:"System Firmware (T1019)"}),id:"T1019",name:"System Firmware",reference:"https://attack.mitre.org/techniques/T1019",tactics:"persistence",value:"systemFirmware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemInformationDiscoveryDescription",{defaultMessage:"System Information Discovery (T1082)"}),id:"T1082",name:"System Information Discovery",reference:"https://attack.mitre.org/techniques/T1082",tactics:"discovery",value:"systemInformationDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConfigurationDiscoveryDescription",{defaultMessage:"System Network Configuration Discovery (T1016)"}),id:"T1016",name:"System Network Configuration Discovery",reference:"https://attack.mitre.org/techniques/T1016",tactics:"discovery",value:"systemNetworkConfigurationDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConnectionsDiscoveryDescription",{defaultMessage:"System Network Connections Discovery (T1049)"}),id:"T1049",name:"System Network Connections Discovery",reference:"https://attack.mitre.org/techniques/T1049",tactics:"discovery",value:"systemNetworkConnectionsDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemOwnerUserDiscoveryDescription",{defaultMessage:"System Owner/User Discovery (T1033)"}),id:"T1033",name:"System Owner/User Discovery",reference:"https://attack.mitre.org/techniques/T1033",tactics:"discovery",value:"systemOwnerUserDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServiceDiscoveryDescription",{defaultMessage:"System Service Discovery (T1007)"}),id:"T1007",name:"System Service Discovery",reference:"https://attack.mitre.org/techniques/T1007",tactics:"discovery",value:"systemServiceDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemShutdownRebootDescription",{defaultMessage:"System Shutdown/Reboot (T1529)"}),id:"T1529",name:"System Shutdown/Reboot",reference:"https://attack.mitre.org/techniques/T1529",tactics:"impact",value:"systemShutdownReboot"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemTimeDiscoveryDescription",{defaultMessage:"System Time Discovery (T1124)"}),id:"T1124",name:"System Time Discovery",reference:"https://attack.mitre.org/techniques/T1124",tactics:"discovery",value:"systemTimeDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemdServiceDescription",{defaultMessage:"Systemd Service (T1501)"}),id:"T1501",name:"Systemd Service",reference:"https://attack.mitre.org/techniques/T1501",tactics:"persistence",value:"systemdService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.taintSharedContentDescription",{defaultMessage:"Taint Shared Content (T1080)"}),id:"T1080",name:"Taint Shared Content",reference:"https://attack.mitre.org/techniques/T1080",tactics:"lateral-movement",value:"taintSharedContent"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.templateInjectionDescription",{defaultMessage:"Template Injection (T1221)"}),id:"T1221",name:"Template Injection",reference:"https://attack.mitre.org/techniques/T1221",tactics:"defense-evasion",value:"templateInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.thirdPartySoftwareDescription",{defaultMessage:"Third-party Software (T1072)"}),id:"T1072",name:"Third-party Software",reference:"https://attack.mitre.org/techniques/T1072",tactics:"execution,lateral-movement",value:"thirdPartySoftware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.timeProvidersDescription",{defaultMessage:"Time Providers (T1209)"}),id:"T1209",name:"Time Providers",reference:"https://attack.mitre.org/techniques/T1209",tactics:"persistence",value:"timeProviders"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.timestompDescription",{defaultMessage:"Timestomp (T1099)"}),id:"T1099",name:"Timestomp",reference:"https://attack.mitre.org/techniques/T1099",tactics:"defense-evasion",value:"timestomp"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.transferDataToCloudAccountDescription",{defaultMessage:"Transfer Data to Cloud Account (T1537)"}),id:"T1537",name:"Transfer Data to Cloud Account",reference:"https://attack.mitre.org/techniques/T1537",tactics:"exfiltration",value:"transferDataToCloudAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.transmittedDataManipulationDescription",{defaultMessage:"Transmitted Data Manipulation (T1493)"}),id:"T1493",name:"Transmitted Data Manipulation",reference:"https://attack.mitre.org/techniques/T1493",tactics:"impact",value:"transmittedDataManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trapDescription",{defaultMessage:"Trap (T1154)"}),id:"T1154",name:"Trap",reference:"https://attack.mitre.org/techniques/T1154",tactics:"execution,persistence",value:"trap"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedDeveloperUtilitiesDescription",{defaultMessage:"Trusted Developer Utilities (T1127)"}),id:"T1127",name:"Trusted Developer Utilities",reference:"https://attack.mitre.org/techniques/T1127",tactics:"defense-evasion,execution",value:"trustedDeveloperUtilities"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedRelationshipDescription",{defaultMessage:"Trusted Relationship (T1199)"}),id:"T1199",name:"Trusted Relationship",reference:"https://attack.mitre.org/techniques/T1199",tactics:"initial-access",value:"trustedRelationship"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.twoFactorAuthenticationInterceptionDescription",{defaultMessage:"Two-Factor Authentication Interception (T1111)"}),id:"T1111",name:"Two-Factor Authentication Interception",reference:"https://attack.mitre.org/techniques/T1111",tactics:"credential-access",value:"twoFactorAuthenticationInterception"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.uncommonlyUsedPortDescription",{defaultMessage:"Uncommonly Used Port (T1065)"}),id:"T1065",name:"Uncommonly Used Port",reference:"https://attack.mitre.org/techniques/T1065",tactics:"command-and-control",value:"uncommonlyUsedPort"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unusedUnsupportedCloudRegionsDescription",{defaultMessage:"Unused/Unsupported Cloud Regions (T1535)"}),id:"T1535",name:"Unused/Unsupported Cloud Regions",reference:"https://attack.mitre.org/techniques/T1535",tactics:"defense-evasion",value:"unusedUnsupportedCloudRegions"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.userExecutionDescription",{defaultMessage:"User Execution (T1204)"}),id:"T1204",name:"User Execution",reference:"https://attack.mitre.org/techniques/T1204",tactics:"execution",value:"userExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.validAccountsDescription",{defaultMessage:"Valid Accounts (T1078)"}),id:"T1078",name:"Valid Accounts",reference:"https://attack.mitre.org/techniques/T1078",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",value:"validAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.videoCaptureDescription",{defaultMessage:"Video Capture (T1125)"}),id:"T1125",name:"Video Capture",reference:"https://attack.mitre.org/techniques/T1125",tactics:"collection",value:"videoCapture"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.virtualizationSandboxEvasionDescription",{defaultMessage:"Virtualization/Sandbox Evasion (T1497)"}),id:"T1497",name:"Virtualization/Sandbox Evasion",reference:"https://attack.mitre.org/techniques/T1497",tactics:"defense-evasion,discovery",value:"virtualizationSandboxEvasion"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.webServiceDescription",{defaultMessage:"Web Service (T1102)"}),id:"T1102",name:"Web Service",reference:"https://attack.mitre.org/techniques/T1102",tactics:"command-and-control,defense-evasion",value:"webService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.webSessionCookieDescription",{defaultMessage:"Web Session Cookie (T1506)"}),id:"T1506",name:"Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1506",tactics:"defense-evasion,lateral-movement",value:"webSessionCookie"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.webShellDescription",{defaultMessage:"Web Shell (T1100)"}),id:"T1100",name:"Web Shell",reference:"https://attack.mitre.org/techniques/T1100",tactics:"persistence,privilege-escalation",value:"webShell"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsAdminSharesDescription",{defaultMessage:"Windows Admin Shares (T1077)"}),id:"T1077",name:"Windows Admin Shares",reference:"https://attack.mitre.org/techniques/T1077",tactics:"lateral-movement",value:"windowsAdminShares"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsManagementInstrumentationDescription",{defaultMessage:"Windows Management Instrumentation (T1047)"}),id:"T1047",name:"Windows Management Instrumentation",reference:"https://attack.mitre.org/techniques/T1047",tactics:"execution",value:"windowsManagementInstrumentation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsManagementInstrumentationEventSubscriptionDescription",{defaultMessage:"Windows Management Instrumentation Event Subscription (T1084)"}),id:"T1084",name:"Windows Management Instrumentation Event Subscription",reference:"https://attack.mitre.org/techniques/T1084",tactics:"persistence",value:"windowsManagementInstrumentationEventSubscription"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsRemoteManagementDescription",{defaultMessage:"Windows Remote Management (T1028)"}),id:"T1028",name:"Windows Remote Management",reference:"https://attack.mitre.org/techniques/T1028",tactics:"execution,lateral-movement",value:"windowsRemoteManagement"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.winlogonHelperDllDescription",{defaultMessage:"Winlogon Helper DLL (T1004)"}),id:"T1004",name:"Winlogon Helper DLL",reference:"https://attack.mitre.org/techniques/T1004",tactics:"persistence",value:"winlogonHelperDll"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.xslScriptProcessingDescription",{defaultMessage:"XSL Script Processing (T1220)"}),id:"T1220",name:"XSL Script Processing",reference:"https://attack.mitre.org/techniques/T1220",tactics:"defense-evasion,execution",value:"xslScriptProcessing"}];const FILTERS_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"});const QUERY_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.QueryLabel",{defaultMessage:"Custom query"});const THREAT_QUERY_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"});const SAVED_ID_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"});const ML_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"});const EQL_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"});const QUERY_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"});const THRESHOLD_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"});const THREAT_MATCH_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"});const ML_JOB_STARTED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"});const ML_JOB_STOPPED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"});const THRESHOLD_RESULTS_ALL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"});const THRESHOLD_RESULTS_AGGREGATED_BY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"});const SeverityBadgeComponent=({value:value})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{"data-test-subj":"severity",color:value==="low"?external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis0:value==="medium"?external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis5:value==="high"?external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis7:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis9},Object(external_kbnSharedDeps_LodashFp_["upperFirst"])(value));const SeverityBadge=external_kbnSharedDeps_React_default.a.memo(SeverityBadgeComponent);var list_tree_icon=__webpack_require__(1008);var list_tree_icon_default=__webpack_require__.n(list_tree_icon);var empty_value=__webpack_require__(88);const NoteDescriptionContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-123zi2b-0"})(["height:105px;overflow-y:hidden;"]);const isNotEmptyArray=values=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(values.join(""));const EuiBadgeWrap=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBadge"]).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-123zi2b-1"})([".euiBadge__text{white-space:pre-wrap !important;}"]);const Query=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Query",componentId:"sc-123zi2b-2"})(["white-space:pre-wrap;"]);const buildQueryBarDescription=({field:field,filters:filters,filterManager:filterManager,query:query,savedId:savedId,indexPatterns:indexPatterns,queryLabel:queryLabel})=>{let items=[];if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(filters)){filterManager.setFilters(filters);items=[...items,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,FILTERS_LABEL," "),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true,responsive:false,gutterSize:"xs"},filterManager.getFilters().map((filter,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:"".concat(field,"-filter-").concat(index)},external_kbnSharedDeps_React_default.a.createElement(EuiBadgeWrap,{color:"hollow"},indexPatterns!=null?external_kbnSharedDeps_React_default.a.createElement(public_["esFilters"].FilterLabel,{filter:filter,valueLabel:public_["esFilters"].getDisplayValueFromFilter(filter,[indexPatterns])}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})))))}]}if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(query)){items=[...items,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,queryLabel!==null&&queryLabel!==void 0?queryLabel:QUERY_LABEL),description:external_kbnSharedDeps_React_default.a.createElement(Query,null,query)}]}if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(savedId)){items=[...items,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,SAVED_ID_LABEL," "),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,savedId," ")}]}return items};const ThreatEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"ThreatEuiFlexGroup",componentId:"sc-123zi2b-3"})([".euiFlexItem{margin-bottom:0px;}"]);const TechniqueLinkItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"]).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-123zi2b-4"})([".euiIcon{width:8px;height:8px;}"]);const buildThreatDescription=({label:label,threat:threat})=>{if(threat.length>0){return[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(ThreatEuiFlexGroup,{direction:"column"},threat.map((singleThreat,index)=>{const tactic=tacticsOptions.find(t=>t.id===singleThreat.tactic.id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:"".concat(singleThreat.tactic.name,"-").concat(index)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{"data-test-subj":"threatTacticLink",href:singleThreat.tactic.reference,target:"_blank"},tactic!=null?tactic.text:""),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",alignItems:"flexStart",direction:"column"},singleThreat.technique.map((technique,listIndex)=>{var _myTechnique$id;const myTechnique=techniquesOptions.find(t=>t.id===technique.id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:(_myTechnique$id=myTechnique===null||myTechnique===void 0?void 0:myTechnique.id)!==null&&_myTechnique$id!==void 0?_myTechnique$id:listIndex},external_kbnSharedDeps_React_default.a.createElement(TechniqueLinkItem,{"data-test-subj":"threatTechniqueLink",href:technique.reference,target:"_blank",iconType:list_tree_icon_default.a,size:"xs",flush:"left"},myTechnique!=null?myTechnique.label:""))})))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null))}]}return[]};const buildUnorderedListArrayDescription=(label,field,values)=>{if(isNotEmptyArray(values)){return[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("ul",null,values.map(val=>Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(val)?null:external_kbnSharedDeps_React_default.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:"".concat(field,"-").concat(val)},val))))}]}return[]};const buildStringArrayDescription=(label,field,values)=>{if(isNotEmptyArray(values)){return[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"xs",wrap:true},values.map(val=>Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(val)?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:"".concat(field,"-").concat(val)},external_kbnSharedDeps_React_default.a.createElement(EuiBadgeWrap,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},val))))}]}return[]};const OverrideColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"OverrideColumn",componentId:"sc-123zi2b-5"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]);const buildSeverityDescription=severity=>[{title:DEFAULT_SEVERITY,description:external_kbnSharedDeps_React_default.a.createElement(SeverityBadge,{value:severity.value})},...severity.isMappingChecked?severity.mapping.filter(severityItem=>severityItem.field!=="").map((severityItem,index)=>({title:index===0?SEVERITY_MAPPING:"",description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(OverrideColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:severityItem.field,"data-test-subj":"severityOverrideField".concat(index)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,"".concat(severityItem.field,":")))),external_kbnSharedDeps_React_default.a.createElement(OverrideColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:severityItem.value,"data-test-subj":"severityOverrideValue".concat(index)},Object(empty_value["a"])(severityItem.value))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(SeverityBadge,{"data-test-subj":"severityOverrideSeverity".concat(index),value:severityItem.severity})))})):[]];const buildRiskScoreDescription=riskScore=>[{title:RISK_SCORE,description:riskScore.value},...riskScore.isMappingChecked?riskScore.mapping.filter(riskScoreItem=>riskScoreItem.field!=="").map((riskScoreItem,index)=>({title:index===0?RISK_SCORE_MAPPING:"",description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(OverrideColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:riskScoreItem.field,"data-test-subj":"riskScoreOverrideField".concat(index)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,riskScoreItem.field))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,"signal.rule.risk_score"))})):[]];const MyRefUrlLink=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLink"]).withConfig({displayName:"MyRefUrlLink",componentId:"sc-123zi2b-6"})(["word-break:break-word;"]);const buildUrlsDescription=(label,values)=>{if(isNotEmptyArray(values)){return[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("ul",null,values.filter(v=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(v)).map((val,index)=>external_kbnSharedDeps_React_default.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:"".concat(index,"-").concat(val)},external_kbnSharedDeps_React_default.a.createElement(MyRefUrlLink,{href:val,external:true,target:"_blank"},val)))))}]}return[]};const buildNoteDescription=(label,note)=>{if(note.trim()!==""){return[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(NoteDescriptionContainer,null,external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},note))}]}return[]};const buildRuleTypeDescription=(label,ruleType)=>{switch(ruleType){case"machine_learning":{return[{title:label,description:ML_TYPE_DESCRIPTION}]}case"query":case"saved_query":{return[{title:label,description:QUERY_TYPE_DESCRIPTION}]}case"threshold":{return[{title:label,description:THRESHOLD_TYPE_DESCRIPTION}]}case"eql":{return[{title:label,description:EQL_TYPE_DESCRIPTION}]}case"threat_match":{return[{title:label,description:THREAT_MATCH_TYPE_DESCRIPTION}]}default:return Object(utility_types["a"])(ruleType)}};const buildThresholdDescription=(label,threshold)=>[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(threshold.field[0])?"".concat(THRESHOLD_RESULTS_ALL," >= ").concat(threshold.value):"".concat(THRESHOLD_RESULTS_AGGREGATED_BY," ").concat(threshold.field[0]," >= ").concat(threshold.value))}];const buildThreatMappingDescription=(title,threatMapping)=>{const description=threatMapping.reduce((accumThreatMaps,threatMap,threatMapIndex,{length:threatMappingLength})=>{const matches=threatMap.entries.reduce((accumItems,item,itemsIndex,{length:threatMapLength})=>{if(threatMapLength===1){return"".concat(item.field," ").concat(MATCHES," ").concat(item.value)}else if(itemsIndex===0){return"(".concat(item.field," ").concat(MATCHES," ").concat(item.value,")")}else{return"".concat(accumItems," ").concat(AND," (").concat(item.field," ").concat(MATCHES," ").concat(item.value,")")}},"");if(threatMappingLength===1){return"".concat(matches)}else if(threatMapIndex===0){return"(".concat(matches,")")}else{return"".concat(accumThreatMaps," ").concat(OR," (").concat(matches,")")}},"");return[{title:title,description:description}]};var ml_public_=__webpack_require__(69);var use_security_jobs=__webpack_require__(445);var MessageLevels;(function(MessageLevels){MessageLevels["info"]="info";MessageLevels["warning"]="warning";MessageLevels["error"]="error"})(MessageLevels||(MessageLevels={}));const AuditIconComponent=({message:message})=>{if(!message){return null}let color="primary";let icon="alert";if(message.level===MessageLevels.info){icon="iInCircle"}else if(message.level===MessageLevels.warning){color="warning"}else if(message.level===MessageLevels.error){color="danger"}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:message.text},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:icon,color:color}))};const AuditIcon=external_kbnSharedDeps_React_default.a.memo(AuditIconComponent);const JobStatusBadgeComponent=({job:job})=>{const isStarted=Object(helpers["c"])(job.jobState,job.datafeedState);const color=isStarted?"secondary":"danger";const text=isStarted?ML_JOB_STARTED:ML_JOB_STOPPED;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{"data-test-subj":"machineLearningJobStatus",color:color},text)};const JobStatusBadge=external_kbnSharedDeps_React_default.a.memo(JobStatusBadgeComponent);const JobLink=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLink"]).withConfig({displayName:"JobLink",componentId:"c3w1h4-0"})(["margin-right:",";"],({theme:theme})=>theme.eui.euiSizeS);const Wrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Wrapper",componentId:"c3w1h4-1"})(["overflow:hidden;"]);const MlJobDescriptionComponent=({jobId:jobId})=>{const _useSecurityJobs=Object(use_security_jobs["a"])(false),jobs=_useSecurityJobs.jobs;const _useKibana=Object(lib_kibana["h"])(),_useKibana$services=_useKibana.services,http=_useKibana$services.http,ml=_useKibana$services.ml;const jobUrl=Object(ml_public_["useMlHref"])(ml,http.basePath.get(),{page:ml_public_["ML_PAGES"].ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[jobId]}});const job=jobs.find(({id:id})=>id===jobId);const jobIdSpan=external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"machineLearningJobId"},jobId);return job!=null?external_kbnSharedDeps_React_default.a.createElement(Wrapper,null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(JobLink,{href:jobUrl,target:"_blank"},jobIdSpan),external_kbnSharedDeps_React_default.a.createElement(AuditIcon,{message:job.auditMessage})),external_kbnSharedDeps_React_default.a.createElement(JobStatusBadge,{job:job})):jobIdSpan};const MlJobDescription=external_kbnSharedDeps_React_default.a.memo(MlJobDescriptionComponent);const buildMlJobDescription=(jobId,label)=>({title:label,description:external_kbnSharedDeps_React_default.a.createElement(MlJobDescription,{jobId:jobId})});const ActionsDescription=({actions:actions})=>{if(!actions.length)return null;return external_kbnSharedDeps_React_default.a.createElement("ul",null,actions.map((action,index)=>external_kbnSharedDeps_React_default.a.createElement("li",{key:index},getActionTypeName(action.actionTypeId))))};const buildActionsDescription=(actions,title)=>({title:actions.length?title:"",description:external_kbnSharedDeps_React_default.a.createElement(ActionsDescription,{actions:actions})});const getActionTypeName=actionTypeId=>{if(!actionTypeId)return"";const actionType=actionTypeId.split(".")[1];if(!actionType)return"";return Object(external_kbnSharedDeps_LodashFp_["startCase"])(actionType)};function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function throttle_select_field_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function throttle_select_field_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){throttle_select_field_ownKeys(Object(source),true).forEach((function(key){throttle_select_field_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{throttle_select_field_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function throttle_select_field_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const THROTTLE_OPTIONS=[{value:constants["X"],text:"Perform no actions"},{value:constants["Y"],text:"On each rule execution"},{value:"1h",text:"Hourly"},{value:"1d",text:"Daily"},{value:"7d",text:"Weekly"}];const DEFAULT_THROTTLE_OPTION=THROTTLE_OPTIONS[0];const ThrottleSelectField=props=>{const setValue=props.field.setValue;const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const throttle=e.target.value;setValue(throttle)},[setValue]);const newEuiFieldProps=throttle_select_field_objectSpread(throttle_select_field_objectSpread({},props.euiFieldProps),{},{onChange:onChange});return external_kbnSharedDeps_React_default.a.createElement(shared_imports["i"],_extends({},props,{euiFieldProps:newEuiFieldProps}))};const buildThrottleDescription=(value=DEFAULT_THROTTLE_OPTION.value,title)=>{const throttleOption=Object(external_kbnSharedDeps_LodashFp_["find"])(["value",value],THROTTLE_OPTIONS);return{title:title,description:throttleOption?throttleOption.text:value}};function description_step_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function description_step_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){description_step_ownKeys(Object(source),true).forEach((function(key){description_step_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{description_step_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function description_step_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function description_step_slicedToArray(arr,i){return description_step_arrayWithHoles(arr)||description_step_iterableToArrayLimit(arr,i)||description_step_unsupportedIterableToArray(arr,i)||description_step_nonIterableRest()}function description_step_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function description_step_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return description_step_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return description_step_arrayLikeToArray(o,minLen)}function description_step_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function description_step_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function description_step_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const DescriptionListContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"]).withConfig({displayName:"DescriptionListContainer",componentId:"sc-1jqwta0-0"})(["&.euiDescriptionList--column .euiDescriptionList__title{width:30%;}&.euiDescriptionList--column .euiDescriptionList__description{width:70%;}"]);const StepRuleDescriptionComponent=({data:data,columns:columns="multi",indexPatterns:indexPatterns,schema:schema})=>{const kibana=Object(lib_kibana["h"])();const _useState=Object(external_kbnSharedDeps_React_["useState"])(new public_["FilterManager"](kibana.services.uiSettings)),_useState2=description_step_slicedToArray(_useState,1),filterManager=_useState2[0];const keys=Object.keys(schema);const listItems=keys.reduce((acc,key)=>{if(key==="machineLearningJobId"){return[...acc,buildMlJobDescription(Object(external_kbnSharedDeps_LodashFp_["get"])(key,data),Object(external_kbnSharedDeps_LodashFp_["get"])(key,schema).label)]}if(key==="throttle"){return[...acc,buildThrottleDescription(Object(external_kbnSharedDeps_LodashFp_["get"])(key,data),Object(external_kbnSharedDeps_LodashFp_["get"])([key,"label"],schema))]}if(key==="actions"){return[...acc,buildActionsDescription(Object(external_kbnSharedDeps_LodashFp_["get"])(key,data),Object(external_kbnSharedDeps_LodashFp_["get"])([key,"label"],schema))]}return[...acc,...buildListItems(data,Object(external_kbnSharedDeps_LodashFp_["pick"])(key,schema),filterManager,indexPatterns)]},[]);if(columns==="multi"){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,Object(external_kbnSharedDeps_LodashFp_["chunk"])(Math.ceil(listItems.length/2),listItems).map((chunkListItems,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"listItemColumnStepRuleDescription",key:"description-step-rule-".concat(index)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{listItems:chunkListItems}))))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"listItemColumnStepRuleDescription"},columns==="single"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{listItems:listItems}):external_kbnSharedDeps_React_default.a.createElement(DescriptionListContainer,{"data-test-subj":"singleSplitStepRuleDescriptionList",type:"column",listItems:listItems})))};const StepRuleDescription=Object(external_kbnSharedDeps_React_["memo"])(StepRuleDescriptionComponent);const buildListItems=(data,schema,filterManager,indexPatterns)=>Object.keys(schema).reduce((acc,field)=>[...acc,...getDescriptionItem(field,Object(external_kbnSharedDeps_LodashFp_["get"])([field,"label"],schema),data,filterManager,indexPatterns)],[]);const addFilterStateIfNotThere=filters=>filters.map(filter=>{if(filter.$state==null){return description_step_objectSpread({$state:{store:public_["esFilters"].FilterStateStore.APP_STATE}},filter)}else{return filter}});const getDescriptionItem=(field,label,data,filterManager,indexPatterns)=>{if(field==="queryBar"){var _get;const filters=addFilterStateIfNotThere((_get=Object(external_kbnSharedDeps_LodashFp_["get"])("queryBar.filters",data))!==null&&_get!==void 0?_get:[]);const query=Object(external_kbnSharedDeps_LodashFp_["get"])("queryBar.query.query",data);const savedId=Object(external_kbnSharedDeps_LodashFp_["get"])("queryBar.saved_id",data);return buildQueryBarDescription({field:field,filters:filters,filterManager:filterManager,query:query,savedId:savedId,indexPatterns:indexPatterns})}else if(field==="threat"){const threat=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data).filter(singleThreat=>singleThreat.tactic.name!=="none");return buildThreatDescription({label:label,threat:threat})}else if(field==="threshold"){const threshold=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildThresholdDescription(label,threshold)}else if(field==="references"){const urls=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildUrlsDescription(label,urls)}else if(field==="falsePositives"){const values=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildUnorderedListArrayDescription(label,field,values)}else if(Array.isArray(Object(external_kbnSharedDeps_LodashFp_["get"])(field,data))&&field!=="threatMapping"){const values=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildStringArrayDescription(label,field,values)}else if(field==="riskScore"){const values=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildRiskScoreDescription(values)}else if(field==="severity"){const values=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildSeverityDescription(values)}else if(field==="timeline"){var _timeline$title;const timeline=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return[{title:label,description:(_timeline$title=timeline.title)!==null&&_timeline$title!==void 0?_timeline$title:timeline_translations["b"]}]}else if(field==="note"){const val=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildNoteDescription(label,val)}else if(field==="ruleType"){const ruleType=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildRuleTypeDescription(label,ruleType)}else if(field==="kibanaSiemAppUrl"){return[]}else if(field==="threatQueryBar"){var _get2;const filters=addFilterStateIfNotThere((_get2=Object(external_kbnSharedDeps_LodashFp_["get"])("threatQueryBar.filters",data))!==null&&_get2!==void 0?_get2:[]);const query=Object(external_kbnSharedDeps_LodashFp_["get"])("threatQueryBar.query.query",data);const savedId=Object(external_kbnSharedDeps_LodashFp_["get"])("threatQueryBar.saved_id",data);return buildQueryBarDescription({field:field,filters:filters,filterManager:filterManager,query:query,savedId:savedId,indexPatterns:indexPatterns,queryLabel:THREAT_QUERY_LABEL})}else if(field==="threatMapping"){const threatMap=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildThreatMappingDescription(label,threatMap)}const description=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);if(Object(external_kbnSharedDeps_LodashFp_["isNumber"])(description)||!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(description)){return[{title:label,description:description}]}return[]};var external_kbnSharedDeps_Rxjs_=__webpack_require__(27);var fast_deep_equal=__webpack_require__(83);var fast_deep_equal_default=__webpack_require__.n(fast_deep_equal);var open_timeline_modal=__webpack_require__(576);var query_bar=__webpack_require__(637);var timeline_helpers=__webpack_require__(104);var timeline_query_bar=__webpack_require__(635);var keury=__webpack_require__(119);var saved_query_services=__webpack_require__(636);const IMPORT_TIMELINE_MODAL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineModalTitle",{defaultMessage:"Import query from saved timeline"});function query_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function query_bar_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){query_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){query_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function query_bar_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function query_bar_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){query_bar_ownKeys(Object(source),true).forEach((function(key){query_bar_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{query_bar_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function query_bar_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function query_bar_slicedToArray(arr,i){return query_bar_arrayWithHoles(arr)||query_bar_iterableToArrayLimit(arr,i)||query_bar_unsupportedIterableToArray(arr,i)||query_bar_nonIterableRest()}function query_bar_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function query_bar_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return query_bar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return query_bar_arrayLikeToArray(o,minLen)}function query_bar_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function query_bar_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function query_bar_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const StyledEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-8c6vgp-0"})([".kbnTypeahead__items{max-height:45vh !important;}.globalQueryBar{padding:4px 0px 0px 0px;.kbnQueryBar{& > div:first-child{margin:0px 0px 0px 4px;}}}"]);const QueryBarDefineRule=({browserFields:browserFields,dataTestSubj:dataTestSubj,field:field,idAria:idAria,indexPattern:indexPattern,isLoading:isLoading=false,onCloseTimelineSearch:onCloseTimelineSearch,openTimelineSearch:openTimelineSearch=false,resizeParentContainer:resizeParentContainer,onValidityChange:onValidityChange})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(-1),_useState2=query_bar_slicedToArray(_useState,2),originalHeight=_useState2[0],setOriginalHeight=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=query_bar_slicedToArray(_useState3,2),loadingTimeline=_useState4[0],setLoadingTimeline=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(null),_useState6=query_bar_slicedToArray(_useState5,2),savedQuery=_useState6[0],setSavedQuery=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])({query:"",language:"kuery"}),_useState8=query_bar_slicedToArray(_useState7,2),queryDraft=_useState8[0],setQueryDraft=_useState8[1];const _getFieldValidityAndE=Object(shared_imports["x"])(field),isInvalid=_getFieldValidityAndE.isInvalid,errorMessage=_getFieldValidityAndE.errorMessage;const kibana=Object(lib_kibana["h"])();const _useState9=Object(external_kbnSharedDeps_React_["useState"])(new public_["FilterManager"](kibana.services.uiSettings)),_useState10=query_bar_slicedToArray(_useState9,1),filterManager=_useState10[0];const savedQueryServices=Object(saved_query_services["a"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(onValidityChange!=null){onValidityChange(!isInvalid)}},[isInvalid,onValidityChange]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const subscriptions=new external_kbnSharedDeps_Rxjs_["Subscription"];filterManager.setFilters([]);subscriptions.add(filterManager.getUpdates$().subscribe({next:()=>{if(isSubscribed){const newFilters=filterManager.getFilters();const _ref=field.value,filters=_ref.filters;if(!fast_deep_equal_default()(filters,newFilters)){field.setValue(query_bar_objectSpread(query_bar_objectSpread({},field.value),{},{filters:newFilters}))}}}}));return()=>{isSubscribed=false;subscriptions.unsubscribe()}},[field.value]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;function updateFilterQueryFromValue(){return _updateFilterQueryFromValue.apply(this,arguments)}function _updateFilterQueryFromValue(){_updateFilterQueryFromValue=query_bar_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _ref2,filters,query,savedId,mySavedQuery;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_ref2=field.value,filters=_ref2.filters,query=_ref2.query,savedId=_ref2.saved_id;if(!fast_deep_equal_default()(query,queryDraft)){setQueryDraft(query)}if(!fast_deep_equal_default()(filters,filterManager.getFilters())){filterManager.setFilters(filters)}if(!(savedId!=null&&savedQuery!=null&&savedId!==savedQuery.id||savedId!=null&&savedQuery==null)){_context.next=16;break}_context.prev=4;_context.next=7;return savedQueryServices.getSavedQuery(savedId);case 7:mySavedQuery=_context.sent;if(isSubscribed&&mySavedQuery!=null){setSavedQuery(mySavedQuery)}_context.next=14;break;case 11:_context.prev=11;_context.t0=_context["catch"](4);setSavedQuery(null);case 14:_context.next=17;break;case 16:if(savedId==null&&savedQuery!=null){setSavedQuery(null)}case 17:case"end":return _context.stop()}}),_callee,null,[[4,11]])})));return _updateFilterQueryFromValue.apply(this,arguments)}updateFilterQueryFromValue();return()=>{isSubscribed=false}},[field.value]);const onSubmitQuery=Object(external_kbnSharedDeps_React_["useCallback"])(newQuery=>{const _ref3=field.value,query=_ref3.query;if(!fast_deep_equal_default()(query,newQuery)){field.setValue(query_bar_objectSpread(query_bar_objectSpread({},field.value),{},{query:newQuery}))}},[field]);const onChangedQuery=Object(external_kbnSharedDeps_React_["useCallback"])(newQuery=>{const _ref4=field.value,query=_ref4.query;if(!fast_deep_equal_default()(query,newQuery)){field.setValue(query_bar_objectSpread(query_bar_objectSpread({},field.value),{},{query:newQuery}))}},[field]);const onSavedQuery=Object(external_kbnSharedDeps_React_["useCallback"])(newSavedQuery=>{if(newSavedQuery!=null){const _ref5=field.value,savedId=_ref5.saved_id;if(newSavedQuery.id!==savedId){setSavedQuery(newSavedQuery);field.setValue({filters:newSavedQuery.attributes.filters,query:newSavedQuery.attributes.query,saved_id:newSavedQuery.id})}}},[field.value]);const onCloseTimelineModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setLoadingTimeline(true);onCloseTimelineSearch()},[onCloseTimelineSearch]);const onOpenTimeline=Object(external_kbnSharedDeps_React_["useCallback"])(timeline=>{var _timeline$kqlQuery$fi,_timeline$kqlQuery$fi2,_timeline$kqlQuery$fi3,_timeline$kqlQuery$fi4,_timeline$kqlQuery$fi5,_timeline$kqlQuery$fi6,_timeline$filters;setLoadingTimeline(false);const newQuery={query:(_timeline$kqlQuery$fi=(_timeline$kqlQuery$fi2=timeline.kqlQuery.filterQuery)===null||_timeline$kqlQuery$fi2===void 0?void 0:(_timeline$kqlQuery$fi3=_timeline$kqlQuery$fi2.kuery)===null||_timeline$kqlQuery$fi3===void 0?void 0:_timeline$kqlQuery$fi3.expression)!==null&&_timeline$kqlQuery$fi!==void 0?_timeline$kqlQuery$fi:"",language:(_timeline$kqlQuery$fi4=(_timeline$kqlQuery$fi5=timeline.kqlQuery.filterQuery)===null||_timeline$kqlQuery$fi5===void 0?void 0:(_timeline$kqlQuery$fi6=_timeline$kqlQuery$fi5.kuery)===null||_timeline$kqlQuery$fi6===void 0?void 0:_timeline$kqlQuery$fi6.kind)!==null&&_timeline$kqlQuery$fi4!==void 0?_timeline$kqlQuery$fi4:"kuery"};const dataProvidersDsl=timeline.dataProviders!=null&&timeline.dataProviders.length>0?Object(keury["a"])(Object(timeline_helpers["c"])(timeline.dataProviders,browserFields),indexPattern):"";const newFilters=(_timeline$filters=timeline.filters)!==null&&_timeline$filters!==void 0?_timeline$filters:[];field.setValue({filters:dataProvidersDsl!==""?[...newFilters,Object(timeline_query_bar["b"])(dataProvidersDsl)]:newFilters,query:newQuery,saved_id:undefined})},[browserFields,field,indexPattern]);const onMutation=()=>{if(resizeParentContainer!=null){const suggestionContainer=document.getElementById("kbnTypeahead__items");if(suggestionContainer!=null){const box=suggestionContainer.getBoundingClientRect();const accordionContainer=document.getElementById("define-rule");if(accordionContainer!=null){const accordionBox=accordionContainer.getBoundingClientRect();if(originalHeight===-1||accordionBox.height<originalHeight+box.height){resizeParentContainer(originalHeight+box.height-100)}if(originalHeight===-1){setOriginalHeight(accordionBox.height)}}}else{resizeParentContainer(-1)}}};const actionTimelineToHide=Object(external_kbnSharedDeps_React_["useMemo"])(()=>["duplicate"],[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StyledEuiFormRow,{label:field.label,labelAppend:field.labelAppend,helpText:field.helpText,error:errorMessage,isInvalid:isInvalid,fullWidth:true,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiMutationObserver"],{observerOptions:{subtree:true,attributes:true,childList:true},onMutation:onMutation},mutationRef=>external_kbnSharedDeps_React_default.a.createElement("div",{ref:mutationRef},external_kbnSharedDeps_React_default.a.createElement(query_bar["a"],{indexPattern:indexPattern,isLoading:isLoading||loadingTimeline,isRefreshPaused:false,filterQuery:queryDraft,filterManager:filterManager,filters:filterManager.getFilters()||[],onChangedQuery:onChangedQuery,onSubmitQuery:onSubmitQuery,savedQuery:savedQuery,onSavedQuery:onSavedQuery,hideSavedQuery:false})))),openTimelineSearch?external_kbnSharedDeps_React_default.a.createElement(open_timeline_modal["a"],{hideActions:actionTimelineToHide,modalTitle:IMPORT_TIMELINE_MODAL,onClose:onCloseTimelineModal,onOpen:onOpenTimeline}):null)};var utils=__webpack_require__(143);const EQL_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeTitle",{defaultMessage:"Event Correlation"});const translations_EQL_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeDescription",{defaultMessage:"Use Event Query Language (EQL) to match events, generate sequences, and stack data"});const QUERY_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeTitle",{defaultMessage:"Custom query"});const translations_QUERY_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeDescription",{defaultMessage:"Use KQL or Lucene to detect issues across indices."});const ML_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeTitle",{defaultMessage:"Machine Learning"});const translations_ML_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDescription",{defaultMessage:"Select ML job to detect anomalous activity."});const THRESHOLD_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeTitle",{defaultMessage:"Threshold"});const translations_THRESHOLD_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeDescription",{defaultMessage:"Aggregate query results to detect when number of matches exceeds threshold."});const THREAT_MATCH_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchTitle",{defaultMessage:"Indicator Match"});const translations_THREAT_MATCH_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchDescription",{defaultMessage:"Use indicators from intelligence sources to detect matching events and alerts."});var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(54);const SmallText=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"SmallText",componentId:"lss4m0-0"})(["font-size:",";"],({theme:theme})=>theme.eui.euiFontSizeS);const MlCardDescriptionComponent=({subscriptionUrl:subscriptionUrl,hasValidLicense:hasValidLicense=false})=>external_kbnSharedDeps_React_default.a.createElement(SmallText,null,hasValidLicense?translations_ML_TYPE_DESCRIPTION:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDisabledDescription",defaultMessage:"Access to ML requires a {subscriptionsLink}.",values:{subscriptionsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:subscriptionUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.components.stepDefineRule.ruleTypeField.subscriptionsLink",defaultMessage:"Platinum subscription"}))}}));MlCardDescriptionComponent.displayName="MlCardDescriptionComponent";const MlCardDescription=external_kbnSharedDeps_React_default.a.memo(MlCardDescriptionComponent);MlCardDescription.displayName="MlCardDescription";var eql_search_icon=__webpack_require__(1009);var eql_search_icon_default=__webpack_require__.n(eql_search_icon);const SelectRuleType=({describedByIds:describedByIds=[],field:field,isUpdateView:isUpdateView,hasValidLicense:hasValidLicense,isMlAdmin:isMlAdmin})=>{const ruleType=field.value;const setType=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{field.setValue(type)},[field]);const setEql=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setType("eql"),[setType]);const setMl=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setType("machine_learning"),[setType]);const setQuery=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setType("query"),[setType]);const setThreshold=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setType("threshold"),[setType]);const setThreatMatch=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setType("threat_match"),[setType]);const licensingUrl=Object(lib_kibana["h"])().services.application.getUrlForApp("kibana",{path:"#/management/stack/license_management"});const eqlSelectableConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({onClick:setEql,isSelected:Object(utils["c"])(ruleType)}),[ruleType,setEql]);const querySelectableConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({onClick:setQuery,isSelected:Object(utils["d"])(ruleType)}),[ruleType,setQuery]);const mlSelectableConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({isDisabled:!hasValidLicense||!isMlAdmin,onClick:setMl,isSelected:Object(helpers["d"])(ruleType)}),[ruleType,setMl,hasValidLicense,isMlAdmin]);const thresholdSelectableConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({onClick:setThreshold,isSelected:Object(utils["f"])(ruleType)}),[ruleType,setThreshold]);const threatMatchSelectableConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({onClick:setThreatMatch,isSelected:Object(utils["e"])(ruleType)}),[ruleType,setThreatMatch]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,"data-test-subj":"selectRuleType",describedByIds:describedByIds,label:field.label},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGrid"],{columns:3},(!isUpdateView||querySelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"customRuleType",title:QUERY_TYPE_TITLE,titleSize:"xs",description:translations_QUERY_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"xl",type:"search"}),selectable:querySelectableConfig,layout:"horizontal",textAlign:"left"})),(!isUpdateView||mlSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"machineLearningRuleType",title:ML_TYPE_TITLE,titleSize:"xs",description:external_kbnSharedDeps_React_default.a.createElement(MlCardDescription,{subscriptionUrl:licensingUrl,hasValidLicense:hasValidLicense}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"l",type:"machineLearningApp"}),isDisabled:mlSelectableConfig.isDisabled&&!mlSelectableConfig.isSelected,selectable:mlSelectableConfig,layout:"horizontal",textAlign:"left"})),(!isUpdateView||thresholdSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"thresholdRuleType",title:THRESHOLD_TYPE_TITLE,titleSize:"xs",description:translations_THRESHOLD_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"l",type:"indexFlush"}),selectable:thresholdSelectableConfig,layout:"horizontal",textAlign:"left"})),(!isUpdateView||eqlSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"eqlRuleType",title:EQL_TYPE_TITLE,titleSize:"xs",description:translations_EQL_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"l",type:eql_search_icon_default.a}),selectable:eqlSelectableConfig,layout:"horizontal",textAlign:"left"})),(!isUpdateView||threatMatchSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"threatMatchRuleType",title:THREAT_MATCH_TYPE_TITLE,titleSize:"xs",description:translations_THREAT_MATCH_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"l",type:"list"}),selectable:threatMatchSelectableConfig,layout:"horizontal",textAlign:"left"}))))};const AnomalyThresholdSlider=({describedByIds:describedByIds=[],field:field})=>{const threshold=field.value;const onThresholdChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{const thresholdValue=Number(event.target.value);field.setValue(thresholdValue)},[field]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:field.label,"data-test-subj":"anomalyThresholdSlider",describedByIds:describedByIds},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRange"],{value:threshold,onChange:onThresholdChange,fullWidth:true,showInput:true,showRange:true,showTicks:true,tickInterval:25}))))};const CUSTOM_QUERY_REQUIRED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."});const INVALID_CUSTOM_QUERY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"});const CONFIG_INDICES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesFromConfigDescription",{defaultMessage:"Use Elasticsearch indices from Security Solution advanced settings"});const CUSTOM_INDICES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesCustomDescription",{defaultMessage:"Provide custom list of indices"});const INDEX_HELPER_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."});const RESET_DEFAULT_INDEX=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"});const IMPORT_TIMELINE_QUERY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"});const ML_JOB_SELECT_PLACEHOLDER_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlJobSelectPlaceholderText",{defaultMessage:"Select a job"});const ENABLE_ML_JOB_WARNING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobWarningTitle",{defaultMessage:'This ML job is not currently running. Please set this job to run via "ML job settings" before activating this rule.'});const QUERY_BAR_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"});const EQL_QUERY_BAR_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"});const THREAT_MATCH_INDEX_HELPER_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"});const THREAT_MATCH_REQUIRED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."});const THREAT_MATCH_EMPTIES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."});const HelpTextWarningContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HelpTextWarningContainer",componentId:"sc-1kiq2lp-0"})(["margin-top:10px;"]);const MlJobSelectEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MlJobSelectEuiFlexGroup",componentId:"sc-1kiq2lp-1"})(["margin-bottom:5px;"]);const HelpText=({href:href,showEnableWarning:showEnableWarning=false})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdHelpText",defaultMessage:"We've provided a few common jobs to get you started. To add your own custom jobs, assign a group of “security” to those jobs in the {machineLearning} application to make them appear here.",values:{machineLearning:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:href,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.components.mlJobSelect.machineLearningLink",defaultMessage:"Machine Learning"}))}}),showEnableWarning&&external_kbnSharedDeps_React_default.a.createElement(HelpTextWarningContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert"}),external_kbnSharedDeps_React_default.a.createElement("span",null,ENABLE_ML_JOB_WARNING))));const JobDisplay=({title:title,description:description})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("strong",null,title),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,description)));const MlJobSelect=({describedByIds:describedByIds=[],field:field})=>{const jobId=field.value;const _getFieldValidityAndE=Object(shared_imports["x"])(field),isInvalid=_getFieldValidityAndE.isInvalid,errorMessage=_getFieldValidityAndE.errorMessage;const _useSecurityJobs=Object(use_security_jobs["a"])(false),loading=_useSecurityJobs.loading,jobs=_useSecurityJobs.jobs;const mlUrl=Object(lib_kibana["h"])().services.application.getUrlForApp("ml");const handleJobChange=Object(external_kbnSharedDeps_React_["useCallback"])(machineLearningJobId=>{field.setValue(machineLearningJobId)},[field]);const placeholderOption={value:"placeholder",inputDisplay:ML_JOB_SELECT_PLACEHOLDER_TEXT,dropdownDisplay:ML_JOB_SELECT_PLACEHOLDER_TEXT,disabled:true};const jobOptions=jobs.map(job=>({value:job.id,inputDisplay:job.id,dropdownDisplay:external_kbnSharedDeps_React_default.a.createElement(JobDisplay,{title:job.id,description:job.description})}));const options=[placeholderOption,...jobOptions];const isJobRunning=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const job=jobs.find(({id:id})=>id===jobId);return job==null||Object(helpers["c"])(job.jobState,job.datafeedState)},[jobs,jobId]);return external_kbnSharedDeps_React_default.a.createElement(MlJobSelectEuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:field.label,helpText:external_kbnSharedDeps_React_default.a.createElement(HelpText,{href:mlUrl,showEnableWarning:!isJobRunning}),isInvalid:isInvalid,error:errorMessage,"data-test-subj":"mlJobSelect",describedByIds:describedByIds},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{hasDividers:true,isLoading:loading,onChange:handleJobChange,options:options,valueOfSelected:jobId||"placeholder"}))))))};var selectable_timeline=__webpack_require__(556);function search_super_select_slicedToArray(arr,i){return search_super_select_arrayWithHoles(arr)||search_super_select_iterableToArrayLimit(arr,i)||search_super_select_unsupportedIterableToArray(arr,i)||search_super_select_nonIterableRest()}function search_super_select_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function search_super_select_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return search_super_select_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return search_super_select_arrayLikeToArray(o,minLen)}function search_super_select_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function search_super_select_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function search_super_select_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const StyledEuiFieldText=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFieldText"]).withConfig({displayName:"StyledEuiFieldText",componentId:"oqcycb-0"})(["padding-left:12px;padding-right:40px;&[readonly]{cursor:pointer;background-size:0 100%;background-repeat:no-repeat;&:focus{background-color:#fff;background-image:linear-gradient( to top,#006bb4,#006bb4 2px,transparent 2px,transparent 100% );background-size:100% 100%;}}& + .euiFormControlLayoutIcons{left:unset;right:12px;}"]);const getBasicSelectableOptions=timelineId=>[{description:timeline_translations["a"],favorite:[],label:timeline_translations["b"],id:undefined,title:timeline_translations["b"],checked:timelineId==="-1"?"on":undefined}];const SearchTimelineSuperSelectComponent=({isDisabled:isDisabled,hideUntitled:hideUntitled=false,timelineId:timelineId,timelineTitle:timelineTitle,timelineType:timelineType=types_timeline["h"].template,onTimelineChange:onTimelineChange})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=search_super_select_slicedToArray(_useState,2),isPopoverOpen=_useState2[0],setIsPopoverOpen=_useState2[1];const handleClosePopover=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsPopoverOpen(false)},[]);const handleOpenPopover=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsPopoverOpen(true)},[]);const superSelect=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(StyledEuiFieldText,{readOnly:true,disabled:isDisabled,onFocus:handleOpenPopover,value:timelineTitle!==null&&timelineTitle!==void 0?timelineTitle:timeline_translations["b"],icon:"arrowDown"}),[handleOpenPopover,isDisabled,timelineTitle]);const handleGetSelectableOptions=Object(external_kbnSharedDeps_React_["useCallback"])(({timelines:timelines,onlyFavorites:onlyFavorites,searchTimelineValue:searchTimelineValue})=>[...!onlyFavorites&&searchTimelineValue===""?getBasicSelectableOptions(timelineId==null?"-1":timelineId):[],...timelines.filter(t=>!hideUntitled||t.title!=="").map((t,index)=>({description:t.description,favorite:t.favorite,label:t.title,id:timelineType===types_timeline["h"].template?t.templateTimelineId:t.savedObjectId,key:"".concat(t.title,"-").concat(index),title:t.title,checked:[t.savedObjectId,t.templateTimelineId].includes(timelineId)?"on":undefined}))],[hideUntitled,timelineId,timelineType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiInputPopover"],{id:"searchTimelinePopover",input:superSelect,isOpen:isPopoverOpen,closePopover:handleClosePopover},external_kbnSharedDeps_React_default.a.createElement(selectable_timeline["a"],{hideUntitled:hideUntitled,getSelectableOptions:handleGetSelectableOptions,onClosePopover:handleClosePopover,onTimelineChange:onTimelineChange,timelineType:timelineType}))};const SearchTimelineSuperSelect=Object(external_kbnSharedDeps_React_["memo"])(SearchTimelineSuperSelectComponent);function pick_timeline_slicedToArray(arr,i){return pick_timeline_arrayWithHoles(arr)||pick_timeline_iterableToArrayLimit(arr,i)||pick_timeline_unsupportedIterableToArray(arr,i)||pick_timeline_nonIterableRest()}function pick_timeline_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pick_timeline_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return pick_timeline_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pick_timeline_arrayLikeToArray(o,minLen)}function pick_timeline_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function pick_timeline_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function pick_timeline_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const PickTimeline=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,isDisabled:isDisabled=false})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=pick_timeline_slicedToArray(_useState,2),timelineId=_useState2[0],setTimelineId=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(null),_useState4=pick_timeline_slicedToArray(_useState3,2),timelineTitle=_useState4[0],setTimelineTitle=_useState4[1];const _getFieldValidityAndE=Object(shared_imports["x"])(field),isInvalid=_getFieldValidityAndE.isInvalid,errorMessage=_getFieldValidityAndE.errorMessage;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const _ref=field.value,id=_ref.id,title=_ref.title;if(timelineTitle!==title&&timelineId!==id){setTimelineId(id);setTimelineTitle(title)}},[field.value]);const handleOnTimelineChange=Object(external_kbnSharedDeps_React_["useCallback"])((title,id)=>{if(id===null){field.setValue({id:id,title:null})}else if(timelineTitle!==title&&timelineId!==id){field.setValue({id:id,title:title})}},[field]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:field.label,labelAppend:field.labelAppend,helpText:field.helpText,error:errorMessage,isInvalid:isInvalid,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(SearchTimelineSuperSelect,{isDisabled:isDisabled,hideUntitled:true,timelineId:timelineId,timelineTitle:timelineTitle,onTimelineChange:handleOnTimelineChange}))};const StyledDiv=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-1adamx3-0"})(["padding-left:",";"],({addPadding:addPadding})=>addPadding&&"53px");StyledDiv.defaultProps={addPadding:false};const StepContentWrapper=external_kbnSharedDeps_React_default.a.memo(StyledDiv);StepContentWrapper.displayName="StepContentWrapper";var rules_translations=__webpack_require__(101);const NextStep=external_kbnSharedDeps_React_default.a.memo(({onClick:onClick,isDisabled:isDisabled,dataTestSubj:dataTestSubj="nextStep-continue"})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,onClick:onClick,isDisabled:isDisabled,"data-test-subj":dataTestSubj},rules_translations["G"])))));NextStep.displayName="NextStep";var edit_data_provider_helpers=__webpack_require__(517);const THRESHOLD_FIELD_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.thresholdField.thresholdFieldPlaceholderText",{defaultMessage:"All results"});const FIELD_COMBO_BOX_WIDTH=410;const OperatorWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"OperatorWrapper",componentId:"sc-10hzoxx-0"})(["align-self:center;"]);const fieldDescribedByIds=["detectionEngineStepDefineRuleThresholdField"];const valueDescribedByIds=["detectionEngineStepDefineRuleThresholdValue"];const ThresholdInputComponent=({thresholdField:thresholdField,thresholdValue:thresholdValue,browserFields:browserFields})=>{const fieldEuiFieldProps=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({fullWidth:true,singleSelection:{asPlainText:true},noSuggestions:false,options:Object(edit_data_provider_helpers["a"])(browserFields),placeholder:THRESHOLD_FIELD_PLACEHOLDER,onCreateOption:undefined,style:{width:"".concat(FIELD_COMBO_BOX_WIDTH,"px")}}),[browserFields]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(shared_imports["d"],{field:thresholdField,idAria:"detectionEngineStepDefineRuleThresholdField","data-test-subj":"detectionEngineStepDefineRuleThresholdField",describedByIds:fieldDescribedByIds,type:thresholdField.type,euiFieldProps:fieldEuiFieldProps})),external_kbnSharedDeps_React_default.a.createElement(OperatorWrapper,{grow:false},">="),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(shared_imports["d"],{field:thresholdValue,idAria:"detectionEngineStepDefineRuleThresholdValue","data-test-subj":"detectionEngineStepDefineRuleThresholdValue",describedByIds:valueDescribedByIds,type:thresholdValue.type})))};const ThresholdInput=external_kbnSharedDeps_React_default.a.memo(ThresholdInputComponent);var external_kbnSharedDeps_Lodash_=__webpack_require__(26);function threat_match_helpers_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function threat_match_helpers_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){threat_match_helpers_ownKeys(Object(source),true).forEach((function(key){threat_match_helpers_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{threat_match_helpers_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function threat_match_helpers_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function helpers_slicedToArray(arr,i){return helpers_arrayWithHoles(arr)||helpers_iterableToArrayLimit(arr,i)||helpers_unsupportedIterableToArray(arr,i)||helpers_nonIterableRest()}function helpers_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function helpers_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return helpers_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return helpers_arrayLikeToArray(o,minLen)}function helpers_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function helpers_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function helpers_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const getFormattedEntry=(indexPattern,threatIndexPatterns,item,itemIndex)=>{const fields=indexPattern.fields;const threatFields=threatIndexPatterns.fields;const field=item.field;const threatField=item.value;const _fields$filter=fields.filter(({name:name})=>field!=null&&field===name),_fields$filter2=helpers_slicedToArray(_fields$filter,1),foundField=_fields$filter2[0];const _threatFields$filter=threatFields.filter(({name:name})=>threatField!=null&&threatField===name),_threatFields$filter2=helpers_slicedToArray(_threatFields$filter,1),threatFoundField=_threatFields$filter2[0];return{field:foundField,type:"mapping",value:threatFoundField,entryIndex:itemIndex}};const getFormattedEntries=(indexPattern,threatIndexPatterns,entries)=>entries.reduce((acc,item,index)=>{const newItemEntry=getFormattedEntry(indexPattern,threatIndexPatterns,item,index);return[...acc,newItemEntry]},[]);const getUpdatedEntriesOnDelete=(item,entryIndex)=>threat_match_helpers_objectSpread(threat_match_helpers_objectSpread({},item),{},{entries:[...item.entries.slice(0,entryIndex),...item.entries.slice(entryIndex+1)]});const getEntryOnFieldChange=(item,newField)=>{const entryIndex=item.entryIndex;return{updatedEntry:{field:newField!=null?newField.name:"",type:"mapping",value:item.value!=null?item.value.name:""},index:entryIndex}};const getEntryOnThreatFieldChange=(item,newField)=>{const entryIndex=item.entryIndex;return{updatedEntry:{field:item.field!=null?item.field.name:"",type:"mapping",value:newField!=null?newField.name:""},index:entryIndex}};const getDefaultEmptyEntry=()=>({field:"",type:"mapping",value:""});const getNewItem=()=>({entries:[{field:"",type:"mapping",value:""}]});const filterItems=items=>items.reduce((acc,item)=>{const newItem=threat_match_helpers_objectSpread(threat_match_helpers_objectSpread({},item),{},{entries:item.entries});if(types["c"].is(newItem)){return[...acc,newItem]}else{return acc}},[]);const containsInvalidItems=items=>items.some(item=>item.entries.some(subEntry=>subEntry.field===""||subEntry.value===""));const singleEntryThreat=items=>items.length===1&&items[0].entries.length===1&&items[0].entries[0].field===""&&items[0].entries[0].value==="";var dataEnhanced_public_=__webpack_require__(74);const PARSING_ERROR_TYPE="parsing_exception";const VERIFICATION_ERROR_TYPE="verification_exception";const MAPPING_ERROR_TYPE="mapping_exception";const isValidationErrorType=type=>type===PARSING_ERROR_TYPE||type===VERIFICATION_ERROR_TYPE||type===MAPPING_ERROR_TYPE;const isErrorResponse=response=>Object(external_kbnSharedDeps_Lodash_["has"])(response,"error.type");const isValidationErrorResponse=response=>isErrorResponse(response)&&isValidationErrorType(Object(external_kbnSharedDeps_Lodash_["get"])(response,"error.type"));const getValidationErrors=response=>response.error.root_cause.filter(cause=>isValidationErrorType(cause.type)).map(cause=>cause.reason);function api_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function api_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){api_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){api_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const validateEql=function(){var _ref=api_asyncToGenerator(regeneratorRuntime.mark((function _callee({data:data,index:index,query:query,signal:signal}){var _yield$data$search$se,response;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return data.search.search({params:{index:index.join(),body:{query:query,size:0}},options:{ignore:[400]}},{strategy:dataEnhanced_public_["EQL_SEARCH_STRATEGY"],abortSignal:signal}).toPromise();case 2:_yield$data$search$se=_context.sent;response=_yield$data$search$se.rawResponse;if(!isValidationErrorResponse(response.body)){_context.next=8;break}return _context.abrupt("return",{valid:false,errors:getValidationErrors(response.body)});case 8:if(!isErrorResponse(response.body)){_context.next=12;break}throw new Error(JSON.stringify(response.body));case 12:return _context.abrupt("return",{valid:true,errors:[]});case 13:case"end":return _context.stop()}}),_callee)})));return function validateEql(_x){return _ref.apply(this,arguments)}}();const EQL_VALIDATION_REQUEST_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"});const EQL_VALIDATION_ERRORS_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"});const EQL_VALIDATION_ERROR_POPOVER_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"});const translations_EQL_QUERY_BAR_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.eqlQueryBar.label",{defaultMessage:"Enter an EQL Query"});const EQL_OVERVIEW_LINK_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"});function validators_slicedToArray(arr,i){return validators_arrayWithHoles(arr)||validators_iterableToArrayLimit(arr,i)||validators_unsupportedIterableToArray(arr,i)||validators_nonIterableRest()}function validators_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function validators_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return validators_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return validators_arrayLikeToArray(o,minLen)}function validators_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function validators_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function validators_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function validators_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function validators_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){validators_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){validators_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}let ERROR_CODES;(function(ERROR_CODES){ERROR_CODES["FAILED_REQUEST"]="ERR_FAILED_REQUEST";ERROR_CODES["INVALID_EQL"]="ERR_INVALID_EQL"})(ERROR_CODES||(ERROR_CODES={}));const debounceAsync=(fn,interval)=>{let handle;let resolves=[];return(...args)=>{if(handle){clearTimeout(handle)}handle=setTimeout(()=>{const result=fn(...args);resolves.forEach(resolve=>resolve(result));resolves=[]},interval);return new Promise(resolve=>resolves.push(resolve))}};const eqlValidator=function(){var _ref=validators_asyncToGenerator(regeneratorRuntime.mark((function _callee(...args){var _args$,value,formData,_ref2,queryValue,query,_ref3,index,ruleType,needsValidation,_KibanaServices$get,data,signal,response;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_args$=args[0],value=_args$.value,formData=_args$.formData;_ref2=value,queryValue=_ref2.query;query=queryValue.query;_ref3=formData,index=_ref3.index,ruleType=_ref3.ruleType;needsValidation=Object(utils["c"])(ruleType)&&!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query);if(needsValidation){_context.next=7;break}return _context.abrupt("return");case 7:_context.prev=7;_KibanaServices$get=lib_kibana["b"].get(),data=_KibanaServices$get.data;signal=(new AbortController).signal;_context.next=12;return validateEql({data:data,query:query,signal:signal,index:index});case 12:response=_context.sent;if(!((response===null||response===void 0?void 0:response.valid)===false)){_context.next=15;break}return _context.abrupt("return",{code:ERROR_CODES.INVALID_EQL,message:"",messages:response.errors});case 15:_context.next=20;break;case 17:_context.prev=17;_context.t0=_context["catch"](7);return _context.abrupt("return",{code:ERROR_CODES.FAILED_REQUEST,message:EQL_VALIDATION_REQUEST_ERROR,error:_context.t0});case 20:case"end":return _context.stop()}}),_callee,null,[[7,17]])})));return function eqlValidator(){return _ref.apply(this,arguments)}}();const getValidationResults=field=>{const hasErrors=field.errors.length>0;const isValid=!field.isChangingValue&&!hasErrors;if(hasErrors){const _field$errors=validators_slicedToArray(field.errors,1),error=_field$errors[0];const message=error.message;if(error.code===ERROR_CODES.INVALID_EQL){return{isValid:isValid,message:message,messages:error.messages}}else{return{isValid:isValid,message:message,error:error.error}}}else{return{isValid:isValid,message:""}}};const schema_schema={index:{fieldsToValidateOnChange:["index","queryBar"],type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},INDEX_HELPER_TEXT),validations:[{validator:(...args)=>{const formData=args[0].formData;const needsValidation=!Object(helpers["d"])(formData.ruleType);if(!needsValidation){return}return shared_imports["w"].emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...args)}}]},queryBar:{validations:[{validator:(...args)=>{const _args$=args[0],value=_args$.value,path=_args$.path,formData=_args$.formData;const _ref=value,query=_ref.query,filters=_ref.filters;const needsValidation=!Object(helpers["d"])(formData.ruleType);if(!needsValidation){return}return Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query.query)&&Object(external_kbnSharedDeps_Lodash_["isEmpty"])(filters)?{code:"ERR_FIELD_MISSING",path:path,message:CUSTOM_QUERY_REQUIRED}:undefined}},{validator:(...args)=>{const _args$2=args[0],value=_args$2.value,path=_args$2.path,formData=_args$2.formData;const _ref2=value,query=_ref2.query;const needsValidation=!Object(helpers["d"])(formData.ruleType);if(!needsValidation){return}if(!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query.query)&&query.language==="kuery"){try{public_["esKuery"].fromKueryExpression(query.query)}catch(err){return{code:"ERR_FIELD_FORMAT",path:path,message:INVALID_CUSTOM_QUERY}}}}},{validator:debounceAsync(eqlValidator,300)}]},ruleType:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...args)=>{const formData=args[0].formData;const needsValidation=Object(helpers["d"])(formData.ruleType);if(!needsValidation){return}return shared_imports["w"].emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...args)}}]},timeline:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Field"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select a field to group results by"})},value:{type:shared_imports["c"].NUMBER,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:shared_imports["w"].numberGreaterThanField({than:1,message:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal one."}),allowEquality:true})}]}},threatIndex:{type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},THREAT_MATCH_INDEX_HELPER_TEXT),validations:[{validator:(...args)=>{const formData=args[0].formData;const needsValidation=Object(utils["e"])(formData.ruleType);if(!needsValidation){return}return shared_imports["w"].emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...args)}}]},threatMapping:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...args)=>{const _args$3=args[0],path=_args$3.path,formData=_args$3.formData;const needsValidation=Object(utils["e"])(formData.ruleType);if(!needsValidation){return}if(singleEntryThreat(formData.threatMapping)){return{code:"ERR_FIELD_MISSING",path:path,message:THREAT_MATCH_REQUIRED}}else if(containsInvalidItems(formData.threatMapping)){return{code:"ERR_FIELD_MISSING",path:path,message:THREAT_MATCH_EMPTIES}}else{return undefined}}}]},threatQueryBar:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...args)=>{const _args$4=args[0],value=_args$4.value,path=_args$4.path,formData=_args$4.formData;const needsValidation=Object(utils["e"])(formData.ruleType);if(!needsValidation){return}const _ref3=value,query=_ref3.query,filters=_ref3.filters;return Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query.query)&&Object(external_kbnSharedDeps_Lodash_["isEmpty"])(filters)?{code:"ERR_FIELD_MISSING",path:path,message:CUSTOM_QUERY_REQUIRED}:undefined}},{validator:(...args)=>{const _args$5=args[0],value=_args$5.value,path=_args$5.path,formData=_args$5.formData;const needsValidation=Object(utils["e"])(formData.ruleType);if(!needsValidation){return}const _ref4=value,query=_ref4.query;if(!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query.query)&&query.language==="kuery"){try{public_["esKuery"].fromKueryExpression(query.query)}catch(err){return{code:"ERR_FIELD_FORMAT",path:path,message:INVALID_CUSTOM_QUERY}}}}}]}};function errors_popover_slicedToArray(arr,i){return errors_popover_arrayWithHoles(arr)||errors_popover_iterableToArrayLimit(arr,i)||errors_popover_unsupportedIterableToArray(arr,i)||errors_popover_nonIterableRest()}function errors_popover_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function errors_popover_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return errors_popover_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return errors_popover_arrayLikeToArray(o,minLen)}function errors_popover_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function errors_popover_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function errors_popover_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ErrorsPopover=({ariaLabel:ariaLabel,errors:errors})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=errors_popover_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];const handleToggle=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsOpen(!isOpen)},[isOpen]);const handleClose=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsOpen(false)},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{"data-test-subj":"eql-validation-errors-popover",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"eql-validation-errors-popover-button",iconType:"crossInACircleFilled",size:"s",color:"danger","aria-label":ariaLabel,onClick:handleToggle},errors.length),isOpen:isOpen,closePopover:handleClose,anchorPosition:"downCenter"},external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,EQL_VALIDATION_ERRORS_TITLE),errors.map((message,idx)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{key:idx},message))))};const InlineText=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiText"]).withConfig({displayName:"InlineText",componentId:"i91hzt-0"})(["display:inline-block;"]);const EqlOverviewLink=()=>{const overviewUrl=Object(lib_kibana["h"])().services.docLinks.links.query.eql;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{external:true,href:overviewUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(InlineText,{size:"xs"},EQL_OVERVIEW_LINK_TEXT))};const Container=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"Container",componentId:"sc-10yczbx-0"})(["border-radius:0;background:",";padding:"," ",";"],({theme:theme})=>theme.eui.euiPageBackgroundColor,({theme:theme})=>theme.eui.euiSizeXS,({theme:theme})=>theme.eui.euiSizeS);const FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroup",componentId:"sc-10yczbx-1"})(["min-height:",";"],({theme:theme})=>theme.eui.euiSizeXL);const Spinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"]).withConfig({displayName:"Spinner",componentId:"sc-10yczbx-2"})(["margin:0 ",";"],({theme:theme})=>theme.eui.euiSizeS);const EqlQueryBarFooter=({errors:errors,isLoading:isLoading})=>external_kbnSharedDeps_React_default.a.createElement(Container,null,external_kbnSharedDeps_React_default.a.createElement(FlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,errors.length>0&&external_kbnSharedDeps_React_default.a.createElement(ErrorsPopover,{ariaLabel:EQL_VALIDATION_ERROR_POPOVER_LABEL,errors:errors}),isLoading&&external_kbnSharedDeps_React_default.a.createElement(Spinner,{"data-test-subj":"eql-validation-loading",size:"m"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(EqlOverviewLink,null))));function eql_query_bar_slicedToArray(arr,i){return eql_query_bar_arrayWithHoles(arr)||eql_query_bar_iterableToArrayLimit(arr,i)||eql_query_bar_unsupportedIterableToArray(arr,i)||eql_query_bar_nonIterableRest()}function eql_query_bar_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function eql_query_bar_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return eql_query_bar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eql_query_bar_arrayLikeToArray(o,minLen)}function eql_query_bar_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function eql_query_bar_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function eql_query_bar_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const TextArea=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiTextArea"]).withConfig({displayName:"TextArea",componentId:"sc-4u43ce-0"})(["display:block;border:",";border-bottom:0;box-shadow:none;min-height:",";"],({theme:theme})=>theme.eui.euiBorderThin,({theme:theme})=>theme.eui.euiFormControlHeight);const EqlQueryBar=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,onValidityChange:onValidityChange})=>{const _useAppToasts=Object(use_app_toasts["a"])(),addError=_useAppToasts.addError;const _useState=Object(external_kbnSharedDeps_React_["useState"])([]),_useState2=eql_query_bar_slicedToArray(_useState,2),errorMessages=_useState2[0],setErrorMessages=_useState2[1];const isValidating=field.isValidating,setValue=field.setValue;const _getValidationResults=getValidationResults(field),isValid=_getValidationResults.isValid,message=_getValidationResults.message,messages=_getValidationResults.messages,error=_getValidationResults.error;const fieldValue=field.value.query.query;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(onValidityChange!=null){onValidityChange(isValid)}},[isValid,onValidityChange]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setErrorMessages(messages!==null&&messages!==void 0?messages:[])},[messages]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(error){addError(error,{title:EQL_VALIDATION_REQUEST_ERROR})}},[error,addError]);const handleChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const newQuery=e.target.value;setErrorMessages([]);setValue({filters:[],query:{query:newQuery,language:"eql"}})},[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:field.label,labelAppend:field.labelAppend,helpText:field.helpText,error:message,isInvalid:!isValid,fullWidth:true,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(TextArea,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:true,isInvalid:!isValid,value:fieldValue,onChange:handleChange}),external_kbnSharedDeps_React_default.a.createElement(EqlQueryBarFooter,{errors:errorMessages,isLoading:isValidating})))};var autocomplete_field=__webpack_require__(262);const FlexItemWithLabel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItemWithLabel",componentId:"sc-1i1appc-0"})(["padding-top:20px;text-align:center;"]);const FlexItemWithoutLabel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItemWithoutLabel",componentId:"sc-1i1appc-1"})(["text-align:center;"]);const EntryItem=({entry:entry,indexPattern:indexPattern,threatIndexPatterns:threatIndexPatterns,showLabel:showLabel,onChange:onChange})=>{const handleFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(([newField])=>{const _getEntryOnFieldChang=getEntryOnFieldChange(entry,newField),updatedEntry=_getEntryOnFieldChang.updatedEntry,index=_getEntryOnFieldChang.index;onChange(updatedEntry,index)},[onChange,entry]);const handleThreatFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(([newField])=>{const _getEntryOnThreatFiel=getEntryOnThreatFieldChange(entry,newField),updatedEntry=_getEntryOnThreatFiel.updatedEntry,index=_getEntryOnThreatFiel.index;onChange(updatedEntry,index)},[onChange,entry]);const renderFieldInput=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const comboBox=external_kbnSharedDeps_React_default.a.createElement(autocomplete_field["a"],{placeholder:FIELD_PLACEHOLDER,indexPattern:indexPattern,selectedField:entry.field,isClearable:false,isLoading:false,isDisabled:indexPattern==null,onChange:handleFieldChange,"data-test-subj":"entryField",fieldInputWidth:360});if(showLabel){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:FIELD,"data-test-subj":"entryItemFieldInputFormRow"},comboBox)}else{return comboBox}},[handleFieldChange,indexPattern,entry,showLabel]);const renderThreatFieldInput=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const comboBox=external_kbnSharedDeps_React_default.a.createElement(autocomplete_field["a"],{placeholder:FIELD_PLACEHOLDER,indexPattern:threatIndexPatterns,selectedField:entry.value,isClearable:false,isLoading:false,isDisabled:threatIndexPatterns==null,onChange:handleThreatFieldChange,"data-test-subj":"threatEntryField",fieldInputWidth:360});if(showLabel){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:THREAT_FIELD,"data-test-subj":"threatFieldInputFormRow"},comboBox)}else{return comboBox}},[handleThreatFieldChange,threatIndexPatterns,entry,showLabel]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",gutterSize:"s",alignItems:"center",justifyContent:"spaceAround","data-test-subj":"itemEntryContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},renderFieldInput),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceAround",alignItems:"center"},showLabel?external_kbnSharedDeps_React_default.a.createElement(FlexItemWithLabel,{grow:true},MATCHES):external_kbnSharedDeps_React_default.a.createElement(FlexItemWithoutLabel,{grow:true},MATCHES))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},renderThreatFieldInput))};EntryItem.displayName="EntryItem";const MyFirstRowContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-136w498-0"})(["padding-top:20px;"]);const EntryDeleteButtonComponent=external_kbnSharedDeps_React_default.a.memo(({entries:entries,isOnlyItem:isOnlyItem,entryIndex:entryIndex,itemIndex:itemIndex,onDelete:onDelete})=>{const isDisabled=isOnlyItem&&entries.length===1&&itemIndex===0&&(entries[0].field==null||entries[0].field==="");const handleDelete=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{onDelete(entryIndex)},[onDelete,entryIndex]);const button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{color:"danger",iconType:"trash",onClick:handleDelete,isDisabled:isDisabled,"aria-label":"entryDeleteButton",className:"itemEntryDeleteButton","data-test-subj":"itemEntryDeleteButton"});if(entryIndex===0&&itemIndex===0){return external_kbnSharedDeps_React_default.a.createElement(MyFirstRowContainer,{grow:false,"data-test-subj":"firstRowDeleteButton"},button)}else{return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,"data-test-subj":"deleteButton"},button)}});EntryDeleteButtonComponent.displayName="EntryDeleteButton";var and_or_badge=__webpack_require__(154);const MyInvisibleAndBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyInvisibleAndBadge",componentId:"d6yaa8-0"})(["visibility:hidden;"]);const and_badge_MyFirstRowContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyFirstRowContainer",componentId:"d6yaa8-1"})(["padding-top:20px;"]);const AndBadgeComponent=external_kbnSharedDeps_React_default.a.memo(({entriesLength:entriesLength,entryItemIndex:entryItemIndex})=>{const badge=external_kbnSharedDeps_React_default.a.createElement(and_or_badge["a"],{includeAntennas:true,type:"and"});if(entriesLength>1&&entryItemIndex===0){return external_kbnSharedDeps_React_default.a.createElement(and_badge_MyFirstRowContainer,{grow:false,"data-test-subj":"entryItemEntryFirstRowAndBadge"},badge)}else if(entriesLength<=1){return external_kbnSharedDeps_React_default.a.createElement(MyInvisibleAndBadge,{grow:false,"data-test-subj":"entryItemEntryInvisibleAndBadge"},badge)}else{return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,"data-test-subj":"entryItemEntryAndBadge"},badge)}});AndBadgeComponent.displayName="AndBadge";function list_item_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function list_item_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){list_item_ownKeys(Object(source),true).forEach((function(key){list_item_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{list_item_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function list_item_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const MyOverflowContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyOverflowContainer",componentId:"o1uavm-0"})(["overflow:hidden;width:100%;"]);const ListItemComponent=external_kbnSharedDeps_React_default.a.memo(({listItem:listItem,listId:listId,listItemIndex:listItemIndex,indexPattern:indexPattern,threatIndexPatterns:threatIndexPatterns,isOnlyItem:isOnlyItem,andLogicIncluded:andLogicIncluded,onDeleteEntryItem:onDeleteEntryItem,onChangeEntryItem:onChangeEntryItem})=>{const handleEntryChange=Object(external_kbnSharedDeps_React_["useCallback"])((entry,entryIndex)=>{const updatedEntries=[...listItem.entries.slice(0,entryIndex),list_item_objectSpread({},entry),...listItem.entries.slice(entryIndex+1)];const updatedEntryItem=list_item_objectSpread(list_item_objectSpread({},listItem),{},{entries:updatedEntries});onChangeEntryItem(updatedEntryItem,listItemIndex)},[onChangeEntryItem,listItem,listItemIndex]);const handleDeleteEntry=Object(external_kbnSharedDeps_React_["useCallback"])(entryIndex=>{const updatedEntryItem=getUpdatedEntriesOnDelete(listItem,entryIndex);onDeleteEntryItem(updatedEntryItem,listItemIndex)},[listItem,onDeleteEntryItem,listItemIndex]);const entries=Object(external_kbnSharedDeps_React_["useMemo"])(()=>indexPattern!=null&&listItem.entries.length>0?getFormattedEntries(indexPattern,threatIndexPatterns,listItem.entries):[],[listItem.entries,indexPattern,threatIndexPatterns]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s","data-test-subj":"entriesContainer"},andLogicIncluded&&external_kbnSharedDeps_React_default.a.createElement(AndBadgeComponent,{entriesLength:listItem.entries.length,entryItemIndex:listItemIndex}),external_kbnSharedDeps_React_default.a.createElement(MyOverflowContainer,{grow:6},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",direction:"column"},entries.map((item,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:"".concat(listId,"-").concat(index),grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"xs",alignItems:"center",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(MyOverflowContainer,{grow:1},external_kbnSharedDeps_React_default.a.createElement(EntryItem,{entry:item,threatIndexPatterns:threatIndexPatterns,indexPattern:indexPattern,showLabel:listItemIndex===0&&index===0,onChange:handleEntryChange})),external_kbnSharedDeps_React_default.a.createElement(EntryDeleteButtonComponent,{entries:listItem.entries,isOnlyItem:isOnlyItem,entryIndex:item.entryIndex,itemIndex:listItemIndex,onDelete:handleDeleteEntry}))))))))});ListItemComponent.displayName="ListItem";const MyEuiButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButton"]).withConfig({displayName:"MyEuiButton",componentId:"sc-1dsnlky-0"})(["min-width:95px;"]);const LogicButtons=({isOrDisabled:isOrDisabled=false,isAndDisabled:isAndDisabled=false,onAndClicked:onAndClicked,onOrClicked:onOrClicked})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyEuiButton,{fill:true,size:"s",iconType:"plusInCircle",onClick:onAndClicked,"data-test-subj":"andButton",isDisabled:isAndDisabled},AND)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyEuiButton,{fill:true,size:"s",iconType:"plusInCircle",onClick:onOrClicked,isDisabled:isOrDisabled,"data-test-subj":"orButton"},OR)));function reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function reducer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){reducer_ownKeys(Object(source),true).forEach((function(key){reducer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{reducer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function reducer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const reducer=()=>(state,action)=>{switch(action.type){case"setEntries":{const isAndLogicIncluded=action.entries.filter(({entries:entries})=>entries.length>1).length>0;const returnState=reducer_objectSpread(reducer_objectSpread({},state),{},{andLogicIncluded:isAndLogicIncluded,entries:action.entries});return returnState}case"setDefault":{return reducer_objectSpread(reducer_objectSpread(reducer_objectSpread({},state),action.initialState),{},{entries:[reducer_objectSpread(reducer_objectSpread({},action.lastEntry),{},{entries:[getDefaultEmptyEntry()]})]})}default:return state}};function threat_match_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function threat_match_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){threat_match_ownKeys(Object(source),true).forEach((function(key){threat_match_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{threat_match_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function threat_match_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function threat_match_slicedToArray(arr,i){return threat_match_arrayWithHoles(arr)||threat_match_iterableToArrayLimit(arr,i)||threat_match_unsupportedIterableToArray(arr,i)||threat_match_nonIterableRest()}function threat_match_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function threat_match_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return threat_match_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return threat_match_arrayLikeToArray(o,minLen)}function threat_match_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function threat_match_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function threat_match_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const threat_match_MyInvisibleAndBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyInvisibleAndBadge",componentId:"ph2s87-0"})(["visibility:hidden;"]);const MyAndBadge=external_kbnSharedDeps_StyledComponents_default()(and_or_badge["a"]).withConfig({displayName:"MyAndBadge",componentId:"ph2s87-1"})(["& > .euiFlexItem{margin:0;}"]);const MyButtonsContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyButtonsContainer",componentId:"ph2s87-2"})(["margin:16px 0;"]);const threat_match_initialState={andLogicIncluded:false,entries:[],entriesToDelete:[]};const ThreatMatchComponent=({listItems:listItems,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,onChange:onChange})=>{const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(reducer(),threat_match_objectSpread({},threat_match_initialState)),_useReducer2=threat_match_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],entries=_useReducer2$.entries,entriesToDelete=_useReducer2$.entriesToDelete,andLogicIncluded=_useReducer2$.andLogicIncluded,dispatch=_useReducer2[1];const setUpdateEntries=Object(external_kbnSharedDeps_React_["useCallback"])(items=>{dispatch({type:"setEntries",entries:items})},[dispatch]);const setDefaultEntries=Object(external_kbnSharedDeps_React_["useCallback"])(item=>{dispatch({type:"setDefault",initialState:threat_match_initialState,lastEntry:item})},[dispatch]);const handleEntryItemChange=Object(external_kbnSharedDeps_React_["useCallback"])((item,index)=>{const updatedEntries=[...entries.slice(0,index),threat_match_objectSpread({},item),...entries.slice(index+1)];setUpdateEntries(updatedEntries)},[setUpdateEntries,entries]);const handleDeleteEntryItem=Object(external_kbnSharedDeps_React_["useCallback"])((item,itemIndex)=>{if(item.entries.length===0){const updatedEntries=[...entries.slice(0,itemIndex),...entries.slice(itemIndex+1)];if(updatedEntries.length===0){setDefaultEntries(item)}else{setUpdateEntries([...entries.slice(0,itemIndex),...entries.slice(itemIndex+1)])}}else{handleEntryItemChange(item,itemIndex)}},[handleEntryItemChange,setUpdateEntries,entries,setDefaultEntries]);const handleAddNewEntryItemEntry=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const lastEntry=entries[entries.length-1];const innerEntries=lastEntry.entries;const updatedEntry=threat_match_objectSpread(threat_match_objectSpread({},lastEntry),{},{entries:[...innerEntries,getDefaultEmptyEntry()]});setUpdateEntries([...entries.slice(0,entries.length-1),threat_match_objectSpread({},updatedEntry)])},[setUpdateEntries,entries]);const handleAddNewEntryItem=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const newItem=getNewItem();setUpdateEntries([...entries,threat_match_objectSpread({},newItem)])},[setUpdateEntries,entries]);const handleAddClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{handleAddNewEntryItemEntry()},[handleAddNewEntryItemEntry]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{onChange({entryItems:filterItems(entries),entriesToDelete:entriesToDelete})},[onChange,entriesToDelete,entries]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(entries.length===0||entries.length===1&&entries[0].entries!=null&&entries[0].entries.length===0){handleAddNewEntryItem()}},[entries,handleAddNewEntryItem]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(listItems.length>0){setUpdateEntries(listItems)}},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",direction:"column"},entries.map((entryListItem,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1,key:"".concat(index)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",direction:"column"},index!==0&&(andLogicIncluded?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(threat_match_MyInvisibleAndBadge,{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyAndBadge,{includeAntennas:true,type:"and"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyAndBadge,{type:"or"})))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyAndBadge,{type:"or"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ListItemComponent,{key:"".concat(index),listItem:entryListItem,listId:"".concat(index),indexPattern:indexPatterns,threatIndexPatterns:threatIndexPatterns,listItemIndex:index,andLogicIncluded:andLogicIncluded,isOnlyItem:entries.length===1,onDeleteEntryItem:handleDeleteEntryItem,onChangeEntryItem:handleEntryItemChange}))))),external_kbnSharedDeps_React_default.a.createElement(MyButtonsContainer,{"data-test-subj":"andOrOperatorButtons"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},andLogicIncluded&&external_kbnSharedDeps_React_default.a.createElement(threat_match_MyInvisibleAndBadge,{grow:false},external_kbnSharedDeps_React_default.a.createElement(and_or_badge["a"],{includeAntennas:true,type:"and"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(LogicButtons,{isOrDisabled:false,isAndDisabled:false,onOrClicked:handleAddNewEntryItem,onAndClicked:handleAddClick})))))};ThreatMatchComponent.displayName="ThreatMatch";function threatmatch_input_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function threatmatch_input_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){threatmatch_input_ownKeys(Object(source),true).forEach((function(key){threatmatch_input_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{threatmatch_input_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function threatmatch_input_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const CommonUseField=Object(shared_imports["y"])({component:shared_imports["d"]});const ThreatMatchInputComponent=({threatMapping:threatMapping,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,threatIndexPatternsLoading:threatIndexPatternsLoading,threatBrowserFields:threatBrowserFields})=>{const setValue=threatMapping.setValue,threatItems=threatMapping.value;const _getFieldValidityAndE=Object(shared_imports["x"])(threatMapping),isInvalid=_getFieldValidityAndE.isInvalid,errorMessage=_getFieldValidityAndE.errorMessage;const handleBuilderOnChange=Object(external_kbnSharedDeps_React_["useCallback"])(({entryItems:entryItems})=>{setValue(entryItems)},[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(CommonUseField,{path:"threatIndex",config:threatmatch_input_objectSpread(threatmatch_input_objectSpread({},schema_schema.threatIndex),{},{labelAppend:null}),componentProps:{idAria:"detectionEngineStepDefineRuleThreatMatchIndices","data-test-subj":"detectionEngineStepDefineRuleThreatMatchIndices",euiFieldProps:{fullWidth:true,isDisabled:false,placeholder:""}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"threatQueryBar",config:threatmatch_input_objectSpread(threatmatch_input_objectSpread({},schema_schema.threatQueryBar),{},{labelAppend:null}),component:QueryBarDefineRule,componentProps:{browserFields:threatBrowserFields,idAria:"detectionEngineStepDefineThreatRuleQueryBar",indexPattern:threatIndexPatterns,isDisabled:false,isLoading:threatIndexPatternsLoading,dataTestSubj:"detectionEngineStepDefineThreatRuleQueryBar",openTimelineSearch:false}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:threatMapping.label,labelAppend:threatMapping.labelAppend,helpText:threatMapping.helpText,error:errorMessage,isInvalid:isInvalid,fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(ThreatMatchComponent,{listItems:threatItems,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,"data-test-subj":"threatmatch-builder","id-aria":"threatmatch-builder",onChange:handleBuilderOnChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}))};const ThreatMatchInput=external_kbnSharedDeps_React_default.a.memo(ThreatMatchInputComponent);var source=__webpack_require__(148);const QUERY_PREVIEW_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.stepDefineRule.previewQueryButton",{defaultMessage:"Preview results"});const QUERY_PREVIEW_SELECT_ARIA=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.stepDefineRule.previewQueryAriaLabel",{defaultMessage:"Query preview timeframe select"});const QUERY_PREVIEW_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewLabel",{defaultMessage:"Quick query preview"});const QUERY_PREVIEW_HELP_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewHelpText",{defaultMessage:"Select a timeframe of data to preview query results"});const QUERY_GRAPH_COUNT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphCountLabel",{defaultMessage:"Count"});const QUERY_GRAPH_HITS_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphHitsTitle",{defaultMessage:"Hits"});const QUERY_PREVIEW_TITLE=hits=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewGraphTitle",{values:{hits:hits},defaultMessage:"{hits} {hits, plural, =1 {hit} other {hits}}"});const QUERY_PREVIEW_THRESHOLD_WITH_FIELD_TITLE=buckets=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewGraphThresholdWithFieldTitle",{values:{buckets:buckets},defaultMessage:"{buckets} {buckets, plural, =1 {unique hit} other {unique hits}}"});const QUERY_PREVIEW_INSPECT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewInspectTitle",{defaultMessage:"query preview"});const QUERY_PREVIEW_NOISE_WARNING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewNoiseWarning",{defaultMessage:"Noise warning: This rule may cause a lot of noise. Consider narrowing your query. This is based on a linear progression of 1 alert per hour."});const QUERY_PREVIEW_NO_HITS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryNoHits",{defaultMessage:"No hits were found."});const QUERY_PREVIEW_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewError",{defaultMessage:"Error fetching preview"});const QUERY_PREVIEW_DISCLAIMER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphDisclaimer",{defaultMessage:"Note: This preview excludes effects of rule exceptions and timestamp overrides."});const QUERY_PREVIEW_DISCLAIMER_EQL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphDisclaimerEql",{defaultMessage:"Note: This preview excludes effects of rule exceptions and timestamp overrides, and is limited to 100 results."});const QUERY_PREVIEW_SUBTITLE_LOADING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSubtitleLoading",{defaultMessage:"...loading"});const QUERY_PREVIEW_EQL_SEQUENCE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewEqlSequenceTitle",{defaultMessage:"No histogram available"});const QUERY_PREVIEW_EQL_SEQUENCE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewEqlSequenceDescription",{defaultMessage:"No histogram is available at this time for EQL sequence queries. You can use the inspect in the top right corner to view query details."});var matrix_histogram=__webpack_require__(720);var security_solution_matrix_histogram=__webpack_require__(255);var external_kbnSharedDeps_ElasticCharts_=__webpack_require__(64);var components_utils=__webpack_require__(171);var get_query_filter=__webpack_require__(722);const isNoisy=(hits,timeframe)=>{if(timeframe==="h"){return hits>1}else if(timeframe==="d"){return hits/24>1}else if(timeframe==="M"){return hits/730>1}return false};const getTimeframeOptions=ruleType=>{if(ruleType==="eql"){return[{value:"h",text:"Last hour"},{value:"d",text:"Last day"}]}else{return[{value:"h",text:"Last hour"},{value:"d",text:"Last day"},{value:"M",text:"Last month"}]}};const getInfoFromQueryBar=(queryBar,index,ruleType)=>{const queryString=typeof queryBar.query.query==="string"?queryBar.query.query:"";const language=queryBar.query.language;const filters=queryBar.filters;try{const queryFilter=ruleType!=="eql"?Object(get_query_filter["a"])(queryString,language,filters,index,[],true):undefined;return{queryString:queryString,language:language,filters:filters,queryFilter:queryFilter}}catch(_unused){return{queryString:queryString,language:language,filters:filters,queryFilter:undefined}}};const getHistogramConfig=(to,from,showLegend=false)=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(components_utils["a"])([to,from]),yTickFormatter:value=>value.toLocaleString(),tickSize:8},yAxisTitle:QUERY_GRAPH_COUNT,settings:{legendPosition:external_kbnSharedDeps_ElasticCharts_["Position"].Right,showLegend:showLegend,showLegendExtra:showLegend,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200});const getThresholdHistogramConfig=()=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Ordinal,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,stackAccessors:["g"]},axis:{yTickFormatter:value=>value.toLocaleString(),tickSize:8},yAxisTitle:QUERY_GRAPH_COUNT,settings:{legendPosition:external_kbnSharedDeps_ElasticCharts_["Position"].Right,showLegend:true,showLegendExtra:true,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200});var use_global_time=__webpack_require__(142);var barchart=__webpack_require__(407);var panel=__webpack_require__(189);var header_section=__webpack_require__(121);const LoadingChart=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingChart"]).withConfig({displayName:"LoadingChart",componentId:"sc-1sjd0mf-0"})(["display:block;margin:0 auto;"]);const PreviewHistogram=({id:id,data:data,dataTestSubj:dataTestSubj,barConfig:barConfig,title:title,subtitle:subtitle,disclaimer:disclaimer,isLoading:isLoading})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(panel["a"],{height:300,"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{id:id,title:title,titleSize:"xs",subtitle:subtitle})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},isLoading?external_kbnSharedDeps_React_default.a.createElement(LoadingChart,{size:"l","data-test-subj":"queryPreviewLoading"}):external_kbnSharedDeps_React_default.a.createElement(barchart["a"],{configs:barConfig,barChart:data,stackByField:undefined,timelineId:undefined,"data-test-subj":"sharedPreviewQueryHistogram"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,disclaimer)))))));const ID="queryEqlPreviewHistogramQuery";const PreviewEqlQueryHistogram=({from:from,to:to,totalCount:totalCount,data:data,inspect:inspect,refetch:refetch,isLoading:isLoading})=>{const _useGlobalTime=Object(use_global_time["a"])(),setQuery=_useGlobalTime.setQuery,isInitializing=_useGlobalTime.isInitializing;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isInitializing){setQuery({id:ID,inspect:inspect,loading:false,refetch:refetch})}},[setQuery,inspect,isInitializing,refetch]);const barConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getHistogramConfig(to,from),[from,to]);const subtitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isLoading?QUERY_PREVIEW_SUBTITLE_LOADING:QUERY_PREVIEW_TITLE(totalCount),[isLoading,totalCount]);const chartData=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{key:"hits",value:data}],[data]);return external_kbnSharedDeps_React_default.a.createElement(PreviewHistogram,{id:ID,data:chartData,barConfig:barConfig,title:QUERY_GRAPH_HITS_TITLE,subtitle:subtitle,disclaimer:QUERY_PREVIEW_DISCLAIMER_EQL,isLoading:isLoading,dataTestSubj:"queryPreviewEqlHistogram"})};var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(20);var hooks_translations=__webpack_require__(512);var common_=__webpack_require__(59);var kibanaUtils_common_=__webpack_require__(58);function eql_helpers_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function eql_helpers_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){eql_helpers_ownKeys(Object(source),true).forEach((function(key){eql_helpers_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{eql_helpers_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function eql_helpers_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const EQL_QUERY_EVENT_SIZE=100;const calculateBucketForHour=(eventTimestamp,relativeNow)=>{const diff=Math.abs(relativeNow-eventTimestamp);const minutes=Math.floor(diff/6e4);return Math.ceil(minutes/2)*2};const calculateBucketForDay=(eventTimestamp,relativeNow)=>{const diff=Math.abs(relativeNow-eventTimestamp);const minutes=Math.floor(diff/6e4);return Math.ceil(minutes/60)};const formatInspect=(response,indices)=>{const body=response.rawResponse.meta.request.params.body;const bodyParse=typeof body==="string"?JSON.parse(body):body;return{dsl:[JSON.stringify(eql_helpers_objectSpread(eql_helpers_objectSpread({},response.rawResponse.meta.request.params),{},{index:indices,body:bodyParse}),null,2)],response:[JSON.stringify(response.rawResponse.body,null,2)]}};const getEventsToBucket=(isSequence,response)=>{var _response$rawResponse;const hits=(_response$rawResponse=response.rawResponse.body.hits)!==null&&_response$rawResponse!==void 0?_response$rawResponse:[];if(isSequence){var _hits$sequences$map,_hits$sequences;return(_hits$sequences$map=(_hits$sequences=hits.sequences)===null||_hits$sequences===void 0?void 0:_hits$sequences.map(seq=>seq.events[seq.events.length-1]))!==null&&_hits$sequences$map!==void 0?_hits$sequences$map:[]}else{var _hits$events;return(_hits$events=hits.events)!==null&&_hits$events!==void 0?_hits$events:[]}};const getEqlAggsData=(response,range,to,refetch,indices,isSequence)=>{const _formatInspect=formatInspect(response,indices),dsl=_formatInspect.dsl,inspectResponse=_formatInspect.response;const relativeNow=Date.parse(to);const accumulator=getInterval(range,relativeNow);const events=getEventsToBucket(isSequence,response);const totalCount=response.rawResponse.body.hits.total.value;const buckets=events.reduce((acc,hit)=>{const timestamp=hit._source["@timestamp"];if(timestamp==null){return acc}const eventDate=new Date(timestamp).toISOString();const eventTimestamp=Date.parse(eventDate);const bucket=range==="h"?calculateBucketForHour(eventTimestamp,relativeNow):calculateBucketForDay(eventTimestamp,relativeNow);if(acc[bucket]!=null){acc[bucket].total+=1}return acc},accumulator);const data=Object.keys(buckets).map(key=>({x:Number(buckets[key].timestamp),y:buckets[key].total,g:"hits"}));const isAllZeros=data.every(({y:y})=>y===0);return{data:data,totalCount:isAllZeros?0:totalCount,inspect:{dsl:dsl,response:inspectResponse},refetch:refetch}};const createIntervalArray=(start,end,multiplier)=>Array(end-start+1).fill(0).map((_,idx)=>start+idx*multiplier);const getInterval=(range,relativeNow)=>{switch(range){case"h":return createIntervalArray(0,30,2).reduce((acc,int)=>eql_helpers_objectSpread(eql_helpers_objectSpread({},acc),{},{[int]:{timestamp:external_kbnSharedDeps_Moment_default()(relativeNow).subtract(int,"m").format("x"),total:0}}),{});case"d":return createIntervalArray(0,24,1).reduce((acc,int)=>eql_helpers_objectSpread(eql_helpers_objectSpread({},acc),{},{[int]:{timestamp:external_kbnSharedDeps_Moment_default()(relativeNow).subtract(int,"h").format("x"),total:0}}),{});default:throw new RangeError('Invalid time range selected. Must be "Last hour" or "Last day".')}};var parse_schedule_dates=__webpack_require__(41);function use_eql_preview_objectWithoutProperties(source,excluded){if(source==null)return{};var target=use_eql_preview_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function use_eql_preview_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function use_eql_preview_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_eql_preview_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_eql_preview_ownKeys(Object(source),true).forEach((function(key){use_eql_preview_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_eql_preview_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_eql_preview_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_eql_preview_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_eql_preview_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_eql_preview_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_eql_preview_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_eql_preview_slicedToArray(arr,i){return use_eql_preview_arrayWithHoles(arr)||use_eql_preview_iterableToArrayLimit(arr,i)||use_eql_preview_unsupportedIterableToArray(arr,i)||use_eql_preview_nonIterableRest()}function use_eql_preview_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_eql_preview_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_eql_preview_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_eql_preview_arrayLikeToArray(o,minLen)}function use_eql_preview_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_eql_preview_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_eql_preview_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useEqlPreview=()=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const unsubscribeStream=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subject"]);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=use_eql_preview_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const didCancel=Object(external_kbnSharedDeps_React_["useRef"])(false);const _useState3=Object(external_kbnSharedDeps_React_["useState"])({data:[],inspect:{dsl:[],response:[]},refetch:refetch.current,totalCount:0}),_useState4=use_eql_preview_slicedToArray(_useState3,2),response=_useState4[0],setResponse=_useState4[1];const searchEql=Object(external_kbnSharedDeps_React_["useCallback"])(({from:from,to:to,query:query,index:index,interval:interval})=>{if(Object(parse_schedule_dates["a"])(to)==null||Object(parse_schedule_dates["a"])(from)==null){notifications.toasts.addWarning("Time intervals are not defined.");return}const asyncSearch=function(){var _ref=use_eql_preview_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);setResponse(prevResponse=>use_eql_preview_objectSpread(use_eql_preview_objectSpread({},prevResponse),{},{data:[],inspect:{dsl:[],response:[]},totalCount:0}));data.search.search({params:{index:index.join(),body:{filter:{range:{"@timestamp":{gte:from,lte:to,format:"strict_date_optional_time"}}},query:query,size:100}}},{strategy:dataEnhanced_public_["EQL_SEARCH_STRATEGY"],abortSignal:abortCtrl.current.signal}).pipe(Object(external_kbnSharedDeps_RxjsOperators_["takeUntil"])(unsubscribeStream.current)).subscribe({next:res=>{if(Object(common_["isCompleteResponse"])(res)){if(!didCancel.current){setLoading(false);setResponse(prev=>{const _getEqlAggsData=getEqlAggsData(res,interval,to,refetch.current,index,Object(utils["a"])(query)),inspect=_getEqlAggsData.inspect,rest=use_eql_preview_objectWithoutProperties(_getEqlAggsData,["inspect"]);const inspectDsl=prev.inspect.dsl[0]?prev.inspect.dsl:inspect.dsl;const inspectResp=prev.inspect.response[0]?prev.inspect.response:inspect.response;return use_eql_preview_objectSpread(use_eql_preview_objectSpread(use_eql_preview_objectSpread({},prev),rest),{},{inspect:{dsl:inspectDsl,response:inspectResp}})})}unsubscribeStream.current.next()}else if(Object(common_["isPartialResponse"])(res)){setResponse(prev=>use_eql_preview_objectSpread(use_eql_preview_objectSpread({},prev),{},{inspect:formatInspect(res,index)}))}else if(Object(common_["isErrorResponse"])(res)){setLoading(false);notifications.toasts.addWarning(hooks_translations["b"]);unsubscribeStream.current.next()}},error:err=>{if(!(err instanceof kibanaUtils_common_["AbortError"])){setLoading(false);setResponse({data:[],inspect:{dsl:[],response:[]},refetch:refetch.current,totalCount:0});notifications.toasts.addError(err,{title:hooks_translations["b"]})}}});case 4:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{didCancel.current=true;abortCtrl.current.abort();unsubscribeStream.current.complete()},[]);return[loading,searchEql,response]};const threshold_histogram_ID="queryPreviewThresholdHistogramQuery";const PreviewThresholdQueryHistogram=({buckets:buckets,inspect:inspect,refetch:refetch,isLoading:isLoading})=>{const _useGlobalTime=Object(use_global_time["a"])(),setQuery=_useGlobalTime.setQuery,isInitializing=_useGlobalTime.isInitializing;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isLoading&&!isInitializing){setQuery({id:threshold_histogram_ID,inspect:inspect,loading:isLoading,refetch:refetch})}},[setQuery,inspect,isLoading,isInitializing,refetch]);const _useMemo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const total=buckets.length;const dataBuckets=buckets.map(({key:key,doc_count:docCount})=>({x:key,y:docCount,g:key}));return{data:[{key:"hits",value:dataBuckets}],totalCount:total}},[buckets]),data=_useMemo.data,totalCount=_useMemo.totalCount;const barConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getThresholdHistogramConfig(),[]);const subtitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isLoading?QUERY_PREVIEW_SUBTITLE_LOADING:QUERY_PREVIEW_THRESHOLD_WITH_FIELD_TITLE(totalCount),[isLoading,totalCount]);return external_kbnSharedDeps_React_default.a.createElement(PreviewHistogram,{id:threshold_histogram_ID,data:data,barConfig:barConfig,title:QUERY_GRAPH_HITS_TITLE,subtitle:subtitle,disclaimer:QUERY_PREVIEW_DISCLAIMER,isLoading:isLoading,dataTestSubj:"thresholdQueryPreviewHistogram"})};var super_date_picker=__webpack_require__(224);function query_preview_reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function query_preview_reducer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){query_preview_reducer_ownKeys(Object(source),true).forEach((function(key){query_preview_reducer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{query_preview_reducer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function query_preview_reducer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const queryPreviewReducer=()=>(state,action)=>{switch(action.type){case"setQueryInfo":{if(action.queryBar!=null){const _getInfoFromQueryBar=getInfoFromQueryBar(action.queryBar,action.index,action.ruleType),queryString=_getInfoFromQueryBar.queryString,language=_getInfoFromQueryBar.language,filters=_getInfoFromQueryBar.filters,queryFilter=_getInfoFromQueryBar.queryFilter;return query_preview_reducer_objectSpread(query_preview_reducer_objectSpread({},state),{},{queryString:queryString,language:language,filters:filters,queryFilter:queryFilter,showHistogram:false})}return query_preview_reducer_objectSpread(query_preview_reducer_objectSpread({},state),{},{showHistogram:false})}case"setTimeframeSelect":{return query_preview_reducer_objectSpread(query_preview_reducer_objectSpread({},state),{},{timeframe:action.timeframe,showHistogram:false,warnings:[]})}case"setResetRuleTypeChange":{const showNonEqlHist=action.ruleType==="query"||action.ruleType==="saved_query"||action.ruleType==="threshold"&&!state.thresholdFieldExists;return query_preview_reducer_objectSpread(query_preview_reducer_objectSpread({},state),{},{showHistogram:false,timeframe:"h",timeframeOptions:getTimeframeOptions(action.ruleType),showNonEqlHistogram:showNonEqlHist,warnings:[]})}case"setWarnings":{return query_preview_reducer_objectSpread(query_preview_reducer_objectSpread({},state),{},{warnings:action.warnings})}case"setShowHistogram":{return query_preview_reducer_objectSpread(query_preview_reducer_objectSpread({},state),{},{showHistogram:action.show})}case"setThresholdQueryVals":{const thresholdField=action.threshold!=null&&action.threshold.field!=null&&action.threshold.field.trim()!=="";const showNonEqlHist=action.ruleType==="query"||action.ruleType==="saved_query"||action.ruleType==="threshold"&&!thresholdField;return query_preview_reducer_objectSpread(query_preview_reducer_objectSpread({},state),{},{thresholdFieldExists:thresholdField,showNonEqlHistogram:showNonEqlHist,showHistogram:false,warnings:[]})}case"setToFrom":{return query_preview_reducer_objectSpread(query_preview_reducer_objectSpread({},state),{},{fromTime:Object(super_date_picker["c"])("now"),toTime:Object(super_date_picker["c"])("now-1".concat(state.timeframe))})}case"setNoiseWarning":{return query_preview_reducer_objectSpread(query_preview_reducer_objectSpread({},state),{},{warnings:[...state.warnings,QUERY_PREVIEW_NOISE_WARNING]})}default:return state}};const custom_histogram_ID="queryPreviewCustomHistogramQuery";const PreviewCustomQueryHistogram=({to:to,from:from,data:data,totalCount:totalCount,inspect:inspect,refetch:refetch,isLoading:isLoading})=>{const _useGlobalTime=Object(use_global_time["a"])(),setQuery=_useGlobalTime.setQuery,isInitializing=_useGlobalTime.isInitializing;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isLoading&&!isInitializing){setQuery({id:custom_histogram_ID,inspect:inspect,loading:isLoading,refetch:refetch})}},[setQuery,inspect,isLoading,isInitializing,refetch]);const barConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getHistogramConfig(to,from,true),[from,to]);const subtitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isLoading?QUERY_PREVIEW_SUBTITLE_LOADING:QUERY_PREVIEW_TITLE(totalCount),[isLoading,totalCount]);const chartData=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{key:"hits",value:data}],[data]);return external_kbnSharedDeps_React_default.a.createElement(PreviewHistogram,{id:custom_histogram_ID,data:chartData,barConfig:barConfig,title:QUERY_GRAPH_HITS_TITLE,subtitle:subtitle,disclaimer:QUERY_PREVIEW_DISCLAIMER,isLoading:isLoading,dataTestSubj:"queryPreviewCustomHistogram"})};function query_preview_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function query_preview_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){query_preview_ownKeys(Object(source),true).forEach((function(key){query_preview_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{query_preview_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function query_preview_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function query_preview_slicedToArray(arr,i){return query_preview_arrayWithHoles(arr)||query_preview_iterableToArrayLimit(arr,i)||query_preview_unsupportedIterableToArray(arr,i)||query_preview_nonIterableRest()}function query_preview_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function query_preview_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return query_preview_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return query_preview_arrayLikeToArray(o,minLen)}function query_preview_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function query_preview_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function query_preview_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const Select=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiSelect"]).withConfig({displayName:"Select",componentId:"sc-111a7av-0"})(["width:",";"],({theme:theme})=>theme.eui.euiSuperDatePickerWidth);const PreviewButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButton"]).withConfig({displayName:"PreviewButton",componentId:"sc-111a7av-1"})(["margin-left:0;"]);const query_preview_initialState={timeframeOptions:[],showHistogram:false,timeframe:"h",warnings:[],queryFilter:undefined,toTime:"",fromTime:"",queryString:"",language:"kuery",filters:[],thresholdFieldExists:false,showNonEqlHistogram:false};const PreviewQuery=({ruleType:ruleType,dataTestSubj:dataTestSubj,idAria:idAria,query:query,index:index,threshold:threshold,isDisabled:isDisabled})=>{const _useEqlPreview=useEqlPreview(),_useEqlPreview2=query_preview_slicedToArray(_useEqlPreview,3),eqlQueryLoading=_useEqlPreview2[0],startEql=_useEqlPreview2[1],_useEqlPreview2$=_useEqlPreview2[2],eqlQueryTotal=_useEqlPreview2$.totalCount,eqlQueryData=_useEqlPreview2$.data,eqlQueryRefetch=_useEqlPreview2$.refetch,eqlQueryInspect=_useEqlPreview2$.inspect;const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(queryPreviewReducer(),query_preview_objectSpread(query_preview_objectSpread({},query_preview_initialState),{},{toTime:Object(super_date_picker["c"])("now-1h"),fromTime:Object(super_date_picker["c"])("now")})),_useReducer2=query_preview_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],thresholdFieldExists=_useReducer2$.thresholdFieldExists,showNonEqlHistogram=_useReducer2$.showNonEqlHistogram,timeframeOptions=_useReducer2$.timeframeOptions,showHistogram=_useReducer2$.showHistogram,timeframe=_useReducer2$.timeframe,warnings=_useReducer2$.warnings,queryFilter=_useReducer2$.queryFilter,toTime=_useReducer2$.toTime,fromTime=_useReducer2$.fromTime,queryString=_useReducer2$.queryString,dispatch=_useReducer2[1];const _useMatrixHistogram=Object(matrix_histogram["a"])({errorMessage:QUERY_PREVIEW_ERROR,endDate:fromTime,startDate:toTime,filterQuery:queryFilter,indexNames:index,histogramType:security_solution_matrix_histogram["MatrixHistogramType"].events,stackByField:"event.category",threshold:ruleType==="threshold"?threshold:undefined,skip:true}),_useMatrixHistogram2=query_preview_slicedToArray(_useMatrixHistogram,3),isMatrixHistogramLoading=_useMatrixHistogram2[0],_useMatrixHistogram2$=_useMatrixHistogram2[1],inspect=_useMatrixHistogram2$.inspect,matrixHistTotal=_useMatrixHistogram2$.totalCount,refetch=_useMatrixHistogram2$.refetch,matrixHistoData=_useMatrixHistogram2$.data,buckets=_useMatrixHistogram2$.buckets,startNonEql=_useMatrixHistogram2[2];const setQueryInfo=Object(external_kbnSharedDeps_React_["useCallback"])((queryBar,indices,type)=>{dispatch({type:"setQueryInfo",queryBar:queryBar,index:indices,ruleType:type})},[dispatch]);const debouncedSetQueryInfo=Object(external_kbnSharedDeps_React_["useRef"])(Object(external_kbnSharedDeps_LodashFp_["debounce"])(500,setQueryInfo));const setTimeframeSelect=Object(external_kbnSharedDeps_React_["useCallback"])(selection=>{dispatch({type:"setTimeframeSelect",timeframe:selection})},[dispatch]);const setRuleTypeChange=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{dispatch({type:"setResetRuleTypeChange",ruleType:type})},[dispatch]);const setWarnings=Object(external_kbnSharedDeps_React_["useCallback"])(yikes=>{dispatch({type:"setWarnings",warnings:yikes})},[dispatch]);const setNoiseWarning=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{dispatch({type:"setNoiseWarning"})},[dispatch]);const setShowHistogram=Object(external_kbnSharedDeps_React_["useCallback"])(show=>{dispatch({type:"setShowHistogram",show:show})},[dispatch]);const setThresholdValues=Object(external_kbnSharedDeps_React_["useCallback"])((thresh,type)=>{dispatch({type:"setThresholdQueryVals",threshold:thresh,ruleType:type})},[dispatch]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{debouncedSetQueryInfo.current(query,index,ruleType)},[index,query,ruleType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setThresholdValues(threshold,ruleType)},[setThresholdValues,threshold,ruleType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setRuleTypeChange(ruleType)},[ruleType,setRuleTypeChange]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{switch(ruleType){case"eql":if(isNoisy(eqlQueryTotal,timeframe)){setNoiseWarning()}break;case"threshold":const totalHits=thresholdFieldExists?buckets.length:matrixHistTotal;if(isNoisy(totalHits,timeframe)){setNoiseWarning()}break;default:if(isNoisy(matrixHistTotal,timeframe)){setNoiseWarning()}}},[timeframe,matrixHistTotal,eqlQueryTotal,ruleType,setNoiseWarning,thresholdFieldExists,buckets.length]);const handlePreviewEqlQuery=Object(external_kbnSharedDeps_React_["useCallback"])((to,from)=>{startEql({index:index,query:queryString,from:from,to:to,interval:timeframe})},[startEql,index,queryString,timeframe]);const handleSelectPreviewTimeframe=Object(external_kbnSharedDeps_React_["useCallback"])(({target:{value:value}})=>{setTimeframeSelect(value)},[setTimeframeSelect]);const handlePreviewClicked=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const to=Object(super_date_picker["c"])("now");const from=Object(super_date_picker["c"])("now-1".concat(timeframe));setWarnings([]);setShowHistogram(true);if(ruleType==="eql"){handlePreviewEqlQuery(to,from)}else{startNonEql(to,from)}},[setWarnings,setShowHistogram,ruleType,handlePreviewEqlQuery,startNonEql,timeframe]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:QUERY_PREVIEW_LABEL,helpText:QUERY_PREVIEW_HELP_TEXT,error:undefined,isInvalid:false,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(Select,{id:"queryPreviewSelect",options:timeframeOptions,value:timeframe,onChange:handleSelectPreviewTimeframe,"aria-label":QUERY_PREVIEW_SELECT_ARIA,disabled:isDisabled,"data-test-subj":"queryPreviewTimeframeSelect"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(PreviewButton,{fill:true,isDisabled:isMatrixHistogramLoading||eqlQueryLoading||isDisabled||query==null,onClick:handlePreviewClicked,"data-test-subj":"queryPreviewButton"},QUERY_PREVIEW_BUTTON)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),showNonEqlHistogram&&showHistogram&&external_kbnSharedDeps_React_default.a.createElement(PreviewCustomQueryHistogram,{to:toTime,from:fromTime,data:matrixHistoData,totalCount:matrixHistTotal,inspect:inspect,refetch:refetch,isLoading:isMatrixHistogramLoading}),ruleType==="threshold"&&thresholdFieldExists&&showHistogram&&external_kbnSharedDeps_React_default.a.createElement(PreviewThresholdQueryHistogram,{isLoading:isMatrixHistogramLoading,buckets:buckets,inspect:inspect,refetch:refetch}),ruleType==="eql"&&showHistogram&&external_kbnSharedDeps_React_default.a.createElement(PreviewEqlQueryHistogram,{to:toTime,from:fromTime,totalCount:eqlQueryTotal,data:eqlQueryData,inspect:eqlQueryInspect,refetch:eqlQueryRefetch,isLoading:eqlQueryLoading}),showHistogram&&warnings.length>0&&warnings.map((warning,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:"".concat(warning,"-").concat(i)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"warning",iconType:"help","data-test-subj":"previewQueryWarning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,warning))))))};function step_define_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function step_define_rule_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){step_define_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){step_define_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function step_define_rule_slicedToArray(arr,i){return step_define_rule_arrayWithHoles(arr)||step_define_rule_iterableToArrayLimit(arr,i)||step_define_rule_unsupportedIterableToArray(arr,i)||step_define_rule_nonIterableRest()}function step_define_rule_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function step_define_rule_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return step_define_rule_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return step_define_rule_arrayLikeToArray(o,minLen)}function step_define_rule_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function step_define_rule_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function step_define_rule_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function step_define_rule_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function step_define_rule_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){step_define_rule_ownKeys(Object(source),true).forEach((function(key){step_define_rule_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{step_define_rule_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function step_define_rule_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const step_define_rule_CommonUseField=Object(shared_imports["y"])({component:shared_imports["d"]});const stepDefineDefaultValue={anomalyThreshold:50,index:[],machineLearningJobId:"",ruleType:"query",threatIndex:[],queryBar:{query:{query:"",language:"kuery"},filters:[],saved_id:undefined},threatQueryBar:{query:{query:"*:*",language:"kuery"},filters:[],saved_id:undefined},threatMapping:[],threshold:{field:[],value:"200"},timeline:{id:null,title:timeline_translations["b"]}};const threatQueryBarDefaultValue=step_define_rule_objectSpread(step_define_rule_objectSpread({},stepDefineDefaultValue.queryBar),{},{query:step_define_rule_objectSpread(step_define_rule_objectSpread({},stepDefineDefaultValue.queryBar.query),{},{query:"*:*"})});const MyLabelButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"]).withConfig({displayName:"MyLabelButton",componentId:"f0vskm-0"})(["height:18px;font-size:12px;.euiIcon{width:14px;height:14px;}"]);MyLabelButton.defaultProps={flush:"right"};const RuleTypeEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).attrs(({$isVisible:$isVisible})=>({style:{display:$isVisible?"flex":"none"}})).withConfig({displayName:"RuleTypeEuiFormRow",componentId:"f0vskm-1"})([""]);const StepDefineRuleComponent=({addPadding:addPadding=false,defaultValues:defaultValues,descriptionColumns:descriptionColumns="singleSplit",isReadOnlyView:isReadOnlyView,isLoading:isLoading,isUpdateView:isUpdateView=false,onSubmit:onSubmit,setForm:setForm})=>{const mlCapabilities=Object(use_ml_capabilities["a"])();const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=step_define_rule_slicedToArray(_useState,2),openTimelineSearch=_useState2[0],setOpenTimelineSearch=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=step_define_rule_slicedToArray(_useState3,2),indexModified=_useState4[0],setIndexModified=_useState4[1];const _useUiSetting$=Object(lib_kibana["l"])(constants["u"]),_useUiSetting$2=step_define_rule_slicedToArray(_useUiSetting$,1),indicesConfig=_useUiSetting$2[0];const initialState=defaultValues!==null&&defaultValues!==void 0?defaultValues:step_define_rule_objectSpread(step_define_rule_objectSpread({},stepDefineDefaultValue),{},{index:indicesConfig});const _useForm=Object(shared_imports["H"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:schema_schema}),form=_useForm.form;const getFields=form.getFields,getFormData=form.getFormData,reset=form.reset,submit=form.submit;const _useFormData=Object(shared_imports["J"])({form:form,watch:["index","ruleType","queryBar","threshold.value","threshold.field","threatIndex"]}),_useFormData2=step_define_rule_slicedToArray(_useFormData,1),_useFormData2$=_useFormData2[0],formIndex=_useFormData2$.index,formRuleType=_useFormData2$.ruleType,formQuery=_useFormData2$.queryBar,formThreatIndex=_useFormData2$.threatIndex,formThresholdValue=_useFormData2$["threshold.value"],formThresholdField=_useFormData2$["threshold.field"];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=step_define_rule_slicedToArray(_useState5,2),isQueryBarValid=_useState6[0],setIsQueryBarValid=_useState6[1];const index=formIndex||initialState.index;const threatIndex=formThreatIndex||initialState.threatIndex;const ruleType=formRuleType||initialState.ruleType;const queryBarQuery=formQuery!=null?formQuery.query.query:false||initialState.queryBar.query.query;const _useFetchIndex=Object(source["b"])(index),_useFetchIndex2=step_define_rule_slicedToArray(_useFetchIndex,2),indexPatternsLoading=_useFetchIndex2[0],_useFetchIndex2$=_useFetchIndex2[1],browserFields=_useFetchIndex2$.browserFields,indexPatterns=_useFetchIndex2$.indexPatterns;const _useFetchIndex3=Object(source["b"])(threatIndex),_useFetchIndex4=step_define_rule_slicedToArray(_useFetchIndex3,2),threatIndexPatternsLoading=_useFetchIndex4[0],_useFetchIndex4$=_useFetchIndex4[1],threatBrowserFields=_useFetchIndex4$.browserFields,threatIndexPatterns=_useFetchIndex4$.indexPatterns;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{reset({resetValues:false})},[reset,ruleType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setIndexModified(!isEqual_default()(index,indicesConfig))},[index,indicesConfig]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const _getFields=getFields(),queryBar=_getFields.queryBar;if(queryBar!=null){const defaultQueryBar=stepDefineDefaultValue.queryBar;if(Object(utils["e"])(ruleType)&&queryBar.value===defaultQueryBar){queryBar.reset({defaultValue:threatQueryBarDefaultValue})}else if(queryBar.value===threatQueryBarDefaultValue){queryBar.reset({defaultValue:defaultQueryBar})}}},[ruleType,getFields]);const handleSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(onSubmit){onSubmit()}},[onSubmit]);const getData=Object(external_kbnSharedDeps_React_["useCallback"])(step_define_rule_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return submit();case 2:result=_context.sent;return _context.abrupt("return",result.isValid?result:{isValid:false,data:getFormData()});case 4:case"end":return _context.stop()}}),_callee)}))),[getFormData,submit]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let didCancel=false;if(setForm&&!didCancel){setForm(rules_types["a"].defineRule,getData)}return()=>{didCancel=true}},[getData,setForm]);const handleResetIndices=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const indexField=getFields().index;indexField.setValue(indicesConfig)},[getFields,indicesConfig]);const handleOpenTimelineSearch=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setOpenTimelineSearch(true)},[]);const handleCloseTimelineSearch=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setOpenTimelineSearch(false)},[]);const thresholdFormValue=Object(external_kbnSharedDeps_React_["useMemo"])(()=>formThresholdValue!=null&&formThresholdField!=null?{value:formThresholdValue,field:formThresholdField[0]}:undefined,[formThresholdField,formThresholdValue]);const ThresholdInputChildren=Object(external_kbnSharedDeps_React_["useCallback"])(({thresholdField:thresholdField,thresholdValue:thresholdValue})=>external_kbnSharedDeps_React_default.a.createElement(ThresholdInput,{browserFields:browserFields,thresholdField:thresholdField,thresholdValue:thresholdValue}),[browserFields]);const ThreatMatchInputChildren=Object(external_kbnSharedDeps_React_["useCallback"])(({threatMapping:threatMapping})=>external_kbnSharedDeps_React_default.a.createElement(ThreatMatchInput,{threatBrowserFields:threatBrowserFields,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,threatMapping:threatMapping,threatIndexPatternsLoading:threatIndexPatternsLoading}),[threatBrowserFields,threatIndexPatternsLoading,threatIndexPatterns,indexPatterns]);return isReadOnlyView?external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{"data-test-subj":"definitionRule",addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{columns:descriptionColumns,indexPatterns:indexPatterns,schema:filterRuleFieldsForType(schema_schema,ruleType),data:filterRuleFieldsForType(initialState,ruleType)})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form,"data-test-subj":"stepDefineRule"},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"ruleType",component:SelectRuleType,componentProps:{describedByIds:["detectionEngineStepDefineRuleType"],isUpdateView:isUpdateView,hasValidLicense:Object(has_ml_license["a"])(mlCapabilities),isMlAdmin:Object(has_ml_admin_permissions["a"])(mlCapabilities)}}),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:!Object(helpers["d"])(ruleType),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(step_define_rule_CommonUseField,{path:"index",config:step_define_rule_objectSpread(step_define_rule_objectSpread({},schema_schema.index),{},{labelAppend:indexModified?external_kbnSharedDeps_React_default.a.createElement(MyLabelButton,{onClick:handleResetIndices,iconType:"refresh"},RESET_DEFAULT_INDEX):null}),componentProps:{idAria:"detectionEngineStepDefineRuleIndices","data-test-subj":"detectionEngineStepDefineRuleIndices",euiFieldProps:{fullWidth:true,isDisabled:isLoading,placeholder:""}}}),Object(utils["c"])(ruleType)?external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{key:"EqlQueryBar",path:"queryBar",component:EqlQueryBar,componentProps:{onValidityChange:setIsQueryBarValid,idAria:"detectionEngineStepDefineRuleEqlQueryBar",isDisabled:isLoading,isLoading:indexPatternsLoading,dataTestSubj:"detectionEngineStepDefineRuleEqlQueryBar"},config:step_define_rule_objectSpread(step_define_rule_objectSpread({},schema_schema.queryBar),{},{label:EQL_QUERY_BAR_LABEL})}):external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{key:"QueryBarDefineRule",path:"queryBar",config:step_define_rule_objectSpread(step_define_rule_objectSpread({},schema_schema.queryBar),{},{label:QUERY_BAR_LABEL,labelAppend:external_kbnSharedDeps_React_default.a.createElement(MyLabelButton,{"data-test-subj":"importQueryFromSavedTimeline",onClick:handleOpenTimelineSearch},IMPORT_TIMELINE_QUERY)}),component:QueryBarDefineRule,componentProps:{browserFields:browserFields,idAria:"detectionEngineStepDefineRuleQueryBar",indexPattern:indexPatterns,isDisabled:isLoading,isLoading:indexPatternsLoading,dataTestSubj:"detectionEngineStepDefineRuleQueryBar",openTimelineSearch:openTimelineSearch,onValidityChange:setIsQueryBarValid,onCloseTimelineSearch:handleCloseTimelineSearch}}))),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:Object(helpers["d"])(ruleType),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"machineLearningJobId",component:MlJobSelect,componentProps:{describedByIds:["detectionEngineStepDefineRulemachineLearningJobId"]}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"anomalyThreshold",component:AnomalyThresholdSlider,componentProps:{describedByIds:["detectionEngineStepDefineRuleAnomalyThreshold"]}}))),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:Object(utils["f"])(ruleType),"data-test-subj":"thresholdInput",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["k"],{fields:{thresholdField:{path:"threshold.field"},thresholdValue:{path:"threshold.value"}}},ThresholdInputChildren))),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:Object(utils["e"])(ruleType),"data-test-subj":"threatMatchInput",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["k"],{fields:{threatMapping:{path:"threatMapping"}}},ThreatMatchInputChildren))),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"timeline",component:PickTimeline,componentProps:{idAria:"detectionEngineStepDefineRuleTimeline",isDisabled:isLoading,dataTestSubj:"detectionEngineStepDefineRuleTimeline"}})),ruleType!=="machine_learning"&&ruleType!=="threat_match"&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(PreviewQuery,{dataTestSubj:"ruleCreationQueryPreview",idAria:"ruleCreationQueryPreview",ruleType:ruleType,index:index,query:formQuery,isDisabled:queryBarQuery.trim()===""||!isQueryBarValid||index.length===0,threshold:thresholdFormValue}))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(NextStep,{dataTestSubj:"define-continue",onClick:handleSubmit,isDisabled:isLoading}))};const StepDefineRule=Object(external_kbnSharedDeps_React_["memo"])(StepDefineRuleComponent);function add_item_form_extends(){add_item_form_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return add_item_form_extends.apply(this,arguments)}function add_item_form_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function add_item_form_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){add_item_form_ownKeys(Object(source),true).forEach((function(key){add_item_form_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{add_item_form_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function add_item_form_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function add_item_form_slicedToArray(arr,i){return add_item_form_arrayWithHoles(arr)||add_item_form_iterableToArrayLimit(arr,i)||add_item_form_unsupportedIterableToArray(arr,i)||add_item_form_nonIterableRest()}function add_item_form_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function add_item_form_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return add_item_form_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return add_item_form_arrayLikeToArray(o,minLen)}function add_item_form_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function add_item_form_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function add_item_form_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const MyEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).withConfig({displayName:"MyEuiFormRow",componentId:"sc-1urlknr-0"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]);const MyAddItemButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"]).withConfig({displayName:"MyAddItemButton",componentId:"sc-1urlknr-1"})(["margin-top:4px;&.euiButtonEmpty--xSmall{font-size:12px;}.euiIcon{width:12px;height:12px;}"]);MyAddItemButton.defaultProps={flush:"left",iconType:"plusInCircle",size:"xs"};const AddItem=({addText:addText,dataTestSubj:dataTestSubj,field:field,idAria:idAria,isDisabled:isDisabled,validate:validate})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=add_item_form_slicedToArray(_useState,2),showValidation=_useState2[0],setShowValidation=_useState2[1];const _getFieldValidityAndE=Object(shared_imports["x"])(field),isInvalid=_getFieldValidityAndE.isInvalid,errorMessage=_getFieldValidityAndE.errorMessage;const _useState3=Object(external_kbnSharedDeps_React_["useState"])(-1),_useState4=add_item_form_slicedToArray(_useState3,2),haveBeenKeyboardDeleted=_useState4[0],setHaveBeenKeyboardDeleted=_useState4[1];const inputsRef=Object(external_kbnSharedDeps_React_["useRef"])([]);const removeItem=Object(external_kbnSharedDeps_React_["useCallback"])(index=>{const values=field.value;const newValues=[...values.slice(0,index),...values.slice(index+1)];field.setValue(newValues.length===0?[""]:newValues);inputsRef.current=[...inputsRef.current.slice(0,index),...inputsRef.current.slice(index+1)];inputsRef.current=inputsRef.current.map((ref,i)=>{if(i>=index&&inputsRef.current[index]!=null){ref.value="re-render"}return ref})},[field]);const addItem=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const values=field.value;field.setValue([...values,""])},[field]);const updateItem=Object(external_kbnSharedDeps_React_["useCallback"])((event,index)=>{event.persist();const values=field.value;const value=event.target.value;field.setValue([...values.slice(0,index),value,...values.slice(index+1)])},[field]);const handleLastInputRef=Object(external_kbnSharedDeps_React_["useCallback"])((index,element)=>{if(element!=null){inputsRef.current=[...inputsRef.current.slice(0,index),element,...inputsRef.current.slice(index+1)]}},[inputsRef]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(haveBeenKeyboardDeleted!==-1&&!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(inputsRef.current)&&inputsRef.current[haveBeenKeyboardDeleted]!=null){inputsRef.current[haveBeenKeyboardDeleted].focus();setHaveBeenKeyboardDeleted(-1)}},[haveBeenKeyboardDeleted,inputsRef.current]);const values=field.value;return external_kbnSharedDeps_React_default.a.createElement(MyEuiFormRow,{label:field.label,labelAppend:field.labelAppend,error:showValidation?errorMessage:null,isInvalid:showValidation&&isInvalid,fullWidth:true,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,values.map((item,index)=>{const euiFieldProps=add_item_form_objectSpread(add_item_form_objectSpread({disabled:isDisabled},index===values.length-1?{inputRef:handleLastInputRef.bind(null,index)}:{}),{},{value:item,isInvalid:validate==null?false:showValidation&&validate(item)});return external_kbnSharedDeps_React_default.a.createElement("div",{key:index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],add_item_form_extends({onBlur:()=>setShowValidation(true),onChange:e=>updateItem(e,index),fullWidth:true},euiFieldProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{color:"danger",iconType:"trash",isDisabled:isDisabled||Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(item)&&values.length===1,onClick:()=>removeItem(index),"aria-label":rules_translations["K"]}))),values.length-1!==index&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}))}),external_kbnSharedDeps_React_default.a.createElement(MyAddItemButton,{onClick:addItem,isDisabled:isDisabled},addText)))};const threatDefault=[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}];const stepAboutDefaultValue={author:[],name:"",description:"",isAssociatedToEndpointList:false,isBuildingBlock:false,severity:{value:"low",mapping:fillEmptySeverityMappings([]),isMappingChecked:false},riskScore:{value:21,mapping:[],isMappingChecked:false},references:[""],falsePositives:[""],license:"",ruleNameOverride:"",tags:[],timestampOverride:"",threat:threatDefault,note:""};const isMitreAttackInvalid=(tacticName,technique)=>{if(Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(tacticName)||tacticName!=="none"&&Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(technique)){return true}return false};const TACTIC=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticsDescription",{defaultMessage:"tactic"});const TECHNIQUE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquesDescription",{defaultMessage:"techniques"});const ADD_MITRE_ATTACK=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.addTitle",{defaultMessage:"Add MITRE ATT&CK\\u2122 threat"});const TECHNIQUES_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquesPlaceHolderDescription",{defaultMessage:"Select techniques ..."});const TACTIC_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticPlaceHolderDescription",{defaultMessage:"Select tactic ..."});function mitre_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function mitre_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){mitre_ownKeys(Object(source),true).forEach((function(key){mitre_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{mitre_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function mitre_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function mitre_slicedToArray(arr,i){return mitre_arrayWithHoles(arr)||mitre_iterableToArrayLimit(arr,i)||mitre_unsupportedIterableToArray(arr,i)||mitre_nonIterableRest()}function mitre_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mitre_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return mitre_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mitre_arrayLikeToArray(o,minLen)}function mitre_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function mitre_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function mitre_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const MitreContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MitreContainer",componentId:"bsl0gv-0"})(["margin-top:16px;"]);const MyEuiSuperSelect=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"]).withConfig({displayName:"MyEuiSuperSelect",componentId:"bsl0gv-1"})(["width:280px;"]);const AddMitreThreat=({field:field,idAria:idAria,isDisabled:isDisabled})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=mitre_slicedToArray(_useState,2),showValidation=_useState2[0],setShowValidation=_useState2[1];const _getFieldValidityAndE=Object(shared_imports["x"])(field),isInvalid=_getFieldValidityAndE.isInvalid,errorMessage=_getFieldValidityAndE.errorMessage;const removeItem=Object(external_kbnSharedDeps_React_["useCallback"])(index=>{const values=field.value;const newValues=[...values.slice(0,index),...values.slice(index+1)];if(Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(newValues)){field.setValue(threatDefault)}else{field.setValue(newValues)}},[field]);const addItem=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const values=field.value;if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(values[values.length-1])){field.setValue([...values,{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])}else{field.setValue([{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])}},[field]);const updateTactic=Object(external_kbnSharedDeps_React_["useCallback"])((index,value)=>{const values=field.value;const _ref=tacticsOptions.find(t=>t.value===value)||{id:"",name:"",reference:""},id=_ref.id,reference=_ref.reference,name=_ref.name;field.setValue([...values.slice(0,index),mitre_objectSpread(mitre_objectSpread({},values[index]),{},{tactic:{id:id,reference:reference,name:name},technique:[]}),...values.slice(index+1)])},[field]);const updateTechniques=Object(external_kbnSharedDeps_React_["useCallback"])((index,selectedOptions)=>{field.setValue([...values.slice(0,index),mitre_objectSpread(mitre_objectSpread({},values[index]),{},{technique:selectedOptions}),...values.slice(index+1)])},[field]);const values=field.value;const getSelectTactic=(tacticName,index,disabled)=>external_kbnSharedDeps_React_default.a.createElement(MyEuiSuperSelect,{id:"selectDocExample",options:[...tacticName==="none"?[{inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,TACTIC_PLACEHOLDER),value:"none",disabled:disabled}]:[],...tacticsOptions.map(t=>({inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,t.text),value:t.value,disabled:disabled}))],"aria-label":"",onChange:updateTactic.bind(null,index),fullWidth:false,valueOfSelected:Object(external_kbnSharedDeps_LodashFp_["camelCase"])(tacticName),"data-test-subj":"mitreTactic"});const getSelectTechniques=(item,index,disabled)=>{const invalid=isMitreAttackInvalid(item.tactic.name,item.technique);const options=techniquesOptions.filter(t=>t.tactics.includes(Object(external_kbnSharedDeps_LodashFp_["kebabCase"])(item.tactic.name)));const selectedOptions=item.technique.map(technic=>mitre_objectSpread(mitre_objectSpread({},technic),{},{label:"".concat(technic.name," (").concat(technic.id,")")}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{"data-test-subj":"mitreTechniques",placeholder:item.tactic.name==="none"?"":TECHNIQUES_PLACEHOLDER,options:options,selectedOptions:selectedOptions,onChange:updateTechniques.bind(null,index),isDisabled:disabled||item.tactic.name==="none",fullWidth:true,isInvalid:showValidation&&invalid,onBlur:()=>setShowValidation(true)}),showValidation&&invalid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"danger",size:"xs"},external_kbnSharedDeps_React_default.a.createElement("p",null,errorMessage))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{color:"danger",iconType:"trash",isDisabled:disabled||item.tactic.name==="none",onClick:()=>removeItem(index),"aria-label":rules_translations["K"]})))};return external_kbnSharedDeps_React_default.a.createElement(MitreContainer,null,values.map((item,index)=>external_kbnSharedDeps_React_default.a.createElement("div",{key:index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},index===0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:"".concat(field.label," ").concat(TACTIC),labelAppend:field.labelAppend,describedByIds:idAria?["".concat(idAria," ").concat(TACTIC)]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,getSelectTactic(item.tactic.name,index,isDisabled))):getSelectTactic(item.tactic.name,index,isDisabled)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},index===0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:"".concat(field.label," ").concat(TECHNIQUE),isInvalid:showValidation&&isInvalid,fullWidth:true,describedByIds:idAria?["".concat(idAria," ").concat(TECHNIQUE)]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,getSelectTechniques(item,index,isDisabled))):getSelectTechniques(item,index,isDisabled))),values.length-1!==index&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}))),external_kbnSharedDeps_React_default.a.createElement(MyAddItemButton,{"data-test-subj":"addMitre",onClick:addItem,isDisabled:isDisabled},ADD_MITRE_ATTACK))};var validators=__webpack_require__(322);const OptionalFieldLabel=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},rules_translations["fb"]);const emptyField=shared_imports["w"].emptyField;const step_about_rule_schema_schema={author:{type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:OptionalFieldLabel},name:{type:shared_imports["c"].TEXT,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:shared_imports["c"].TEXTAREA,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:shared_imports["c"].CHECKBOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:OptionalFieldLabel},isAssociatedToEndpointList:{type:shared_imports["c"].CHECKBOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:OptionalFieldLabel},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:OptionalFieldLabel,validations:[{validator:(...args)=>{const _args$=args[0],value=_args$.value,path=_args$.path;let hasError=false;value.forEach(url=>{if(Object(validators["a"])(url)){hasError=true}});return hasError?{code:"ERR_FIELD_FORMAT",path:path,message:URL_FORMAT_INVALID}:undefined}}]},falsePositives:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:OptionalFieldLabel},license:{type:shared_imports["c"].TEXT,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:OptionalFieldLabel},ruleNameOverride:{type:shared_imports["c"].TEXT,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:OptionalFieldLabel},threat:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),labelAppend:OptionalFieldLabel,validations:[{validator:(...args)=>{const _args$2=args[0],value=_args$2.value,path=_args$2.path;let hasError=false;value.forEach(v=>{if(isMitreAttackInvalid(v.tactic.name,v.technique)){hasError=true}});return hasError?{code:"ERR_FIELD_MISSING",path:path,message:CUSTOM_MITRE_ATTACK_TECHNIQUES_REQUIRED}:undefined}}]},timestampOverride:{type:shared_imports["c"].TEXT,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:OptionalFieldLabel},tags:{type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:OptionalFieldLabel},note:{type:shared_imports["c"].TEXTAREA,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:OptionalFieldLabel}};var eui_form=__webpack_require__(251);var field_value_match=__webpack_require__(620);function severity_mapping_slicedToArray(arr,i){return severity_mapping_arrayWithHoles(arr)||severity_mapping_iterableToArrayLimit(arr,i)||severity_mapping_unsupportedIterableToArray(arr,i)||severity_mapping_nonIterableRest()}function severity_mapping_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function severity_mapping_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return severity_mapping_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return severity_mapping_arrayLikeToArray(o,minLen)}function severity_mapping_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function severity_mapping_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function severity_mapping_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function severity_mapping_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function severity_mapping_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){severity_mapping_ownKeys(Object(source),true).forEach((function(key){severity_mapping_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{severity_mapping_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function severity_mapping_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const NestedContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1o9f6e3-0"})(["margin-left:24px;"]);const EuiFlexItemComboBoxColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1o9f6e3-1"})(["max-width:376px;"]);const EuiFlexItemIconColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1o9f6e3-2"})(["width:20px;"]);const EuiFlexItemSeverityColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemSeverityColumn",componentId:"sc-1o9f6e3-3"})(["width:80px;"]);const SeverityField=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,indices:indices,isDisabled:isDisabled,options:options})=>{const setValue=field.setValue;const _ref=field.value,value=_ref.value,isMappingChecked=_ref.isMappingChecked,mapping=_ref.mapping;const handleFieldValueChange=Object(external_kbnSharedDeps_React_["useCallback"])((newMappingItems,index)=>{setValue({value:value,isMappingChecked:isMappingChecked,mapping:[...mapping.slice(0,index),...newMappingItems,...mapping.slice(index+1)]})},[value,isMappingChecked,mapping,setValue]);const handleFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])((index,severity,[newField])=>{var _newField$name;const newMappingItems=[severity_mapping_objectSpread(severity_mapping_objectSpread({},mapping[index]),{},{field:(_newField$name=newField===null||newField===void 0?void 0:newField.name)!==null&&_newField$name!==void 0?_newField$name:"",value:newField!=null?mapping[index].value:"",operator:"equals",severity:severity})];handleFieldValueChange(newMappingItems,index)},[mapping,handleFieldValueChange]);const handleSecurityLevelChange=Object(external_kbnSharedDeps_React_["useCallback"])(newValue=>{setValue({value:newValue,isMappingChecked:isMappingChecked,mapping:mapping})},[isMappingChecked,mapping,setValue]);const handleFieldMatchValueChange=Object(external_kbnSharedDeps_React_["useCallback"])((index,severity,newMatchValue)=>{const newMappingItems=[severity_mapping_objectSpread(severity_mapping_objectSpread({},mapping[index]),{},{field:mapping[index].field,value:mapping[index].field!=null&&mapping[index].field!==""?newMatchValue:"",operator:"equals",severity:severity})];handleFieldValueChange(newMappingItems,index)},[mapping,handleFieldValueChange]);const getIFieldTypeFromFieldName=(fieldName,iIndexPattern)=>{const _iIndexPattern$fields=iIndexPattern.fields.filter(({name:name})=>fieldName===name),_iIndexPattern$fields2=severity_mapping_slicedToArray(_iIndexPattern$fields,1),iFieldType=_iIndexPattern$fields2[0];return iFieldType};const handleSeverityMappingChecked=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setValue({value:value,mapping:[...mapping],isMappingChecked:!isMappingChecked})},[isMappingChecked,mapping,value,setValue]);const severityLabel=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,SEVERITY)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},SEVERITY_DESCRIPTION)),[]);const severityMappingLabel=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",onClick:!isDisabled?handleSeverityMappingChecked:external_kbnSharedDeps_LodashFp_["noop"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{id:"severity-mapping-override",checked:isMappingChecked,disabled:isDisabled,onChange:handleSeverityMappingChecked})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,SEVERITY_MAPPING)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},SEVERITY_MAPPING_DESCRIPTION))),[handleSeverityMappingChecked,isDisabled,isMappingChecked]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:severityLabel,labelAppend:field.labelAppend,helpText:field.helpText,error:"errorMessage",isInvalid:false,fullWidth:true,"data-test-subj":"detectionEngineStepAboutRuleSeverity",describedByIds:["detectionEngineStepAboutRuleSeverity"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{fullWidth:false,disabled:false,valueOfSelected:value,onChange:handleSecurityLevelChange,options:options,"data-test-subj":"select"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:severityMappingLabel,labelAppend:field.labelAppend,helpText:isMappingChecked?external_kbnSharedDeps_React_default.a.createElement(NestedContent,null,SEVERITY_MAPPING_DETAILS):"",error:"errorMessage",isInvalid:false,fullWidth:true,"data-test-subj":"".concat(dataTestSubj,"-severityOverride"),describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),isMappingChecked&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,SOURCE_FIELD)),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,SOURCE_VALUE)),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemIconColumn,{grow:false}),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemSeverityColumn,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,DEFAULT_SEVERITY)))),mapping.map((severityMappingItem,index)=>{var _options$find;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:"".concat(severityMappingItem.severity,"-").concat(index)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":"severityOverrideRow",alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(autocomplete_field["a"],{placeholder:"",selectedField:getIFieldTypeFromFieldName(severityMappingItem.field,indices),isLoading:false,isDisabled:isDisabled,isClearable:false,indexPattern:indices,onChange:handleFieldChange.bind(null,index,severityMappingItem.severity),"data-test-subj":"detectionEngineStepAboutRuleSeverityMappingField-".concat(severityMappingItem.severity,"-").concat(index),"aria-label":"detectionEngineStepAboutRuleSeverityMappingField-".concat(severityMappingItem.severity,"-").concat(index)})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(field_value_match["a"],{placeholder:"",selectedField:getIFieldTypeFromFieldName(severityMappingItem.field,indices),selectedValue:severityMappingItem.value,isClearable:false,isDisabled:isDisabled,isLoading:false,indexPattern:indices,onChange:handleFieldMatchValueChange.bind(null,index,severityMappingItem.severity),"data-test-subj":"detectionEngineStepAboutRuleSeverityMappingValue-".concat(severityMappingItem.severity,"-").concat(index),"aria-label":"detectionEngineStepAboutRuleSeverityMappingValue-".concat(severityMappingItem.severity,"-").concat(index)})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemIconColumn,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemSeverityColumn,{grow:false},(_options$find=options.find(o=>o.value===severityMappingItem.severity))===null||_options$find===void 0?void 0:_options$find.inputDisplay)))}))))))};function risk_score_mapping_slicedToArray(arr,i){return risk_score_mapping_arrayWithHoles(arr)||risk_score_mapping_iterableToArrayLimit(arr,i)||risk_score_mapping_unsupportedIterableToArray(arr,i)||risk_score_mapping_nonIterableRest()}function risk_score_mapping_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function risk_score_mapping_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return risk_score_mapping_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return risk_score_mapping_arrayLikeToArray(o,minLen)}function risk_score_mapping_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function risk_score_mapping_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function risk_score_mapping_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const risk_score_mapping_NestedContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1k1nimg-0"})(["margin-left:24px;"]);const risk_score_mapping_EuiFlexItemComboBoxColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1k1nimg-1"})(["max-width:376px;"]);const risk_score_mapping_EuiFlexItemIconColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1k1nimg-2"})(["width:20px;"]);const EuiFlexItemRiskScoreColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemRiskScoreColumn",componentId:"sc-1k1nimg-3"})(["width:160px;"]);const RiskScoreField=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,indices:indices,isDisabled:isDisabled,placeholder:placeholder})=>{const fieldTypeFilter=Object(external_kbnSharedDeps_React_["useMemo"])(()=>["number"],[]);const fieldValue=field.value,setValue=field.setValue;const handleFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(([newField])=>{var _newField$name;const values=fieldValue;setValue({value:values.value,isMappingChecked:values.isMappingChecked,mapping:[{field:(_newField$name=newField===null||newField===void 0?void 0:newField.name)!==null&&_newField$name!==void 0?_newField$name:"",operator:"equals",value:"",riskScore:undefined}]})},[setValue,fieldValue]);const handleRangeFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const range=e.target.value;setValue({value:range.trim()===""?"":+range,isMappingChecked:fieldValue.isMappingChecked,mapping:fieldValue.mapping})},[fieldValue,setValue]);const selectedField=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _mapping$0$field,_mapping,_mapping$;const existingField=(_mapping$0$field=(_mapping=fieldValue.mapping)===null||_mapping===void 0?void 0:(_mapping$=_mapping[0])===null||_mapping$===void 0?void 0:_mapping$.field)!==null&&_mapping$0$field!==void 0?_mapping$0$field:"";const _indices$fields$filte=indices.fields.filter(({name:name})=>existingField!=null&&existingField===name),_indices$fields$filte2=risk_score_mapping_slicedToArray(_indices$fields$filte,1),newSelectedField=_indices$fields$filte2[0];return newSelectedField},[fieldValue,indices]);const handleRiskScoreMappingChecked=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const values=fieldValue;setValue({value:values.value,mapping:[...values.mapping],isMappingChecked:!values.isMappingChecked})},[fieldValue,setValue]);const riskScoreLabel=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,DEFAULT_RISK_SCORE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},RISK_SCORE_DESCRIPTION)),[]);const riskScoreMappingLabel=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",onClick:!isDisabled?handleRiskScoreMappingChecked:external_kbnSharedDeps_LodashFp_["noop"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{id:"risk_score-mapping-override",checked:fieldValue.isMappingChecked,disabled:isDisabled,onChange:handleRiskScoreMappingChecked})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,RISK_SCORE_MAPPING)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},RISK_SCORE_MAPPING_DESCRIPTION))),[fieldValue,handleRiskScoreMappingChecked,isDisabled]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:riskScoreLabel,labelAppend:field.labelAppend,helpText:field.helpText,error:"errorMessage",isInvalid:false,fullWidth:true,"data-test-subj":"detectionEngineStepAboutRuleRiskScore",describedByIds:["detectionEngineStepAboutRuleRiskScore"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRange"],{value:fieldValue.value,onChange:handleRangeFieldChange,max:100,min:0,showRange:true,showInput:true,fullWidth:false,showTicks:true,tickInterval:25,"data-test-subj":"range"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:riskScoreMappingLabel,labelAppend:field.labelAppend,helpText:fieldValue.isMappingChecked?external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_NestedContent,null,RISK_SCORE_MAPPING_DETAILS):"",error:"errorMessage",isInvalid:false,fullWidth:true,"data-test-subj":"".concat(dataTestSubj,"-riskOverride"),describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),fieldValue.isMappingChecked&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,translations_SOURCE_FIELD)),external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemIconColumn,{grow:false}),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemRiskScoreColumn,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,DEFAULT_RISK_SCORE)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(autocomplete_field["a"],{placeholder:placeholder!==null&&placeholder!==void 0?placeholder:"",indexPattern:indices,selectedField:selectedField,fieldTypeFilter:fieldTypeFilter,isLoading:false,isClearable:false,isDisabled:isDisabled,onChange:handleFieldChange,"data-test-subj":dataTestSubj,"aria-label":idAria})),external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemIconColumn,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemRiskScoreColumn,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},RISK_SCORE_FIELD)))))))))};function autocomplete_field_slicedToArray(arr,i){return autocomplete_field_arrayWithHoles(arr)||autocomplete_field_iterableToArrayLimit(arr,i)||autocomplete_field_unsupportedIterableToArray(arr,i)||autocomplete_field_nonIterableRest()}function autocomplete_field_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function autocomplete_field_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return autocomplete_field_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return autocomplete_field_arrayLikeToArray(o,minLen)}function autocomplete_field_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function autocomplete_field_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function autocomplete_field_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AutocompleteField=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,indices:indices,isDisabled:isDisabled,fieldType:fieldType,placeholder:placeholder})=>{const handleFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(([newField])=>{var _newField$name;field.setValue((_newField$name=newField===null||newField===void 0?void 0:newField.name)!==null&&_newField$name!==void 0?_newField$name:"")},[field]);const selectedField=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _ref;const existingField=(_ref=field.value)!==null&&_ref!==void 0?_ref:"";const _indices$fields$filte=indices.fields.filter(({name:name})=>existingField!=null&&existingField===name),_indices$fields$filte2=autocomplete_field_slicedToArray(_indices$fields$filte,1),newSelectedField=_indices$fields$filte2[0];return newSelectedField},[field.value,indices]);const fieldTypeFilter=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[fieldType],[fieldType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined,fullWidth:true,helpText:field.helpText,label:field.label,labelAppend:field.labelAppend},external_kbnSharedDeps_React_default.a.createElement(autocomplete_field["a"],{placeholder:placeholder!==null&&placeholder!==void 0?placeholder:"",indexPattern:indices,selectedField:selectedField,fieldTypeFilter:fieldTypeFilter,isLoading:false,isDisabled:isDisabled,isClearable:false,onChange:handleFieldChange,"data-test-subj":dataTestSubj,"aria-label":idAria,fieldInputWidth:500}))};function step_about_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function step_about_rule_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){step_about_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){step_about_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function step_about_rule_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function step_about_rule_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){step_about_rule_ownKeys(Object(source),true).forEach((function(key){step_about_rule_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{step_about_rule_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function step_about_rule_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function step_about_rule_slicedToArray(arr,i){return step_about_rule_arrayWithHoles(arr)||step_about_rule_iterableToArrayLimit(arr,i)||step_about_rule_unsupportedIterableToArray(arr,i)||step_about_rule_nonIterableRest()}function step_about_rule_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function step_about_rule_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return step_about_rule_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return step_about_rule_arrayLikeToArray(o,minLen)}function step_about_rule_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function step_about_rule_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function step_about_rule_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const step_about_rule_CommonUseField=Object(shared_imports["y"])({component:shared_imports["d"]});const ThreeQuartersContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ThreeQuartersContainer",componentId:"sc-1nsr0kk-0"})(["max-width:740px;"]);ThreeQuartersContainer.displayName="ThreeQuartersContainer";const TagContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"TagContainer",componentId:"sc-1nsr0kk-1"})(["margin-top:16px;"]);TagContainer.displayName="TagContainer";const StepAboutRuleComponent=({addPadding:addPadding=false,defaultValues:defaultValues,defineRuleData:defineRuleData,descriptionColumns:descriptionColumns="singleSplit",isReadOnlyView:isReadOnlyView,isUpdateView:isUpdateView=false,isLoading:isLoading,onSubmit:onSubmit,setForm:setForm})=>{var _defineRuleData$index;const initialState=defaultValues!==null&&defaultValues!==void 0?defaultValues:stepAboutDefaultValue;const _useState=Object(external_kbnSharedDeps_React_["useState"])(initialState.severity.value),_useState2=step_about_rule_slicedToArray(_useState,2),severityValue=_useState2[0],setSeverityValue=_useState2[1];const _useFetchIndex=Object(source["b"])((_defineRuleData$index=defineRuleData===null||defineRuleData===void 0?void 0:defineRuleData.index)!==null&&_defineRuleData$index!==void 0?_defineRuleData$index:[]),_useFetchIndex2=step_about_rule_slicedToArray(_useFetchIndex,2),indexPatternLoading=_useFetchIndex2[0],indexPatterns=_useFetchIndex2[1].indexPatterns;const canUseExceptions=(defineRuleData===null||defineRuleData===void 0?void 0:defineRuleData.ruleType)&&!Object(helpers["d"])(defineRuleData.ruleType)&&!Object(utils["f"])(defineRuleData.ruleType);const _useForm=Object(shared_imports["H"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:step_about_rule_schema_schema}),form=_useForm.form;const getFields=form.getFields,getFormData=form.getFormData,submit=form.submit;const _useFormData=Object(shared_imports["J"])({form:form,watch:["severity"]}),_useFormData2=step_about_rule_slicedToArray(_useFormData,1),formSeverity=_useFormData2[0].severity;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const formSeverityValue=formSeverity===null||formSeverity===void 0?void 0:formSeverity.value;if(formSeverityValue!=null&&formSeverityValue!==severityValue){setSeverityValue(formSeverityValue);const newRiskScoreValue=defaultRiskScoreBySeverity[formSeverityValue];if(newRiskScoreValue!=null){const riskScoreField=getFields().riskScore;riskScoreField.setValue(step_about_rule_objectSpread(step_about_rule_objectSpread({},riskScoreField.value),{},{value:newRiskScoreValue}))}}},[formSeverity===null||formSeverity===void 0?void 0:formSeverity.value,getFields,severityValue]);const getData=Object(external_kbnSharedDeps_React_["useCallback"])(step_about_rule_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return submit();case 2:result=_context.sent;return _context.abrupt("return",(result===null||result===void 0?void 0:result.isValid)?result:{isValid:false,data:getFormData()});case 4:case"end":return _context.stop()}}),_callee)}))),[getFormData,submit]);const handleSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(onSubmit){onSubmit()}},[onSubmit]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let didCancel=false;if(setForm&&!didCancel){setForm(rules_types["a"].aboutRule,getData)}return()=>{didCancel=true}},[getData,setForm]);return isReadOnlyView?external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{"data-test-subj":"aboutStep",addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{columns:descriptionColumns,schema:step_about_rule_schema_schema,data:initialState})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form},external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"name",componentProps:{idAria:"detectionEngineStepAboutRuleName","data-test-subj":"detectionEngineStepAboutRuleName",euiFieldProps:{fullWidth:true,disabled:isLoading}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"description",componentProps:{idAria:"detectionEngineStepAboutRuleDescription","data-test-subj":"detectionEngineStepAboutRuleDescription",euiFieldProps:{disabled:isLoading,compressed:true,fullWidth:true}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"severity",component:SeverityField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleSeverityField",idAria:"detectionEngineStepAboutRuleSeverityField",isDisabled:isLoading||indexPatternLoading,options:severityOptions,indices:indexPatterns}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"riskScore",component:RiskScoreField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRiskScore",idAria:"detectionEngineStepAboutRuleRiskScore",isDisabled:isLoading||indexPatternLoading,indices:indexPatterns}})),external_kbnSharedDeps_React_default.a.createElement(TagContainer,null,external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"tags",componentProps:{idAria:"detectionEngineStepAboutRuleTags","data-test-subj":"detectionEngineStepAboutRuleTags",euiFieldProps:{fullWidth:true,isDisabled:isLoading||indexPatternLoading,placeholder:""}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{"data-test-subj":"advancedSettings",id:"advancedSettingsAccordion",buttonContent:ADVANCED_SETTINGS},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"references",component:AddItem,componentProps:{addText:ADD_REFERENCE,idAria:"detectionEngineStepAboutRuleReferenceUrls",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleReferenceUrls",validate:validators["a"]}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"falsePositives",component:AddItem,componentProps:{addText:ADD_FALSE_POSITIVE,idAria:"detectionEngineStepAboutRuleFalsePositives",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleFalsePositives"}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"threat",component:AddMitreThreat,componentProps:{idAria:"detectionEngineStepAboutRuleMitreThreat",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleMitreThreat"}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"note",component:eui_form["a"],componentProps:{idAria:"detectionEngineStepAboutRuleNote",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleNote",placeholder:ADD_RULE_NOTE_HELP_TEXT}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"author",componentProps:{idAria:"detectionEngineStepAboutRuleAuthor","data-test-subj":"detectionEngineStepAboutRuleAuthor",euiFieldProps:{fullWidth:true,isDisabled:isLoading,placeholder:""}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"license",componentProps:{idAria:"detectionEngineStepAboutRuleLicense","data-test-subj":"detectionEngineStepAboutRuleLicense",euiFieldProps:{fullWidth:true,disabled:isLoading,placeholder:""}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:GLOBAL_ENDPOINT_EXCEPTION_LIST,fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"isAssociatedToEndpointList",componentProps:{idAria:"detectionEngineStepAboutRuleAssociatedToEndpointList","data-test-subj":"detectionEngineStepAboutRuleAssociatedToEndpointList",euiFieldProps:{disabled:isLoading||!canUseExceptions}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:BUILDING_BLOCK,fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"isBuildingBlock",componentProps:{idAria:"detectionEngineStepAboutRuleBuildingBlock","data-test-subj":"detectionEngineStepAboutRuleBuildingBlock",euiFieldProps:{disabled:isLoading}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"ruleNameOverride",component:AutocompleteField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRuleNameOverride",fieldType:"string",idAria:"detectionEngineStepAboutRuleRuleNameOverride",indices:indexPatterns,isDisabled:isLoading||indexPatternLoading,placeholder:""}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"timestampOverride",component:AutocompleteField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleTimestampOverride",fieldType:"date",idAria:"detectionEngineStepAboutRuleTimestampOverride",indices:indexPatterns,isDisabled:isLoading||indexPatternLoading,placeholder:""}})))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(NextStep,{dataTestSubj:"about-continue",onClick:handleSubmit,isDisabled:isLoading}))};const StepAboutRule=Object(external_kbnSharedDeps_React_["memo"])(StepAboutRuleComponent);const SECONDS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.secondsOptionDescription",{defaultMessage:"Seconds"});const MINUTES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.minutesOptionDescription",{defaultMessage:"Minutes"});const HOURS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.hoursOptionDescription",{defaultMessage:"Hours"});const INVALID_TIME=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.invalidTimeMessageDescription",{defaultMessage:"A time is required."});function schedule_item_form_extends(){schedule_item_form_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return schedule_item_form_extends.apply(this,arguments)}function schedule_item_form_slicedToArray(arr,i){return schedule_item_form_arrayWithHoles(arr)||schedule_item_form_iterableToArrayLimit(arr,i)||schedule_item_form_unsupportedIterableToArray(arr,i)||schedule_item_form_nonIterableRest()}function schedule_item_form_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function schedule_item_form_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return schedule_item_form_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return schedule_item_form_arrayLikeToArray(o,minLen)}function schedule_item_form_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function schedule_item_form_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function schedule_item_form_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const timeTypeOptions=[{value:"s",text:SECONDS},{value:"m",text:MINUTES},{value:"h",text:HOURS}];const StyledLabelAppend=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"StyledLabelAppend",componentId:"d3i8n6-0"})(["&.euiFlexItem.euiFlexItem--flexGrowZero{margin-left:31px;}"]);const schedule_item_form_StyledEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).withConfig({displayName:"StyledEuiFormRow",componentId:"d3i8n6-1"})(["max-width:none;.euiFormControlLayout{max-width:200px !important;}.euiFormControlLayout__childrenWrapper > *:first-child{box-shadow:none;height:38px;}.euiFormControlLayout:not(:first-child){border-left:1px solid ",";}"],({theme:theme})=>theme.eui.euiColorLightShade);const MyEuiSelect=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiSelect"]).withConfig({displayName:"MyEuiSelect",componentId:"d3i8n6-2"})(["width:auto;"]);const getNumberFromUserInput=(input,defaultValue=0)=>{const number=parseInt(input,10);if(Number.isNaN(number)){return defaultValue}else{return Math.min(number,Number.MAX_SAFE_INTEGER)}};const ScheduleItem=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,isDisabled:isDisabled,minimumValue:minimumValue=0})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])("s"),_useState2=schedule_item_form_slicedToArray(_useState,2),timeType=_useState2[0],setTimeType=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(0),_useState4=schedule_item_form_slicedToArray(_useState3,2),timeVal=_useState4[0],setTimeVal=_useState4[1];const _getFieldValidityAndE=Object(shared_imports["x"])(field),isInvalid=_getFieldValidityAndE.isInvalid,errorMessage=_getFieldValidityAndE.errorMessage;const value=field.value,setValue=field.setValue;const onChangeTimeType=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{setTimeType(e.target.value);setValue("".concat(timeVal).concat(e.target.value))},[setValue,timeVal]);const onChangeTimeVal=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const sanitizedValue=getNumberFromUserInput(e.target.value,minimumValue);setTimeVal(sanitizedValue);setValue("".concat(sanitizedValue).concat(timeType))},[minimumValue,setValue,timeType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(value!=="".concat(timeVal).concat(timeType)){const filterTimeVal=value.match(/\d+/g);const filterTimeType=value.match(/[a-zA-Z]+/g);if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(filterTimeVal)&&filterTimeVal!=null&&!isNaN(Number(filterTimeVal[0]))&&Number(filterTimeVal[0])!==Number(timeVal)){setTimeVal(Number(filterTimeVal[0]))}if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(filterTimeType)&&filterTimeType!=null&&["s","m","h"].includes(filterTimeType[0])&&filterTimeType[0]!==timeType){setTimeType(filterTimeType[0])}}},[timeType,timeVal,value]);const rest={disabled:isDisabled};const label=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,component:"span"},field.label),external_kbnSharedDeps_React_default.a.createElement(StyledLabelAppend,{grow:false,component:"span"},field.labelAppend)),[field.label,field.labelAppend]);return external_kbnSharedDeps_React_default.a.createElement(schedule_item_form_StyledEuiFormRow,{label:label,helpText:field.helpText,error:errorMessage,isInvalid:isInvalid,fullWidth:false,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormControlLayout"],{append:external_kbnSharedDeps_React_default.a.createElement(MyEuiSelect,schedule_item_form_extends({fullWidth:false,options:timeTypeOptions,onChange:onChangeTimeType,value:timeType,"data-test-subj":"timeType"},rest))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],schedule_item_form_extends({fullWidth:true,min:minimumValue,max:Number.MAX_SAFE_INTEGER,onChange:onChangeTimeVal,value:timeVal,"data-test-subj":"interval"},rest))))};const step_schedule_rule_schema_schema={interval:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),labelAppend:OptionalFieldLabel,helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}};function step_schedule_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function step_schedule_rule_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){step_schedule_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){step_schedule_rule_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const stepScheduleDefaultValue={interval:"5m",from:"1m"};const StepScheduleRuleComponent=({addPadding:addPadding=false,defaultValues:defaultValues,descriptionColumns:descriptionColumns="singleSplit",isReadOnlyView:isReadOnlyView,isLoading:isLoading,isUpdateView:isUpdateView=false,onSubmit:onSubmit,setForm:setForm})=>{const initialState=defaultValues!==null&&defaultValues!==void 0?defaultValues:stepScheduleDefaultValue;const _useForm=Object(shared_imports["H"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:step_schedule_rule_schema_schema}),form=_useForm.form;const getFormData=form.getFormData,submit=form.submit;const handleSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(onSubmit){onSubmit()}},[onSubmit]);const getData=Object(external_kbnSharedDeps_React_["useCallback"])(step_schedule_rule_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return submit();case 2:result=_context.sent;return _context.abrupt("return",(result===null||result===void 0?void 0:result.isValid)?result:{isValid:false,data:getFormData()});case 4:case"end":return _context.stop()}}),_callee)}))),[getFormData,submit]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let didCancel=false;if(setForm&&!didCancel){setForm(rules_types["a"].scheduleRule,getData)}return()=>{didCancel=true}},[getData,setForm]);return isReadOnlyView?external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{columns:descriptionColumns,schema:step_schedule_rule_schema_schema,data:initialState})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form,"data-test-subj":"stepScheduleRule"},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"interval",component:ScheduleItem,componentProps:{idAria:"detectionEngineStepScheduleRuleInterval",isDisabled:isLoading,dataTestSubj:"detectionEngineStepScheduleRuleInterval"}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"from",component:ScheduleItem,componentProps:{idAria:"detectionEngineStepScheduleRuleFrom",isDisabled:isLoading,dataTestSubj:"detectionEngineStepScheduleRuleFrom",minimumValue:1}}))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(NextStep,{dataTestSubj:"schedule-continue",onClick:handleSubmit,isDisabled:isLoading}))};const StepScheduleRule=Object(external_kbnSharedDeps_React_["memo"])(StepScheduleRuleComponent);var react_markdown=__webpack_require__(1010);var react_markdown_default=__webpack_require__.n(react_markdown);var triggersActionsUi_public_=__webpack_require__(76);const FORM_ERRORS_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"});function rule_actions_field_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function rule_actions_field_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){rule_actions_field_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){rule_actions_field_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function rule_actions_field_slicedToArray(arr,i){return rule_actions_field_arrayWithHoles(arr)||rule_actions_field_iterableToArrayLimit(arr,i)||rule_actions_field_unsupportedIterableToArray(arr,i)||rule_actions_field_nonIterableRest()}function rule_actions_field_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rule_actions_field_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return rule_actions_field_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rule_actions_field_arrayLikeToArray(o,minLen)}function rule_actions_field_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function rule_actions_field_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function rule_actions_field_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const DEFAULT_ACTION_GROUP_ID="default";const DEFAULT_ACTION_MESSAGE="Rule {{context.rule.name}} generated {{state.signals_count}} alerts";const FieldErrorsContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-1brsijn-0"})(["p{margin-bottom:0;}"]);const RuleActionsField=({field:field,messageVariables:messageVariables})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=rule_actions_field_slicedToArray(_useState,2),fieldErrors=_useState2[0],setFieldErrors=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=rule_actions_field_slicedToArray(_useState3,2),supportedActionTypes=_useState4[0],setSupportedActionTypes=_useState4[1];const form=Object(shared_imports["I"])();const isSubmitted=form.isSubmitted,isSubmitting=form.isSubmitting,isValid=form.isValid;const _useKibana$services=Object(lib_kibana["h"])().services,http=_useKibana$services.http,actionTypeRegistry=_useKibana$services.triggersActionsUi.actionTypeRegistry;const actions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(field.value)?field.value:[],[field.value]);const setActionIdByIndex=Object(external_kbnSharedDeps_React_["useCallback"])((id,index)=>{const updatedActions=[...actions];updatedActions[index]=cjs_default()(updatedActions[index],{id:id});field.setValue(updatedActions)},[field.setValue,actions]);const setAlertProperty=Object(external_kbnSharedDeps_React_["useCallback"])(updatedActions=>field.setValue(updatedActions),[field]);const setActionParamsProperty=Object(external_kbnSharedDeps_React_["useCallback"])((key,value,index)=>{const updatedActions=[...actions];updatedActions[index].params[key]=value;field.setValue(updatedActions)},[field.setValue,actions]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{rule_actions_field_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var actionTypes,supportedTypes;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return Object(triggersActionsUi_public_["loadActionTypes"])({http:http});case 2:actionTypes=_context.sent;supportedTypes=actionTypes.filter(actionType=>constants["W"].includes(actionType.id));setSupportedActionTypes(supportedTypes);case 5:case"end":return _context.stop()}}),_callee)})))()},[]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isSubmitting||!field.errors.length){return setFieldErrors(null)}if(isSubmitted&&!isSubmitting&&isValid===false&&field.errors.length){const errorsString=field.errors.map(({message:message})=>message).join("\n");return setFieldErrors(errorsString)}},[isSubmitted,isSubmitting,field.isChangingValue,isValid,field.errors,setFieldErrors]);if(!supportedActionTypes)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,fieldErrors?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FieldErrorsContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:FORM_ERRORS_TITLE,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(react_markdown_default.a,{source:fieldErrors}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)):null,external_kbnSharedDeps_React_default.a.createElement(triggersActionsUi_public_["ActionForm"],{actions:actions,messageVariables:messageVariables,defaultActionGroupId:DEFAULT_ACTION_GROUP_ID,setActionIdByIndex:setActionIdByIndex,setAlertProperty:setAlertProperty,setActionParamsProperty:setActionParamsProperty,actionTypeRegistry:actionTypeRegistry,actionTypes:supportedActionTypes,defaultActionMessage:DEFAULT_ACTION_MESSAGE}))};const COMPLETE_WITHOUT_ACTIVATING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithoutActivatingTitle",{defaultMessage:"Create rule without activating it"});const COMPLETE_WITH_ACTIVATING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithActivatingTitle",{defaultMessage:"Create & activate rule"});const NO_CONNECTOR_SELECTED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noConnectorSelectedErrorMessage",{defaultMessage:"No connector selected"});const NO_ACTIONS_READ_PERMISSIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'});const INVALID_MUSTACHE_TEMPLATE=paramKey=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(external_kbnSharedDeps_LodashFp_["startCase"])(paramKey)}});var mustache=__webpack_require__(1089);var mustache_default=__webpack_require__.n(mustache);const UUID_V4_REGEX=/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i;const isUuidv4=id=>!!id.match(UUID_V4_REGEX);const utils_getActionTypeName=actionTypeId=>{if(!actionTypeId)return"";const actionType=actionTypeId.split(".")[1];if(!actionType)return"";return Object(external_kbnSharedDeps_LodashFp_["startCase"])(actionType)};const validateMustache=params=>{const errors=[];Object.entries(params).forEach(([paramKey,paramValue])=>{if(!Object(external_kbnSharedDeps_LodashFp_["isString"])(paramValue))return;try{mustache_default.a.render(paramValue,{})}catch(e){errors.push(INVALID_MUSTACHE_TEMPLATE(paramKey))}});return errors};const validateActionParams=(actionItem,actionTypeRegistry)=>{var _actionTypeRegistry$g;const actionErrors=(_actionTypeRegistry$g=actionTypeRegistry.get(actionItem.actionTypeId))===null||_actionTypeRegistry$g===void 0?void 0:_actionTypeRegistry$g.validateParams(actionItem.params);if(actionErrors){const actionErrorsValues=Object.values(actionErrors.errors);if(actionErrorsValues.length){const filteredObjects=actionErrorsValues.filter(item=>Object(external_kbnSharedDeps_LodashFp_["isString"])(item)||Object(external_kbnSharedDeps_LodashFp_["isArray"])(item));const uniqActionErrors=Object(external_kbnSharedDeps_LodashFp_["uniq"])(Object(external_kbnSharedDeps_LodashFp_["flattenDeep"])(filteredObjects));if(uniqActionErrors.length){return uniqActionErrors}}}return[]};function schema_slicedToArray(arr,i){return schema_arrayWithHoles(arr)||schema_iterableToArrayLimit(arr,i)||schema_unsupportedIterableToArray(arr,i)||schema_nonIterableRest()}function schema_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function schema_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return schema_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return schema_arrayLikeToArray(o,minLen)}function schema_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function schema_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function schema_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const validateSingleAction=(actionItem,actionTypeRegistry)=>{if(!isUuidv4(actionItem.id)){return[NO_CONNECTOR_SELECTED]}const actionParamsErrors=validateActionParams(actionItem,actionTypeRegistry);const mustacheErrors=validateMustache(actionItem.params);return[...actionParamsErrors,...mustacheErrors]};const validateRuleActionsField=actionTypeRegistry=>(...data)=>{const _ref=data,_ref2=schema_slicedToArray(_ref,1),_ref2$=_ref2[0],value=_ref2$.value,path=_ref2$.path;const errors=value.reduce((acc,actionItem)=>{const errorsArray=validateSingleAction(actionItem,actionTypeRegistry);if(errorsArray.length){const actionTypeName=utils_getActionTypeName(actionItem.actionTypeId);const errorsListItems=errorsArray.map(error=>"*   ".concat(error,"\n"));return[...acc,"\n**".concat(actionTypeName,":**\n").concat(errorsListItems.join(""))]}return acc},[]);if(errors.length){return{code:"ERR_FIELD_FORMAT",path:path,message:"".concat(errors.join("\n"))}}};const getSchema=({actionTypeRegistry:actionTypeRegistry})=>({actions:{validations:[{validator:validateRuleActionsField(actionTypeRegistry)}]},enabled:{},kibanaSiemAppUrl:{},throttle:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleLabel",{defaultMessage:"Actions frequency"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."})}});function step_rule_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function step_rule_actions_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){step_rule_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){step_rule_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function step_rule_actions_slicedToArray(arr,i){return step_rule_actions_arrayWithHoles(arr)||step_rule_actions_iterableToArrayLimit(arr,i)||step_rule_actions_unsupportedIterableToArray(arr,i)||step_rule_actions_nonIterableRest()}function step_rule_actions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function step_rule_actions_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return step_rule_actions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return step_rule_actions_arrayLikeToArray(o,minLen)}function step_rule_actions_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function step_rule_actions_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function step_rule_actions_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function step_rule_actions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function step_rule_actions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){step_rule_actions_ownKeys(Object(source),true).forEach((function(key){step_rule_actions_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{step_rule_actions_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function step_rule_actions_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const stepActionsDefaultValue={enabled:true,actions:[],kibanaSiemAppUrl:"",throttle:DEFAULT_THROTTLE_OPTION.value};const GhostFormField=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null);const getThrottleOptions=throttle=>{if(throttle&&Object(external_kbnSharedDeps_LodashFp_["findIndex"])(["value",throttle],THROTTLE_OPTIONS)<0){return[...THROTTLE_OPTIONS,{value:throttle,text:throttle}]}return THROTTLE_OPTIONS};const StepRuleActionsComponent=({addPadding:addPadding=false,defaultValues:defaultValues,isReadOnlyView:isReadOnlyView,isLoading:isLoading,isUpdateView:isUpdateView=false,onSubmit:onSubmit,setForm:setForm,actionMessageParams:actionMessageParams})=>{const _useKibana=Object(lib_kibana["h"])(),_useKibana$services=_useKibana.services,application=_useKibana$services.application,actionTypeRegistry=_useKibana$services.triggersActionsUi.actionTypeRegistry;const kibanaAbsoluteUrl=Object(external_kbnSharedDeps_React_["useMemo"])(()=>application.getUrlForApp("".concat(constants["f"]),{absolute:true}),[application]);const initialState=step_rule_actions_objectSpread(step_rule_actions_objectSpread({},defaultValues!==null&&defaultValues!==void 0?defaultValues:stepActionsDefaultValue),{},{kibanaSiemAppUrl:kibanaAbsoluteUrl});const schema=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getSchema({actionTypeRegistry:actionTypeRegistry}),[actionTypeRegistry]);const _useForm=Object(shared_imports["H"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:schema}),form=_useForm.form;const getFields=form.getFields,getFormData=form.getFormData,submit=form.submit;const _useFormData=Object(shared_imports["J"])({form:form,watch:["throttle"]}),_useFormData2=step_rule_actions_slicedToArray(_useFormData,1),formThrottle=_useFormData2[0].throttle;const throttle=formThrottle||initialState.throttle;const handleSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(enabled=>{getFields().enabled.setValue(enabled);if(onSubmit){onSubmit()}},[getFields,onSubmit]);const getData=Object(external_kbnSharedDeps_React_["useCallback"])(step_rule_actions_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return submit();case 2:result=_context.sent;return _context.abrupt("return",(result===null||result===void 0?void 0:result.isValid)?result:{isValid:false,data:getFormData()});case 4:case"end":return _context.stop()}}),_callee)}))),[getFormData,submit]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let didCancel=false;if(setForm&&!didCancel){setForm(rules_types["a"].ruleActions,getData)}return()=>{didCancel=true}},[getData,setForm]);const throttleOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getThrottleOptions(throttle),[throttle]);const throttleFieldComponentProps=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({idAria:"detectionEngineStepRuleActionsThrottle",isDisabled:isLoading,dataTestSubj:"detectionEngineStepRuleActionsThrottle",hasNoInitialSelection:false,euiFieldProps:{options:throttleOptions}}),[isLoading,throttleOptions]);const displayActionsOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>throttle!==stepActionsDefaultValue.throttle?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"actions",component:RuleActionsField,componentProps:{messageVariables:actionMessageParams}})):external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"actions",component:GhostFormField}),[throttle,actionMessageParams]);const displayActionsDropDown=Object(external_kbnSharedDeps_React_["useMemo"])(()=>application.capabilities.actions.show?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"throttle",component:ThrottleSelectField,componentProps:throttleFieldComponentProps}),displayActionsOptions,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"kibanaSiemAppUrl",component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"enabled",component:GhostFormField})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,NO_ACTIONS_READ_PERMISSIONS),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"throttle",componentProps:throttleFieldComponentProps,component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"actions",component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"kibanaSiemAppUrl",component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"enabled",component:GhostFormField})),[application.capabilities.actions.show,displayActionsOptions,throttleFieldComponentProps]);if(isReadOnlyView){return external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{schema:schema,data:initialState,columns:"single"}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form,"data-test-subj":"stepRuleActions"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,displayActionsDropDown))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:false,isDisabled:isLoading,isLoading:isLoading,onClick:()=>handleSubmit(false)},COMPLETE_WITHOUT_ACTIVATING)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,isDisabled:isLoading,isLoading:isLoading,onClick:()=>handleSubmit(true),"data-test-subj":"create-activate"},COMPLETE_WITH_ACTIVATING)))))};const StepRuleActions=Object(external_kbnSharedDeps_React_["memo"])(StepRuleActionsComponent);var header_page=__webpack_require__(162);function detection_engine_header_page_extends(){detection_engine_header_page_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return detection_engine_header_page_extends.apply(this,arguments)}const DetectionEngineHeaderPageComponent=props=>external_kbnSharedDeps_React_default.a.createElement(header_page["a"],detection_engine_header_page_extends({hideSourcerer:true},props));const DetectionEngineHeaderPage=external_kbnSharedDeps_React_default.a.memo(DetectionEngineHeaderPageComponent);DetectionEngineHeaderPage.displayName="DetectionEngineHeaderPage";const PAGE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.pageTitle",{defaultMessage:"Create new rule"});const BACK_TO_RULES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.backToRulesDescription",{defaultMessage:"Back to detection rules"});const EDIT_RULE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.editRuleButton",{defaultMessage:"Edit"});const SUCCESSFULLY_CREATED_RULES=ruleName=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.create.successfullyCreatedRuleTitle",{values:{ruleName:ruleName},defaultMessage:"{ruleName} was created"});var app_types=__webpack_require__(2);var rules_utils=__webpack_require__(427);function create_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function create_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){create_ownKeys(Object(source),true).forEach((function(key){create_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{create_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function create_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function create_slicedToArray(arr,i){return create_arrayWithHoles(arr)||create_iterableToArrayLimit(arr,i)||create_unsupportedIterableToArray(arr,i)||create_nonIterableRest()}function create_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function create_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return create_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return create_arrayLikeToArray(o,minLen)}function create_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function create_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function create_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function create_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function create_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){create_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){create_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const formHookNoop=function(){var _ref=create_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",undefined);case 1:case"end":return _context.stop()}}),_callee)})));return function formHookNoop(){return _ref.apply(this,arguments)}}();const MyEuiPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"MyEuiPanel",componentId:"wzrzmg-0"})(["position:relative;z-index:",";> .euiAccordion > .euiAccordion__triggerWrapper{.euiAccordion__button{cursor:default !important;&:hover{text-decoration:none !important;}}.euiAccordion__iconWrapper{display:none;}}"],props=>props.zindex);MyEuiPanel.displayName="MyEuiPanel";const StepDefineRuleAccordion=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiAccordion"]).withConfig({displayName:"StepDefineRuleAccordion",componentId:"wzrzmg-1"})([".euiAccordion__childWrapper{overflow:visible;}"]);StepDefineRuleAccordion.displayName="StepDefineRuleAccordion";const CreateRulePageComponent=()=>{var _stepsData$current$Ru,_stepsData$current$Ru2;const _useUserData=Object(user_info["b"])(),_useUserData2=create_slicedToArray(_useUserData,1),_useUserData2$=_useUserData2[0],userInfoLoading=_useUserData2$.loading,isSignalIndexExists=_useUserData2$.isSignalIndexExists,isAuthenticated=_useUserData2$.isAuthenticated,hasEncryptionKey=_useUserData2$.hasEncryptionKey,canUserCRUD=_useUserData2$.canUserCRUD;const _useListsConfig=useListsConfig(),listsConfigLoading=_useListsConfig.loading,needsListsConfiguration=_useListsConfig.needsConfiguration;const loading=userInfoLoading||listsConfigLoading;const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=create_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const _useState=Object(external_kbnSharedDeps_React_["useState"])(rules_types["a"].defineRule),_useState2=create_slicedToArray(_useState,2),activeStep=_useState2[0],setActiveStep=_useState2[1];const getNextStep=step=>rules_utils["b"][rules_utils["b"].indexOf(step)+1];const defineRuleRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const aboutRuleRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const scheduleRuleRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const ruleActionsRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const formHooks=Object(external_kbnSharedDeps_React_["useRef"])({[rules_types["a"].defineRule]:formHookNoop,[rules_types["a"].aboutRule]:formHookNoop,[rules_types["a"].scheduleRule]:formHookNoop,[rules_types["a"].ruleActions]:formHookNoop});const setFormHook=Object(external_kbnSharedDeps_React_["useCallback"])((step,hook)=>{formHooks.current[step]=hook},[]);const stepsData=Object(external_kbnSharedDeps_React_["useRef"])({[rules_types["a"].defineRule]:{isValid:false,data:undefined},[rules_types["a"].aboutRule]:{isValid:false,data:undefined},[rules_types["a"].scheduleRule]:{isValid:false,data:undefined},[rules_types["a"].ruleActions]:{isValid:false,data:undefined}});const setStepData=(step,data)=>{stepsData.current[step]=data};const _useState3=Object(external_kbnSharedDeps_React_["useState"])({[rules_types["a"].defineRule]:false,[rules_types["a"].aboutRule]:false,[rules_types["a"].scheduleRule]:false,[rules_types["a"].ruleActions]:false}),_useState4=create_slicedToArray(_useState3,2),openSteps=_useState4[0],setOpenSteps=_useState4[1];const _useCreateRule=useCreateRule(),_useCreateRule2=create_slicedToArray(_useCreateRule,2),_useCreateRule2$=_useCreateRule2[0],isLoading=_useCreateRule2$.isLoading,isSaved=_useCreateRule2$.isSaved,setRule=_useCreateRule2[1];const ruleType=(_stepsData$current$Ru=stepsData.current[rules_types["a"].defineRule].data)===null||_stepsData$current$Ru===void 0?void 0:_stepsData$current$Ru.ruleType;const ruleName=(_stepsData$current$Ru2=stepsData.current[rules_types["a"].aboutRule].data)===null||_stepsData$current$Ru2===void 0?void 0:_stepsData$current$Ru2.name;const actionMessageParams=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getActionMessageParams(ruleType),[ruleType]);const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const handleAccordionToggle=Object(external_kbnSharedDeps_React_["useCallback"])((step,isOpen)=>setOpenSteps(_openSteps=>create_objectSpread(create_objectSpread({},_openSteps),{},{[step]:isOpen})),[]);const goToStep=Object(external_kbnSharedDeps_React_["useCallback"])(step=>{if(rules_utils["b"].indexOf(step)>rules_utils["b"].indexOf(activeStep)&&!openSteps[step]){toggleStepAccordion(step)}setActiveStep(step)},[activeStep,openSteps]);const toggleStepAccordion=step=>{if(step===rules_types["a"].defineRule){var _defineRuleRef$curren;(_defineRuleRef$curren=defineRuleRef.current)===null||_defineRuleRef$curren===void 0?void 0:_defineRuleRef$curren.onToggle()}else if(step===rules_types["a"].aboutRule){var _aboutRuleRef$current;(_aboutRuleRef$current=aboutRuleRef.current)===null||_aboutRuleRef$current===void 0?void 0:_aboutRuleRef$current.onToggle()}else if(step===rules_types["a"].scheduleRule){var _scheduleRuleRef$curr;(_scheduleRuleRef$curr=scheduleRuleRef.current)===null||_scheduleRuleRef$curr===void 0?void 0:_scheduleRuleRef$curr.onToggle()}else if(step===rules_types["a"].ruleActions){var _ruleActionsRef$curre;(_ruleActionsRef$curre=ruleActionsRef.current)===null||_ruleActionsRef$curre===void 0?void 0:_ruleActionsRef$curre.onToggle()}};const editStep=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref2=create_asyncToGenerator(regeneratorRuntime.mark((function _callee2(step){var activeStepData;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return formHooks.current[activeStep]();case 2:activeStepData=_context2.sent;if(activeStepData===null||activeStepData===void 0?void 0:activeStepData.isValid){setStepData(activeStep,activeStepData);goToStep(step)}case 4:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref2.apply(this,arguments)}}(),[activeStep,goToStep]);const submitStep=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref3=create_asyncToGenerator(regeneratorRuntime.mark((function _callee3(step){var stepData,nextStep,defineStep,aboutStep,scheduleStep,actionsStep;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return formHooks.current[step]();case 2:stepData=_context3.sent;if(stepData===null||stepData===void 0?void 0:stepData.isValid){setStepData(step,stepData);nextStep=getNextStep(step);if(nextStep!=null){goToStep(nextStep)}else{defineStep=stepsData.current[rules_types["a"].defineRule];aboutStep=stepsData.current[rules_types["a"].aboutRule];scheduleStep=stepsData.current[rules_types["a"].scheduleRule];actionsStep=stepsData.current[rules_types["a"].ruleActions];if(stepIsValid(defineStep)&&stepIsValid(aboutStep)&&stepIsValid(scheduleStep)&&stepIsValid(actionsStep)){setRule(formatRule(defineStep.data,aboutStep.data,scheduleStep.data,actionsStep.data))}}}case 4:case"end":return _context3.stop()}}),_callee3)})));return function(_x2){return _ref3.apply(this,arguments)}}(),[goToStep,setRule]);const getAccordionType=Object(external_kbnSharedDeps_React_["useCallback"])(step=>{if(step===activeStep){return"active"}else if(stepsData.current[step].isValid){return"valid"}return"passive"},[activeStep]);const defineRuleButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"1",title:rules_translations["I"],type:getAccordionType(rules_types["a"].defineRule)});const aboutRuleButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"2",title:rules_translations["b"],type:getAccordionType(rules_types["a"].aboutRule)});const scheduleRuleButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"3",title:rules_translations["rb"],type:getAccordionType(rules_types["a"].scheduleRule)});const ruleActionsButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"4",title:rules_translations["pb"],type:getAccordionType(rules_types["a"].ruleActions)});if(isSaved&&ruleName){Object(toasters["e"])(SUCCESSFULLY_CREATED_RULES(ruleName),dispatchToaster);history.replace(Object(redirect_to_detection_engine["f"])());return null}if(redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)){history.replace(Object(redirect_to_detection_engine["c"])());return null}else if(helpers_userHasNoPermissions(canUserCRUD)){history.replace(Object(redirect_to_detection_engine["f"])());return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(MaxWidthEuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine["f"])(),text:BACK_TO_RULES,pageId:app_types["a"].detections},border:true,isLoading:isLoading||loading,title:PAGE_TITLE}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:4},external_kbnSharedDeps_React_default.a.createElement(StepDefineRuleAccordion,{initialIsOpen:true,id:rules_types["a"].defineRule,buttonContent:defineRuleButton,paddingSize:"xs",ref:defineRuleRef,onToggle:handleAccordionToggle.bind(null,rules_types["a"].defineRule),extraAction:stepsData.current[rules_types["a"].defineRule].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"edit-define-rule",iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types["a"].defineRule)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepDefineRule,{addPadding:true,defaultValues:stepsData.current[rules_types["a"].defineRule].data,isReadOnlyView:activeStep!==rules_types["a"].defineRule,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types["a"].defineRule),descriptionColumns:"singleSplit"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{initialIsOpen:false,id:rules_types["a"].aboutRule,buttonContent:aboutRuleButton,paddingSize:"xs",ref:aboutRuleRef,onToggle:handleAccordionToggle.bind(null,rules_types["a"].aboutRule),extraAction:stepsData.current[rules_types["a"].aboutRule].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"edit-about-rule",iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types["a"].aboutRule)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepAboutRule,{addPadding:true,defaultValues:stepsData.current[rules_types["a"].aboutRule].data,defineRuleData:stepsData.current[rules_types["a"].defineRule].data,descriptionColumns:"singleSplit",isReadOnlyView:activeStep!==rules_types["a"].aboutRule,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types["a"].aboutRule)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{initialIsOpen:false,id:rules_types["a"].scheduleRule,buttonContent:scheduleRuleButton,paddingSize:"xs",ref:scheduleRuleRef,onToggle:handleAccordionToggle.bind(null,rules_types["a"].scheduleRule),extraAction:stepsData.current[rules_types["a"].scheduleRule].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types["a"].scheduleRule)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepScheduleRule,{addPadding:true,defaultValues:stepsData.current[rules_types["a"].scheduleRule].data,descriptionColumns:"singleSplit",isReadOnlyView:activeStep!==rules_types["a"].scheduleRule,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types["a"].scheduleRule)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{initialIsOpen:false,id:rules_types["a"].ruleActions,buttonContent:ruleActionsButton,paddingSize:"xs",ref:ruleActionsRef,onToggle:handleAccordionToggle.bind(null,rules_types["a"].ruleActions),extraAction:stepsData.current[rules_types["a"].ruleActions].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types["a"].ruleActions)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepRuleActions,{addPadding:true,defaultValues:stepsData.current[rules_types["a"].ruleActions].data,isReadOnlyView:activeStep!==rules_types["a"].ruleActions,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types["a"].ruleActions),actionMessageParams:actionMessageParams})))))),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].detections}))};const CreateRulePage=external_kbnSharedDeps_React_default.a.memo(CreateRulePageComponent);var react_redux_lib=__webpack_require__(81);var filters_global=__webpack_require__(214);var search_bar=__webpack_require__(215);var inputs=__webpack_require__(123);var inputs_actions=__webpack_require__(125);var use_query=__webpack_require__(627);const buildLastAlertsQuery=ruleId=>{const queryFilter=[{bool:{should:[{match:{"signal.status":"open"}}],minimum_should_match:1}}];return{aggs:{lastSeen:{max:{field:"@timestamp"}}},query:{bool:{filter:ruleId!=null?[...queryFilter,{bool:{should:[{match:{"signal.rule.id":ruleId}}],minimum_should_match:1}}]:queryFilter}},size:1,track_total_hits:true}};function alerts_info_slicedToArray(arr,i){return alerts_info_arrayWithHoles(arr)||alerts_info_iterableToArrayLimit(arr,i)||alerts_info_unsupportedIterableToArray(arr,i)||alerts_info_nonIterableRest()}function alerts_info_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function alerts_info_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return alerts_info_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return alerts_info_arrayLikeToArray(o,minLen)}function alerts_info_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function alerts_info_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function alerts_info_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useAlertInfo=({ruleId:ruleId=null})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})),_useState2=alerts_info_slicedToArray(_useState,2),lastAlerts=_useState2[0],setLastAlerts=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})),_useState4=alerts_info_slicedToArray(_useState3,2),totalAlerts=_useState4[0],setTotalAlerts=_useState4[1];const _useQueryAlerts=Object(use_query["a"])(buildLastAlertsQuery(ruleId)),loading=_useQueryAlerts.loading,alerts=_useQueryAlerts.data;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(alerts!=null){var _myAlerts$aggregation,_myAlerts$aggregation2,_myAlerts$aggregation3;const myAlerts=alerts;setLastAlerts(((_myAlerts$aggregation=myAlerts.aggregations)===null||_myAlerts$aggregation===void 0?void 0:_myAlerts$aggregation.lastSeen.value)!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{value:new Date((_myAlerts$aggregation2=(_myAlerts$aggregation3=myAlerts.aggregations)===null||_myAlerts$aggregation3===void 0?void 0:_myAlerts$aggregation3.lastSeen.value_as_string)!==null&&_myAlerts$aggregation2!==void 0?_myAlerts$aggregation2:"")}):null);setTotalAlerts(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,myAlerts.hits.total.value))}else{setLastAlerts(null);setTotalAlerts(null)}},[loading,alerts]);return[lastAlerts,totalAlerts]};var events_viewer=__webpack_require__(441);var common_store=__webpack_require__(95);var store_timeline=__webpack_require__(87);var defaults=__webpack_require__(103);var manage_timeline=__webpack_require__(128);var alerts_table_actions=__webpack_require__(325);var default_config=__webpack_require__(205);var alerts_filter_group=__webpack_require__(417);var external_kbnSharedDeps_ElasticNumeral_=__webpack_require__(63);var external_kbnSharedDeps_ElasticNumeral_default=__webpack_require__.n(external_kbnSharedDeps_ElasticNumeral_);var link_icon=__webpack_require__(406);var utility_bar=__webpack_require__(272);const SHOWING_ALERTS=(totalAlertsFormatted,totalAlerts)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.showingAlertsTitle",{values:{totalAlertsFormatted:totalAlertsFormatted,totalAlerts:totalAlerts},defaultMessage:"Showing {totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"});const SELECTED_ALERTS=(selectedAlertsFormatted,selectedAlerts)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.selectedAlertsTitle",{values:{selectedAlertsFormatted:selectedAlertsFormatted,selectedAlerts:selectedAlerts},defaultMessage:"Selected {selectedAlertsFormatted} {selectedAlerts, plural, =1 {alert} other {alerts}}"});const SELECT_ALL_ALERTS=(totalAlertsFormatted,totalAlerts)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.selectAllAlertsTitle",{values:{totalAlertsFormatted:totalAlertsFormatted,totalAlerts:totalAlerts},defaultMessage:"Select all {totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"});const ADDITIONAL_FILTERS_ACTIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersTitle",{defaultMessage:"Additional filters"});const ADDITIONAL_FILTERS_ACTIONS_SHOW_BUILDING_BLOCK=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showBuildingBlockTitle",{defaultMessage:"Include building block alerts"});const CLEAR_SELECTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.clearSelectionTitle",{defaultMessage:"Clear selection"});const TAKE_ACTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.takeActionTitle",{defaultMessage:"Take action"});const BATCH_ACTIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActionsTitle",{defaultMessage:"Batch actions"});const BATCH_ACTION_VIEW_SELECTED_IN_HOSTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.viewSelectedInHostsTitle",{defaultMessage:"View selected in hosts"});const BATCH_ACTION_VIEW_SELECTED_IN_NETWORK=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.viewSelectedInNetworkTitle",{defaultMessage:"View selected in network"});const BATCH_ACTION_VIEW_SELECTED_IN_TIMELINE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.viewSelectedInTimelineTitle",{defaultMessage:"View selected in timeline"});const BATCH_ACTION_OPEN_SELECTED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.openSelectedTitle",{defaultMessage:"Open selected"});const BATCH_ACTION_CLOSE_SELECTED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.closeSelectedTitle",{defaultMessage:"Close selected"});const BATCH_ACTION_IN_PROGRESS_SELECTED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.inProgressSelectedTitle",{defaultMessage:"Mark in progress"});function alerts_utility_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function alerts_utility_bar_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){alerts_utility_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){alerts_utility_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function alerts_utility_bar_slicedToArray(arr,i){return alerts_utility_bar_arrayWithHoles(arr)||alerts_utility_bar_iterableToArrayLimit(arr,i)||alerts_utility_bar_unsupportedIterableToArray(arr,i)||alerts_utility_bar_nonIterableRest()}function alerts_utility_bar_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function alerts_utility_bar_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return alerts_utility_bar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return alerts_utility_bar_arrayLikeToArray(o,minLen)}function alerts_utility_bar_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function alerts_utility_bar_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function alerts_utility_bar_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const UtilityBarFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"UtilityBarFlexGroup",componentId:"jqzk8o-0"})(["min-width:175px;"]);const BuildingBlockContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"BuildingBlockContainer",componentId:"jqzk8o-1"})(["background:repeating-linear-gradient( 127deg,rgba(245,167,0,0.2),rgba(245,167,0,0.2) 1px,rgba(245,167,0,0.05) 2px,rgba(245,167,0,0.05) 10px );padding:",";"],({theme:theme})=>"".concat(theme.eui.paddingSizes.xs));const AlertsUtilityBarComponent=({canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,areEventsLoading:areEventsLoading,clearSelection:clearSelection,totalCount:totalCount,selectedEventIds:selectedEventIds,currentFilter:currentFilter,selectAll:selectAll,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChanged,showClearSelection:showClearSelection,updateAlertsStatus:updateAlertsStatus})=>{const _useUiSetting$=Object(lib_kibana["l"])(constants["A"]),_useUiSetting$2=alerts_utility_bar_slicedToArray(_useUiSetting$,1),defaultNumberFormat=_useUiSetting$2[0];const handleUpdateStatus=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref=alerts_utility_bar_asyncToGenerator(regeneratorRuntime.mark((function _callee(selectedStatus){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return updateAlertsStatus({alertIds:Object.keys(selectedEventIds),status:currentFilter,selectedStatus:selectedStatus});case 2:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),[currentFilter,selectedEventIds,updateAlertsStatus]);const formattedTotalCount=external_kbnSharedDeps_ElasticNumeral_default()(totalCount).format(defaultNumberFormat);const formattedSelectedEventsCount=external_kbnSharedDeps_ElasticNumeral_default()(Object.keys(selectedEventIds).length).format(defaultNumberFormat);const UtilityBarPopoverContent=closePopover=>external_kbnSharedDeps_React_default.a.createElement(UtilityBarFlexGroup,{direction:"column"},currentFilter!==alerts_filter_group["d"]&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(link_icon["a"],{"aria-label":"openSelectedAlerts",onClick:()=>{closePopover();handleUpdateStatus("open")},color:"text","data-test-subj":"openSelectedAlertsButton"},BATCH_ACTION_OPEN_SELECTED)),currentFilter!==alerts_filter_group["b"]&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(link_icon["a"],{"aria-label":"closeSelectedAlerts",onClick:()=>{closePopover();handleUpdateStatus("closed")},color:"text","data-test-subj":"closeSelectedAlertsButton"},BATCH_ACTION_CLOSE_SELECTED)),currentFilter!==alerts_filter_group["c"]&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(link_icon["a"],{"aria-label":"markSelectedAlertsInProgress",onClick:()=>{closePopover();handleUpdateStatus("in-progress")},color:"text","data-test-subj":"markSelectedAlertsInProgressButton"},BATCH_ACTION_IN_PROGRESS_SELECTED)));const UtilityBarAdditionalFiltersContent=closePopover=>external_kbnSharedDeps_React_default.a.createElement(UtilityBarFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(BuildingBlockContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{id:"showBuildingBlockAlertsCheckbox","aria-label":"showBuildingBlockAlerts",onChange:e=>{closePopover();onShowBuildingBlockAlertsChanged(e.target.checked)},checked:showBuildingBlockAlerts,color:"text","data-test-subj":"showBuildingBlockAlertsCheckbox",label:ADDITIONAL_FILTERS_ACTIONS_SHOW_BUILDING_BLOCK})));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["a"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["d"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"showingAlerts"},SHOWING_ALERTS(formattedTotalCount,totalCount))),external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],{grow:true},canUserCRUD&&hasIndexWrite&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"selectedAlerts"},SELECTED_ALERTS(showClearSelection?formattedTotalCount:formattedSelectedEventsCount,showClearSelection?totalCount:Object.keys(selectedEventIds).length)),external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"alertActionPopover",disabled:areEventsLoading||Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(selectedEventIds)&&showClearSelection===false,iconType:"arrowDown",iconSide:"right",ownFocus:false,popoverContent:UtilityBarPopoverContent},TAKE_ACTION),external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{"aria-label":"selectAllAlerts",dataTestSubj:"selectAllAlertsButton",iconType:showClearSelection?"cross":"pagesSelect",onClick:()=>{if(!showClearSelection){selectAll()}else{clearSelection()}}},showClearSelection?CLEAR_SELECTION:SELECT_ALL_ALERTS(formattedTotalCount,totalCount))),external_kbnSharedDeps_React_default.a.createElement(utility_bar["e"],null),external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"additionalFilters",disabled:areEventsLoading,iconType:"arrowDown",iconSide:"right",ownFocus:false,popoverContent:UtilityBarAdditionalFiltersContent},ADDITIONAL_FILTERS_ACTIONS)))))};const AlertsUtilityBar=external_kbnSharedDeps_React_default.a.memo(AlertsUtilityBarComponent,(prevProps,nextProps)=>prevProps.areEventsLoading===nextProps.areEventsLoading&&prevProps.selectedEventIds===nextProps.selectedEventIds&&prevProps.totalCount===nextProps.totalCount&&prevProps.showClearSelection===nextProps.showClearSelection&&prevProps.showBuildingBlockAlerts===nextProps.showBuildingBlockAlerts);var common_translations=__webpack_require__(326);var alerts_table_translations=__webpack_require__(246);var model=__webpack_require__(98);var sourcerer=__webpack_require__(131);var alerts_table_helpers=__webpack_require__(619);function alerts_table_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function alerts_table_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){alerts_table_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){alerts_table_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function alerts_table_slicedToArray(arr,i){return alerts_table_arrayWithHoles(arr)||alerts_table_iterableToArrayLimit(arr,i)||alerts_table_unsupportedIterableToArray(arr,i)||alerts_table_nonIterableRest()}function alerts_table_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function alerts_table_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return alerts_table_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return alerts_table_arrayLikeToArray(o,minLen)}function alerts_table_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function alerts_table_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function alerts_table_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AlertsTableComponent=({timelineId:timelineId,canUserCRUD:canUserCRUD,clearEventsDeleted:clearEventsDeleted,clearEventsLoading:clearEventsLoading,clearSelected:clearSelected,defaultFilters:defaultFilters,from:from,globalFilters:globalFilters,globalQuery:globalQuery,hasIndexWrite:hasIndexWrite,isSelectAllChecked:isSelectAllChecked,loading:loading,loadingEventIds:loadingEventIds,onRuleChange:onRuleChange,selectedEventIds:selectedEventIds,setEventsDeleted:setEventsDeleted,setEventsLoading:setEventsLoading,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChanged,to:to})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=alerts_table_slicedToArray(_useState,2),showClearSelectionAction=_useState2[0],setShowClearSelectionAction=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(alerts_filter_group["d"]),_useState4=alerts_table_slicedToArray(_useState3,2),filterGroup=_useState4[0],setFilterGroup=_useState4[1];const _useSourcererScope=Object(sourcerer["b"])(model["SourcererScopeName"].detections),browserFields=_useSourcererScope.browserFields,indexPatterns=_useSourcererScope.indexPattern,indexPatternsLoading=_useSourcererScope.loading,selectedPatterns=_useSourcererScope.selectedPatterns;const kibana=Object(lib_kibana["h"])();const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=alerts_table_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const _useAppToasts=Object(use_app_toasts["a"])(),addWarning=_useAppToasts.addWarning;const _useManageTimeline=Object(manage_timeline["b"])(),initializeTimeline=_useManageTimeline.initializeTimeline,setSelectAll=_useManageTimeline.setSelectAll;const getGlobalQuery=Object(external_kbnSharedDeps_React_["useCallback"])(customFilters=>{if(browserFields!=null&&indexPatterns!=null){return Object(timeline_helpers["d"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),dataProviders:[],indexPattern:indexPatterns,browserFields:browserFields,filters:[...defaultFilters!==null&&defaultFilters!==void 0?defaultFilters:[],...globalFilters,...customFilters,...Object(alerts_table_helpers["a"])(from,to)],kqlQuery:globalQuery,kqlMode:globalQuery.language,isEventViewer:true})}return null},[browserFields,defaultFilters,globalFilters,globalQuery,indexPatterns,kibana,to,from]);const setEventsLoadingCallback=Object(external_kbnSharedDeps_React_["useCallback"])(({eventIds:eventIds,isLoading:isLoading})=>{setEventsLoading({id:timelineId,eventIds:eventIds,isLoading:isLoading})},[setEventsLoading,timelineId]);const setEventsDeletedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(({eventIds:eventIds,isDeleted:isDeleted})=>{setEventsDeleted({id:timelineId,eventIds:eventIds,isDeleted:isDeleted})},[setEventsDeleted,timelineId]);const onAlertStatusUpdateSuccess=Object(external_kbnSharedDeps_React_["useCallback"])((updated,conflicts,status)=>{if(conflicts>0){addWarning({title:common_translations["i"](conflicts),text:common_translations["j"](updated,conflicts)})}else{let title;switch(status){case"closed":title=alerts_table_translations["p"](updated);break;case"open":title=alerts_table_translations["v"](updated);break;case"in-progress":title=alerts_table_translations["s"](updated)}Object(toasters["e"])(title,dispatchToaster)}},[addWarning,dispatchToaster]);const onAlertStatusUpdateFailure=Object(external_kbnSharedDeps_React_["useCallback"])((status,error)=>{let title;switch(status){case"closed":title=alerts_table_translations["o"];break;case"open":title=alerts_table_translations["u"];break;case"in-progress":title=alerts_table_translations["r"]}Object(toasters["d"])(title,[error.message],dispatchToaster)},[dispatchToaster]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isSelectAllChecked){setSelectAll({id:timelineId,selectAll:false})}else{setShowClearSelectionAction(false)}},[isSelectAllChecked,setSelectAll,timelineId]);const onFilterGroupChangedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(newFilterGroup=>{clearEventsLoading({id:timelineId});clearEventsDeleted({id:timelineId});clearSelected({id:timelineId});setFilterGroup(newFilterGroup)},[clearEventsLoading,clearEventsDeleted,clearSelected,setFilterGroup,timelineId]);const clearSelectionCallback=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{clearSelected({id:timelineId});setSelectAll({id:timelineId,selectAll:false});setShowClearSelectionAction(false)},[clearSelected,setSelectAll,setShowClearSelectionAction,timelineId]);const selectAllOnAllPagesCallback=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setSelectAll({id:timelineId,selectAll:true});setShowClearSelectionAction(true)},[setSelectAll,setShowClearSelectionAction,timelineId]);const updateAlertsStatusCallback=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref=alerts_table_asyncToGenerator(regeneratorRuntime.mark((function _callee(refetchQuery,{status:status,selectedStatus:selectedStatus}){var _getGlobalQuery;var currentStatusFilter;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:currentStatusFilter=Object(default_config["c"])(status);_context.next=3;return Object(alerts_table_actions["c"])({query:showClearSelectionAction?(_getGlobalQuery=getGlobalQuery(currentStatusFilter))===null||_getGlobalQuery===void 0?void 0:_getGlobalQuery.filterQuery:undefined,alertIds:Object.keys(selectedEventIds),selectedStatus:selectedStatus,setEventsDeleted:setEventsDeletedCallback,setEventsLoading:setEventsLoadingCallback,onAlertStatusUpdateSuccess:onAlertStatusUpdateSuccess,onAlertStatusUpdateFailure:onAlertStatusUpdateFailure});case 3:refetchQuery();case 4:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref.apply(this,arguments)}}(),[getGlobalQuery,selectedEventIds,setEventsDeletedCallback,setEventsLoadingCallback,showClearSelectionAction,onAlertStatusUpdateSuccess,onAlertStatusUpdateFailure]);const utilityBarCallback=Object(external_kbnSharedDeps_React_["useCallback"])((refetchQuery,totalCount)=>external_kbnSharedDeps_React_default.a.createElement(AlertsUtilityBar,{canUserCRUD:canUserCRUD,areEventsLoading:loadingEventIds.length>0,clearSelection:clearSelectionCallback,hasIndexWrite:hasIndexWrite,currentFilter:filterGroup,selectAll:selectAllOnAllPagesCallback,selectedEventIds:selectedEventIds,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChanged,showClearSelection:showClearSelectionAction,totalCount:totalCount,updateAlertsStatus:updateAlertsStatusCallback.bind(null,refetchQuery)}),[canUserCRUD,hasIndexWrite,clearSelectionCallback,filterGroup,showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged,loadingEventIds.length,selectAllOnAllPagesCallback,selectedEventIds,showClearSelectionAction,updateAlertsStatusCallback]);const defaultFiltersMemo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(defaultFilters)){return Object(default_config["c"])(filterGroup)}else if(defaultFilters!=null&&!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(defaultFilters)){return[...defaultFilters,...Object(default_config["c"])(filterGroup)]}},[defaultFilters,filterGroup]);const filterManager=Object(lib_kibana["h"])().services.data.query.filterManager;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{initializeTimeline({defaultModel:default_config["a"],documentType:alerts_table_translations["h"],filterManager:filterManager,footerText:alerts_table_translations["x"],id:timelineId,loadingText:alerts_table_translations["t"],selectAll:false,queryFields:default_config["f"],title:""})},[]);const headerFilterGroup=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(alerts_filter_group["a"],{onFilterGroupChanged:onFilterGroupChangedCallback}),[onFilterGroupChangedCallback]);if(loading||indexPatternsLoading||Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(selectedPatterns)){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:""}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{"data-test-subj":"loading-alerts-panel"}))}return external_kbnSharedDeps_React_default.a.createElement(events_viewer["a"],{pageFilters:defaultFiltersMemo,defaultModel:default_config["a"],end:to,headerFilterGroup:headerFilterGroup,id:timelineId,onRuleChange:onRuleChange,scopeId:model["SourcererScopeName"].detections,start:from,utilityBar:utilityBarCallback})};const makeMapStateToProps=()=>{const getTimeline=store_timeline["b"].getTimelineByIdSelector();const getGlobalInputs=common_store["inputsSelectors"].globalSelector();const mapStateToProps=(state,ownProps)=>{var _getTimeline;const timelineId=ownProps.timelineId;const timeline=(_getTimeline=getTimeline(state,timelineId))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"];const deletedEventIds=timeline.deletedEventIds,isSelectAllChecked=timeline.isSelectAllChecked,loadingEventIds=timeline.loadingEventIds,selectedEventIds=timeline.selectedEventIds;const globalInputs=getGlobalInputs(state);const query=globalInputs.query,filters=globalInputs.filters;return{globalQuery:query,globalFilters:filters,deletedEventIds:deletedEventIds,isSelectAllChecked:isSelectAllChecked,loadingEventIds:loadingEventIds,selectedEventIds:selectedEventIds}};return mapStateToProps};const mapDispatchToProps=dispatch=>({clearSelected:({id:id})=>dispatch(store_timeline["a"].clearSelected({id:id})),setEventsLoading:({id:id,eventIds:eventIds,isLoading:isLoading})=>dispatch(store_timeline["a"].setEventsLoading({id:id,eventIds:eventIds,isLoading:isLoading})),clearEventsLoading:({id:id})=>dispatch(store_timeline["a"].clearEventsLoading({id:id})),setEventsDeleted:({id:id,eventIds:eventIds,isDeleted:isDeleted})=>dispatch(store_timeline["a"].setEventsDeleted({id:id,eventIds:eventIds,isDeleted:isDeleted})),clearEventsDeleted:({id:id})=>dispatch(store_timeline["a"].clearEventsDeleted({id:id}))});const alerts_table_connector=Object(react_redux_lib["connect"])(makeMapStateToProps,mapDispatchToProps);const AlertsTable=alerts_table_connector(external_kbnSharedDeps_React_default.a.memo(AlertsTableComponent));const NO_API_INTEGRATION_KEY_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutTitle",{defaultMessage:"API integration key required"});const NO_API_INTEGRATION_KEY_CALLOUT_MSG=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutMsg",{defaultMessage:"A new encryption key is generated for saved objects each time you start Kibana. Without a persistent key, you cannot delete or modify rules after Kibana restarts. To set a persistent key, add the xpack.encryptedSavedObjects.encryptionKey setting with any text value of 32 or more characters to the kibana.yml file."});const DISMISS_CALLOUT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.dismissNoApiIntegrationKeyButton",{defaultMessage:"Dismiss"});function no_api_integration_callout_slicedToArray(arr,i){return no_api_integration_callout_arrayWithHoles(arr)||no_api_integration_callout_iterableToArrayLimit(arr,i)||no_api_integration_callout_unsupportedIterableToArray(arr,i)||no_api_integration_callout_nonIterableRest()}function no_api_integration_callout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function no_api_integration_callout_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return no_api_integration_callout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return no_api_integration_callout_arrayLikeToArray(o,minLen)}function no_api_integration_callout_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function no_api_integration_callout_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function no_api_integration_callout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const NoApiIntegrationKeyCallOutComponent=()=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=no_api_integration_callout_slicedToArray(_useState,2),showCallOut=_useState2[0],setShowCallOut=_useState2[1];const handleCallOut=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setShowCallOut(false),[setShowCallOut]);return showCallOut?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:NO_API_INTEGRATION_KEY_CALLOUT_TITLE,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,NO_API_INTEGRATION_KEY_CALLOUT_MSG),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"danger",onClick:handleCallOut},DISMISS_CALLOUT)):null};const NoApiIntegrationKeyCallOut=Object(external_kbnSharedDeps_React_["memo"])(NoApiIntegrationKeyCallOutComponent);const NO_WRITE_ALERTS_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.noWriteAlertsCallOutTitle",{defaultMessage:"You cannot change alert states"});const NO_WRITE_ALERTS_CALLOUT_MSG=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.noWriteAlertsCallOutMsg",{defaultMessage:"You only have permissions to view alerts. If you need to update alert states (open or close alerts), contact your Kibana administrator."});const translations_DISMISS_CALLOUT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.dismissNoWriteAlertButton",{defaultMessage:"Dismiss"});function no_write_alerts_callout_slicedToArray(arr,i){return no_write_alerts_callout_arrayWithHoles(arr)||no_write_alerts_callout_iterableToArrayLimit(arr,i)||no_write_alerts_callout_unsupportedIterableToArray(arr,i)||no_write_alerts_callout_nonIterableRest()}function no_write_alerts_callout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function no_write_alerts_callout_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return no_write_alerts_callout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return no_write_alerts_callout_arrayLikeToArray(o,minLen)}function no_write_alerts_callout_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function no_write_alerts_callout_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function no_write_alerts_callout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const NoWriteAlertsCallOutComponent=()=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=no_write_alerts_callout_slicedToArray(_useState,2),showCallOut=_useState2[0],setShowCallOut=_useState2[1];const handleCallOut=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setShowCallOut(false),[setShowCallOut]);return showCallOut?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:NO_WRITE_ALERTS_CALLOUT_TITLE,color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,NO_WRITE_ALERTS_CALLOUT_MSG),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"warning",onClick:handleCallOut},translations_DISMISS_CALLOUT)):null};const NoWriteAlertsCallOut=Object(external_kbnSharedDeps_React_["memo"])(NoWriteAlertsCallOutComponent);var alerts_histogram_panel=__webpack_require__(440);var alerts_histogram_panel_config=__webpack_require__(331);var overview_empty=__webpack_require__(195);var empty_page=__webpack_require__(335);var detection_engine_translations=__webpack_require__(210);const buildMessage=(needsListsIndex,needsSignalsIndex)=>{if(needsSignalsIndex&&needsListsIndex){return detection_engine_translations["h"](detection_engine_translations["j"])}else if(needsSignalsIndex){return detection_engine_translations["h"](detection_engine_translations["k"])}else if(needsListsIndex){return detection_engine_translations["h"](detection_engine_translations["i"])}else{return detection_engine_translations["h"]("")}};const DetectionEngineNoIndexComponent=({needsListsIndex:needsListsIndex,needsSignalsIndex:needsSignalsIndex})=>{const docLinks=Object(lib_kibana["h"])().services.docLinks;const actions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({detections:{icon:"documents",label:detection_engine_translations["d"],url:"".concat(docLinks.ELASTIC_WEBSITE_URL,"guide/en/security/").concat(docLinks.DOC_LINK_VERSION,"/detections-permissions-section.html"),target:"_blank"}}),[docLinks]);const message=buildMessage(needsListsIndex,needsSignalsIndex);return external_kbnSharedDeps_React_default.a.createElement(empty_page["a"],{actions:actions,"data-test-subj":"no_index",message:message,title:detection_engine_translations["l"]})};const DetectionEngineNoIndex=external_kbnSharedDeps_React_default.a.memo(DetectionEngineNoIndexComponent);const DetectionEngineUserUnauthenticated=external_kbnSharedDeps_React_default.a.memo(()=>{const docLinks=Object(lib_kibana["h"])().services.docLinks;const actions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({detectionUnauthenticated:{icon:"documents",label:detection_engine_translations["d"],url:"".concat(docLinks.ELASTIC_WEBSITE_URL,"guide/en/security/").concat(docLinks.DOC_LINK_VERSION,"/detections-permissions-section.html"),target:"_blank"}}),[docLinks]);return external_kbnSharedDeps_React_default.a.createElement(empty_page["a"],{actions:actions,message:detection_engine_translations["n"],"data-test-subj":"no_index",title:detection_engine_translations["o"]})});DetectionEngineUserUnauthenticated.displayName="DetectionEngineUserUnauthenticated";var links=__webpack_require__(89);var link_to=__webpack_require__(85);var use_full_screen=__webpack_require__(120);const Display=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Display",componentId:"sc-1njjyjq-0"})(["",";"],({show:show})=>show?"":"display: none;");Display.displayName="Display";function detection_engine_slicedToArray(arr,i){return detection_engine_arrayWithHoles(arr)||detection_engine_iterableToArrayLimit(arr,i)||detection_engine_unsupportedIterableToArray(arr,i)||detection_engine_nonIterableRest()}function detection_engine_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function detection_engine_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return detection_engine_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return detection_engine_arrayLikeToArray(o,minLen)}function detection_engine_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function detection_engine_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function detection_engine_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const DetectionEnginePageComponent=({filters:filters,graphEventId:graphEventId,query:query,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker})=>{const _useGlobalTime=Object(use_global_time["a"])(),to=_useGlobalTime.to,from=_useGlobalTime.from,deleteQuery=_useGlobalTime.deleteQuery,setQuery=_useGlobalTime.setQuery;const _useFullScreen=Object(use_full_screen["a"])(),globalFullScreen=_useFullScreen.globalFullScreen;const _useUserData=Object(user_info["b"])(),_useUserData2=detection_engine_slicedToArray(_useUserData,1),_useUserData2$=_useUserData2[0],userInfoLoading=_useUserData2$.loading,isSignalIndexExists=_useUserData2$.isSignalIndexExists,isUserAuthenticated=_useUserData2$.isAuthenticated,hasEncryptionKey=_useUserData2$.hasEncryptionKey,canUserCRUD=_useUserData2$.canUserCRUD,signalIndexName=_useUserData2$.signalIndexName,hasIndexWrite=_useUserData2$.hasIndexWrite;const _useListsConfig=useListsConfig(),listsConfigLoading=_useListsConfig.loading,needsListsConfiguration=_useListsConfig.needsConfiguration;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useAlertInfo=useAlertInfo({}),_useAlertInfo2=detection_engine_slicedToArray(_useAlertInfo,1),lastAlerts=_useAlertInfo2[0];const _useFormatUrl=Object(link_to["n"])(app_types["a"].detections),formatUrl=_useFormatUrl.formatUrl;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=detection_engine_slicedToArray(_useState,2),showBuildingBlockAlerts=_useState2[0],setShowBuildingBlockAlerts=_useState2[1];const loading=userInfoLoading||listsConfigLoading;const updateDateRangeCallback=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const _x=detection_engine_slicedToArray(x,2),min=_x[0],max=_x[1];setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]);const goToRules=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["f"])())},[history]);const alertsHistogramDefaultFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[...filters,...Object(default_config["e"])(showBuildingBlockAlerts)],[filters,showBuildingBlockAlerts]);const alertsTableDefaultFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(default_config["e"])(showBuildingBlockAlerts),[showBuildingBlockAlerts]);const onShowBuildingBlockAlertsChangedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(newShowBuildingBlockAlerts=>{setShowBuildingBlockAlerts(newShowBuildingBlockAlerts)},[setShowBuildingBlockAlerts]);const _useSourcererScope=Object(sourcerer["b"])(model["SourcererScopeName"].detections),indicesExist=_useSourcererScope.indicesExist,indexPattern=_useSourcererScope.indexPattern;if(isUserAuthenticated!=null&&!isUserAuthenticated&&!loading){return external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:true,title:detection_engine_translations["m"]}),external_kbnSharedDeps_React_default.a.createElement(DetectionEngineUserUnauthenticated,null))}if(!loading&&(isSignalIndexExists===false||needsListsConfiguration)){return external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:true,title:detection_engine_translations["m"]}),external_kbnSharedDeps_React_default.a.createElement(DetectionEngineNoIndex,{needsSignalsIndex:isSignalIndexExists===false,needsListsIndex:needsListsConfiguration}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,hasEncryptionKey!=null&&!hasEncryptionKey&&external_kbnSharedDeps_React_default.a.createElement(NoApiIntegrationKeyCallOut,null),hasIndexWrite!=null&&!hasIndexWrite&&external_kbnSharedDeps_React_default.a.createElement(NoWriteAlertsCallOut,null),indicesExist?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"resize",handler:external_kbnSharedDeps_LodashFp_["noop"]}),external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],{show:Object(timeline_helpers["f"])({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{id:"global",indexPattern:indexPattern})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{subtitle:lastAlerts!=null&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,detection_engine_translations["e"],": ",lastAlerts),title:detection_engine_translations["m"]},external_kbnSharedDeps_React_default.a.createElement(links["g"],{fill:true,onClick:goToRules,href:formatUrl(Object(redirect_to_detection_engine["f"])()),iconType:"gear","data-test-subj":"manage-alert-detection-rules"},detection_engine_translations["c"])),external_kbnSharedDeps_React_default.a.createElement(alerts_histogram_panel["a"],{deleteQuery:deleteQuery,filters:alertsHistogramDefaultFilters,from:from,query:query,setQuery:setQuery,showTotalAlertsCount:true,signalIndexName:signalIndexName,stackByOptions:alerts_histogram_panel_config["a"],to:to,updateDateRange:updateDateRangeCallback}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(AlertsTable,{timelineId:types_timeline["e"].detectionsPage,loading:loading,hasIndexWrite:hasIndexWrite!==null&&hasIndexWrite!==void 0?hasIndexWrite:false,canUserCRUD:(canUserCRUD!==null&&canUserCRUD!==void 0?canUserCRUD:false)&&(hasEncryptionKey!==null&&hasEncryptionKey!==void 0?hasEncryptionKey:false),from:from,defaultFilters:alertsTableDefaultFilters,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChangedCallback,to:to}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:true,title:detection_engine_translations["m"]}),external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].detections}))};const detection_engine_makeMapStateToProps=()=>{const getGlobalInputs=inputs["d"].globalSelector();const getTimeline=store_timeline["b"].getTimelineByIdSelector();return state=>{var _getTimeline;const globalInputs=getGlobalInputs(state);const query=globalInputs.query,filters=globalInputs.filters;const timeline=(_getTimeline=getTimeline(state,types_timeline["e"].detectionsPage))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"];const graphEventId=timeline.graphEventId;return{query:query,filters:filters,graphEventId:graphEventId}}};const detection_engine_mapDispatchToProps={setAbsoluteRangeDatePicker:inputs_actions["setAbsoluteRangeDatePicker"]};const detection_engine_connector=Object(react_redux_lib["connect"])(detection_engine_makeMapStateToProps,detection_engine_mapDispatchToProps);const DetectionEnginePage=detection_engine_connector(external_kbnSharedDeps_React_default.a.memo(DetectionEnginePageComponent));const MyPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"MyPanel",componentId:"sc-177nzsv-0"})(["position:relative;"]);MyPanel.displayName="MyPanel";const StepPanelComponent=({children:children,loading:loading,title:title})=>external_kbnSharedDeps_React_default.a.createElement(MyPanel,null,loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{size:"xs",color:"accent",position:"absolute"}),external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:title}),children);const StepPanel=Object(external_kbnSharedDeps_React_["memo"])(StepPanelComponent);const translations_PAGE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.editRule.pageTitle",{defaultMessage:"Edit rule settings"});const CANCEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.editRule.cancelTitle",{defaultMessage:"Cancel"});const SAVE_CHANGES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.editRule.saveChangeTitle",{defaultMessage:"Save changes"});const SORRY_ERRORS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.editRule.errorMsgDescription",{defaultMessage:"Sorry"});const BACK_TO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.editRule.backToDescription",{defaultMessage:"Back to"});const SUCCESSFULLY_SAVED_RULE=ruleName=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.update.successfullySavedRuleTitle",{values:{ruleName:ruleName},defaultMessage:"{ruleName} was saved"});function edit_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function edit_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){edit_ownKeys(Object(source),true).forEach((function(key){edit_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{edit_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function edit_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function edit_slicedToArray(arr,i){return edit_arrayWithHoles(arr)||edit_iterableToArrayLimit(arr,i)||edit_unsupportedIterableToArray(arr,i)||edit_nonIterableRest()}function edit_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function edit_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return edit_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return edit_arrayLikeToArray(o,minLen)}function edit_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function edit_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function edit_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function edit_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function edit_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){edit_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){edit_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const edit_formHookNoop=function(){var _ref=edit_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",undefined);case 1:case"end":return _context.stop()}}),_callee)})));return function formHookNoop(){return _ref.apply(this,arguments)}}();const EditRulePageComponent=()=>{var _rule$name2;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=edit_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const _useUserData=Object(user_info["b"])(),_useUserData2=edit_slicedToArray(_useUserData,1),_useUserData2$=_useUserData2[0],userInfoLoading=_useUserData2$.loading,isSignalIndexExists=_useUserData2$.isSignalIndexExists,isAuthenticated=_useUserData2$.isAuthenticated,hasEncryptionKey=_useUserData2$.hasEncryptionKey,canUserCRUD=_useUserData2$.canUserCRUD;const _useListsConfig=useListsConfig(),listsConfigLoading=_useListsConfig.loading,needsListsConfiguration=_useListsConfig.needsConfiguration;const _useParams=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])(),ruleId=_useParams.detailName;const _useRule=useRule(ruleId),_useRule2=edit_slicedToArray(_useRule,2),ruleLoading=_useRule2[0],rule=_useRule2[1];const loading=ruleLoading||userInfoLoading||listsConfigLoading;const formHooks=Object(external_kbnSharedDeps_React_["useRef"])({[rules_types["a"].defineRule]:edit_formHookNoop,[rules_types["a"].aboutRule]:edit_formHookNoop,[rules_types["a"].scheduleRule]:edit_formHookNoop,[rules_types["a"].ruleActions]:edit_formHookNoop});const stepsData=Object(external_kbnSharedDeps_React_["useRef"])({[rules_types["a"].defineRule]:{isValid:false,data:undefined},[rules_types["a"].aboutRule]:{isValid:false,data:undefined},[rules_types["a"].scheduleRule]:{isValid:false,data:undefined},[rules_types["a"].ruleActions]:{isValid:false,data:undefined}});const defineStep=stepsData.current[rules_types["a"].defineRule];const aboutStep=stepsData.current[rules_types["a"].aboutRule];const scheduleStep=stepsData.current[rules_types["a"].scheduleRule];const actionsStep=stepsData.current[rules_types["a"].ruleActions];const _useState=Object(external_kbnSharedDeps_React_["useState"])(rules_types["a"].defineRule),_useState2=edit_slicedToArray(_useState,2),activeStep=_useState2[0],setActiveStep=_useState2[1];const invalidSteps=rules_utils["b"].filter(step=>{const stepData=stepsData.current[step];return stepData.data!=null&&!stepIsValid(stepData)});const _useUpdateRule=useUpdateRule(),_useUpdateRule2=edit_slicedToArray(_useUpdateRule,2),_useUpdateRule2$=_useUpdateRule2[0],isLoading=_useUpdateRule2$.isLoading,isSaved=_useUpdateRule2$.isSaved,setRule=_useUpdateRule2[1];const actionMessageParams=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getActionMessageParams(rule===null||rule===void 0?void 0:rule.type),[rule===null||rule===void 0?void 0:rule.type]);const setFormHook=Object(external_kbnSharedDeps_React_["useCallback"])((step,hook)=>{formHooks.current[step]=hook;if(step===activeStep){hook()}},[activeStep]);const setStepData=Object(external_kbnSharedDeps_React_["useCallback"])((step,data,isValid)=>{stepsData.current[step]=edit_objectSpread(edit_objectSpread({},stepsData.current[step]),{},{data:data,isValid:isValid})},[]);const tabs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{"data-test-subj":"edit-rule-define-tab",id:rules_types["a"].defineRule,name:rules_translations["J"],disabled:rule===null||rule===void 0?void 0:rule.immutable,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations["J"]},defineStep.data!=null&&external_kbnSharedDeps_React_default.a.createElement(StepDefineRule,{isReadOnlyView:false,isLoading:isLoading,isUpdateView:true,defaultValues:defineStep.data,setForm:setFormHook}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)))},{"data-test-subj":"edit-rule-about-tab",id:rules_types["a"].aboutRule,name:rules_translations["a"],disabled:rule===null||rule===void 0?void 0:rule.immutable,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations["a"]},aboutStep.data!=null&&defineStep.data!=null&&external_kbnSharedDeps_React_default.a.createElement(StepAboutRule,{isReadOnlyView:false,isLoading:isLoading,isUpdateView:true,defaultValues:aboutStep.data,defineRuleData:defineStep.data,setForm:setFormHook}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)))},{"data-test-subj":"edit-rule-schedule-tab",id:rules_types["a"].scheduleRule,name:rules_translations["qb"],disabled:rule===null||rule===void 0?void 0:rule.immutable,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations["qb"]},scheduleStep.data!=null&&external_kbnSharedDeps_React_default.a.createElement(StepScheduleRule,{isReadOnlyView:false,isLoading:isLoading,isUpdateView:true,defaultValues:scheduleStep.data,setForm:setFormHook}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)))},{"data-test-subj":"edit-rule-actions-tab",id:rules_types["a"].ruleActions,name:rules_translations["c"],content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations["c"]},actionsStep.data!=null&&external_kbnSharedDeps_React_default.a.createElement(StepRuleActions,{isReadOnlyView:false,isLoading:isLoading,isUpdateView:true,defaultValues:actionsStep.data,setForm:setFormHook,actionMessageParams:actionMessageParams}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)))}],[rule===null||rule===void 0?void 0:rule.immutable,loading,defineStep.data,isLoading,setFormHook,aboutStep.data,scheduleStep.data,actionsStep.data,actionMessageParams]);const onSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(edit_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var activeStepData,define,about,schedule,actions;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return formHooks.current[activeStep]();case 2:activeStepData=_context2.sent;if((activeStepData===null||activeStepData===void 0?void 0:activeStepData.data)!=null){setStepData(activeStep,activeStepData.data,activeStepData.isValid)}define=isDefineStep(activeStepData)?activeStepData:defineStep;about=isAboutStep(activeStepData)?activeStepData:aboutStep;schedule=isScheduleStep(activeStepData)?activeStepData:scheduleStep;actions=isActionsStep(activeStepData)?activeStepData:actionsStep;if(stepIsValid(define)&&stepIsValid(about)&&stepIsValid(schedule)&&stepIsValid(actions)){setRule(edit_objectSpread(edit_objectSpread({},formatRule(define.data,about.data,schedule.data,actions.data,rule)),ruleId?{id:ruleId}:{}))}case 9:case"end":return _context2.stop()}}),_callee2)}))),[aboutStep,actionsStep,activeStep,defineStep,rule,ruleId,scheduleStep,setRule,setStepData]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(rule!=null){const _getStepsData=getStepsData({rule:rule}),aboutRuleData=_getStepsData.aboutRuleData,defineRuleData=_getStepsData.defineRuleData,scheduleRuleData=_getStepsData.scheduleRuleData,ruleActionsData=_getStepsData.ruleActionsData;setStepData(rules_types["a"].defineRule,defineRuleData,true);setStepData(rules_types["a"].aboutRule,aboutRuleData,true);setStepData(rules_types["a"].scheduleRule,scheduleRuleData,true);setStepData(rules_types["a"].ruleActions,ruleActionsData,true)}},[rule,setStepData]);const goToStep=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref3=edit_asyncToGenerator(regeneratorRuntime.mark((function _callee3(step){return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:setActiveStep(step);_context3.next=3;return formHooks.current[step]();case 3:case"end":return _context3.stop()}}),_callee3)})));return function(_x){return _ref3.apply(this,arguments)}}(),[]);const onTabClick=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref4=edit_asyncToGenerator(regeneratorRuntime.mark((function _callee4(tab){var targetStep,activeStepData;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:targetStep=tab.id;_context4.next=3;return formHooks.current[activeStep]();case 3:activeStepData=_context4.sent;if((activeStepData===null||activeStepData===void 0?void 0:activeStepData.data)!=null){setStepData(activeStep,activeStepData.data,activeStepData.isValid);goToStep(targetStep)}case 5:case"end":return _context4.stop()}}),_callee4)})));return function(_x2){return _ref4.apply(this,arguments)}}(),[activeStep,goToStep,setStepData]);const goToDetailsRule=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.replace(Object(redirect_to_detection_engine["e"])(ruleId!==null&&ruleId!==void 0?ruleId:""))},[history,ruleId]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(rule===null||rule===void 0?void 0:rule.immutable){setActiveStep(rules_types["a"].ruleActions)}else{setActiveStep(rules_types["a"].defineRule)}},[rule]);if(isSaved){var _rule$name;Object(toasters["e"])(SUCCESSFULLY_SAVED_RULE((_rule$name=rule===null||rule===void 0?void 0:rule.name)!==null&&_rule$name!==void 0?_rule$name:""),dispatchToaster);history.replace(Object(redirect_to_detection_engine["e"])(ruleId!==null&&ruleId!==void 0?ruleId:""));return null}if(redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)){history.replace(Object(redirect_to_detection_engine["c"])());return null}else if(helpers_userHasNoPermissions(canUserCRUD)){history.replace(Object(redirect_to_detection_engine["e"])(ruleId!==null&&ruleId!==void 0?ruleId:""));return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(MaxWidthEuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine["e"])(ruleId!==null&&ruleId!==void 0?ruleId:""),text:"".concat(BACK_TO," ").concat((_rule$name2=rule===null||rule===void 0?void 0:rule.name)!==null&&_rule$name2!==void 0?_rule$name2:""),pageId:app_types["a"].detections},isLoading:isLoading,title:translations_PAGE_TITLE}),invalidSteps.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:SORRY_ERRORS,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.rule.editRule.errorMsgDescription",defaultMessage:"You have an invalid input in {countError, plural, one {this tab} other {these tabs}}: {tabHasError}",values:{countError:invalidSteps.length,tabHasError:invalidSteps.map(t=>{if(t===rules_types["a"].aboutRule){return rules_translations["a"]}else if(t===rules_types["a"].defineRule){return rules_translations["J"]}else if(t===rules_types["a"].scheduleRule){return rules_translations["qb"]}else if(t===rules_types["a"].ruleActions){return rules_translations["pb"]}return t}).join(", ")}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabbedContent"],{initialSelectedTab:tabs[0],selectedTab:tabs.find(t=>t.id===activeStep),onTabClick:onTabClick,tabs:tabs}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"cross",onClick:goToDetailsRule},CANCEL)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"ruleEditSubmitButton",fill:true,onClick:onSubmit,iconType:"save",isLoading:isLoading,isDisabled:loading},SAVE_CHANGES)))))),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].detections,state:{ruleName:rule===null||rule===void 0?void 0:rule.name}}))};const EditRulePage=Object(external_kbnSharedDeps_React_["memo"])(EditRulePageComponent);var formatted_date=__webpack_require__(94);var markdown_editor=__webpack_require__(228);const ABOUT_PANEL_DETAILS_TAB=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.detailsLabel",{defaultMessage:"Details"});const ABOUT_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.aboutText",{defaultMessage:"About"});const ABOUT_PANEL_NOTES_TAB=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.investigationGuideLabel",{defaultMessage:"Investigation guide"});const ABOUT_CONTROL_LEGEND=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.controlLegend",{defaultMessage:"Viewing"});function step_about_rule_details_slicedToArray(arr,i){return step_about_rule_details_arrayWithHoles(arr)||step_about_rule_details_iterableToArrayLimit(arr,i)||step_about_rule_details_unsupportedIterableToArray(arr,i)||step_about_rule_details_nonIterableRest()}function step_about_rule_details_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function step_about_rule_details_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return step_about_rule_details_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return step_about_rule_details_arrayLikeToArray(o,minLen)}function step_about_rule_details_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function step_about_rule_details_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function step_about_rule_details_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const step_about_rule_details_MyPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"MyPanel",componentId:"wtwaaw-0"})(["position:relative;"]);const FlexGroupFullHeight=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroupFullHeight",componentId:"wtwaaw-1"})(["height:100%;"]);const VerticalOverflowContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"VerticalOverflowContainer",componentId:"wtwaaw-2"})(props=>({"max-height":"".concat(props.maxHeight,"px"),"overflow-y":"hidden"}));const VerticalOverflowContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"VerticalOverflowContent",componentId:"wtwaaw-3"})(props=>({"max-height":"".concat(props.maxHeight,"px")}));const AboutContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"AboutContent",componentId:"wtwaaw-4"})(["height:100%;"]);const toggleOptions=[{id:"details",label:ABOUT_PANEL_DETAILS_TAB,"data-test-subj":"stepAboutDetailsToggle-details"},{id:"notes",label:ABOUT_PANEL_NOTES_TAB,"data-test-subj":"stepAboutDetailsToggle-notes"}];const StepAboutRuleToggleDetailsComponent=({stepData:stepData,stepDataDetails:stepDataDetails,loading:loading})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])("details"),_useState2=step_about_rule_details_slicedToArray(_useState,2),selectedToggleOption=_useState2[0],setToggleOption=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(0),_useState4=step_about_rule_details_slicedToArray(_useState3,2),aboutPanelHeight=_useState4[0],setAboutPanelHeight=_useState4[1];const onResize=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{setAboutPanelHeight(e.height)},[setAboutPanelHeight]);return external_kbnSharedDeps_React_default.a.createElement(step_about_rule_details_MyPanel,null,loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{size:"xs",color:"accent",position:"absolute"}),external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:ABOUT_TEXT})),stepData!=null&&stepDataDetails!=null&&external_kbnSharedDeps_React_default.a.createElement(FlexGroupFullHeight,{gutterSize:"xs",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1,key:"header"},external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:ABOUT_TEXT},!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(stepDataDetails.note)&&stepDataDetails.note.trim()!==""&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{options:toggleOptions,idSelected:selectedToggleOption,onChange:val=>{setToggleOption(val)},"data-test-subj":"stepAboutDetailsToggle",legend:ABOUT_CONTROL_LEGEND}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:5,key:"details"},selectedToggleOption==="details"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiResizeObserver"],{"data-test-subj":"stepAboutDetailsContent",onResize:onResize},resizeRef=>external_kbnSharedDeps_React_default.a.createElement(AboutContent,{ref:resizeRef},external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContainer,{maxHeight:120},external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContent,{maxHeight:120,className:"eui-yScrollWithShadows"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s","data-test-subj":"stepAboutRuleDetailsToggleDescriptionText"},stepDataDetails.description))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepAboutRule,{descriptionColumns:"singleSplit",isReadOnlyView:true,isLoading:false,defaultValues:stepData}))):external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContainer,{"data-test-subj":"stepAboutDetailsNoteContent",maxHeight:aboutPanelHeight},external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContent,{maxHeight:aboutPanelHeight,className:"eui-yScrollWithShadows"},external_kbnSharedDeps_React_default.a.createElement(markdown_editor["MarkdownRenderer"],null,stepDataDetails.note))))))};const StepAboutRuleToggleDetails=Object(external_kbnSharedDeps_React_["memo"])(StepAboutRuleToggleDetailsComponent);const READ_ONLY_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.readOnlyCallOutTitle",{defaultMessage:"Rule permissions required"});const READ_ONLY_CALLOUT_MSG=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.readOnlyCallOutMsg",{defaultMessage:"You are currently missing the required permissions to create/edit detection engine rule. Please contact your administrator for further assistance."});const read_only_callout_translations_DISMISS_CALLOUT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.dismissButton",{defaultMessage:"Dismiss"});function read_only_callout_slicedToArray(arr,i){return read_only_callout_arrayWithHoles(arr)||read_only_callout_iterableToArrayLimit(arr,i)||read_only_callout_unsupportedIterableToArray(arr,i)||read_only_callout_nonIterableRest()}function read_only_callout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function read_only_callout_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return read_only_callout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return read_only_callout_arrayLikeToArray(o,minLen)}function read_only_callout_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function read_only_callout_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function read_only_callout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ReadOnlyCallOutComponent=()=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=read_only_callout_slicedToArray(_useState,2),showCallOut=_useState2[0],setShowCallOut=_useState2[1];const handleCallOut=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setShowCallOut(false),[setShowCallOut]);return showCallOut?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:READ_ONLY_CALLOUT_TITLE,color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,READ_ONLY_CALLOUT_MSG),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"warning",onClick:handleCallOut},read_only_callout_translations_DISMISS_CALLOUT)):null};const ReadOnlyCallOut=Object(external_kbnSharedDeps_React_["memo"])(ReadOnlyCallOutComponent);var telemetry=__webpack_require__(31);const bucketRulesResponse=response=>response.reduce((acc,cv)=>"error"in cv?{rules:[...acc.rules],errors:[...acc.errors,cv]}:{rules:[...acc.rules,cv],errors:[...acc.errors]},{rules:[],errors:[]});const showRulesTable=({rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled})=>rulesCustomInstalled!=null&&rulesCustomInstalled>0||rulesInstalled!=null&&rulesInstalled>0;const caseInsensitiveSort=tags=>tags.sort((a,b)=>a.toLowerCase().localeCompare(b.toLowerCase()));function actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function actions_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const editRuleAction=(rule,history)=>{history.push(Object(redirect_to_detection_engine["d"])(rule.id))};const duplicateRulesAction=function(){var _ref=actions_asyncToGenerator(regeneratorRuntime.mark((function _callee(rules,ruleIds,dispatch,dispatchToaster){var response,_bucketRulesResponse,errors;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch({type:"loadingRuleIds",ids:ruleIds,actionType:"duplicate"});_context.next=4;return Object(api["d"])({rules:rules});case 4:response=_context.sent;_bucketRulesResponse=bucketRulesResponse(response),errors=_bucketRulesResponse.errors;if(errors.length>0){Object(toasters["d"])(rules_translations["O"],errors.map(e=>e.error.message),dispatchToaster)}else{Object(toasters["e"])(rules_translations["xb"](ruleIds.length),dispatchToaster)}dispatch({type:"loadingRuleIds",ids:[],actionType:null});_context.next=14;break;case 10:_context.prev=10;_context.t0=_context["catch"](0);dispatch({type:"loadingRuleIds",ids:[],actionType:null});Object(toasters["g"])({title:rules_translations["O"],error:_context.t0,dispatchToaster:dispatchToaster});case 14:case"end":return _context.stop()}}),_callee,null,[[0,10]])})));return function duplicateRulesAction(_x,_x2,_x3,_x4){return _ref.apply(this,arguments)}}();const exportRulesAction=(exportRuleId,dispatch)=>{dispatch({type:"exportRuleIds",ids:exportRuleId})};const deleteRulesAction=function(){var _ref2=actions_asyncToGenerator(regeneratorRuntime.mark((function _callee2(ruleIds,dispatch,dispatchToaster,onRuleDeleted){var response,_bucketRulesResponse2,errors;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;dispatch({type:"loadingRuleIds",ids:ruleIds,actionType:"delete"});_context2.next=4;return Object(api["c"])({ids:ruleIds});case 4:response=_context2.sent;_bucketRulesResponse2=bucketRulesResponse(response),errors=_bucketRulesResponse2.errors;dispatch({type:"loadingRuleIds",ids:[],actionType:null});if(errors.length>0){Object(toasters["d"])(rules_translations["o"](ruleIds.length),errors.map(e=>e.error.message),dispatchToaster)}else if(onRuleDeleted){onRuleDeleted()}_context2.next=14;break;case 10:_context2.prev=10;_context2.t0=_context2["catch"](0);dispatch({type:"loadingRuleIds",ids:[],actionType:null});Object(toasters["g"])({title:rules_translations["o"](ruleIds.length),error:_context2.t0,dispatchToaster:dispatchToaster});case 14:case"end":return _context2.stop()}}),_callee2,null,[[0,10]])})));return function deleteRulesAction(_x5,_x6,_x7,_x8){return _ref2.apply(this,arguments)}}();const enableRulesAction=function(){var _ref3=actions_asyncToGenerator(regeneratorRuntime.mark((function _callee3(ids,enabled,dispatch,dispatchToaster){var errorTitle,response,_bucketRulesResponse3,rules,errors;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:errorTitle=enabled?rules_translations["k"](ids.length):rules_translations["m"](ids.length);_context3.prev=1;dispatch({type:"loadingRuleIds",ids:ids,actionType:enabled?"enable":"disable"});_context3.next=5;return Object(api["e"])({ids:ids,enabled:enabled});case 5:response=_context3.sent;_bucketRulesResponse3=bucketRulesResponse(response),rules=_bucketRulesResponse3.rules,errors=_bucketRulesResponse3.errors;dispatch({type:"updateRules",rules:rules});if(errors.length>0){Object(toasters["d"])(errorTitle,errors.map(e=>e.error.message),dispatchToaster)}if(rules.some(rule=>rule.immutable)){Object(telemetry["e"])(telemetry["a"].COUNT,enabled?telemetry["b"].SIEM_RULE_ENABLED:telemetry["b"].SIEM_RULE_DISABLED)}if(rules.some(rule=>!rule.immutable)){Object(telemetry["e"])(telemetry["a"].COUNT,enabled?telemetry["b"].CUSTOM_RULE_ENABLED:telemetry["b"].CUSTOM_RULE_DISABLED)}_context3.next=17;break;case 13:_context3.prev=13;_context3.t0=_context3["catch"](1);Object(toasters["d"])(errorTitle,[_context3.t0.message],dispatchToaster);dispatch({type:"loadingRuleIds",ids:[],actionType:null});case 17:case"end":return _context3.stop()}}),_callee3,null,[[1,13]])})));return function enableRulesAction(_x9,_x10,_x11,_x12){return _ref3.apply(this,arguments)}}();function rule_switch_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function rule_switch_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){rule_switch_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){rule_switch_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function rule_switch_slicedToArray(arr,i){return rule_switch_arrayWithHoles(arr)||rule_switch_iterableToArrayLimit(arr,i)||rule_switch_unsupportedIterableToArray(arr,i)||rule_switch_nonIterableRest()}function rule_switch_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rule_switch_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return rule_switch_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rule_switch_arrayLikeToArray(o,minLen)}function rule_switch_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function rule_switch_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function rule_switch_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const StaticSwitch=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiSwitch"]).withConfig({displayName:"StaticSwitch",componentId:"sc-12pilng-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);StaticSwitch.displayName="StaticSwitch";const RuleSwitchComponent=({dispatch:dispatch,id:id,isDisabled:isDisabled,isLoading:isLoading,enabled:enabled,optionLabel:optionLabel,onChange:onChange})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=rule_switch_slicedToArray(_useState,2),myIsLoading=_useState2[0],setMyIsLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(enabled!==null&&enabled!==void 0?enabled:false),_useState4=rule_switch_slicedToArray(_useState3,2),myEnabled=_useState4[0],setMyEnabled=_useState4[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=rule_switch_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const onRuleStateChange=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref=rule_switch_asyncToGenerator(regeneratorRuntime.mark((function _callee(event){var enabling,title,response,_bucketRulesResponse,rules,errors,_rules,rule;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setMyIsLoading(true);if(!(dispatch!=null)){_context.next=6;break}_context.next=4;return enableRulesAction([id],event.target.checked,dispatch,dispatchToaster);case 4:_context.next=20;break;case 6:enabling=event.target.checked;title=enabling?rules_translations["k"](1):rules_translations["m"](1);_context.prev=8;_context.next=11;return Object(api["e"])({ids:[id],enabled:enabling});case 11:response=_context.sent;_bucketRulesResponse=bucketRulesResponse(response),rules=_bucketRulesResponse.rules,errors=_bucketRulesResponse.errors;if(errors.length>0){setMyIsLoading(false);Object(toasters["d"])(title,errors.map(e=>e.error.message),dispatchToaster)}else{_rules=rule_switch_slicedToArray(rules,1),rule=_rules[0];setMyEnabled(rule.enabled);if(onChange!=null){onChange(rule.enabled)}}_context.next=20;break;case 16:_context.prev=16;_context.t0=_context["catch"](8);setMyIsLoading(false);Object(toasters["d"])(title,_context.t0.message,dispatchToaster);case 20:setMyIsLoading(false);case 21:case"end":return _context.stop()}}),_callee,null,[[8,16]])})));return function(_x){return _ref.apply(this,arguments)}}(),[dispatch,id]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(myEnabled!==enabled){setMyEnabled(enabled)}},[enabled]);const showLoader=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(myIsLoading!==isLoading){return isLoading!==null&&isLoading!==void 0?isLoading:false}return myIsLoading},[myIsLoading,isLoading]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},showLoader?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m","data-test-subj":"ruleSwitchLoader"}):external_kbnSharedDeps_React_default.a.createElement(StaticSwitch,{"data-test-subj":"ruleSwitch",label:optionLabel!==null&&optionLabel!==void 0?optionLabel:"",showLabel:!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(optionLabel),disabled:isDisabled,checked:myEnabled,onChange:onRuleStateChange})))};const RuleSwitch=external_kbnSharedDeps_React_default.a.memo(RuleSwitchComponent);RuleSwitch.displayName="RuleSwitch";const details_translations_PAGE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"});const translations_BACK_TO_RULES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesDescription",{defaultMessage:"Back to detection rules"});const EXPERIMENTAL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.experimentalDescription",{defaultMessage:"Experimental"});const ACTIVATE_RULE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.activateRuleLabel",{defaultMessage:"Activate"});const UNKNOWN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"});const ERROR_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.errorCalloutTitle",{defaultMessage:"Rule failure at"});const FAILURE_HISTORY_TAB=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.failureHistoryTab",{defaultMessage:"Failure History"});const LAST_FIVE_ERRORS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.lastFiveErrorsTitle",{defaultMessage:"Last five errors"});const COLUMN_STATUS_TYPE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.statusTypeColumn",{defaultMessage:"Type"});const COLUMN_FAILED_AT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedAtColumn",{defaultMessage:"Failed at"});const COLUMN_FAILED_MSG=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedMsgColumn",{defaultMessage:"Failed message"});const TYPE_FAILED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedDescription",{defaultMessage:"Failed"});const EXCEPTIONS_TAB=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.exceptionsTab",{defaultMessage:"Exceptions"});const ALL_ACTIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.components.ruleActionsOverflow.allActionsTitle",{defaultMessage:"All actions"});var generic_downloader=__webpack_require__(447);const isBoolean=obj=>typeof obj==="boolean";const canEditRuleWithActions=(rule,privileges)=>{var _rule$actions;if(rule==null){return true}if(((_rule$actions=rule.actions)===null||_rule$actions===void 0?void 0:_rule$actions.length)>0&&isBoolean(privileges)){return privileges}return true};const getToolTipContent=(rule,hasMlPermissions,hasReadActionsPrivileges)=>{if(rule==null){return undefined}else if(Object(helpers["d"])(rule.type)&&!hasMlPermissions){return detection_engine_translations["f"]}else if(!canEditRuleWithActions(rule,hasReadActionsPrivileges)){return rules_translations["R"]}else{return undefined}};function rule_actions_overflow_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function rule_actions_overflow_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){rule_actions_overflow_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){rule_actions_overflow_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function rule_actions_overflow_slicedToArray(arr,i){return rule_actions_overflow_arrayWithHoles(arr)||rule_actions_overflow_iterableToArrayLimit(arr,i)||rule_actions_overflow_unsupportedIterableToArray(arr,i)||rule_actions_overflow_nonIterableRest()}function rule_actions_overflow_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rule_actions_overflow_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return rule_actions_overflow_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rule_actions_overflow_arrayLikeToArray(o,minLen)}function rule_actions_overflow_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function rule_actions_overflow_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function rule_actions_overflow_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const MyEuiButtonIcon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"]).withConfig({displayName:"MyEuiButtonIcon",componentId:"wltxb1-0"})(["&.euiButtonIcon{svg{transform:rotate(90deg);}border:1px solid  ",";width:40px;height:40px;}"],({theme:theme})=>theme.euiColorPrimary);const RuleActionsOverflowComponent=({rule:rule,userHasNoPermissions:userHasNoPermissions,canDuplicateRuleWithActions:canDuplicateRuleWithActions})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=rule_actions_overflow_slicedToArray(_useState,2),isPopoverOpen=_useState2[0],setIsPopoverOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])([]),_useState4=rule_actions_overflow_slicedToArray(_useState3,2),rulesToExport=_useState4[0],setRulesToExport=_useState4[1];const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=rule_actions_overflow_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const onRuleDeletedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{history.push(Object(redirect_to_detection_engine["f"])())},[history]);const actions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>rule!=null?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["N"],icon:"copy",disabled:!canDuplicateRuleWithActions||userHasNoPermissions,"data-test-subj":"rules-details-duplicate-rule",onClick:rule_actions_overflow_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsPopoverOpen(false);_context.next=3;return duplicateRulesAction([rule],[rule.id],external_kbnSharedDeps_LodashFp_["noop"],dispatchToaster);case 3:case"end":return _context.stop()}}),_callee)})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"left",content:getToolTipContent(rule,true,canDuplicateRuleWithActions)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["N"]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["U"],icon:"exportAction",disabled:userHasNoPermissions||rule.immutable,"data-test-subj":"rules-details-export-rule",onClick:()=>{setIsPopoverOpen(false);setRulesToExport([rule.rule_id])}},rules_translations["U"]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["L"],icon:"trash",disabled:userHasNoPermissions,"data-test-subj":"rules-details-delete-rule",onClick:rule_actions_overflow_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setIsPopoverOpen(false);_context2.next=3;return deleteRulesAction([rule.id],external_kbnSharedDeps_LodashFp_["noop"],dispatchToaster,onRuleDeletedCallback);case 3:case"end":return _context2.stop()}}),_callee2)})))},rules_translations["L"])]:[],[rule,userHasNoPermissions]);const handlePopoverOpen=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsPopoverOpen(!isPopoverOpen)},[setIsPopoverOpen,isPopoverOpen]);const button=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:ALL_ACTIONS},external_kbnSharedDeps_React_default.a.createElement(MyEuiButtonIcon,{iconType:"boxesHorizontal","aria-label":ALL_ACTIONS,isDisabled:userHasNoPermissions,"data-test-subj":"rules-details-popover-button-icon",onClick:handlePopoverOpen})),[handlePopoverOpen,userHasNoPermissions]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{anchorPosition:"leftCenter",button:button,closePopover:()=>setIsPopoverOpen(false),id:"ruleActionsOverflow",isOpen:isPopoverOpen,"data-test-subj":"rules-details-popover",ownFocus:true,panelPaddingSize:"none",repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{"data-test-subj":"rules-details-menu-panel",items:actions})),external_kbnSharedDeps_React_default.a.createElement(generic_downloader["a"],{filename:"".concat(rules_translations["T"],".ndjson"),ids:rulesToExport,exportSelectedData:api["f"],"data-test-subj":"rules-details-generic-downloader",onExportSuccess:exportCount=>{Object(toasters["e"])(rules_translations["yb"](exportCount),dispatchToaster)}}))};const RuleActionsOverflow=external_kbnSharedDeps_React_default.a.memo(RuleActionsOverflowComponent);RuleActionsOverflow.displayName="RuleActionsOverflow";const RuleStatusFailedCallOutComponent=({date:date,message:message})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},ERROR_CALLOUT_TITLE),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:date,fieldName:"last_failure_at"}))),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,message));const RuleStatusFailedCallOut=Object(external_kbnSharedDeps_React_["memo"])(RuleStatusFailedCallOutComponent);function failure_history_slicedToArray(arr,i){return failure_history_arrayWithHoles(arr)||failure_history_iterableToArrayLimit(arr,i)||failure_history_unsupportedIterableToArray(arr,i)||failure_history_nonIterableRest()}function failure_history_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function failure_history_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return failure_history_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return failure_history_arrayLikeToArray(o,minLen)}function failure_history_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function failure_history_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function failure_history_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const FailureHistoryComponent=({id:id})=>{const _useRuleStatus=useRuleStatus(id),_useRuleStatus2=failure_history_slicedToArray(_useRuleStatus,2),loading=_useRuleStatus2[0],ruleStatus=_useRuleStatus2[1];if(loading){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:LAST_FIVE_ERRORS}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],null))}const columns=[{name:COLUMN_STATUS_TYPE,render:()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"danger"},TYPE_FAILED),truncateText:false,width:"16%"},{field:"last_failure_at",name:COLUMN_FAILED_AT,render:value=>external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:value,fieldName:"last_failure_at"}),sortable:false,truncateText:false,width:"24%"},{field:"last_failure_message",name:COLUMN_FAILED_MSG,render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value),sortable:false,truncateText:false,width:"60%"}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:LAST_FIVE_ERRORS}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{columns:columns,loading:loading,items:ruleStatus!=null?ruleStatus===null||ruleStatus===void 0?void 0:ruleStatus.failures.filter(rs=>rs.last_failure_at!=null):[],sorting:{sort:{field:"status_date",direction:"desc"}}}))};const FailureHistory=Object(external_kbnSharedDeps_React_["memo"])(FailureHistoryComponent);const getStatusColor=status=>status==null?"subdued":status==="succeeded"?"success":status==="failed"?"danger":status==="executing"||status==="going to run"?"warning":"subdued";const STATUS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDescription",{defaultMessage:"Last response"});const STATUS_AT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleStatus.statusAtDescription",{defaultMessage:"at"});const STATUS_DATE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDateDescription",{defaultMessage:"Status date"});const REFRESH=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleStatus.refreshButton",{defaultMessage:"Refresh"});function rule_status_slicedToArray(arr,i){return rule_status_arrayWithHoles(arr)||rule_status_iterableToArrayLimit(arr,i)||rule_status_unsupportedIterableToArray(arr,i)||rule_status_nonIterableRest()}function rule_status_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rule_status_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return rule_status_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rule_status_arrayLikeToArray(o,minLen)}function rule_status_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function rule_status_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function rule_status_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const RuleStatusComponent=({ruleId:ruleId,ruleEnabled:ruleEnabled})=>{var _ruleStatus$current_s,_currentStatus$status,_currentStatus$status2;const _useRuleStatus=useRuleStatus(ruleId),_useRuleStatus2=rule_status_slicedToArray(_useRuleStatus,3),loading=_useRuleStatus2[0],ruleStatus=_useRuleStatus2[1],fetchRuleStatus=_useRuleStatus2[2];const _useState=Object(external_kbnSharedDeps_React_["useState"])(ruleEnabled!==null&&ruleEnabled!==void 0?ruleEnabled:null),_useState2=rule_status_slicedToArray(_useState,2),myRuleEnabled=_useState2[0],setMyRuleEnabled=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])((_ruleStatus$current_s=ruleStatus===null||ruleStatus===void 0?void 0:ruleStatus.current_status)!==null&&_ruleStatus$current_s!==void 0?_ruleStatus$current_s:null),_useState4=rule_status_slicedToArray(_useState3,2),currentStatus=_useState4[0],setCurrentStatus=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(myRuleEnabled!==ruleEnabled&&fetchRuleStatus!=null&&ruleId!=null){fetchRuleStatus(ruleId);if(myRuleEnabled!==ruleEnabled){setMyRuleEnabled(ruleEnabled!==null&&ruleEnabled!==void 0?ruleEnabled:null)}}},[fetchRuleStatus,myRuleEnabled,ruleId,ruleEnabled,setMyRuleEnabled]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!fast_deep_equal_default()(currentStatus,ruleStatus===null||ruleStatus===void 0?void 0:ruleStatus.current_status)){var _ruleStatus$current_s2;setCurrentStatus((_ruleStatus$current_s2=ruleStatus===null||ruleStatus===void 0?void 0:ruleStatus.current_status)!==null&&_ruleStatus$current_s2!==void 0?_ruleStatus$current_s2:null)}},[currentStatus,ruleStatus,setCurrentStatus]);const handleRefresh=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(fetchRuleStatus!=null&&ruleId!=null){fetchRuleStatus(ruleId)}},[fetchRuleStatus,ruleId]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},STATUS,":"),loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m","data-test-subj":"rule-status-loader"})),!loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:getStatusColor((_currentStatus$status=currentStatus===null||currentStatus===void 0?void 0:currentStatus.status)!==null&&_currentStatus$status!==void 0?_currentStatus$status:null)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"ruleStatus",size:"xs"},(_currentStatus$status2=currentStatus===null||currentStatus===void 0?void 0:currentStatus.status)!==null&&_currentStatus$status2!==void 0?_currentStatus$status2:Object(empty_value["d"])()))),(currentStatus===null||currentStatus===void 0?void 0:currentStatus.status_date)!=null&&(currentStatus===null||currentStatus===void 0?void 0:currentStatus.status)!=null&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,STATUS_AT)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:currentStatus===null||currentStatus===void 0?void 0:currentStatus.status_date,fieldName:STATUS_DATE}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"refreshButton",color:"primary",onClick:handleRefresh,iconType:"refresh","aria-label":REFRESH}))))};const RuleStatus=Object(external_kbnSharedDeps_React_["memo"])(RuleStatusComponent);var uuid=__webpack_require__(25);var uuid_default=__webpack_require__.n(uuid);var exceptions_translations=__webpack_require__(132);var loader=__webpack_require__(152);var lists_plugin_deps=__webpack_require__(133);function exceptions_viewer_header_slicedToArray(arr,i){return exceptions_viewer_header_arrayWithHoles(arr)||exceptions_viewer_header_iterableToArrayLimit(arr,i)||exceptions_viewer_header_unsupportedIterableToArray(arr,i)||exceptions_viewer_header_nonIterableRest()}function exceptions_viewer_header_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function exceptions_viewer_header_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return exceptions_viewer_header_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return exceptions_viewer_header_arrayLikeToArray(o,minLen)}function exceptions_viewer_header_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function exceptions_viewer_header_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function exceptions_viewer_header_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ExceptionsViewerHeaderComponent=({isInitLoading:isInitLoading,supportedListTypes:supportedListTypes,detectionsListItems:detectionsListItems,endpointListItems:endpointListItems,onFilterChange:onFilterChange,onAddExceptionClick:onAddExceptionClick})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(""),_useState2=exceptions_viewer_header_slicedToArray(_useState,2),filter=_useState2[0],setFilter=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])([]),_useState4=exceptions_viewer_header_slicedToArray(_useState3,2),tags=_useState4[0],setTags=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=exceptions_viewer_header_slicedToArray(_useState5,2),showDetectionsListsOnly=_useState6[0],setShowDetectionsList=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=exceptions_viewer_header_slicedToArray(_useState7,2),showEndpointListsOnly=_useState8[0],setShowEndpointList=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])(false),_useState10=exceptions_viewer_header_slicedToArray(_useState9,2),isAddExceptionMenuOpen=_useState10[0],setAddExceptionMenuOpen=_useState10[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{onFilterChange({filter:{filter:filter,tags:tags},pagination:{pageIndex:0},showDetectionsListsOnly:showDetectionsListsOnly,showEndpointListsOnly:showEndpointListsOnly})},[filter,tags,showDetectionsListsOnly,showEndpointListsOnly,onFilterChange]);const onAddExceptionDropdownClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setAddExceptionMenuOpen(!isAddExceptionMenuOpen),[setAddExceptionMenuOpen,isAddExceptionMenuOpen]);const handleDetectionsListClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowDetectionsList(!showDetectionsListsOnly);setShowEndpointList(false)},[showDetectionsListsOnly,setShowDetectionsList,setShowEndpointList]);const handleEndpointListClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowEndpointList(!showEndpointListsOnly);setShowDetectionsList(false)},[showEndpointListsOnly,setShowEndpointList,setShowDetectionsList]);const handleOnSearch=Object(external_kbnSharedDeps_React_["useCallback"])(searchValue=>{const tagsRegex=/(tags:[^\s]*)/i;const tagsMatch=searchValue.match(tagsRegex);const foundTags=tagsMatch!=null?tagsMatch[0].split(":")[1]:"";const filterString=tagsMatch!=null?searchValue.replace(tagsRegex,""):searchValue;if(foundTags.length>0){setTags(foundTags.split(","))}setFilter(filterString.trim())},[setTags,setFilter]);const onAddException=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{onAddExceptionClick(type);setAddExceptionMenuOpen(false)},[onAddExceptionClick,setAddExceptionMenuOpen]);const addExceptionButtonOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{id:0,items:[{name:exceptions_translations["g"],onClick:()=>onAddException(lists_plugin_deps["a"].ENDPOINT),"data-test-subj":"addEndpointExceptionBtn"},{name:exceptions_translations["f"],onClick:()=>onAddException(lists_plugin_deps["a"].DETECTION),"data-test-subj":"addDetectionsExceptionBtn"}]}],[onAddException]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldSearch"],{"data-test-subj":"exceptionsHeaderSearch","aria-label":exceptions_translations["I"],placeholder:exceptions_translations["I"],onSearch:handleOnSearch,disabled:isInitLoading,incremental:false,fullWidth:true})),supportedListTypes.length<2&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"exceptionsHeaderAddExceptionBtn",onClick:()=>onAddException(supportedListTypes[0]),isDisabled:isInitLoading,fill:true},exceptions_translations["d"])),supportedListTypes.length>1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterGroup"],{"data-test-subj":"exceptionsFilterGroupBtns"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{"data-test-subj":"exceptionsDetectionFilterBtn",hasActiveFilters:showDetectionsListsOnly,onClick:handleDetectionsListClick,isDisabled:isInitLoading},exceptions_translations["r"],detectionsListItems!=null?" (".concat(detectionsListItems,")"):""),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{"data-test-subj":"exceptionsEndpointFilterBtn",hasActiveFilters:showEndpointListsOnly,onClick:handleEndpointListClick,isDisabled:isInitLoading},exceptions_translations["v"],endpointListItems!=null?" (".concat(endpointListItems,")"):""))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"exceptionsHeaderAddExceptionPopoverBtn",onClick:onAddExceptionDropdownClick,isDisabled:isInitLoading,iconType:"arrowDown",iconSide:"right",fill:true},exceptions_translations["d"]),isOpen:isAddExceptionMenuOpen,closePopover:onAddExceptionDropdownClick,anchorPosition:"downCenter",panelPaddingSize:"none",repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenu"],{initialPanelId:0,panels:addExceptionButtonOptions}))))))};ExceptionsViewerHeaderComponent.displayName="ExceptionsViewerHeaderComponent";const ExceptionsViewerHeader=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerHeaderComponent);ExceptionsViewerHeader.displayName="ExceptionsViewerHeader";function viewer_reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function viewer_reducer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){viewer_reducer_ownKeys(Object(source),true).forEach((function(key){viewer_reducer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{viewer_reducer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function viewer_reducer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const allExceptionItemsReducer=()=>(state,action)=>{switch(action.type){case"setExceptions":{var _pagination$total;const exceptions=action.exceptions,pagination=action.pagination;return viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state),{},{pagination:viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state.pagination),{},{pageIndex:pagination.page-1,pageSize:pagination.perPage,totalItemCount:(_pagination$total=pagination.total)!==null&&_pagination$total!==void 0?_pagination$total:0}),exceptions:exceptions})}case"updateFilterOptions":{const _action$filters=action.filters,filter=_action$filters.filter,pagination=_action$filters.pagination,showEndpointListsOnly=_action$filters.showEndpointListsOnly,showDetectionsListsOnly=_action$filters.showDetectionsListsOnly;return viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state),{},{filterOptions:viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state.filterOptions),filter),pagination:viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state.pagination),pagination),showEndpointListsOnly:showEndpointListsOnly!==null&&showEndpointListsOnly!==void 0?showEndpointListsOnly:state.showEndpointListsOnly,showDetectionsListsOnly:showDetectionsListsOnly!==null&&showDetectionsListsOnly!==void 0?showDetectionsListsOnly:state.showDetectionsListsOnly})}case"setExceptionItemTotals":{return viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state),{},{totalEndpointItems:action.totalEndpointItems==null?state.totalEndpointItems:action.totalEndpointItems,totalDetectionsItems:action.totalDetectionsItems==null?state.totalDetectionsItems:action.totalDetectionsItems})}case"updateIsInitLoading":{return viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state),{},{isInitLoading:action.loading})}case"updateLoadingItemIds":{return viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state),{},{loadingItemIds:[...state.loadingItemIds,...action.items]})}case"updateExceptionToEdit":{const exception=action.exception,lists=action.lists;const exceptionListToEdit=lists.find(list=>list!==null&&exception.list_id===list.listId);return viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state),{},{exceptionToEdit:exception,exceptionListTypeToEdit:exceptionListToEdit?exceptionListToEdit.type:null})}case"updateModalOpen":{return viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state),{},{currentModal:action.modalName})}case"updateExceptionListTypeToEdit":{return viewer_reducer_objectSpread(viewer_reducer_objectSpread({},state),{},{exceptionListTypeToEdit:action.exceptionListType})}default:return state}};function exceptions_pagination_slicedToArray(arr,i){return exceptions_pagination_arrayWithHoles(arr)||exceptions_pagination_iterableToArrayLimit(arr,i)||exceptions_pagination_unsupportedIterableToArray(arr,i)||exceptions_pagination_nonIterableRest()}function exceptions_pagination_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function exceptions_pagination_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return exceptions_pagination_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return exceptions_pagination_arrayLikeToArray(o,minLen)}function exceptions_pagination_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function exceptions_pagination_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function exceptions_pagination_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ExceptionsViewerPaginationComponent=({pagination:pagination,onPaginationChange:onPaginationChange})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=exceptions_pagination_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];const handleClosePerPageMenu=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setIsOpen(false),[setIsOpen]);const handlePerPageMenuClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setIsOpen(isPopoverOpen=>!isPopoverOpen),[setIsOpen]);const handlePageClick=Object(external_kbnSharedDeps_React_["useCallback"])(pageIndex=>{onPaginationChange({pagination:{pageIndex:pageIndex,pageSize:pagination.pageSize,totalItemCount:pagination.totalItemCount}})},[pagination,onPaginationChange]);const items=Object(external_kbnSharedDeps_React_["useMemo"])(()=>pagination.pageSizeOptions.map(rows=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rows,icon:"empty",onClick:()=>{onPaginationChange({pagination:{pageIndex:0,pageSize:rows,totalItemCount:pagination.totalItemCount}});handleClosePerPageMenu()},"data-test-subj":"exceptionsPerPageItem"},exceptions_translations["D"](rows))),[pagination,onPaginationChange,handleClosePerPageMenu]);const totalPages=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(pagination.totalItemCount>0){return Math.ceil(pagination.totalItemCount/pagination.pageSize)}else{return 1}},[pagination]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:handlePerPageMenuClick,"data-test-subj":"exceptionsPerPageBtn"},exceptions_translations["B"](pagination.pageSize)),isOpen:isOpen,closePopover:handleClosePerPageMenu,panelPaddingSize:"none",repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:items}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPagination"],{pageCount:totalPages,activePage:pagination.pageIndex,onPageClick:handlePageClick,"data-test-subj":"exceptionsPagination"})))};ExceptionsViewerPaginationComponent.displayName="ExceptionsViewerPaginationComponent";const ExceptionsViewerPagination=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerPaginationComponent);ExceptionsViewerPagination.displayName="ExceptionsViewerPagination";const StyledText=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiText"]).withConfig({displayName:"StyledText",componentId:"oztuyc-0"})(["font-style:italic;"]);const MyUtilities=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyUtilities",componentId:"oztuyc-1"})(["height:50px;"]);const ExceptionsViewerUtilityComponent=({pagination:pagination,showEndpointListsOnly:showEndpointListsOnly,showDetectionsListsOnly:showDetectionsListsOnly,ruleSettingsUrl:ruleSettingsUrl,onRefreshClick:onRefreshClick})=>{var _pagination$totalItem;return external_kbnSharedDeps_React_default.a.createElement(MyUtilities,{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(utility_bar["a"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["d"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"exceptionsShowing"},exceptions_translations["J"]((_pagination$totalItem=pagination.totalItemCount)!==null&&_pagination$totalItem!==void 0?_pagination$totalItem:0))),external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"exceptionsRefresh",iconSide:"left",iconType:"refresh",onClick:onRefreshClick},exceptions_translations["G"]))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(StyledText,{size:"s"},showEndpointListsOnly&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.exceptions.viewer.exceptionEndpointDetailsDescription",defaultMessage:"All exceptions to this rule are applied to the endpoint and the detection rule. View {ruleSettings} for more details.","data-test-subj":"exceptionsEndpointMessage",values:{ruleSettings:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:ruleSettingsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.exceptions.viewer.exceptionEndpointDetailsDescription.ruleSettingsLink",defaultMessage:"rule settings"}))}}),showDetectionsListsOnly&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.exceptions.viewer.exceptionDetectionDetailsDescription",defaultMessage:"All exceptions to this rule are applied to the detection rule, not the endpoint. View {ruleSettings} for more details.","data-test-subj":"exceptionsDetectionsMessage",values:{ruleSettings:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:ruleSettingsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.exceptions.viewer.exceptionDetectionDetailsDescription.ruleSettingsLink",defaultMessage:"rule settings"}))}}))))};ExceptionsViewerUtilityComponent.displayName="ExceptionsViewerUtilityComponent";const ExceptionsViewerUtility=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerUtilityComponent);ExceptionsViewerUtility.displayName="ExceptionsViewerUtility";var exceptions_helpers=__webpack_require__(192);function viewer_helpers_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function viewer_helpers_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){viewer_helpers_ownKeys(Object(source),true).forEach((function(key){viewer_helpers_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{viewer_helpers_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function viewer_helpers_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const formatEntry=({isNested:isNested,item:item})=>{var _item$field;const operator=Object(exceptions_helpers["k"])(item);const value=Object(exceptions_helpers["j"])(item);return{fieldName:(_item$field=item.field)!==null&&_item$field!==void 0?_item$field:"",operator:operator.message,value:value,isNested:isNested}};const helpers_getFormattedEntries=entries=>{const formattedEntries=entries.map(item=>{if(lists_plugin_deps["h"].is(item)){const parent={fieldName:item.field,operator:undefined,value:undefined,isNested:false};return item.entries.reduce((acc,nestedEntry)=>{const formattedEntry=formatEntry({isNested:true,item:nestedEntry});return[...acc,viewer_helpers_objectSpread({},formattedEntry)]},[parent])}else{return formatEntry({isNested:false,item:item})}});return formattedEntries.flat()};const getDescriptionListContent=exceptionItem=>{const details=[{title:exceptions_translations["E"],value:Object(exceptions_helpers["i"])(exceptionItem.os_types)},{title:exceptions_translations["o"],value:external_kbnSharedDeps_Moment_default()(exceptionItem.created_at).format("MMMM Do YYYY @ HH:mm:ss")},{title:exceptions_translations["n"],value:exceptionItem.created_by},{title:exceptions_translations["q"],value:exceptionItem.description}];return details.reduce((acc,{value:value,title:title})=>{if(value!=null&&value.trim()!==""){return[...acc,{title:title,description:value}]}else{return acc}},[])};const MyExceptionDetails=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyExceptionDetails",componentId:"z36hrg-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["background-color:",";padding:",";"],theme.eui.euiColorLightestShade,theme.eui.euiSize));const MyDescriptionListTitle=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"]).withConfig({displayName:"MyDescriptionListTitle",componentId:"z36hrg-1"})(["width:40%;"]);const MyDescriptionListDescription=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"]).withConfig({displayName:"MyDescriptionListDescription",componentId:"z36hrg-2"})(["width:60%;"]);const ExceptionDetailsComponent=({showComments:showComments,onCommentsClick:onCommentsClick,exceptionItem:exceptionItem})=>{const descriptionListItems=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getDescriptionListContent(exceptionItem),[exceptionItem]);const commentsSection=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const comments=exceptionItem.comments;if(comments.length>0){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onCommentsClick,flush:"left",size:"xs","data-test-subj":"exceptionsViewerItemCommentsBtn"},!showComments?exceptions_translations["l"](comments.length):exceptions_translations["k"](comments.length))}else{return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null)}},[showComments,onCommentsClick,exceptionItem]);return external_kbnSharedDeps_React_default.a.createElement(MyExceptionDetails,{grow:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{compressed:true,type:"column","data-test-subj":"exceptionsViewerItemDetails"},descriptionListItems.map(item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:"".concat(item.title)},external_kbnSharedDeps_React_default.a.createElement(MyDescriptionListTitle,null,item.title),external_kbnSharedDeps_React_default.a.createElement(MyDescriptionListDescription,null,item.description))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},commentsSection)))};ExceptionDetailsComponent.displayName="ExceptionDetailsComponent";const ExceptionDetails=external_kbnSharedDeps_React_default.a.memo(ExceptionDetailsComponent);ExceptionDetails.displayName="ExceptionDetails";var polished_lib=__webpack_require__(170);const MyEntriesDetails=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyEntriesDetails",componentId:"sc-1tpcxfd-0"})(["padding:",";"],({theme:theme})=>theme.eui.euiSize);const MyEditButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButton"]).withConfig({displayName:"MyEditButton",componentId:"sc-1tpcxfd-1"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["background-color:",";border:none;font-weight:",";"],Object(polished_lib["transparentize"])(.9,theme.eui.euiColorPrimary),theme.eui.euiFontWeightSemiBold));const MyRemoveButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButton"]).withConfig({displayName:"MyRemoveButton",componentId:"sc-1tpcxfd-2"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["background-color:",";border:none;font-weight:",";"],Object(polished_lib["transparentize"])(.9,theme.eui.euiColorDanger),theme.eui.euiFontWeightSemiBold));const MyAndOrBadgeContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyAndOrBadgeContainer",componentId:"sc-1tpcxfd-3"})(["padding-top:",";padding-bottom:",";"],({theme:theme})=>theme.eui.euiSizeXL,({theme:theme})=>theme.eui.euiSizeS);const MyActionButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyActionButton",componentId:"sc-1tpcxfd-4"})(["align-self:flex-end;"]);const MyNestedValueContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MyNestedValueContainer",componentId:"sc-1tpcxfd-5"})(["margin-left:",";"],({theme:theme})=>theme.eui.euiSizeL);const MyNestedValue=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"MyNestedValue",componentId:"sc-1tpcxfd-6"})(["margin-left:",";"],({theme:theme})=>theme.eui.euiSizeS);const ValueBadgeGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBadgeGroup"]).withConfig({displayName:"ValueBadgeGroup",componentId:"sc-1tpcxfd-7"})(["width:100%;"]);const ExceptionEntriesComponent=({entries:entries,disableDelete:disableDelete,onDelete:onDelete,onEdit:onEdit})=>{const columns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{field:"fieldName",name:"Field",sortable:false,truncateText:true,textOnly:true,"data-test-subj":"exceptionFieldNameCell",width:"30%",render:(value,data)=>{if(value!=null&&data.isNested){return external_kbnSharedDeps_React_default.a.createElement(MyNestedValueContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{type:"nested",size:"s"}),external_kbnSharedDeps_React_default.a.createElement(MyNestedValue,null,value))}else{return value!==null&&value!==void 0?value:Object(empty_value["e"])()}}},{field:"operator",name:"Operator",sortable:false,truncateText:true,"data-test-subj":"exceptionFieldOperatorCell",width:"20%",render:value=>value!==null&&value!==void 0?value:Object(empty_value["e"])()},{field:"value",name:"Value",sortable:false,truncateText:true,"data-test-subj":"exceptionFieldValueCell",width:"60%",render:values=>{if(Array.isArray(values)){return external_kbnSharedDeps_React_default.a.createElement(ValueBadgeGroup,{gutterSize:"xs"},values.map(value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"#DDD",key:value},value)))}else{return values!==null&&values!==void 0?values:Object(empty_value["e"])()}}}],[entries]);return external_kbnSharedDeps_React_default.a.createElement(MyEntriesDetails,{grow:5},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",gutterSize:"none"},entries.length>1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHideFor"],{sizes:["xs","s"]},external_kbnSharedDeps_React_default.a.createElement(MyAndOrBadgeContainer,{grow:false},external_kbnSharedDeps_React_default.a.createElement(and_or_badge["a"],{type:"and",includeAntennas:true,"data-test-subj":"exceptionsViewerAndBadge"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{isSelectable:false,itemId:"id",columns:columns,items:entries,responsive:true})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(MyActionButton,{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyEditButton,{size:"s",color:"primary",onClick:onEdit,isDisabled:disableDelete,"data-test-subj":"exceptionsViewerEditBtn"},exceptions_translations["u"])),external_kbnSharedDeps_React_default.a.createElement(MyActionButton,{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyRemoveButton,{size:"s",color:"danger",onClick:onDelete,isLoading:disableDelete,"data-test-subj":"exceptionsViewerDeleteBtn"},exceptions_translations["H"]))))))};ExceptionEntriesComponent.displayName="ExceptionEntriesComponent";const ExceptionEntries=external_kbnSharedDeps_React_default.a.memo(ExceptionEntriesComponent);ExceptionEntries.displayName="ExceptionEntries";function exception_item_slicedToArray(arr,i){return exception_item_arrayWithHoles(arr)||exception_item_iterableToArrayLimit(arr,i)||exception_item_unsupportedIterableToArray(arr,i)||exception_item_nonIterableRest()}function exception_item_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function exception_item_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return exception_item_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return exception_item_arrayLikeToArray(o,minLen)}function exception_item_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function exception_item_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function exception_item_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const MyFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyFlexItem",componentId:"l5qlm8-0"})(["&.comments--show{padding:",";border-top:",";}"],({theme:theme})=>theme.eui.euiSize,({theme:theme})=>"".concat(theme.eui.euiBorderThin));const ExceptionItemComponent=({loadingItemIds:loadingItemIds,exceptionItem:exceptionItem,commentsAccordionId:commentsAccordionId,onDeleteException:onDeleteException,onEditException:onEditException})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])([]),_useState2=exception_item_slicedToArray(_useState,2),entryItems=_useState2[0],setEntryItems=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=exception_item_slicedToArray(_useState3,2),showComments=_useState4[0],setShowComments=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const formattedEntries=helpers_getFormattedEntries(exceptionItem.entries);setEntryItems(formattedEntries)},[exceptionItem.entries]);const handleDelete=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{onDeleteException({id:exceptionItem.id,namespaceType:exceptionItem.namespace_type})},[onDeleteException,exceptionItem.id,exceptionItem.namespace_type]);const handleEdit=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{onEditException(exceptionItem)},[onEditException,exceptionItem]);const onCommentsClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowComments(!showComments)},[setShowComments,showComments]);const formattedComments=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(exceptions_helpers["l"])(exceptionItem.comments),[exceptionItem.comments]);const disableDelete=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const foundItems=loadingItemIds.filter(({id:id})=>id===exceptionItem.id);return foundItems.length>0},[loadingItemIds,exceptionItem.id]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row"},external_kbnSharedDeps_React_default.a.createElement(ExceptionDetails,{showComments:showComments,exceptionItem:exceptionItem,onCommentsClick:onCommentsClick}),external_kbnSharedDeps_React_default.a.createElement(ExceptionEntries,{disableDelete:disableDelete,entries:entryItems,onDelete:handleDelete,onEdit:handleEdit}))),external_kbnSharedDeps_React_default.a.createElement(MyFlexItem,{className:showComments?"comments--show":""},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{id:commentsAccordionId,arrowDisplay:"none",forceState:showComments?"open":"closed","data-test-subj":"exceptionsViewerCommentAccordion"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCommentList"],{comments:formattedComments})))))};ExceptionItemComponent.displayName="ExceptionItemComponent";const ExceptionItem=external_kbnSharedDeps_React_default.a.memo(ExceptionItemComponent);ExceptionItem.displayName="ExceptionItem";const exceptions_viewer_items_MyFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyFlexItem",componentId:"z8zhds-0"})(["margin:",";&:first-child{margin:",";}"],({theme:theme})=>"".concat(theme.eui.euiSize," 0"),({theme:theme})=>"".concat(theme.eui.euiSizeXS," 0 ").concat(theme.eui.euiSize));const MyExceptionsContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyExceptionsContainer",componentId:"z8zhds-1"})(["height:600px;overflow:hidden;"]);const MyExceptionItemContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyExceptionItemContainer",componentId:"z8zhds-2"})(["margin:",";"],({theme:theme})=>"0 ".concat(theme.eui.euiSize," ").concat(theme.eui.euiSize," 0"));const ExceptionsViewerItemsComponent=({showEmpty:showEmpty,showNoResults:showNoResults,isInitLoading:isInitLoading,exceptions:exceptions,loadingItemIds:loadingItemIds,commentsAccordionId:commentsAccordionId,onDeleteException:onDeleteException,onEditExceptionItem:onEditExceptionItem})=>external_kbnSharedDeps_React_default.a.createElement(MyExceptionsContainer,{direction:"column",className:"eui-yScrollWithShadows"},showEmpty||showNoResults||isInitLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:showNoResults?"searchProfilerApp":"list",title:external_kbnSharedDeps_React_default.a.createElement("h2",{"data-test-subj":"exceptionsEmptyPromptTitle"},showNoResults?"":exceptions_translations["y"]),body:external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"exceptionsEmptyPromptBody"},showNoResults?exceptions_translations["z"]:exceptions_translations["x"]),"data-test-subj":"exceptionsEmptyPrompt"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"eui-yScrollWithShadows"},external_kbnSharedDeps_React_default.a.createElement(MyExceptionItemContainer,{"data-test-subj":"exceptionsContainer",gutterSize:"none",direction:"column"},!isInitLoading&&exceptions.length>0&&exceptions.map((exception,index)=>external_kbnSharedDeps_React_default.a.createElement(exceptions_viewer_items_MyFlexItem,{"data-test-subj":"exceptionItemContainer",grow:false,key:exception.id},index!==0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(and_or_badge["a"],{"data-test-subj":"exceptionItemOrBadge",type:"or"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ExceptionItem,{loadingItemIds:loadingItemIds,commentsAccordionId:commentsAccordionId,exceptionItem:exception,onDeleteException:onDeleteException,onEditException:onEditExceptionItem}))))));ExceptionsViewerItemsComponent.displayName="ExceptionsViewerItemsComponent";const ExceptionsViewerItems=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerItemsComponent);ExceptionsViewerItems.displayName="ExceptionsViewerItems";var use_signal_index=__webpack_require__(244);var use_rule_async=__webpack_require__(418);const translations_CANCEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.cancel",{defaultMessage:"Cancel"});const EDIT_EXCEPTION_SAVE_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.editExceptionSaveButton",{defaultMessage:"Save"});const EDIT_EXCEPTION_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.editExceptionTitle",{defaultMessage:"Edit Rule Exception"});const EDIT_ENDPOINT_EXCEPTION_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit Endpoint Exception"});const EDIT_EXCEPTION_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.error",{defaultMessage:"Failed to update exception"});const EDIT_EXCEPTION_SUCCESS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.success",{defaultMessage:"Successfully updated exception"});const BULK_CLOSE_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by this rule"});const BULK_CLOSE_LABEL_DISABLED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"});const ENDPOINT_QUARANTINE_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."});const EXCEPTION_BUILDER_INFO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"});const VERSION_CONFLICT_ERROR_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.versionConflictTitle",{defaultMessage:"Sorry, there was an error"});const VERSION_CONFLICT_ERROR_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.versionConflictDescription",{defaultMessage:"It appears this exception was updated since you first selected to edit it. Try clicking 'Cancel' and editing the exception again."});const EDIT_EXCEPTION_SEQUENCE_WARNING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.sequenceWarning",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."});var builder=__webpack_require__(679);var use_add_exception=__webpack_require__(622);var add_exception_comments=__webpack_require__(623);var error_callout=__webpack_require__(721);function edit_exception_modal_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function edit_exception_modal_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){edit_exception_modal_ownKeys(Object(source),true).forEach((function(key){edit_exception_modal_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{edit_exception_modal_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function edit_exception_modal_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function edit_exception_modal_slicedToArray(arr,i){return edit_exception_modal_arrayWithHoles(arr)||edit_exception_modal_iterableToArrayLimit(arr,i)||edit_exception_modal_unsupportedIterableToArray(arr,i)||edit_exception_modal_nonIterableRest()}function edit_exception_modal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function edit_exception_modal_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return edit_exception_modal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return edit_exception_modal_arrayLikeToArray(o,minLen)}function edit_exception_modal_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function edit_exception_modal_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function edit_exception_modal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const Modal=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiModal"]).withConfig({displayName:"Modal",componentId:"sc-1xmfgey-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["width:",";max-width:",";"],theme.eui.euiBreakpoints.l,theme.eui.euiBreakpoints.l));const ModalHeader=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiModalHeader"]).withConfig({displayName:"ModalHeader",componentId:"sc-1xmfgey-1"})(["flex-direction:column;align-items:flex-start;"]);const ModalHeaderSubtitle=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ModalHeaderSubtitle",componentId:"sc-1xmfgey-2"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["color:",";"],theme.eui.euiColorMediumShade));const ModalBodySection=external_kbnSharedDeps_StyledComponents_default.a.section.withConfig({displayName:"ModalBodySection",componentId:"sc-1xmfgey-3"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["padding:"," ",";&.builder-section{overflow-y:scroll;}"],theme.eui.euiSizeS,theme.eui.euiSizeL));const edit_exception_modal_EditExceptionModal=Object(external_kbnSharedDeps_React_["memo"])((function EditExceptionModal({ruleName:ruleName,ruleId:ruleId,ruleIndices:ruleIndices,exceptionItem:exceptionItem,exceptionListType:exceptionListType,onCancel:onCancel,onConfirm:onConfirm,onRuleChange:onRuleChange}){const http=Object(lib_kibana["h"])().services.http;const _useState=Object(external_kbnSharedDeps_React_["useState"])(""),_useState2=edit_exception_modal_slicedToArray(_useState,2),comment=_useState2[0],setComment=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=edit_exception_modal_slicedToArray(_useState3,2),errorsExist=_useState4[0],setErrorExists=_useState4[1];const _useRuleAsync=Object(use_rule_async["a"])(ruleId),maybeRule=_useRuleAsync.rule;const _useState5=Object(external_kbnSharedDeps_React_["useState"])(null),_useState6=edit_exception_modal_slicedToArray(_useState5,2),updateError=_useState6[0],setUpdateError=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=edit_exception_modal_slicedToArray(_useState7,2),hasVersionConflict=_useState8[0],setHasVersionConflict=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])(false),_useState10=edit_exception_modal_slicedToArray(_useState9,2),shouldBulkCloseAlert=_useState10[0],setShouldBulkCloseAlert=_useState10[1];const _useState11=Object(external_kbnSharedDeps_React_["useState"])(false),_useState12=edit_exception_modal_slicedToArray(_useState11,2),shouldDisableBulkClose=_useState12[0],setShouldDisableBulkClose=_useState12[1];const _useState13=Object(external_kbnSharedDeps_React_["useState"])([]),_useState14=edit_exception_modal_slicedToArray(_useState13,2),exceptionItemsToAdd=_useState14[0],setExceptionItemsToAdd=_useState14[1];const _useAppToasts=Object(use_app_toasts["a"])(),addError=_useAppToasts.addError,addSuccess=_useAppToasts.addSuccess;const _useSignalIndex=Object(use_signal_index["a"])(),isSignalIndexLoading=_useSignalIndex.loading,signalIndexName=_useSignalIndex.signalIndexName;const memoSignalIndexName=Object(external_kbnSharedDeps_React_["useMemo"])(()=>signalIndexName!==null?[signalIndexName]:[],[signalIndexName]);const _useFetchIndex=Object(source["b"])(memoSignalIndexName),_useFetchIndex2=edit_exception_modal_slicedToArray(_useFetchIndex,2),isSignalIndexPatternLoading=_useFetchIndex2[0],signalIndexPatterns=_useFetchIndex2[1].indexPatterns;const _useFetchIndex3=Object(source["b"])(ruleIndices),_useFetchIndex4=edit_exception_modal_slicedToArray(_useFetchIndex3,2),isIndexPatternLoading=_useFetchIndex4[0],indexPatterns=_useFetchIndex4[1].indexPatterns;const handleExceptionUpdateError=Object(external_kbnSharedDeps_React_["useCallback"])((error,statusCode,message)=>{if(error.message.includes("Conflict")){setHasVersionConflict(true)}else{setUpdateError({reason:error.message,code:statusCode,details:message,listListId:exceptionItem.list_id})}},[setUpdateError,setHasVersionConflict,exceptionItem.list_id]);const handleDissasociationSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{addSuccess(exceptions_translations["t"](id));if(onRuleChange){onRuleChange()}onCancel()},[addSuccess,onCancel,onRuleChange]);const handleDissasociationError=Object(external_kbnSharedDeps_React_["useCallback"])(error=>{addError(error,{title:exceptions_translations["s"]});onCancel()},[addError,onCancel]);const handleExceptionUpdateSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{addSuccess(EDIT_EXCEPTION_SUCCESS);onConfirm()},[addSuccess,onConfirm]);const _useAddOrUpdateExcept=Object(use_add_exception["a"])({http:http,onSuccess:handleExceptionUpdateSuccess,onError:handleExceptionUpdateError}),_useAddOrUpdateExcept2=edit_exception_modal_slicedToArray(_useAddOrUpdateExcept,2),addExceptionIsLoading=_useAddOrUpdateExcept2[0].isLoading,addOrUpdateExceptionItems=_useAddOrUpdateExcept2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isSignalIndexPatternLoading===false&&isSignalIndexLoading===false){setShouldDisableBulkClose(Object(exceptions_helpers["e"])(exceptionItemsToAdd)||Object(exceptions_helpers["f"])(exceptionItemsToAdd,signalIndexPatterns)||exceptionItemsToAdd.every(item=>item.entries.length===0))}},[setShouldDisableBulkClose,exceptionItemsToAdd,isSignalIndexPatternLoading,isSignalIndexLoading,signalIndexPatterns]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(shouldDisableBulkClose===true){setShouldBulkCloseAlert(false)}},[shouldDisableBulkClose]);const isSubmitButtonDisabled=Object(external_kbnSharedDeps_React_["useMemo"])(()=>exceptionItemsToAdd.every(item=>item.entries.length===0)||hasVersionConflict||errorsExist,[exceptionItemsToAdd,hasVersionConflict,errorsExist]);const handleBuilderOnChange=Object(external_kbnSharedDeps_React_["useCallback"])(({exceptionItems:exceptionItems,errorExists:errorExists})=>{setExceptionItemsToAdd(exceptionItems);setErrorExists(errorExists)},[setExceptionItemsToAdd]);const onCommentChange=Object(external_kbnSharedDeps_React_["useCallback"])(value=>{setComment(value)},[setComment]);const onBulkCloseAlertCheckboxChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{setShouldBulkCloseAlert(event.currentTarget.checked)},[setShouldBulkCloseAlert]);const enrichExceptionItems=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const _exceptionItemsToAdd=edit_exception_modal_slicedToArray(exceptionItemsToAdd,1),exceptionItemToEdit=_exceptionItemsToAdd[0];let enriched=[edit_exception_modal_objectSpread({},Object(exceptions_helpers["c"])(exceptionItemToEdit,[...exceptionItem.comments,...comment.trim()!==""?[{comment:comment}]:[]]))];if(exceptionListType==="endpoint"){enriched=Object(exceptions_helpers["n"])(Object(exceptions_helpers["b"])(enriched,exceptionItem.os_types))}return enriched},[exceptionItemsToAdd,exceptionItem,comment,exceptionListType]);const onEditExceptionConfirm=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(addOrUpdateExceptionItems!==null){const bulkCloseIndex=shouldBulkCloseAlert&&signalIndexName!==null?[signalIndexName]:undefined;addOrUpdateExceptionItems(ruleId,enrichExceptionItems(),undefined,bulkCloseIndex)}},[addOrUpdateExceptionItems,ruleId,enrichExceptionItems,shouldBulkCloseAlert,signalIndexName]);const isRuleEQLSequenceStatement=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(maybeRule!=null){return Object(utils["c"])(maybeRule.type)&&Object(utils["a"])(maybeRule.query)}return false},[maybeRule]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],{onClick:onCancel},external_kbnSharedDeps_React_default.a.createElement(Modal,{onClose:onCancel,"data-test-subj":"add-exception-modal"},external_kbnSharedDeps_React_default.a.createElement(ModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalHeaderTitle"],null,exceptionListType==="endpoint"?EDIT_ENDPOINT_EXCEPTION_TITLE:EDIT_EXCEPTION_TITLE),external_kbnSharedDeps_React_default.a.createElement(ModalHeaderSubtitle,{className:"eui-textTruncate",title:ruleName},ruleName)),(addExceptionIsLoading||isIndexPatternLoading||isSignalIndexLoading)&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loadingEditExceptionModal",size:"xl"}),!isSignalIndexLoading&&!addExceptionIsLoading&&!isIndexPatternLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,{className:"builder-section"},isRuleEQLSequenceStatement&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{"data-test-subj":"eql-sequence-callout",title:EDIT_EXCEPTION_SEQUENCE_WARNING}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,EXCEPTION_BUILDER_INFO),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(builder["a"],{exceptionListItems:[exceptionItem],listType:exceptionListType,listId:exceptionItem.list_id,listNamespaceType:exceptionItem.namespace_type,ruleName:ruleName,isOrDisabled:true,isAndDisabled:false,isNestedDisabled:false,"data-test-subj":"edit-exception-modal-builder","id-aria":"edit-exception-modal-builder",onChange:handleBuilderOnChange,indexPatterns:indexPatterns,ruleType:maybeRule===null||maybeRule===void 0?void 0:maybeRule.type}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(add_exception_comments["a"],{exceptionItemComments:exceptionItem.comments,newCommentValue:comment,newCommentOnChange:onCommentChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{"data-test-subj":"close-alert-on-add-edit-exception-checkbox",id:"close-alert-on-add-edit-exception-checkbox",label:shouldDisableBulkClose?BULK_CLOSE_LABEL_DISABLED:BULK_CLOSE_LABEL,checked:shouldBulkCloseAlert,onChange:onBulkCloseAlertCheckboxChange,disabled:shouldDisableBulkClose})),exceptionListType==="endpoint"&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"edit-exception-endpoint-text",color:"subdued",size:"s"},ENDPOINT_QUARANTINE_TEXT)))),updateError!=null&&external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,null,external_kbnSharedDeps_React_default.a.createElement(error_callout["a"],{http:http,errorInfo:updateError,rule:maybeRule,onCancel:onCancel,onSuccess:handleDissasociationSuccess,onError:handleDissasociationError})),hasVersionConflict&&external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:VERSION_CONFLICT_ERROR_TITLE,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,VERSION_CONFLICT_ERROR_DESCRIPTION))),updateError==null&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onCancel},translations_CANCEL),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"edit-exception-confirm-button",onClick:onEditExceptionConfirm,isLoading:addExceptionIsLoading,isDisabled:isSubmitButtonDisabled,fill:true},EDIT_EXCEPTION_SAVE_BUTTON))))}));var add_exception_modal=__webpack_require__(695);function viewer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function viewer_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){viewer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){viewer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function viewer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function viewer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){viewer_ownKeys(Object(source),true).forEach((function(key){viewer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{viewer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function viewer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function viewer_slicedToArray(arr,i){return viewer_arrayWithHoles(arr)||viewer_iterableToArrayLimit(arr,i)||viewer_unsupportedIterableToArray(arr,i)||viewer_nonIterableRest()}function viewer_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function viewer_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return viewer_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return viewer_arrayLikeToArray(o,minLen)}function viewer_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function viewer_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function viewer_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const viewer_initialState={filterOptions:{filter:"",tags:[]},pagination:{pageIndex:0,pageSize:20,totalItemCount:0,pageSizeOptions:[5,10,20,50,100,200,300]},exceptions:[],exceptionToEdit:null,loadingItemIds:[],isInitLoading:true,currentModal:null,exceptionListTypeToEdit:null,totalEndpointItems:0,totalDetectionsItems:0,showEndpointListsOnly:false,showDetectionsListsOnly:false};const ExceptionsViewerComponent=({ruleId:ruleId,ruleName:ruleName,ruleIndices:ruleIndices,exceptionListsMeta:exceptionListsMeta,availableListTypes:availableListTypes,commentsAccordionId:commentsAccordionId,onRuleChange:onRuleChange})=>{const _useKibana=Object(lib_kibana["h"])(),services=_useKibana.services;const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=viewer_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const onDispatchToaster=Object(external_kbnSharedDeps_React_["useCallback"])(({title:title,color:color,iconType:iconType})=>()=>{dispatchToaster({type:"addToaster",toast:{id:uuid_default.a.v4(),title:title,color:color,iconType:iconType}})},[dispatchToaster]);const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(allExceptionItemsReducer(),viewer_objectSpread({},viewer_initialState)),_useReducer2=viewer_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],exceptions=_useReducer2$.exceptions,filterOptions=_useReducer2$.filterOptions,pagination=_useReducer2$.pagination,loadingItemIds=_useReducer2$.loadingItemIds,isInitLoading=_useReducer2$.isInitLoading,currentModal=_useReducer2$.currentModal,exceptionToEdit=_useReducer2$.exceptionToEdit,exceptionListTypeToEdit=_useReducer2$.exceptionListTypeToEdit,totalEndpointItems=_useReducer2$.totalEndpointItems,totalDetectionsItems=_useReducer2$.totalDetectionsItems,showDetectionsListsOnly=_useReducer2$.showDetectionsListsOnly,showEndpointListsOnly=_useReducer2$.showEndpointListsOnly,dispatch=_useReducer2[1];const _useApi=Object(lists_plugin_deps["l"])(services.http),deleteExceptionItem=_useApi.deleteExceptionItem,getExceptionListsItems=_useApi.getExceptionListsItems;const setExceptions=Object(external_kbnSharedDeps_React_["useCallback"])(({exceptions:newExceptions,pagination:newPagination})=>{dispatch({type:"setExceptions",lists:exceptionListsMeta,exceptions:newExceptions,pagination:newPagination})},[dispatch,exceptionListsMeta]);const _useExceptionList=Object(lists_plugin_deps["m"])({http:services.http,lists:exceptionListsMeta,filterOptions:filterOptions.filter!==""||filterOptions.tags.length>0?[filterOptions]:[],pagination:{page:pagination.pageIndex+1,perPage:pagination.pageSize,total:pagination.totalItemCount},showDetectionsListsOnly:showDetectionsListsOnly,showEndpointListsOnly:showEndpointListsOnly,matchFilters:true,onSuccess:setExceptions,onError:onDispatchToaster({color:"danger",title:exceptions_translations["A"],iconType:"alert"})}),_useExceptionList2=viewer_slicedToArray(_useExceptionList,4),loadingList=_useExceptionList2[0],fetchListItems=_useExceptionList2[3];const setCurrentModal=Object(external_kbnSharedDeps_React_["useCallback"])(modalName=>{dispatch({type:"updateModalOpen",modalName:modalName})},[dispatch]);const setExceptionItemTotals=Object(external_kbnSharedDeps_React_["useCallback"])((endpointItemTotals,detectionItemTotals)=>{dispatch({type:"setExceptionItemTotals",totalEndpointItems:endpointItemTotals,totalDetectionsItems:detectionItemTotals})},[dispatch]);const handleGetTotals=Object(external_kbnSharedDeps_React_["useCallback"])(viewer_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return getExceptionListsItems({lists:exceptionListsMeta,filterOptions:[],pagination:{page:0,perPage:1,total:0},showDetectionsListsOnly:true,showEndpointListsOnly:false,onSuccess:({pagination:detectionPagination})=>{var _detectionPagination$;setExceptionItemTotals(null,(_detectionPagination$=detectionPagination.total)!==null&&_detectionPagination$!==void 0?_detectionPagination$:0)},onError:()=>{const dispatchToasterError=onDispatchToaster({color:"danger",title:exceptions_translations["K"],iconType:"alert"});dispatchToasterError()}});case 2:_context.next=4;return getExceptionListsItems({lists:exceptionListsMeta,filterOptions:[],pagination:{page:0,perPage:1,total:0},showDetectionsListsOnly:false,showEndpointListsOnly:true,onSuccess:({pagination:endpointPagination})=>{var _endpointPagination$t;setExceptionItemTotals((_endpointPagination$t=endpointPagination.total)!==null&&_endpointPagination$t!==void 0?_endpointPagination$t:0,null)},onError:()=>{const dispatchToasterError=onDispatchToaster({color:"danger",title:exceptions_translations["K"],iconType:"alert"});dispatchToasterError()}});case 4:case"end":return _context.stop()}}),_callee)}))),[setExceptionItemTotals,exceptionListsMeta,getExceptionListsItems,onDispatchToaster]);const handleFetchList=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(fetchListItems!=null){fetchListItems();handleGetTotals()}},[fetchListItems,handleGetTotals]);const handleFilterChange=Object(external_kbnSharedDeps_React_["useCallback"])(filters=>{dispatch({type:"updateFilterOptions",filters:filters})},[dispatch]);const handleAddException=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{dispatch({type:"updateExceptionListTypeToEdit",exceptionListType:type});setCurrentModal("addModal")},[setCurrentModal]);const handleEditException=Object(external_kbnSharedDeps_React_["useCallback"])(exception=>{dispatch({type:"updateExceptionToEdit",lists:exceptionListsMeta,exception:exception});setCurrentModal("editModal")},[setCurrentModal,exceptionListsMeta]);const handleOnCancelExceptionModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setCurrentModal(null);handleFetchList()},[setCurrentModal,handleFetchList]);const handleOnConfirmExceptionModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setCurrentModal(null);handleFetchList()},[setCurrentModal,handleFetchList]);const setLoadingItemIds=Object(external_kbnSharedDeps_React_["useCallback"])(items=>{dispatch({type:"updateLoadingItemIds",items:items})},[dispatch]);const handleDeleteException=Object(external_kbnSharedDeps_React_["useCallback"])(({id:itemId,namespaceType:namespaceType})=>{setLoadingItemIds([{id:itemId,namespaceType:namespaceType}]);deleteExceptionItem({id:itemId,namespaceType:namespaceType,onSuccess:()=>{setLoadingItemIds(loadingItemIds.filter(({id:id})=>id!==itemId));handleFetchList()},onError:()=>{const dispatchToasterError=onDispatchToaster({color:"danger",title:exceptions_translations["p"],iconType:"alert"});dispatchToasterError();setLoadingItemIds(loadingItemIds.filter(({id:id})=>id!==itemId))}})},[setLoadingItemIds,deleteExceptionItem,loadingItemIds,handleFetchList,onDispatchToaster]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isInitLoading&&!loadingList&&(exceptions.length===0||exceptions!=null)){handleGetTotals();dispatch({type:"updateIsInitLoading",loading:false})}},[handleGetTotals,isInitLoading,exceptions,loadingList,dispatch]);const ruleSettingsUrl=services.application.getUrlForApp("security/detections/rules/id/".concat(encodeURI(ruleId),"/edit"));const showEmpty=!isInitLoading&&!loadingList&&totalEndpointItems===0&&totalDetectionsItems===0;const showNoResults=exceptions.length===0&&(totalEndpointItems>0||totalDetectionsItems>0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,currentModal==="editModal"&&exceptionToEdit!=null&&exceptionListTypeToEdit!=null&&external_kbnSharedDeps_React_default.a.createElement(edit_exception_modal_EditExceptionModal,{ruleName:ruleName,ruleId:ruleId,ruleIndices:ruleIndices,exceptionListType:exceptionListTypeToEdit,exceptionItem:exceptionToEdit,onCancel:handleOnCancelExceptionModal,onConfirm:handleOnConfirmExceptionModal,onRuleChange:onRuleChange}),currentModal==="addModal"&&exceptionListTypeToEdit!=null&&external_kbnSharedDeps_React_default.a.createElement(add_exception_modal["a"],{ruleName:ruleName,ruleIndices:ruleIndices,ruleId:ruleId,exceptionListType:exceptionListTypeToEdit,onCancel:handleOnCancelExceptionModal,onConfirm:handleOnConfirmExceptionModal,onRuleChange:onRuleChange}),external_kbnSharedDeps_React_default.a.createElement(panel["a"],{loading:isInitLoading||loadingList},(isInitLoading||loadingList)&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loadingPanelAllRulesTable",overlay:true,size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerHeader,{isInitLoading:isInitLoading,supportedListTypes:availableListTypes,detectionsListItems:totalDetectionsItems,endpointListItems:totalEndpointItems,onFilterChange:handleFilterChange,onAddExceptionClick:handleAddException}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerUtility,{pagination:pagination,showEndpointListsOnly:showEndpointListsOnly,showDetectionsListsOnly:showDetectionsListsOnly,onRefreshClick:handleFetchList,ruleSettingsUrl:ruleSettingsUrl}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerItems,{showEmpty:showEmpty,showNoResults:showNoResults,isInitLoading:isInitLoading,exceptions:exceptions,loadingItemIds:loadingItemIds,commentsAccordionId:commentsAccordionId,onDeleteException:handleDeleteException,onEditExceptionItem:handleEditException}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerPagination,{onPaginationChange:handleFilterChange,pagination:pagination})))};ExceptionsViewerComponent.displayName="ExceptionsViewerComponent";const ExceptionsViewer=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerComponent);ExceptionsViewer.displayName="ExceptionsViewer";function details_slicedToArray(arr,i){return details_arrayWithHoles(arr)||details_iterableToArrayLimit(arr,i)||details_unsupportedIterableToArray(arr,i)||details_nonIterableRest()}function details_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function details_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return details_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return details_arrayLikeToArray(o,minLen)}function details_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function details_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function details_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var RuleDetailTabs;(function(RuleDetailTabs){RuleDetailTabs["alerts"]="alerts";RuleDetailTabs["failures"]="failures";RuleDetailTabs["exceptions"]="exceptions"})(RuleDetailTabs||(RuleDetailTabs={}));const getRuleDetailsTabs=rule=>{const canUseExceptions=rule&&!Object(helpers["d"])(rule.type)&&!Object(utils["f"])(rule.type);return[{id:RuleDetailTabs.alerts,name:detection_engine_translations["a"],disabled:false},{id:RuleDetailTabs.exceptions,name:EXCEPTIONS_TAB,disabled:!canUseExceptions},{id:RuleDetailTabs.failures,name:FAILURE_HISTORY_TAB,disabled:false}]};const RuleDetailsPageComponent=({filters:filters,graphEventId:graphEventId,query:query,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker})=>{var _rule$name,_rule$id,_rule$enabled,_rule$name2,_rule$index;const _useGlobalTime=Object(use_global_time["a"])(),to=_useGlobalTime.to,from=_useGlobalTime.from,deleteQuery=_useGlobalTime.deleteQuery,setQuery=_useGlobalTime.setQuery;const _useUserData=Object(user_info["b"])(),_useUserData2=details_slicedToArray(_useUserData,1),_useUserData2$=_useUserData2[0],userInfoLoading=_useUserData2$.loading,isSignalIndexExists=_useUserData2$.isSignalIndexExists,isAuthenticated=_useUserData2$.isAuthenticated,hasEncryptionKey=_useUserData2$.hasEncryptionKey,canUserCRUD=_useUserData2$.canUserCRUD,hasIndexWrite=_useUserData2$.hasIndexWrite,signalIndexName=_useUserData2$.signalIndexName;const _useListsConfig=useListsConfig(),listsConfigLoading=_useListsConfig.loading,needsListsConfiguration=_useListsConfig.needsConfiguration;const loading=userInfoLoading||listsConfigLoading;const _useParams=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])(),ruleId=_useParams.detailName;const _useRuleAsync=Object(use_rule_async["a"])(ruleId),maybeRule=_useRuleAsync.rule,refreshRule=_useRuleAsync.refresh,ruleLoading=_useRuleAsync.loading;const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=details_slicedToArray(_useState,2),rule=_useState2[0],setRule=_useState2[1];const isLoading=ruleLoading&&rule==null;const _useState3=Object(external_kbnSharedDeps_React_["useState"])(null),_useState4=details_slicedToArray(_useState3,2),ruleEnabled=_useState4[0],setRuleEnabled=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(RuleDetailTabs.alerts),_useState6=details_slicedToArray(_useState5,2),ruleDetailTab=_useState6[0],setRuleDetailTab=_useState6[1];const _ref=rule!=null?getStepsData({rule:rule,detailsView:true}):{aboutRuleData:null,modifiedAboutRuleDetailsData:null,defineRuleData:null,scheduleRuleData:null},aboutRuleData=_ref.aboutRuleData,modifiedAboutRuleDetailsData=_ref.modifiedAboutRuleDetailsData,defineRuleData=_ref.defineRuleData,scheduleRuleData=_ref.scheduleRuleData;const _useAlertInfo=useAlertInfo({ruleId:ruleId}),_useAlertInfo2=details_slicedToArray(_useAlertInfo,1),lastAlerts=_useAlertInfo2[0];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=details_slicedToArray(_useState7,2),showBuildingBlockAlerts=_useState8[0],setShowBuildingBlockAlerts=_useState8[1];const mlCapabilities=Object(use_ml_capabilities["a"])();const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useFormatUrl=Object(link_to["n"])(app_types["a"].detections),formatUrl=_useFormatUrl.formatUrl;const _useFullScreen=Object(use_full_screen["a"])(),globalFullScreen=_useFullScreen.globalFullScreen;const hasMlPermissions=Object(has_ml_license["a"])(mlCapabilities)&&Object(has_ml_admin_permissions["a"])(mlCapabilities);const ruleDetailTabs=getRuleDetailsTabs(rule);const _useKibana=Object(lib_kibana["h"])(),actions=_useKibana.services.application.capabilities.actions;const hasActionsPrivileges=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if((rule===null||rule===void 0?void 0:rule.actions)!=null&&(rule===null||rule===void 0?void 0:rule.actions.length)>0&&isBoolean(actions.show)){return actions.show}return true},[actions,rule===null||rule===void 0?void 0:rule.actions]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(maybeRule!=null){setRule(maybeRule)}},[maybeRule]);const title=(_rule$name=rule===null||rule===void 0?void 0:rule.name)!==null&&_rule$name!==void 0?_rule$name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"});const subTitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _rule$created_by,_rule$created_at,_rule$updated_by,_rule$updated_at;return rule==null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"}):[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:(_rule$created_by=rule===null||rule===void 0?void 0:rule.created_by)!==null&&_rule$created_by!==void 0?_rule$created_by:UNKNOWN,date:external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:(_rule$created_at=rule===null||rule===void 0?void 0:rule.created_at)!==null&&_rule$created_at!==void 0?_rule$created_at:(new Date).toISOString(),fieldName:"createdAt"})}}),(rule===null||rule===void 0?void 0:rule.updated_by)!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:(_rule$updated_by=rule===null||rule===void 0?void 0:rule.updated_by)!==null&&_rule$updated_by!==void 0?_rule$updated_by:UNKNOWN,date:external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:(_rule$updated_at=rule===null||rule===void 0?void 0:rule.updated_at)!==null&&_rule$updated_at!==void 0?_rule$updated_at:(new Date).toISOString(),fieldName:"updatedAt"})}}):""]},[rule]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setShowBuildingBlockAlerts((rule===null||rule===void 0?void 0:rule.building_block_type)!=null)},[rule]);const alertDefaultFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[...ruleId!=null?Object(default_config["d"])(ruleId):[],...Object(default_config["e"])(showBuildingBlockAlerts)],[ruleId,showBuildingBlockAlerts]);const alertMergedFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[...alertDefaultFilters,...filters],[alertDefaultFilters,filters]);const tabs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],null,ruleDetailTabs.map(tab=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{onClick:()=>setRuleDetailTab(tab.id),isSelected:tab.id===ruleDetailTab,disabled:tab.disabled,key:tab.id},tab.name))),[ruleDetailTabs,ruleDetailTab,setRuleDetailTab]);const ruleError=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _rule$last_failure_me;return(rule===null||rule===void 0?void 0:rule.status)==="failed"&&ruleDetailTab===RuleDetailTabs.alerts&&(rule===null||rule===void 0?void 0:rule.last_failure_at)!=null?external_kbnSharedDeps_React_default.a.createElement(RuleStatusFailedCallOut,{message:(_rule$last_failure_me=rule===null||rule===void 0?void 0:rule.last_failure_message)!==null&&_rule$last_failure_me!==void 0?_rule$last_failure_me:"",date:rule===null||rule===void 0?void 0:rule.last_failure_at}):null},[rule,ruleDetailTab]);const updateDateRangeCallback=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const _x=details_slicedToArray(x,2),min=_x[0],max=_x[1];setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]);const handleOnChangeEnabledRule=Object(external_kbnSharedDeps_React_["useCallback"])(enabled=>{if(ruleEnabled==null||enabled!==ruleEnabled){setRuleEnabled(enabled)}},[ruleEnabled,setRuleEnabled]);const goToEditRule=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["d"])(ruleId!==null&&ruleId!==void 0?ruleId:""))},[history,ruleId]);const editRule=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _userHasNoPermissions;if(!hasActionsPrivileges){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:rules_translations["R"]},external_kbnSharedDeps_React_default.a.createElement(links["g"],{onClick:goToEditRule,iconType:"controlsHorizontal",isDisabled:true,href:formatUrl(Object(redirect_to_detection_engine["d"])(ruleId!==null&&ruleId!==void 0?ruleId:""))},rules_translations["Q"]))}return external_kbnSharedDeps_React_default.a.createElement(links["g"],{onClick:goToEditRule,iconType:"controlsHorizontal",isDisabled:(_userHasNoPermissions=helpers_userHasNoPermissions(canUserCRUD))!==null&&_userHasNoPermissions!==void 0?_userHasNoPermissions:true,href:formatUrl(Object(redirect_to_detection_engine["d"])(ruleId!==null&&ruleId!==void 0?ruleId:""))},rules_translations["Q"])},[canUserCRUD,formatUrl,goToEditRule,hasActionsPrivileges,ruleId]);const onShowBuildingBlockAlertsChangedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(newShowBuildingBlockAlerts=>{setShowBuildingBlockAlerts(newShowBuildingBlockAlerts)},[setShowBuildingBlockAlerts]);const _useSourcererScope=Object(sourcerer["b"])(model["SourcererScopeName"].detections),indicesExist=_useSourcererScope.indicesExist,indexPattern=_useSourcererScope.indexPattern;const exceptionLists=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(rule!=null&&rule.exceptions_list!=null){return rule.exceptions_list.reduce((acc,{id:id,list_id:listId,namespace_type:namespaceType,type:type})=>{const allowedExceptionListTypes=acc.allowedExceptionListTypes,lists=acc.lists;const shouldAddEndpoint=type===shared_imports["b"].ENDPOINT&&!allowedExceptionListTypes.includes(shared_imports["b"].ENDPOINT);return{lists:[...lists,{id:id,listId:listId,namespaceType:namespaceType,type:type}],allowedExceptionListTypes:shouldAddEndpoint?[...allowedExceptionListTypes,shared_imports["b"].ENDPOINT]:allowedExceptionListTypes}},{lists:[],allowedExceptionListTypes:[shared_imports["b"].DETECTION]})}else{return{lists:[],allowedExceptionListTypes:[shared_imports["b"].DETECTION]}}},[rule]);if(redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)){history.replace(Object(redirect_to_detection_engine["c"])());return null}const defaultRuleStackByOption={text:"event.category",value:"event.category"};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,hasIndexWrite!=null&&!hasIndexWrite&&external_kbnSharedDeps_React_default.a.createElement(NoWriteAlertsCallOut,null),helpers_userHasNoPermissions(canUserCRUD)&&external_kbnSharedDeps_React_default.a.createElement(ReadOnlyCallOut,null),indicesExist?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"resize",handler:external_kbnSharedDeps_LodashFp_["noop"]}),external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],{show:Object(timeline_helpers["f"])({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{id:"global",indexPattern:indexPattern})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine["f"])(),text:translations_BACK_TO_RULES,pageId:app_types["a"].detections},border:true,subtitle:subTitle,subtitle2:[...lastAlerts!=null?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,detection_engine_translations["e"],": ",lastAlerts)]:[],external_kbnSharedDeps_React_default.a.createElement(RuleStatus,{ruleId:ruleId!==null&&ruleId!==void 0?ruleId:null,ruleEnabled:ruleEnabled})],title:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:getToolTipContent(rule,hasMlPermissions,hasActionsPrivileges)},external_kbnSharedDeps_React_default.a.createElement(RuleSwitch,{id:(_rule$id=rule===null||rule===void 0?void 0:rule.id)!==null&&_rule$id!==void 0?_rule$id:"-1",isDisabled:!canEditRuleWithActions(rule,hasActionsPrivileges)||helpers_userHasNoPermissions(canUserCRUD)||!hasMlPermissions&&!(rule===null||rule===void 0?void 0:rule.enabled),enabled:(_rule$enabled=rule===null||rule===void 0?void 0:rule.enabled)!==null&&_rule$enabled!==void 0?_rule$enabled:false,optionLabel:ACTIVATE_RULE,onChange:handleOnChangeEnabledRule}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},editRule),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(RuleActionsOverflow,{rule:rule,userHasNoPermissions:helpers_userHasNoPermissions(canUserCRUD),canDuplicateRuleWithActions:canEditRuleWithActions(rule,hasActionsPrivileges)})))))),ruleError,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"aboutRule",component:"section",grow:1},external_kbnSharedDeps_React_default.a.createElement(StepAboutRuleToggleDetails,{loading:isLoading,stepData:aboutRuleData,stepDataDetails:modifiedAboutRuleDetailsData})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{component:"section",grow:1},external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:isLoading,title:rules_translations["J"]},defineRuleData!=null&&external_kbnSharedDeps_React_default.a.createElement(StepDefineRule,{descriptionColumns:"singleSplit",isReadOnlyView:true,isLoading:false,defaultValues:defineRuleData}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"schedule",component:"section",grow:1},external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:isLoading,title:rules_translations["qb"]},scheduleRuleData!=null&&external_kbnSharedDeps_React_default.a.createElement(StepScheduleRule,{descriptionColumns:"singleSplit",isReadOnlyView:true,isLoading:false,defaultValues:scheduleRuleData})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),tabs,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),ruleDetailTab===RuleDetailTabs.alerts&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(alerts_histogram_panel["a"],{deleteQuery:deleteQuery,filters:alertMergedFilters,query:query,from:from,signalIndexName:signalIndexName,setQuery:setQuery,stackByOptions:alerts_histogram_panel_config["a"],defaultStackByOption:defaultRuleStackByOption,to:to,updateDateRange:updateDateRangeCallback}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),ruleId!=null&&external_kbnSharedDeps_React_default.a.createElement(AlertsTable,{timelineId:types_timeline["e"].detectionsRulesDetailsPage,canUserCRUD:canUserCRUD!==null&&canUserCRUD!==void 0?canUserCRUD:false,defaultFilters:alertDefaultFilters,hasIndexWrite:hasIndexWrite!==null&&hasIndexWrite!==void 0?hasIndexWrite:false,from:from,loading:loading,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChangedCallback,onRuleChange:refreshRule,to:to})),ruleDetailTab===RuleDetailTabs.exceptions&&external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewer,{ruleId:ruleId!==null&&ruleId!==void 0?ruleId:"",ruleName:(_rule$name2=rule===null||rule===void 0?void 0:rule.name)!==null&&_rule$name2!==void 0?_rule$name2:"",ruleIndices:(_rule$index=rule===null||rule===void 0?void 0:rule.index)!==null&&_rule$index!==void 0?_rule$index:constants["v"],availableListTypes:exceptionLists.allowedExceptionListTypes,commentsAccordionId:"ruleDetailsTabExceptions",exceptionListsMeta:exceptionLists.lists,onRuleChange:refreshRule}),ruleDetailTab===RuleDetailTabs.failures&&external_kbnSharedDeps_React_default.a.createElement(FailureHistory,{id:rule===null||rule===void 0?void 0:rule.id}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:true,title:details_translations_PAGE_TITLE}),external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].detections,state:{ruleName:rule===null||rule===void 0?void 0:rule.name}}))};RuleDetailsPageComponent.displayName="RuleDetailsPageComponent";const details_makeMapStateToProps=()=>{const getGlobalInputs=inputs["d"].globalSelector();const getTimeline=store_timeline["b"].getTimelineByIdSelector();return state=>{var _getTimeline;const globalInputs=getGlobalInputs(state);const query=globalInputs.query,filters=globalInputs.filters;const timeline=(_getTimeline=getTimeline(state,types_timeline["e"].detectionsRulesDetailsPage))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"];const graphEventId=timeline.graphEventId;return{query:query,filters:filters,graphEventId:graphEventId}}};const details_mapDispatchToProps={setAbsoluteRangeDatePicker:inputs_actions["setAbsoluteRangeDatePicker"]};const details_connector=Object(react_redux_lib["connect"])(details_makeMapStateToProps,details_mapDispatchToProps);const RuleDetailsPage=details_connector(Object(external_kbnSharedDeps_React_["memo"])(RuleDetailsPageComponent));RuleDetailsPage.displayName="RuleDetailsPage";const PRE_BUILT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptTitle",{defaultMessage:"Load Elastic prebuilt detection rules"});const PRE_BUILT_MSG=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptMessage",{defaultMessage:"Elastic Security comes with prebuilt detection rules that run in the background and create alerts when their conditions are met. By default, all prebuilt rules except the Endpoint Security rule are disabled. You can select additional rules you want to activate."});const CREATE_RULE_ACTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.createOwnRuletButton",{defaultMessage:"Create your own rules"});const UPDATE_PREPACKAGED_RULES_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesTitle",{defaultMessage:"Update available for Elastic prebuilt rules or timeline templates"});const UPDATE_PREPACKAGED_RULES_MSG=updateRules=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesMsg",{values:{updateRules:updateRules},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"});const UPDATE_PREPACKAGED_TIMELINES_MSG=updateTimelines=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesMsg",{values:{updateTimelines:updateTimelines},defaultMessage:"You can update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"});const UPDATE_PREPACKAGED_RULES_AND_TIMELINES_MSG=(updateRules,updateTimelines)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesMsg",{values:{updateRules:updateRules,updateTimelines:updateTimelines},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}. Note that this will reload deleted Elastic prebuilt rules."});const UPDATE_PREPACKAGED_RULES=updateRules=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesButton",{values:{updateRules:updateRules},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"});const UPDATE_PREPACKAGED_TIMELINES=updateTimelines=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesButton",{values:{updateTimelines:updateTimelines},defaultMessage:"Update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"});const UPDATE_PREPACKAGED_RULES_AND_TIMELINES=(updateRules,updateTimelines)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesButton",{values:{updateRules:updateRules,updateTimelines:updateTimelines},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"});const RELEASE_NOTES_HELP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.releaseNotesHelp",{defaultMessage:"Release notes"});function load_empty_prompt_slicedToArray(arr,i){return load_empty_prompt_arrayWithHoles(arr)||load_empty_prompt_iterableToArrayLimit(arr,i)||load_empty_prompt_unsupportedIterableToArray(arr,i)||load_empty_prompt_nonIterableRest()}function load_empty_prompt_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function load_empty_prompt_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return load_empty_prompt_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return load_empty_prompt_arrayLikeToArray(o,minLen)}function load_empty_prompt_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function load_empty_prompt_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function load_empty_prompt_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const EmptyPrompt=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"]).withConfig({displayName:"EmptyPrompt",componentId:"sc-1rs1rob-0"})(["align-self:center;"]);EmptyPrompt.displayName="EmptyPrompt";const PrePackagedRulesPromptComponent=({createPrePackagedRules:createPrePackagedRules,loading:loading=false,userHasNoPermissions:userHasNoPermissions=true})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const handlePreBuiltCreation=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{createPrePackagedRules()},[createPrePackagedRules]);const _useFormatUrl=Object(link_to["n"])(app_types["a"].detections),formatUrl=_useFormatUrl.formatUrl;const goToCreateRule=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["a"])())},[history]);const _useUserData=Object(user_info["b"])(),_useUserData2=load_empty_prompt_slicedToArray(_useUserData,1),_useUserData2$=_useUserData2[0],isSignalIndexExists=_useUserData2$.isSignalIndexExists,isAuthenticated=_useUserData2$.isAuthenticated,hasEncryptionKey=_useUserData2$.hasEncryptionKey,canUserCRUD=_useUserData2$.canUserCRUD,hasIndexWrite=_useUserData2$.hasIndexWrite;const _usePrePackagedRules=usePrePackagedRules({canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey}),getLoadPrebuiltRulesAndTemplatesButton=_usePrePackagedRules.getLoadPrebuiltRulesAndTemplatesButton;const loadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getLoadPrebuiltRulesAndTemplatesButton({isDisabled:userHasNoPermissions,onClick:handlePreBuiltCreation,fill:true,"data-test-subj":"load-prebuilt-rules"}),[getLoadPrebuiltRulesAndTemplatesButton,handlePreBuiltCreation,userHasNoPermissions]);return external_kbnSharedDeps_React_default.a.createElement(EmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,PRE_BUILT_TITLE),body:external_kbnSharedDeps_React_default.a.createElement("p",null,PRE_BUILT_MSG),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},loadPrebuiltRulesAndTemplatesButton),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(links["g"],{isDisabled:userHasNoPermissions,onClick:goToCreateRule,href:formatUrl(Object(redirect_to_detection_engine["a"])()),iconType:"plusInCircle"},CREATE_RULE_ACTION)))})};const PrePackagedRulesPrompt=Object(external_kbnSharedDeps_React_["memo"])(PrePackagedRulesPromptComponent);const MyEuiBasicTable=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"]).withConfig({displayName:"MyEuiBasicTable",componentId:"x49r9h-0"})([""]);const AllRulesTablesComponent=({euiBasicTableSelectionProps:euiBasicTableSelectionProps,hasNoPermissions:hasNoPermissions,monitoringColumns:monitoringColumns,pagination:pagination,rules:rules,rulesColumns:rulesColumns,rulesStatuses:rulesStatuses,sorting:sorting,tableOnChangeCallback:tableOnChangeCallback,tableRef:tableRef,selectedTab:selectedTab})=>{var _hasNoPermissions,_hasNoPermissions2;const emptyPrompt=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,rules_translations["cb"]),titleSize:"xs",body:rules_translations["db"]}),[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,selectedTab===AllRulesTabs.rules&&external_kbnSharedDeps_React_default.a.createElement(MyEuiBasicTable,{"data-test-subj":"rules-table",columns:rulesColumns,isSelectable:(_hasNoPermissions=!hasNoPermissions)!==null&&_hasNoPermissions!==void 0?_hasNoPermissions:false,itemId:"id",items:rules!==null&&rules!==void 0?rules:[],noItemsMessage:emptyPrompt,onChange:tableOnChangeCallback,pagination:pagination,ref:tableRef,sorting:sorting,selection:hasNoPermissions?undefined:euiBasicTableSelectionProps}),selectedTab===AllRulesTabs.monitoring&&external_kbnSharedDeps_React_default.a.createElement(MyEuiBasicTable,{"data-test-subj":"monitoring-table",columns:monitoringColumns,isSelectable:(_hasNoPermissions2=!hasNoPermissions)!==null&&_hasNoPermissions2!==void 0?_hasNoPermissions2:false,itemId:"id",items:rulesStatuses,noItemsMessage:emptyPrompt,onChange:tableOnChangeCallback,pagination:pagination,sorting:sorting}))};const AllRulesTables=Object(external_kbnSharedDeps_React_["memo"])(AllRulesTablesComponent);function batch_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function batch_actions_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){batch_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){batch_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function batch_actions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function batch_actions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){batch_actions_ownKeys(Object(source),true).forEach((function(key){batch_actions_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{batch_actions_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function batch_actions_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const getBatchItems=({closePopover:closePopover,dispatch:dispatch,dispatchToaster:dispatchToaster,hasMlPermissions:hasMlPermissions,loadingRuleIds:loadingRuleIds,reFetchRules:reFetchRules,rules:rules,selectedRuleIds:selectedRuleIds,hasActionsPrivileges:hasActionsPrivileges})=>{const selectedRules=selectedRuleIds.reduce((acc,id)=>{const found=rules.find(r=>r.id===id);if(found!=null){return batch_actions_objectSpread({[id]:found},acc)}return acc},{});const containsEnabled=selectedRuleIds.some(id=>{var _selectedRules$id$ena,_selectedRules$id;return(_selectedRules$id$ena=(_selectedRules$id=selectedRules[id])===null||_selectedRules$id===void 0?void 0:_selectedRules$id.enabled)!==null&&_selectedRules$id$ena!==void 0?_selectedRules$id$ena:false});const containsDisabled=selectedRuleIds.some(id=>{var _selectedRules$id$ena2,_selectedRules$id2;return(_selectedRules$id$ena2=!((_selectedRules$id2=selectedRules[id])===null||_selectedRules$id2===void 0?void 0:_selectedRules$id2.enabled))!==null&&_selectedRules$id$ena2!==void 0?_selectedRules$id$ena2:false});const containsLoading=selectedRuleIds.some(id=>loadingRuleIds.includes(id));const containsImmutable=selectedRuleIds.some(id=>{var _selectedRules$id$imm,_selectedRules$id3;return(_selectedRules$id$imm=(_selectedRules$id3=selectedRules[id])===null||_selectedRules$id3===void 0?void 0:_selectedRules$id3.immutable)!==null&&_selectedRules$id$imm!==void 0?_selectedRules$id$imm:false});const missingActionPrivileges=!hasActionsPrivileges&&selectedRuleIds.some(id=>!canEditRuleWithActions(selectedRules[id],hasActionsPrivileges));return[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["j"],icon:"checkInCircleFilled",disabled:missingActionPrivileges||containsLoading||!containsDisabled,onClick:batch_actions_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var deactivatedIds,deactivatedIdsNoML,mlRuleCount;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:closePopover();deactivatedIds=selectedRuleIds.filter(id=>{var _selectedRules$id$ena3,_selectedRules$id4;return(_selectedRules$id$ena3=!((_selectedRules$id4=selectedRules[id])===null||_selectedRules$id4===void 0?void 0:_selectedRules$id4.enabled))!==null&&_selectedRules$id$ena3!==void 0?_selectedRules$id$ena3:false});deactivatedIdsNoML=deactivatedIds.filter(id=>{var _selectedRules$id5;return!Object(helpers["d"])((_selectedRules$id5=selectedRules[id])===null||_selectedRules$id5===void 0?void 0:_selectedRules$id5.type)});mlRuleCount=deactivatedIds.length-deactivatedIdsNoML.length;if(!hasMlPermissions&&mlRuleCount>0){Object(toasters["f"])(detection_engine_translations["g"](mlRuleCount),dispatchToaster)}_context.next=7;return enableRulesAction(hasMlPermissions?deactivatedIds:deactivatedIdsNoML,true,dispatch,dispatchToaster);case 7:case"end":return _context.stop()}}),_callee)})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"right",content:missingActionPrivileges?rules_translations["R"]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["j"]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["l"],icon:"crossInACircleFilled",disabled:missingActionPrivileges||containsLoading||!containsEnabled,onClick:batch_actions_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var activatedIds;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:closePopover();activatedIds=selectedRuleIds.filter(id=>{var _selectedRules$id$ena4,_selectedRules$id6;return(_selectedRules$id$ena4=(_selectedRules$id6=selectedRules[id])===null||_selectedRules$id6===void 0?void 0:_selectedRules$id6.enabled)!==null&&_selectedRules$id$ena4!==void 0?_selectedRules$id$ena4:false});_context2.next=4;return enableRulesAction(activatedIds,false,dispatch,dispatchToaster);case 4:case"end":return _context2.stop()}}),_callee2)})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"right",content:missingActionPrivileges?rules_translations["R"]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["l"]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["r"],icon:"exportAction",disabled:containsImmutable||containsLoading||selectedRuleIds.length===0,onClick:()=>{closePopover();exportRulesAction(rules.filter(r=>selectedRuleIds.includes(r.id)).map(r=>r.rule_id),dispatch)}},rules_translations["r"]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["q"],icon:"copy",disabled:missingActionPrivileges||containsLoading||selectedRuleIds.length===0,onClick:batch_actions_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:closePopover();_context3.next=3;return duplicateRulesAction(rules.filter(r=>selectedRuleIds.includes(r.id)),selectedRuleIds,dispatch,dispatchToaster);case 3:reFetchRules(true);case 4:case"end":return _context3.stop()}}),_callee3)})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"right",content:missingActionPrivileges?rules_translations["R"]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["q"]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{"data-test-subj":"deleteRuleBulk",key:rules_translations["n"],icon:"trash",title:containsImmutable?rules_translations["p"]:undefined,disabled:containsLoading||selectedRuleIds.length===0,onClick:batch_actions_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:closePopover();_context4.next=3;return deleteRulesAction(selectedRuleIds,dispatch,dispatchToaster);case 3:reFetchRules(true);case 4:case"end":return _context4.stop()}}),_callee4)})))},rules_translations["n"])]};var localized_date_tooltip=__webpack_require__(252);function tag_display_slicedToArray(arr,i){return tag_display_arrayWithHoles(arr)||tag_display_iterableToArrayLimit(arr,i)||tag_display_unsupportedIterableToArray(arr,i)||tag_display_nonIterableRest()}function tag_display_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tag_display_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return tag_display_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tag_display_arrayLikeToArray(o,minLen)}function tag_display_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function tag_display_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function tag_display_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const TagWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBadgeGroup"]).withConfig({displayName:"TagWrapper",componentId:"dbczeh-0"})(["width:100%;"]);const TagPopoverWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBadgeGroup"]).withConfig({displayName:"TagPopoverWrapper",componentId:"dbczeh-1"})(["max-height:200px;max-width:600px;overflow:auto;"]);const TagPopoverButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"]).withConfig({displayName:"TagPopoverButton",componentId:"dbczeh-2"})(["font-size:"," font-weight:500;height:20px;"],({theme:theme})=>theme.eui.euiFontSizeXS);const TagsDisplayComponent=({tags:tags})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=tag_display_slicedToArray(_useState,2),isTagPopoverOpen=_useState2[0],setIsTagPopoverOpen=_useState2[1];const sortedTags=Object(external_kbnSharedDeps_React_["useMemo"])(()=>caseInsensitiveSort(tags),[tags]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,sortedTags.length<=3?external_kbnSharedDeps_React_default.a.createElement(TagWrapper,{"data-test-subj":"tags"},sortedTags.map((tag,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow",key:"".concat(tag,"-").concat(i),"data-test-subj":"rules-table-column-tags-".concat(i)},tag))):external_kbnSharedDeps_React_default.a.createElement(TagWrapper,{"data-test-subj":"tags"},sortedTags.slice(0,3).map((tag,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow",key:"".concat(tag,"-").concat(i),"data-test-subj":"rules-table-column-tags-".concat(i)},tag)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{ownFocus:true,display:"block","data-test-subj":"tags-display-popover",button:external_kbnSharedDeps_React_default.a.createElement(TagPopoverButton,{size:"xs","data-test-subj":"tags-display-popover-button",onClick:()=>setIsTagPopoverOpen(!isTagPopoverOpen)},rules_translations["C"]),isOpen:isTagPopoverOpen,closePopover:()=>setIsTagPopoverOpen(!isTagPopoverOpen),repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(TagPopoverWrapper,null,sortedTags.map((tag,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow",key:"".concat(tag,"-").concat(i),"data-test-subj":"rules-table-column-popover-tags-".concat(i),title:tag},tag))))))};const TagsDisplay=external_kbnSharedDeps_React_default.a.memo(TagsDisplayComponent);TagsDisplay.displayName="TagsDisplay";function columns_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function columns_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){columns_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){columns_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const getActions=(dispatch,dispatchToaster,history,reFetchRules,actionsPrivileges)=>[{"data-test-subj":"editRuleAction",description:rules_translations["Q"],name:!actionsPrivileges?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"left",content:rules_translations["R"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["Q"])):rules_translations["Q"],icon:"controlsHorizontal",onClick:rowItem=>editRuleAction(rowItem,history),enabled:rowItem=>canEditRuleWithActions(rowItem,actionsPrivileges)},{description:rules_translations["N"],icon:"copy",name:!actionsPrivileges?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"left",content:rules_translations["R"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["N"])):rules_translations["N"],enabled:rowItem=>canEditRuleWithActions(rowItem,actionsPrivileges),onClick:function(){var _onClick=columns_asyncToGenerator(regeneratorRuntime.mark((function _callee(rowItem){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return duplicateRulesAction([rowItem],[rowItem.id],dispatch,dispatchToaster);case 2:_context.next=4;return reFetchRules(true);case 4:case"end":return _context.stop()}}),_callee)})));function onClick(_x){return _onClick.apply(this,arguments)}return onClick}()},{"data-test-subj":"exportRuleAction",description:rules_translations["U"],icon:"exportAction",name:rules_translations["U"],onClick:rowItem=>exportRulesAction([rowItem.rule_id],dispatch),enabled:rowItem=>!rowItem.immutable},{"data-test-subj":"deleteRuleAction",description:rules_translations["L"],icon:"trash",name:rules_translations["L"],onClick:function(){var _onClick2=columns_asyncToGenerator(regeneratorRuntime.mark((function _callee2(rowItem){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return deleteRulesAction([rowItem.id],dispatch,dispatchToaster);case 2:_context2.next=4;return reFetchRules(true);case 4:case"end":return _context2.stop()}}),_callee2)})));function onClick(_x2){return _onClick2.apply(this,arguments)}return onClick}()}];const getColumns=({dispatch:dispatch,dispatchToaster:dispatchToaster,formatUrl:formatUrl,history:history,hasMlPermissions:hasMlPermissions,hasNoPermissions:hasNoPermissions,loadingRuleIds:loadingRuleIds,reFetchRules:reFetchRules,hasReadActionsPrivileges:hasReadActionsPrivileges})=>{const cols=[{field:"name",name:rules_translations["B"],render:(value,item)=>external_kbnSharedDeps_React_default.a.createElement(links["f"],{"data-test-subj":"ruleName",onClick:ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["e"])(item.id))},href:formatUrl(Object(redirect_to_detection_engine["e"])(item.id))},value),truncateText:true,width:"20%",sortable:true},{field:"risk_score",name:rules_translations["A"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"riskScore",size:"s"},value),truncateText:true,width:"10%"},{field:"severity",name:rules_translations["D"],render:value=>external_kbnSharedDeps_React_default.a.createElement(SeverityBadge,{value:value}),truncateText:true,width:"12%"},{field:"status_date",name:rules_translations["v"],render:value=>value==null?Object(empty_value["d"])():external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip["a"],{fieldName:rules_translations["v"],date:new Date(value)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{value:value})),truncateText:true,width:"14%"},{field:"status",name:rules_translations["x"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:getStatusColor(value!==null&&value!==void 0?value:null)},value!==null&&value!==void 0?value:Object(empty_value["d"])())),width:"12%",truncateText:true},{field:"updated_at",name:rules_translations["y"],render:value=>value==null?Object(empty_value["d"])():external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip["a"],{fieldName:rules_translations["y"],date:new Date(value)},external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:value,fieldName:"last rule update date"})),sortable:true,truncateText:true,width:"14%"},{field:"version",name:rules_translations["F"],render:value=>value==null?Object(empty_value["d"])():external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"version",size:"s"},value),truncateText:true,width:"8%"},{field:"tags",name:rules_translations["E"],render:value=>{if(value.length>0){return external_kbnSharedDeps_React_default.a.createElement(TagsDisplay,{tags:value})}return Object(empty_value["d"])()},truncateText:true,width:"20%"},{align:"center",field:"enabled",name:rules_translations["s"],render:(value,item)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:getToolTipContent(item,hasMlPermissions,hasReadActionsPrivileges)},external_kbnSharedDeps_React_default.a.createElement(RuleSwitch,{"data-test-subj":"enabled",dispatch:dispatch,id:item.id,enabled:item.enabled,isDisabled:!canEditRuleWithActions(item,hasReadActionsPrivileges)||hasNoPermissions||Object(helpers["d"])(item.type)&&!hasMlPermissions&&!item.enabled,isLoading:loadingRuleIds.includes(item.id)})),sortable:true,width:"95px"}];const actions=[{actions:getActions(dispatch,dispatchToaster,history,reFetchRules,hasReadActionsPrivileges),width:"40px"}];return hasNoPermissions?cols:[...cols,...actions]};const getMonitoringColumns=(history,formatUrl)=>{const cols=[{field:"name",name:rules_translations["B"],render:(value,item)=>external_kbnSharedDeps_React_default.a.createElement(links["f"],{"data-test-subj":"ruleName",onClick:ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["e"])(item.id))},href:formatUrl(Object(redirect_to_detection_engine["e"])(item.id))},value),truncateText:true,width:"24%"},{field:"current_status.bulk_create_time_durations",name:rules_translations["u"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"bulk_create_time_durations",size:"s"},value!=null&&value.length>0?Math.max(...value===null||value===void 0?void 0:value.map(item=>Number.parseFloat(item))):Object(empty_value["d"])()),truncateText:true,width:"14%"},{field:"current_status.search_after_time_durations",name:rules_translations["z"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"search_after_time_durations",size:"s"},value!=null&&value.length>0?Math.max(...value===null||value===void 0?void 0:value.map(item=>Number.parseFloat(item))):Object(empty_value["d"])()),truncateText:true,width:"14%"},{field:"current_status.gap",name:rules_translations["t"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"gap",size:"s"},value!==null&&value!==void 0?value:Object(empty_value["d"])()),truncateText:true,width:"14%"},{field:"current_status.last_look_back_date",name:rules_translations["w"],render:value=>value==null?Object(empty_value["d"])():external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:value,fieldName:"last look back date"}),truncateText:true,width:"16%"},{field:"current_status.status_date",name:rules_translations["v"],render:value=>value==null?Object(empty_value["d"])():external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip["a"],{fieldName:rules_translations["v"],date:new Date(value)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{value:value})),truncateText:true,width:"20%"},{field:"current_status.status",name:rules_translations["x"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:getStatusColor(value!==null&&value!==void 0?value:null)},value!==null&&value!==void 0?value:Object(empty_value["d"])())),width:"16%",truncateText:true},{field:"activate",name:rules_translations["s"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"search_after_time_durations",size:"s"},value?rules_translations["d"]:rules_translations["Z"]),width:"95px"}];return cols};function all_reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function all_reducer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){all_reducer_ownKeys(Object(source),true).forEach((function(key){all_reducer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{all_reducer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function all_reducer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const allRulesReducer=tableRef=>(state,action)=>{switch(action.type){case"exportRuleIds":{return all_reducer_objectSpread(all_reducer_objectSpread({},state),{},{loadingRuleIds:action.ids,loadingRulesAction:"export",exportRuleIds:action.ids})}case"loadingRuleIds":{return all_reducer_objectSpread(all_reducer_objectSpread({},state),{},{loadingRuleIds:action.actionType==null?[]:[...state.loadingRuleIds,...action.ids],loadingRulesAction:action.actionType})}case"selectedRuleIds":{return all_reducer_objectSpread(all_reducer_objectSpread({},state),{},{selectedRuleIds:action.ids})}case"setRules":{if(tableRef!=null&&tableRef.current!=null&&tableRef.current.changeSelection!=null){window.setTimeout(()=>{var _tableRef$current;return tableRef===null||tableRef===void 0?void 0:(_tableRef$current=tableRef.current)===null||_tableRef$current===void 0?void 0:_tableRef$current.changeSelection([])},0)}return all_reducer_objectSpread(all_reducer_objectSpread({},state),{},{rules:action.rules,selectedRuleIds:[],loadingRuleIds:[],loadingRulesAction:null,pagination:all_reducer_objectSpread(all_reducer_objectSpread({},state.pagination),action.pagination)})}case"updateRules":{const ruleIds=state.rules.map(r=>r.id);const updatedRules=action.rules.reduce((rules,updatedRule)=>{let newRules=rules;if(ruleIds.includes(updatedRule.id)){newRules=newRules.map(r=>updatedRule.id===r.id?updatedRule:r)}else{newRules=[...newRules,updatedRule]}return newRules},state.rules);const updatedRuleIds=action.rules.map(r=>r.id);const newLoadingRuleIds=state.loadingRuleIds.filter(id=>!updatedRuleIds.includes(id));return all_reducer_objectSpread(all_reducer_objectSpread({},state),{},{rules:updatedRules,loadingRuleIds:newLoadingRuleIds,loadingRulesAction:newLoadingRuleIds.length===0?null:state.loadingRulesAction})}case"updateFilterOptions":{return all_reducer_objectSpread(all_reducer_objectSpread({},state),{},{filterOptions:all_reducer_objectSpread(all_reducer_objectSpread({},state.filterOptions),action.filterOptions),pagination:all_reducer_objectSpread(all_reducer_objectSpread({},state.pagination),action.pagination)})}case"failure":{return all_reducer_objectSpread(all_reducer_objectSpread({},state),{},{rules:[]})}case"setLastRefreshDate":{return all_reducer_objectSpread(all_reducer_objectSpread({},state),{},{lastUpdated:Date.now()})}case"setShowIdleModal":{return all_reducer_objectSpread(all_reducer_objectSpread({},state),{},{showIdleModal:action.show,isRefreshOn:!action.show})}case"setAutoRefreshOn":{return all_reducer_objectSpread(all_reducer_objectSpread({},state),{},{isRefreshOn:action.on})}default:return state}};function use_tags_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_tags_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_tags_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_tags_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_tags_slicedToArray(arr,i){return use_tags_arrayWithHoles(arr)||use_tags_iterableToArrayLimit(arr,i)||use_tags_unsupportedIterableToArray(arr,i)||use_tags_nonIterableRest()}function use_tags_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_tags_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_tags_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_tags_arrayLikeToArray(o,minLen)}function use_tags_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_tags_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_tags_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useTags=()=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])([]),_useState2=use_tags_slicedToArray(_useState,2),tags=_useState2[0],setTags=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(true),_useState4=use_tags_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_tags_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const reFetchTags=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;function fetchData(){return _fetchData.apply(this,arguments)}function _fetchData(){_fetchData=use_tags_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var fetchTagsResult;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setLoading(true);_context.prev=1;_context.next=4;return Object(api["i"])({signal:abortCtrl.signal});case 4:fetchTagsResult=_context.sent;if(isSubscribed){setTags(fetchTagsResult)}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);if(isSubscribed){Object(toasters["g"])({title:translations["l"],error:_context.t0,dispatchToaster:dispatchToaster})}case 11:if(isSubscribed){setLoading(false)}case 12:case"end":return _context.stop()}}),_callee,null,[[1,8]])})));return _fetchData.apply(this,arguments)}fetchData();reFetchTags.current=fetchData;return()=>{isSubscribed=false;abortCtrl.abort()}},[]);return[loading,tags,reFetchTags.current]};var toggle_selected_group=__webpack_require__(638);function tags_filter_popover_slicedToArray(arr,i){return tags_filter_popover_arrayWithHoles(arr)||tags_filter_popover_iterableToArrayLimit(arr,i)||tags_filter_popover_unsupportedIterableToArray(arr,i)||tags_filter_popover_nonIterableRest()}function tags_filter_popover_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tags_filter_popover_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return tags_filter_popover_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tags_filter_popover_arrayLikeToArray(o,minLen)}function tags_filter_popover_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function tags_filter_popover_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function tags_filter_popover_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const PopoverContentWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"PopoverContentWrapper",componentId:"sc-1c6dnvx-0"})(["width:275px;"]);const ScrollableDiv=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ScrollableDiv",componentId:"sc-1c6dnvx-1"})(["max-height:250px;overflow-y:auto;"]);const TagOverflowContainer=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"TagOverflowContainer",componentId:"sc-1c6dnvx-2"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]);const TagsFilterPopoverComponent=({tags:tags,selectedTags:selectedTags,onSelectedTagsChanged:onSelectedTagsChanged})=>{const sortedTags=Object(external_kbnSharedDeps_React_["useMemo"])(()=>caseInsensitiveSort(tags),[tags]);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=tags_filter_popover_slicedToArray(_useState,2),isTagPopoverOpen=_useState2[0],setIsTagPopoverOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(""),_useState4=tags_filter_popover_slicedToArray(_useState3,2),searchInput=_useState4[0],setSearchInput=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(sortedTags),_useState6=tags_filter_popover_slicedToArray(_useState5,2),filterTags=_useState6[0],setFilterTags=_useState6[1];const tagsComponent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>filterTags.map((tag,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterSelectItem"],{checked:selectedTags.includes(tag)?"on":undefined,key:"".concat(index,"-").concat(tag),onClick:()=>Object(toggle_selected_group["a"])(tag,selectedTags,onSelectedTagsChanged),title:tag},external_kbnSharedDeps_React_default.a.createElement(TagOverflowContainer,null,tag))),[onSelectedTagsChanged,selectedTags,filterTags]);const onSearchInputChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{setSearchInput(event.target.value)},[]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setFilterTags(sortedTags.filter(tag=>tag.toLowerCase().includes(searchInput.toLowerCase())))},[sortedTags,searchInput]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{ownFocus:true,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{"data-test-subj":"tags-filter-popover-button",iconType:"arrowDown",onClick:()=>setIsTagPopoverOpen(!isTagPopoverOpen),isSelected:isTagPopoverOpen,hasActiveFilters:selectedTags.length>0,numActiveFilters:selectedTags.length},rules_translations["Ab"]),isOpen:isTagPopoverOpen,closePopover:()=>setIsTagPopoverOpen(!isTagPopoverOpen),panelPaddingSize:"none",repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(PopoverContentWrapper,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldSearch"],{placeholder:"Search tags",value:searchInput,onChange:onSearchInputChange,isClearable:true,"aria-label":"Rules tag search"})),external_kbnSharedDeps_React_default.a.createElement(ScrollableDiv,null,tagsComponent),filterTags.length===0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,rules_translations["eb"]))))))};TagsFilterPopoverComponent.displayName="TagsFilterPopoverComponent";const TagsFilterPopover=external_kbnSharedDeps_React_default.a.memo(TagsFilterPopoverComponent);TagsFilterPopover.displayName="TagsFilterPopover";function rules_table_filters_slicedToArray(arr,i){return rules_table_filters_arrayWithHoles(arr)||rules_table_filters_iterableToArrayLimit(arr,i)||rules_table_filters_unsupportedIterableToArray(arr,i)||rules_table_filters_nonIterableRest()}function rules_table_filters_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rules_table_filters_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return rules_table_filters_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rules_table_filters_arrayLikeToArray(o,minLen)}function rules_table_filters_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function rules_table_filters_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function rules_table_filters_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const RulesTableFiltersComponent=({onFilterChanged:onFilterChanged,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(""),_useState2=rules_table_filters_slicedToArray(_useState,2),filter=_useState2[0],setFilter=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])([]),_useState4=rules_table_filters_slicedToArray(_useState3,2),selectedTags=_useState4[0],setSelectedTags=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=rules_table_filters_slicedToArray(_useState5,2),showCustomRules=_useState6[0],setShowCustomRules=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=rules_table_filters_slicedToArray(_useState7,2),showElasticRules=_useState8[0],setShowElasticRules=_useState8[1];const _useTags=useTags(),_useTags2=rules_table_filters_slicedToArray(_useTags,3),isLoadingTags=_useTags2[0],tags=_useTags2[1],reFetchTags=_useTags2[2];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{reFetchTags()},[rulesCustomInstalled,rulesInstalled]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{onFilterChanged({filter:filter,showCustomRules:showCustomRules,showElasticRules:showElasticRules,tags:selectedTags})},[filter,selectedTags,showCustomRules,showElasticRules,onFilterChanged]);const handleOnSearch=Object(external_kbnSharedDeps_React_["useCallback"])(filterString=>setFilter(filterString.trim()),[setFilter]);const handleElasticRulesClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowElasticRules(!showElasticRules);setShowCustomRules(false)},[setShowElasticRules,showElasticRules,setShowCustomRules]);const handleCustomRulesClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowCustomRules(!showCustomRules);setShowElasticRules(false)},[setShowElasticRules,showCustomRules,setShowCustomRules]);const handleSelectedTags=Object(external_kbnSharedDeps_React_["useCallback"])(newTags=>{if(!Object(external_kbnSharedDeps_LodashFp_["isEqual"])(newTags,selectedTags)){setSelectedTags(newTags)}},[selectedTags]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldSearch"],{"aria-label":rules_translations["tb"],fullWidth:true,incremental:false,placeholder:rules_translations["sb"],onSearch:handleOnSearch})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterGroup"],null,external_kbnSharedDeps_React_default.a.createElement(TagsFilterPopover,{isLoading:isLoadingTags,onSelectedTagsChanged:handleSelectedTags,selectedTags:selectedTags,tags:tags,"data-test-subj":"allRulesTagPopover"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{hasActiveFilters:showElasticRules,onClick:handleElasticRulesClick,"data-test-subj":"showElasticRulesFilterButton",withNext:true},rules_translations["S"],rulesInstalled!=null?" (".concat(rulesInstalled,")"):""),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{hasActiveFilters:showCustomRules,onClick:handleCustomRulesClick,"data-test-subj":"showCustomRulesFilterButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["H"],rulesCustomInstalled!=null?" (".concat(rulesCustomInstalled,")"):"")))))};RulesTableFiltersComponent.displayName="RulesTableFiltersComponent";const RulesTableFilters=external_kbnSharedDeps_React_default.a.memo(RulesTableFiltersComponent);RulesTableFilters.displayName="RulesTableFilters";const AllRulesUtilityBar=external_kbnSharedDeps_React_default.a.memo(({userHasNoPermissions:userHasNoPermissions,onRefresh:onRefresh,paginationTotal:paginationTotal,numberSelectedRules:numberSelectedRules,onGetBatchItemsPopoverContent:onGetBatchItemsPopoverContent,isAutoRefreshOn:isAutoRefreshOn,onRefreshSwitch:onRefreshSwitch})=>{const handleGetBatchItemsPopoverContent=Object(external_kbnSharedDeps_React_["useCallback"])(closePopover=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:onGetBatchItemsPopoverContent(closePopover)}),[onGetBatchItemsPopoverContent]);const handleAutoRefreshSwitch=Object(external_kbnSharedDeps_React_["useCallback"])(closePopover=>e=>{onRefreshSwitch(e.target.checked);closePopover()},[onRefreshSwitch]);const handleGetRefreshSettingsPopoverContent=Object(external_kbnSharedDeps_React_["useCallback"])(closePopover=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{key:"allRulesAutoRefreshSwitch",label:rules_translations["mb"],checked:isAutoRefreshOn,onChange:handleAutoRefreshSwitch(closePopover),compressed:true,"data-test-subj":"refreshSettingsSwitch"})]}),[isAutoRefreshOn,handleAutoRefreshSwitch]);return external_kbnSharedDeps_React_default.a.createElement(utility_bar["a"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["d"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"showingRules"},rules_translations["wb"](paginationTotal))),external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"selectedRules"},rules_translations["ub"](numberSelectedRules)),!userHasNoPermissions&&external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"bulkActions",iconSide:"right",iconType:"arrowDown",popoverContent:handleGetBatchItemsPopoverContent},rules_translations["i"]),external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:onRefresh},rules_translations["ib"]),external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"refreshSettings",iconSide:"right",iconType:"arrowDown",popoverContent:handleGetRefreshSettingsPopoverContent},rules_translations["nb"]))))});AllRulesUtilityBar.displayName="AllRulesUtilityBar";var last_updated=__webpack_require__(711);function all_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function all_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){all_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){all_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function all_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function all_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){all_ownKeys(Object(source),true).forEach((function(key){all_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{all_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function all_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function all_slicedToArray(arr,i){return all_arrayWithHoles(arr)||all_iterableToArrayLimit(arr,i)||all_unsupportedIterableToArray(arr,i)||all_nonIterableRest()}function all_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function all_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return all_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return all_arrayLikeToArray(o,minLen)}function all_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function all_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function all_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const INITIAL_SORT_FIELD="enabled";const all_initialState={exportRuleIds:[],filterOptions:{filter:"",sortField:INITIAL_SORT_FIELD,sortOrder:"desc"},loadingRuleIds:[],loadingRulesAction:null,pagination:{page:1,perPage:20,total:0},rules:[],selectedRuleIds:[],lastUpdated:0,showIdleModal:false,isRefreshOn:true};let AllRulesTabs;(function(AllRulesTabs){AllRulesTabs["rules"]="rules";AllRulesTabs["monitoring"]="monitoring"})(AllRulesTabs||(AllRulesTabs={}));const allRulesTabs=[{id:AllRulesTabs.rules,name:rules_translations["ob"],disabled:false},{id:AllRulesTabs.monitoring,name:rules_translations["bb"],disabled:false}];const AllRules=external_kbnSharedDeps_React_default.a.memo(({createPrePackagedRules:createPrePackagedRules,hasNoPermissions:hasNoPermissions,loading:loading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,setRefreshRulesData:setRefreshRulesData})=>{var _pagination$total;const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=all_slicedToArray(_useState,2),initLoading=_useState2[0],setInitLoading=_useState2[1];const tableRef=Object(external_kbnSharedDeps_React_["useRef"])();const _useKibana=Object(lib_kibana["h"])(),actions=_useKibana.services.application.capabilities.actions;const _useUiSetting$=Object(lib_kibana["l"])(constants["B"]),_useUiSetting$2=all_slicedToArray(_useUiSetting$,1),defaultAutoRefreshSetting=_useUiSetting$2[0];const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(allRulesReducer(tableRef),all_objectSpread(all_objectSpread({},all_initialState),{},{lastUpdated:Date.now(),isRefreshOn:defaultAutoRefreshSetting.on})),_useReducer2=all_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],exportRuleIds=_useReducer2$.exportRuleIds,filterOptions=_useReducer2$.filterOptions,loadingRuleIds=_useReducer2$.loadingRuleIds,loadingRulesAction=_useReducer2$.loadingRulesAction,pagination=_useReducer2$.pagination,rules=_useReducer2$.rules,selectedRuleIds=_useReducer2$.selectedRuleIds,lastUpdated=_useReducer2$.lastUpdated,showIdleModal=_useReducer2$.showIdleModal,isRefreshOn=_useReducer2$.isRefreshOn,dispatch=_useReducer2[1];const _useRulesStatuses=useRulesStatuses(rules),isLoadingRulesStatuses=_useRulesStatuses.loading,rulesStatuses=_useRulesStatuses.rulesStatuses;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=all_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const mlCapabilities=Object(use_ml_capabilities["a"])();const _useState3=Object(external_kbnSharedDeps_React_["useState"])(AllRulesTabs.rules),_useState4=all_slicedToArray(_useState3,2),allRulesTab=_useState4[0],setAllRulesTab=_useState4[1];const _useFormatUrl=Object(link_to["n"])(app_types["a"].detections),formatUrl=_useFormatUrl.formatUrl;const hasMlPermissions=Object(has_ml_license["a"])(mlCapabilities)&&Object(has_ml_admin_permissions["a"])(mlCapabilities);const setRules=Object(external_kbnSharedDeps_React_["useCallback"])((newRules,newPagination)=>{dispatch({type:"setRules",rules:newRules,pagination:newPagination})},[]);const setShowIdleModal=Object(external_kbnSharedDeps_React_["useCallback"])(show=>{dispatch({type:"setShowIdleModal",show:show})},[]);const setLastRefreshDate=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{dispatch({type:"setLastRefreshDate"})},[]);const setAutoRefreshOn=Object(external_kbnSharedDeps_React_["useCallback"])(on=>{dispatch({type:"setAutoRefreshOn",on:on})},[]);const _useRules=useRules({pagination:pagination,filterOptions:filterOptions,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,dispatchRulesInReducer:setRules}),_useRules2=all_slicedToArray(_useRules,3),isLoadingRules=_useRules2[0],reFetchRulesData=_useRules2[2];const sorting=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({sort:{field:filterOptions.sortField,direction:filterOptions.sortOrder}}),[filterOptions]);const prePackagedRuleStatus=getPrePackagedRuleStatus(rulesInstalled,rulesNotInstalled,rulesNotUpdated);const hasActionsPrivileges=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isBoolean(actions.show)?actions.show:true,[actions]);const getBatchItemsPopoverContent=Object(external_kbnSharedDeps_React_["useCallback"])(closePopover=>getBatchItems({closePopover:closePopover,dispatch:dispatch,dispatchToaster:dispatchToaster,hasMlPermissions:hasMlPermissions,hasActionsPrivileges:hasActionsPrivileges,loadingRuleIds:loadingRuleIds,selectedRuleIds:selectedRuleIds,reFetchRules:reFetchRulesData,rules:rules}),[dispatch,dispatchToaster,hasMlPermissions,loadingRuleIds,reFetchRulesData,rules,selectedRuleIds,hasActionsPrivileges]);const paginationMemo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({pageIndex:pagination.page-1,pageSize:pagination.perPage,totalItemCount:pagination.total,pageSizeOptions:[5,10,20,50,100,200,300]}),[pagination]);const tableOnChangeCallback=Object(external_kbnSharedDeps_React_["useCallback"])(({page:page,sort:sort})=>{var _ref,_sort$direction;dispatch({type:"updateFilterOptions",filterOptions:{sortField:(_ref=sort===null||sort===void 0?void 0:sort.field)!==null&&_ref!==void 0?_ref:INITIAL_SORT_FIELD,sortOrder:(_sort$direction=sort===null||sort===void 0?void 0:sort.direction)!==null&&_sort$direction!==void 0?_sort$direction:"desc"},pagination:{page:page.index+1,perPage:page.size}})},[dispatch]);const rulesColumns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getColumns({dispatch:dispatch,dispatchToaster:dispatchToaster,formatUrl:formatUrl,history:history,hasMlPermissions:hasMlPermissions,hasNoPermissions:hasNoPermissions,loadingRuleIds:loadingRulesAction!=null&&(loadingRulesAction==="enable"||loadingRulesAction==="disable")?loadingRuleIds:[],reFetchRules:reFetchRulesData,hasReadActionsPrivileges:hasActionsPrivileges}),[dispatch,dispatchToaster,formatUrl,hasMlPermissions,history,loadingRuleIds,loadingRulesAction,reFetchRulesData]);const monitoringColumns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getMonitoringColumns(history,formatUrl),[history,formatUrl]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(reFetchRulesData!=null){setRefreshRulesData(reFetchRulesData)}},[reFetchRulesData,setRefreshRulesData]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(initLoading&&!loading&&!isLoadingRules&&!isLoadingRulesStatuses){setInitLoading(false)}},[initLoading,loading,isLoadingRules,isLoadingRulesStatuses]);const handleCreatePrePackagedRules=Object(external_kbnSharedDeps_React_["useCallback"])(all_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(createPrePackagedRules!=null&&reFetchRulesData!=null)){_context.next=4;break}_context.next=3;return createPrePackagedRules();case 3:reFetchRulesData(true);case 4:case"end":return _context.stop()}}),_callee)}))),[createPrePackagedRules,reFetchRulesData]);const euiBasicTableSelectionProps=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({selectable:item=>!loadingRuleIds.includes(item.id),onSelectionChange:selected=>dispatch({type:"selectedRuleIds",ids:selected.map(r=>r.id)})}),[loadingRuleIds]);const onFilterChangedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(newFilterOptions=>{dispatch({type:"updateFilterOptions",filterOptions:all_objectSpread({},newFilterOptions),pagination:{page:1}})},[]);const isLoadingAnActionOnRule=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(loadingRuleIds.length>0&&(loadingRulesAction==="disable"||loadingRulesAction==="enable")){return false}else if(loadingRuleIds.length>0){return true}return false},[loadingRuleIds,loadingRulesAction]);const handleRefreshData=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(reFetchRulesData!=null&&!isLoadingAnActionOnRule){reFetchRulesData(true);setLastRefreshDate()}},[reFetchRulesData,isLoadingAnActionOnRule,setLastRefreshDate]);const handleResetIdleTimer=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(isRefreshOn){setShowIdleModal(true);setAutoRefreshOn(false)}},[setShowIdleModal,setAutoRefreshOn,isRefreshOn]);const debounceResetIdleTimer=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(external_kbnSharedDeps_LodashFp_["debounce"])(defaultAutoRefreshSetting.idleTimeout,handleResetIdleTimer),[handleResetIdleTimer,defaultAutoRefreshSetting.idleTimeout]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const interval=setInterval(()=>{if(isRefreshOn){handleRefreshData()}},defaultAutoRefreshSetting.value);return()=>{clearInterval(interval)}},[isRefreshOn,handleRefreshData,defaultAutoRefreshSetting.value]);const handleIdleModalContinue=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowIdleModal(false);handleRefreshData();setAutoRefreshOn(true)},[setShowIdleModal,setAutoRefreshOn,handleRefreshData]);const handleAutoRefreshSwitch=Object(external_kbnSharedDeps_React_["useCallback"])(refreshOn=>{if(refreshOn){handleRefreshData()}setAutoRefreshOn(refreshOn)},[setAutoRefreshOn,handleRefreshData]);const shouldShowRulesTable=Object(external_kbnSharedDeps_React_["useMemo"])(()=>showRulesTable({rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled})&&!initLoading,[initLoading,rulesCustomInstalled,rulesInstalled]);const shouldShowPrepackagedRulesPrompt=Object(external_kbnSharedDeps_React_["useMemo"])(()=>rulesCustomInstalled!=null&&rulesCustomInstalled===0&&prePackagedRuleStatus==="ruleNotInstalled"&&!initLoading,[initLoading,prePackagedRuleStatus,rulesCustomInstalled]);const handleGenericDownloaderSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(exportCount=>{dispatch({type:"loadingRuleIds",ids:[],actionType:null});dispatchToaster({type:"addToaster",toast:{id:uuid_default.a.v4(),title:rules_translations["yb"](exportCount),color:"success",iconType:"check"}})},[dispatchToaster]);const tabs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],null,allRulesTabs.map(tab=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"allRulesTableTab-".concat(tab.id),onClick:()=>setAllRulesTab(tab.id),isSelected:tab.id===allRulesTab,disabled:tab.disabled,key:tab.id},tab.name))),[allRulesTabs,allRulesTab,setAllRulesTab]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"mousemove",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"mousedown",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"click",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"keydown",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"scroll",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"load",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(generic_downloader["a"],{filename:"".concat(rules_translations["T"],".ndjson"),ids:exportRuleIds,onExportSuccess:handleGenericDownloaderSuccess,exportSelectedData:api["f"]}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),tabs,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(panel["a"],{loading:loading||isLoadingRules||isLoadingRulesStatuses,"data-test-subj":"allRulesPanel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,(isLoadingRules||isLoadingRulesStatuses)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{split:true,growLeftSplit:false,title:rules_translations["g"],subtitle:external_kbnSharedDeps_React_default.a.createElement(last_updated["a"],{showUpdating:loading||isLoadingRules||isLoadingRulesStatuses,updatedAt:lastUpdated})},external_kbnSharedDeps_React_default.a.createElement(RulesTableFilters,{onFilterChanged:onFilterChangedCallback,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled})),isLoadingAnActionOnRule&&!initLoading&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loadingPanelAllRulesTable",overlay:true,size:"xl"}),shouldShowPrepackagedRulesPrompt&&external_kbnSharedDeps_React_default.a.createElement(PrePackagedRulesPrompt,{createPrePackagedRules:handleCreatePrePackagedRules,loading:loadingCreatePrePackagedRules,userHasNoPermissions:hasNoPermissions}),initLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}),showIdleModal&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:rules_translations["lb"],onCancel:handleIdleModalContinue,onConfirm:handleIdleModalContinue,confirmButtonText:rules_translations["kb"],defaultFocusedButton:"confirm","data-test-subj":"allRulesIdleModal"},external_kbnSharedDeps_React_default.a.createElement("p",null,rules_translations["jb"]))),shouldShowRulesTable&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AllRulesUtilityBar,{userHasNoPermissions:hasNoPermissions,paginationTotal:(_pagination$total=pagination.total)!==null&&_pagination$total!==void 0?_pagination$total:0,numberSelectedRules:selectedRuleIds.length,onGetBatchItemsPopoverContent:getBatchItemsPopoverContent,onRefresh:handleRefreshData,isAutoRefreshOn:isRefreshOn,onRefreshSwitch:handleAutoRefreshSwitch}),external_kbnSharedDeps_React_default.a.createElement(AllRulesTables,{selectedTab:allRulesTab,euiBasicTableSelectionProps:euiBasicTableSelectionProps,hasNoPermissions:hasNoPermissions,monitoringColumns:monitoringColumns,pagination:paginationMemo,rules:rules,rulesColumns:rulesColumns,rulesStatuses:rulesStatuses,sorting:sorting,tableOnChangeCallback:tableOnChangeCallback,tableRef:tableRef})))))});AllRules.displayName="AllRules";var import_data_modal=__webpack_require__(710);const MODAL_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.uploadValueListTitle",{defaultMessage:"Upload value lists"});const FILE_PICKER_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.uploadValueListDescription",{defaultMessage:"Upload single value lists to use while writing rule exceptions."});const FILE_PICKER_PROMPT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.uploadValueListPrompt",{defaultMessage:"Select or drag and drop a file"});const FILE_PICKER_INVALID_FILE_TYPE=fileTypes=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.uploadValueListExtensionValidationMessage",{values:{fileTypes:fileTypes},defaultMessage:"File must be one of the following types: [{fileTypes}]"});const CLOSE_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.closeValueListsModalTitle",{defaultMessage:"Close"});const CANCEL_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.cancelValueListsUploadTitle",{defaultMessage:"Cancel upload"});const UPLOAD_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsUploadButton",{defaultMessage:"Upload list"});const UPLOAD_SUCCESS_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsUploadSuccessTitle",{defaultMessage:"Value list uploaded"});const UPLOAD_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsUploadError",{defaultMessage:"There was an error uploading the value list."});const uploadSuccessMessage=fileName=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsUploadSuccess",{defaultMessage:"Value list '{fileName}' was uploaded",values:{fileName:fileName}});const EXPORT_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsExportError",{defaultMessage:"There was an error exporting the value list."});const COLUMN_FILE_NAME=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.fileNameColumn",{defaultMessage:"Filename"});const COLUMN_TYPE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.typeColumn",{defaultMessage:"Type"});const COLUMN_UPLOAD_DATE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.uploadDateColumn",{defaultMessage:"Upload Date"});const COLUMN_CREATED_BY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.createdByColumn",{defaultMessage:"Created by"});const COLUMN_ACTIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.actionsColumn",{defaultMessage:"Actions"});const ACTION_EXPORT_NAME=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.exportActionName",{defaultMessage:"Export"});const ACTION_EXPORT_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.exportActionDescription",{defaultMessage:"Export value list"});const ACTION_DELETE_NAME=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.deleteActionName",{defaultMessage:"Remove"});const ACTION_DELETE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.deleteActionDescription",{defaultMessage:"Remove value list"});const TABLE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.title",{defaultMessage:"Value lists"});const LIST_TYPES_RADIO_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsForm.listTypesRadioLabel",{defaultMessage:"Type of value list"});const IP_RADIO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsForm.ipRadioLabel",{defaultMessage:"IP addresses"});const KEYWORDS_RADIO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsForm.keywordsRadioLabel",{defaultMessage:"Keywords"});const IP_RANGE_RADIO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsForm.ipRangesRadioLabel",{defaultMessage:"IP ranges"});const TEXT_RADIO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsForm.textRadioLabel",{defaultMessage:"Text"});function form_objectWithoutProperties(source,excluded){if(source==null)return{};var target=form_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function form_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function form_slicedToArray(arr,i){return form_arrayWithHoles(arr)||form_iterableToArrayLimit(arr,i)||form_unsupportedIterableToArray(arr,i)||form_nonIterableRest()}function form_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function form_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return form_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return form_arrayLikeToArray(o,minLen)}function form_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function form_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function form_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const listFormOptions=[{value:"keyword",text:KEYWORDS_RADIO},{value:"ip",text:IP_RADIO},{value:"ip_range",text:IP_RANGE_RADIO},{value:"text",text:TEXT_RADIO}];const defaultListType="keyword";const validFileTypes=["text/csv","text/plain"];const ValueListsFormComponent=({onError:onError,onSuccess:onSuccess})=>{const ctrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=form_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(defaultListType),_useState4=form_slicedToArray(_useState3,2),type=_useState4[0],setType=_useState4[1];const filePickerRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const http=Object(lib_kibana["h"])().services.http;const _useImportList=Object(shared_imports["K"])(),importList=_useImportList.start,importState=form_objectWithoutProperties(_useImportList,["start"]);const fileIsValid=!file||validFileTypes.some(fileType=>file.type===fileType);const handleRadioChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>setType(event.target.value),[setType]);const handleFileChange=Object(external_kbnSharedDeps_React_["useCallback"])(files=>{var _files$item;setFile((_files$item=files===null||files===void 0?void 0:files.item(0))!==null&&_files$item!==void 0?_files$item:null)},[]);const resetForm=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{var _filePickerRef$curren;if((_filePickerRef$curren=filePickerRef.current)===null||_filePickerRef$curren===void 0?void 0:_filePickerRef$curren.fileInput){filePickerRef.current.fileInput.value="";filePickerRef.current.handleChange()}setFile(null);setType(defaultListType)},[]);const handleCancel=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{ctrl.current.abort()},[]);const handleSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(response=>{resetForm();onSuccess(response)},[resetForm,onSuccess]);const handleError=Object(external_kbnSharedDeps_React_["useCallback"])(error=>{onError(error)},[onError]);const handleImport=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(!importState.loading&&file){ctrl.current=new AbortController;importList({file:file,listId:undefined,http:http,signal:ctrl.current.signal,type:type})}},[importState.loading,file,importList,http,type]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!importState.loading&&importState.result){handleSuccess(importState.result)}else if(!importState.loading&&importState.error){handleError(importState.error)}},[handleError,handleSuccess,importState.error,importState.loading,importState.result]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>handleCancel,[handleCancel]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{"data-test-subj":"value-list-file-picker-row",label:FILE_PICKER_LABEL,fullWidth:true,isInvalid:!fileIsValid,error:[FILE_PICKER_INVALID_FILE_TYPE(validFileTypes.join(", "))]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilePicker"],{accept:validFileTypes.join(),"data-test-subj":"value-list-file-picker",id:"value-list-file-picker",initialPromptText:FILE_PICKER_PROMPT,ref:filePickerRef,onChange:handleFileChange,fullWidth:true,isLoading:importState.loading,isInvalid:!fileIsValid})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:LIST_TYPES_RADIO_LABEL},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{"data-test-subj":"value-lists-form-select-type-action",options:listFormOptions,value:type,onChange:handleRadioChange,name:"valueListType"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{hasEmptyLabelSpace:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,importState.loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:handleCancel},CANCEL_BUTTON)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"value-lists-form-import-action",onClick:handleImport,disabled:file==null||!fileIsValid||importState.loading},UPLOAD_BUTTON))))))))};ValueListsFormComponent.displayName="ValueListsFormComponent";const ValueListsForm=external_kbnSharedDeps_React_default.a.memo(ValueListsFormComponent);ValueListsForm.displayName="ValueListsForm";const AlignedSpinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"]).withConfig({displayName:"AlignedSpinner",componentId:"j76bhq-0"})(["margin:",";vertical-align:middle;"],({theme:theme})=>theme.eui.euiSizeXS);const buildColumns=(onExport,onDelete)=>[{field:"name",name:COLUMN_FILE_NAME,truncateText:true},{field:"type",name:COLUMN_TYPE,width:"15%",truncateText:true,render:type=>{const option=listFormOptions.find(({value:value})=>value===type);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,option?option.text:type)}},{field:"created_at",name:COLUMN_UPLOAD_DATE,render:value=>external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:value,fieldName:"created_at"}),width:"30%"},{field:"created_by",name:COLUMN_CREATED_BY,truncateText:true,width:"20%"},{name:COLUMN_ACTIONS,actions:[{render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:ACTION_EXPORT_DESCRIPTION},item.isExporting?external_kbnSharedDeps_React_default.a.createElement(AlignedSpinner,{size:"m"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":ACTION_EXPORT_DESCRIPTION,"data-test-subj":"action-export-value-list",iconType:"exportAction",onClick:()=>onExport(item)}))},{render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:ACTION_DELETE_DESCRIPTION},item.isDeleting?external_kbnSharedDeps_React_default.a.createElement(AlignedSpinner,{size:"m"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":ACTION_DELETE_DESCRIPTION,"data-test-subj":"action-delete-value-list-".concat(item.name),iconType:"trash",onClick:()=>onDelete(item)}))}],width:"15%"}];const InvisibleAnchor=external_kbnSharedDeps_StyledComponents_default.a.a.withConfig({displayName:"InvisibleAnchor",componentId:"sc-10wd1yq-0"})(["display:none;"]);const AutoDownload=({blob:blob,name:name,onDownload:onDownload})=>{const anchorRef=Object(external_kbnSharedDeps_React_["useRef"])(null);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(blob&&(anchorRef===null||anchorRef===void 0?void 0:anchorRef.current)){if(typeof window.navigator.msSaveOrOpenBlob==="function"){window.navigator.msSaveBlob(blob)}else{const objectURL=window.URL.createObjectURL(blob);anchorRef.current.href=objectURL;anchorRef.current.download=name!==null&&name!==void 0?name:"download.txt";anchorRef.current.click();window.URL.revokeObjectURL(objectURL)}if(onDownload){onDownload()}}},[blob,name,onDownload]);return external_kbnSharedDeps_React_default.a.createElement(InvisibleAnchor,{ref:anchorRef})};function modal_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function modal_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){modal_ownKeys(Object(source),true).forEach((function(key){modal_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{modal_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function modal_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function modal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function modal_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){modal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){modal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function modal_objectWithoutProperties(source,excluded){if(source==null)return{};var target=modal_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function modal_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function modal_slicedToArray(arr,i){return modal_arrayWithHoles(arr)||modal_iterableToArrayLimit(arr,i)||modal_unsupportedIterableToArray(arr,i)||modal_nonIterableRest()}function modal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function modal_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return modal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return modal_arrayLikeToArray(o,minLen)}function modal_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function modal_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function modal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ValueListsModalComponent=({onClose:onClose,showModal:showModal})=>{var _lists$result$data,_lists$result2,_lists$result$total,_lists$result3;const _useState=Object(external_kbnSharedDeps_React_["useState"])(0),_useState2=modal_slicedToArray(_useState,2),pageIndex=_useState2[0],setPageIndex=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(5),_useState4=modal_slicedToArray(_useState3,2),pageSize=_useState4[0],setPageSize=_useState4[1];const _useCursor=Object(shared_imports["D"])({pageIndex:pageIndex,pageSize:pageSize}),_useCursor2=modal_slicedToArray(_useCursor,2),cursor=_useCursor2[0],setCursor=_useCursor2[1];const http=Object(lib_kibana["h"])().services.http;const _useFindLists=Object(shared_imports["G"])(),findLists=_useFindLists.start,lists=modal_objectWithoutProperties(_useFindLists,["start"]);const _useDeleteList=Object(shared_imports["E"])(),deleteList=_useDeleteList.start,deleteResult=_useDeleteList.result;const _useState5=Object(external_kbnSharedDeps_React_["useState"])([]),_useState6=modal_slicedToArray(_useState5,2),deletingListIds=_useState6[0],setDeletingListIds=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])([]),_useState8=modal_slicedToArray(_useState7,2),exportingListIds=_useState8[0],setExportingListIds=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])({}),_useState10=modal_slicedToArray(_useState9,2),exportDownload=_useState10[0],setExportDownload=_useState10[1];const _useAppToasts=Object(use_app_toasts["a"])(),addError=_useAppToasts.addError,addSuccess=_useAppToasts.addSuccess;const fetchLists=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{findLists({cursor:cursor,http:http,pageIndex:pageIndex+1,pageSize:pageSize})},[cursor,http,findLists,pageIndex,pageSize]);const handleDelete=Object(external_kbnSharedDeps_React_["useCallback"])(({id:id})=>{setDeletingListIds([...deletingListIds,id]);deleteList({http:http,id:id})},[deleteList,deletingListIds,http]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(deleteResult!=null){setDeletingListIds(ids=>[...ids.filter(id=>id!==deleteResult.id)]);fetchLists()}},[deleteResult,fetchLists]);const handleExport=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref=modal_asyncToGenerator(regeneratorRuntime.mark((function _callee({id:id}){var blob;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setExportingListIds(ids=>[...ids,id]);_context.next=4;return Object(shared_imports["u"])({http:http,listId:id,signal:(new AbortController).signal});case 4:blob=_context.sent;setExportDownload({name:id,blob:blob});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](0);addError(_context.t0,{title:EXPORT_ERROR});case 11:_context.prev=11;setExportingListIds(ids=>[...ids.filter(_id=>_id!==id)]);return _context.finish(11);case 14:case"end":return _context.stop()}}),_callee,null,[[0,8,11,14]])})));return function(_x){return _ref.apply(this,arguments)}}(),[addError,http]);const handleTableChange=Object(external_kbnSharedDeps_React_["useCallback"])(({page:{index:index,size:size}})=>{setPageIndex(index);setPageSize(size)},[setPageIndex,setPageSize]);const handleUploadError=Object(external_kbnSharedDeps_React_["useCallback"])(error=>{if(error.name!=="AbortError"){addError(error,{title:UPLOAD_ERROR})}},[addError]);const handleUploadSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(response=>{addSuccess({text:uploadSuccessMessage(response.name),title:UPLOAD_SUCCESS_TITLE});fetchLists()},[addSuccess]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(showModal){fetchLists()}},[showModal,fetchLists]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{var _lists$result;if(!lists.loading&&((_lists$result=lists.result)===null||_lists$result===void 0?void 0:_lists$result.cursor)){setCursor(lists.result.cursor)}},[lists.loading,lists.result,setCursor]);if(!showModal){return null}const tableItems=((_lists$result$data=(_lists$result2=lists.result)===null||_lists$result2===void 0?void 0:_lists$result2.data)!==null&&_lists$result$data!==void 0?_lists$result$data:[]).map(item=>modal_objectSpread(modal_objectSpread({},item),{},{isDeleting:deletingListIds.includes(item.id),isExporting:exportingListIds.includes(item.id)}));const pagination={pageIndex:pageIndex,pageSize:pageSize,totalItemCount:(_lists$result$total=(_lists$result3=lists.result)===null||_lists$result3===void 0?void 0:_lists$result3.total)!==null&&_lists$result$total!==void 0?_lists$result$total:0,hidePerPageOptions:true};const columns=buildColumns(handleExport,handleDelete);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],{onClick:onClose},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModal"],{onClose:onClose,maxWidth:800},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalHeader"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalHeaderTitle"],null,MODAL_TITLE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalBody"],null,external_kbnSharedDeps_React_default.a.createElement(ValueListsForm,{onSuccess:handleUploadSuccess,onError:handleUploadError}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",null,TABLE_TITLE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{"data-test-subj":"value-lists-table",columns:columns,items:tableItems,loading:lists.loading,onChange:handleTableChange,pagination:pagination}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"value-lists-modal-close-action",onClick:onClose},CLOSE_BUTTON))),external_kbnSharedDeps_React_default.a.createElement(AutoDownload,{blob:exportDownload.blob,name:exportDownload.name,onDownload:()=>setExportDownload({})}))};ValueListsModalComponent.displayName="ValueListsModalComponent";const ValueListsModal=external_kbnSharedDeps_React_default.a.memo(ValueListsModalComponent);ValueListsModal.displayName="ValueListsModal";const UpdatePrePackagedRulesCallOutComponent=({loading:loading,numberOfUpdatedRules:numberOfUpdatedRules,numberOfUpdatedTimelines:numberOfUpdatedTimelines,updateRules:updateRules})=>{const _useKibana=Object(lib_kibana["h"])(),services=_useKibana.services;const prepackagedRulesOrTimelines=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(numberOfUpdatedRules>0&&numberOfUpdatedTimelines===0){return{callOutMessage:UPDATE_PREPACKAGED_RULES_MSG(numberOfUpdatedRules),buttonTitle:UPDATE_PREPACKAGED_RULES(numberOfUpdatedRules)}}else if(numberOfUpdatedRules===0&&numberOfUpdatedTimelines>0){return{callOutMessage:UPDATE_PREPACKAGED_TIMELINES_MSG(numberOfUpdatedTimelines),buttonTitle:UPDATE_PREPACKAGED_TIMELINES(numberOfUpdatedTimelines)}}else if(numberOfUpdatedRules>0&&numberOfUpdatedTimelines>0)return{callOutMessage:UPDATE_PREPACKAGED_RULES_AND_TIMELINES_MSG(numberOfUpdatedRules,numberOfUpdatedTimelines),buttonTitle:UPDATE_PREPACKAGED_RULES_AND_TIMELINES(numberOfUpdatedRules,numberOfUpdatedTimelines)}},[numberOfUpdatedRules,numberOfUpdatedTimelines]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:UPDATE_PREPACKAGED_RULES_TITLE,"data-test-subj":"update-callout"},external_kbnSharedDeps_React_default.a.createElement("p",null,prepackagedRulesOrTimelines===null||prepackagedRulesOrTimelines===void 0?void 0:prepackagedRulesOrTimelines.callOutMessage,external_kbnSharedDeps_React_default.a.createElement("br",null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"".concat(services.docLinks.ELASTIC_WEBSITE_URL,"guide/en/security/").concat(services.docLinks.DOC_LINK_VERSION,"/prebuilt-rules-changelog.html"),target:"_blank"},RELEASE_NOTES_HELP)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:updateRules,size:"s",isLoading:loading,"data-test-subj":"update-callout-button"},prepackagedRulesOrTimelines===null||prepackagedRulesOrTimelines===void 0?void 0:prepackagedRulesOrTimelines.buttonTitle))};const UpdatePrePackagedRulesCallOut=Object(external_kbnSharedDeps_React_["memo"])(UpdatePrePackagedRulesCallOutComponent);function rules_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function rules_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){rules_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){rules_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function rules_slicedToArray(arr,i){return rules_arrayWithHoles(arr)||rules_iterableToArrayLimit(arr,i)||rules_unsupportedIterableToArray(arr,i)||rules_nonIterableRest()}function rules_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rules_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return rules_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rules_arrayLikeToArray(o,minLen)}function rules_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function rules_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function rules_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const RulesPageComponent=()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=rules_slicedToArray(_useState,2),showImportModal=_useState2[0],setShowImportModal=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=rules_slicedToArray(_useState3,2),showValueListsModal=_useState4[0],setShowValueListsModal=_useState4[1];const refreshRulesData=Object(external_kbnSharedDeps_React_["useRef"])(null);const _useUserData=Object(user_info["b"])(),_useUserData2=rules_slicedToArray(_useUserData,1),_useUserData2$=_useUserData2[0],userInfoLoading=_useUserData2$.loading,isSignalIndexExists=_useUserData2$.isSignalIndexExists,isAuthenticated=_useUserData2$.isAuthenticated,hasEncryptionKey=_useUserData2$.hasEncryptionKey,canUserCRUD=_useUserData2$.canUserCRUD,hasIndexWrite=_useUserData2$.hasIndexWrite;const _useListsConfig=useListsConfig(),listsConfigLoading=_useListsConfig.loading,canWriteListsIndex=_useListsConfig.canWriteIndex,needsListsConfiguration=_useListsConfig.needsConfiguration;const loading=userInfoLoading||listsConfigLoading;const _usePrePackagedRules=usePrePackagedRules({canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey}),createPrePackagedRules=_usePrePackagedRules.createPrePackagedRules,prePackagedRuleLoading=_usePrePackagedRules.loading,loadingCreatePrePackagedRules=_usePrePackagedRules.loadingCreatePrePackagedRules,refetchPrePackagedRulesStatus=_usePrePackagedRules.refetchPrePackagedRulesStatus,rulesCustomInstalled=_usePrePackagedRules.rulesCustomInstalled,rulesInstalled=_usePrePackagedRules.rulesInstalled,rulesNotInstalled=_usePrePackagedRules.rulesNotInstalled,rulesNotUpdated=_usePrePackagedRules.rulesNotUpdated,timelinesInstalled=_usePrePackagedRules.timelinesInstalled,timelinesNotInstalled=_usePrePackagedRules.timelinesNotInstalled,timelinesNotUpdated=_usePrePackagedRules.timelinesNotUpdated,getLoadPrebuiltRulesAndTemplatesButton=_usePrePackagedRules.getLoadPrebuiltRulesAndTemplatesButton,getReloadPrebuiltRulesAndTemplatesButton=_usePrePackagedRules.getReloadPrebuiltRulesAndTemplatesButton;const prePackagedRuleStatus=getPrePackagedRuleStatus(rulesInstalled,rulesNotInstalled,rulesNotUpdated);const prePackagedTimelineStatus=getPrePackagedTimelineStatus(timelinesInstalled,timelinesNotInstalled,timelinesNotUpdated);const _useFormatUrl=Object(link_to["n"])(app_types["a"].detections),formatUrl=_useFormatUrl.formatUrl;const handleRefreshRules=Object(external_kbnSharedDeps_React_["useCallback"])(rules_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(refreshRulesData.current!=null){refreshRulesData.current(true)}case 1:case"end":return _context.stop()}}),_callee)}))),[refreshRulesData]);const handleCreatePrePackagedRules=Object(external_kbnSharedDeps_React_["useCallback"])(rules_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!(createPrePackagedRules!=null)){_context2.next=4;break}_context2.next=3;return createPrePackagedRules();case 3:handleRefreshRules();case 4:case"end":return _context2.stop()}}),_callee2)}))),[createPrePackagedRules,handleRefreshRules]);const handleRefetchPrePackagedRulesStatus=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(refetchPrePackagedRulesStatus!=null){refetchPrePackagedRulesStatus()}},[refetchPrePackagedRulesStatus]);const handleSetRefreshRulesData=Object(external_kbnSharedDeps_React_["useCallback"])(refreshRule=>{refreshRulesData.current=refreshRule},[]);const goToNewRule=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["a"])())},[history]);const loadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getLoadPrebuiltRulesAndTemplatesButton({isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading,onClick:handleCreatePrePackagedRules}),[canUserCRUD,getLoadPrebuiltRulesAndTemplatesButton,handleCreatePrePackagedRules,loading]);const reloadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getReloadPrebuiltRulesAndTemplatesButton({isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading,onClick:handleCreatePrePackagedRules}),[canUserCRUD,getReloadPrebuiltRulesAndTemplatesButton,handleCreatePrePackagedRules,loading]);if(redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)){history.replace(Object(redirect_to_detection_engine["c"])());return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,helpers_userHasNoPermissions(canUserCRUD)&&external_kbnSharedDeps_React_default.a.createElement(ReadOnlyCallOut,null),external_kbnSharedDeps_React_default.a.createElement(ValueListsModal,{showModal:showValueListsModal,onClose:()=>setShowValueListsModal(false)}),external_kbnSharedDeps_React_default.a.createElement(import_data_modal["a"],{checkBoxLabel:rules_translations["gb"],closeModal:()=>setShowImportModal(false),description:rules_translations["vb"],errorMessage:rules_translations["V"],failedDetailed:rules_translations["W"],importComplete:handleRefreshRules,importData:api["m"],successMessage:rules_translations["zb"],showCheckBox:true,showModal:showImportModal,submitBtnText:rules_translations["Y"],subtitle:rules_translations["ab"],title:rules_translations["X"]}),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine["c"])(),text:rules_translations["h"],pageId:app_types["a"].detections},title:rules_translations["hb"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",responsive:false,wrap:true},loadPrebuiltRulesAndTemplatesButton&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},loadPrebuiltRulesAndTemplatesButton),reloadPrebuiltRulesAndTemplatesButton&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},reloadPrebuiltRulesAndTemplatesButton),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:rules_translations["Cb"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"open-value-lists-modal-button",iconType:"importAction",isDisabled:!canWriteListsIndex||loading,onClick:()=>setShowValueListsModal(true)},rules_translations["Bb"]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"importAction",isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading,onClick:()=>{setShowImportModal(true)}},rules_translations["X"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(links["g"],{"data-test-subj":"create-new-rule",fill:true,onClick:goToNewRule,href:formatUrl(Object(redirect_to_detection_engine["a"])()),iconType:"plusInCircle",isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading},rules_translations["e"])))),(prePackagedRuleStatus==="ruleNeedUpdate"||prePackagedTimelineStatus==="timelineNeedUpdate")&&external_kbnSharedDeps_React_default.a.createElement(UpdatePrePackagedRulesCallOut,{"data-test-subj":"update-callout-button",loading:loadingCreatePrePackagedRules,numberOfUpdatedRules:rulesNotUpdated!==null&&rulesNotUpdated!==void 0?rulesNotUpdated:0,numberOfUpdatedTimelines:timelinesNotUpdated!==null&&timelinesNotUpdated!==void 0?timelinesNotUpdated:0,updateRules:handleCreatePrePackagedRules}),external_kbnSharedDeps_React_default.a.createElement(AllRules,{createPrePackagedRules:createPrePackagedRules,"data-test-subj":"all-rules",loading:loading||prePackagedRuleLoading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,hasNoPermissions:helpers_userHasNoPermissions(canUserCRUD),refetchPrePackagedRulesStatus:handleRefetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,setRefreshRulesData:handleSetRefreshRulesData})),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].detections}))};const RulesPage=external_kbnSharedDeps_React_default.a.memo(RulesPageComponent);const DetectionEngineContainerComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/rules/id/:detailName/edit"},external_kbnSharedDeps_React_default.a.createElement(EditRulePage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/rules/id/:detailName"},external_kbnSharedDeps_React_default.a.createElement(RuleDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/rules/create"},external_kbnSharedDeps_React_default.a.createElement(CreateRulePage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/rules"},external_kbnSharedDeps_React_default.a.createElement(RulesPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:"",strict:true},external_kbnSharedDeps_React_default.a.createElement(DetectionEnginePage,null)));const DetectionEngineContainer=external_kbnSharedDeps_React_default.a.memo(DetectionEngineContainerComponent);var _404=__webpack_require__(140);const AlertsRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/"},external_kbnSharedDeps_React_default.a.createElement(DetectionEngineContainer,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],null,external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)));const DETECTIONS_TIMELINE_IDS=[types_timeline["e"].detectionsRulesDetailsPage,types_timeline["e"].detectionsPage];class detections_Detections{setup(){}start(storage){return{SubPluginRoutes:AlertsRoutes,storageTimelines:{timelineById:Object(local_storage["b"])(storage,DETECTIONS_TIMELINE_IDS)}}}}var use_get_url_search=__webpack_require__(248);var home_navigations=__webpack_require__(225);var cases_translations=__webpack_require__(105);const SHOWING_CASES=(actionDate,actionName,userName)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionHeadline",{values:{actionDate:actionDate,actionName:actionName,userName:userName},defaultMessage:"{userName} {actionName} on {actionDate}"});const ADDED_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.addedField",{defaultMessage:"added"});const CHANGED_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.changededField",{defaultMessage:"changed"});const SELECTED_THIRD_PARTY=thirdParty=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.selectedThirdParty",{values:{thirdParty:thirdParty},defaultMessage:"selected { thirdParty } as incident management system"});const REMOVED_THIRD_PARTY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.removedThirdParty",{defaultMessage:"removed external incident management system"});const EDITED_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.editedField",{defaultMessage:"edited"});const REMOVED_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.removedField",{defaultMessage:"removed"});const VIEW_INCIDENT=incidentNumber=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.viewIncident",{defaultMessage:"View {incidentNumber}",values:{incidentNumber:incidentNumber}});const PUSHED_NEW_INCIDENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.pushedNewIncident",{defaultMessage:"pushed as new incident"});const UPDATE_INCIDENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.updateIncident",{defaultMessage:"updated incident"});const ADDED_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.addDescription",{defaultMessage:"added description"});const EDIT_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.edit.description",{defaultMessage:"Edit description"});const QUOTE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.edit.quote",{defaultMessage:"Quote"});const EDIT_COMMENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.edit.comment",{defaultMessage:"Edit comment"});const ON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.on",{defaultMessage:"on"});const ADDED_COMMENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.addComment",{defaultMessage:"added comment"});const translations_STATUS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.statusLabel",{defaultMessage:"Status"});const CASE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.case",{defaultMessage:"case"});const COMMENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.comment",{defaultMessage:"comment"});const CASE_OPENED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.caseOpened",{defaultMessage:"Case opened"});const CASE_CLOSED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.caseClosed",{defaultMessage:"Case closed"});const CASE_REFRESH=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.caseRefresh",{defaultMessage:"Refresh case"});const EMAIL_SUBJECT=caseTitle=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.emailSubject",{values:{caseTitle:caseTitle},defaultMessage:"Security Case - {caseTitle}"});const EMAIL_BODY=caseUrl=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.emailBody",{values:{caseUrl:caseUrl},defaultMessage:"Case reference: {caseUrl}"});const CHANGED_CONNECTOR_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.fieldChanged",{defaultMessage:"changed connector field"});var lib_helpers=__webpack_require__(159);const SAVE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.header.editableTitle.save",{defaultMessage:"Save"});const header_page_translations_CANCEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.header.editableTitle.cancel",{defaultMessage:"Cancel"});const EDIT_TITLE_ARIA=title=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.header.editableTitle.editButtonAria",{values:{title:title},defaultMessage:"You can edit {title} by clicking"});var header_page_title=__webpack_require__(629);function editable_title_slicedToArray(arr,i){return editable_title_arrayWithHoles(arr)||editable_title_iterableToArrayLimit(arr,i)||editable_title_unsupportedIterableToArray(arr,i)||editable_title_nonIterableRest()}function editable_title_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function editable_title_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return editable_title_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return editable_title_arrayLikeToArray(o,minLen)}function editable_title_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function editable_title_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function editable_title_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const editable_title_MyEuiButtonIcon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"]).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-1mw23e4-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["margin-left:",";"],theme.eui.euiSize));const MySpinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"]).withConfig({displayName:"MySpinner",componentId:"sc-1mw23e4-1"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["margin-left:",";"],theme.eui.euiSize));const EditableTitleComponent=({disabled:disabled=false,onSubmit:onSubmit,isLoading:isLoading,title:title})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=editable_title_slicedToArray(_useState,2),editMode=_useState2[0],setEditMode=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(typeof title==="string"?title:""),_useState4=editable_title_slicedToArray(_useState3,2),changedTitle=_useState4[0],onTitleChange=_useState4[1];const onCancel=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setEditMode(false),[]);const onClickEditIcon=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setEditMode(true),[]);const onClickSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(changedTitle!==title){onSubmit(changedTitle)}setEditMode(false)},[changedTitle,title]);const handleOnChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>onTitleChange(e.target.value),[]);return editMode?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleOnChange,value:"".concat(changedTitle),"data-test-subj":"editable-title-input-field"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"secondary","data-test-subj":"editable-title-submit-btn",fill:true,iconType:"save",onClick:onClickSubmit,size:"s"},SAVE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"editable-title-cancel-btn",iconType:"cross",onClick:onCancel,size:"s"},header_page_translations_CANCEL))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(header_page_title["a"],{title:title})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},isLoading&&external_kbnSharedDeps_React_default.a.createElement(MySpinner,{"data-test-subj":"editable-title-loading"}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement(editable_title_MyEuiButtonIcon,{isDisabled:disabled,"aria-label":EDIT_TITLE_ARIA(title),iconType:"pencil",onClick:onClickEditIcon,"data-test-subj":"editable-title-edit-icon"})))};const EditableTitle=external_kbnSharedDeps_React_default.a.memo(EditableTitleComponent);const EDIT_TAGS_ARIA=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.editTagsLinkAria",{defaultMessage:"click to edit tags"});const optional_field_label_OptionalFieldLabel=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},cases_translations["z"]);const schema_emptyField=shared_imports["w"].emptyField;const schemaTags={type:shared_imports["c"].COMBO_BOX,label:cases_translations["H"],helpText:cases_translations["I"],labelAppend:optional_field_label_OptionalFieldLabel};const create_schema_schema={title:{type:shared_imports["c"].TEXT,label:cases_translations["t"],validations:[{validator:schema_emptyField(cases_translations["J"])}]},description:{label:cases_translations["r"],validations:[{validator:schema_emptyField(cases_translations["s"])}]},tags:schemaTags,connectorId:{type:shared_imports["c"].SUPER_SELECT,label:cases_translations["m"],defaultValue:"none"}};const tag_list_schema_schema={tags:schemaTags};var containers_api=__webpack_require__(134);var containers_translations=__webpack_require__(114);function use_post_case_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_post_case_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_post_case_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_post_case_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_post_case_slicedToArray(arr,i){return use_post_case_arrayWithHoles(arr)||use_post_case_iterableToArrayLimit(arr,i)||use_post_case_unsupportedIterableToArray(arr,i)||use_post_case_nonIterableRest()}function use_post_case_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_post_case_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_post_case_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_post_case_arrayLikeToArray(o,minLen)}function use_post_case_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_post_case_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_post_case_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function use_post_case_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_post_case_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_post_case_ownKeys(Object(source),true).forEach((function(key){use_post_case_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_post_case_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_post_case_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const dataFetchReducer=(state,action)=>{var _action$payload;switch(action.type){case"FETCH_INIT":return use_post_case_objectSpread(use_post_case_objectSpread({},state),{},{isLoading:true,isError:false});case"FETCH_SUCCESS":return use_post_case_objectSpread(use_post_case_objectSpread({},state),{},{isLoading:false,isError:false,caseData:(_action$payload=action.payload)!==null&&_action$payload!==void 0?_action$payload:null});case"FETCH_FAILURE":return use_post_case_objectSpread(use_post_case_objectSpread({},state),{},{isLoading:false,isError:true});default:return state}};const usePostCase=()=>{const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(dataFetchReducer,{isLoading:false,isError:false,caseData:null}),_useReducer2=use_post_case_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_post_case_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const postMyCase=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref=use_post_case_asyncToGenerator(regeneratorRuntime.mark((function _callee(data){var cancel,abortCtrl,response;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:cancel=false;abortCtrl=new AbortController;_context.prev=2;dispatch({type:"FETCH_INIT"});_context.next=6;return Object(containers_api["l"])(data,abortCtrl.signal);case 6:response=_context.sent;if(!cancel){dispatch({type:"FETCH_SUCCESS",payload:response})}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context["catch"](2);if(!cancel){Object(toasters["g"])({title:containers_translations["e"],error:_context.t0.body&&_context.t0.body.message?new Error(_context.t0.body.message):_context.t0,dispatchToaster:dispatchToaster});dispatch({type:"FETCH_FAILURE"})}case 13:return _context.abrupt("return",()=>{abortCtrl.abort();cancel=true});case 14:case"end":return _context.stop()}}),_callee,null,[[2,10]])})));return function(_x){return _ref.apply(this,arguments)}}(),[]);return use_post_case_objectSpread(use_post_case_objectSpread({},state),{},{postCase:postMyCase})};var use_selector=__webpack_require__(90);var timeline_actions=__webpack_require__(15);function use_insert_timeline_slicedToArray(arr,i){return use_insert_timeline_arrayWithHoles(arr)||use_insert_timeline_iterableToArrayLimit(arr,i)||use_insert_timeline_unsupportedIterableToArray(arr,i)||use_insert_timeline_nonIterableRest()}function use_insert_timeline_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_insert_timeline_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_insert_timeline_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_insert_timeline_arrayLikeToArray(o,minLen)}function use_insert_timeline_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_insert_timeline_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_insert_timeline_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useInsertTimeline=(value,onChange)=>{const dispatch=Object(react_redux_lib["useDispatch"])();const _useFormatUrl=Object(link_to["n"])(constants["bb"].timelines),formatUrl=_useFormatUrl.formatUrl;const _useState=Object(external_kbnSharedDeps_React_["useState"])({start:0,end:0}),_useState2=use_insert_timeline_slicedToArray(_useState,2),cursorPosition=_useState2[0],setCursorPosition=_useState2[1];const insertTimeline=Object(use_selector["b"])(store_timeline["b"].selectInsertTimeline);const handleOnTimelineChange=Object(external_kbnSharedDeps_React_["useCallback"])((title,id,graphEventId)=>{const url=formatUrl(Object(link_to["m"])(id!==null&&id!==void 0?id:"",graphEventId),{absolute:true,skipSearch:true});const newValue=[value.slice(0,cursorPosition.start),cursorPosition.start===cursorPosition.end?"[".concat(title,"](").concat(url,")"):"[".concat(value.slice(cursorPosition.start,cursorPosition.end),"](").concat(url,")"),value.slice(cursorPosition.end)].join("");onChange(newValue)},[value,onChange,cursorPosition,formatUrl]);const handleCursorChange=Object(external_kbnSharedDeps_React_["useCallback"])(cp=>{setCursorPosition(cp)},[]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(insertTimeline!=null&&value!=null){dispatch(store_timeline["a"].showTimeline({id:insertTimeline.timelineId,show:false}));handleOnTimelineChange(insertTimeline.timelineTitle,insertTimeline.timelineSavedObjectId,insertTimeline.graphEventId);dispatch(Object(timeline_actions["setInsertTimeline"])(null))}},[insertTimeline,dispatch,handleOnTimelineChange,value]);return{cursorPosition:cursorPosition,handleCursorChange:handleCursorChange,handleOnTimelineChange:handleOnTimelineChange}};var use_get_tags=__webpack_require__(422);var use_timeline_click=__webpack_require__(403);const createCaseSettingsRegistry=()=>{const settings=new Map;const registry={has:id=>settings.has(id),register:setting=>{if(settings.has(setting.id)){throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.caseSettingsRegistry.register.duplicateCaseSettingErrorMessage",{defaultMessage:'Object type "{id}" is already registered.',values:{id:setting.id}}))}settings.set(setting.id,setting)},get:id=>{if(!settings.has(id)){throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.caseSettingsRegistry.get.missingCaseSettingErrorMessage",{defaultMessage:'Object type "{id}" is not registered.',values:{id:id}}))}return settings.get(id)},list:()=>Array.from(settings).map(([id,setting])=>setting)};return registry};var jira=__webpack_require__(1090);var resilient=__webpack_require__(1091);var servicenow_translations=__webpack_require__(669);const getCaseSetting=()=>({id:".servicenow",caseSettingFieldsComponent:Object(external_kbnSharedDeps_React_["lazy"])(()=>__webpack_require__.e(9).then(__webpack_require__.bind(null,1100)))});const fieldLabels={impact:servicenow_translations["a"],severity:servicenow_translations["b"],urgency:servicenow_translations["f"]};function settings_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class settings_CaseSettings{constructor(){settings_defineProperty(this,"caseSettingsRegistry",void 0);this.caseSettingsRegistry=createCaseSettingsRegistry();this.init()}init(){this.caseSettingsRegistry.register(Object(jira["getCaseSetting"])());this.caseSettingsRegistry.register(Object(resilient["getCaseSetting"])());this.caseSettingsRegistry.register(getCaseSetting())}registry(){return this.caseSettingsRegistry}}const caseSettings=new settings_CaseSettings;const getCaseSettings=()=>({caseSettingsRegistry:caseSettings.registry()});const SettingFieldsFormComponent=({connector:connector,isEdit:isEdit,onChange:onChange,fields:fields})=>{const _getCaseSettings=getCaseSettings(),caseSettingsRegistry=_getCaseSettings.caseSettingsRegistry;const onFieldsChange=Object(external_kbnSharedDeps_React_["useCallback"])(newFields=>{onChange(newFields)},[onChange]);if(connector==null||connector.actionTypeId==null||connector.actionTypeId===".none"){return null}const _caseSettingsRegistry=caseSettingsRegistry.get(connector.actionTypeId),FieldsComponent=_caseSettingsRegistry.caseSettingFieldsComponent;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,FieldsComponent!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Suspense"],{fallback:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})))},external_kbnSharedDeps_React_default.a.createElement(FieldsComponent,{isEdit:isEdit,fields:fields,connector:connector,onChange:onFieldsChange})):null)};const SettingFieldsForm=Object(external_kbnSharedDeps_React_["memo"])(SettingFieldsFormComponent);var common_constants=__webpack_require__(420);var containers_utils=__webpack_require__(181);function configure_api_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function configure_api_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){configure_api_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){configure_api_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const fetchConnectors=function(){var _ref=configure_api_asyncToGenerator(regeneratorRuntime.mark((function _callee({signal:signal}){var response;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return lib_kibana["b"].get().http.fetch("".concat(common_constants["f"],"/_find"),{method:"GET",signal:signal});case 2:response=_context.sent;return _context.abrupt("return",response);case 4:case"end":return _context.stop()}}),_callee)})));return function fetchConnectors(_x){return _ref.apply(this,arguments)}}();const getCaseConfigure=function(){var _ref2=configure_api_asyncToGenerator(regeneratorRuntime.mark((function _callee2({signal:signal}){var response;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return lib_kibana["b"].get().http.fetch(common_constants["g"],{method:"GET",signal:signal});case 2:response=_context2.sent;return _context2.abrupt("return",!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(response)?Object(containers_utils["c"])(Object(containers_utils["e"])(response)):null);case 4:case"end":return _context2.stop()}}),_callee2)})));return function getCaseConfigure(_x2){return _ref2.apply(this,arguments)}}();const postCaseConfigure=function(){var _ref3=configure_api_asyncToGenerator(regeneratorRuntime.mark((function _callee3(caseConfiguration,signal){var response;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return lib_kibana["b"].get().http.fetch(common_constants["g"],{method:"POST",body:JSON.stringify(caseConfiguration),signal:signal});case 2:response=_context3.sent;return _context3.abrupt("return",Object(containers_utils["c"])(Object(containers_utils["e"])(response)));case 4:case"end":return _context3.stop()}}),_callee3)})));return function postCaseConfigure(_x3,_x4){return _ref3.apply(this,arguments)}}();const patchCaseConfigure=function(){var _ref4=configure_api_asyncToGenerator(regeneratorRuntime.mark((function _callee4(caseConfiguration,signal){var response;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return lib_kibana["b"].get().http.fetch(common_constants["g"],{method:"PATCH",body:JSON.stringify(caseConfiguration),signal:signal});case 2:response=_context4.sent;return _context4.abrupt("return",Object(containers_utils["c"])(Object(containers_utils["e"])(response)));case 4:case"end":return _context4.stop()}}),_callee4)})));return function patchCaseConfigure(_x5,_x6){return _ref4.apply(this,arguments)}}();function use_connectors_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_connectors_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_connectors_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_connectors_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_connectors_slicedToArray(arr,i){return use_connectors_arrayWithHoles(arr)||use_connectors_iterableToArrayLimit(arr,i)||use_connectors_unsupportedIterableToArray(arr,i)||use_connectors_nonIterableRest()}function use_connectors_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_connectors_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_connectors_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_connectors_arrayLikeToArray(o,minLen)}function use_connectors_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_connectors_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_connectors_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useConnectors=()=>{const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_connectors_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=use_connectors_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])([]),_useState4=use_connectors_slicedToArray(_useState3,2),connectors=_useState4[0],setConnectors=_useState4[1];const refetchConnectors=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{let didCancel=false;const abortCtrl=new AbortController;const getConnectors=function(){var _ref=use_connectors_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var res;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return fetchConnectors({signal:abortCtrl.signal});case 4:res=_context.sent;if(!didCancel){setLoading(false);setConnectors(res)}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](0);if(!didCancel){setLoading(false);setConnectors([]);Object(toasters["g"])({title:containers_translations["e"],error:_context.t0.body&&_context.t0.body.message?new Error(_context.t0.body.message):_context.t0,dispatchToaster:dispatchToaster})}case 11:case"end":return _context.stop()}}),_callee,null,[[0,8]])})));return function getConnectors(){return _ref.apply(this,arguments)}}();getConnectors();return()=>{didCancel=true;abortCtrl.abort()}},[]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{refetchConnectors()},[]);return{loading:loading,connectors:connectors,refetchConnectors:refetchConnectors}};var connectors_config=__webpack_require__(270);const INCIDENT_MANAGEMENT_SYSTEM_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.incidentManagementSystemTitle",{defaultMessage:"Connect to external incident management system"});const INCIDENT_MANAGEMENT_SYSTEM_DESC=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.incidentManagementSystemDesc",{defaultMessage:"You may optionally connect Security cases to an external incident management system of your choosing. This will allow you to push case data as an incident in your chosen third-party system."});const INCIDENT_MANAGEMENT_SYSTEM_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.incidentManagementSystemLabel",{defaultMessage:"Incident management system"});const ADD_NEW_CONNECTOR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.addNewConnector",{defaultMessage:"Add new connector"});const CASE_CLOSURE_OPTIONS_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.caseClosureOptionsTitle",{defaultMessage:"Case Closures"});const CASE_CLOSURE_OPTIONS_DESC=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.caseClosureOptionsDesc",{defaultMessage:"Define how you wish Security cases to be closed. Automated case closures require an established connection to an external incident management system."});const CASE_CLOSURE_OPTIONS_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.caseClosureOptionsLabel",{defaultMessage:"Case closure options"});const CASE_CLOSURE_OPTIONS_MANUAL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.caseClosureOptionsManual",{defaultMessage:"Manually close Security cases"});const CASE_CLOSURE_OPTIONS_NEW_INCIDENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.caseClosureOptionsNewIncident",{defaultMessage:"Automatically close Security cases when pushing new incident to external system"});const CASE_CLOSURE_OPTIONS_CLOSED_INCIDENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.caseClosureOptionsClosedIncident",{defaultMessage:"Automatically close Security cases when incident is closed in external system"});const FIELD_MAPPING_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.fieldMappingTitle",{defaultMessage:"Field mappings"});const FIELD_MAPPING_DESC=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.fieldMappingDesc",{defaultMessage:"Map Security case fields when pushing data to a third-party. Field mappings require an established connection to an external incident management system."});const FIELD_MAPPING_FIRST_COL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.fieldMappingFirstCol",{defaultMessage:"Security case field"});const FIELD_MAPPING_SECOND_COL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.fieldMappingSecondCol",{defaultMessage:"External incident field"});const FIELD_MAPPING_THIRD_COL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.fieldMappingThirdCol",{defaultMessage:"On edit and update"});const FIELD_MAPPING_EDIT_NOTHING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.fieldMappingEditNothing",{defaultMessage:"Nothing"});const FIELD_MAPPING_EDIT_OVERWRITE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.fieldMappingEditOverwrite",{defaultMessage:"Overwrite"});const FIELD_MAPPING_EDIT_APPEND=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.fieldMappingEditAppend",{defaultMessage:"Append"});const configure_cases_translations_CANCEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.cancelButton",{defaultMessage:"Cancel"});const WARNING_NO_CONNECTOR_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.warningTitle",{defaultMessage:"Warning"});const WARNING_NO_CONNECTOR_MESSAGE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.warningMessage",{defaultMessage:"The selected connector has been deleted. Either select a different connector or create a new one."});const MAPPING_FIELD_NOT_MAPPED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.mappingFieldNotMapped",{defaultMessage:"Not mapped"});const UPDATE_CONNECTOR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.updateConnector",{defaultMessage:"Update connector"});const UPDATE_SELECTED_CONNECTOR=connectorName=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configureCases.updateSelectedConnector",{values:{connectorName:connectorName},defaultMessage:"Update { connectorName }"});const ICON_SIZE="m";const EuiIconExtended=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiIcon"]).withConfig({displayName:"EuiIconExtended",componentId:"sc-7am6ho-0"})(["margin-right:13px;margin-bottom:0 !important;"]);const noConnectorOption={value:"none",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(EuiIconExtended,{type:"minusInCircle",size:ICON_SIZE})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"dropdown-connector-no-connector"},cases_translations["u"]))),"data-test-subj":"dropdown-connector-no-connector"};const addNewConnector={value:"add-connector",inputDisplay:external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiButtonEmpty euiButtonEmpty--primary euiButtonEmpty--xSmall euiButtonEmpty--flushLeft"},ADD_NEW_CONNECTOR),"data-test-subj":"dropdown-connector-add-connector"};const ConnectorsDropdownComponent=({connectors:connectors,disabled:disabled,isLoading:isLoading,onChange:onChange,selectedConnector:selectedConnector,appendAddConnectorButton:appendAddConnectorButton=false})=>{const connectorsAsOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const connectorsFormatted=connectors.reduce((acc,connector)=>{var _connectorsConfigurat,_connectorsConfigurat2;return[...acc,{value:connector.id,inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(EuiIconExtended,{type:(_connectorsConfigurat=(_connectorsConfigurat2=connectors_config["a"][connector.actionTypeId])===null||_connectorsConfigurat2===void 0?void 0:_connectorsConfigurat2.logo)!==null&&_connectorsConfigurat!==void 0?_connectorsConfigurat:"",size:ICON_SIZE})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement("span",null,connector.name))),"data-test-subj":"dropdown-connector-".concat(connector.id)}]},[noConnectorOption]);if(appendAddConnectorButton){return[...connectorsFormatted,addNewConnector]}return connectorsFormatted},[connectors]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{"aria-label":INCIDENT_MANAGEMENT_SYSTEM_LABEL,"data-test-subj":"dropdown-connectors",disabled:disabled,fullWidth:true,isLoading:isLoading,onChange:onChange,options:connectorsAsOptions,valueOfSelected:selectedConnector})};const ConnectorsDropdown=external_kbnSharedDeps_React_default.a.memo(ConnectorsDropdownComponent);const ConnectorSelector=({connectors:connectors,dataTestSubj:dataTestSubj,defaultValue:defaultValue,disabled:disabled=false,field:field,idAria:idAria,isEdit:isEdit=true,isLoading:isLoading=false})=>{var _ref;const _getFieldValidityAndE=Object(shared_imports["x"])(field),isInvalid=_getFieldValidityAndE.isInvalid,errorMessage=_getFieldValidityAndE.errorMessage;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{field.setValue(defaultValue)},[defaultValue]);const handleContentChange=Object(external_kbnSharedDeps_React_["useCallback"])(newConnector=>{field.setValue(newConnector)},[field]);return isEdit?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined,error:errorMessage,fullWidth:true,helpText:field.helpText,isInvalid:isInvalid,label:field.label,labelAppend:field.labelAppend},external_kbnSharedDeps_React_default.a.createElement(ConnectorsDropdown,{connectors:connectors,disabled:disabled,isLoading:isLoading,onChange:handleContentChange,selectedConnector:(_ref=field.value)!==null&&_ref!==void 0?_ref:"none"})):null};const SUCCESS_CONFIGURE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.configure.successSaveToast",{defaultMessage:"Saved external connection settings"});var api_connectors=__webpack_require__(182);function use_configure_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_configure_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_configure_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_configure_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_configure_slicedToArray(arr,i){return use_configure_arrayWithHoles(arr)||use_configure_iterableToArrayLimit(arr,i)||use_configure_unsupportedIterableToArray(arr,i)||use_configure_nonIterableRest()}function use_configure_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_configure_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_configure_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_configure_arrayLikeToArray(o,minLen)}function use_configure_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_configure_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_configure_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function use_configure_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_configure_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_configure_ownKeys(Object(source),true).forEach((function(key){use_configure_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_configure_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_configure_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const configureCasesReducer=(state,action)=>{switch(action.type){case"setLoading":return use_configure_objectSpread(use_configure_objectSpread({},state),{},{loading:action.payload});case"setFirstLoad":return use_configure_objectSpread(use_configure_objectSpread({},state),{},{firstLoad:action.payload});case"setPersistLoading":return use_configure_objectSpread(use_configure_objectSpread({},state),{},{persistLoading:action.payload});case"setVersion":return use_configure_objectSpread(use_configure_objectSpread({},state),{},{version:action.payload});case"setCurrentConfiguration":{return use_configure_objectSpread(use_configure_objectSpread({},state),{},{currentConfiguration:use_configure_objectSpread({},action.currentConfiguration)})}case"setConnector":{return use_configure_objectSpread(use_configure_objectSpread({},state),{},{connector:action.connector})}case"setClosureType":{return use_configure_objectSpread(use_configure_objectSpread({},state),{},{closureType:action.closureType})}case"setMapping":{return use_configure_objectSpread(use_configure_objectSpread({},state),{},{mapping:action.mapping})}default:return state}};const use_configure_initialState={closureType:"close-by-user",connector:{fields:null,id:"none",name:"none",type:api_connectors["c"].none},currentConfiguration:{closureType:"close-by-user",connector:{fields:null,id:"none",name:"none",type:api_connectors["c"].none}},firstLoad:false,loading:true,mapping:null,persistLoading:false,version:""};const useCaseConfigure=()=>{const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(configureCasesReducer,use_configure_initialState),_useReducer2=use_configure_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];const setCurrentConfiguration=Object(external_kbnSharedDeps_React_["useCallback"])(configuration=>{dispatch({currentConfiguration:configuration,type:"setCurrentConfiguration"})},[]);const setConnector=Object(external_kbnSharedDeps_React_["useCallback"])(connector=>{dispatch({connector:connector,type:"setConnector"})},[]);const setClosureType=Object(external_kbnSharedDeps_React_["useCallback"])(closureType=>{dispatch({closureType:closureType,type:"setClosureType"})},[]);const setMapping=Object(external_kbnSharedDeps_React_["useCallback"])(newMapping=>{dispatch({mapping:newMapping,type:"setMapping"})},[]);const setLoading=Object(external_kbnSharedDeps_React_["useCallback"])(isLoading=>{dispatch({payload:isLoading,type:"setLoading"})},[]);const setFirstLoad=Object(external_kbnSharedDeps_React_["useCallback"])(isFirstLoad=>{dispatch({payload:isFirstLoad,type:"setFirstLoad"})},[]);const setPersistLoading=Object(external_kbnSharedDeps_React_["useCallback"])(isPersistLoading=>{dispatch({payload:isPersistLoading,type:"setPersistLoading"})},[]);const setVersion=Object(external_kbnSharedDeps_React_["useCallback"])(version=>{dispatch({payload:version,type:"setVersion"})},[]);const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_configure_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const refetchCaseConfigure=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{let didCancel=false;const abortCtrl=new AbortController;const fetchCaseConfiguration=function(){var _ref=use_configure_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var res;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return getCaseConfigure({signal:abortCtrl.signal});case 4:res=_context.sent;if(!didCancel){if(res!=null){setConnector(res.connector);if(setClosureType!=null){setClosureType(res.closureType)}setVersion(res.version);if(!state.firstLoad){setFirstLoad(true);if(setCurrentConfiguration!=null){setCurrentConfiguration({closureType:res.closureType,connector:use_configure_objectSpread({},res.connector)})}}}setLoading(false)}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](0);if(!didCancel){setLoading(false);Object(toasters["g"])({dispatchToaster:dispatchToaster,error:_context.t0.body&&_context.t0.body.message?new Error(_context.t0.body.message):_context.t0,title:containers_translations["e"]})}case 11:case"end":return _context.stop()}}),_callee,null,[[0,8]])})));return function fetchCaseConfiguration(){return _ref.apply(this,arguments)}}();fetchCaseConfiguration();return()=>{didCancel=true;abortCtrl.abort()}},[state.firstLoad]);const persistCaseConfigure=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref2=use_configure_asyncToGenerator(regeneratorRuntime.mark((function _callee3({connector:connector,closureType:closureType}){var didCancel,abortCtrl,saveCaseConfiguration;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:didCancel=false;abortCtrl=new AbortController;saveCaseConfiguration=function(){var _ref3=use_configure_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var connectorObj,res;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setPersistLoading(true);connectorObj={connector:connector,closure_type:closureType};if(!(state.version.length===0)){_context2.next=9;break}_context2.next=6;return postCaseConfigure(connectorObj,abortCtrl.signal);case 6:_context2.t0=_context2.sent;_context2.next=12;break;case 9:_context2.next=11;return patchCaseConfigure(use_configure_objectSpread(use_configure_objectSpread({},connectorObj),{},{version:state.version}),abortCtrl.signal);case 11:_context2.t0=_context2.sent;case 12:res=_context2.t0;if(!didCancel){setConnector(res.connector);if(setClosureType){setClosureType(res.closureType)}setVersion(res.version);if(setCurrentConfiguration!=null){setCurrentConfiguration({closureType:res.closureType,connector:use_configure_objectSpread({},res.connector)})}Object(toasters["e"])(SUCCESS_CONFIGURE,dispatchToaster);setPersistLoading(false)}_context2.next=19;break;case 16:_context2.prev=16;_context2.t1=_context2["catch"](0);if(!didCancel){setPersistLoading(false);Object(toasters["g"])({title:containers_translations["e"],error:_context2.t1.body&&_context2.t1.body.message?new Error(_context2.t1.body.message):_context2.t1,dispatchToaster:dispatchToaster})}case 19:case"end":return _context2.stop()}}),_callee2,null,[[0,16]])})));return function saveCaseConfiguration(){return _ref3.apply(this,arguments)}}();saveCaseConfiguration();return _context3.abrupt("return",()=>{didCancel=true;abortCtrl.abort()});case 5:case"end":return _context3.stop()}}),_callee3)})));return function(_x){return _ref2.apply(this,arguments)}}(),[state.version]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{refetchCaseConfigure()},[]);return use_configure_objectSpread(use_configure_objectSpread({},state),{},{refetchCaseConfigure:refetchCaseConfigure,persistCaseConfigure:persistCaseConfigure,setCurrentConfiguration:setCurrentConfiguration,setConnector:setConnector,setClosureType:setClosureType,setMapping:setMapping})};var common_api=__webpack_require__(176);function utils_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function utils_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){utils_ownKeys(Object(source),true).forEach((function(key){utils_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{utils_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function utils_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const setActionTypeToMapping=(caseField,newActionType,mapping)=>{const findItemIndex=mapping.findIndex(item=>item.source===caseField);if(findItemIndex>=0){return[...mapping.slice(0,findItemIndex),utils_objectSpread(utils_objectSpread({},mapping[findItemIndex]),{},{actionType:newActionType}),...mapping.slice(findItemIndex+1)]}return[...mapping]};const setThirdPartyToMapping=(caseField,newThirdPartyField,mapping)=>mapping.map(item=>{if(item.source!==caseField&&item.target===newThirdPartyField){return utils_objectSpread(utils_objectSpread({},item),{},{target:"not_mapped"})}else if(item.source===caseField){return utils_objectSpread(utils_objectSpread({},item),{},{target:newThirdPartyField})}return item});const getNoneConnector=()=>({id:"none",name:"none",type:common_api["h"].none,fields:null});const getConnectorById=(id,connectors)=>{var _connectors$find;return(_connectors$find=connectors.find(c=>c.id===id))!==null&&_connectors$find!==void 0?_connectors$find:null};const normalizeActionConnector=(actionConnector,fields=null)=>{const caseConnectorFieldsType={type:actionConnector.actionTypeId,fields:fields};return utils_objectSpread({id:actionConnector.id,name:actionConnector.name},caseConnectorFieldsType)};const normalizeCaseConnector=(connectors,caseConnector)=>{var _connectors$find2;return(_connectors$find2=connectors.find(c=>c.id===caseConnector.id))!==null&&_connectors$find2!==void 0?_connectors$find2:null};const STEP_ONE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.create.stepOneTitle",{defaultMessage:"Case fields"});const STEP_TWO_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.create.stepTwoTitle",{defaultMessage:"External Connector Fields"});function components_create_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function components_create_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){components_create_ownKeys(Object(source),true).forEach((function(key){components_create_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{components_create_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function components_create_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function create_objectWithoutProperties(source,excluded){if(source==null)return{};var target=create_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function create_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function components_create_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function components_create_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){components_create_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){components_create_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function components_create_slicedToArray(arr,i){return components_create_arrayWithHoles(arr)||components_create_iterableToArrayLimit(arr,i)||components_create_unsupportedIterableToArray(arr,i)||components_create_nonIterableRest()}function components_create_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function components_create_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return components_create_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return components_create_arrayLikeToArray(o,minLen)}function components_create_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function components_create_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function components_create_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const create_CommonUseField=Object(shared_imports["y"])({component:shared_imports["d"]});const create_Container=external_kbnSharedDeps_StyledComponents_default.a.div.attrs(props=>props).withConfig({displayName:"Container",componentId:"sc-3p3fo4-0"})(["",""],({big:big,theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["margin-top:",";"],big?theme.eui.euiSizeXL:theme.eui.euiSize));const create_MySpinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"]).withConfig({displayName:"MySpinner",componentId:"sc-3p3fo4-1"})(["position:absolute;top:50%;left:50%;z-index:99;"]);const initialCaseValue={description:"",tags:[],title:"",connectorId:"none"};const Create=external_kbnSharedDeps_React_default.a.memo(()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _usePostCase=usePostCase(),caseData=_usePostCase.caseData,isLoading=_usePostCase.isLoading,postCase=_usePostCase.postCase;const _useConnectors=useConnectors(),isLoadingConnectors=_useConnectors.loading,connectors=_useConnectors.connectors;const _useCaseConfigure=useCaseConfigure(),configureConnector=_useCaseConfigure.connector,isLoadingCaseConfigure=_useCaseConfigure.loading;const _useGetTags=Object(use_get_tags["a"])(),tagOptions=_useGetTags.tags;const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=components_create_slicedToArray(_useState,2),connector=_useState2[0],setConnector=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(tagOptions.map(label=>({label:label}))),_useState4=components_create_slicedToArray(_useState3,2),options=_useState4[0],setOptions=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>setOptions(tagOptions.map(label=>({label:label}))),[tagOptions]);const _useState5=Object(external_kbnSharedDeps_React_["useState"])(null),_useState6=components_create_slicedToArray(_useState5,2),fields=_useState6[0],setFields=_useState6[1];const _useForm=Object(shared_imports["H"])({defaultValue:initialCaseValue,options:{stripEmptyFields:false},schema:create_schema_schema}),form=_useForm.form;const currentConnectorId=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _normalizeCaseConnect,_normalizeCaseConnect2;return!isLoadingCaseConfigure?(_normalizeCaseConnect=(_normalizeCaseConnect2=normalizeCaseConnector(connectors,configureConnector))===null||_normalizeCaseConnect2===void 0?void 0:_normalizeCaseConnect2.id)!==null&&_normalizeCaseConnect!==void 0?_normalizeCaseConnect:"none":null},[configureConnector,connectors,isLoadingCaseConfigure]);const submit=form.submit,setFieldValue=form.setFieldValue;const _useFormData=Object(shared_imports["J"])({form:form,watch:["description"]}),_useFormData2=components_create_slicedToArray(_useFormData,1),description=_useFormData2[0].description;const onChangeConnector=Object(external_kbnSharedDeps_React_["useCallback"])(newConnectorId=>{if(connector==null||connector.id!==newConnectorId){var _getConnectorById;setConnector((_getConnectorById=getConnectorById(newConnectorId,connectors))!==null&&_getConnectorById!==void 0?_getConnectorById:null);setFields(null)}},[connector,connectors]);const onDescriptionChange=Object(external_kbnSharedDeps_React_["useCallback"])(newValue=>setFieldValue("description",newValue),[setFieldValue]);const _useInsertTimeline=useInsertTimeline(description,onDescriptionChange),handleCursorChange=_useInsertTimeline.handleCursorChange;const handleTimelineClick=Object(use_timeline_click["a"])();const onSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(components_create_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$submit,isValid,data,dataConnectorId,dataWithoutConnectorId,caseConnector,connectorToUpdate;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return submit();case 2:_yield$submit=_context.sent;isValid=_yield$submit.isValid;data=_yield$submit.data;if(!isValid){_context.next=11;break}dataConnectorId=data.connectorId,dataWithoutConnectorId=create_objectWithoutProperties(data,["connectorId"]);caseConnector=getConnectorById(dataConnectorId,connectors);connectorToUpdate=caseConnector?normalizeActionConnector(caseConnector,fields):getNoneConnector();_context.next=11;return postCase(components_create_objectSpread(components_create_objectSpread({},dataWithoutConnectorId),{},{connector:connectorToUpdate}));case 11:case"end":return _context.stop()}}),_callee)}))),[submit,postCase,fields,connectors]);const handleSetIsCancel=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{history.push("/")},[history]);const firstStep=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({title:STEP_ONE_TITLE,children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(create_CommonUseField,{path:"title",componentProps:{idAria:"caseTitle","data-test-subj":"caseTitle",euiFieldProps:{fullWidth:false,disabled:isLoading}}}),external_kbnSharedDeps_React_default.a.createElement(create_Container,null,external_kbnSharedDeps_React_default.a.createElement(create_CommonUseField,{path:"tags",componentProps:{idAria:"caseTags","data-test-subj":"caseTags",euiFieldProps:{fullWidth:true,placeholder:"",disabled:isLoading,options:options,noSuggestions:false}}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["f"],{pathsToWatch:"tags"},({tags:anotherTags})=>{const current=options.map(opt=>opt.label);const newOptions=anotherTags.reduce((acc,item)=>{if(!acc.includes(item)){return[...acc,item]}return acc},current);if(!Object(external_kbnSharedDeps_LodashFp_["isEqual"])(current,newOptions)){setOptions(newOptions.map(label=>({label:label})))}return null})),external_kbnSharedDeps_React_default.a.createElement(create_Container,{big:true},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"description",component:eui_form["a"],componentProps:{dataTestSubj:"caseDescription",idAria:"caseDescription",isDisabled:isLoading,onClickTimeline:handleTimelineClick,onCursorPositionUpdate:handleCursorChange}})))}),[isLoading,options,handleCursorChange,handleTimelineClick]);const secondStep=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({title:STEP_TWO_TITLE,children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(create_Container,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"connectorId",component:ConnectorSelector,componentProps:{connectors:connectors,dataTestSubj:"caseConnectors",defaultValue:currentConnectorId,disabled:isLoadingConnectors,idAria:"caseConnectors",isLoading:isLoading},onChange:onChangeConnector}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(create_Container,null,external_kbnSharedDeps_React_default.a.createElement(SettingFieldsForm,{connector:connector,fields:fields,isEdit:true,onChange:setFields}))))}),[connector,connectors,currentConnectorId,fields,isLoading,isLoadingConnectors,onChangeConnector]);const allSteps=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[firstStep,secondStep],[firstStep,secondStep]);if(caseData!=null&&caseData.id){history.push(Object(link_to["b"])({id:caseData.id}));return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,isLoading&&external_kbnSharedDeps_React_default.a.createElement(create_MySpinner,{"data-test-subj":"create-case-loading-spinner",size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSteps"],{headingElement:"h2",steps:allSteps})),external_kbnSharedDeps_React_default.a.createElement(create_Container,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"create-case-cancel",size:"s",onClick:handleSetIsCancel,iconType:"cross"},cases_translations["e"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"create-case-submit",fill:true,iconType:"plusInCircle",isDisabled:isLoading,isLoading:isLoading,onClick:onSubmit},cases_translations["n"])))))});Create.displayName="Create";const TagsComponent=({tags:tags,color:color="default",gutterSize:gutterSize})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,tags.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadgeGroup"],{gutterSize:gutterSize},tags.map(tag=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{"data-test-subj":"tag-".concat(tag),color:color,key:tag},tag))));const Tags=Object(external_kbnSharedDeps_React_["memo"])(TagsComponent);function tag_list_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function tag_list_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){tag_list_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){tag_list_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function tag_list_slicedToArray(arr,i){return tag_list_arrayWithHoles(arr)||tag_list_iterableToArrayLimit(arr,i)||tag_list_unsupportedIterableToArray(arr,i)||tag_list_nonIterableRest()}function tag_list_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tag_list_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return tag_list_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tag_list_arrayLikeToArray(o,minLen)}function tag_list_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function tag_list_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function tag_list_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const MyFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyFlexGroup",componentId:"sc-1hmj58j-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["margin-top:",";p{font-size:",";}"],theme.eui.euiSizeM,theme.eui.euiSizeM));const TagList=external_kbnSharedDeps_React_default.a.memo(({disabled:disabled=false,isLoading:isLoading,onSubmit:onSubmit,tags:tags})=>{const initialState={tags:tags};const _useForm=Object(shared_imports["H"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:tag_list_schema_schema}),form=_useForm.form;const submit=form.submit;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=tag_list_slicedToArray(_useState,2),isEditTags=_useState2[0],setIsEditTags=_useState2[1];const onSubmitTags=Object(external_kbnSharedDeps_React_["useCallback"])(tag_list_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$submit,isValid,newData;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return submit();case 2:_yield$submit=_context.sent;isValid=_yield$submit.isValid;newData=_yield$submit.data;if(isValid&&newData.tags){onSubmit(newData.tags);setIsEditTags(false)}case 6:case"end":return _context.stop()}}),_callee)}))),[onSubmit,submit]);const _useGetTags=Object(use_get_tags["a"])(),tagOptions=_useGetTags.tags;const _useState3=Object(external_kbnSharedDeps_React_["useState"])(tagOptions.map(label=>({label:label}))),_useState4=tag_list_slicedToArray(_useState3,2),options=_useState4[0],setOptions=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>setOptions(tagOptions.map(label=>({label:label}))),[tagOptions]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("h4",null,cases_translations["H"])),isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{"data-test-subj":"tag-list-loading"}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"tag-list-edit",grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"tag-list-edit-button",isDisabled:disabled,"aria-label":EDIT_TAGS_ARIA,iconType:"pencil",onClick:setIsEditTags.bind(null,true)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(MyFlexGroup,{gutterSize:"none","data-test-subj":"case-tags"},tags.length===0&&!isEditTags&&external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"no-tags"},cases_translations["w"]),!isEditTags&&external_kbnSharedDeps_React_default.a.createElement(Tags,{tags:tags,color:"hollow"}),isEditTags&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":"edit-tags",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form},external_kbnSharedDeps_React_default.a.createElement(create_CommonUseField,{path:"tags",componentProps:{idAria:"caseTags","data-test-subj":"caseTags",euiFieldProps:{fullWidth:true,placeholder:"",options:options,noSuggestions:false}}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["f"],{pathsToWatch:"tags"},({tags:anotherTags})=>{const current=options.map(opt=>opt.label);const newOptions=anotherTags.reduce((acc,item)=>{if(!acc.includes(item)){return[...acc,item]}return acc},current);if(!Object(external_kbnSharedDeps_LodashFp_["isEqual"])(current,newOptions)){setOptions(newOptions.map(label=>({label:label})))}return null}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"secondary","data-test-subj":"edit-tags-submit",fill:true,iconType:"save",onClick:onSubmitTags,size:"s"},cases_translations["G"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"edit-tags-cancel",iconType:"cross",onClick:setIsEditTags.bind(null,false),size:"s"},cases_translations["e"])))))))});TagList.displayName="TagList";function use_get_case_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_get_case_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_get_case_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_get_case_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_get_case_slicedToArray(arr,i){return use_get_case_arrayWithHoles(arr)||use_get_case_iterableToArrayLimit(arr,i)||use_get_case_unsupportedIterableToArray(arr,i)||use_get_case_nonIterableRest()}function use_get_case_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_get_case_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_get_case_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_get_case_arrayLikeToArray(o,minLen)}function use_get_case_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_get_case_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_get_case_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function use_get_case_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_get_case_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_get_case_ownKeys(Object(source),true).forEach((function(key){use_get_case_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_get_case_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_get_case_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const use_get_case_dataFetchReducer=(state,action)=>{switch(action.type){case"FETCH_INIT":return use_get_case_objectSpread(use_get_case_objectSpread({},state),{},{isLoading:true,isError:false});case"FETCH_SUCCESS":return use_get_case_objectSpread(use_get_case_objectSpread({},state),{},{isLoading:false,isError:false,data:action.payload});case"FETCH_FAILURE":return use_get_case_objectSpread(use_get_case_objectSpread({},state),{},{isLoading:false,isError:true});case"UPDATE_CASE":return use_get_case_objectSpread(use_get_case_objectSpread({},state),{},{data:action.payload});default:return state}};const initialData={id:"",closedAt:null,closedBy:null,createdAt:"",comments:[],connector:use_get_case_objectSpread(use_get_case_objectSpread({},getNoneConnector()),{},{fields:null}),createdBy:{username:""},description:"",externalService:null,status:"",tags:[],title:"",totalComment:0,updatedAt:null,updatedBy:null,version:""};const useGetCase=caseId=>{const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(use_get_case_dataFetchReducer,{isLoading:true,isError:false,data:initialData}),_useReducer2=use_get_case_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_get_case_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const updateCase=Object(external_kbnSharedDeps_React_["useCallback"])(newCase=>{dispatch({type:"UPDATE_CASE",payload:newCase})},[]);const callFetch=Object(external_kbnSharedDeps_React_["useCallback"])(use_get_case_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var didCancel,abortCtrl,fetchData;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:didCancel=false;abortCtrl=new AbortController;fetchData=function(){var _ref2=use_get_case_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var response;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:dispatch({type:"FETCH_INIT"});_context.prev=1;_context.next=4;return Object(containers_api["c"])(caseId,true,abortCtrl.signal);case 4:response=_context.sent;if(!didCancel){dispatch({type:"FETCH_SUCCESS",payload:response})}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);if(!didCancel){Object(toasters["g"])({title:containers_translations["e"],error:_context.t0.body&&_context.t0.body.message?new Error(_context.t0.body.message):_context.t0,dispatchToaster:dispatchToaster});dispatch({type:"FETCH_FAILURE"})}case 11:case"end":return _context.stop()}}),_callee,null,[[1,8]])})));return function fetchData(){return _ref2.apply(this,arguments)}}();fetchData();return _context2.abrupt("return",()=>{didCancel=true;abortCtrl.abort()});case 5:case"end":return _context2.stop()}}),_callee2)}))),[caseId]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{callFetch()},[caseId]);return use_get_case_objectSpread(use_get_case_objectSpread({},state),{},{fetchCase:callFetch,updateCase:updateCase})};var classnames=__webpack_require__(384);var classnames_default=__webpack_require__.n(classnames);const ALREADY_PUSHED_TO_SERVICE=externalService=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.alreadyPushedToExternalService",{values:{externalService:externalService},defaultMessage:"Already pushed to { externalService } incident"});const REQUIRED_UPDATE_TO_SERVICE=externalService=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.requiredUpdateToExternalService",{values:{externalService:externalService},defaultMessage:"Requires update to { externalService } incident"});const COPY_REFERENCE_LINK=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.copyCommentLinkAria",{defaultMessage:"Copy reference link"});const MOVE_TO_ORIGINAL_COMMENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.moveToCommentAria",{defaultMessage:"Highlight the referenced comment"});function use_update_comment_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_update_comment_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_update_comment_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_update_comment_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_update_comment_slicedToArray(arr,i){return use_update_comment_arrayWithHoles(arr)||use_update_comment_iterableToArrayLimit(arr,i)||use_update_comment_unsupportedIterableToArray(arr,i)||use_update_comment_nonIterableRest()}function use_update_comment_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_update_comment_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_update_comment_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_update_comment_arrayLikeToArray(o,minLen)}function use_update_comment_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_update_comment_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_update_comment_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function use_update_comment_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_update_comment_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_update_comment_ownKeys(Object(source),true).forEach((function(key){use_update_comment_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_update_comment_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_update_comment_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const use_update_comment_dataFetchReducer=(state,action)=>{switch(action.type){case"FETCH_INIT":return use_update_comment_objectSpread(use_update_comment_objectSpread({},state),{},{isLoadingIds:[...state.isLoadingIds,action.payload],isError:false});case"FETCH_SUCCESS":return use_update_comment_objectSpread(use_update_comment_objectSpread({},state),{},{isLoadingIds:state.isLoadingIds.filter(id=>action.payload.commentId!==id),isError:false});case"FETCH_FAILURE":return use_update_comment_objectSpread(use_update_comment_objectSpread({},state),{},{isLoadingIds:state.isLoadingIds.filter(id=>action.payload!==id),isError:true});default:return state}};const useUpdateComment=()=>{const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(use_update_comment_dataFetchReducer,{isLoadingIds:[],isError:false}),_useReducer2=use_update_comment_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_update_comment_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const dispatchUpdateComment=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref=use_update_comment_asyncToGenerator(regeneratorRuntime.mark((function _callee({caseId:caseId,commentId:commentId,commentUpdate:commentUpdate,fetchUserActions:fetchUserActions,updateCase:updateCase,version:version}){var cancel,abortCtrl,response;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:cancel=false;abortCtrl=new AbortController;_context.prev=2;dispatch({type:"FETCH_INIT",payload:commentId});_context.next=6;return Object(containers_api["k"])(caseId,commentId,commentUpdate,version,abortCtrl.signal);case 6:response=_context.sent;if(!cancel){updateCase(response);fetchUserActions();dispatch({type:"FETCH_SUCCESS",payload:{commentId:commentId}})}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context["catch"](2);if(!cancel){Object(toasters["g"])({title:containers_translations["e"],error:_context.t0.body&&_context.t0.body.message?new Error(_context.t0.body.message):_context.t0,dispatchToaster:dispatchToaster});dispatch({type:"FETCH_FAILURE",payload:commentId})}case 13:return _context.abrupt("return",()=>{cancel=true;abortCtrl.abort()});case 14:case"end":return _context.stop()}}),_callee,null,[[2,10]])})));return function(_x){return _ref.apply(this,arguments)}}(),[]);return use_update_comment_objectSpread(use_update_comment_objectSpread({},state),{},{patchComment:dispatchUpdateComment})};function use_post_comment_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_post_comment_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_post_comment_ownKeys(Object(source),true).forEach((function(key){use_post_comment_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_post_comment_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_post_comment_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_post_comment_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_post_comment_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_post_comment_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_post_comment_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_post_comment_slicedToArray(arr,i){return use_post_comment_arrayWithHoles(arr)||use_post_comment_iterableToArrayLimit(arr,i)||use_post_comment_unsupportedIterableToArray(arr,i)||use_post_comment_nonIterableRest()}function use_post_comment_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_post_comment_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_post_comment_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_post_comment_arrayLikeToArray(o,minLen)}function use_post_comment_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_post_comment_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_post_comment_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const use_post_comment_dataFetchReducer=(state,action)=>{switch(action.type){case"FETCH_INIT":return{isLoading:true,isError:false};case"FETCH_SUCCESS":return{isLoading:false,isError:false};case"FETCH_FAILURE":return{isLoading:false,isError:true};default:return state}};const usePostComment=caseId=>{const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(use_post_comment_dataFetchReducer,{isLoading:false,isError:false}),_useReducer2=use_post_comment_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_post_comment_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const postMyComment=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref=use_post_comment_asyncToGenerator(regeneratorRuntime.mark((function _callee(data,updateCase){var cancel,abortCtrl,response;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:cancel=false;abortCtrl=new AbortController;_context.prev=2;dispatch({type:"FETCH_INIT"});_context.next=6;return Object(containers_api["m"])(data,caseId,abortCtrl.signal);case 6:response=_context.sent;if(!cancel){dispatch({type:"FETCH_SUCCESS"});updateCase(response)}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context["catch"](2);if(!cancel){Object(toasters["g"])({title:containers_translations["e"],error:_context.t0.body&&_context.t0.body.message?new Error(_context.t0.body.message):_context.t0,dispatchToaster:dispatchToaster});dispatch({type:"FETCH_FAILURE"})}case 13:return _context.abrupt("return",()=>{abortCtrl.abort();cancel=true});case 14:case"end":return _context.stop()}}),_callee,null,[[2,10]])})));return function(_x,_x2){return _ref.apply(this,arguments)}}(),[caseId]);return use_post_comment_objectSpread(use_post_comment_objectSpread({},state),{},{postComment:postMyComment})};const add_comment_schema_emptyField=shared_imports["w"].emptyField;const add_comment_schema_schema={comment:{type:shared_imports["c"].TEXTAREA,validations:[{validator:add_comment_schema_emptyField(cases_translations["k"])}]}};function add_comment_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function add_comment_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){add_comment_ownKeys(Object(source),true).forEach((function(key){add_comment_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{add_comment_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function add_comment_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function add_comment_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function add_comment_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){add_comment_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){add_comment_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function add_comment_slicedToArray(arr,i){return add_comment_arrayWithHoles(arr)||add_comment_iterableToArrayLimit(arr,i)||add_comment_unsupportedIterableToArray(arr,i)||add_comment_nonIterableRest()}function add_comment_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function add_comment_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return add_comment_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return add_comment_arrayLikeToArray(o,minLen)}function add_comment_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function add_comment_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function add_comment_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const add_comment_MySpinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"]).withConfig({displayName:"MySpinner",componentId:"sc-12tgh7e-0"})(["position:absolute;top:50%;left:50%;"]);const initialCommentValue={comment:""};const AddComment=external_kbnSharedDeps_React_default.a.memo(Object(external_kbnSharedDeps_React_["forwardRef"])(({caseId:caseId,disabled:disabled,showLoading:showLoading=true,onCommentPosted:onCommentPosted,onCommentSaving:onCommentSaving},ref)=>{const _usePostComment=usePostComment(caseId),isLoading=_usePostComment.isLoading,postComment=_usePostComment.postComment;const _useForm=Object(shared_imports["H"])({defaultValue:initialCommentValue,options:{stripEmptyFields:false},schema:add_comment_schema_schema}),form=_useForm.form;const fieldName="comment";const setFieldValue=form.setFieldValue,reset=form.reset,submit=form.submit;const _useFormData=Object(shared_imports["J"])({form:form,watch:[fieldName]}),_useFormData2=add_comment_slicedToArray(_useFormData,1),comment=_useFormData2[0].comment;const onCommentChange=Object(external_kbnSharedDeps_React_["useCallback"])(newValue=>setFieldValue(fieldName,newValue),[setFieldValue]);const _useInsertTimeline=useInsertTimeline(comment,onCommentChange),handleCursorChange=_useInsertTimeline.handleCursorChange;const addQuote=Object(external_kbnSharedDeps_React_["useCallback"])(quote=>{setFieldValue(fieldName,"".concat(comment).concat(comment.length>0?"\n\n":"").concat(quote))},[comment,setFieldValue]);Object(external_kbnSharedDeps_React_["useImperativeHandle"])(ref,()=>({addQuote:addQuote}));const handleTimelineClick=Object(use_timeline_click["a"])();const onSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(add_comment_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$submit,isValid,data;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return submit();case 2:_yield$submit=_context.sent;isValid=_yield$submit.isValid;data=_yield$submit.data;if(isValid){if(onCommentSaving!=null){onCommentSaving()}postComment(add_comment_objectSpread(add_comment_objectSpread({},data),{},{type:common_api["g"].user}),onCommentPosted);reset()}case 6:case"end":return _context.stop()}}),_callee)}))),[onCommentPosted,onCommentSaving,postComment,reset,submit]);return external_kbnSharedDeps_React_default.a.createElement("span",{id:"add-comment-permLink"},isLoading&&showLoading&&external_kbnSharedDeps_React_default.a.createElement(add_comment_MySpinner,{"data-test-subj":"loading-spinner",size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:fieldName,component:eui_form["a"],componentProps:{idAria:"caseComment",isDisabled:isLoading,dataTestSubj:"add-comment",placeholder:cases_translations["c"],onCursorPositionUpdate:handleCursorChange,onClickTimeline:handleTimelineClick,bottomRightContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"submit-comment",iconType:"plusInCircle",isDisabled:isLoading||disabled,isLoading:isLoading,onClick:onSubmit,size:"s"},cases_translations["b"])}})))}));AddComment.displayName="AddComment";const UserActionUsernameComponent=({username:username,fullName:fullName})=>{var _ref;const tooltipContent=(_ref=Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(fullName)?username:fullName)!==null&&_ref!==void 0?_ref:cases_translations["L"];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,tooltipContent),"data-test-subj":"user-action-username-tooltip"},external_kbnSharedDeps_React_default.a.createElement("strong",null,username!==null&&username!==void 0?username:cases_translations["L"].toLowerCase()))};const UserActionUsername=Object(external_kbnSharedDeps_React_["memo"])(UserActionUsernameComponent);const UserActionUsernameWithAvatarComponent=({username:username,fullName:fullName})=>{var _ref;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,alignItems:"center",gutterSize:"s","data-test-subj":"user-action-username-with-avatar"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAvatar"],{size:"s",name:(_ref=Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(fullName)?username:fullName)!==null&&_ref!==void 0?_ref:cases_translations["L"],"data-test-subj":"user-action-username-avatar"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:username,fullName:fullName})))};const UserActionUsernameWithAvatar=Object(external_kbnSharedDeps_React_["memo"])(UserActionUsernameWithAvatarComponent);const UserActionTimestampComponent=({createdAt:createdAt,updatedAt:updatedAt})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip["a"],{date:new Date(createdAt)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{"data-test-subj":"user-action-title-creation-relative-time",value:createdAt})),updatedAt&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:"subdued"}," (",EDITED_FIELD," ",external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip["a"],{date:new Date(updatedAt)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{"data-test-subj":"user-action-title-edited-relative-time",value:updatedAt})),")"));const UserActionTimestamp=Object(external_kbnSharedDeps_React_["memo"])(UserActionTimestampComponent);var copy_to_clipboard=__webpack_require__(574);var copy_to_clipboard_default=__webpack_require__.n(copy_to_clipboard);const UserActionCopyLinkComponent=({id:id})=>{const _useParams=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])(),caseId=_useParams.detailName;const _useFormatUrl=Object(link_to["n"])(app_types["a"].case),formatUrl=_useFormatUrl.formatUrl;const handleAnchorLink=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{copy_to_clipboard_default()(formatUrl(Object(link_to["c"])({id:caseId,commentId:id}),{absolute:true}))},[caseId,formatUrl,id]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,COPY_REFERENCE_LINK)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":COPY_REFERENCE_LINK,"data-test-subj":"copy-link-".concat(id),onClick:handleAnchorLink,iconType:"link",id:"".concat(id,"-permLink")}))};const UserActionCopyLink=Object(external_kbnSharedDeps_React_["memo"])(UserActionCopyLinkComponent);const UserActionMoveToReferenceComponent=({id:id,outlineComment:outlineComment})=>{const handleMoveToLink=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{outlineComment(id)},[id,outlineComment]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,MOVE_TO_ORIGINAL_COMMENT)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":MOVE_TO_ORIGINAL_COMMENT,"data-test-subj":"move-to-link-".concat(id),onClick:handleMoveToLink,iconType:"arrowUp"}))};const UserActionMoveToReference=Object(external_kbnSharedDeps_React_["memo"])(UserActionMoveToReferenceComponent);const getLabelTitle=({action:action,field:field})=>{if(field==="tags"){return getTagsLabelTitle(action)}else if(field==="title"&&action.action==="update"){return"".concat(CHANGED_FIELD.toLowerCase()," ").concat(cases_translations["f"].toLowerCase(),"  ").concat(cases_translations["K"],' "').concat(action.newValue,'"')}else if(field==="description"&&action.action==="update"){return"".concat(EDITED_FIELD," ").concat(cases_translations["r"].toLowerCase())}else if(field==="status"&&action.action==="update"){return"".concat(action.newValue==="open"?cases_translations["C"].toLowerCase():cases_translations["g"].toLowerCase()," ").concat(CASE)}else if(field==="comment"&&action.action==="update"){return"".concat(EDITED_FIELD," ").concat(COMMENT.toLowerCase())}return""};const getConnectorLabelTitle=({action:action,connectors:connectors})=>{const oldValue=Object(containers_utils["m"])("".concat(action.oldValue));const newValue=Object(containers_utils["m"])("".concat(action.newValue));if(oldValue===null||newValue===null){return""}if(oldValue.id!==newValue.id){const newConnector=connectors.find(c=>c.id===newValue.id);return newValue.id!=null&&newValue.id!=="none"&&newConnector!=null?SELECTED_THIRD_PARTY(newConnector.name):REMOVED_THIRD_PARTY}else{return CHANGED_CONNECTOR_FIELD}};const getTagsLabelTitle=action=>{const tags=action.newValue!=null?action.newValue.split(","):[];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"baseline",gutterSize:"xs",component:"span"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"ua-tags-label",grow:false},action.action==="add"&&ADDED_FIELD,action.action==="delete"&&REMOVED_FIELD," ",cases_translations["H"].toLowerCase()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(Tags,{tags:tags,gutterSize:"xs"})))};const getPushedServiceLabelTitle=(action,firstPush)=>{var _action$newValue;const pushedVal=JSON.parse((_action$newValue=action.newValue)!==null&&_action$newValue!==void 0?_action$newValue:"");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"baseline",gutterSize:"xs","data-test-subj":"pushed-service-label-title"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"pushed-label"},"".concat(firstPush?PUSHED_NEW_INCIDENT:UPDATE_INCIDENT," ").concat(pushedVal===null||pushedVal===void 0?void 0:pushedVal.connector_name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{"data-test-subj":"pushed-value",href:pushedVal===null||pushedVal===void 0?void 0:pushedVal.external_url,target:"_blank"},pushedVal===null||pushedVal===void 0?void 0:pushedVal.external_title)))};const getPushInfo=(caseServices,parsedValue,index)=>{var _caseServices$parsedV;return parsedValue!=null?{firstPush:((_caseServices$parsedV=caseServices[parsedValue.connector_id])===null||_caseServices$parsedV===void 0?void 0:_caseServices$parsedV.firstPushIndex)===index,parsedConnectorId:parsedValue.connector_id,parsedConnectorName:parsedValue.connector_name}:{firstPush:false,parsedConnectorId:"none",parsedConnectorName:"none"}};const getUpdateAction=({action:action,label:label,handleOutlineComment:handleOutlineComment})=>({username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsernameWithAvatar,{username:action.actionBy.username,fullName:action.actionBy.fullName}),type:"update",event:label,"data-test-subj":"".concat(action.actionField[0],"-").concat(action.action,"-action-").concat(action.actionId),timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:action.actionAt}),timelineIcon:action.action==="add"||action.action==="delete"?"tag":"dot",actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionCopyLink,{id:action.actionId})),action.action==="update"&&action.commentId!=null&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionMoveToReference,{id:action.commentId,outlineComment:handleOutlineComment})))});const UserActionAvatarComponent=({username:username,fullName:fullName})=>{const avatarName=fullName&&fullName.length>0?fullName:username!==null&&username!==void 0?username:cases_translations["L"];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAvatar"],{name:avatarName,"data-test-subj":"user-action-avatar"})};const UserActionAvatar=Object(external_kbnSharedDeps_React_["memo"])(UserActionAvatarComponent);const user_action_tree_schema_emptyField=shared_imports["w"].emptyField;const user_action_tree_schema_schema={content:{type:shared_imports["c"].TEXTAREA,validations:[{validator:user_action_tree_schema_emptyField(cases_translations["F"])}]}};function user_action_markdown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function user_action_markdown_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){user_action_markdown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){user_action_markdown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const ContentWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ContentWrapper",componentId:"t03oqe-0"})(["padding:",";"],({theme:theme})=>"".concat(theme.eui.euiSizeM," ").concat(theme.eui.euiSizeL));const UserActionMarkdown=({id:id,content:content,isEditable:isEditable,onChangeEditable:onChangeEditable,onSaveContent:onSaveContent})=>{const initialState={content:content};const _useForm=Object(shared_imports["H"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:user_action_tree_schema_schema}),form=_useForm.form;const fieldName="content";const submit=form.submit;const handleCancelAction=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{onChangeEditable(id)},[id,onChangeEditable]);const handleSaveAction=Object(external_kbnSharedDeps_React_["useCallback"])(user_action_markdown_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$submit,isValid,data;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return submit();case 2:_yield$submit=_context.sent;isValid=_yield$submit.isValid;data=_yield$submit.data;if(isValid){onSaveContent(data.content)}onChangeEditable(id);case 7:case"end":return _context.stop()}}),_callee)}))),[id,onChangeEditable,onSaveContent,submit]);const renderButtons=Object(external_kbnSharedDeps_React_["useCallback"])(({cancelAction:cancelAction,saveAction:saveAction})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"user-action-cancel-markdown",size:"s",onClick:cancelAction,iconType:"cross"},cases_translations["e"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"user-action-save-markdown",color:"secondary",fill:true,iconType:"save",onClick:saveAction,size:"s"},cases_translations["G"]))),[]);return isEditable?external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form,"data-test-subj":"user-action-markdown-form"},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:fieldName,component:markdown_editor["MarkdownEditorForm"],componentProps:{"aria-label":"Cases markdown editor",value:content,id:id,bottomRightContent:renderButtons({cancelAction:handleCancelAction,saveAction:handleSaveAction})}})):external_kbnSharedDeps_React_default.a.createElement(ContentWrapper,{"data-test-subj":"user-action-markdown"},external_kbnSharedDeps_React_default.a.createElement(markdown_editor["MarkdownRenderer"],null,content))};const ACTIONS_ARIA=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.editActionsLinkAria",{defaultMessage:"click to see all actions"});function property_actions_slicedToArray(arr,i){return property_actions_arrayWithHoles(arr)||property_actions_iterableToArrayLimit(arr,i)||property_actions_unsupportedIterableToArray(arr,i)||property_actions_nonIterableRest()}function property_actions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function property_actions_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return property_actions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return property_actions_arrayLikeToArray(o,minLen)}function property_actions_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function property_actions_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function property_actions_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ComponentId="property-actions";const PropertyActionButton=external_kbnSharedDeps_React_default.a.memo(({disabled:disabled=false,onClick:onClick,iconType:iconType,label:label})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"".concat(ComponentId,"-").concat(iconType),"aria-label":label,color:"text",iconSide:"left",iconType:iconType,isDisabled:disabled,onClick:onClick},label));PropertyActionButton.displayName="PropertyActionButton";const PropertyActions=external_kbnSharedDeps_React_default.a.memo(({propertyActions:propertyActions})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=property_actions_slicedToArray(_useState,2),showActions=_useState2[0],setShowActions=_useState2[1];const onButtonClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowActions(!showActions)},[showActions]);const onClosePopover=Object(external_kbnSharedDeps_React_["useCallback"])(cb=>{setShowActions(false);if(cb!=null){cb()}},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"flexStart","data-test-subj":ComponentId,gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{anchorPosition:"downRight",ownFocus:true,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"".concat(ComponentId,"-ellipses"),"aria-label":ACTIONS_ARIA,iconType:"boxesHorizontal",onClick:onButtonClick}),id:"settingsPopover",isOpen:showActions,closePopover:onClosePopover,repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"flexStart","data-test-subj":"".concat(ComponentId,"-group"),direction:"column",gutterSize:"none"},propertyActions.map((action,key)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:"".concat(action.label).concat(key)},external_kbnSharedDeps_React_default.a.createElement(PropertyActionButton,{disabled:action.disabled,iconType:action.iconType,label:action.label,onClick:()=>onClosePopover(action.onClick)})))))))});PropertyActions.displayName="PropertyActions";const UserActionPropertyActionsComponent=({id:id,editLabel:editLabel,quoteLabel:quoteLabel,disabled:disabled,isLoading:isLoading,onEdit:onEdit,onQuote:onQuote})=>{const onEditClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onEdit(id),[id,onEdit]);const onQuoteClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onQuote(id),[id,onQuote]);const propertyActions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{disabled:disabled,iconType:"pencil",label:editLabel,onClick:onEditClick},{disabled:disabled,iconType:"quote",label:quoteLabel,onClick:onQuoteClick}],[disabled,editLabel,quoteLabel,onEditClick,onQuoteClick]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{"data-test-subj":"user-action-title-loading"}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement(PropertyActions,{propertyActions:propertyActions}))};const UserActionPropertyActions=Object(external_kbnSharedDeps_React_["memo"])(UserActionPropertyActionsComponent);const UserActionContentToolbarComponent=({id:id,editLabel:editLabel,quoteLabel:quoteLabel,disabled:disabled,isLoading:isLoading,onEdit:onEdit,onQuote:onQuote})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionCopyLink,{id:id})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionPropertyActions,{id:id,editLabel:editLabel,quoteLabel:quoteLabel,disabled:disabled,isLoading:isLoading,onEdit:onEdit,onQuote:onQuote})));const UserActionContentToolbar=Object(external_kbnSharedDeps_React_["memo"])(UserActionContentToolbarComponent);function user_action_tree_slicedToArray(arr,i){return user_action_tree_arrayWithHoles(arr)||user_action_tree_iterableToArrayLimit(arr,i)||user_action_tree_unsupportedIterableToArray(arr,i)||user_action_tree_nonIterableRest()}function user_action_tree_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function user_action_tree_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return user_action_tree_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return user_action_tree_arrayLikeToArray(o,minLen)}function user_action_tree_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function user_action_tree_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function user_action_tree_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const MyEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyEuiFlexGroup",componentId:"sc-1dz3qn9-0"})(["margin-bottom:8px;"]);const MyEuiCommentList=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiCommentList"]).withConfig({displayName:"MyEuiCommentList",componentId:"sc-1dz3qn9-1"})(["",""],({theme:theme})=>"\n    & .userAction__comment.outlined .euiCommentEvent {\n      outline: solid 5px ".concat(theme.eui.euiColorVis1_behindText,";\n      margin: 0.5em;\n      transition: 0.8s;\n    }\n\n    & .euiComment.isEdit {\n      & .euiCommentEvent {\n        border: none;\n        box-shadow: none;\n      }\n\n      & .euiCommentEvent__body {\n        padding: 0;\n      }\n\n      & .euiCommentEvent__header {\n        display: none;\n      }\n    }\n  "));const DESCRIPTION_ID="description";const NEW_ID="newComment";const UserActionTree=external_kbnSharedDeps_React_default.a.memo(({data:caseData,caseServices:caseServices,caseUserActions:caseUserActions,connectors:connectors,fetchUserActions:fetchUserActions,isLoadingDescription:isLoadingDescription,isLoadingUserActions:isLoadingUserActions,onUpdateField:onUpdateField,updateCase:updateCase,userCanCrud:userCanCrud})=>{const _useParams=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])(),commentId=_useParams.commentId;const handlerTimeoutId=Object(external_kbnSharedDeps_React_["useRef"])(0);const addCommentRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=user_action_tree_slicedToArray(_useState,2),initLoading=_useState2[0],setInitLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(""),_useState4=user_action_tree_slicedToArray(_useState3,2),selectedOutlineCommentId=_useState4[0],setSelectedOutlineCommentId=_useState4[1];const _useUpdateComment=useUpdateComment(),isLoadingIds=_useUpdateComment.isLoadingIds,patchComment=_useUpdateComment.patchComment;const currentUser=Object(lib_kibana["d"])();const _useState5=Object(external_kbnSharedDeps_React_["useState"])([]),_useState6=user_action_tree_slicedToArray(_useState5,2),manageMarkdownEditIds=_useState6[0],setManangeMardownEditIds=_useState6[1];const handleManageMarkdownEditId=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{if(!manageMarkdownEditIds.includes(id)){setManangeMardownEditIds([...manageMarkdownEditIds,id])}else{setManangeMardownEditIds(manageMarkdownEditIds.filter(myId=>id!==myId))}},[manageMarkdownEditIds]);const handleSaveComment=Object(external_kbnSharedDeps_React_["useCallback"])(({id:id,version:version},content)=>{patchComment({caseId:caseData.id,commentId:id,commentUpdate:content,fetchUserActions:fetchUserActions,version:version,updateCase:updateCase})},[caseData.id,fetchUserActions,patchComment,updateCase]);const handleOutlineComment=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{const moveToTarget=document.getElementById("".concat(id,"-permLink"));if(moveToTarget!=null){const yOffset=-60;const y=moveToTarget.getBoundingClientRect().top+window.pageYOffset+yOffset;window.scrollTo({top:y,behavior:"smooth"});if(id==="add-comment"){moveToTarget.getElementsByTagName("textarea")[0].focus()}}window.clearTimeout(handlerTimeoutId.current);setSelectedOutlineCommentId(id);handlerTimeoutId.current=window.setTimeout(()=>{setSelectedOutlineCommentId("");window.clearTimeout(handlerTimeoutId.current)},2400)},[handlerTimeoutId]);const handleManageQuote=Object(external_kbnSharedDeps_React_["useCallback"])(quote=>{const addCarrots=quote.replace(new RegExp("\r?\n","g"),"  \n> ");if(addCommentRef&&addCommentRef.current){addCommentRef.current.addQuote("> ".concat(addCarrots," \n"))}handleOutlineComment("add-comment")},[handleOutlineComment]);const handleUpdate=Object(external_kbnSharedDeps_React_["useCallback"])(newCase=>{updateCase(newCase);fetchUserActions()},[fetchUserActions,updateCase]);const MarkdownDescription=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(UserActionMarkdown,{id:DESCRIPTION_ID,content:caseData.description,isEditable:manageMarkdownEditIds.includes(DESCRIPTION_ID),onSaveContent:content=>{onUpdateField({key:DESCRIPTION_ID,value:content})},onChangeEditable:handleManageMarkdownEditId}),[caseData.description,handleManageMarkdownEditId,manageMarkdownEditIds,onUpdateField]);const MarkdownNewComment=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(AddComment,{caseId:caseData.id,disabled:!userCanCrud,ref:addCommentRef,onCommentPosted:handleUpdate,onCommentSaving:handleManageMarkdownEditId.bind(null,NEW_ID),showLoading:false}),[caseData.id,handleUpdate,userCanCrud,handleManageMarkdownEditId]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(initLoading&&!isLoadingUserActions&&isLoadingIds.length===0){setInitLoading(false);if(commentId!=null){handleOutlineComment(commentId)}}},[commentId,initLoading,isLoadingUserActions,isLoadingIds,handleOutlineComment]);const descriptionCommentListObj=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:caseData.createdBy.username,fullName:caseData.createdBy.fullName}),event:ADDED_DESCRIPTION,"data-test-subj":"description-action",timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:caseData.createdAt}),children:MarkdownDescription,timelineIcon:external_kbnSharedDeps_React_default.a.createElement(UserActionAvatar,{username:caseData.createdBy.username,fullName:caseData.createdBy.fullName}),className:classnames_default()({isEdit:manageMarkdownEditIds.includes(DESCRIPTION_ID)}),actions:external_kbnSharedDeps_React_default.a.createElement(UserActionContentToolbar,{id:DESCRIPTION_ID,editLabel:EDIT_DESCRIPTION,quoteLabel:QUOTE,disabled:!userCanCrud,isLoading:isLoadingDescription,onEdit:handleManageMarkdownEditId.bind(null,DESCRIPTION_ID),onQuote:handleManageQuote.bind(null,caseData.description)})}),[MarkdownDescription,caseData,handleManageMarkdownEditId,handleManageQuote,isLoadingDescription,userCanCrud,manageMarkdownEditIds]);const userActions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>caseUserActions.reduce((comments,action,index)=>{if(action.commentId!=null&&action.action==="create"){const comment=caseData.comments.find(c=>c.id===action.commentId);if(comment!=null){return[...comments,{username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:comment.createdBy.username,fullName:comment.createdBy.fullName}),"data-test-subj":"comment-create-action-".concat(comment.id),timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:comment.createdAt,updatedAt:comment.updatedAt}),className:classnames_default()("userAction__comment",{outlined:comment.id===selectedOutlineCommentId,isEdit:manageMarkdownEditIds.includes(comment.id)}),children:external_kbnSharedDeps_React_default.a.createElement(UserActionMarkdown,{id:comment.id,content:comment.comment,isEditable:manageMarkdownEditIds.includes(comment.id),onChangeEditable:handleManageMarkdownEditId,onSaveContent:handleSaveComment.bind(null,{id:comment.id,version:comment.version})}),timelineIcon:external_kbnSharedDeps_React_default.a.createElement(UserActionAvatar,{username:comment.createdBy.username,fullName:comment.createdBy.fullName}),actions:external_kbnSharedDeps_React_default.a.createElement(UserActionContentToolbar,{id:comment.id,editLabel:EDIT_COMMENT,quoteLabel:QUOTE,disabled:!userCanCrud,isLoading:isLoadingIds.includes(comment.id),onEdit:handleManageMarkdownEditId.bind(null,comment.id),onQuote:handleManageQuote.bind(null,comment.comment)})}]}}if(action.actionField.length===1&&action.actionField[0]==="connector"){const label=getConnectorLabelTitle({action:action,connectors:connectors});return[...comments,getUpdateAction({action:action,label:label,handleOutlineComment:handleOutlineComment})]}if(action.actionField.length===1&&action.actionField[0]==="pushed"){var _caseServices$parsedC,_caseServices$parsedC2;const parsedValue=Object(containers_utils["m"])("".concat(action.newValue));const _getPushInfo=getPushInfo(caseServices,parsedValue,index),firstPush=_getPushInfo.firstPush,parsedConnectorId=_getPushInfo.parsedConnectorId,parsedConnectorName=_getPushInfo.parsedConnectorName;const label=getPushedServiceLabelTitle(action,firstPush);const showTopFooter=action.action==="push-to-service"&&index===((_caseServices$parsedC=caseServices[parsedConnectorId])===null||_caseServices$parsedC===void 0?void 0:_caseServices$parsedC.lastPushIndex);const showBottomFooter=action.action==="push-to-service"&&index===((_caseServices$parsedC2=caseServices[parsedConnectorId])===null||_caseServices$parsedC2===void 0?void 0:_caseServices$parsedC2.lastPushIndex)&&caseServices[parsedConnectorId].hasDataToPush;let footers=[];if(showTopFooter){footers=[...footers,{username:"",type:"update",event:ALREADY_PUSHED_TO_SERVICE("".concat(parsedConnectorName)),timelineIcon:"sortUp","data-test-subj":"top-footer"}]}if(showBottomFooter){footers=[...footers,{username:"",type:"update",event:REQUIRED_UPDATE_TO_SERVICE("".concat(parsedConnectorName)),timelineIcon:"sortDown","data-test-subj":"bottom-footer"}]}return[...comments,getUpdateAction({action:action,label:label,handleOutlineComment:handleOutlineComment}),...footers]}if(action.actionField.length===1&&["title","description","comment","tags"].includes(action.actionField[0])){const myField=action.actionField[0];const label=getLabelTitle({action:action,field:myField});return[...comments,getUpdateAction({action:action,label:label,handleOutlineComment:handleOutlineComment})]}return comments},[descriptionCommentListObj]),[caseData,caseServices,caseUserActions,connectors,handleOutlineComment,descriptionCommentListObj,handleManageMarkdownEditId,handleManageQuote,handleSaveComment,isLoadingIds,manageMarkdownEditIds,selectedOutlineCommentId,userCanCrud]);const bottomActions=[{username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:currentUser===null||currentUser===void 0?void 0:currentUser.username,fullName:currentUser===null||currentUser===void 0?void 0:currentUser.fullName}),"data-test-subj":"add-comment",timelineIcon:external_kbnSharedDeps_React_default.a.createElement(UserActionAvatar,{username:currentUser===null||currentUser===void 0?void 0:currentUser.username,fullName:currentUser===null||currentUser===void 0?void 0:currentUser.fullName}),className:"isEdit",children:MarkdownNewComment}];const comments=[...userActions,...bottomActions];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(MyEuiCommentList,{comments:comments,"data-test-subj":"user-actions"}),(isLoadingUserActions||isLoadingIds.includes(NEW_ID))&&external_kbnSharedDeps_React_default.a.createElement(MyEuiFlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{"data-test-subj":"user-actions-loading",size:"l"}))))});UserActionTree.displayName="UserActionTree";const SEND_EMAIL_ARIA=user=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.sendEmalLinkAria",{values:{user:user},defaultMessage:"click to send an email to {user}"});const MyAvatar=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiAvatar"]).withConfig({displayName:"MyAvatar",componentId:"i4ieve-0"})(["top:-4px;"]);const user_list_MyFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyFlexGroup",componentId:"i4ieve-1"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["margin-top:",";"],theme.eui.euiSizeM));const renderUsers=(users,handleSendEmail)=>users.map(({fullName:fullName,username:username,email:email},key)=>external_kbnSharedDeps_React_default.a.createElement(user_list_MyFlexGroup,{key:key,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(MyAvatar,{name:fullName?fullName:username!==null&&username!==void 0?username:""})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,fullName?fullName:username!==null&&username!==void 0?username:"")},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement("small",{"data-test-subj":"case-view-username"},username))))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"user-list-email-button",onClick:handleSendEmail.bind(null,email),iconType:"email","aria-label":SEND_EMAIL_ARIA(fullName?fullName:username!==null&&username!==void 0?username:""),isDisabled:Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(email)}))));const UserList=external_kbnSharedDeps_React_default.a.memo(({email:email,headline:headline,loading:loading,users:users})=>{const handleSendEmail=Object(external_kbnSharedDeps_React_["useCallback"])(emailAddress=>{if(emailAddress&&emailAddress!=null){window.open("mailto:".concat(emailAddress,"?subject=").concat(email.subject,"&body=").concat(email.body),"_blank")}},[email.subject]);return users.filter(({username:username})=>username!=null&&username!=="").length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h4",null,headline),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"xs"}),loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],null))),renderUsers(users.filter(({username:username})=>username!=null&&username!==""),handleSendEmail)):null});UserList.displayName="UserList";function use_update_case_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_update_case_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_update_case_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_update_case_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_update_case_slicedToArray(arr,i){return use_update_case_arrayWithHoles(arr)||use_update_case_iterableToArrayLimit(arr,i)||use_update_case_unsupportedIterableToArray(arr,i)||use_update_case_nonIterableRest()}function use_update_case_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_update_case_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_update_case_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_update_case_arrayLikeToArray(o,minLen)}function use_update_case_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_update_case_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_update_case_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function use_update_case_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_update_case_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_update_case_ownKeys(Object(source),true).forEach((function(key){use_update_case_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_update_case_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_update_case_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const use_update_case_dataFetchReducer=(state,action)=>{switch(action.type){case"FETCH_INIT":return use_update_case_objectSpread(use_update_case_objectSpread({},state),{},{isLoading:true,isError:false,updateKey:action.payload});case"FETCH_SUCCESS":return use_update_case_objectSpread(use_update_case_objectSpread({},state),{},{isLoading:false,isError:false,updateKey:null});case"FETCH_FAILURE":return use_update_case_objectSpread(use_update_case_objectSpread({},state),{},{isLoading:false,isError:true,updateKey:null});default:return state}};const useUpdateCase=({caseId:caseId})=>{const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(use_update_case_dataFetchReducer,{isLoading:false,isError:false,updateKey:null}),_useReducer2=use_update_case_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_update_case_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const dispatchUpdateCaseProperty=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref=use_update_case_asyncToGenerator(regeneratorRuntime.mark((function _callee({fetchCaseUserActions:fetchCaseUserActions,updateKey:updateKey,updateValue:updateValue,updateCase:updateCase,version:version,onSuccess:onSuccess,onError:onError}){var cancel,abortCtrl,response;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:cancel=false;abortCtrl=new AbortController;_context.prev=2;dispatch({type:"FETCH_INIT",payload:updateKey});_context.next=6;return Object(containers_api["i"])(caseId,{[updateKey]:updateValue},version,abortCtrl.signal);case 6:response=_context.sent;if(!cancel){if(fetchCaseUserActions!=null){fetchCaseUserActions(caseId)}if(updateCase!=null){updateCase(response[0])}dispatch({type:"FETCH_SUCCESS"});Object(toasters["e"])(containers_translations["h"](response[0].title),dispatchToaster);if(onSuccess){onSuccess()}}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context["catch"](2);if(!cancel){Object(toasters["g"])({title:containers_translations["e"],error:_context.t0.body&&_context.t0.body.message?new Error(_context.t0.body.message):_context.t0,dispatchToaster:dispatchToaster});dispatch({type:"FETCH_FAILURE"});if(onError){onError()}}case 13:return _context.abrupt("return",()=>{cancel=true;abortCtrl.abort()});case 14:case"end":return _context.stop()}}),_callee,null,[[2,10]])})));return function(_x){return _ref.apply(this,arguments)}}(),[]);return use_update_case_objectSpread(use_update_case_objectSpread({},state),{},{updateCaseProperty:dispatchUpdateCaseProperty})};const WhitePageWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"WhitePageWrapper",componentId:"d11hu8-0"})(["background-color:",";border-top:",";flex:1 1 auto;"],({theme:theme})=>theme.eui.euiColorEmptyShade,({theme:theme})=>theme.eui.euiBorderThin);const SectionWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"SectionWrapper",componentId:"d11hu8-1"})(["box-sizing:content-box;margin:0 auto;max-width:1175px;width:100%;"]);const wrappers_HeaderWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HeaderWrapper",componentId:"d11hu8-2"})(["padding:",";"],({theme:theme})=>"".concat(theme.eui.paddingSizes.l," ").concat(lib_helpers["d"]," 0\n  ").concat(theme.eui.paddingSizes.l));var use_delete_cases=__webpack_require__(628);var confirm_delete_case=__webpack_require__(712);const CaseViewActionsComponent=({caseData:caseData,currentExternalIncident:currentExternalIncident,disabled:disabled=false})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useDeleteCases=Object(use_delete_cases["a"])(),handleToggleModal=_useDeleteCases.handleToggleModal,handleOnDeleteConfirm=_useDeleteCases.handleOnDeleteConfirm,isDeleted=_useDeleteCases.isDeleted,isDisplayConfirmDeleteModal=_useDeleteCases.isDisplayConfirmDeleteModal;const confirmDeleteModal=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(confirm_delete_case["a"],{caseTitle:caseData.title,isModalVisible:isDisplayConfirmDeleteModal,isPlural:false,onCancel:handleToggleModal,onConfirm:handleOnDeleteConfirm.bind(null,[{id:caseData.id,title:caseData.title}])}),[isDisplayConfirmDeleteModal,caseData]);const propertyActions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _currentExternalIncid;return[{disabled:disabled,iconType:"trash",label:cases_translations["p"],onClick:handleToggleModal},...currentExternalIncident!=null&&!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(currentExternalIncident===null||currentExternalIncident===void 0?void 0:currentExternalIncident.externalUrl)?[{iconType:"popout",label:VIEW_INCIDENT((_currentExternalIncid=currentExternalIncident===null||currentExternalIncident===void 0?void 0:currentExternalIncident.externalTitle)!==null&&_currentExternalIncid!==void 0?_currentExternalIncid:""),onClick:()=>window.open(currentExternalIncident===null||currentExternalIncident===void 0?void 0:currentExternalIncident.externalUrl,"_blank")}]:[]]},[disabled,handleToggleModal,currentExternalIncident]);if(isDeleted){history.push("/");return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(PropertyActions,{propertyActions:propertyActions}),confirmDeleteModal)};const CaseViewActions=external_kbnSharedDeps_React_default.a.memo(CaseViewActionsComponent);const MyDescriptionList=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"]).withConfig({displayName:"MyDescriptionList",componentId:"pbwdj-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["&{padding-right:",";border-right:",";}"],theme.eui.euiSizeL,theme.eui.euiBorderThin));const CaseStatusComp=({"data-test-subj":dataTestSubj,badgeColor:badgeColor,buttonLabel:buttonLabel,caseData:caseData,currentExternalIncident:currentExternalIncident,disabled:disabled=false,icon:icon,isLoading:isLoading,isSelected:isSelected,onRefresh:onRefresh,status:status,title:title,toggleStatusCase:toggleStatusCase,value:value})=>{const handleToggleStatusCase=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{toggleStatusCase(!isSelected)},[toggleStatusCase,isSelected]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"l",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyDescriptionList,{compressed:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,translations_STATUS),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:badgeColor,"data-test-subj":"case-view-status"},status))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,title),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(formatted_date["b"],{"data-test-subj":dataTestSubj,value:value})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"l",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"case-refresh",iconType:"refresh",onClick:onRefresh},CASE_REFRESH)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"toggle-case-status",isDisabled:disabled,iconType:icon,isLoading:isLoading,fill:isSelected,onClick:handleToggleStatusCase},buttonLabel)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(CaseViewActions,{caseData:caseData,currentExternalIncident:currentExternalIncident,disabled:disabled})))))};const CaseStatus=external_kbnSharedDeps_React_default.a.memo(CaseStatusComp);function use_get_case_user_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_get_case_user_actions_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_get_case_user_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_get_case_user_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_get_case_user_actions_slicedToArray(arr,i){return use_get_case_user_actions_arrayWithHoles(arr)||use_get_case_user_actions_iterableToArrayLimit(arr,i)||use_get_case_user_actions_unsupportedIterableToArray(arr,i)||use_get_case_user_actions_nonIterableRest()}function use_get_case_user_actions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_get_case_user_actions_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_get_case_user_actions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_get_case_user_actions_arrayLikeToArray(o,minLen)}function use_get_case_user_actions_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_get_case_user_actions_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_get_case_user_actions_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function use_get_case_user_actions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_get_case_user_actions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_get_case_user_actions_ownKeys(Object(source),true).forEach((function(key){use_get_case_user_actions_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_get_case_user_actions_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_get_case_user_actions_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const use_get_case_user_actions_initialData={caseServices:{},caseUserActions:[],hasDataToPush:false,isError:false,isLoading:true,participants:[]};const getExternalService=value=>Object(containers_utils["c"])(Object(containers_utils["m"])("".concat(value)));const groupConnectorFields=userActions=>userActions.reduce((acc,mua)=>{if(mua.actionField[0]!=="connector"){return acc}const oldValue=Object(containers_utils["m"])("".concat(mua.oldValue));const newValue=Object(containers_utils["m"])("".concat(mua.newValue));if(oldValue==null||newValue==null){return acc}return use_get_case_user_actions_objectSpread(use_get_case_user_actions_objectSpread({},acc),{},{[oldValue.id]:[...acc[oldValue.id]||[],...oldValue.id===newValue.id?[oldValue.fields,newValue.fields]:[oldValue.fields]],[newValue.id]:[...acc[newValue.id]||[],...oldValue.id===newValue.id?[oldValue.fields,newValue.fields]:[newValue.fields]]})},{});const connectorHasChangedFields=({connectorFieldsBeforePush:connectorFieldsBeforePush,connectorFieldsAfterPush:connectorFieldsAfterPush,connectorId:connectorId})=>{if(connectorFieldsAfterPush==null||connectorFieldsAfterPush[connectorId]==null){return false}const fieldsAfterPush=connectorFieldsAfterPush[connectorId];if(connectorFieldsBeforePush!=null&&connectorFieldsBeforePush[connectorId]!=null){const fieldsBeforePush=connectorFieldsBeforePush[connectorId];return!fast_deep_equal_default()(fieldsBeforePush[fieldsBeforePush.length-1],fieldsAfterPush[fieldsAfterPush.length-1])}if(fieldsAfterPush.length>=2){return!fast_deep_equal_default()(fieldsAfterPush[fieldsAfterPush.length-2],fieldsAfterPush[fieldsAfterPush.length-1])}return false};const getPushedInfo=(caseUserActions,caseConnectorId)=>{const hasDataToPushForConnector=connectorId=>{const caseUserActionsReversed=[...caseUserActions].reverse();const lastPushOfConnectorReversedIndex=caseUserActionsReversed.findIndex(mua=>{var _getExternalService;return mua.action==="push-to-service"&&((_getExternalService=getExternalService("".concat(mua.newValue)))===null||_getExternalService===void 0?void 0:_getExternalService.connectorId)===connectorId});if(lastPushOfConnectorReversedIndex===-1){return true}const lastPushOfConnectorIndex=caseUserActionsReversed.length-lastPushOfConnectorReversedIndex-1;const actionsBeforePush=caseUserActions.slice(0,lastPushOfConnectorIndex);const actionsAfterPush=caseUserActions.slice(lastPushOfConnectorIndex+1,caseUserActionsReversed.length);const connectorFieldsBeforePush=groupConnectorFields(actionsBeforePush);const connectorFieldsAfterPush=groupConnectorFields(actionsAfterPush);const connectorHasChanged=connectorHasChangedFields({connectorFieldsBeforePush:connectorFieldsBeforePush,connectorFieldsAfterPush:connectorFieldsAfterPush,connectorId:connectorId});return actionsAfterPush.some(mua=>mua.actionField[0]!=="connector"&&mua.action!=="push-to-service")||connectorHasChanged};const commentsAndIndex=caseUserActions.reduce((bacc,mua,index)=>mua.actionField[0]==="comment"&&mua.commentId!=null?[...bacc,{commentId:mua.commentId,commentIndex:index}]:bacc,[]);let caseServices=caseUserActions.reduce((acc,cua,i)=>{if(cua.action!=="push-to-service"){return acc}const externalService=getExternalService("".concat(cua.newValue));if(externalService===null){return acc}return use_get_case_user_actions_objectSpread(use_get_case_user_actions_objectSpread({},acc),acc[externalService.connectorId]!=null?{[externalService.connectorId]:use_get_case_user_actions_objectSpread(use_get_case_user_actions_objectSpread(use_get_case_user_actions_objectSpread({},acc[externalService.connectorId]),externalService),{},{lastPushIndex:i,commentsToUpdate:[]})}:{[externalService.connectorId]:use_get_case_user_actions_objectSpread(use_get_case_user_actions_objectSpread({},externalService),{},{firstPushIndex:i,lastPushIndex:i,hasDataToPush:hasDataToPushForConnector(externalService.connectorId),commentsToUpdate:[]})})},{});caseServices=Object.keys(caseServices).reduce((acc,key)=>use_get_case_user_actions_objectSpread(use_get_case_user_actions_objectSpread({},acc),{},{[key]:use_get_case_user_actions_objectSpread(use_get_case_user_actions_objectSpread({},caseServices[key]),{},{commentsToUpdate:commentsAndIndex.reduce((bacc,currentComment)=>currentComment.commentIndex>caseServices[key].lastPushIndex?bacc.indexOf(currentComment.commentId)>-1?[...bacc.filter(e=>e!==currentComment.commentId),currentComment.commentId]:[...bacc,currentComment.commentId]:bacc,[])})}),{});const hasDataToPush=caseServices[caseConnectorId]!=null?caseServices[caseConnectorId].hasDataToPush:true;return{hasDataToPush:hasDataToPush,caseServices:caseServices}};const useGetCaseUserActions=(caseId,caseConnectorId)=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(use_get_case_user_actions_initialData),_useState2=use_get_case_user_actions_slicedToArray(_useState,2),caseUserActionsState=_useState2[0],setCaseUserActionsState=_useState2[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_get_case_user_actions_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const fetchCaseUserActions=Object(external_kbnSharedDeps_React_["useCallback"])(thisCaseId=>{let didCancel=false;const abortCtrl=new AbortController;const fetchData=function(){var _ref=use_get_case_user_actions_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var response,participants,caseUserActions;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setCaseUserActionsState(use_get_case_user_actions_objectSpread(use_get_case_user_actions_objectSpread({},caseUserActionsState),{},{isLoading:true}));_context.prev=1;_context.next=4;return Object(containers_api["d"])(thisCaseId,abortCtrl.signal);case 4:response=_context.sent;if(!didCancel){participants=!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(response)?Object(external_kbnSharedDeps_LodashFp_["uniqBy"])("actionBy.username",response).map(cau=>cau.actionBy):[];caseUserActions=!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(response)?response.slice(1):[];setCaseUserActionsState(use_get_case_user_actions_objectSpread(use_get_case_user_actions_objectSpread({caseUserActions:caseUserActions},getPushedInfo(caseUserActions,caseConnectorId)),{},{isLoading:false,isError:false,participants:participants}))}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);if(!didCancel){Object(toasters["g"])({title:containers_translations["e"],error:_context.t0.body&&_context.t0.body.message?new Error(_context.t0.body.message):_context.t0,dispatchToaster:dispatchToaster});setCaseUserActionsState({caseServices:{},caseUserActions:[],hasDataToPush:false,isError:true,isLoading:false,participants:[]})}case 11:case"end":return _context.stop()}}),_callee,null,[[1,8]])})));return function fetchData(){return _ref.apply(this,arguments)}}();fetchData();return()=>{didCancel=true;abortCtrl.abort()}},[caseUserActionsState,caseConnectorId]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(caseId)){fetchCaseUserActions(caseId)}},[caseId,caseConnectorId]);return use_get_case_user_actions_objectSpread(use_get_case_user_actions_objectSpread({},caseUserActionsState),{},{fetchCaseUserActions:fetchCaseUserActions})};var use_get_action_license=__webpack_require__(630);function use_post_push_to_service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_post_push_to_service_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_post_push_to_service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_post_push_to_service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_post_push_to_service_slicedToArray(arr,i){return use_post_push_to_service_arrayWithHoles(arr)||use_post_push_to_service_iterableToArrayLimit(arr,i)||use_post_push_to_service_unsupportedIterableToArray(arr,i)||use_post_push_to_service_nonIterableRest()}function use_post_push_to_service_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_post_push_to_service_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_post_push_to_service_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_post_push_to_service_arrayLikeToArray(o,minLen)}function use_post_push_to_service_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_post_push_to_service_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_post_push_to_service_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function use_post_push_to_service_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_post_push_to_service_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_post_push_to_service_ownKeys(Object(source),true).forEach((function(key){use_post_push_to_service_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_post_push_to_service_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_post_push_to_service_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const use_post_push_to_service_dataFetchReducer=(state,action)=>{var _action$payload,_action$payload2;switch(action.type){case"FETCH_INIT":return use_post_push_to_service_objectSpread(use_post_push_to_service_objectSpread({},state),{},{isLoading:true,isError:false});case"FETCH_SUCCESS_PUSH_SERVICE":return use_post_push_to_service_objectSpread(use_post_push_to_service_objectSpread({},state),{},{isLoading:false,isError:false,serviceData:(_action$payload=action.payload)!==null&&_action$payload!==void 0?_action$payload:null});case"FETCH_SUCCESS_PUSH_CASE":return use_post_push_to_service_objectSpread(use_post_push_to_service_objectSpread({},state),{},{isLoading:false,isError:false,pushedCaseData:(_action$payload2=action.payload)!==null&&_action$payload2!==void 0?_action$payload2:null});case"FETCH_FAILURE":return use_post_push_to_service_objectSpread(use_post_push_to_service_objectSpread({},state),{},{isLoading:false,isError:true});default:return state}};const usePostPushToService=()=>{const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(use_post_push_to_service_dataFetchReducer,{serviceData:null,pushedCaseData:null,isLoading:false,isError:false}),_useReducer2=use_post_push_to_service_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=use_post_push_to_service_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const postPushToService=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref=use_post_push_to_service_asyncToGenerator(regeneratorRuntime.mark((function _callee({caseId:caseId,caseServices:caseServices,connector:connector,updateCase:updateCase}){var cancel,abortCtrl,casePushData,responseService,responseCase;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:cancel=false;abortCtrl=new AbortController;_context.prev=2;dispatch({type:"FETCH_INIT"});_context.next=6;return Object(containers_api["c"])(caseId,true,abortCtrl.signal);case 6:casePushData=_context.sent;_context.next=9;return Object(containers_api["o"])(connector.id,formatServiceRequestData(casePushData,connector,caseServices),abortCtrl.signal);case 9:responseService=_context.sent;_context.next=12;return Object(containers_api["n"])(caseId,{connector_id:connector.id,connector_name:connector.name,external_id:responseService.id,external_title:responseService.title,external_url:responseService.url},abortCtrl.signal);case 12:responseCase=_context.sent;if(!cancel){dispatch({type:"FETCH_SUCCESS_PUSH_SERVICE",payload:responseService});dispatch({type:"FETCH_SUCCESS_PUSH_CASE",payload:responseCase});updateCase(responseCase);Object(toasters["e"])(containers_translations["g"](connector.name),dispatchToaster)}_context.next=19;break;case 16:_context.prev=16;_context.t0=_context["catch"](2);if(!cancel){Object(toasters["g"])({title:containers_translations["e"],error:_context.t0.body&&_context.t0.body.message?new Error(_context.t0.body.message):_context.t0,dispatchToaster:dispatchToaster});dispatch({type:"FETCH_FAILURE"})}case 19:return _context.abrupt("return",()=>{cancel=true;abortCtrl.abort()});case 20:case"end":return _context.stop()}}),_callee,null,[[2,16]])})));return function(_x){return _ref.apply(this,arguments)}}(),[]);return use_post_push_to_service_objectSpread(use_post_push_to_service_objectSpread({},state),{},{postPushToService:postPushToService})};const formatServiceRequestData=(myCase,connector,caseServices)=>{var _caseServices$connect,_createdBy$fullName,_createdBy$username,_actualExternalServic,_connector$fields,_updatedBy$fullName,_updatedBy$username;const caseId=myCase.id,createdAt=myCase.createdAt,createdBy=myCase.createdBy,comments=myCase.comments,description=myCase.description,title=myCase.title,updatedAt=myCase.updatedAt,updatedBy=myCase.updatedBy;const actualExternalService=(_caseServices$connect=caseServices[connector.id])!==null&&_caseServices$connect!==void 0?_caseServices$connect:null;return use_post_push_to_service_objectSpread(use_post_push_to_service_objectSpread({savedObjectId:caseId,createdAt:createdAt,createdBy:{fullName:(_createdBy$fullName=createdBy.fullName)!==null&&_createdBy$fullName!==void 0?_createdBy$fullName:null,username:(_createdBy$username=createdBy===null||createdBy===void 0?void 0:createdBy.username)!==null&&_createdBy$username!==void 0?_createdBy$username:""},comments:comments.filter(c=>actualExternalService==null||actualExternalService.commentsToUpdate.includes(c.id)).map(c=>{var _c$createdBy$fullName,_c$createdBy$username,_c$updatedBy$fullName,_c$updatedBy$username;return{commentId:c.id,comment:c.comment,createdAt:c.createdAt,createdBy:{fullName:(_c$createdBy$fullName=c.createdBy.fullName)!==null&&_c$createdBy$fullName!==void 0?_c$createdBy$fullName:null,username:(_c$createdBy$username=c.createdBy.username)!==null&&_c$createdBy$username!==void 0?_c$createdBy$username:""},updatedAt:c.updatedAt,updatedBy:c.updatedBy!=null?{fullName:(_c$updatedBy$fullName=c.updatedBy.fullName)!==null&&_c$updatedBy$fullName!==void 0?_c$updatedBy$fullName:null,username:(_c$updatedBy$username=c.updatedBy.username)!==null&&_c$updatedBy$username!==void 0?_c$updatedBy$username:""}:null}}),description:description,externalId:(_actualExternalServic=actualExternalService===null||actualExternalService===void 0?void 0:actualExternalService.externalId)!==null&&_actualExternalServic!==void 0?_actualExternalServic:null,title:title},(_connector$fields=connector.fields)!==null&&_connector$fields!==void 0?_connector$fields:{}),{},{updatedAt:updatedAt,updatedBy:updatedBy!=null?{fullName:(_updatedBy$fullName=updatedBy.fullName)!==null&&_updatedBy$fullName!==void 0?_updatedBy$fullName:null,username:(_updatedBy$username=updatedBy.username)!==null&&_updatedBy$username!==void 0?_updatedBy$username:""}:null})};var callout=__webpack_require__(347);var use_push_to_service_helpers=__webpack_require__(631);var use_push_to_service_translations=__webpack_require__(423);const usePushToService=({connector:connector,caseId:caseId,caseServices:caseServices,caseStatus:caseStatus,connectors:connectors,updateCase:updateCase,userCanCrud:userCanCrud,isValidConnector:isValidConnector})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useFormatUrl=Object(link_to["n"])(app_types["a"].case),formatUrl=_useFormatUrl.formatUrl,urlSearch=_useFormatUrl.search;const _usePostPushToService=usePostPushToService(),isLoading=_usePostPushToService.isLoading,postPushToService=_usePostPushToService.postPushToService;const _useGetActionLicense=Object(use_get_action_license["a"])(),loadingLicense=_useGetActionLicense.isLoading,actionLicense=_useGetActionLicense.actionLicense;const handlePushToService=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(connector.id!=null&&connector.id!=="none"){postPushToService({caseId:caseId,caseServices:caseServices,connector:connector,updateCase:updateCase})}},[caseId,caseServices,connector,postPushToService,updateCase]);const goToConfigureCases=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.push(Object(link_to["e"])(urlSearch))},[history,urlSearch]);const errorsMsg=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{let errors=[];if(actionLicense!=null&&!actionLicense.enabledInLicense){errors=[...errors,Object(use_push_to_service_helpers["c"])()]}if(connectors.length===0&&connector.id==="none"&&!loadingLicense){errors=[...errors,{id:"connector-missing-error",title:use_push_to_service_translations["h"],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"To open and update cases in external systems, you must configure a {link}.",id:"xpack.securitySolution.case.caseView.pushToServiceDisableByNoConnectors",values:{link:external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:goToConfigureCases,href:formatUrl(Object(link_to["e"])()),target:"_blank"},use_push_to_service_translations["c"])}})}]}else if(connector.id==="none"&&!loadingLicense){errors=[...errors,{id:"connector-not-selected-error",title:use_push_to_service_translations["g"],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"To open and update cases in external systems, you must select an external incident management system for this case.",id:"xpack.securitySolution.case.caseView.pushToServiceDisableByNoCaseConfigDescription"})}]}else if(!isValidConnector&&!loadingLicense){errors=[...errors,{id:"connector-deleted-error",title:use_push_to_service_translations["g"],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"The connector used to send updates to external service has been deleted. To update cases in external systems, select a different connector or create a new one.",id:"xpack.securitySolution.case.caseView.pushToServiceDisableByInvalidConnector"}),errorType:"danger"}]}if(caseStatus==="closed"){errors=[...errors,{id:"closed-case-push-error",title:use_push_to_service_translations["d"],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"Closed cases cannot be sent to external systems. Reopen the case if you want to open or update it in an external system.",id:"xpack.securitySolution.case.caseView.pushToServiceDisableBecauseCaseClosedDescription"})}]}if(actionLicense!=null&&!actionLicense.enabledInConfig){errors=[...errors,Object(use_push_to_service_helpers["b"])()]}return errors},[actionLicense,caseStatus,connectors.length,connector,loadingLicense,urlSearch]);const pushToServiceButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"push-to-external-service",fill:true,iconType:"importAction",onClick:handlePushToService,disabled:isLoading||loadingLicense||errorsMsg.length>0||!userCanCrud||!isValidConnector,isLoading:isLoading},caseServices[connector.id]?use_push_to_service_translations["j"](connector.name):use_push_to_service_translations["i"](connector.name)),[connector,connectors,errorsMsg,handlePushToService,isLoading,loadingLicense,userCanCrud,isValidConnector]);const objToReturn=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({pushButton:errorsMsg.length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",title:errorsMsg[0].title,content:external_kbnSharedDeps_React_default.a.createElement("p",null,errorsMsg[0].description)},pushToServiceButton):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,pushToServiceButton),pushCallouts:errorsMsg.length>0?external_kbnSharedDeps_React_default.a.createElement(callout["a"],{title:use_push_to_service_translations["a"],messages:errorsMsg}):null}),[errorsMsg,pushToServiceButton]);return objToReturn};const edit_connector_schema_schema={connectorId:{type:shared_imports["c"].SUPER_SELECT}};function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=edit_connector_helpers_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function edit_connector_helpers_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return edit_connector_helpers_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return edit_connector_helpers_arrayLikeToArray(o,minLen)}function edit_connector_helpers_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}const getConnectorFieldsFromUserActions=(id,userActions)=>{try{var _iterator=_createForOfIteratorHelper([...userActions].reverse()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){const action=_step.value;if(action.actionField.length===1&&action.actionField[0]==="connector"){if(action.oldValue&&action.newValue){const oldValue=JSON.parse(action.oldValue);const newValue=JSON.parse(action.newValue);if(newValue.id===id){return newValue.fields}if(oldValue.id===id){return oldValue.fields}}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return null}catch(_unused){return null}};const EDIT_CONNECTOR_ARIA=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.editConnector.editConnectorLinkAria",{defaultMessage:"click to edit connector"});function edit_connector_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function edit_connector_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){edit_connector_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){edit_connector_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function edit_connector_slicedToArray(arr,i){return edit_connector_arrayWithHoles(arr)||edit_connector_iterableToArrayLimit(arr,i)||edit_connector_unsupportedIterableToArray(arr,i)||edit_connector_nonIterableRest()}function edit_connector_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function edit_connector_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return edit_connector_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return edit_connector_arrayLikeToArray(o,minLen)}function edit_connector_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function edit_connector_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function edit_connector_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function edit_connector_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function edit_connector_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){edit_connector_ownKeys(Object(source),true).forEach((function(key){edit_connector_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{edit_connector_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function edit_connector_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const edit_connector_MyFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyFlexGroup",componentId:"sc-1e8a7nn-0"})(["",""],({theme:theme})=>"\n    margin-top: ".concat(theme.eui.euiSizeM,";\n    p {\n      font-size: ").concat(theme.eui.euiSizeM,";\n    }\n  "));const DisappearingFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"DisappearingFlexItem",componentId:"sc-1e8a7nn-1"})(["",""],({$isHidden:$isHidden})=>$isHidden&&"\n      margin: 0 !important;\n    ");const editConnectorReducer=(state,action)=>{switch(action.type){case"SET_CURRENT_CONNECTOR":return edit_connector_objectSpread(edit_connector_objectSpread({},state),{},{currentConnector:action.payload});case"SET_FIELDS":return edit_connector_objectSpread(edit_connector_objectSpread({},state),{},{fields:action.payload});case"SET_EDIT_CONNECTOR":return edit_connector_objectSpread(edit_connector_objectSpread({},state),{},{editConnector:action.payload});default:return state}};const edit_connector_initialState={currentConnector:null,fields:null,editConnector:false};const EditConnector=external_kbnSharedDeps_React_default.a.memo(({caseFields:caseFields,connectors:connectors,disabled:disabled=false,isLoading:isLoading,onSubmit:onSubmit,selectedConnector:selectedConnector,userActions:userActions})=>{const _useForm=Object(shared_imports["H"])({defaultValue:{connectorId:selectedConnector},options:{stripEmptyFields:false},schema:edit_connector_schema_schema}),form=_useForm.form;const setFieldValue=form.setFieldValue,submit=form.submit;const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(editConnectorReducer,edit_connector_objectSpread(edit_connector_objectSpread({},edit_connector_initialState),{},{fields:caseFields})),_useReducer2=edit_connector_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],currentConnector=_useReducer2$.currentConnector,fields=_useReducer2$.fields,editConnector=_useReducer2$.editConnector,dispatch=_useReducer2[1];const onChangeConnector=Object(external_kbnSharedDeps_React_["useCallback"])(newConnectorId=>{if(currentConnector==null){dispatch({type:"SET_CURRENT_CONNECTOR",payload:getConnectorById(newConnectorId,connectors)})}else if(currentConnector.id!==newConnectorId){dispatch({type:"SET_CURRENT_CONNECTOR",payload:getConnectorById(newConnectorId,connectors)});dispatch({type:"SET_FIELDS",payload:getConnectorFieldsFromUserActions(newConnectorId,userActions!==null&&userActions!==void 0?userActions:[])})}else if(fields===null){dispatch({type:"SET_FIELDS",payload:getConnectorFieldsFromUserActions(newConnectorId,userActions!==null&&userActions!==void 0?userActions:[])})}},[currentConnector,fields,userActions,connectors]);const onFieldsChange=Object(external_kbnSharedDeps_React_["useCallback"])(newFields=>{if(!fast_deep_equal_default()(newFields,fields)){dispatch({type:"SET_FIELDS",payload:newFields})}},[fields,dispatch]);const onError=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setFieldValue("connectorId",selectedConnector);dispatch({type:"SET_EDIT_CONNECTOR",payload:false})},[dispatch,setFieldValue,selectedConnector]);const onCancelConnector=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setFieldValue("connectorId",selectedConnector);dispatch({type:"SET_FIELDS",payload:caseFields});dispatch({type:"SET_EDIT_CONNECTOR",payload:false})},[dispatch,selectedConnector,setFieldValue,caseFields]);const onSubmitConnector=Object(external_kbnSharedDeps_React_["useCallback"])(edit_connector_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$submit,isValid,newData;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return submit();case 2:_yield$submit=_context.sent;isValid=_yield$submit.isValid;newData=_yield$submit.data;if(isValid&&newData.connectorId){onSubmit(newData.connectorId,fields,onError,external_kbnSharedDeps_LodashFp_["noop"]);dispatch({type:"SET_EDIT_CONNECTOR",payload:false})}case 6:case"end":return _context.stop()}}),_callee)}))),[dispatch,submit,fields,onSubmit,onError]);const onEditClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{dispatch({type:"SET_EDIT_CONNECTOR",payload:true})},[dispatch]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(edit_connector_MyFlexGroup,{alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("h4",null,cases_translations["m"])),isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{"data-test-subj":"connector-loading"}),!isLoading&&!editConnector&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"connector-edit",grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"connector-edit-button",isDisabled:disabled,"aria-label":EDIT_CONNECTOR_ARIA,iconType:"pencil",onClick:onEditClick}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(edit_connector_MyFlexGroup,{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":"edit-connectors",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(DisappearingFlexItem,{$isHidden:!editConnector},external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"connectorId",component:ConnectorSelector,componentProps:{connectors:connectors,dataTestSubj:"caseConnectors",defaultValue:selectedConnector,disabled:disabled,idAria:"caseConnectors",isEdit:editConnector,isLoading:isLoading},onChange:onChangeConnector}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"edit-connector-settings-fields-form-flex-item"},(currentConnector==null||(currentConnector===null||currentConnector===void 0?void 0:currentConnector.id)==="none")&&!(currentConnector===null&&selectedConnector!=="none")&&!editConnector&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,cases_translations["u"])),external_kbnSharedDeps_React_default.a.createElement(SettingFieldsForm,{connector:currentConnector,fields:fields,isEdit:editConnector,onChange:onFieldsChange})),editConnector&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"secondary","data-test-subj":"edit-connectors-submit",fill:true,iconType:"save",onClick:onSubmitConnector,size:"s"},cases_translations["G"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"edit-connectors-cancel",iconType:"cross",onClick:onCancelConnector,size:"s"},cases_translations["e"])))))))});EditConnector.displayName="EditConnector";function case_view_extends(){case_view_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return case_view_extends.apply(this,arguments)}function case_view_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function case_view_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){case_view_ownKeys(Object(source),true).forEach((function(key){case_view_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{case_view_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function case_view_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function case_view_slicedToArray(arr,i){return case_view_arrayWithHoles(arr)||case_view_iterableToArrayLimit(arr,i)||case_view_unsupportedIterableToArray(arr,i)||case_view_nonIterableRest()}function case_view_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function case_view_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return case_view_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return case_view_arrayLikeToArray(o,minLen)}function case_view_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function case_view_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function case_view_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const MyWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MyWrapper",componentId:"sc-1xjixbg-0"})(["padding:",";"],({theme:theme})=>"".concat(theme.eui.paddingSizes.l," ").concat(lib_helpers["d"]," ").concat(theme.eui.paddingSizes.l,"\n  ").concat(theme.eui.paddingSizes.l));const case_view_MyEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyEuiFlexGroup",componentId:"sc-1xjixbg-1"})(["height:100%;"]);const MyEuiHorizontalRule=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"]).withConfig({displayName:"MyEuiHorizontalRule",componentId:"sc-1xjixbg-2"})(["margin-left:48px;&.euiHorizontalRule--full{width:calc(100% - 48px);}"]);const CaseComponent=external_kbnSharedDeps_React_default.a.memo(({caseId:caseId,caseData:caseData,fetchCase:fetchCase,updateCase:updateCase,userCanCrud:userCanCrud})=>{const _useFormatUrl=Object(link_to["n"])(app_types["a"].case),formatUrl=_useFormatUrl.formatUrl,search=_useFormatUrl.search;const allCasesLink=Object(link_to["d"])(search);const caseDetailsLink=formatUrl(Object(link_to["b"])({id:caseId}),{absolute:true});const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=case_view_slicedToArray(_useState,2),initLoadingData=_useState2[0],setInitLoadingData=_useState2[1];const _useGetCaseUserAction=useGetCaseUserActions(caseId,caseData.connector.id),caseUserActions=_useGetCaseUserAction.caseUserActions,fetchCaseUserActions=_useGetCaseUserAction.fetchCaseUserActions,caseServices=_useGetCaseUserAction.caseServices,hasDataToPush=_useGetCaseUserAction.hasDataToPush,isLoadingUserActions=_useGetCaseUserAction.isLoading,participants=_useGetCaseUserAction.participants;const _useUpdateCase=useUpdateCase({caseId:caseId}),isLoading=_useUpdateCase.isLoading,updateKey=_useUpdateCase.updateKey,updateCaseProperty=_useUpdateCase.updateCaseProperty;const onUpdateField=Object(external_kbnSharedDeps_React_["useCallback"])(({key:key,value:value,onSuccess:onSuccess,onError:onError})=>{const handleUpdateNewCase=newCase=>updateCase(case_view_objectSpread(case_view_objectSpread({},newCase),{},{comments:caseData.comments}));switch(key){case"title":const titleUpdate=Object(containers_utils["l"])(value);if(titleUpdate.length>0){updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"title",updateValue:titleUpdate,updateCase:handleUpdateNewCase,version:caseData.version,onSuccess:onSuccess,onError:onError})}break;case"connector":const connector=Object(containers_utils["l"])(value);if(connector!=null){updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"connector",updateValue:connector,updateCase:handleUpdateNewCase,version:caseData.version,onSuccess:onSuccess,onError:onError})}break;case"description":const descriptionUpdate=Object(containers_utils["l"])(value);if(descriptionUpdate.length>0){updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"description",updateValue:descriptionUpdate,updateCase:handleUpdateNewCase,version:caseData.version,onSuccess:onSuccess,onError:onError})}break;case"tags":const tagsUpdate=Object(containers_utils["l"])(value);updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"tags",updateValue:tagsUpdate,updateCase:handleUpdateNewCase,version:caseData.version,onSuccess:onSuccess,onError:onError});break;case"status":const statusUpdate=Object(containers_utils["l"])(value);if(caseData.status!==value){updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"status",updateValue:statusUpdate,updateCase:handleUpdateNewCase,version:caseData.version,onSuccess:onSuccess,onError:onError})}default:return null}},[fetchCaseUserActions,updateCaseProperty,updateCase,caseData]);const handleUpdateCase=Object(external_kbnSharedDeps_React_["useCallback"])(newCase=>{updateCase(newCase);fetchCaseUserActions(newCase.id)},[updateCase,fetchCaseUserActions]);const _useConnectors=useConnectors(),isLoadingConnectors=_useConnectors.loading,connectors=_useConnectors.connectors;const _useMemo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _connector$name;const connector=connectors.find(c=>c.id===caseData.connector.id);return[(_connector$name=connector===null||connector===void 0?void 0:connector.name)!==null&&_connector$name!==void 0?_connector$name:"",!!connector]},[connectors,caseData.connector]),_useMemo2=case_view_slicedToArray(_useMemo,2),connectorName=_useMemo2[0],isValidConnector=_useMemo2[1];const currentExternalIncident=Object(external_kbnSharedDeps_React_["useMemo"])(()=>caseServices!=null&&caseServices[caseData.connector.id]!=null?caseServices[caseData.connector.id]:null,[caseServices,caseData.connector]);const _usePushToService=usePushToService({connector:case_view_objectSpread(case_view_objectSpread({},caseData.connector),{},{name:Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(caseData.connector.name)?connectorName:caseData.connector.name}),caseServices:caseServices,caseId:caseData.id,caseStatus:caseData.status,connectors:connectors,updateCase:handleUpdateCase,userCanCrud:userCanCrud,isValidConnector:isValidConnector}),pushButton=_usePushToService.pushButton,pushCallouts=_usePushToService.pushCallouts;const onSubmitConnector=Object(external_kbnSharedDeps_React_["useCallback"])((connectorId,connectorFields,onError,onSuccess)=>{const connector=getConnectorById(connectorId,connectors);const connectorToUpdate=connector?normalizeActionConnector(connector):getNoneConnector();onUpdateField({key:"connector",value:case_view_objectSpread(case_view_objectSpread({},connectorToUpdate),{},{fields:connectorFields}),onSuccess:onSuccess,onError:onError})},[onUpdateField,connectors]);const onSubmitTags=Object(external_kbnSharedDeps_React_["useCallback"])(newTags=>onUpdateField({key:"tags",value:newTags}),[onUpdateField]);const onSubmitTitle=Object(external_kbnSharedDeps_React_["useCallback"])(newTitle=>onUpdateField({key:"title",value:newTitle}),[onUpdateField]);const toggleStatusCase=Object(external_kbnSharedDeps_React_["useCallback"])(nextStatus=>onUpdateField({key:"status",value:nextStatus?"closed":"open"}),[onUpdateField]);const handleRefresh=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{fetchCaseUserActions(caseData.id);fetchCase()},[caseData.id,fetchCase,fetchCaseUserActions]);const spyState=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({caseTitle:caseData.title}),[caseData.title]);const caseStatusData=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _caseData$closedAt;return caseData.status==="open"?{"data-test-subj":"case-view-createdAt",value:caseData.createdAt,title:CASE_OPENED,buttonLabel:cases_translations["i"],status:caseData.status,icon:"folderCheck",badgeColor:"secondary",isSelected:false}:{"data-test-subj":"case-view-closedAt",value:(_caseData$closedAt=caseData.closedAt)!==null&&_caseData$closedAt!==void 0?_caseData$closedAt:"",title:CASE_CLOSED,buttonLabel:cases_translations["D"],status:caseData.status,icon:"folderExclamation",badgeColor:"danger",isSelected:true}},[caseData.closedAt,caseData.createdAt,caseData.status]);const emailContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({subject:EMAIL_SUBJECT(caseData.title),body:EMAIL_BODY(caseDetailsLink)}),[caseDetailsLink,caseData.title]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(initLoadingData&&!isLoadingUserActions){setInitLoadingData(false)}},[initLoadingData,isLoadingUserActions]);const backOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({href:allCasesLink,text:cases_translations["d"],dataTestSubj:"backToCases",pageId:app_types["a"].case}),[allCasesLink]);const isSelected=Object(external_kbnSharedDeps_React_["useMemo"])(()=>caseStatusData.isSelected,[caseStatusData]);const handleToggleStatusCase=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{toggleStatusCase(!isSelected)},[toggleStatusCase,isSelected]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrappers_HeaderWrapper,null,external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{backOptions:backOptions,"data-test-subj":"case-view-title",hideSourcerer:true,titleNode:external_kbnSharedDeps_React_default.a.createElement(EditableTitle,{disabled:!userCanCrud,isLoading:isLoading&&updateKey==="title",title:caseData.title,onSubmit:onSubmitTitle}),title:caseData.title},external_kbnSharedDeps_React_default.a.createElement(CaseStatus,case_view_extends({currentExternalIncident:currentExternalIncident,caseData:caseData,disabled:!userCanCrud,isLoading:isLoading&&updateKey==="status",onRefresh:handleRefresh,toggleStatusCase:handleToggleStatusCase},caseStatusData)))),external_kbnSharedDeps_React_default.a.createElement(WhitePageWrapper,null,external_kbnSharedDeps_React_default.a.createElement(MyWrapper,null,!initLoadingData&&pushCallouts!=null&&pushCallouts,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:6},initLoadingData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{lines:8}),!initLoadingData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(UserActionTree,{caseUserActions:caseUserActions,connectors:connectors,data:caseData,fetchUserActions:fetchCaseUserActions.bind(null,caseData.id),caseServices:caseServices,isLoadingDescription:isLoading&&updateKey==="description",isLoadingUserActions:isLoadingUserActions,onUpdateField:onUpdateField,updateCase:updateCase,userCanCrud:userCanCrud}),external_kbnSharedDeps_React_default.a.createElement(MyEuiHorizontalRule,{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":caseStatusData["data-test-subj"],iconType:caseStatusData.icon,isDisabled:!userCanCrud,isLoading:isLoading&&updateKey==="status",fill:caseStatusData.isSelected,onClick:handleToggleStatusCase},caseStatusData.buttonLabel)),hasDataToPush&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"has-data-to-push-button",grow:false},pushButton)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2},external_kbnSharedDeps_React_default.a.createElement(UserList,{"data-test-subj":"case-view-user-list-reporter",email:emailContent,headline:cases_translations["E"],users:[caseData.createdBy]}),external_kbnSharedDeps_React_default.a.createElement(UserList,{"data-test-subj":"case-view-user-list-participants",email:emailContent,headline:cases_translations["B"],loading:isLoadingUserActions,users:participants}),external_kbnSharedDeps_React_default.a.createElement(TagList,{"data-test-subj":"case-view-tag-list",disabled:!userCanCrud,tags:caseData.tags,onSubmit:onSubmitTags,isLoading:isLoading&&updateKey==="tags"}),external_kbnSharedDeps_React_default.a.createElement(EditConnector,{caseFields:caseData.connector.fields,connectors:connectors,disabled:!userCanCrud,isLoading:isLoadingConnectors||isLoading&&updateKey==="connector",onSubmit:onSubmitConnector,selectedConnector:caseData.connector.id,userActions:caseUserActions}))))),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{state:spyState,pageName:app_types["a"].case}))});const CaseView=external_kbnSharedDeps_React_default.a.memo(({caseId:caseId,userCanCrud:userCanCrud})=>{const _useGetCase=useGetCase(caseId),data=_useGetCase.data,isLoading=_useGetCase.isLoading,isError=_useGetCase.isError,fetchCase=_useGetCase.fetchCase,updateCase=_useGetCase.updateCase;if(isError){return null}if(isLoading){return external_kbnSharedDeps_React_default.a.createElement(case_view_MyEuiFlexGroup,{gutterSize:"none",justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{"data-test-subj":"case-view-loading",size:"xl"})))}return external_kbnSharedDeps_React_default.a.createElement(CaseComponent,{caseId:caseId,fetchCase:fetchCase,caseData:data,updateCase:updateCase,userCanCrud:userCanCrud})});CaseComponent.displayName="CaseComponent";CaseView.displayName="CaseView";function case_details_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function case_details_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){case_details_ownKeys(Object(source),true).forEach((function(key){case_details_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{case_details_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function case_details_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const CaseDetailsPage=external_kbnSharedDeps_React_default.a.memo(()=>{var _userPermissions$crud;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const userPermissions=Object(lib_kibana["f"])();const _useParams=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])(),caseId=_useParams.detailName;const search=Object(use_get_url_search["a"])(home_navigations["a"].case);if(userPermissions!=null&&!userPermissions.read){history.replace(Object(link_to["d"])(search));return null}return caseId!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:true},userPermissions!=null&&!(userPermissions===null||userPermissions===void 0?void 0:userPermissions.crud)&&(userPermissions===null||userPermissions===void 0?void 0:userPermissions.read)&&external_kbnSharedDeps_React_default.a.createElement(callout["a"],{title:callout["b"].title,messages:[case_details_objectSpread({},callout["b"])]}),external_kbnSharedDeps_React_default.a.createElement(CaseView,{caseId:caseId,userCanCrud:(_userPermissions$crud=userPermissions===null||userPermissions===void 0?void 0:userPermissions.crud)!==null&&_userPermissions$crud!==void 0?_userPermissions$crud:false})),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].case})):null});CaseDetailsPage.displayName="CaseDetailsPage";var all_cases=__webpack_require__(678);var pages_translations=__webpack_require__(339);const CaseSavedObjectNoPermissions=external_kbnSharedDeps_React_default.a.memo(()=>{const docLinks=Object(lib_kibana["h"])().services.docLinks;const actions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({savedObject:{icon:"documents",label:pages_translations["e"],url:"".concat(docLinks.ELASTIC_WEBSITE_URL,"guide/en/security/").concat(docLinks.DOC_LINK_VERSION,"s"),target:"_blank"}}),[docLinks]);return external_kbnSharedDeps_React_default.a.createElement(empty_page["a"],{actions:actions,message:pages_translations["g"],"data-test-subj":"no_saved_objects_permissions",title:pages_translations["h"]})});CaseSavedObjectNoPermissions.displayName="CaseSavedObjectNoPermissions";function case_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function case_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){case_ownKeys(Object(source),true).forEach((function(key){case_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{case_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function case_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const CasesPage=external_kbnSharedDeps_React_default.a.memo(()=>{var _userPermissions$crud;const userPermissions=Object(lib_kibana["f"])();return userPermissions==null||(userPermissions===null||userPermissions===void 0?void 0:userPermissions.read)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,userPermissions!=null&&!(userPermissions===null||userPermissions===void 0?void 0:userPermissions.crud)&&(userPermissions===null||userPermissions===void 0?void 0:userPermissions.read)&&external_kbnSharedDeps_React_default.a.createElement(callout["a"],{title:callout["b"].title,messages:[case_objectSpread({},callout["b"])]}),external_kbnSharedDeps_React_default.a.createElement(all_cases["a"],{userCanCrud:(_userPermissions$crud=userPermissions===null||userPermissions===void 0?void 0:userPermissions.crud)!==null&&_userPermissions$crud!==void 0?_userPermissions$crud:false})),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].case})):external_kbnSharedDeps_React_default.a.createElement(CaseSavedObjectNoPermissions,null)});CasesPage.displayName="CasesPage";var case_header_page=__webpack_require__(421);const CreateCasePage=external_kbnSharedDeps_React_default.a.memo(()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const userPermissions=Object(lib_kibana["f"])();const search=Object(use_get_url_search["a"])(home_navigations["a"].case);const backOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({href:Object(link_to["d"])(search),text:pages_translations["a"],pageId:app_types["a"].case}),[search]);if(userPermissions!=null&&!userPermissions.crud){history.replace(Object(link_to["d"])(search));return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(case_header_page["a"],{backOptions:backOptions,title:pages_translations["d"]}),external_kbnSharedDeps_React_default.a.createElement(Create,null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].case}))});CreateCasePage.displayName="CreateCasePage";const EuiFormRowExtended=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).withConfig({displayName:"EuiFormRowExtended",componentId:"iiz1mi-0"})([".euiFormRow__labelWrapper{.euiFormRow__label{width:100%;}}"]);const ConnectorsComponent=({connectors:connectors,isLoading:isLoading,disabled:disabled,updateConnectorDisabled:updateConnectorDisabled,onChangeConnector:onChangeConnector,selectedConnector:selectedConnector,handleShowEditFlyout:handleShowEditFlyout})=>{const connectorsName=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _connectors$find$name,_connectors$find;return(_connectors$find$name=(_connectors$find=connectors.find(c=>c.id===selectedConnector))===null||_connectors$find===void 0?void 0:_connectors$find.name)!==null&&_connectors$find$name!==void 0?_connectors$find$name:"none"},[connectors,selectedConnector]);const dropDownLabel=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},INCIDENT_MANAGEMENT_SYSTEM_LABEL),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},connectorsName!=="none"&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{disabled:updateConnectorDisabled,onClick:handleShowEditFlyout,"data-test-subj":"case-configure-update-selected-connector-button"},UPDATE_SELECTED_CONNECTOR(connectorsName)))),[connectorsName,updateConnectorDisabled]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{fullWidth:true,title:external_kbnSharedDeps_React_default.a.createElement("h3",null,INCIDENT_MANAGEMENT_SYSTEM_TITLE),description:INCIDENT_MANAGEMENT_SYSTEM_DESC,"data-test-subj":"case-connectors-form-group"},external_kbnSharedDeps_React_default.a.createElement(EuiFormRowExtended,{fullWidth:true,label:dropDownLabel,"data-test-subj":"case-connectors-form-row"},external_kbnSharedDeps_React_default.a.createElement(ConnectorsDropdown,{connectors:connectors,disabled:disabled,selectedConnector:selectedConnector,isLoading:isLoading,onChange:onChangeConnector,"data-test-subj":"case-connectors-dropdown",appendAddConnectorButton:true}))))};const Connectors=external_kbnSharedDeps_React_default.a.memo(ConnectorsComponent);const radios=[{id:"close-by-user",label:CASE_CLOSURE_OPTIONS_MANUAL},{id:"close-by-pushing",label:CASE_CLOSURE_OPTIONS_NEW_INCIDENT}];const ClosureOptionsRadioComponent=({closureTypeSelected:closureTypeSelected,disabled:disabled,onChangeClosureType:onChangeClosureType})=>{const onChangeLocal=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{onChangeClosureType(id)},[onChangeClosureType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRadioGroup"],{disabled:disabled,options:radios,idSelected:closureTypeSelected,onChange:onChangeLocal,name:"closure_options","data-test-subj":"closure-options-radio-group"})};const ClosureOptionsRadio=external_kbnSharedDeps_React_default.a.memo(ClosureOptionsRadioComponent);const ClosureOptionsComponent=({closureTypeSelected:closureTypeSelected,disabled:disabled,onChangeClosureType:onChangeClosureType})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{fullWidth:true,title:external_kbnSharedDeps_React_default.a.createElement("h3",null,CASE_CLOSURE_OPTIONS_TITLE),description:CASE_CLOSURE_OPTIONS_DESC,"data-test-subj":"case-closure-options-form-group"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,label:CASE_CLOSURE_OPTIONS_LABEL,"data-test-subj":"case-closure-options-form-row"},external_kbnSharedDeps_React_default.a.createElement(ClosureOptionsRadio,{closureTypeSelected:closureTypeSelected,disabled:disabled,onChangeClosureType:onChangeClosureType,"data-test-subj":"case-closure-options-radio"})));const ClosureOptions=external_kbnSharedDeps_React_default.a.memo(ClosureOptionsComponent);function configure_cases_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function configure_cases_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){configure_cases_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){configure_cases_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function configure_cases_slicedToArray(arr,i){return configure_cases_arrayWithHoles(arr)||configure_cases_iterableToArrayLimit(arr,i)||configure_cases_unsupportedIterableToArray(arr,i)||configure_cases_nonIterableRest()}function configure_cases_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function configure_cases_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return configure_cases_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return configure_cases_arrayLikeToArray(o,minLen)}function configure_cases_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function configure_cases_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function configure_cases_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const FormWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"FormWrapper",componentId:"ox2hsq-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["& > *{margin-top 40px;}& >:first-child{margin-top:0;}padding-top:",";padding-bottom:",";.euiFlyout{z-index:",";}"],theme.eui.paddingSizes.xl,theme.eui.paddingSizes.xl,theme.eui.euiZNavigation+1));const configure_cases_actionTypes=Object.values(connectors_config["a"]);const ConfigureCasesComponent=({userCanCrud:userCanCrud})=>{const triggersActionsUi=Object(lib_kibana["h"])().services.triggersActionsUi;const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=configure_cases_slicedToArray(_useState,2),connectorIsValid=_useState2[0],setConnectorIsValid=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=configure_cases_slicedToArray(_useState3,2),addFlyoutVisible=_useState4[0],setAddFlyoutVisibility=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=configure_cases_slicedToArray(_useState5,2),editFlyoutVisible=_useState6[0],setEditFlyoutVisibility=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(null),_useState8=configure_cases_slicedToArray(_useState7,2),editedConnectorItem=_useState8[0],setEditedConnectorItem=_useState8[1];const _useCaseConfigure=useCaseConfigure(),connector=_useCaseConfigure.connector,closureType=_useCaseConfigure.closureType,loadingCaseConfigure=_useCaseConfigure.loading,persistLoading=_useCaseConfigure.persistLoading,persistCaseConfigure=_useCaseConfigure.persistCaseConfigure,setConnector=_useCaseConfigure.setConnector,setClosureType=_useCaseConfigure.setClosureType;const _useConnectors=useConnectors(),isLoadingConnectors=_useConnectors.loading,connectors=_useConnectors.connectors,refetchConnectors=_useConnectors.refetchConnectors;const reloadConnectors=Object(external_kbnSharedDeps_React_["useCallback"])(configure_cases_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",refetchConnectors());case 1:case"end":return _context.stop()}}),_callee)}))),[]);const isLoadingAny=isLoadingConnectors||persistLoading||loadingCaseConfigure;const updateConnectorDisabled=isLoadingAny||!connectorIsValid||connector.id==="none";const onClickUpdateConnector=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setEditFlyoutVisibility(true)},[]);const onCloseAddFlyout=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setAddFlyoutVisibility(false),[setAddFlyoutVisibility]);const onCloseEditFlyout=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setEditFlyoutVisibility(false),[setEditFlyoutVisibility]);const onChangeConnector=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{if(id==="add-connector"){setAddFlyoutVisibility(true);return}const actionConnector=getConnectorById(id,connectors);const caseConnector=actionConnector!=null?normalizeActionConnector(actionConnector):getNoneConnector();setConnector(caseConnector);persistCaseConfigure({connector:caseConnector,closureType:closureType})},[connectors,closureType,persistCaseConfigure,setConnector]);const onChangeClosureType=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{setClosureType(type);persistCaseConfigure({connector:connector,closureType:type})},[connector,persistCaseConfigure,setClosureType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isLoadingConnectors&&connector.id!=="none"&&!connectors.some(c=>c.id===connector.id)){setConnectorIsValid(false)}else if(!isLoadingConnectors&&(connector.id==="none"||connectors.some(c=>c.id===connector.id))){setConnectorIsValid(true)}},[connectors,connector,isLoadingConnectors]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isLoadingConnectors&&connector.id!=="none"){setEditedConnectorItem(normalizeCaseConnector(connectors,connector))}},[connectors,connector,isLoadingConnectors]);const ConnectorAddFlyout=Object(external_kbnSharedDeps_React_["useMemo"])(()=>triggersActionsUi.getAddConnectorFlyout({consumer:"case",onClose:onCloseAddFlyout,actionTypes:configure_cases_actionTypes,reloadConnectors:reloadConnectors}),[]);const ConnectorEditFlyout=Object(external_kbnSharedDeps_React_["useMemo"])(()=>editedConnectorItem&&editFlyoutVisible?triggersActionsUi.getEditConnectorFlyout({initialConnector:editedConnectorItem,consumer:"case",onClose:onCloseEditFlyout,reloadConnectors:reloadConnectors}):null,[connector.id,editFlyoutVisible]);return external_kbnSharedDeps_React_default.a.createElement(FormWrapper,null,!connectorIsValid&&external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,{style:{marginTop:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:WARNING_NO_CONNECTOR_TITLE,color:"warning",iconType:"help","data-test-subj":"configure-cases-warning-callout"},WARNING_NO_CONNECTOR_MESSAGE)),external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(ClosureOptions,{closureTypeSelected:closureType,disabled:persistLoading||isLoadingConnectors||!userCanCrud,onChangeClosureType:onChangeClosureType})),external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(Connectors,{connectors:connectors!==null&&connectors!==void 0?connectors:[],disabled:persistLoading||isLoadingConnectors||!userCanCrud,isLoading:isLoadingConnectors,onChangeConnector:onChangeConnector,updateConnectorDisabled:updateConnectorDisabled||!userCanCrud,handleShowEditFlyout:onClickUpdateConnector,selectedConnector:connector.id})),addFlyoutVisible&&ConnectorAddFlyout,ConnectorEditFlyout)};const ConfigureCases=external_kbnSharedDeps_React_default.a.memo(ConfigureCasesComponent);const ConfigureCasesPageComponent=()=>{var _userPermissions$crud;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const userPermissions=Object(lib_kibana["f"])();const search=Object(use_get_url_search["a"])(home_navigations["a"].case);const backOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({href:Object(link_to["d"])(search),text:pages_translations["a"],pageId:app_types["a"].case}),[search]);if(userPermissions!=null&&!userPermissions.read){history.push(Object(link_to["d"])(search));return null}const HeaderWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HeaderWrapper",componentId:"ty9qqa-0"})(["padding-top:",";"],({theme:theme})=>theme.eui.paddingSizes.l);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:true},external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(HeaderWrapper,null,external_kbnSharedDeps_React_default.a.createElement(case_header_page["a"],{title:pages_translations["b"],backOptions:backOptions}))),external_kbnSharedDeps_React_default.a.createElement(WhitePageWrapper,null,external_kbnSharedDeps_React_default.a.createElement(ConfigureCases,{userCanCrud:(_userPermissions$crud=userPermissions===null||userPermissions===void 0?void 0:userPermissions.crud)!==null&&_userPermissions$crud!==void 0?_userPermissions$crud:false}))),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].case}))};const ConfigureCasesPage=external_kbnSharedDeps_React_default.a.memo(ConfigureCasesPageComponent);const casesPagePath="";const caseDetailsPagePath="".concat(casesPagePath,"/:detailName");const caseDetailsPagePathWithCommentId="".concat(casesPagePath,"/:detailName/:commentId");const createCasePagePath="".concat(casesPagePath,"/create");const configureCasesPagePath="".concat(casesPagePath,"/configure");const CaseContainerComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:createCasePagePath},external_kbnSharedDeps_React_default.a.createElement(CreateCasePage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:configureCasesPagePath},external_kbnSharedDeps_React_default.a.createElement(ConfigureCasesPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:caseDetailsPagePathWithCommentId},external_kbnSharedDeps_React_default.a.createElement(CaseDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:caseDetailsPagePath},external_kbnSharedDeps_React_default.a.createElement(CaseDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{strict:true,exact:true,path:casesPagePath},external_kbnSharedDeps_React_default.a.createElement(CasesPage,null)));const Case=external_kbnSharedDeps_React_default.a.memo(CaseContainerComponent);const CasesRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/"},external_kbnSharedDeps_React_default.a.createElement(Case,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)}));class cases_Cases{setup(){}start(){return{SubPluginRoutes:CasesRoutes}}}var search_strategy=__webpack_require__(93);var last_event_time=__webpack_require__(349);var use_anomalies_table_data=__webpack_require__(350);function anomaly_table_provider_slicedToArray(arr,i){return anomaly_table_provider_arrayWithHoles(arr)||anomaly_table_provider_iterableToArrayLimit(arr,i)||anomaly_table_provider_unsupportedIterableToArray(arr,i)||anomaly_table_provider_nonIterableRest()}function anomaly_table_provider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function anomaly_table_provider_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return anomaly_table_provider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return anomaly_table_provider_arrayLikeToArray(o,minLen)}function anomaly_table_provider_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function anomaly_table_provider_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function anomaly_table_provider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AnomalyTableProvider=external_kbnSharedDeps_React_default.a.memo(({influencers:influencers,startDate:startDate,endDate:endDate,children:children,criteriaFields:criteriaFields,skip:skip})=>{const _useAnomaliesTableDat=Object(use_anomalies_table_data["a"])({criteriaFields:criteriaFields,influencers:influencers,startDate:startDate,endDate:endDate,skip:skip}),_useAnomaliesTableDat2=anomaly_table_provider_slicedToArray(_useAnomaliesTableDat,2),isLoadingAnomaliesData=_useAnomaliesTableDat2[0],anomaliesData=_useAnomaliesTableDat2[1];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children({isLoadingAnomaliesData:isLoadingAnomaliesData,anomaliesData:anomaliesData}))});AnomalyTableProvider.displayName="AnomalyTableProvider";const hostToCriteria=hostItem=>{if(hostItem.host!=null&&hostItem.host.name!=null){const criteria=[{fieldName:"host.name",fieldValue:hostItem.host.name[0]}];return criteria}else{return[]}};var has_ml_user_permissions=__webpack_require__(194);var score_interval_to_datetime=__webpack_require__(268);var navigation=__webpack_require__(273);var containers_helpers=__webpack_require__(97);const ERROR_HOSTS_KPI_AUTHENTICATIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiAuthentications.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi authentications search"});const FAIL_HOSTS_KPI_AUTHENTICATIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiAuthentications.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi authentications"});var public_helpers=__webpack_require__(24);function authentications_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function authentications_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){authentications_ownKeys(Object(source),true).forEach((function(key){authentications_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{authentications_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function authentications_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function authentications_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function authentications_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){authentications_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){authentications_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function authentications_slicedToArray(arr,i){return authentications_arrayWithHoles(arr)||authentications_iterableToArrayLimit(arr,i)||authentications_unsupportedIterableToArray(arr,i)||authentications_nonIterableRest()}function authentications_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function authentications_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return authentications_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return authentications_arrayLikeToArray(o,minLen)}function authentications_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function authentications_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function authentications_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const authentications_ID="hostsKpiAuthenticationsQuery";const useHostsKpiAuthentications=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=authentications_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,factoryQueryType:search_strategy["HostsKpiQueries"].kpiAuthentications,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}}:null),_useState4=authentications_slicedToArray(_useState3,2),hostsKpiAuthenticationsRequest=_useState4[0],setHostsKpiAuthenticationsRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({authenticationsSuccess:0,authenticationsSuccessHistogram:[],authenticationsFailure:0,authenticationsFailureHistogram:[],id:authentications_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current}),_useState6=authentications_slicedToArray(_useState5,2),hostsKpiAuthenticationsResponse=_useState6[0],setHostsKpiAuthenticationsResponse=_useState6[1];const hostsKpiAuthenticationsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=authentications_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(!response.isPartial&&!response.isRunning){if(!didCancel){setLoading(false);setHostsKpiAuthenticationsResponse(prevResponse=>authentications_objectSpread(authentications_objectSpread({},prevResponse),{},{authenticationsSuccess:response.authenticationsSuccess,authenticationsSuccessHistogram:response.authenticationsSuccessHistogram,authenticationsFailure:response.authenticationsFailure,authenticationsFailureHistogram:response.authenticationsFailureHistogram,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}))}searchSubscription$.unsubscribe()}else if(response.isPartial&&!response.isRunning){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_HOSTS_KPI_AUTHENTICATIONS);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_HOSTS_KPI_AUTHENTICATIONS,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setHostsKpiAuthenticationsRequest(prevRequest=>{const myRequest=authentications_objectSpread(authentications_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,factoryQueryType:search_strategy["HostsKpiQueries"].kpiAuthentications,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{hostsKpiAuthenticationsSearch(hostsKpiAuthenticationsRequest)},[hostsKpiAuthenticationsRequest,hostsKpiAuthenticationsSearch]);return[loading,hostsKpiAuthenticationsResponse]};var manage_query=__webpack_require__(106);var chart_place_holder=__webpack_require__(581);var common=__webpack_require__(315);function areachart_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function areachart_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){areachart_ownKeys(Object(source),true).forEach((function(key){areachart_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{areachart_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function areachart_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function areachart_objectWithoutProperties(source,excluded){if(source==null)return{};var target=areachart_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function areachart_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const getSeriesLineStyle=()=>({area:{opacity:.04,visible:true},line:{strokeWidth:1,visible:true},point:{visible:false,radius:.2,strokeWidth:1,opacity:1}});const checkIfAllTheDataInTheSeriesAreValid=series=>!!Object(external_kbnSharedDeps_LodashFp_["get"])("value.length",series)&&Object(external_kbnSharedDeps_LodashFp_["get"])("value",series).every(({x:x,y:y})=>!Object(external_kbnSharedDeps_LodashFp_["isNull"])(x)&&Object(external_kbnSharedDeps_LodashFp_["isNumber"])(y)&&y>0);const checkIfAnyValidSeriesExist=data=>Array.isArray(data)&&data.some(checkIfAllTheDataInTheSeriesAreValid);const AreaChartBaseComponent=_ref=>{let data=_ref.data,chartConfigs=areachart_objectWithoutProperties(_ref,["data"]);const theme=Object(common["f"])();const timeZone=Object(lib_kibana["i"])();const xTickFormatter=Object(external_kbnSharedDeps_LodashFp_["get"])("configs.axis.xTickFormatter",chartConfigs);const yTickFormatter=Object(external_kbnSharedDeps_LodashFp_["get"])("configs.axis.yTickFormatter",chartConfigs);const xAxisId="group-".concat(data[0].key,"-x");const yAxisId="group-".concat(data[0].key,"-y");const settings=areachart_objectSpread(areachart_objectSpread({},common["b"]),{},{theme:theme},Object(external_kbnSharedDeps_LodashFp_["get"])("configs.settings",chartConfigs));return chartConfigs.width&&chartConfigs.height?external_kbnSharedDeps_React_default.a.createElement("div",{style:{height:chartConfigs.height,width:chartConfigs.width,position:"relative"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],settings),data.map(series=>{const seriesKey=series.key;return checkIfAllTheDataInTheSeriesAreValid(series)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["AreaSeries"],{id:seriesKey,key:seriesKey,name:series.key.replace("Histogram",""),data:series.value||[],xScaleType:Object(external_kbnSharedDeps_LodashFp_["getOr"])(external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,"configs.series.xScaleType",chartConfigs),yScaleType:Object(external_kbnSharedDeps_LodashFp_["getOr"])(external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,"configs.series.yScaleType",chartConfigs),timeZone:timeZone,xAccessor:"x",yAccessors:["y"],areaSeriesStyle:getSeriesLineStyle(),color:series.color?series.color:undefined}):null}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:xAxisId,position:external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,showOverlappingTicks:false,tickFormat:xTickFormatter,style:{tickLine:{visible:false}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:yAxisId,position:external_kbnSharedDeps_ElasticCharts_["Position"].Left,style:{tickLine:{visible:false}},tickFormat:yTickFormatter}))):null};AreaChartBaseComponent.displayName="AreaChartBaseComponent";const AreaChartBase=external_kbnSharedDeps_React_default.a.memo(AreaChartBaseComponent);AreaChartBase.displayName="AreaChartBase";const AreaChartComponent=({areaChart:areaChart,configs:configs})=>{const _useThrottledResizeOb=Object(components_utils["b"])(),measureRef=_useThrottledResizeOb.ref,width=_useThrottledResizeOb.width,height=_useThrottledResizeOb.height;const customHeight=Object(external_kbnSharedDeps_LodashFp_["get"])("customHeight",configs);const customWidth=Object(external_kbnSharedDeps_LodashFp_["get"])("customWidth",configs);const chartHeight=Object(common["d"])(customHeight,height);const chartWidth=Object(common["e"])(customWidth,width);return checkIfAnyValidSeriesExist(areaChart)?external_kbnSharedDeps_React_default.a.createElement(common["a"],{ref:measureRef,height:chartHeight},external_kbnSharedDeps_React_default.a.createElement(AreaChartBase,{data:areaChart,height:chartHeight,width:chartWidth,configs:configs})):external_kbnSharedDeps_React_default.a.createElement(chart_place_holder["a"],{height:chartHeight,width:chartWidth,data:areaChart})};const AreaChart=external_kbnSharedDeps_React_default.a.memo(AreaChartComponent);var components_inspect=__webpack_require__(155);function stat_items_slicedToArray(arr,i){return stat_items_arrayWithHoles(arr)||stat_items_iterableToArrayLimit(arr,i)||stat_items_unsupportedIterableToArray(arr,i)||stat_items_nonIterableRest()}function stat_items_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function stat_items_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return stat_items_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return stat_items_arrayLikeToArray(o,minLen)}function stat_items_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function stat_items_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function stat_items_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function stat_items_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function stat_items_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){stat_items_ownKeys(Object(source),true).forEach((function(key){stat_items_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{stat_items_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function stat_items_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const FlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItem",componentId:"sc-1rm4ik7-0"})(["min-width:0;"]);FlexItem.displayName="FlexItem";const StatValue=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiTitle"]).withConfig({displayName:"StatValue",componentId:"sc-1rm4ik7-1"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]);StatValue.displayName="StatValue";const numberFormatter=value=>value.toLocaleString();const statItemBarchartRotation=90;const statItemChartCustomHeight=74;const areachartConfigs=config=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear},axis:{xTickFormatter:Object(external_kbnSharedDeps_LodashFp_["get"])("xTickFormatter",config),yTickFormatter:numberFormatter},settings:{onBrushEnd:Object(external_kbnSharedDeps_LodashFp_["getOr"])(()=>{},"onBrushEnd",config)},customHeight:statItemChartCustomHeight});const barchartConfigs=config=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Ordinal,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,stackAccessors:["y0"]},axis:{xTickFormatter:numberFormatter},settings:{onElementClick:Object(external_kbnSharedDeps_LodashFp_["getOr"])(()=>{},"onElementClick",config),rotation:statItemBarchartRotation},customHeight:statItemChartCustomHeight});const addValueToFields=(fields,data)=>fields.map(field=>stat_items_objectSpread(stat_items_objectSpread({},field),{},{value:Object(external_kbnSharedDeps_LodashFp_["get"])(field.key,data)}));const addValueToAreaChart=(fields,data)=>fields.filter(field=>Object(external_kbnSharedDeps_LodashFp_["get"])("".concat(field.key,"Histogram"),data)!=null).map(field=>stat_items_objectSpread(stat_items_objectSpread({},field),{},{value:Object(external_kbnSharedDeps_LodashFp_["get"])("".concat(field.key,"Histogram"),data),key:"".concat(field.key,"Histogram")}));const addValueToBarChart=(fields,data)=>{if(fields.length===0)return[];return fields.reduce((acc,field,idx)=>{const key=field.key,color=field.color;const y=Object(external_kbnSharedDeps_LodashFp_["getOr"])(null,key,data);const x=Object(external_kbnSharedDeps_LodashFp_["get"])("".concat(idx,".name"),fields)||Object(external_kbnSharedDeps_LodashFp_["getOr"])("","".concat(idx,".description"),fields);const value=[{x:x,y:y,g:key,y0:0}];return[...acc,{key:key,color:color,value:value}]},[])};const useKpiMatrixStatus=(mappings,data,id,from,to,narrowDateRange)=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(mappings),_useState2=stat_items_slicedToArray(_useState,2),statItemsProps=_useState2[0],setStatItemsProps=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setStatItemsProps(mappings.map(stat=>stat_items_objectSpread(stat_items_objectSpread({},stat),{},{areaChart:stat.enableAreaChart?addValueToAreaChart(stat.fields,data):undefined,barChart:stat.enableBarChart?addValueToBarChart(stat.fields,data):undefined,fields:addValueToFields(stat.fields,data),id:id,key:"kpi-summary-".concat(stat.key),statKey:"".concat(stat.key),from:from,to:to,narrowDateRange:narrowDateRange})))},[data]);return statItemsProps};const StatItemsComponent=external_kbnSharedDeps_React_default.a.memo(({areaChart:areaChart,barChart:barChart,description:description,enableAreaChart:enableAreaChart,enableBarChart:enableBarChart,fields:fields,from:from,grow:grow,id:id,index:index,narrowDateRange:narrowDateRange,statKey:statKey="item",to:to})=>{const isBarChartDataAvailable=barChart&&barChart.length&&barChart.every(item=>item.value!=null&&item.value.length>0);const isAreaChartDataAvailable=areaChart&&areaChart.length&&areaChart.every(item=>item.value!=null&&item.value.length>0);return external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:grow,"data-test-subj":"stat-".concat(statKey)},external_kbnSharedDeps_React_default.a.createElement(components_inspect["b"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("h6",null,description))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(components_inspect["a"],{queryId:id,title:"KPI ".concat(description),inspectIndex:index}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,fields.map(field=>external_kbnSharedDeps_React_default.a.createElement(FlexItem,{key:"stat-items-field-".concat(field.key)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m",responsive:false},(isAreaChartDataAvailable||isBarChartDataAvailable)&&field.icon&&external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:field.icon,color:field.color,size:"l","data-test-subj":"stat-icon"})),external_kbnSharedDeps_React_default.a.createElement(FlexItem,null,external_kbnSharedDeps_React_default.a.createElement(StatValue,null,external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"stat-title"},field.value!=null?field.value.toLocaleString():Object(empty_value["d"])()," ",field.description))))))),(enableAreaChart||enableBarChart)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,enableBarChart&&external_kbnSharedDeps_React_default.a.createElement(FlexItem,null,external_kbnSharedDeps_React_default.a.createElement(barchart["a"],{barChart:barChart,configs:barchartConfigs()})),enableAreaChart&&from!=null&&to!=null&&external_kbnSharedDeps_React_default.a.createElement(FlexItem,null,external_kbnSharedDeps_React_default.a.createElement(AreaChart,{areaChart:areaChart,configs:areachartConfigs({xTickFormatter:Object(components_utils["a"])([from,to]),onBrushEnd:narrowDateRange})}))))))});StatItemsComponent.displayName="StatItemsComponent";const kpiWidgetHeight=247;const common_FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroup",componentId:"sc-17i7jd7-0"})(["min-height:","px;"],kpiWidgetHeight);common_FlexGroup.displayName="FlexGroup";const HostsKpiBaseComponent=external_kbnSharedDeps_React_default.a.memo(({fieldsMapping:fieldsMapping,data:data,id:id,loading:loading=false,from:from,to:to,narrowDateRange:narrowDateRange})=>{const statItemsProps=useKpiMatrixStatus(fieldsMapping,data,id,from,to,narrowDateRange);if(loading){return external_kbnSharedDeps_React_default.a.createElement(common_FlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"xl"})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},statItemsProps.map(mappedStatItemProps=>external_kbnSharedDeps_React_default.a.createElement(StatItemsComponent,mappedStatItemProps)))});HostsKpiBaseComponent.displayName="HostsKpiBaseComponent";const HostsKpiBaseComponentManage=Object(manage_query["a"])(HostsKpiBaseComponent);var kpi_hosts_types=__webpack_require__(318);const USER_AUTHENTICATIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.userAuthentications.title",{defaultMessage:"User authentications"});const SUCCESS_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.userAuthentications.successUnitLabel",{defaultMessage:"success"});const FAIL_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.userAuthentications.failUnitLabel",{defaultMessage:"fail"});const SUCCESS_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.userAuthentications.successChartLabel",{defaultMessage:"Succ."});const FAIL_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.userAuthentications.failChartLabel",{defaultMessage:"Fail"});function authentications_objectWithoutProperties(source,excluded){if(source==null)return{};var target=authentications_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function authentications_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function kpi_hosts_authentications_slicedToArray(arr,i){return kpi_hosts_authentications_arrayWithHoles(arr)||kpi_hosts_authentications_iterableToArrayLimit(arr,i)||kpi_hosts_authentications_unsupportedIterableToArray(arr,i)||kpi_hosts_authentications_nonIterableRest()}function kpi_hosts_authentications_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kpi_hosts_authentications_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return kpi_hosts_authentications_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kpi_hosts_authentications_arrayLikeToArray(o,minLen)}function kpi_hosts_authentications_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function kpi_hosts_authentications_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function kpi_hosts_authentications_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const authentications_fieldsMapping=[{key:"authentication",fields:[{key:"authenticationsSuccess",name:SUCCESS_CHART_LABEL,description:SUCCESS_UNIT_LABEL,value:null,color:kpi_hosts_types["a"].authenticationsSuccess,icon:"check"},{key:"authenticationsFailure",name:FAIL_CHART_LABEL,description:FAIL_UNIT_LABEL,value:null,color:kpi_hosts_types["a"].authenticationsFailure,icon:"cross"}],enableAreaChart:true,enableBarChart:true,description:USER_AUTHENTICATIONS}];const HostsKpiAuthenticationsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const _useHostsKpiAuthentic=useHostsKpiAuthentications({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip}),_useHostsKpiAuthentic2=kpi_hosts_authentications_slicedToArray(_useHostsKpiAuthentic,2),loading=_useHostsKpiAuthentic2[0],_useHostsKpiAuthentic3=_useHostsKpiAuthentic2[1],refetch=_useHostsKpiAuthentic3.refetch,id=_useHostsKpiAuthentic3.id,inspect=_useHostsKpiAuthentic3.inspect,data=authentications_objectWithoutProperties(_useHostsKpiAuthentic3,["refetch","id","inspect"]);return external_kbnSharedDeps_React_default.a.createElement(HostsKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:authentications_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const HostsKpiAuthentications=external_kbnSharedDeps_React_default.a.memo(HostsKpiAuthenticationsComponent);const ERROR_HOSTS_KPI_HOSTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiHosts.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi hosts search"});const FAIL_HOSTS_KPI_HOSTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiHosts.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi hosts"});function hosts_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function hosts_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){hosts_ownKeys(Object(source),true).forEach((function(key){hosts_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{hosts_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function hosts_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function hosts_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function hosts_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){hosts_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){hosts_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function hosts_slicedToArray(arr,i){return hosts_arrayWithHoles(arr)||hosts_iterableToArrayLimit(arr,i)||hosts_unsupportedIterableToArray(arr,i)||hosts_nonIterableRest()}function hosts_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hosts_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return hosts_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hosts_arrayLikeToArray(o,minLen)}function hosts_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function hosts_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function hosts_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const hosts_ID="hostsKpiHostsQuery";const useHostsKpiHosts=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=hosts_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,factoryQueryType:search_strategy["HostsKpiQueries"].kpiHosts,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}}:null),_useState4=hosts_slicedToArray(_useState3,2),hostsKpiHostsRequest=_useState4[0],setHostsKpiHostsRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({hosts:0,hostsHistogram:[],id:hosts_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current}),_useState6=hosts_slicedToArray(_useState5,2),hostsKpiHostsResponse=_useState6[0],setHostsKpiHostsResponse=_useState6[1];const hostsKpiHostsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=hosts_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(!response.isPartial&&!response.isRunning){if(!didCancel){setLoading(false);setHostsKpiHostsResponse(prevResponse=>hosts_objectSpread(hosts_objectSpread({},prevResponse),{},{hosts:response.hosts,hostsHistogram:response.hostsHistogram,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}))}searchSubscription$.unsubscribe()}else if(response.isPartial&&!response.isRunning){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_HOSTS_KPI_HOSTS);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_HOSTS_KPI_HOSTS,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setHostsKpiHostsRequest(prevRequest=>{const myRequest=hosts_objectSpread(hosts_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,factoryQueryType:search_strategy["HostsKpiQueries"].kpiHosts,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{hostsKpiHostsSearch(hostsKpiHostsRequest)},[hostsKpiHostsRequest,hostsKpiHostsSearch]);return[loading,hostsKpiHostsResponse]};const HOSTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.hosts.title",{defaultMessage:"Hosts"});function hosts_objectWithoutProperties(source,excluded){if(source==null)return{};var target=hosts_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function hosts_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function kpi_hosts_hosts_slicedToArray(arr,i){return kpi_hosts_hosts_arrayWithHoles(arr)||kpi_hosts_hosts_iterableToArrayLimit(arr,i)||kpi_hosts_hosts_unsupportedIterableToArray(arr,i)||kpi_hosts_hosts_nonIterableRest()}function kpi_hosts_hosts_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kpi_hosts_hosts_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return kpi_hosts_hosts_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kpi_hosts_hosts_arrayLikeToArray(o,minLen)}function kpi_hosts_hosts_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function kpi_hosts_hosts_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function kpi_hosts_hosts_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const hosts_fieldsMapping=[{key:"hosts",fields:[{key:"hosts",value:null,color:kpi_hosts_types["a"].hosts,icon:"storage"}],enableAreaChart:true,description:HOSTS}];const HostsKpiHostsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const _useHostsKpiHosts=useHostsKpiHosts({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip}),_useHostsKpiHosts2=kpi_hosts_hosts_slicedToArray(_useHostsKpiHosts,2),loading=_useHostsKpiHosts2[0],_useHostsKpiHosts2$=_useHostsKpiHosts2[1],refetch=_useHostsKpiHosts2$.refetch,id=_useHostsKpiHosts2$.id,inspect=_useHostsKpiHosts2$.inspect,data=hosts_objectWithoutProperties(_useHostsKpiHosts2$,["refetch","id","inspect"]);return external_kbnSharedDeps_React_default.a.createElement(HostsKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:hosts_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const HostsKpiHosts=external_kbnSharedDeps_React_default.a.memo(HostsKpiHostsComponent);const ERROR_HOSTS_KPI_UNIQUE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiUniqueIps.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi unique ips search"});const FAIL_HOSTS_KPI_UNIQUE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiUniqueIps.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi unique ips"});function unique_ips_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function unique_ips_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){unique_ips_ownKeys(Object(source),true).forEach((function(key){unique_ips_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{unique_ips_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function unique_ips_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function unique_ips_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function unique_ips_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){unique_ips_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){unique_ips_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function unique_ips_slicedToArray(arr,i){return unique_ips_arrayWithHoles(arr)||unique_ips_iterableToArrayLimit(arr,i)||unique_ips_unsupportedIterableToArray(arr,i)||unique_ips_nonIterableRest()}function unique_ips_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function unique_ips_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return unique_ips_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return unique_ips_arrayLikeToArray(o,minLen)}function unique_ips_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function unique_ips_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function unique_ips_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const unique_ips_ID="hostsKpiUniqueIpsQuery";const useHostsKpiUniqueIps=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=unique_ips_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,factoryQueryType:search_strategy["HostsKpiQueries"].kpiUniqueIps,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}}:null),_useState4=unique_ips_slicedToArray(_useState3,2),hostsKpiUniqueIpsRequest=_useState4[0],setHostsKpiUniqueIpsRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({uniqueSourceIps:0,uniqueSourceIpsHistogram:[],uniqueDestinationIps:0,uniqueDestinationIpsHistogram:[],id:unique_ips_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current}),_useState6=unique_ips_slicedToArray(_useState5,2),hostsKpiUniqueIpsResponse=_useState6[0],setHostsKpiUniqueIpsResponse=_useState6[1];const hostsKpiUniqueIpsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=unique_ips_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(!response.isPartial&&!response.isRunning){if(!didCancel){setLoading(false);setHostsKpiUniqueIpsResponse(prevResponse=>unique_ips_objectSpread(unique_ips_objectSpread({},prevResponse),{},{uniqueSourceIps:response.uniqueSourceIps,uniqueSourceIpsHistogram:response.uniqueSourceIpsHistogram,uniqueDestinationIps:response.uniqueDestinationIps,uniqueDestinationIpsHistogram:response.uniqueDestinationIpsHistogram,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}))}searchSubscription$.unsubscribe()}else if(response.isPartial&&!response.isRunning){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_HOSTS_KPI_UNIQUE_IPS);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_HOSTS_KPI_UNIQUE_IPS,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setHostsKpiUniqueIpsRequest(prevRequest=>{const myRequest=unique_ips_objectSpread(unique_ips_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,factoryQueryType:search_strategy["HostsKpiQueries"].kpiUniqueIps,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{hostsKpiUniqueIpsSearch(hostsKpiUniqueIpsRequest)},[hostsKpiUniqueIpsRequest,hostsKpiUniqueIpsSearch]);return[loading,hostsKpiUniqueIpsResponse]};const UNIQUE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.uniqueIps.title",{defaultMessage:"Unique IPs"});const SOURCE_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceUnitLabel",{defaultMessage:"source"});const DESTINATION_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationUnitLabel",{defaultMessage:"destination"});const SOURCE_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceChartLabel",{defaultMessage:"Src."});const DESTINATION_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."});function unique_ips_objectWithoutProperties(source,excluded){if(source==null)return{};var target=unique_ips_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function unique_ips_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function kpi_hosts_unique_ips_slicedToArray(arr,i){return kpi_hosts_unique_ips_arrayWithHoles(arr)||kpi_hosts_unique_ips_iterableToArrayLimit(arr,i)||kpi_hosts_unique_ips_unsupportedIterableToArray(arr,i)||kpi_hosts_unique_ips_nonIterableRest()}function kpi_hosts_unique_ips_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kpi_hosts_unique_ips_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return kpi_hosts_unique_ips_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kpi_hosts_unique_ips_arrayLikeToArray(o,minLen)}function kpi_hosts_unique_ips_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function kpi_hosts_unique_ips_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function kpi_hosts_unique_ips_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const unique_ips_fieldsMapping=[{key:"uniqueIps",fields:[{key:"uniqueSourceIps",name:SOURCE_CHART_LABEL,description:SOURCE_UNIT_LABEL,value:null,color:kpi_hosts_types["a"].uniqueSourceIps,icon:"visMapCoordinate"},{key:"uniqueDestinationIps",name:DESTINATION_CHART_LABEL,description:DESTINATION_UNIT_LABEL,value:null,color:kpi_hosts_types["a"].uniqueDestinationIps,icon:"visMapCoordinate"}],enableAreaChart:true,enableBarChart:true,description:UNIQUE_IPS}];const HostsKpiUniqueIpsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const _useHostsKpiUniqueIps=useHostsKpiUniqueIps({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip}),_useHostsKpiUniqueIps2=kpi_hosts_unique_ips_slicedToArray(_useHostsKpiUniqueIps,2),loading=_useHostsKpiUniqueIps2[0],_useHostsKpiUniqueIps3=_useHostsKpiUniqueIps2[1],refetch=_useHostsKpiUniqueIps3.refetch,id=_useHostsKpiUniqueIps3.id,inspect=_useHostsKpiUniqueIps3.inspect,data=unique_ips_objectWithoutProperties(_useHostsKpiUniqueIps3,["refetch","id","inspect"]);return external_kbnSharedDeps_React_default.a.createElement(HostsKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:unique_ips_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const HostsKpiUniqueIps=external_kbnSharedDeps_React_default.a.memo(HostsKpiUniqueIpsComponent);const HostsKpiComponent=external_kbnSharedDeps_React_default.a.memo(({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,setQuery:setQuery,skip:skip,narrowDateRange:narrowDateRange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(HostsKpiHosts,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2},external_kbnSharedDeps_React_default.a.createElement(HostsKpiAuthentications,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2},external_kbnSharedDeps_React_default.a.createElement(HostsKpiUniqueIps,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))));HostsKpiComponent.displayName="HostsKpiComponent";const HostsDetailsKpiComponent=external_kbnSharedDeps_React_default.a.memo(({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,setQuery:setQuery,skip:skip,narrowDateRange:narrowDateRange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(HostsKpiAuthentications,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(HostsKpiUniqueIps,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))));HostsDetailsKpiComponent.displayName="HostsDetailsKpiComponent";var field_renderers=__webpack_require__(231);var anomaly_scores=__webpack_require__(685);var page=__webpack_require__(129);var security_solution=__webpack_require__(161);const ERROR_FIRST_LAST_SEEN_HOST=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.firstLastSeenHost.errorSearchDescription",{defaultMessage:"An error has occurred on first last seen host search"});const FAIL_FIRST_LAST_SEEN_HOST=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.firstLastSeenHost.failSearchDescription",{defaultMessage:"Failed to run search on first last seen host"});function first_last_seen_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function first_last_seen_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){first_last_seen_ownKeys(Object(source),true).forEach((function(key){first_last_seen_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{first_last_seen_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function first_last_seen_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function first_last_seen_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function first_last_seen_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){first_last_seen_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){first_last_seen_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function first_last_seen_slicedToArray(arr,i){return first_last_seen_arrayWithHoles(arr)||first_last_seen_iterableToArrayLimit(arr,i)||first_last_seen_unsupportedIterableToArray(arr,i)||first_last_seen_nonIterableRest()}function first_last_seen_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function first_last_seen_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return first_last_seen_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return first_last_seen_arrayLikeToArray(o,minLen)}function first_last_seen_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function first_last_seen_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function first_last_seen_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const first_last_seen_ID="firstLastSeenHostQuery";const useFirstLastSeenHost=({docValueFields:docValueFields,hostName:hostName,indexNames:indexNames})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=first_last_seen_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])({defaultIndex:indexNames,docValueFields:docValueFields!==null&&docValueFields!==void 0?docValueFields:[],factoryQueryType:security_solution["HostsQueries"].firstLastSeen,hostName:hostName}),_useState4=first_last_seen_slicedToArray(_useState3,2),firstLastSeenHostRequest=_useState4[0],setFirstLastSeenHostRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({firstSeen:null,lastSeen:null,errorMessage:null,id:first_last_seen_ID}),_useState6=first_last_seen_slicedToArray(_useState5,2),firstLastSeenHostResponse=_useState6[0],setFirstLastSeenHostResponse=_useState6[1];const firstLastSeenHostSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{let didCancel=false;const asyncSearch=function(){var _ref=first_last_seen_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){if(!didCancel){setLoading(false);setFirstLastSeenHostResponse(prevResponse=>first_last_seen_objectSpread(first_last_seen_objectSpread({},prevResponse),{},{errorMessage:null,firstSeen:response.firstSeen,lastSeen:response.lastSeen}))}searchSubscription$.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_FIRST_LAST_SEEN_HOST);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){setFirstLastSeenHostResponse(prevResponse=>first_last_seen_objectSpread(first_last_seen_objectSpread({},prevResponse),{},{errorMessage:msg}));notifications.toasts.addDanger({title:FAIL_FIRST_LAST_SEEN_HOST,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setFirstLastSeenHostRequest(prevRequest=>{const myRequest=first_last_seen_objectSpread(first_last_seen_objectSpread({},prevRequest),{},{defaultIndex:indexNames,docValueFields:docValueFields!==null&&docValueFields!==void 0?docValueFields:[],hostName:hostName});if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,docValueFields,hostName]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{firstLastSeenHostSearch(firstLastSeenHostRequest)},[firstLastSeenHostRequest,firstLastSeenHostSearch]);return[loading,firstLastSeenHostResponse]};function first_last_seen_host_slicedToArray(arr,i){return first_last_seen_host_arrayWithHoles(arr)||first_last_seen_host_iterableToArrayLimit(arr,i)||first_last_seen_host_unsupportedIterableToArray(arr,i)||first_last_seen_host_nonIterableRest()}function first_last_seen_host_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function first_last_seen_host_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return first_last_seen_host_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return first_last_seen_host_arrayLikeToArray(o,minLen)}function first_last_seen_host_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function first_last_seen_host_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function first_last_seen_host_arrayWithHoles(arr){if(Array.isArray(arr))return arr}let FirstLastSeenHostType;(function(FirstLastSeenHostType){FirstLastSeenHostType["FIRST_SEEN"]="first-seen";FirstLastSeenHostType["LAST_SEEN"]="last-seen"})(FirstLastSeenHostType||(FirstLastSeenHostType={}));const FirstLastSeenHost=external_kbnSharedDeps_React_default.a.memo(({docValueFields:docValueFields,hostName:hostName,type:type,indexNames:indexNames})=>{const _useFirstLastSeenHost=useFirstLastSeenHost({docValueFields:docValueFields,hostName:hostName,indexNames:indexNames}),_useFirstLastSeenHost2=first_last_seen_host_slicedToArray(_useFirstLastSeenHost,2),loading=_useFirstLastSeenHost2[0],_useFirstLastSeenHost3=_useFirstLastSeenHost2[1],firstSeen=_useFirstLastSeenHost3.firstSeen,lastSeen=_useFirstLastSeenHost3.lastSeen,errorMessage=_useFirstLastSeenHost3.errorMessage;const valueSeen=Object(external_kbnSharedDeps_React_["useMemo"])(()=>type===FirstLastSeenHostType.FIRST_SEEN?firstSeen:lastSeen,[firstSeen,lastSeen,type]);if(errorMessage!=null){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:errorMessage,"data-test-subj":"firstLastSeenErrorToolTip","aria-label":"firstLastSeenError-".concat(type),id:"firstLastSeenError-".concat(hostName,"-").concat(type)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{"aria-describedby":"firstLastSeenError-".concat(hostName,"-").concat(type),type:"alert"}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"}),!loading&&valueSeen!=null&&new Date(valueSeen).toString()==="Invalid Date"?valueSeen:!loading&&valueSeen!=null&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(formatted_date["b"],{value:"".concat(valueSeen)})),!loading&&valueSeen==null&&Object(empty_value["d"])())});FirstLastSeenHost.displayName="FirstLastSeenHost";const HOST_ID=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.hostIdTitle",{defaultMessage:"Host ID"});const FIRST_SEEN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.firstSeenTitle",{defaultMessage:"First seen"});const LAST_SEEN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.lastSeenTitle",{defaultMessage:"Last seen"});const MAX_ANOMALY_SCORE_BY_JOB=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"});const IP_ADDRESSES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"});const MAC_ADDRESSES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.macAddressesTitle",{defaultMessage:"MAC addresses"});const PLATFORM=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.platformTitle",{defaultMessage:"Platform"});const OS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.osTitle",{defaultMessage:"Operating system"});const FAMILY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.familyTitle",{defaultMessage:"Family"});const VERSION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.versionLabel",{defaultMessage:"Version"});const ARCHITECTURE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.architectureLabel",{defaultMessage:"Architecture"});const CLOUD_PROVIDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.cloudProviderTitle",{defaultMessage:"Cloud provider"});const REGION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.regionTitle",{defaultMessage:"Region"});const INSTANCE_ID=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.instanceIdTitle",{defaultMessage:"Instance ID"});const MACHINE_TYPE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.machineTypeTitle",{defaultMessage:"Machine type"});const INSPECT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.overview.inspectTitle",{defaultMessage:"Host overview"});var graphql_types=__webpack_require__(110);const ENDPOINT_POLICY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.endpoint.endpointPolicy",{defaultMessage:"Integration"});const POLICY_STATUS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.endpoint.policyStatus",{defaultMessage:"Configuration Status"});const SENSORVERSION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.host.details.endpoint.sensorversion",{defaultMessage:"Sensorversion"});const getDescriptionList=(descriptionList,key)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:key},external_kbnSharedDeps_React_default.a.createElement(page["d"],{"data-test-subj":"endpoint-overview",listItems:descriptionList}));const EndpointOverview=external_kbnSharedDeps_React_default.a.memo(({data:data})=>{const getDefaultRenderer=Object(external_kbnSharedDeps_React_["useCallback"])((fieldName,fieldData,attrName)=>external_kbnSharedDeps_React_default.a.createElement(field_renderers["b"],{rowItems:[Object(external_kbnSharedDeps_LodashFp_["getOr"])("",fieldName,fieldData)],attrName:attrName,idPrefix:"endpoint-overview"}),[]);const descriptionLists=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[[{title:ENDPOINT_POLICY,description:data!=null&&data.endpointPolicy!=null?data.endpointPolicy:Object(empty_value["d"])()}],[{title:POLICY_STATUS,description:data!=null&&data.policyStatus!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{"aria-label":data.policyStatus,color:data.policyStatus===graphql_types["e"].failure?"danger":data.policyStatus},data.policyStatus):Object(empty_value["d"])()}],[{title:SENSORVERSION,description:data!=null&&data.sensorVersion!=null?getDefaultRenderer("sensorVersion",data,"agent.version"):Object(empty_value["d"])()}],[]],[data,getDefaultRenderer]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,descriptionLists.map((descriptionList,index)=>getDescriptionList(descriptionList,index)))});EndpointOverview.displayName="EndpointOverview";function host_overview_slicedToArray(arr,i){return host_overview_arrayWithHoles(arr)||host_overview_iterableToArrayLimit(arr,i)||host_overview_unsupportedIterableToArray(arr,i)||host_overview_nonIterableRest()}function host_overview_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function host_overview_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return host_overview_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return host_overview_arrayLikeToArray(o,minLen)}function host_overview_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function host_overview_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function host_overview_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const host_overview_getDescriptionList=(descriptionList,key)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:key},external_kbnSharedDeps_React_default.a.createElement(page["d"],{listItems:descriptionList}));const HostOverview=external_kbnSharedDeps_React_default.a.memo(({anomaliesData:anomaliesData,data:data,docValueFields:docValueFields,endDate:endDate,id:id,isLoadingAnomaliesData:isLoadingAnomaliesData,indexNames:indexNames,loading:loading,narrowDateRange:narrowDateRange,startDate:startDate})=>{const capabilities=Object(use_ml_capabilities["a"])();const userPermissions=Object(has_ml_user_permissions["a"])(capabilities);const _useUiSetting$=Object(lib_kibana["l"])(constants["q"]),_useUiSetting$2=host_overview_slicedToArray(_useUiSetting$,1),darkMode=_useUiSetting$2[0];const getDefaultRenderer=Object(external_kbnSharedDeps_React_["useCallback"])((fieldName,fieldData)=>external_kbnSharedDeps_React_default.a.createElement(field_renderers["b"],{rowItems:Object(external_kbnSharedDeps_LodashFp_["getOr"])([],fieldName,fieldData),attrName:fieldName,idPrefix:"host-overview"}),[]);const column=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{title:HOST_ID,description:data.host?Object(field_renderers["g"])({host:data.host,noLink:true}):Object(empty_value["d"])()},{title:FIRST_SEEN,description:data.host!=null&&data.host.name&&data.host.name.length?external_kbnSharedDeps_React_default.a.createElement(FirstLastSeenHost,{docValueFields:docValueFields,hostName:data.host.name[0],indexNames:indexNames,type:FirstLastSeenHostType.FIRST_SEEN}):Object(empty_value["d"])()},{title:LAST_SEEN,description:data.host!=null&&data.host.name&&data.host.name.length?external_kbnSharedDeps_React_default.a.createElement(FirstLastSeenHost,{docValueFields:docValueFields,hostName:data.host.name[0],indexNames:indexNames,type:FirstLastSeenHostType.LAST_SEEN}):Object(empty_value["d"])()}],[data,docValueFields,indexNames]);const firstColumn=Object(external_kbnSharedDeps_React_["useMemo"])(()=>userPermissions?[...column,{title:MAX_ANOMALY_SCORE_BY_JOB,description:external_kbnSharedDeps_React_default.a.createElement(anomaly_scores["a"],{anomalies:anomaliesData,startDate:startDate,endDate:endDate,isLoading:isLoadingAnomaliesData,narrowDateRange:narrowDateRange})}]:column,[anomaliesData,column,endDate,isLoadingAnomaliesData,narrowDateRange,startDate,userPermissions]);const descriptionLists=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[firstColumn,[{title:IP_ADDRESSES,description:external_kbnSharedDeps_React_default.a.createElement(field_renderers["b"],{rowItems:Object(external_kbnSharedDeps_LodashFp_["getOr"])([],"host.ip",data),attrName:"host.ip",idPrefix:"host-overview",render:ip=>ip!=null?external_kbnSharedDeps_React_default.a.createElement(links["h"],{ip:ip}):Object(empty_value["d"])()})},{title:MAC_ADDRESSES,description:getDefaultRenderer("host.mac",data)},{title:PLATFORM,description:getDefaultRenderer("host.os.platform",data)}],[{title:OS,description:getDefaultRenderer("host.os.name",data)},{title:FAMILY,description:getDefaultRenderer("host.os.family",data)},{title:VERSION,description:getDefaultRenderer("host.os.version",data)},{title:ARCHITECTURE,description:getDefaultRenderer("host.architecture",data)}],[{title:CLOUD_PROVIDER,description:getDefaultRenderer("cloud.provider",data)},{title:REGION,description:getDefaultRenderer("cloud.region",data)},{title:INSTANCE_ID,description:getDefaultRenderer("cloud.instance.id",data)},{title:MACHINE_TYPE,description:getDefaultRenderer("cloud.machine.type",data)}]],[data,firstColumn,getDefaultRenderer]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(components_inspect["b"],null,external_kbnSharedDeps_React_default.a.createElement(page["f"],null,external_kbnSharedDeps_React_default.a.createElement(components_inspect["a"],{queryId:id,title:INSPECT_TITLE,inspectIndex:0}),descriptionLists.map((descriptionList,index)=>host_overview_getDescriptionList(descriptionList,index)),loading&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{overlay:true,overlayBackground:darkMode?external_kbnSharedDeps_Theme_euiDarkVars_default.a.euiPageBackgroundColor:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiPageBackgroundColor,size:"xl"}))),data.endpoint!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(page["f"],null,external_kbnSharedDeps_React_default.a.createElement(EndpointOverview,{data:data.endpoint}),loading&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{overlay:true,overlayBackground:darkMode?external_kbnSharedDeps_Theme_euiDarkVars_default.a.euiPageBackgroundColor:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiPageBackgroundColor,size:"xl"}))):null)});HostOverview.displayName="HostOverview";var react_apollo_browser_umd=__webpack_require__(471);var redux=__webpack_require__(156);function query_template_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class query_template_QueryTemplate extends external_kbnSharedDeps_React_default.a.PureComponent{constructor(...args){super(...args);query_template_defineProperty(this,"fetchMore",void 0);query_template_defineProperty(this,"fetchMoreOptions",void 0);query_template_defineProperty(this,"refetch",void 0);query_template_defineProperty(this,"executeBeforeFetchMore",void 0);query_template_defineProperty(this,"executeBeforeRefetch",void 0);query_template_defineProperty(this,"setExecuteBeforeFetchMore",val=>{this.executeBeforeFetchMore=val});query_template_defineProperty(this,"setExecuteBeforeRefetch",val=>{this.executeBeforeRefetch=val});query_template_defineProperty(this,"setFetchMore",val=>{this.fetchMore=val});query_template_defineProperty(this,"setFetchMoreOptions",val=>{this.fetchMoreOptions=val});query_template_defineProperty(this,"setRefetch",val=>{this.refetch=val});query_template_defineProperty(this,"wrappedLoadMore",(newCursor,tiebreaker)=>{this.executeBeforeFetchMore({id:this.props.id});return this.fetchMore(this.fetchMoreOptions(newCursor,tiebreaker))});query_template_defineProperty(this,"wrappedRefetch",variables=>{this.executeBeforeRefetch({id:this.props.id});return this.refetch(variables)})}}var graphql_tag_umd=__webpack_require__(204);var graphql_tag_umd_default=__webpack_require__.n(graphql_tag_umd);function _templateObject(){const data=_taggedTemplateLiteral(["\n  query GetHostOverviewQuery(\n    $sourceId: ID!\n    $hostName: String!\n    $timerange: TimerangeInput!\n    $defaultIndex: [String!]!\n    $inspect: Boolean!\n  ) {\n    source(id: $sourceId) {\n      id\n      HostOverview(hostName: $hostName, timerange: $timerange, defaultIndex: $defaultIndex) {\n        _id\n        agent {\n          id\n        }\n        host {\n          architecture\n          id\n          ip\n          mac\n          name\n          os {\n            family\n            name\n            platform\n            version\n          }\n          type\n        }\n        cloud {\n          instance {\n            id\n          }\n          machine {\n            type\n          }\n          provider\n          region\n        }\n        inspect @include(if: $inspect) {\n          dsl\n          response\n        }\n        endpoint {\n          endpointPolicy\n          policyStatus\n          sensorVersion\n        }\n      }\n    }\n  }\n"]);_templateObject=function _templateObject(){return data};return data}function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0)}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}const HostOverviewQuery=graphql_tag_umd_default()(_templateObject());const details_ID="hostOverviewQuery";class details_HostOverviewByNameComponentQuery extends query_template_QueryTemplate{render(){const _this$props=this.props,_this$props$id=_this$props.id,id=_this$props$id===void 0?details_ID:_this$props$id,indexNames=_this$props.indexNames,isInspected=_this$props.isInspected,children=_this$props.children,hostName=_this$props.hostName,skip=_this$props.skip,sourceId=_this$props.sourceId,startDate=_this$props.startDate,endDate=_this$props.endDate;return external_kbnSharedDeps_React_default.a.createElement(react_apollo_browser_umd["Query"],{query:HostOverviewQuery,fetchPolicy:Object(containers_helpers["b"])(),notifyOnNetworkStatusChange:true,skip:skip,variables:{sourceId:sourceId,hostName:hostName,timerange:{interval:"12h",from:startDate,to:endDate},defaultIndex:indexNames,inspect:isInspected}},({data:data,loading:loading,refetch:refetch})=>{const hostOverview=Object(external_kbnSharedDeps_LodashFp_["getOr"])([],"source.HostOverview",data);return children({id:id,inspect:Object(external_kbnSharedDeps_LodashFp_["getOr"])(null,"source.HostOverview.inspect",data),refetch:refetch,loading:loading,hostOverview:hostOverview,startDate:startDate,endDate:endDate})})}}const hosts_details_makeMapStateToProps=()=>{const getQuery=common_store["inputsSelectors"].globalQueryByIdSelector();const mapStateToProps=(state,{id:id=details_ID})=>{const _getQuery=getQuery(state,id),isInspected=_getQuery.isInspected;return{isInspected:isInspected}};return mapStateToProps};const HostOverviewByNameQuery=Object(redux["compose"])(Object(react_redux_lib["connect"])(hosts_details_makeMapStateToProps))(details_HostOverviewByNameComponentQuery);var store_actions=__webpack_require__(316);var store_model=__webpack_require__(113);var anomalies_query_tab_body=__webpack_require__(348);var tables_translations=__webpack_require__(333);var tables_helpers=__webpack_require__(153);var entity_draggable=__webpack_require__(642);var create_compound_key=__webpack_require__(643);var get_entries=__webpack_require__(269);var draggable_score=__webpack_require__(425);var create_explorer_link=__webpack_require__(426);var drag_and_drop_helpers=__webpack_require__(92);function get_anomalies_host_table_columns_slicedToArray(arr,i){return get_anomalies_host_table_columns_arrayWithHoles(arr)||get_anomalies_host_table_columns_iterableToArrayLimit(arr,i)||get_anomalies_host_table_columns_unsupportedIterableToArray(arr,i)||get_anomalies_host_table_columns_nonIterableRest()}function get_anomalies_host_table_columns_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function get_anomalies_host_table_columns_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return get_anomalies_host_table_columns_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return get_anomalies_host_table_columns_arrayLikeToArray(o,minLen)}function get_anomalies_host_table_columns_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function get_anomalies_host_table_columns_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function get_anomalies_host_table_columns_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const getAnomaliesHostTableColumns=(startDate,endDate,interval,narrowDateRange)=>[{name:tables_translations["d"],field:"hostName",sortable:true,render:(hostName,anomaliesByHost)=>Object(tables_helpers["b"])({rowItem:hostName,attrName:"host.name",idPrefix:"anomalies-host-table-hostName-".concat(Object(create_compound_key["a"])(anomaliesByHost),"-hostName"),render:item=>external_kbnSharedDeps_React_default.a.createElement(links["d"],{hostName:item})})},{name:tables_translations["b"],field:"anomaly.jobId",sortable:true,render:(jobId,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(create_explorer_link["a"],{score:anomaliesByHost.anomaly,startDate:startDate,endDate:endDate,linkName:jobId})},{name:tables_translations["g"],field:"anomaly.severity",sortable:true,render:(_,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(draggable_score["a"],{id:Object(drag_and_drop_helpers["j"])("anomalies-host-table-severity-".concat(Object(create_compound_key["a"])(anomaliesByHost))),score:anomaliesByHost.anomaly})},{name:tables_translations["c"],field:"anomaly.entityValue",sortable:true,render:(entityValue,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(entity_draggable["a"],{idPrefix:"anomalies-host-table-entityValue".concat(Object(create_compound_key["a"])(anomaliesByHost),"-entity"),entityName:anomaliesByHost.anomaly.entityName,entityValue:entityValue})},{name:tables_translations["e"],field:"anomaly.influencers",render:(influencers,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"none",responsive:false},influencers&&influencers.map(influencer=>{const _getEntries=Object(get_entries["a"])(influencer),_getEntries2=get_anomalies_host_table_columns_slicedToArray(_getEntries,2),key=_getEntries2[0],value=_getEntries2[1];const entityName=key!=null?key:"";const entityValue=value!=null?value:"";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:"".concat(entityName,"-").concat(entityValue,"-").concat(Object(create_compound_key["a"])(anomaliesByHost)),grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(entity_draggable["a"],{idPrefix:"anomalies-host-table-influencers-".concat(entityName,"-").concat(entityValue,"-").concat(Object(create_compound_key["a"])(anomaliesByHost)),entityName:entityName,entityValue:entityValue}))))}))},{name:tables_translations["i"],field:"anomaly.time",sortable:true,render:time=>external_kbnSharedDeps_React_default.a.createElement(formatted_date["b"],{value:time})}];const getAnomaliesHostTableColumnsCurated=(pageType,startDate,endDate,interval,narrowDateRange)=>{const columns=getAnomaliesHostTableColumns(startDate,endDate,interval,narrowDateRange);if(pageType===store_model["HostsType"].details){return columns.filter(column=>column.name!==tables_translations["d"])}else{return columns}};function get_host_name_from_influencers_slicedToArray(arr,i){return get_host_name_from_influencers_arrayWithHoles(arr)||get_host_name_from_influencers_iterableToArrayLimit(arr,i)||get_host_name_from_influencers_unsupportedIterableToArray(arr,i)||get_host_name_from_influencers_nonIterableRest()}function get_host_name_from_influencers_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function get_host_name_from_influencers_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return get_host_name_from_influencers_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return get_host_name_from_influencers_arrayLikeToArray(o,minLen)}function get_host_name_from_influencers_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function get_host_name_from_influencers_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function get_host_name_from_influencers_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const getHostNameFromInfluencers=(influencers=[],hostName)=>{const recordFound=influencers.find(influencer=>{const _getEntries=Object(get_entries["a"])(influencer),_getEntries2=get_host_name_from_influencers_slicedToArray(_getEntries,2),influencerName=_getEntries2[0],influencerValue=_getEntries2[1];if(influencerName==="host.name"){if(hostName==null){return true}else{return influencerValue===hostName}}else{return false}});if(recordFound!=null){return Object.values(recordFound)[0]}else{return null}};const convertAnomaliesToHosts=(anomalies,hostName)=>{if(anomalies==null){return[]}else{return anomalies.anomalies.reduce((accum,item)=>{if(getHostNameFromEntity(item,hostName)){return[...accum,{hostName:item.entityValue,anomaly:item}]}else{const hostNameFromInfluencers=getHostNameFromInfluencers(item.influencers,hostName);if(hostNameFromInfluencers!=null){return[...accum,{hostName:hostNameFromInfluencers,anomaly:item}]}else{return accum}}},[])}};const getHostNameFromEntity=(anomaly,hostName)=>{if(anomaly.entityName!=="host.name"){return false}else if(hostName==null){return true}else{return anomaly.entityValue===hostName}};const getIntervalFromAnomalies=anomalies=>{if(anomalies==null){return"day"}else{return anomalies.interval}};var basic_table=__webpack_require__(645);const hostEquality=(prevProps,nextProps)=>prevProps.startDate===nextProps.startDate&&prevProps.endDate===nextProps.endDate&&prevProps.skip===nextProps.skip;const getCriteriaFromHostType=(type,hostName)=>{if(type===store_model["HostsType"].details&&hostName!=null){return[{fieldName:"host.name",fieldValue:hostName}]}else{return[]}};function anomalies_host_table_slicedToArray(arr,i){return anomalies_host_table_arrayWithHoles(arr)||anomalies_host_table_iterableToArrayLimit(arr,i)||anomalies_host_table_unsupportedIterableToArray(arr,i)||anomalies_host_table_nonIterableRest()}function anomalies_host_table_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function anomalies_host_table_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return anomalies_host_table_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return anomalies_host_table_arrayLikeToArray(o,minLen)}function anomalies_host_table_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function anomalies_host_table_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function anomalies_host_table_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const anomalies_host_table_sorting={sort:{field:"anomaly.severity",direction:"desc"}};const AnomaliesHostTableComponent=({startDate:startDate,endDate:endDate,narrowDateRange:narrowDateRange,hostName:hostName,skip:skip,type:type})=>{const capabilities=Object(use_ml_capabilities["a"])();const _useAnomaliesTableDat=Object(use_anomalies_table_data["a"])({startDate:startDate,endDate:endDate,skip:skip,criteriaFields:getCriteriaFromHostType(type,hostName)}),_useAnomaliesTableDat2=anomalies_host_table_slicedToArray(_useAnomaliesTableDat,2),loading=_useAnomaliesTableDat2[0],tableData=_useAnomaliesTableDat2[1];const hosts=convertAnomaliesToHosts(tableData,hostName);const interval=getIntervalFromAnomalies(tableData);const columns=getAnomaliesHostTableColumnsCurated(type,startDate,endDate,interval,narrowDateRange);const pagination={initialPageIndex:0,initialPageSize:10,totalItemCount:hosts.length,pageSizeOptions:[5,10,20,50],hidePerPageOptions:false};if(!Object(has_ml_user_permissions["a"])(capabilities)){return null}else{return external_kbnSharedDeps_React_default.a.createElement(panel["a"],{loading:loading},external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{subtitle:"".concat(tables_translations["h"],": ").concat(pagination.totalItemCount.toLocaleString()," ").concat(tables_translations["k"](pagination.totalItemCount)),title:tables_translations["a"],tooltip:tables_translations["j"]}),external_kbnSharedDeps_React_default.a.createElement(basic_table["a"],{columns:columns,items:hosts,pagination:pagination,sorting:anomalies_host_table_sorting}),loading&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"anomalies-host-table-loading-panel",overlay:true,size:"xl"}))}};const AnomaliesHostTable=external_kbnSharedDeps_React_default.a.memo(AnomaliesHostTableComponent,hostEquality);var details_utils=__webpack_require__(424);var pages_navigation=__webpack_require__(346);function details_tabs_extends(){details_tabs_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return details_tabs_extends.apply(this,arguments)}function details_tabs_slicedToArray(arr,i){return details_tabs_arrayWithHoles(arr)||details_tabs_iterableToArrayLimit(arr,i)||details_tabs_unsupportedIterableToArray(arr,i)||details_tabs_nonIterableRest()}function details_tabs_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function details_tabs_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return details_tabs_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return details_tabs_arrayLikeToArray(o,minLen)}function details_tabs_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function details_tabs_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function details_tabs_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const HostDetailsTabs=external_kbnSharedDeps_React_default.a.memo(({detailName:detailName,docValueFields:docValueFields,filterQuery:filterQuery,indexNames:indexNames,indexPattern:indexPattern,pageFilters:pageFilters,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,hostDetailsPagePath:hostDetailsPagePath})=>{const _useGlobalTime=Object(use_global_time["a"])(),from=_useGlobalTime.from,to=_useGlobalTime.to,isInitializing=_useGlobalTime.isInitializing,deleteQuery=_useGlobalTime.deleteQuery,setQuery=_useGlobalTime.setQuery;const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])((score,interval)=>{const fromTo=Object(score_interval_to_datetime["a"])(score,interval);setAbsoluteRangeDatePicker({id:"global",from:fromTo.from,to:fromTo.to})},[setAbsoluteRangeDatePicker]);const updateDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const _x=details_tabs_slicedToArray(x,2),min=_x[0],max=_x[1];setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]);const tabProps={deleteQuery:deleteQuery,endDate:to,filterQuery:filterQuery,skip:isInitializing,setQuery:setQuery,startDate:from,type:details_utils["b"],indexPattern:indexPattern,indexNames:indexNames,hostName:detailName,narrowDateRange:narrowDateRange,updateDateRange:updateDateRange};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"".concat(hostDetailsPagePath,"/:tabName(").concat(store_model["HostsTableType"].authentications,")")},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["a"],details_tabs_extends({docValueFields:docValueFields},tabProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"".concat(hostDetailsPagePath,"/:tabName(").concat(store_model["HostsTableType"].hosts,")")},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["d"],tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"".concat(hostDetailsPagePath,"/:tabName(").concat(store_model["HostsTableType"].uncommonProcesses,")")},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["e"],tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"".concat(hostDetailsPagePath,"/:tabName(").concat(store_model["HostsTableType"].anomalies,")")},external_kbnSharedDeps_React_default.a.createElement(anomalies_query_tab_body["a"],details_tabs_extends({},tabProps,{AnomaliesTableComponent:AnomaliesHostTable}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"".concat(hostDetailsPagePath,"/:tabName(").concat(store_model["HostsTableType"].events,")")},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["b"],details_tabs_extends({},tabProps,{pageFilters:pageFilters}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"".concat(hostDetailsPagePath,"/:tabName(").concat(store_model["HostsTableType"].alerts,")")},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["c"],details_tabs_extends({},tabProps,{pageFilters:pageFilters}))))});HostDetailsTabs.displayName="HostDetailsTabs";var hosts_pages_translations=__webpack_require__(232);const getTabsOnHostDetailsUrl=(hostName,tabName)=>"/".concat(hostName,"/").concat(tabName);const navTabsHostDetails=(hostName,hasMlUserPermissions)=>{const hostDetailsNavTabs={[store_model["HostsTableType"].authentications]:{id:store_model["HostsTableType"].authentications,name:hosts_pages_translations["f"],href:getTabsOnHostDetailsUrl(hostName,store_model["HostsTableType"].authentications),disabled:false,urlKey:"host",isDetailPage:true,pageId:app_types["a"].hosts},[store_model["HostsTableType"].uncommonProcesses]:{id:store_model["HostsTableType"].uncommonProcesses,name:hosts_pages_translations["h"],href:getTabsOnHostDetailsUrl(hostName,store_model["HostsTableType"].uncommonProcesses),disabled:false,urlKey:"host",isDetailPage:true,pageId:app_types["a"].hosts},[store_model["HostsTableType"].anomalies]:{id:store_model["HostsTableType"].anomalies,name:hosts_pages_translations["e"],href:getTabsOnHostDetailsUrl(hostName,store_model["HostsTableType"].anomalies),disabled:false,urlKey:"host",isDetailPage:true,pageId:app_types["a"].hosts},[store_model["HostsTableType"].events]:{id:store_model["HostsTableType"].events,name:hosts_pages_translations["g"],href:getTabsOnHostDetailsUrl(hostName,store_model["HostsTableType"].events),disabled:false,urlKey:"host",isDetailPage:true,pageId:app_types["a"].hosts},[store_model["HostsTableType"].alerts]:{id:store_model["HostsTableType"].alerts,name:hosts_pages_translations["c"],href:getTabsOnHostDetailsUrl(hostName,store_model["HostsTableType"].alerts),disabled:false,urlKey:"host",pageId:app_types["a"].hosts}};return hasMlUserPermissions?hostDetailsNavTabs:Object(external_kbnSharedDeps_LodashFp_["omit"])(store_model["HostsTableType"].anomalies,hostDetailsNavTabs)};const getHostDetailsEventsKqlQueryExpression=({filterQueryExpression:filterQueryExpression,hostName:hostName})=>{if(filterQueryExpression.length){return"".concat(filterQueryExpression).concat(hostName.length?" and host.name: ".concat(Object(keury["c"])(hostName)):"")}else{return hostName.length?"host.name: ".concat(Object(keury["c"])(hostName)):""}};const getHostDetailsPageFilters=hostName=>[{meta:{alias:null,negate:false,disabled:false,type:"phrase",key:"host.name",value:hostName,params:{query:hostName}},query:{match:{"host.name":{query:hostName,type:"phrase"}}}}];function pages_details_slicedToArray(arr,i){return pages_details_arrayWithHoles(arr)||pages_details_iterableToArrayLimit(arr,i)||pages_details_unsupportedIterableToArray(arr,i)||pages_details_nonIterableRest()}function pages_details_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pages_details_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return pages_details_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pages_details_arrayLikeToArray(o,minLen)}function pages_details_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function pages_details_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function pages_details_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const HostOverviewManage=Object(manage_query["a"])(HostOverview);const HostDetailsComponent=external_kbnSharedDeps_React_default.a.memo(({filters:filters,graphEventId:graphEventId,query:query,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,setHostDetailsTablesActivePageToZero:setHostDetailsTablesActivePageToZero,detailName:detailName,hostDetailsPagePath:hostDetailsPagePath})=>{const _useGlobalTime=Object(use_global_time["a"])(),to=_useGlobalTime.to,from=_useGlobalTime.from,deleteQuery=_useGlobalTime.deleteQuery,setQuery=_useGlobalTime.setQuery,isInitializing=_useGlobalTime.isInitializing;const _useFullScreen=Object(use_full_screen["a"])(),globalFullScreen=_useFullScreen.globalFullScreen;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setHostDetailsTablesActivePageToZero()},[setHostDetailsTablesActivePageToZero,detailName]);const capabilities=Object(use_ml_capabilities["a"])();const kibana=Object(lib_kibana["h"])();const hostDetailsPageFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getHostDetailsPageFilters(detailName),[detailName]);const getFilters=()=>[...hostDetailsPageFilters,...filters];const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const _x=pages_details_slicedToArray(x,2),min=_x[0],max=_x[1];setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]);const _useSourcererScope=Object(sourcerer["b"])(),docValueFields=_useSourcererScope.docValueFields,indicesExist=_useSourcererScope.indicesExist,indexPattern=_useSourcererScope.indexPattern,selectedPatterns=_useSourcererScope.selectedPatterns;const filterQuery=Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:getFilters()});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"resize",handler:external_kbnSharedDeps_LodashFp_["noop"]}),external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],{show:Object(timeline_helpers["f"])({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{indexPattern:indexPattern,id:"global"})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_event_time["a"],{docValueFields:docValueFields,indexKey:search_strategy["LastEventIndexKey"].hostDetails,hostName:detailName,indexNames:selectedPatterns}),title:detailName}),external_kbnSharedDeps_React_default.a.createElement(HostOverviewByNameQuery,{indexNames:selectedPatterns,sourceId:"default",hostName:detailName,skip:isInitializing,startDate:from,endDate:to},({hostOverview:hostOverview,loading:loading,id:id,inspect:inspect,refetch:refetch})=>external_kbnSharedDeps_React_default.a.createElement(AnomalyTableProvider,{criteriaFields:hostToCriteria(hostOverview),startDate:from,endDate:to,skip:isInitializing},({isLoadingAnomaliesData:isLoadingAnomaliesData,anomaliesData:anomaliesData})=>external_kbnSharedDeps_React_default.a.createElement(HostOverviewManage,{docValueFields:docValueFields,id:id,inspect:inspect,refetch:refetch,setQuery:setQuery,data:hostOverview,anomaliesData:anomaliesData,isLoadingAnomaliesData:isLoadingAnomaliesData,indexNames:selectedPatterns,loading:loading,startDate:from,endDate:to,narrowDateRange:(score,interval)=>{const fromTo=Object(score_interval_to_datetime["a"])(score,interval);setAbsoluteRangeDatePicker({id:"global",from:fromTo.from,to:fromTo.to})}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(HostsDetailsKpiComponent,{filterQuery:filterQuery,from:from,indexNames:selectedPatterns,setQuery:setQuery,to:to,narrowDateRange:narrowDateRange,skip:isInitializing}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(navigation["a"],{navTabs:navTabsHostDetails(detailName,Object(has_ml_user_permissions["a"])(capabilities))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),external_kbnSharedDeps_React_default.a.createElement(HostDetailsTabs,{docValueFields:docValueFields,indexNames:selectedPatterns,isInitializing:isInitializing,deleteQuery:deleteQuery,pageFilters:hostDetailsPageFilters,to:to,from:from,detailName:detailName,type:details_utils["b"],setQuery:setQuery,filterQuery:filterQuery,hostDetailsPagePath:hostDetailsPagePath,indexPattern:indexPattern,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,title:detailName}),external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].hosts}))});HostDetailsComponent.displayName="HostDetailsComponent";const pages_details_makeMapStateToProps=()=>{const getGlobalQuerySelector=common_store["inputsSelectors"].globalQuerySelector();const getGlobalFiltersQuerySelector=common_store["inputsSelectors"].globalFiltersQuerySelector();const getTimeline=store_timeline["b"].getTimelineByIdSelector();return state=>{var _getTimeline;const timeline=(_getTimeline=getTimeline(state,types_timeline["e"].hostsPageEvents))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"];const graphEventId=timeline.graphEventId;return{query:getGlobalQuerySelector(state),filters:getGlobalFiltersQuerySelector(state),graphEventId:graphEventId}}};const pages_details_mapDispatchToProps={setAbsoluteRangeDatePicker:inputs_actions["setAbsoluteRangeDatePicker"],setHostDetailsTablesActivePageToZero:store_actions["setHostDetailsTablesActivePageToZero"]};const pages_details_connector=Object(react_redux_lib["connect"])(pages_details_makeMapStateToProps,pages_details_mapDispatchToProps);const HostDetails=pages_details_connector(HostDetailsComponent);var query_string=__webpack_require__(249);var rison=__webpack_require__(166);const decodeRison=value=>{try{return Object(rison["decode"])(value)}catch(error){return null}};const isRisonObject=value=>Object(external_kbnSharedDeps_LodashFp_["isObject"])(value);const isRegularString=value=>Object(external_kbnSharedDeps_LodashFp_["isString"])(value);const entityToKql=(entityNames,entity)=>{if(entityNames.length===1){return"".concat(entityNames[0],': "').concat(entity,'"')}else{return entityNames.reduce((accum,entityName,index,array)=>{if(index===0){return"(".concat(entityName,': "').concat(entity,'"')}else if(index===array.length-1){return"".concat(accum," or ").concat(entityName,': "').concat(entity,'")')}else{return"".concat(accum," or ").concat(entityName,': "').concat(entity,'"')}},"")}};const entitiesToKql=(entityNames,entities)=>entities.reduce((accum,entity,index)=>{const entityKql=entityToKql(entityNames,entity);if(index===0){return entityKql}else{return"".concat(accum," or ").concat(entityKql)}},"");const addEntitiesToKql=(entityNames,entities,kqlQuery)=>{const value=decodeRison(kqlQuery);if(isRisonObject(value)){const appQuery=value;if(isRisonObject(appQuery)){if(isRegularString(appQuery.query)){const entitiesKql=entitiesToKql(entityNames,entities);if(appQuery.query!==""&&entitiesKql!==""){appQuery.query="(".concat(entitiesKql,") and (").concat(appQuery.query,")")}else if(appQuery.query===""&&entitiesKql!==""){appQuery.query="(".concat(entitiesKql,")")}return Object(rison["encode"])(value)}}}else if(value==null){const entitiesKql=entitiesToKql(entityNames,entities);return Object(rison["encode"])({query:"(".concat(entitiesKql,")"),language:"kuery"})}return kqlQuery};const replacement=(match,p1,p2)=>{const split=p2.split(",");const newQuery=split.reduce((accum,item,index)=>{if(index===0){return"".concat(p1,': "').concat(item,'"')}else{return"".concat(accum," or ").concat(p1,': "').concat(item,'"')}},"");return"(".concat(newQuery,")")};const replaceKqlCommasWithOrUsingRegex=expression=>{const myRegexp=/([\w\.\-\[\]]+)\s*:\s*"(([\w\.\-\(\)\[\]]+,[\w\.\-\(\)\[\]]+){1,})"/g;return expression.replace(myRegexp,replacement)};const replaceKqlCommasWithOr=kqlQuery=>{const value=decodeRison(kqlQuery);if(isRisonObject(value)){const appQuery=value;if(isRisonObject(appQuery)){if(isRegularString(appQuery.query)){appQuery.query=replaceKqlCommasWithOrUsingRegex(appQuery.query);return Object(rison["encode"])(value)}}}return kqlQuery};const operators=["and","or","not"];const removeKqlVariablesUsingRegex=expression=>{const myRegexp=/(\s+)*(and|or|not){0,1}(\s+)*([\w\.\-\[\]]+)\s*:\s*"(\$[\w\.\-\(\)\[\]]+\$)"(\s+)*(and|or|not){0,1}(\s+)*/g;return expression.replace(myRegexp,replacer)};const replacer=(match,...parts)=>{if(parts==null){return""}const operatorsMatched=parts.reduce((accum,part)=>part!=null&&operators.includes(part)?[...accum,part]:accum,[]);if(operatorsMatched.length>1){return" ".concat(operatorsMatched[operatorsMatched.length-1].trim()," ")}else{return""}};const removeKqlVariables=kqlQuery=>{const value=decodeRison(kqlQuery);if(isRisonObject(value)){const appQuery=value;if(isRisonObject(appQuery)){if(isRegularString(appQuery.query)){appQuery.query=removeKqlVariablesUsingRegex(appQuery.query);return Object(rison["encode"])(value)}}}return kqlQuery};const replaceKQLParts=kqlQuery=>Object(external_kbnSharedDeps_LodashFp_["flow"])(replaceKqlCommasWithOr,removeKqlVariables)(kqlQuery);const emptyEntity=entity=>entity.trim()===""||entity.startsWith("$")&&entity.endsWith("$");const multipleEntities=entity=>entity.split(",").length>1;const getMultipleEntities=entity=>entity.split(",");var kibanaUtils_public_=__webpack_require__(29);const MlHostConditionalContainer=external_kbnSharedDeps_React_default.a.memo(({url:url})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{strict:true,exact:true,path:url,render:({location:location})=>{const queryStringDecoded=Object(query_string["parse"])(location.search.substring(1),{sort:false});if(queryStringDecoded.query!=null){queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query)}const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:"?".concat(reEncoded)})}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"".concat(url,"/:hostName"),render:({location:location,match:{params:{hostName:hostName}}})=>{const queryStringDecoded=Object(query_string["parse"])(location.search.substring(1),{sort:false});if(queryStringDecoded.query!=null){queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query)}if(emptyEntity(hostName)){const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:"/".concat(store_model["HostsTableType"].anomalies,"?").concat(reEncoded)})}else if(multipleEntities(hostName)){const hosts=getMultipleEntities(hostName);queryStringDecoded.query=addEntitiesToKql(["host.name"],hosts,queryStringDecoded.query||"");const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:"/".concat(store_model["HostsTableType"].anomalies,"?").concat(reEncoded)})}else{const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:"/".concat(hostName,"/").concat(store_model["HostsTableType"].anomalies,"?").concat(reEncoded)})}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/ml-hosts/",render:({location:{search:search=""}})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{from:"/ml-hosts/",to:"/ml-hosts".concat(search)})})));MlHostConditionalContainer.displayName="MlHostConditionalContainer";var alerts_query_tab_body=__webpack_require__(329);function hosts_tabs_extends(){hosts_tabs_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return hosts_tabs_extends.apply(this,arguments)}function hosts_tabs_slicedToArray(arr,i){return hosts_tabs_arrayWithHoles(arr)||hosts_tabs_iterableToArrayLimit(arr,i)||hosts_tabs_unsupportedIterableToArray(arr,i)||hosts_tabs_nonIterableRest()}function hosts_tabs_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hosts_tabs_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return hosts_tabs_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hosts_tabs_arrayLikeToArray(o,minLen)}function hosts_tabs_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function hosts_tabs_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function hosts_tabs_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const HostsTabs=Object(external_kbnSharedDeps_React_["memo"])(({deleteQuery:deleteQuery,docValueFields:docValueFields,filterQuery:filterQuery,from:from,indexNames:indexNames,isInitializing:isInitializing,hostsPagePath:hostsPagePath,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,setQuery:setQuery,to:to,type:type})=>{const tabProps={deleteQuery:deleteQuery,endDate:to,filterQuery:filterQuery,indexNames:indexNames,skip:isInitializing,setQuery:setQuery,startDate:from,type:type,narrowDateRange:Object(external_kbnSharedDeps_React_["useCallback"])((score,interval)=>{const fromTo=Object(score_interval_to_datetime["a"])(score,interval);setAbsoluteRangeDatePicker({id:"global",from:fromTo.from,to:fromTo.to})},[setAbsoluteRangeDatePicker]),updateDateRange:Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const _x=hosts_tabs_slicedToArray(x,2),min=_x[0],max=_x[1];setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker])};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(store_model["HostsTableType"].hosts,")")},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["d"],hosts_tabs_extends({docValueFields:docValueFields},tabProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(store_model["HostsTableType"].authentications,")")},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["a"],hosts_tabs_extends({docValueFields:docValueFields},tabProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(store_model["HostsTableType"].uncommonProcesses,")")},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["e"],tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(store_model["HostsTableType"].anomalies,")")},external_kbnSharedDeps_React_default.a.createElement(anomalies_query_tab_body["a"],hosts_tabs_extends({},tabProps,{AnomaliesTableComponent:AnomaliesHostTable}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(store_model["HostsTableType"].events,")")},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["b"],tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(store_model["HostsTableType"].alerts,")")},external_kbnSharedDeps_React_default.a.createElement(alerts_query_tab_body["a"],tabProps)))});HostsTabs.displayName="HostsTabs";const getTabsOnHostsUrl=tabName=>"/".concat(tabName);const navTabsHosts=hasMlUserPermissions=>{const hostsNavTabs={[store_model["HostsTableType"].hosts]:{id:store_model["HostsTableType"].hosts,name:hosts_pages_translations["d"],href:getTabsOnHostsUrl(store_model["HostsTableType"].hosts),disabled:false,urlKey:"host",pageId:app_types["a"].hosts},[store_model["HostsTableType"].authentications]:{id:store_model["HostsTableType"].authentications,name:hosts_pages_translations["f"],href:getTabsOnHostsUrl(store_model["HostsTableType"].authentications),disabled:false,urlKey:"host",pageId:app_types["a"].hosts},[store_model["HostsTableType"].uncommonProcesses]:{id:store_model["HostsTableType"].uncommonProcesses,name:hosts_pages_translations["h"],href:getTabsOnHostsUrl(store_model["HostsTableType"].uncommonProcesses),disabled:false,urlKey:"host",pageId:app_types["a"].hosts},[store_model["HostsTableType"].anomalies]:{id:store_model["HostsTableType"].anomalies,name:hosts_pages_translations["e"],href:getTabsOnHostsUrl(store_model["HostsTableType"].anomalies),disabled:false,urlKey:"host",pageId:app_types["a"].hosts},[store_model["HostsTableType"].events]:{id:store_model["HostsTableType"].events,name:hosts_pages_translations["g"],href:getTabsOnHostsUrl(store_model["HostsTableType"].events),disabled:false,urlKey:"host",pageId:app_types["a"].hosts},[store_model["HostsTableType"].alerts]:{id:store_model["HostsTableType"].alerts,name:hosts_pages_translations["c"],href:getTabsOnHostsUrl(store_model["HostsTableType"].alerts),disabled:false,urlKey:"host",pageId:app_types["a"].hosts}};return hasMlUserPermissions?hostsNavTabs:Object(external_kbnSharedDeps_LodashFp_["omit"])([store_model["HostsTableType"].anomalies],hostsNavTabs)};var hosts_store=__webpack_require__(164);function pages_hosts_slicedToArray(arr,i){return pages_hosts_arrayWithHoles(arr)||pages_hosts_iterableToArrayLimit(arr,i)||pages_hosts_unsupportedIterableToArray(arr,i)||pages_hosts_nonIterableRest()}function pages_hosts_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pages_hosts_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return pages_hosts_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pages_hosts_arrayLikeToArray(o,minLen)}function pages_hosts_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function pages_hosts_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function pages_hosts_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const HostsComponent=external_kbnSharedDeps_React_default.a.memo(({filters:filters,graphEventId:graphEventId,query:query,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,hostsPagePath:hostsPagePath})=>{const _useGlobalTime=Object(use_global_time["a"])(),to=_useGlobalTime.to,from=_useGlobalTime.from,deleteQuery=_useGlobalTime.deleteQuery,setQuery=_useGlobalTime.setQuery,isInitializing=_useGlobalTime.isInitializing;const _useFullScreen=Object(use_full_screen["a"])(),globalFullScreen=_useFullScreen.globalFullScreen;const capabilities=Object(use_ml_capabilities["a"])();const kibana=Object(lib_kibana["h"])();const _useParams=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])(),tabName=_useParams.tabName;const tabsFilters=external_kbnSharedDeps_React_default.a.useMemo(()=>{if(tabName===store_model["HostsTableType"].alerts){return filters.length>0?[...filters,...pages_navigation["g"]]:pages_navigation["g"]}return filters},[tabName,filters]);const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const _x=pages_hosts_slicedToArray(x,2),min=_x[0],max=_x[1];setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]);const _useSourcererScope=Object(sourcerer["b"])(),docValueFields=_useSourcererScope.docValueFields,indicesExist=_useSourcererScope.indicesExist,indexPattern=_useSourcererScope.indexPattern,selectedPatterns=_useSourcererScope.selectedPatterns;const filterQuery=Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:filters});const tabsFilterQuery=Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:tabsFilters});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"resize",handler:external_kbnSharedDeps_LodashFp_["noop"]}),external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],{show:Object(timeline_helpers["f"])({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{indexPattern:indexPattern,id:"global"})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_event_time["a"],{docValueFields:docValueFields,indexKey:search_strategy["LastEventIndexKey"].hosts,indexNames:selectedPatterns}),title:hosts_pages_translations["i"]}),external_kbnSharedDeps_React_default.a.createElement(HostsKpiComponent,{filterQuery:filterQuery,indexNames:selectedPatterns,from:from,setQuery:setQuery,to:to,skip:isInitializing,narrowDateRange:narrowDateRange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(navigation["a"],{navTabs:navTabsHosts(Object(has_ml_user_permissions["a"])(capabilities))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),external_kbnSharedDeps_React_default.a.createElement(HostsTabs,{deleteQuery:deleteQuery,docValueFields:docValueFields,to:to,filterQuery:tabsFilterQuery,isInitializing:isInitializing,indexNames:selectedPatterns,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,setQuery:setQuery,from:from,type:hosts_store["b"].HostsType.page,hostsPagePath:hostsPagePath}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,title:hosts_pages_translations["i"]}),external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].hosts}))});HostsComponent.displayName="HostsComponent";const hosts_makeMapStateToProps=()=>{const getGlobalQuerySelector=common_store["inputsSelectors"].globalQuerySelector();const getGlobalFiltersQuerySelector=common_store["inputsSelectors"].globalFiltersQuerySelector();const getTimeline=store_timeline["b"].getTimelineByIdSelector();const mapStateToProps=state=>{var _getTimeline,_getTimeline2;const hostsPageEventsTimeline=(_getTimeline=getTimeline(state,types_timeline["e"].hostsPageEvents))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"];const hostsPageEventsGraphEventId=hostsPageEventsTimeline.graphEventId;const hostsPageExternalAlertsTimeline=(_getTimeline2=getTimeline(state,types_timeline["e"].hostsPageExternalAlerts))!==null&&_getTimeline2!==void 0?_getTimeline2:defaults["a"];const hostsPageExternalAlertsGraphEventId=hostsPageExternalAlertsTimeline.graphEventId;return{query:getGlobalQuerySelector(state),filters:getGlobalFiltersQuerySelector(state),graphEventId:hostsPageEventsGraphEventId!==null&&hostsPageEventsGraphEventId!==void 0?hostsPageEventsGraphEventId:hostsPageExternalAlertsGraphEventId}};return mapStateToProps};const hosts_mapDispatchToProps={setAbsoluteRangeDatePicker:inputs_actions["setAbsoluteRangeDatePicker"]};const hosts_connector=Object(react_redux_lib["connect"])(hosts_makeMapStateToProps,hosts_mapDispatchToProps);const hosts_Hosts=hosts_connector(HostsComponent);const types_hostsPagePath="/";const types_hostDetailsPagePath="/:detailName";const getHostsTabPath=()=>"/:tabName("+"".concat(store_model["HostsTableType"].hosts,"|")+"".concat(store_model["HostsTableType"].authentications,"|")+"".concat(store_model["HostsTableType"].uncommonProcesses,"|")+"".concat(store_model["HostsTableType"].anomalies,"|")+"".concat(store_model["HostsTableType"].events,"|")+"".concat(store_model["HostsTableType"].alerts,")");const getHostDetailsTabPath=pagePath=>"".concat(types_hostDetailsPagePath,"/:tabName(")+"".concat(store_model["HostsTableType"].authentications,"|")+"".concat(store_model["HostsTableType"].uncommonProcesses,"|")+"".concat(store_model["HostsTableType"].anomalies,"|")+"".concat(store_model["HostsTableType"].events,"|")+"".concat(store_model["HostsTableType"].alerts,")");const HostsContainer=external_kbnSharedDeps_React_default.a.memo(({url:url})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/ml-hosts",render:({location:location,match:match})=>external_kbnSharedDeps_React_default.a.createElement(MlHostConditionalContainer,{location:location,url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:getHostsTabPath()},external_kbnSharedDeps_React_default.a.createElement(hosts_Hosts,{hostsPagePath:types_hostsPagePath})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:getHostDetailsTabPath(types_hostsPagePath),render:({match:{params:{detailName:detailName}}})=>external_kbnSharedDeps_React_default.a.createElement(HostDetails,{hostDetailsPagePath:types_hostDetailsPagePath,detailName:detailName})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:types_hostDetailsPagePath,render:({match:{params:{detailName:detailName}},location:{search:search=""}})=>{history.replace("".concat(detailName,"/").concat(store_model["HostsTableType"].authentications).concat(search));return null}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,strict:true,path:"",render:({location:{search:search=""}})=>{history.replace("".concat(store_model["HostsTableType"].hosts).concat(search));return null}}))});HostsContainer.displayName="HostsContainer";const HostsRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",render:({match:match})=>external_kbnSharedDeps_React_default.a.createElement(HostsContainer,{url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)}));const HOST_TIMELINE_IDS=[types_timeline["e"].hostsPageEvents,types_timeline["e"].hostsPageExternalAlerts];class public_hosts_Hosts{setup(){}start(storage){return{SubPluginRoutes:HostsRoutes,storageTimelines:{timelineById:Object(local_storage["b"])(storage,HOST_TIMELINE_IDS)},store:{initialState:{hosts:hosts_store["e"]},reducer:{hosts:hosts_store["c"]}}}}}var pages_details=__webpack_require__(677);var web=__webpack_require__(266);var embeddable_public_=__webpack_require__(75);const Panel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"Panel",componentId:"sc-4inzan-0"})(["overflow:hidden;"]);Panel.displayName="Panel";const Embeddable=external_kbnSharedDeps_React_default.a.memo(({children:children})=>external_kbnSharedDeps_React_default.a.createElement("section",{className:"siemEmbeddable"},external_kbnSharedDeps_React_default.a.createElement(Panel,{paddingSize:"none"},children)));Embeddable.displayName="Embeddable";const Header=external_kbnSharedDeps_StyledComponents_default.a.header.attrs(({className:className})=>({className:"siemEmbeddable__header ".concat(className)})).withConfig({displayName:"Header",componentId:"yclxqi-0"})(["border-bottom:",";padding:",";"],({theme:theme})=>theme.eui.euiBorderThin,({theme:theme})=>theme.eui.paddingSizes.m);Header.displayName="Header";const EmbeddableHeader=external_kbnSharedDeps_React_default.a.memo(({children:children,title:title})=>external_kbnSharedDeps_React_default.a.createElement(Header,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("h6",{"data-test-subj":"header-embeddable-title"},title))),children&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"header-embeddable-supplements",grow:false},children))));EmbeddableHeader.displayName="EmbeddableHeader";var minimatch=__webpack_require__(1092);var minimatch_default=__webpack_require__.n(minimatch);const EMBEDDABLE_HEADER_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderTitle",{defaultMessage:"Network map"});const EMBEDDABLE_HEADER_HELP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderHelp",{defaultMessage:"Map configuration help"});const MAP_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddablePanelTitle",{defaultMessage:"Source -> Destination Point-to-Point Map"});const SOURCE_LAYER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.sourceLayerLabel",{defaultMessage:"Source Point"});const DESTINATION_LAYER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.destinationLayerLabel",{defaultMessage:"Destination Point"});const CLIENT_LAYER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.clientLayerLabel",{defaultMessage:"Client Point"});const SERVER_LAYER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.serverLayerLabel",{defaultMessage:"Server Point"});const LINE_LAYER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.lineLayerLabel",{defaultMessage:"Line"});const ERROR_CONFIGURING_EMBEDDABLES_API=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.errorConfiguringEmbeddableApiTitle",{defaultMessage:"Error configuring Embeddables API"});const ERROR_CREATING_EMBEDDABLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.errorCreatingMapEmbeddableTitle",{defaultMessage:"Error creating Map Embeddable"});const ERROR_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorTitle",{defaultMessage:"Required index patterns not configured"});const ERROR_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorButtonLabel",{defaultMessage:"Configure index patterns"});const FILTER_FOR_VALUE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.filterForValueHoverAction",{defaultMessage:"Filter for value"});const MAP_TOOL_TIP_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.errorTitle",{defaultMessage:"Error loading map features"});const MAP_TOOL_TIP_FEATURES_FOOTER=(currentFeature,totalFeatures)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.footerLabel",{values:{currentFeature:currentFeature,totalFeatures:totalFeatures},defaultMessage:"{currentFeature} of {totalFeatures} {totalFeatures, plural, =1 {feature} other {features}}"});const HOST=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.hostTitle",{defaultMessage:"Host"});const SOURCE_IP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceIPTitle",{defaultMessage:"Source IP"});const DESTINATION_IP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationIPTitle",{defaultMessage:"Destination IP"});const CLIENT_IP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientIPTitle",{defaultMessage:"Client IP"});const SERVER_IP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverIPTitle",{defaultMessage:"Server IP"});const SOURCE_DOMAIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceDomainTitle",{defaultMessage:"Source domain"});const DESTINATION_DOMAIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationDomainTitle",{defaultMessage:"Destination domain"});const CLIENT_DOMAIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientDomainTitle",{defaultMessage:"Client domain"});const SERVER_DOMAIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverDomainTitle",{defaultMessage:"Server domain"});const LOCATION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.locationTitle",{defaultMessage:"Location"});const ASN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.asnTitle",{defaultMessage:"ASN"});const SOURCE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.sourceLabel",{defaultMessage:"Source"});const DESTINATION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.destinationLabel",{defaultMessage:"Destination"});const CLIENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.clientLabel",{defaultMessage:"Client"});const SERVER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.serverLabel",{defaultMessage:"Server"});var constants_=__webpack_require__(78);function map_config_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function map_config_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){map_config_ownKeys(Object(source),true).forEach((function(key){map_config_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{map_config_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function map_config_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const euiVisColorPalette=Object(external_kbnSharedDeps_ElasticEui_["euiPaletteColorBlind"])();const sourceFieldMappings={"host.name":HOST,"source.ip":SOURCE_IP,"source.domain":SOURCE_DOMAIN,"source.geo.country_iso_code":LOCATION,"source.as.organization.name":ASN};const destinationFieldMappings={"host.name":HOST,"destination.ip":DESTINATION_IP,"destination.domain":DESTINATION_DOMAIN,"destination.geo.country_iso_code":LOCATION,"destination.as.organization.name":ASN};const clientFieldMappings={"host.name":HOST,"client.ip":CLIENT_IP,"client.domain":CLIENT_DOMAIN,"client.geo.country_iso_code":LOCATION,"client.as.organization.name":ASN};const serverFieldMappings={"host.name":HOST,"server.ip":SERVER_IP,"server.domain":SERVER_DOMAIN,"server.geo.country_iso_code":LOCATION,"server.as.organization.name":ASN};const sourceDestinationFieldMappings=map_config_objectSpread(map_config_objectSpread(map_config_objectSpread(map_config_objectSpread({},sourceFieldMappings),destinationFieldMappings),clientFieldMappings),serverFieldMappings);const SUM_OF_SOURCE_BYTES="sum_of_source.bytes";const SUM_OF_DESTINATION_BYTES="sum_of_destination.bytes";const SUM_OF_CLIENT_BYTES="sum_of_client.bytes";const SUM_OF_SERVER_BYTES="sum_of_server.bytes";const lmc={default:{source:{metricField:"source.bytes",geoField:"source.geo.location",tooltipProperties:Object.keys(sourceFieldMappings),label:SOURCE_LAYER},destination:{metricField:"destination.bytes",geoField:"destination.geo.location",tooltipProperties:Object.keys(destinationFieldMappings),label:DESTINATION_LAYER}},"apm-*":{source:{metricField:"client.bytes",geoField:"client.geo.location",tooltipProperties:Object.keys(clientFieldMappings),label:CLIENT_LAYER},destination:{metricField:"server.bytes",geoField:"server.geo.location",tooltipProperties:Object.keys(serverFieldMappings),label:SERVER_LAYER}}};const getLayerList=indexPatternIds=>[{sourceDescriptor:{type:constants_["SOURCE_TYPES"].EMS_TMS,isAutoSelect:true},id:uuid_default.a.v4(),label:null,minZoom:0,maxZoom:24,alpha:1,visible:true,style:null,type:"VECTOR_TILE"},...indexPatternIds.reduce((acc,{title:title,id:id})=>{var _lmc$title,_lmc$title$destinatio,_lmc$title2,_lmc$title$source,_lmc$title3;return[...acc,getLineLayer(title,id,(_lmc$title=lmc[title])!==null&&_lmc$title!==void 0?_lmc$title:lmc.default),getDestinationLayer(title,id,(_lmc$title$destinatio=(_lmc$title2=lmc[title])===null||_lmc$title2===void 0?void 0:_lmc$title2.destination)!==null&&_lmc$title$destinatio!==void 0?_lmc$title$destinatio:lmc.default.destination),getSourceLayer(title,id,(_lmc$title$source=(_lmc$title3=lmc[title])===null||_lmc$title3===void 0?void 0:_lmc$title3.source)!==null&&_lmc$title$source!==void 0?_lmc$title$source:lmc.default.source)]},[])];const getSourceLayer=(indexPatternTitle,indexPatternId,layerDetails)=>({sourceDescriptor:{id:uuid_default.a.v4(),type:"ES_SEARCH",applyGlobalQuery:true,geoField:layerDetails.geoField,filterByMapBounds:false,tooltipProperties:layerDetails.tooltipProperties,useTopHits:false,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:indexPatternId},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:euiVisColorPalette[1]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"home"}}}},id:uuid_default.a.v4(),label:"".concat(indexPatternTitle," | ").concat(layerDetails.label),minZoom:0,maxZoom:24,alpha:1,visible:true,type:"VECTOR",query:{query:"",language:"kuery"},joins:[]});const getDestinationLayer=(indexPatternTitle,indexPatternId,layerDetails)=>({sourceDescriptor:{id:uuid_default.a.v4(),type:"ES_SEARCH",applyGlobalQuery:true,geoField:layerDetails.geoField,filterByMapBounds:true,tooltipProperties:layerDetails.tooltipProperties,useTopHits:false,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:indexPatternId},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:euiVisColorPalette[2]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"marker"}}}},id:uuid_default.a.v4(),label:"".concat(indexPatternTitle," | ").concat(layerDetails.label),minZoom:0,maxZoom:24,alpha:1,visible:true,type:"VECTOR",query:{query:"",language:"kuery"}});const getLineLayer=(indexPatternTitle,indexPatternId,layerDetails)=>({sourceDescriptor:{type:constants_["SOURCE_TYPES"].ES_PEW_PEW,applyGlobalQuery:true,id:uuid_default.a.v4(),indexPatternId:indexPatternId,sourceGeoField:layerDetails.source.geoField,destGeoField:layerDetails.destination.geoField,metrics:[{type:"sum",field:layerDetails.source.metricField,label:layerDetails.source.metricField},{type:"sum",field:layerDetails.destination.metricField,label:layerDetails.destination.metricField}]},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:"#1EA593"}},lineColor:{type:"STATIC",options:{color:euiVisColorPalette[1]}},lineWidth:{type:"DYNAMIC",options:{field:{label:"count",name:"doc_count",origin:"source"},minSize:1,maxSize:8,fieldMetaOptions:{isEnabled:true,sigma:3}}},iconSize:{type:"STATIC",options:{size:10}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"airfield"}}}},id:uuid_default.a.v4(),label:"".concat(indexPatternTitle," | ").concat(LINE_LAYER),minZoom:0,maxZoom:24,alpha:.5,visible:true,type:"VECTOR",query:{query:"",language:"kuery"}});var maps_public_=__webpack_require__(79);function embedded_map_helpers_extends(){embedded_map_helpers_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return embedded_map_helpers_extends.apply(this,arguments)}function embedded_map_helpers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function embedded_map_helpers_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){embedded_map_helpers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){embedded_map_helpers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const createEmbeddable=function(){var _ref=embedded_map_helpers_asyncToGenerator(regeneratorRuntime.mark((function _callee(filters,indexPatterns,query,startDate,endDate,setQuery,portalNode,embeddableApi){var factory,input,renderTooltipContent,embeddableObject;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:factory=embeddableApi.getEmbeddableFactory(maps_public_["MAP_SAVED_OBJECT_TYPE"]);if(factory){_context.next=3;break}throw new Error("Map embeddable factory undefined");case 3:input={title:MAP_TITLE,attributes:{title:""},id:uuid_default.a.v4(),filters:filters,hidePanelTitles:true,query:query,refreshConfig:{value:0,pause:true},timeRange:{from:new Date(startDate).toISOString(),to:new Date(endDate).toISOString()},viewMode:embeddable_public_["ViewMode"].VIEW,isLayerTOCOpen:false,openTOCDetails:[],hideFilterActions:false,mapCenter:{lon:-1.05469,lat:15.96133,zoom:1},disabledActions:["CUSTOM_TIME_RANGE","CUSTOM_TIME_RANGE_BADGE"]};renderTooltipContent=({addFilters:addFilters,closeTooltip:closeTooltip,features:features,isLocked:isLocked,getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry})=>{const props={addFilters:addFilters,closeTooltip:closeTooltip,features:features,isLocked:isLocked,getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry};return external_kbnSharedDeps_React_default.a.createElement(web["b"],embedded_map_helpers_extends({node:portalNode},props))};_context.next=7;return factory.create(input);case 7:embeddableObject=_context.sent;if(embeddableObject){_context.next=10;break}throw new Error("Map embeddable is undefined");case 10:if(!Object(embeddable_public_["isErrorEmbeddable"])(embeddableObject)){embeddableObject.setRenderTooltipContent(renderTooltipContent);embeddableObject.setLayerList(getLayerList(indexPatterns))}setQuery({id:"embeddedMap",inspect:null,loading:false,refetch:()=>embeddableObject.reload()});return _context.abrupt("return",embeddableObject);case 13:case"end":return _context.stop()}}),_callee)})));return function createEmbeddable(_x,_x2,_x3,_x4,_x5,_x6,_x7,_x8){return _ref.apply(this,arguments)}}();const ignoredIndexPatterns=["*","*:*"];const findMatchingIndexPatterns=({kibanaIndexPatterns:kibanaIndexPatterns,siemDefaultIndices:siemDefaultIndices})=>{try{return kibanaIndexPatterns.filter(kip=>{const pattern=kip.attributes.title;return!ignoredIndexPatterns.includes(pattern)&&siemDefaultIndices.some(sdi=>{var _pattern$split;const splitPattern=(_pattern$split=pattern.split(","))!==null&&_pattern$split!==void 0?_pattern$split:[];return splitPattern.length>1?splitPattern.some(p=>{const isMatch=minimatch_default()(sdi,p);return isMatch&&p.charAt(0)==="-"?false:isMatch}):minimatch_default()(sdi,pattern)})})}catch(_unused){return[]}};const IndexPatternsMissingPromptComponent=()=>{const docLinks=Object(lib_kibana["h"])().services.docLinks;const kibanaBasePath="".concat(Object(lib_kibana["c"])(),"/app");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"gisApp",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,ERROR_TITLE),titleSize:"xs",body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"To display map data, you must define SIEM indices ({defaultIndex}) and Kibana index patterns with matching glob patterns. When using {beats}, you can run the {setup} command on your hosts to automatically create the index patterns. For example: {example}.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription1",values:{defaultIndex:external_kbnSharedDeps_React_default.a.createElement("a",{href:"".concat(kibanaBasePath,"/management/kibana/settings"),rel:"noopener noreferrer",target:"_blank"},"securitySolution:defaultIndex"),beats:external_kbnSharedDeps_React_default.a.createElement("a",{href:"".concat(docLinks.ELASTIC_WEBSITE_URL,"guide/en/beats/libbeat/").concat(docLinks.DOC_LINK_VERSION,"/getting-started.html"),rel:"noopener noreferrer",target:"_blank"},"beats"),setup:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"setup"),example:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"./packetbeat setup")}})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"You can also configure index patterns manually in Kibana.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription2"}))),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{href:"".concat(kibanaBasePath,"/management/kibana/indexPatterns"),color:"primary",target:"_blank",fill:true},ERROR_BUTTON)})};IndexPatternsMissingPromptComponent.displayName="IndexPatternsMissingPromptComponent";const IndexPatternsMissingPrompt=external_kbnSharedDeps_React_default.a.memo(IndexPatternsMissingPromptComponent);IndexPatternsMissingPrompt.displayName="IndexPatternsMissingPrompt";const Icon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiIcon"]).withConfig({displayName:"Icon",componentId:"s0r863-0"})(["margin-right:",";"],external_kbnSharedDeps_Theme_euiLightVars_default.a.euiSizeS);Icon.displayName="Icon";const ToolTipFooterComponent=({featureIndex:featureIndex,totalFeatures:totalFeatures,previousFeature:previousFeature,nextFeature:nextFeature})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},MAP_TOOL_TIP_FEATURES_FOOTER(featureIndex+1,totalFeatures))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"previous-feature-button",color:"text",onClick:previousFeature,iconType:"arrowLeft","aria-label":"Next",disabled:featureIndex<=0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"next-feature-button",color:"text",onClick:nextFeature,iconType:"arrowRight","aria-label":"Next",disabled:featureIndex>=totalFeatures-1})))));ToolTipFooterComponent.displayName="ToolTipFooterComponent";const ToolTipFooter=external_kbnSharedDeps_React_default.a.memo(ToolTipFooterComponent);ToolTipFooter.displayName="ToolTipFooter";var source_destination_arrows=__webpack_require__(351);function line_tool_tip_content_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function line_tool_tip_content_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){line_tool_tip_content_ownKeys(Object(source),true).forEach((function(key){line_tool_tip_content_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{line_tool_tip_content_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function line_tool_tip_content_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const FlowBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBadge"]).withConfig({displayName:"FlowBadge",componentId:"sc-120vo88-0"})(["height:45px;min-width:85px;"]);const EuiFlexGroupStyled=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-120vo88-1"})(["margin:0 auto;"]);const LineToolTipContentComponent=({contextId:contextId,featureProps:featureProps})=>{const lineProps=featureProps.reduce((acc,f)=>{var _f$getRawValue;const rawValue=(_f$getRawValue=f.getRawValue())!==null&&_f$getRawValue!==void 0?_f$getRawValue:[];return line_tool_tip_content_objectSpread(line_tool_tip_content_objectSpread({},acc),{[f.getPropertyKey()]:Array.isArray(rawValue)?rawValue:[rawValue]})},{});const isSrcDest=Object.keys(lineProps).includes(SUM_OF_SOURCE_BYTES);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(FlowBadge,{color:"hollow"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexGroupStyled,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},isSrcDest?SOURCE:CLIENT)))),external_kbnSharedDeps_React_default.a.createElement(source_destination_arrows["e"],{contextId:contextId,destinationBytes:isSrcDest?lineProps[SUM_OF_DESTINATION_BYTES]:lineProps[SUM_OF_SERVER_BYTES],eventId:"map-line-tooltip-".concat(contextId),sourceBytes:isSrcDest?lineProps[SUM_OF_SOURCE_BYTES]:lineProps[SUM_OF_CLIENT_BYTES]}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(FlowBadge,{color:"hollow"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexGroupStyled,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},isSrcDest?DESTINATION:SERVER)))))};LineToolTipContentComponent.displayName="LineToolTipContentComponent";const LineToolTipContent=external_kbnSharedDeps_React_default.a.memo(LineToolTipContentComponent);LineToolTipContent.displayName="LineToolTipContent";const PointToolTipContentComponent=({contextId:contextId,featureProps:featureProps})=>{const featureDescriptionListItems=Object(external_kbnSharedDeps_React_["useMemo"])(()=>featureProps.map(featureProp=>{var _featureProp$getRawVa;const key=featureProp.getPropertyKey();const value=(_featureProp$getRawVa=featureProp.getRawValue())!==null&&_featureProp$getRawVa!==void 0?_featureProp$getRawVa:[];return{title:sourceDestinationFieldMappings[key],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value!=null?external_kbnSharedDeps_React_default.a.createElement(field_renderers["b"],{rowItems:Array.isArray(value)?value:[value],attrName:key,idPrefix:"map-point-tooltip-".concat(contextId,"-").concat(key,"-").concat(value),render:item=>getRenderedFieldValue(key,item)}):Object(empty_value["d"])())}}),[contextId,featureProps]);return external_kbnSharedDeps_React_default.a.createElement(page["d"],{listItems:featureDescriptionListItems})};PointToolTipContentComponent.displayName="PointToolTipContentComponent";const PointToolTipContent=external_kbnSharedDeps_React_default.a.memo(PointToolTipContentComponent);PointToolTipContent.displayName="PointToolTipContent";const getRenderedFieldValue=(field,value)=>{if(value===""){return Object(empty_value["f"])(value)}else if(["host.name"].includes(field)){return external_kbnSharedDeps_React_default.a.createElement(links["d"],{hostName:value})}else if(["source.ip","destination.ip"].includes(field)){const flowTarget=field.split(".")[0];return external_kbnSharedDeps_React_default.a.createElement(links["h"],{ip:value,flowTarget:flowTarget})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value)};function map_tool_tip_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function map_tool_tip_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){map_tool_tip_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){map_tool_tip_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function map_tool_tip_slicedToArray(arr,i){return map_tool_tip_arrayWithHoles(arr)||map_tool_tip_iterableToArrayLimit(arr,i)||map_tool_tip_unsupportedIterableToArray(arr,i)||map_tool_tip_nonIterableRest()}function map_tool_tip_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function map_tool_tip_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return map_tool_tip_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return map_tool_tip_arrayLikeToArray(o,minLen)}function map_tool_tip_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function map_tool_tip_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function map_tool_tip_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const MapToolTipComponent=({closeTooltip:closeTooltip,features:features=[],getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=map_tool_tip_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=map_tool_tip_slicedToArray(_useState3,2),isLoadingNextFeature=_useState4[0],setIsLoadingNextFeature=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=map_tool_tip_slicedToArray(_useState5,2),isError=_useState6[0],setIsError=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(0),_useState8=map_tool_tip_slicedToArray(_useState7,2),featureIndex=_useState8[0],setFeatureIndex=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])([]),_useState10=map_tool_tip_slicedToArray(_useState9,2),featureProps=_useState10[0],setFeatureProps=_useState10[1];const _useState11=Object(external_kbnSharedDeps_React_["useState"])(null),_useState12=map_tool_tip_slicedToArray(_useState11,2),featureGeometry=_useState12[0],setFeatureGeometry=_useState12[1];const _useState13=Object(external_kbnSharedDeps_React_["useState"])(""),_useState14=map_tool_tip_slicedToArray(_useState13,2),setLayerName=_useState14[1];const handleCloseTooltip=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(closeTooltip!=null){closeTooltip();setFeatureIndex(0)}},[closeTooltip]);const handlePreviousFeature=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setFeatureIndex(prevFeatureIndex=>prevFeatureIndex-1);setIsLoadingNextFeature(true)},[]);const handleNextFeature=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setFeatureIndex(prevFeatureIndex=>prevFeatureIndex+1);setIsLoadingNextFeature(true)},[]);const content=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(isError){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},MAP_TOOL_TIP_ERROR))}if(isLoading&&!isLoadingNextFeature){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})))}return external_kbnSharedDeps_React_default.a.createElement("div",null,featureGeometry!=null&&featureGeometry.type==="LineString"?external_kbnSharedDeps_React_default.a.createElement(LineToolTipContent,{contextId:"".concat(features[featureIndex].layerId,"-").concat(features[featureIndex].id,"-").concat(featureIndex),featureProps:featureProps}):external_kbnSharedDeps_React_default.a.createElement(PointToolTipContent,{contextId:"".concat(features[featureIndex].layerId,"-").concat(features[featureIndex].id,"-").concat(featureIndex),featureProps:featureProps}),features.length>1&&external_kbnSharedDeps_React_default.a.createElement(ToolTipFooter,{featureIndex:featureIndex,totalFeatures:features.length,previousFeature:handlePreviousFeature,nextFeature:handleNextFeature}),isLoadingNextFeature&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loading-panel",overlay:true,size:"m"}))},[featureGeometry,featureIndex,featureProps,features,handleNextFeature,handlePreviousFeature,isError,isLoading,isLoadingNextFeature]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(features.length===0||getLayerName==null||loadFeatureProperties==null||loadFeatureGeometry==null){return}if(!isLoadingNextFeature){setIsLoading(true)}setIsError(false);const fetchFeatureProps=function(){var _ref=map_tool_tip_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var layerId,featureId,featureGeo,_yield$Promise$all,_yield$Promise$all2,featureProperties,layerNameString;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(features[featureIndex]!=null)){_context.next=23;break}layerId=features[featureIndex].layerId;featureId=features[featureIndex].id;_context.prev=3;featureGeo=loadFeatureGeometry({layerId:layerId,featureId:featureId});_context.next=7;return Promise.all([loadFeatureProperties({layerId:layerId,featureId:featureId}),getLayerName(layerId)]);case 7:_yield$Promise$all=_context.sent;_yield$Promise$all2=map_tool_tip_slicedToArray(_yield$Promise$all,2);featureProperties=_yield$Promise$all2[0];layerNameString=_yield$Promise$all2[1];setFeatureProps(featureProperties);setFeatureGeometry(featureGeo);setLayerName(layerNameString);_context.next=19;break;case 16:_context.prev=16;_context.t0=_context["catch"](3);setIsError(true);case 19:_context.prev=19;setIsLoading(false);setIsLoadingNextFeature(false);return _context.finish(19);case 23:case"end":return _context.stop()}}),_callee,null,[[3,16,19,23]])})));return function fetchFeatureProps(){return _ref.apply(this,arguments)}}();fetchFeatureProps()},[featureIndex,features,getLayerName,isLoadingNextFeature,loadFeatureGeometry,loadFeatureProperties]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOutsideClickDetector"],{onOutsideClick:handleCloseTooltip},content)};MapToolTipComponent.displayName="MapToolTipComponent";const MapToolTip=external_kbnSharedDeps_React_default.a.memo(MapToolTipComponent);MapToolTip.displayName="MapToolTip";var store_sourcerer=__webpack_require__(117);const getDefaultSourcererSelector=()=>{const getKibanaIndexPatternsSelector=store_sourcerer["d"].kibanaIndexPatternsSelector();const getScopesSelector=store_sourcerer["d"].scopesSelector();const mapStateToProps=state=>{const kibanaIndexPatterns=getKibanaIndexPatternsSelector(state);const scope=getScopesSelector(state)[model["SourcererScopeName"].default];return{kibanaIndexPatterns:kibanaIndexPatterns,sourcererScope:scope}};return mapStateToProps};function embedded_map_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function embedded_map_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){embedded_map_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){embedded_map_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function embedded_map_slicedToArray(arr,i){return embedded_map_arrayWithHoles(arr)||embedded_map_iterableToArrayLimit(arr,i)||embedded_map_unsupportedIterableToArray(arr,i)||embedded_map_nonIterableRest()}function embedded_map_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function embedded_map_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return embedded_map_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return embedded_map_arrayLikeToArray(o,minLen)}function embedded_map_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function embedded_map_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function embedded_map_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const EmbeddableMap=external_kbnSharedDeps_StyledComponents_default.a.div.attrs(()=>({className:"siemEmbeddable__map"})).withConfig({displayName:"EmbeddableMap",componentId:"sc-1t0ky4k-0"})([".embPanel{border:none;box-shadow:none;}.mapToolbarOverlay__button{display:none;}",""],({maintainRatio:maintainRatio})=>maintainRatio&&Object(external_kbnSharedDeps_StyledComponents_["css"])(["padding-top:calc(3 / 4 * 100%);position:relative;@media only screen and (min-width:","){padding-top:calc(9 / 32 * 100%);}@media only screen and (min-width:1441px) and (min-height:901px){padding-top:calc(9 / 21 * 100%);}.embPanel{bottom:0;left:0;position:absolute;right:0;top:0;}"],({theme:theme})=>theme.eui.euiBreakpoints.m));EmbeddableMap.displayName="EmbeddableMap";const EmbeddedMapComponent=({endDate:endDate,filters:filters,query:query,setQuery:setQuery,startDate:startDate})=>{const _React$useState=external_kbnSharedDeps_React_default.a.useState(undefined),_React$useState2=embedded_map_slicedToArray(_React$useState,2),embeddable=_React$useState2[0],setEmbeddable=_React$useState2[1];const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=embedded_map_slicedToArray(_useState,2),isError=_useState2[0],setIsError=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=embedded_map_slicedToArray(_useState3,2),isIndexError=_useState4[0],setIsIndexError=_useState4[1];const _useStateToaster=Object(toasters["h"])(),_useStateToaster2=embedded_map_slicedToArray(_useStateToaster,2),dispatchToaster=_useStateToaster2[1];const defaultSourcererScopeSelector=Object(external_kbnSharedDeps_React_["useMemo"])(getDefaultSourcererSelector,[]);const _useSelector=Object(react_redux_lib["useSelector"])(defaultSourcererScopeSelector,fast_deep_equal_default.a),kibanaIndexPatterns=_useSelector.kibanaIndexPatterns,sourcererScope=_useSelector.sourcererScope;const _useState5=Object(external_kbnSharedDeps_React_["useState"])(kibanaIndexPatterns.filter(kip=>sourcererScope.selectedPatterns.includes(kip.title))),_useState6=embedded_map_slicedToArray(_useState5,2),mapIndexPatterns=_useState6[0],setMapIndexPatterns=_useState6[1];const portalNode=external_kbnSharedDeps_React_default.a.useMemo(()=>Object(web["c"])(),[]);const _useKibana=Object(lib_kibana["h"])(),services=_useKibana.services;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setMapIndexPatterns(prevMapIndexPatterns=>{const newIndexPatterns=kibanaIndexPatterns.filter(kip=>sourcererScope.selectedPatterns.includes(kip.title));if(!fast_deep_equal_default()(newIndexPatterns,prevMapIndexPatterns)){if(newIndexPatterns.length===0){setIsError(true)}return newIndexPatterns}return prevMapIndexPatterns})},[kibanaIndexPatterns,sourcererScope.selectedPatterns]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;function setupEmbeddable(){return _setupEmbeddable.apply(this,arguments)}function _setupEmbeddable(){_setupEmbeddable=embedded_map_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var embeddableObject;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return createEmbeddable(filters,mapIndexPatterns,query,startDate,endDate,setQuery,portalNode,services.embeddable);case 3:embeddableObject=_context.sent;if(isSubscribed){if(mapIndexPatterns.length===0){setIsIndexError(true)}else{setEmbeddable(embeddableObject);setIsIndexError(false)}}_context.next=10;break;case 7:_context.prev=7;_context.t0=_context["catch"](0);if(isSubscribed){Object(toasters["d"])(ERROR_CREATING_EMBEDDABLE,[_context.t0.message],dispatchToaster);setIsError(true)}case 10:case"end":return _context.stop()}}),_callee,null,[[0,7]])})));return _setupEmbeddable.apply(this,arguments)}if(embeddable==null&&sourcererScope.selectedPatterns.length>0){setupEmbeddable()}return()=>{isSubscribed=false}},[dispatchToaster,endDate,embeddable,filters,mapIndexPatterns,query,portalNode,services.embeddable,sourcererScope.selectedPatterns,setQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const setLayerList=function(){var _ref=embedded_map_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!(embeddable!=null)){_context2.next=4;break}_context2.next=3;return embeddable.setLayerList(getLayerList(mapIndexPatterns));case 3:embeddable.reload();case 4:case"end":return _context2.stop()}}),_callee2)})));return function setLayerList(){return _ref.apply(this,arguments)}}();if(embeddable!=null&&!Object(embeddable_public_["isErrorEmbeddable"])(embeddable)){setLayerList()}},[embeddable,mapIndexPatterns]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(embeddable!=null){embeddable.updateInput({query:query})}},[embeddable,query]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(embeddable!=null){embeddable.updateInput({filters:filters})}},[embeddable,filters]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(embeddable!=null&&startDate!=null&&endDate!=null){const timeRange={from:new Date(startDate).toISOString(),to:new Date(endDate).toISOString()};embeddable.updateInput({timeRange:timeRange})}},[embeddable,startDate,endDate]);return isError?null:external_kbnSharedDeps_React_default.a.createElement(Embeddable,null,external_kbnSharedDeps_React_default.a.createElement(EmbeddableHeader,{title:EMBEDDABLE_HEADER_TITLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"".concat(services.docLinks.ELASTIC_WEBSITE_URL,"guide/en/security/").concat(services.docLinks.DOC_LINK_VERSION,"/conf-map-ui.html"),target:"_blank"},EMBEDDABLE_HEADER_HELP))),external_kbnSharedDeps_React_default.a.createElement(web["a"],{node:portalNode},external_kbnSharedDeps_React_default.a.createElement(MapToolTip,null)),external_kbnSharedDeps_React_default.a.createElement(EmbeddableMap,{maintainRatio:!isIndexError},isIndexError?external_kbnSharedDeps_React_default.a.createElement(IndexPatternsMissingPrompt,{"data-test-subj":"missing-prompt"}):embeddable!=null?external_kbnSharedDeps_React_default.a.createElement(services.embeddable.EmbeddablePanel,{embeddable:embeddable}):external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loading-panel",overlay:true,size:"xl"})))};EmbeddedMapComponent.displayName="EmbeddedMapComponent";const EmbeddedMap=external_kbnSharedDeps_React_default.a.memo(EmbeddedMapComponent);EmbeddedMap.displayName="EmbeddedMap";const ERROR_NETWORK_KPI_DNS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiDns.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi dns search"});const FAIL_NETWORK_KPI_DNS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiDns.failSearchDescription",{defaultMessage:"Failed to run search on network kpi dns"});function dns_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function dns_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){dns_ownKeys(Object(source),true).forEach((function(key){dns_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{dns_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function dns_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function dns_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function dns_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){dns_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){dns_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function dns_slicedToArray(arr,i){return dns_arrayWithHoles(arr)||dns_iterableToArrayLimit(arr,i)||dns_unsupportedIterableToArray(arr,i)||dns_nonIterableRest()}function dns_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dns_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return dns_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dns_arrayLikeToArray(o,minLen)}function dns_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function dns_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function dns_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const dns_ID="networkKpiDnsQuery";const useNetworkKpiDns=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=dns_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].dns,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}}:null),_useState4=dns_slicedToArray(_useState3,2),networkKpiDnsRequest=_useState4[0],setNetworkKpiDnsRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({dnsQueries:0,id:dns_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current}),_useState6=dns_slicedToArray(_useState5,2),networkKpiDnsResponse=_useState6[0],setNetworkKpiDnsResponse=_useState6[1];const networkKpiDnsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=dns_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){if(!didCancel){setLoading(false);setNetworkKpiDnsResponse(prevResponse=>dns_objectSpread(dns_objectSpread({},prevResponse),{},{dnsQueries:response.dnsQueries,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}))}searchSubscription$.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_NETWORK_KPI_DNS);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_NETWORK_KPI_DNS,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkKpiDnsRequest(prevRequest=>{const myRequest=dns_objectSpread(dns_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].dns,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkKpiDnsSearch(networkKpiDnsRequest)},[networkKpiDnsRequest,networkKpiDnsSearch]);return[loading,networkKpiDnsResponse]};const common_kpiWidgetHeight=228;const kpi_network_common_FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroup",componentId:"sc-1sakt4o-0"})(["min-height:","px;"],common_kpiWidgetHeight);kpi_network_common_FlexGroup.displayName="FlexGroup";const NetworkKpiBaseComponent=external_kbnSharedDeps_React_default.a.memo(({fieldsMapping:fieldsMapping,data:data,id:id,loading:loading=false,from:from,to:to,narrowDateRange:narrowDateRange})=>{const statItemsProps=useKpiMatrixStatus(fieldsMapping,data,id,from,to,narrowDateRange);if(loading){return external_kbnSharedDeps_React_default.a.createElement(kpi_network_common_FlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"xl"})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},statItemsProps.map(mappedStatItemProps=>external_kbnSharedDeps_React_default.a.createElement(StatItemsComponent,mappedStatItemProps)))});NetworkKpiBaseComponent.displayName="NetworkKpiBaseComponent";const NetworkKpiBaseComponentManage=Object(manage_query["a"])(NetworkKpiBaseComponent);const DNS_QUERIES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.dnsQueries.title",{defaultMessage:"DNS queries"});function dns_objectWithoutProperties(source,excluded){if(source==null)return{};var target=dns_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function dns_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function kpi_network_dns_slicedToArray(arr,i){return kpi_network_dns_arrayWithHoles(arr)||kpi_network_dns_iterableToArrayLimit(arr,i)||kpi_network_dns_unsupportedIterableToArray(arr,i)||kpi_network_dns_nonIterableRest()}function kpi_network_dns_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kpi_network_dns_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return kpi_network_dns_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kpi_network_dns_arrayLikeToArray(o,minLen)}function kpi_network_dns_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function kpi_network_dns_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function kpi_network_dns_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const dns_fieldsMapping=[{key:"dnsQueries",fields:[{key:"dnsQueries",value:null}],description:DNS_QUERIES}];const NetworkKpiDnsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const _useNetworkKpiDns=useNetworkKpiDns({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip}),_useNetworkKpiDns2=kpi_network_dns_slicedToArray(_useNetworkKpiDns,2),loading=_useNetworkKpiDns2[0],_useNetworkKpiDns2$=_useNetworkKpiDns2[1],refetch=_useNetworkKpiDns2$.refetch,id=_useNetworkKpiDns2$.id,inspect=_useNetworkKpiDns2$.inspect,data=dns_objectWithoutProperties(_useNetworkKpiDns2$,["refetch","id","inspect"]);return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:dns_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const NetworkKpiDns=external_kbnSharedDeps_React_default.a.memo(NetworkKpiDnsComponent);const ERROR_NETWORK_KPI_NETWORK_EVENTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiNetworkEvents.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi network events search"});const FAIL_NETWORK_KPI_NETWORK_EVENTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiNetworkEvents.failSearchDescription",{defaultMessage:"Failed to run search on network kpi network events"});function network_events_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function network_events_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){network_events_ownKeys(Object(source),true).forEach((function(key){network_events_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{network_events_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function network_events_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function network_events_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function network_events_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){network_events_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){network_events_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function network_events_slicedToArray(arr,i){return network_events_arrayWithHoles(arr)||network_events_iterableToArrayLimit(arr,i)||network_events_unsupportedIterableToArray(arr,i)||network_events_nonIterableRest()}function network_events_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function network_events_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return network_events_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return network_events_arrayLikeToArray(o,minLen)}function network_events_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function network_events_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function network_events_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const network_events_ID="networkKpiNetworkEventsQuery";const useNetworkKpiNetworkEvents=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=network_events_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].networkEvents,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}}:null),_useState4=network_events_slicedToArray(_useState3,2),networkKpiNetworkEventsRequest=_useState4[0],setNetworkKpiNetworkEventsRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({networkEvents:0,id:network_events_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current}),_useState6=network_events_slicedToArray(_useState5,2),networkKpiNetworkEventsResponse=_useState6[0],setNetworkKpiNetworkEventsResponse=_useState6[1];const networkKpiNetworkEventsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=network_events_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){if(!didCancel){setLoading(false);setNetworkKpiNetworkEventsResponse(prevResponse=>network_events_objectSpread(network_events_objectSpread({},prevResponse),{},{networkEvents:response.networkEvents,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}))}searchSubscription$.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_NETWORK_KPI_NETWORK_EVENTS);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_NETWORK_KPI_NETWORK_EVENTS,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkKpiNetworkEventsRequest(prevRequest=>{const myRequest=network_events_objectSpread(network_events_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].networkEvents,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkKpiNetworkEventsSearch(networkKpiNetworkEventsRequest)},[networkKpiNetworkEventsRequest,networkKpiNetworkEventsSearch]);return[loading,networkKpiNetworkEventsResponse]};const NETWORK_EVENTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.networkEvents.title",{defaultMessage:"Network events"});function network_events_objectWithoutProperties(source,excluded){if(source==null)return{};var target=network_events_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function network_events_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function kpi_network_network_events_slicedToArray(arr,i){return kpi_network_network_events_arrayWithHoles(arr)||kpi_network_network_events_iterableToArrayLimit(arr,i)||kpi_network_network_events_unsupportedIterableToArray(arr,i)||kpi_network_network_events_nonIterableRest()}function kpi_network_network_events_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kpi_network_network_events_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return kpi_network_network_events_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kpi_network_network_events_arrayLikeToArray(o,minLen)}function kpi_network_network_events_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function kpi_network_network_events_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function kpi_network_network_events_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const network_events_euiVisColorPalette=Object(external_kbnSharedDeps_ElasticEui_["euiPaletteColorBlind"])();const euiColorVis1=network_events_euiVisColorPalette[1];const network_events_fieldsMapping=[{key:"networkEvents",fields:[{key:"networkEvents",value:null,color:euiColorVis1}],description:NETWORK_EVENTS}];const NetworkKpiNetworkEventsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const _useNetworkKpiNetwork=useNetworkKpiNetworkEvents({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip}),_useNetworkKpiNetwork2=kpi_network_network_events_slicedToArray(_useNetworkKpiNetwork,2),loading=_useNetworkKpiNetwork2[0],_useNetworkKpiNetwork3=_useNetworkKpiNetwork2[1],refetch=_useNetworkKpiNetwork3.refetch,id=_useNetworkKpiNetwork3.id,inspect=_useNetworkKpiNetwork3.inspect,data=network_events_objectWithoutProperties(_useNetworkKpiNetwork3,["refetch","id","inspect"]);return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:network_events_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const NetworkKpiNetworkEvents=external_kbnSharedDeps_React_default.a.memo(NetworkKpiNetworkEventsComponent);const ERROR_NETWORK_KPI_TLS_HANDSHAKES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiTlsHandshakes.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi tls handshakes search"});const FAIL_NETWORK_KPI_TLS_HANDSHAKES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiTlsHandshakes.failSearchDescription",{defaultMessage:"Failed to run search on network kpi tls handshakes"});function tls_handshakes_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function tls_handshakes_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){tls_handshakes_ownKeys(Object(source),true).forEach((function(key){tls_handshakes_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{tls_handshakes_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function tls_handshakes_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function tls_handshakes_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function tls_handshakes_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){tls_handshakes_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){tls_handshakes_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function tls_handshakes_slicedToArray(arr,i){return tls_handshakes_arrayWithHoles(arr)||tls_handshakes_iterableToArrayLimit(arr,i)||tls_handshakes_unsupportedIterableToArray(arr,i)||tls_handshakes_nonIterableRest()}function tls_handshakes_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tls_handshakes_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return tls_handshakes_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tls_handshakes_arrayLikeToArray(o,minLen)}function tls_handshakes_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function tls_handshakes_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function tls_handshakes_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const tls_handshakes_ID="networkKpiTlsHandshakesQuery";const useNetworkKpiTlsHandshakes=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=tls_handshakes_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].tlsHandshakes,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}}:null),_useState4=tls_handshakes_slicedToArray(_useState3,2),networkKpiTlsHandshakesRequest=_useState4[0],setNetworkKpiTlsHandshakesRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({tlsHandshakes:0,id:tls_handshakes_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current}),_useState6=tls_handshakes_slicedToArray(_useState5,2),networkKpiTlsHandshakesResponse=_useState6[0],setNetworkKpiTlsHandshakesResponse=_useState6[1];const networkKpiTlsHandshakesSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=tls_handshakes_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){if(!didCancel){setLoading(false);setNetworkKpiTlsHandshakesResponse(prevResponse=>tls_handshakes_objectSpread(tls_handshakes_objectSpread({},prevResponse),{},{tlsHandshakes:response.tlsHandshakes,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}))}searchSubscription$.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_NETWORK_KPI_TLS_HANDSHAKES);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_NETWORK_KPI_TLS_HANDSHAKES,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkKpiTlsHandshakesRequest(prevRequest=>{const myRequest=tls_handshakes_objectSpread(tls_handshakes_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].tlsHandshakes,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkKpiTlsHandshakesSearch(networkKpiTlsHandshakesRequest)},[networkKpiTlsHandshakesRequest,networkKpiTlsHandshakesSearch]);return[loading,networkKpiTlsHandshakesResponse]};const TLS_HANDSHAKES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.tlsHandshakes.title",{defaultMessage:"TLS handshakes"});function tls_handshakes_objectWithoutProperties(source,excluded){if(source==null)return{};var target=tls_handshakes_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function tls_handshakes_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function kpi_network_tls_handshakes_slicedToArray(arr,i){return kpi_network_tls_handshakes_arrayWithHoles(arr)||kpi_network_tls_handshakes_iterableToArrayLimit(arr,i)||kpi_network_tls_handshakes_unsupportedIterableToArray(arr,i)||kpi_network_tls_handshakes_nonIterableRest()}function kpi_network_tls_handshakes_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kpi_network_tls_handshakes_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return kpi_network_tls_handshakes_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kpi_network_tls_handshakes_arrayLikeToArray(o,minLen)}function kpi_network_tls_handshakes_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function kpi_network_tls_handshakes_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function kpi_network_tls_handshakes_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const tls_handshakes_fieldsMapping=[{key:"tlsHandshakes",fields:[{key:"tlsHandshakes",value:null}],description:TLS_HANDSHAKES}];const NetworkKpiTlsHandshakesComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const _useNetworkKpiTlsHand=useNetworkKpiTlsHandshakes({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip}),_useNetworkKpiTlsHand2=kpi_network_tls_handshakes_slicedToArray(_useNetworkKpiTlsHand,2),loading=_useNetworkKpiTlsHand2[0],_useNetworkKpiTlsHand3=_useNetworkKpiTlsHand2[1],refetch=_useNetworkKpiTlsHand3.refetch,id=_useNetworkKpiTlsHand3.id,inspect=_useNetworkKpiTlsHand3.inspect,data=tls_handshakes_objectWithoutProperties(_useNetworkKpiTlsHand3,["refetch","id","inspect"]);return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:tls_handshakes_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const NetworkKpiTlsHandshakes=external_kbnSharedDeps_React_default.a.memo(NetworkKpiTlsHandshakesComponent);const ERROR_NETWORK_KPI_UNIQUE_FLOWS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiUniqueFlows.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique flows search"});const FAIL_NETWORK_KPI_UNIQUE_FLOWS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiUniqueFlows.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique flows"});function unique_flows_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function unique_flows_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){unique_flows_ownKeys(Object(source),true).forEach((function(key){unique_flows_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{unique_flows_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function unique_flows_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function unique_flows_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function unique_flows_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){unique_flows_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){unique_flows_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function unique_flows_slicedToArray(arr,i){return unique_flows_arrayWithHoles(arr)||unique_flows_iterableToArrayLimit(arr,i)||unique_flows_unsupportedIterableToArray(arr,i)||unique_flows_nonIterableRest()}function unique_flows_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function unique_flows_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return unique_flows_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return unique_flows_arrayLikeToArray(o,minLen)}function unique_flows_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function unique_flows_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function unique_flows_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const unique_flows_ID="networkKpiUniqueFlowsQuery";const useNetworkKpiUniqueFlows=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=unique_flows_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].uniqueFlows,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}}:null),_useState4=unique_flows_slicedToArray(_useState3,2),networkKpiUniqueFlowsRequest=_useState4[0],setNetworkKpiUniqueFlowsRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({uniqueFlowId:0,id:unique_flows_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current}),_useState6=unique_flows_slicedToArray(_useState5,2),networkKpiUniqueFlowsResponse=_useState6[0],setNetworkKpiUniqueFlowsResponse=_useState6[1];const networkKpiUniqueFlowsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=unique_flows_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){if(!didCancel){setLoading(false);setNetworkKpiUniqueFlowsResponse(prevResponse=>unique_flows_objectSpread(unique_flows_objectSpread({},prevResponse),{},{uniqueFlowId:response.uniqueFlowId,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}))}searchSubscription$.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_NETWORK_KPI_UNIQUE_FLOWS);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_NETWORK_KPI_UNIQUE_FLOWS,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkKpiUniqueFlowsRequest(prevRequest=>{const myRequest=unique_flows_objectSpread(unique_flows_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].uniqueFlows,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkKpiUniqueFlowsSearch(networkKpiUniqueFlowsRequest)},[networkKpiUniqueFlowsRequest,networkKpiUniqueFlowsSearch]);return[loading,networkKpiUniqueFlowsResponse]};const UNIQUE_FLOW_IDS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniqueFlowIds.title",{defaultMessage:"Unique flow IDs"});function unique_flows_objectWithoutProperties(source,excluded){if(source==null)return{};var target=unique_flows_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function unique_flows_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function kpi_network_unique_flows_slicedToArray(arr,i){return kpi_network_unique_flows_arrayWithHoles(arr)||kpi_network_unique_flows_iterableToArrayLimit(arr,i)||kpi_network_unique_flows_unsupportedIterableToArray(arr,i)||kpi_network_unique_flows_nonIterableRest()}function kpi_network_unique_flows_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kpi_network_unique_flows_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return kpi_network_unique_flows_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kpi_network_unique_flows_arrayLikeToArray(o,minLen)}function kpi_network_unique_flows_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function kpi_network_unique_flows_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function kpi_network_unique_flows_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const unique_flows_fieldsMapping=[{key:"uniqueFlowId",fields:[{key:"uniqueFlowId",value:null}],description:UNIQUE_FLOW_IDS}];const NetworkKpiUniqueFlowsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const _useNetworkKpiUniqueF=useNetworkKpiUniqueFlows({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip}),_useNetworkKpiUniqueF2=kpi_network_unique_flows_slicedToArray(_useNetworkKpiUniqueF,2),loading=_useNetworkKpiUniqueF2[0],_useNetworkKpiUniqueF3=_useNetworkKpiUniqueF2[1],refetch=_useNetworkKpiUniqueF3.refetch,id=_useNetworkKpiUniqueF3.id,inspect=_useNetworkKpiUniqueF3.inspect,data=unique_flows_objectWithoutProperties(_useNetworkKpiUniqueF3,["refetch","id","inspect"]);return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:unique_flows_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const NetworkKpiUniqueFlows=external_kbnSharedDeps_React_default.a.memo(NetworkKpiUniqueFlowsComponent);const ERROR_NETWORK_KPI_UNIQUE_PRIVATE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiUniquePrivateIps.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique private ips search"});const FAIL_NETWORK_KPI_UNIQUE_PRIVATE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiUniquePrivateIps.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique private ips"});function unique_private_ips_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function unique_private_ips_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){unique_private_ips_ownKeys(Object(source),true).forEach((function(key){unique_private_ips_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{unique_private_ips_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function unique_private_ips_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function unique_private_ips_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function unique_private_ips_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){unique_private_ips_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){unique_private_ips_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function unique_private_ips_slicedToArray(arr,i){return unique_private_ips_arrayWithHoles(arr)||unique_private_ips_iterableToArrayLimit(arr,i)||unique_private_ips_unsupportedIterableToArray(arr,i)||unique_private_ips_nonIterableRest()}function unique_private_ips_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function unique_private_ips_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return unique_private_ips_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return unique_private_ips_arrayLikeToArray(o,minLen)}function unique_private_ips_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function unique_private_ips_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function unique_private_ips_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const unique_private_ips_ID="networkKpiUniquePrivateIpsQuery";const useNetworkKpiUniquePrivateIps=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=unique_private_ips_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].uniquePrivateIps,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}}:null),_useState4=unique_private_ips_slicedToArray(_useState3,2),networkKpiUniquePrivateIpsRequest=_useState4[0],setNetworkKpiUniquePrivateIpsRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({uniqueDestinationPrivateIps:0,uniqueDestinationPrivateIpsHistogram:null,uniqueSourcePrivateIps:0,uniqueSourcePrivateIpsHistogram:null,id:unique_private_ips_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current}),_useState6=unique_private_ips_slicedToArray(_useState5,2),networkKpiUniquePrivateIpsResponse=_useState6[0],setNetworkKpiUniquePrivateIpsResponse=_useState6[1];const networkKpiUniquePrivateIpsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=unique_private_ips_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){if(!didCancel){setLoading(false);setNetworkKpiUniquePrivateIpsResponse(prevResponse=>unique_private_ips_objectSpread(unique_private_ips_objectSpread({},prevResponse),{},{uniqueDestinationPrivateIps:response.uniqueDestinationPrivateIps,uniqueDestinationPrivateIpsHistogram:response.uniqueDestinationPrivateIpsHistogram,uniqueSourcePrivateIps:response.uniqueSourcePrivateIps,uniqueSourcePrivateIpsHistogram:response.uniqueSourcePrivateIpsHistogram,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}))}searchSubscription$.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_NETWORK_KPI_UNIQUE_PRIVATE_IPS);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_NETWORK_KPI_UNIQUE_PRIVATE_IPS,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkKpiUniquePrivateIpsRequest(prevRequest=>{const myRequest=unique_private_ips_objectSpread(unique_private_ips_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].uniquePrivateIps,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkKpiUniquePrivateIpsSearch(networkKpiUniquePrivateIpsRequest)},[networkKpiUniquePrivateIpsRequest,networkKpiUniquePrivateIpsSearch]);return[loading,networkKpiUniquePrivateIpsResponse]};const UNIQUE_PRIVATE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.title",{defaultMessage:"Unique private IPs"});const translations_SOURCE_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceUnitLabel",{defaultMessage:"source"});const translations_DESTINATION_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationUnitLabel",{defaultMessage:"destination"});const translations_SOURCE_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceChartLabel",{defaultMessage:"Src."});const translations_DESTINATION_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationChartLabel",{defaultMessage:"Dest."});function unique_private_ips_objectWithoutProperties(source,excluded){if(source==null)return{};var target=unique_private_ips_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function unique_private_ips_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function kpi_network_unique_private_ips_slicedToArray(arr,i){return kpi_network_unique_private_ips_arrayWithHoles(arr)||kpi_network_unique_private_ips_iterableToArrayLimit(arr,i)||kpi_network_unique_private_ips_unsupportedIterableToArray(arr,i)||kpi_network_unique_private_ips_nonIterableRest()}function kpi_network_unique_private_ips_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kpi_network_unique_private_ips_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return kpi_network_unique_private_ips_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kpi_network_unique_private_ips_arrayLikeToArray(o,minLen)}function kpi_network_unique_private_ips_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function kpi_network_unique_private_ips_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function kpi_network_unique_private_ips_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const unique_private_ips_euiVisColorPalette=Object(external_kbnSharedDeps_ElasticEui_["euiPaletteColorBlind"])();const euiColorVis2=unique_private_ips_euiVisColorPalette[2];const euiColorVis3=unique_private_ips_euiVisColorPalette[3];const unique_private_ips_fieldsMapping=[{key:"UniqueIps",fields:[{key:"uniqueSourcePrivateIps",value:null,name:translations_SOURCE_CHART_LABEL,description:translations_SOURCE_UNIT_LABEL,color:euiColorVis2,icon:"visMapCoordinate"},{key:"uniqueDestinationPrivateIps",value:null,name:translations_DESTINATION_CHART_LABEL,description:translations_DESTINATION_UNIT_LABEL,color:euiColorVis3,icon:"visMapCoordinate"}],description:UNIQUE_PRIVATE_IPS,enableAreaChart:true,enableBarChart:true}];const NetworkKpiUniquePrivateIpsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const _useNetworkKpiUniqueP=useNetworkKpiUniquePrivateIps({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip}),_useNetworkKpiUniqueP2=kpi_network_unique_private_ips_slicedToArray(_useNetworkKpiUniqueP,2),loading=_useNetworkKpiUniqueP2[0],_useNetworkKpiUniqueP3=_useNetworkKpiUniqueP2[1],refetch=_useNetworkKpiUniqueP3.refetch,id=_useNetworkKpiUniqueP3.id,inspect=_useNetworkKpiUniqueP3.inspect,data=unique_private_ips_objectWithoutProperties(_useNetworkKpiUniqueP3,["refetch","id","inspect"]);return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:unique_private_ips_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const NetworkKpiUniquePrivateIps=external_kbnSharedDeps_React_default.a.memo(NetworkKpiUniquePrivateIpsComponent);const NetworkKpiComponent=external_kbnSharedDeps_React_default.a.memo(({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,setQuery:setQuery,skip:skip,narrowDateRange:narrowDateRange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiNetworkEvents,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiDns,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiUniqueFlows,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiTlsHandshakes,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(NetworkKpiUniquePrivateIps,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))));NetworkKpiComponent.displayName="NetworkKpiComponent";var network_store=__webpack_require__(100);var network=__webpack_require__(160);var network_top_n_flow_table=__webpack_require__(700);var network_top_n_flow=__webpack_require__(715);function ips_query_tab_body_slicedToArray(arr,i){return ips_query_tab_body_arrayWithHoles(arr)||ips_query_tab_body_iterableToArrayLimit(arr,i)||ips_query_tab_body_unsupportedIterableToArray(arr,i)||ips_query_tab_body_nonIterableRest()}function ips_query_tab_body_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ips_query_tab_body_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return ips_query_tab_body_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ips_query_tab_body_arrayLikeToArray(o,minLen)}function ips_query_tab_body_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ips_query_tab_body_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function ips_query_tab_body_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const NetworkTopNFlowTableManage=Object(manage_query["a"])(network_top_n_flow_table["a"]);const IPsQueryTabBody=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery,flowTarget:flowTarget})=>{const _useNetworkTopNFlow=Object(network_top_n_flow["a"])({endDate:endDate,flowTarget:flowTarget,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:network_store["c"].NetworkType.page}),_useNetworkTopNFlow2=ips_query_tab_body_slicedToArray(_useNetworkTopNFlow,2),loading=_useNetworkTopNFlow2[0],_useNetworkTopNFlow2$=_useNetworkTopNFlow2[1],id=_useNetworkTopNFlow2$.id,inspect=_useNetworkTopNFlow2$.inspect,isInspected=_useNetworkTopNFlow2$.isInspected,loadPage=_useNetworkTopNFlow2$.loadPage,networkTopNFlow=_useNetworkTopNFlow2$.networkTopNFlow,pageInfo=_useNetworkTopNFlow2$.pageInfo,refetch=_useNetworkTopNFlow2$.refetch,totalCount=_useNetworkTopNFlow2$.totalCount;return external_kbnSharedDeps_React_default.a.createElement(NetworkTopNFlowTableManage,{data:networkTopNFlow,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_["getOr"])(50,"fakeTotalCount",pageInfo),flowTargeted:flowTarget,id:id,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_["getOr"])(false,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:network_store["c"].NetworkType.page})};IPsQueryTabBody.displayName="IPsQueryTabBody";var network_top_countries_table=__webpack_require__(699);var network_top_countries=__webpack_require__(714);function countries_query_tab_body_slicedToArray(arr,i){return countries_query_tab_body_arrayWithHoles(arr)||countries_query_tab_body_iterableToArrayLimit(arr,i)||countries_query_tab_body_unsupportedIterableToArray(arr,i)||countries_query_tab_body_nonIterableRest()}function countries_query_tab_body_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function countries_query_tab_body_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return countries_query_tab_body_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return countries_query_tab_body_arrayLikeToArray(o,minLen)}function countries_query_tab_body_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function countries_query_tab_body_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function countries_query_tab_body_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const NetworkTopCountriesTableManage=Object(manage_query["a"])(network_top_countries_table["a"]);const CountriesQueryTabBody=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery,indexPattern:indexPattern,flowTarget:flowTarget})=>{const _useNetworkTopCountri=Object(network_top_countries["a"])({endDate:endDate,flowTarget:flowTarget,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:network_store["c"].NetworkType.page}),_useNetworkTopCountri2=countries_query_tab_body_slicedToArray(_useNetworkTopCountri,2),loading=_useNetworkTopCountri2[0],_useNetworkTopCountri3=_useNetworkTopCountri2[1],id=_useNetworkTopCountri3.id,inspect=_useNetworkTopCountri3.inspect,isInspected=_useNetworkTopCountri3.isInspected,loadPage=_useNetworkTopCountri3.loadPage,networkTopCountries=_useNetworkTopCountri3.networkTopCountries,pageInfo=_useNetworkTopCountri3.pageInfo,refetch=_useNetworkTopCountri3.refetch,totalCount=_useNetworkTopCountri3.totalCount;return external_kbnSharedDeps_React_default.a.createElement(NetworkTopCountriesTableManage,{data:networkTopCountries,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_["getOr"])(50,"fakeTotalCount",pageInfo),flowTargeted:flowTarget,id:id,indexPattern:indexPattern,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_["getOr"])(false,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:network_store["c"].NetworkType.page})};CountriesQueryTabBody.displayName="CountriesQueryTabBody";var network_http_table=__webpack_require__(698);var network_http=__webpack_require__(713);function http_query_tab_body_slicedToArray(arr,i){return http_query_tab_body_arrayWithHoles(arr)||http_query_tab_body_iterableToArrayLimit(arr,i)||http_query_tab_body_unsupportedIterableToArray(arr,i)||http_query_tab_body_nonIterableRest()}function http_query_tab_body_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function http_query_tab_body_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return http_query_tab_body_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return http_query_tab_body_arrayLikeToArray(o,minLen)}function http_query_tab_body_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function http_query_tab_body_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function http_query_tab_body_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const NetworkHttpTableManage=Object(manage_query["a"])(network_http_table["a"]);const HttpQueryTabBody=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery})=>{const _useNetworkHttp=Object(network_http["a"])({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:network_store["c"].NetworkType.page}),_useNetworkHttp2=http_query_tab_body_slicedToArray(_useNetworkHttp,2),loading=_useNetworkHttp2[0],_useNetworkHttp2$=_useNetworkHttp2[1],id=_useNetworkHttp2$.id,inspect=_useNetworkHttp2$.inspect,isInspected=_useNetworkHttp2$.isInspected,loadPage=_useNetworkHttp2$.loadPage,networkHttp=_useNetworkHttp2$.networkHttp,pageInfo=_useNetworkHttp2$.pageInfo,refetch=_useNetworkHttp2$.refetch,totalCount=_useNetworkHttp2$.totalCount;return external_kbnSharedDeps_React_default.a.createElement(NetworkHttpTableManage,{data:networkHttp,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_["getOr"])(50,"fakeTotalCount",pageInfo),id:id,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_["getOr"])(false,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:network_store["c"].NetworkType.page})};HttpQueryTabBody.displayName="HttpQueryTabBody";var anomalies_network_table=__webpack_require__(683);var paginated_table=__webpack_require__(179);var draggable_wrapper=__webpack_require__(116);var data_provider=__webpack_require__(96);var formatted_bytes=__webpack_require__(235);var data_providers_provider=__webpack_require__(138);const TOP_DNS_DOMAINS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.title",{defaultMessage:"Top DNS domains"});const UNIT=totalCount=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.unit",{values:{totalCount:totalCount},defaultMessage:"{totalCount, plural, =1 {domain} other {domains}}"});const TOOLTIP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.helperTooltip",{defaultMessage:"This shows DNS protocol traffic only and can be useful for hunting domains used in DNS data exfiltration."});const REGISTERED_DOMAIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.column.registeredDomain",{defaultMessage:"Registered domain"});const TOTAL_QUERIES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.column.TotalQueriesTitle",{defaultMessage:"Total queries"});const UNIQUE_DOMAINS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.column.uniqueDomainsTitle",{defaultMessage:"Unique domains"});const DNS_BYTES_IN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.column.bytesInTitle",{defaultMessage:"DNS bytes in"});const DNS_BYTES_OUT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.column.bytesOutTitle",{defaultMessage:"DNS bytes out"});const INCLUDE_PTR_RECORDS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.select.includePtrRecords",{defaultMessage:"Include PTR records"});const ROWS_5=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});const ROWS_10=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});const getNetworkDnsColumns=()=>[{field:"node.".concat(search_strategy["NetworkDnsFields"].dnsName),name:REGISTERED_DOMAIN,truncateText:false,hideForMobile:false,sortable:true,render:dnsName=>{if(dnsName!=null){const id=Object(drag_and_drop_helpers["j"])("networkDns-table--name-".concat(dnsName));return external_kbnSharedDeps_React_default.a.createElement(draggable_wrapper["b"],{key:id,dataProvider:{and:[],enabled:true,id:id,name:dnsName,excluded:false,kqlQuery:"",queryMatch:{field:"dns.question.registered_domain",value:dnsName,operator:data_provider["c"]}},render:(dataProvider,_,snapshot)=>snapshot.isDragging?external_kbnSharedDeps_React_default.a.createElement(draggable_wrapper["a"],null,external_kbnSharedDeps_React_default.a.createElement(data_providers_provider["a"],{dataProvider:dataProvider})):Object(empty_value["a"])(dnsName)})}else{return Object(empty_value["d"])()}}},{align:"right",field:"node.".concat(search_strategy["NetworkDnsFields"].queryCount),name:TOTAL_QUERIES,sortable:true,truncateText:false,hideForMobile:false,render:queryCount=>{if(queryCount!=null){return external_kbnSharedDeps_ElasticNumeral_default()(queryCount).format("0")}else{return Object(empty_value["d"])()}}},{align:"right",field:"node.".concat(search_strategy["NetworkDnsFields"].uniqueDomains),name:UNIQUE_DOMAINS,sortable:true,truncateText:false,hideForMobile:false,render:uniqueDomains=>{if(uniqueDomains!=null){return external_kbnSharedDeps_ElasticNumeral_default()(uniqueDomains).format("0")}else{return Object(empty_value["d"])()}}},{align:"right",field:"node.".concat(search_strategy["NetworkDnsFields"].dnsBytesIn),name:DNS_BYTES_IN,sortable:true,truncateText:false,hideForMobile:false,render:dnsBytesIn=>{if(dnsBytesIn!=null){return external_kbnSharedDeps_React_default.a.createElement(formatted_bytes["a"],{value:dnsBytesIn})}else{return Object(empty_value["d"])()}}},{align:"right",field:"node.".concat(search_strategy["NetworkDnsFields"].dnsBytesOut),name:DNS_BYTES_OUT,sortable:true,truncateText:false,hideForMobile:false,render:dnsBytesOut=>{if(dnsBytesOut!=null){return external_kbnSharedDeps_React_default.a.createElement(formatted_bytes["a"],{value:dnsBytesOut})}else{return Object(empty_value["d"])()}}}];const IsPtrIncluded=external_kbnSharedDeps_React_default.a.memo(({isPtrIncluded:isPtrIncluded,onChange:onChange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{name:"switch-ptr-included",label:INCLUDE_PTR_RECORDS,checked:isPtrIncluded,onChange:onChange}));IsPtrIncluded.displayName="IsPtrIncluded";const tableType=network_store["c"].NetworkTableType.dns;const rowItems=[{text:ROWS_5,numberOfRow:5},{text:ROWS_10,numberOfRow:10}];const NetworkDnsTableComponent=({data:data,fakeTotalCount:fakeTotalCount,id:id,isInspect:isInspect,loading:loading,loadPage:loadPage,showMorePagesIndicator:showMorePagesIndicator,totalCount:totalCount,type:type})=>{const dispatch=Object(react_redux_lib["useDispatch"])();const getNetworkDnsSelector=network_store["e"].dnsSelector();const _useShallowEqualSelec=Object(use_selector["b"])(getNetworkDnsSelector),activePage=_useShallowEqualSelec.activePage,isPtrIncluded=_useShallowEqualSelec.isPtrIncluded,limit=_useShallowEqualSelec.limit,sort=_useShallowEqualSelec.sort;const updateLimitPagination=Object(external_kbnSharedDeps_React_["useCallback"])(newLimit=>dispatch(network_store["b"].updateNetworkTable({networkType:type,tableType:tableType,updates:{limit:newLimit}})),[type,dispatch]);const updateActivePage=Object(external_kbnSharedDeps_React_["useCallback"])(newPage=>dispatch(network_store["b"].updateNetworkTable({networkType:type,tableType:tableType,updates:{activePage:newPage}})),[dispatch,type]);const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(criteria=>{if(criteria.sort!=null){const newDnsSortField={field:criteria.sort.field.split(".")[1],direction:criteria.sort.direction};if(!fast_deep_equal_default()(newDnsSortField,sort)){dispatch(network_store["b"].updateNetworkTable({networkType:type,tableType:tableType,updates:{sort:newDnsSortField}}))}}},[sort,type,dispatch]);const onChangePtrIncluded=Object(external_kbnSharedDeps_React_["useCallback"])(()=>dispatch(network_store["b"].updateNetworkTable({networkType:type,tableType:tableType,updates:{isPtrIncluded:!isPtrIncluded}})),[dispatch,type,isPtrIncluded]);const columns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getNetworkDnsColumns(),[]);const sorting=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({field:"node.".concat(sort.field),direction:sort.direction}),[sort.direction,sort.field]);const HeaderSupplement=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(IsPtrIncluded,{isPtrIncluded:isPtrIncluded,onChange:onChangePtrIncluded}),[isPtrIncluded,onChangePtrIncluded]);return external_kbnSharedDeps_React_default.a.createElement(paginated_table["a"],{activePage:activePage,columns:columns,dataTestSubj:"table-".concat(tableType),headerCount:totalCount,headerSupplement:HeaderSupplement,headerTitle:TOP_DNS_DOMAINS,headerTooltip:TOOLTIP,headerUnit:UNIT(totalCount),id:id,itemsPerRow:rowItems,isInspect:isInspect,limit:limit,loading:loading,loadPage:loadPage,onChange:onChange,pageOfItems:data,showMorePagesIndicator:showMorePagesIndicator,sorting:sorting,totalCount:fakeTotalCount,updateActivePage:updateActivePage,updateLimitPagination:updateLimitPagination})};NetworkDnsTableComponent.displayName="NetworkDnsTableComponent";const NetworkDnsTable=external_kbnSharedDeps_React_default.a.memo(NetworkDnsTableComponent);var paginated_table_helpers=__webpack_require__(173);const ERROR_NETWORK_DNS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDns.errorSearchDescription",{defaultMessage:"An error has occurred on network dns search"});const FAIL_NETWORK_DNS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDns.failSearchDescription",{defaultMessage:"Failed to run search on network dns"});function network_dns_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function network_dns_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){network_dns_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){network_dns_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function network_dns_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function network_dns_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){network_dns_ownKeys(Object(source),true).forEach((function(key){network_dns_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{network_dns_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function network_dns_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function network_dns_slicedToArray(arr,i){return network_dns_arrayWithHoles(arr)||network_dns_iterableToArrayLimit(arr,i)||network_dns_unsupportedIterableToArray(arr,i)||network_dns_nonIterableRest()}function network_dns_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function network_dns_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return network_dns_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return network_dns_arrayLikeToArray(o,minLen)}function network_dns_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function network_dns_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function network_dns_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const network_dns_ID="networkDnsQuery";const useNetworkDns=({docValueFields:docValueFields,endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:type})=>{const getNetworkDnsSelector=network_store["e"].dnsSelector();const _useShallowEqualSelec=Object(use_selector["b"])(getNetworkDnsSelector),activePage=_useShallowEqualSelec.activePage,sort=_useShallowEqualSelec.sort,isPtrIncluded=_useShallowEqualSelec.isPtrIncluded,limit=_useShallowEqualSelec.limit;const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=network_dns_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,docValueFields:docValueFields!==null&&docValueFields!==void 0?docValueFields:[],factoryQueryType:search_strategy["NetworkQueries"].dns,filterQuery:Object(containers_helpers["a"])(filterQuery),isPtrIncluded:isPtrIncluded,pagination:Object(paginated_table_helpers["a"])(activePage,limit,true),sort:sort,timerange:{interval:"12h",from:startDate?startDate:"",to:endDate?endDate:new Date(Date.now()).toISOString()}}:null),_useState4=network_dns_slicedToArray(_useState3,2),networkDnsRequest=_useState4[0],setNetworkDnsRequest=_useState4[1];const wrappedLoadMore=Object(external_kbnSharedDeps_React_["useCallback"])(newActivePage=>{setNetworkDnsRequest(prevRequest=>{if(!prevRequest){return prevRequest}return network_dns_objectSpread(network_dns_objectSpread({},prevRequest),{},{pagination:Object(paginated_table_helpers["a"])(newActivePage,limit)})})},[limit]);const _useState5=Object(external_kbnSharedDeps_React_["useState"])({networkDns:[],histogram:[],id:network_dns_ID,inspect:{dsl:[],response:[]},isInspected:false,loadPage:wrappedLoadMore,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:false},refetch:refetch.current,totalCount:-1}),_useState6=network_dns_slicedToArray(_useState5,2),networkDnsResponse=_useState6[0],setNetworkDnsResponse=_useState6[1];const networkDnsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=network_dns_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){if(!didCancel){setLoading(false);setNetworkDnsResponse(prevResponse=>{var _response$histogram;return network_dns_objectSpread(network_dns_objectSpread({},prevResponse),{},{networkDns:response.edges,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),pageInfo:response.pageInfo,refetch:refetch.current,totalCount:response.totalCount,histogram:(_response$histogram=response.histogram)!==null&&_response$histogram!==void 0?_response$histogram:prevResponse.histogram})})}searchSubscription$.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_NETWORK_DNS);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_NETWORK_DNS,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkDnsRequest(prevRequest=>{const myRequest=network_dns_objectSpread(network_dns_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,docValueFields:docValueFields!==null&&docValueFields!==void 0?docValueFields:[],isPtrIncluded:isPtrIncluded,factoryQueryType:search_strategy["NetworkQueries"].dns,filterQuery:Object(containers_helpers["a"])(filterQuery),pagination:Object(paginated_table_helpers["a"])(activePage,limit,true),sort:sort,timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[activePage,indexNames,endDate,filterQuery,limit,startDate,sort,skip,isPtrIncluded,docValueFields]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkDnsSearch(networkDnsRequest)},[networkDnsRequest,networkDnsSearch]);return[loading,networkDnsResponse]};var network_pages_translations=__webpack_require__(338);var components_matrix_histogram=__webpack_require__(216);var _dnsStackByOptions$fi;function dns_query_tab_body_extends(){dns_query_tab_body_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return dns_query_tab_body_extends.apply(this,arguments)}function dns_query_tab_body_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function dns_query_tab_body_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){dns_query_tab_body_ownKeys(Object(source),true).forEach((function(key){dns_query_tab_body_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{dns_query_tab_body_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function dns_query_tab_body_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function dns_query_tab_body_slicedToArray(arr,i){return dns_query_tab_body_arrayWithHoles(arr)||dns_query_tab_body_iterableToArrayLimit(arr,i)||dns_query_tab_body_unsupportedIterableToArray(arr,i)||dns_query_tab_body_nonIterableRest()}function dns_query_tab_body_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dns_query_tab_body_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return dns_query_tab_body_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dns_query_tab_body_arrayLikeToArray(o,minLen)}function dns_query_tab_body_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function dns_query_tab_body_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function dns_query_tab_body_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const HISTOGRAM_ID="networkDnsHistogramQuery";const NetworkDnsTableManage=Object(manage_query["a"])(NetworkDnsTable);const dnsStackByOptions=[{text:"dns.question.registered_domain",value:"dns.question.registered_domain"}];const DEFAULT_STACK_BY="dns.question.registered_domain";const histogramConfigs={defaultStackByOption:(_dnsStackByOptions$fi=dnsStackByOptions.find(o=>o.text===DEFAULT_STACK_BY))!==null&&_dnsStackByOptions$fi!==void 0?_dnsStackByOptions$fi:dnsStackByOptions[0],errorMessage:network_pages_translations["b"],histogramType:security_solution["MatrixHistogramType"].dns,stackByOptions:dnsStackByOptions,subtitle:undefined};const DnsQueryTabBodyComponent=({deleteQuery:deleteQuery,docValueFields:docValueFields,endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery,type:type})=>{const getNetworkDnsSelector=network_store["e"].dnsSelector();const _useShallowEqualSelec=Object(use_selector["b"])(getNetworkDnsSelector),isPtrIncluded=_useShallowEqualSelec.isPtrIncluded;Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{if(deleteQuery){deleteQuery({id:HISTOGRAM_ID})}},[deleteQuery]);const _useNetworkDns=useNetworkDns({docValueFields:docValueFields!==null&&docValueFields!==void 0?docValueFields:[],endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:type}),_useNetworkDns2=dns_query_tab_body_slicedToArray(_useNetworkDns,2),loading=_useNetworkDns2[0],_useNetworkDns2$=_useNetworkDns2[1],totalCount=_useNetworkDns2$.totalCount,networkDns=_useNetworkDns2$.networkDns,pageInfo=_useNetworkDns2$.pageInfo,loadPage=_useNetworkDns2$.loadPage,id=_useNetworkDns2$.id,inspect=_useNetworkDns2$.inspect,isInspected=_useNetworkDns2$.isInspected,refetch=_useNetworkDns2$.refetch;const getTitle=Object(external_kbnSharedDeps_React_["useCallback"])(option=>network_pages_translations["a"](option.text),[]);const dnsHistogramConfigs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>dns_query_tab_body_objectSpread(dns_query_tab_body_objectSpread({},histogramConfigs),{},{title:getTitle}),[getTitle]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(components_matrix_histogram["a"],dns_query_tab_body_extends({id:HISTOGRAM_ID,isPtrIncluded:isPtrIncluded,docValueFields:docValueFields,endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,setQuery:setQuery,showLegend:true,startDate:startDate},dnsHistogramConfigs)),external_kbnSharedDeps_React_default.a.createElement(NetworkDnsTableManage,{data:networkDns,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_["getOr"])(50,"fakeTotalCount",pageInfo),id:id,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_["getOr"])(false,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:type}))};DnsQueryTabBodyComponent.displayName="DnsQueryTabBodyComponent";const DnsQueryTabBody=external_kbnSharedDeps_React_default.a.memo(DnsQueryTabBodyComponent);var conditional_flex_group=__webpack_require__(646);var navigation_types=__webpack_require__(238);var containers_tls=__webpack_require__(716);var tls_table=__webpack_require__(701);function tls_query_tab_body_slicedToArray(arr,i){return tls_query_tab_body_arrayWithHoles(arr)||tls_query_tab_body_iterableToArrayLimit(arr,i)||tls_query_tab_body_unsupportedIterableToArray(arr,i)||tls_query_tab_body_nonIterableRest()}function tls_query_tab_body_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tls_query_tab_body_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return tls_query_tab_body_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tls_query_tab_body_arrayLikeToArray(o,minLen)}function tls_query_tab_body_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function tls_query_tab_body_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function tls_query_tab_body_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const TlsTableManage=Object(manage_query["a"])(tls_table["a"]);const TlsQueryTabBodyComponent=({endDate:endDate,filterQuery:filterQuery,flowTarget:flowTarget,indexNames:indexNames,ip:ip="",setQuery:setQuery,skip:skip,startDate:startDate,type:type})=>{const _useNetworkTls=Object(containers_tls["a"])({endDate:endDate,filterQuery:filterQuery,flowTarget:flowTarget,indexNames:indexNames,ip:ip,skip:skip,startDate:startDate,type:type}),_useNetworkTls2=tls_query_tab_body_slicedToArray(_useNetworkTls,2),loading=_useNetworkTls2[0],_useNetworkTls2$=_useNetworkTls2[1],id=_useNetworkTls2$.id,inspect=_useNetworkTls2$.inspect,isInspected=_useNetworkTls2$.isInspected,tls=_useNetworkTls2$.tls,totalCount=_useNetworkTls2$.totalCount,pageInfo=_useNetworkTls2$.pageInfo,loadPage=_useNetworkTls2$.loadPage,refetch=_useNetworkTls2$.refetch;return external_kbnSharedDeps_React_default.a.createElement(TlsTableManage,{data:tls,id:id,inspect:inspect,isInspect:isInspected,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_["getOr"])(50,"fakeTotalCount",pageInfo),loading:loading,loadPage:loadPage,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_["getOr"])(false,"showMorePagesIndicator",pageInfo),refetch:refetch,setQuery:setQuery,totalCount:totalCount,type:type})};TlsQueryTabBodyComponent.displayName="TlsQueryTabBodyComponent";const TlsQueryTabBody=external_kbnSharedDeps_React_default.a.memo(TlsQueryTabBodyComponent);var alerts_viewer=__webpack_require__(696);function alerts_query_tab_body_extends(){alerts_query_tab_body_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return alerts_query_tab_body_extends.apply(this,arguments)}const filterNetworkData=[{query:{bool:{filter:[{bool:{should:[{bool:{should:[{exists:{field:"source.ip"}}],minimum_should_match:1}},{bool:{should:[{exists:{field:"destination.ip"}}],minimum_should_match:1}}],minimum_should_match:1}}]}},meta:{alias:"",disabled:false,key:"bool",negate:false,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}];const NetworkAlertsQueryTabBody=external_kbnSharedDeps_React_default.a.memo(alertsProps=>external_kbnSharedDeps_React_default.a.createElement(alerts_viewer["a"],alerts_query_tab_body_extends({timelineId:types_timeline["e"].networkPageExternalAlerts},alertsProps,{pageFilters:filterNetworkData})));NetworkAlertsQueryTabBody.displayName="NetworkAlertsQueryTabBody";function network_routes_extends(){network_routes_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return network_routes_extends.apply(this,arguments)}function network_routes_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function network_routes_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){network_routes_ownKeys(Object(source),true).forEach((function(key){network_routes_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{network_routes_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function network_routes_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function network_routes_slicedToArray(arr,i){return network_routes_arrayWithHoles(arr)||network_routes_iterableToArrayLimit(arr,i)||network_routes_unsupportedIterableToArray(arr,i)||network_routes_nonIterableRest()}function network_routes_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function network_routes_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return network_routes_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return network_routes_arrayLikeToArray(o,minLen)}function network_routes_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function network_routes_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function network_routes_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const NetworkRoutes=external_kbnSharedDeps_React_default.a.memo(({networkPagePath:networkPagePath,docValueFields:docValueFields,type:type,to:to,filterQuery:filterQuery,isInitializing:isInitializing,from:from,indexPattern:indexPattern,indexNames:indexNames,setQuery:setQuery,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker})=>{const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])((score,interval)=>{const fromTo=Object(score_interval_to_datetime["a"])(score,interval);setAbsoluteRangeDatePicker({id:"global",from:fromTo.from,to:fromTo.to})},[setAbsoluteRangeDatePicker]);const updateDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const _x=network_routes_slicedToArray(x,2),min=_x[0],max=_x[1];setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]);const networkAnomaliesFilterQuery={bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}};const commonProps={startDate:from,endDate:to,indexNames:indexNames,skip:isInitializing,type:type,narrowDateRange:narrowDateRange,setQuery:setQuery,filterQuery:filterQuery};const tabProps=network_routes_objectSpread(network_routes_objectSpread({},commonProps),{},{indexPattern:indexPattern,updateDateRange:updateDateRange});const anomaliesProps=network_routes_objectSpread(network_routes_objectSpread({},commonProps),{},{anomaliesFilterQuery:networkAnomaliesFilterQuery,AnomaliesTableComponent:anomalies_network_table["a"]});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(navigation_types["a"].dns,")")},external_kbnSharedDeps_React_default.a.createElement(DnsQueryTabBody,network_routes_extends({},tabProps,{docValueFields:docValueFields}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(navigation_types["a"].flows,")")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(conditional_flex_group["a"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(IPsQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network["FlowTargetSourceDest"].source}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(IPsQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network["FlowTargetSourceDest"].destination})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(conditional_flex_group["a"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(CountriesQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network["FlowTargetSourceDest"].source}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(CountriesQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network["FlowTargetSourceDest"].destination})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(navigation_types["a"].http,")")},external_kbnSharedDeps_React_default.a.createElement(HttpQueryTabBody,tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(navigation_types["a"].tls,")")},external_kbnSharedDeps_React_default.a.createElement(TlsQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network["FlowTargetSourceDest"].source}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(navigation_types["a"].anomalies,")")},external_kbnSharedDeps_React_default.a.createElement(anomalies_query_tab_body["a"],network_routes_extends({},anomaliesProps,{AnomaliesTableComponent:anomalies_network_table["a"]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/:tabName(".concat(navigation_types["a"].alerts,")")},external_kbnSharedDeps_React_default.a.createElement(NetworkAlertsQueryTabBody,tabProps)))});NetworkRoutes.displayName="NetworkRoutes";const network_routes_loading_FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroup",componentId:"sc-1sbaj97-0"})(["min-height:200px;"]);network_routes_loading_FlexGroup.displayName="FlexGroup";const NetworkRoutesLoading=()=>external_kbnSharedDeps_React_default.a.createElement(network_routes_loading_FlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"xl"})));NetworkRoutesLoading.displayName="NetworkRoutesLoading";const getTabsOnNetworkUrl=tabName=>"/".concat(tabName);const navTabsNetwork=hasMlUserPermissions=>{const networkNavTabs={[navigation_types["a"].flows]:{id:navigation_types["a"].flows,name:network_pages_translations["f"],href:getTabsOnNetworkUrl(navigation_types["a"].flows),disabled:false,urlKey:"network",pageId:app_types["a"].network},[navigation_types["a"].dns]:{id:navigation_types["a"].dns,name:network_pages_translations["e"],href:getTabsOnNetworkUrl(navigation_types["a"].dns),disabled:false,urlKey:"network",pageId:app_types["a"].network},[navigation_types["a"].http]:{id:navigation_types["a"].http,name:network_pages_translations["g"],href:getTabsOnNetworkUrl(navigation_types["a"].http),disabled:false,urlKey:"network",pageId:app_types["a"].network},[navigation_types["a"].tls]:{id:navigation_types["a"].tls,name:network_pages_translations["h"],href:getTabsOnNetworkUrl(navigation_types["a"].tls),disabled:false,urlKey:"network",pageId:app_types["a"].network},[navigation_types["a"].anomalies]:{id:navigation_types["a"].anomalies,name:network_pages_translations["d"],href:getTabsOnNetworkUrl(navigation_types["a"].anomalies),disabled:false,urlKey:"network",pageId:app_types["a"].network},[navigation_types["a"].alerts]:{id:navigation_types["a"].alerts,name:network_pages_translations["c"],href:getTabsOnNetworkUrl(navigation_types["a"].alerts),disabled:false,urlKey:"network",pageId:app_types["a"].network}};return hasMlUserPermissions?networkNavTabs:Object(external_kbnSharedDeps_LodashFp_["omit"])([navigation_types["a"].anomalies],networkNavTabs)};const getNetworkRoutePath=(capabilitiesFetched,hasMlUserPermission)=>{if(capabilitiesFetched&&!hasMlUserPermission){return"/:tabName(".concat(navigation_types["a"].flows,"|").concat(navigation_types["a"].dns,"|").concat(navigation_types["a"].http,"|").concat(navigation_types["a"].tls,"|").concat(navigation_types["a"].alerts,")")}return"/:tabName("+"".concat(navigation_types["a"].flows,"|")+"".concat(navigation_types["a"].dns,"|")+"".concat(navigation_types["a"].anomalies,"|")+"".concat(navigation_types["a"].http,"|")+"".concat(navigation_types["a"].tls,"|")+"".concat(navigation_types["a"].alerts,")")};function network_slicedToArray(arr,i){return network_arrayWithHoles(arr)||network_iterableToArrayLimit(arr,i)||network_unsupportedIterableToArray(arr,i)||network_nonIterableRest()}function network_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function network_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return network_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return network_arrayLikeToArray(o,minLen)}function network_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function network_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function network_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const NetworkComponent=external_kbnSharedDeps_React_default.a.memo(({filters:filters,graphEventId:graphEventId,query:query,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,networkPagePath:networkPagePath,hasMlUserPermissions:hasMlUserPermissions,capabilitiesFetched:capabilitiesFetched})=>{const _useGlobalTime=Object(use_global_time["a"])(),to=_useGlobalTime.to,from=_useGlobalTime.from,setQuery=_useGlobalTime.setQuery,isInitializing=_useGlobalTime.isInitializing;const _useFullScreen=Object(use_full_screen["a"])(),globalFullScreen=_useFullScreen.globalFullScreen;const kibana=Object(lib_kibana["h"])();const _useParams=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])(),tabName=_useParams.tabName;const tabsFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(tabName===navigation_types["a"].alerts){return filters.length>0?[...filters,...filterNetworkData]:filterNetworkData}return filters},[tabName,filters]);const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const _x=network_slicedToArray(x,2),min=_x[0],max=_x[1];setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]);const _useSourcererScope=Object(sourcerer["b"])(),docValueFields=_useSourcererScope.docValueFields,indicesExist=_useSourcererScope.indicesExist,indexPattern=_useSourcererScope.indexPattern,selectedPatterns=_useSourcererScope.selectedPatterns;const filterQuery=Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:filters});const tabsFilterQuery=Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:tabsFilters});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"resize",handler:external_kbnSharedDeps_LodashFp_["noop"]}),external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],{show:Object(timeline_helpers["f"])({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{indexPattern:indexPattern,id:"global"})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_event_time["a"],{docValueFields:docValueFields,indexKey:search_strategy["LastEventIndexKey"].network,indexNames:selectedPatterns}),title:network_pages_translations["i"]}),external_kbnSharedDeps_React_default.a.createElement(EmbeddedMap,{query:query,filters:filters,startDate:from,endDate:to,setQuery:setQuery}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(NetworkKpiComponent,{filterQuery:filterQuery,from:from,indexNames:selectedPatterns,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:isInitializing,to:to})),capabilitiesFetched&&!isInitializing?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(navigation["a"],{navTabs:navTabsNetwork(hasMlUserPermissions)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),external_kbnSharedDeps_React_default.a.createElement(NetworkRoutes,{docValueFields:docValueFields,filterQuery:tabsFilterQuery,from:from,isInitializing:isInitializing,indexPattern:indexPattern,indexNames:selectedPatterns,setQuery:setQuery,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,type:network_store["c"].NetworkType.page,to:to,networkPagePath:networkPagePath})):external_kbnSharedDeps_React_default.a.createElement(NetworkRoutesLoading,null))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,title:network_pages_translations["i"]}),external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].network}))});NetworkComponent.displayName="NetworkComponent";const network_makeMapStateToProps=()=>{const getGlobalQuerySelector=common_store["inputsSelectors"].globalQuerySelector();const getGlobalFiltersQuerySelector=common_store["inputsSelectors"].globalFiltersQuerySelector();const getTimeline=store_timeline["b"].getTimelineByIdSelector();const mapStateToProps=state=>{var _getTimeline;const timeline=(_getTimeline=getTimeline(state,types_timeline["e"].networkPageExternalAlerts))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"];const graphEventId=timeline.graphEventId;return{query:getGlobalQuerySelector(state),filters:getGlobalFiltersQuerySelector(state),graphEventId:graphEventId}};return mapStateToProps};const network_mapDispatchToProps={setAbsoluteRangeDatePicker:inputs_actions["setAbsoluteRangeDatePicker"]};const network_connector=Object(react_redux_lib["connect"])(network_makeMapStateToProps,network_mapDispatchToProps);const network_Network=network_connector(NetworkComponent);const MlNetworkConditionalContainer=external_kbnSharedDeps_React_default.a.memo(({url:url})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{strict:true,exact:true,path:url,render:({location:location})=>{const queryStringDecoded=Object(query_string["parse"])(location.search.substring(1),{sort:false});if(queryStringDecoded.query!=null){queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query)}const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:"?".concat(reEncoded)})}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"".concat(url,"/ip/:ip"),render:({location:location,match:{params:{ip:ip}}})=>{const queryStringDecoded=Object(query_string["parse"])(location.search.substring(1),{sort:false});if(queryStringDecoded.query!=null){queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query)}if(emptyEntity(ip)){const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:"?".concat(reEncoded)})}else if(multipleEntities(ip)){const ips=getMultipleEntities(ip);queryStringDecoded.query=addEntitiesToKql(["source.ip","destination.ip"],ips,queryStringDecoded.query||"");const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:"?".concat(reEncoded)})}else{const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:"/ip/".concat(ip,"?").concat(reEncoded)})}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/ml-network/",render:({location:{search:search=""}})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{from:"/ml-network/",to:"/ml-network".concat(search)})})));MlNetworkConditionalContainer.displayName="MlNetworkConditionalContainer";const pages_networkPagePath="";const ipDetailsPageBasePath="/ip/:detailName";const NetworkContainerComponent=()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const capabilities=Object(use_ml_capabilities["a"])();const capabilitiesFetched=capabilities.capabilitiesFetched;const userHasMlUserPermissions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(has_ml_user_permissions["a"])(capabilities),[capabilities]);const networkRoutePath=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getNetworkRoutePath(capabilitiesFetched,userHasMlUserPermissions),[capabilitiesFetched,userHasMlUserPermissions]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/ml-network",render:({location:location,match:match})=>external_kbnSharedDeps_React_default.a.createElement(MlNetworkConditionalContainer,{location:location,url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{strict:true,path:networkRoutePath},external_kbnSharedDeps_React_default.a.createElement(network_Network,{networkPagePath:pages_networkPagePath,capabilitiesFetched:capabilities.capabilitiesFetched,hasMlUserPermissions:userHasMlUserPermissions})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"".concat(ipDetailsPageBasePath,"/:flowTarget")},external_kbnSharedDeps_React_default.a.createElement(pages_details["a"],null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:ipDetailsPageBasePath,render:({location:{search:search=""},match:{params:{detailName:detailName}}})=>{history.replace("ip/".concat(detailName,"/").concat(graphql_types["c"].source).concat(search));return null}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",render:({location:{search:search=""}})=>{history.replace("".concat(navigation_types["a"].flows).concat(search));return null}}))};const NetworkContainer=external_kbnSharedDeps_React_default.a.memo(NetworkContainerComponent);const routes_NetworkRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",render:({location:location,match:match})=>external_kbnSharedDeps_React_default.a.createElement(NetworkContainer,{location:location,url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)}));class public_network_Network{setup(){}start(storage){return{SubPluginRoutes:routes_NetworkRoutes,storageTimelines:{timelineById:Object(local_storage["b"])(storage,[types_timeline["e"].networkPageExternalAlerts])},store:{initialState:{network:network_store["a"]},reducer:{network:network_store["d"]}}}}}var alerts_viewer_translations=__webpack_require__(330);var overview_pages_translations=__webpack_require__(264);var histogram_configs=__webpack_require__(625);var redirect_to_hosts=__webpack_require__(226);function alerts_by_category_extends(){alerts_by_category_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return alerts_by_category_extends.apply(this,arguments)}function alerts_by_category_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function alerts_by_category_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){alerts_by_category_ownKeys(Object(source),true).forEach((function(key){alerts_by_category_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{alerts_by_category_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function alerts_by_category_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function alerts_by_category_slicedToArray(arr,i){return alerts_by_category_arrayWithHoles(arr)||alerts_by_category_iterableToArrayLimit(arr,i)||alerts_by_category_unsupportedIterableToArray(arr,i)||alerts_by_category_nonIterableRest()}function alerts_by_category_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function alerts_by_category_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return alerts_by_category_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return alerts_by_category_arrayLikeToArray(o,minLen)}function alerts_by_category_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function alerts_by_category_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function alerts_by_category_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const alerts_by_category_ID="alertsByCategoryOverview";const NO_FILTERS=[];const DEFAULT_QUERY={query:"",language:"kuery"};const alerts_by_category_DEFAULT_STACK_BY="event.module";const AlertsByCategoryComponent=({deleteQuery:deleteQuery,filters:filters=NO_FILTERS,from:from,hideHeaderChildren:hideHeaderChildren=false,indexPattern:indexPattern,indexNames:indexNames,query:query=DEFAULT_QUERY,setQuery:setQuery,to:to})=>{Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{if(deleteQuery){deleteQuery({id:alerts_by_category_ID})}},[]);const kibana=Object(lib_kibana["h"])();const _useFormatUrl=Object(link_to["n"])(app_types["a"].hosts),formatUrl=_useFormatUrl.formatUrl,urlSearch=_useFormatUrl.search;const navigateToApp=kibana.services.application.navigateToApp;const _useUiSetting$=Object(lib_kibana["l"])(constants["A"]),_useUiSetting$2=alerts_by_category_slicedToArray(_useUiSetting$,1),defaultNumberFormat=_useUiSetting$2[0];const goToHostAlerts=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp("".concat(constants["f"],":").concat(app_types["a"].hosts),{path:Object(redirect_to_hosts["c"])(store_model["HostsTableType"].alerts,urlSearch)})},[navigateToApp,urlSearch]);const alertsCountViewAlertsButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["g"],{"data-test-subj":"view-alerts",onClick:goToHostAlerts,href:formatUrl(Object(redirect_to_hosts["c"])(store_model["HostsTableType"].alerts))},overview_pages_translations["f"]),[goToHostAlerts,formatUrl]);const alertsByCategoryHistogramConfigs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _alertsStackByOptions;return alerts_by_category_objectSpread(alerts_by_category_objectSpread({},histogram_configs["b"]),{},{defaultStackByOption:(_alertsStackByOptions=histogram_configs["a"].find(o=>o.text===alerts_by_category_DEFAULT_STACK_BY))!==null&&_alertsStackByOptions!==void 0?_alertsStackByOptions:histogram_configs["a"][0],subtitle:totalCount=>"".concat(alerts_viewer_translations["e"],": ").concat(external_kbnSharedDeps_ElasticNumeral_default()(totalCount).format(defaultNumberFormat)," ").concat(Object(alerts_viewer_translations["g"])(totalCount)),legendPosition:external_kbnSharedDeps_ElasticCharts_["Position"].Right})},[]);return external_kbnSharedDeps_React_default.a.createElement(components_matrix_histogram["a"],alerts_by_category_extends({endDate:to,filterQuery:Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:filters}),headerChildren:hideHeaderChildren?null:alertsCountViewAlertsButton,id:alerts_by_category_ID,indexNames:indexNames,setQuery:setQuery,startDate:from},alertsByCategoryHistogramConfigs))};AlertsByCategoryComponent.displayName="AlertsByCategoryComponent";const AlertsByCategory=external_kbnSharedDeps_React_default.a.memo(AlertsByCategoryComponent);var events_by_dataset=__webpack_require__(580);const ERROR_HOST_OVERVIEW=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"});const FAIL_HOST_OVERVIEW=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"});function overview_host_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function overview_host_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){overview_host_ownKeys(Object(source),true).forEach((function(key){overview_host_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{overview_host_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function overview_host_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function overview_host_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function overview_host_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){overview_host_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){overview_host_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function overview_host_slicedToArray(arr,i){return overview_host_arrayWithHoles(arr)||overview_host_iterableToArrayLimit(arr,i)||overview_host_unsupportedIterableToArray(arr,i)||overview_host_nonIterableRest()}function overview_host_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function overview_host_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return overview_host_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return overview_host_arrayLikeToArray(o,minLen)}function overview_host_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function overview_host_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function overview_host_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const overview_host_ID="overviewHostQuery";const useHostOverview=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=overview_host_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,factoryQueryType:security_solution["HostsQueries"].overview,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}}:null),_useState4=overview_host_slicedToArray(_useState3,2),overviewHostRequest=_useState4[0],setHostRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({overviewHost:{},id:overview_host_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current}),_useState6=overview_host_slicedToArray(_useState5,2),overviewHostResponse=_useState6[0],setHostOverviewResponse=_useState6[1];const overviewHostSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=overview_host_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){if(!didCancel){setLoading(false);setHostOverviewResponse(prevResponse=>overview_host_objectSpread(overview_host_objectSpread({},prevResponse),{},{overviewHost:response.overviewHost,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}))}searchSubscription$.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_HOST_OVERVIEW);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_HOST_OVERVIEW,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setHostRequest(prevRequest=>{const myRequest=overview_host_objectSpread(overview_host_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,factoryQueryType:security_solution["HostsQueries"].overview,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{overviewHostSearch(overviewHostRequest)},[overviewHostRequest,overviewHostSearch]);return[loading,overviewHostResponse]};function stat_value_slicedToArray(arr,i){return stat_value_arrayWithHoles(arr)||stat_value_iterableToArrayLimit(arr,i)||stat_value_unsupportedIterableToArray(arr,i)||stat_value_nonIterableRest()}function stat_value_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function stat_value_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return stat_value_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return stat_value_arrayLikeToArray(o,minLen)}function stat_value_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function stat_value_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function stat_value_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ProgressContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ProgressContainer",componentId:"sc-1qvjg2g-0"})(["margin-left:8px;min-width:100px;"]);const LoadingContent=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"]).withConfig({displayName:"LoadingContent",componentId:"sc-1qvjg2g-1"})([".euiLoadingContent__singleLine{margin-bottom:0px;}"]);const StatValueComponent=({count:count,isGroupStat:isGroupStat,isLoading:isLoading,max:max})=>{const _useUiSetting$=Object(lib_kibana["l"])(constants["A"]),_useUiSetting$2=stat_value_slicedToArray(_useUiSetting$,1),defaultNumberFormat=_useUiSetting$2[0];const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=stat_value_slicedToArray(_useState,2),isInitialLoading=_useState2[0],setIsInitialLoading=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isInitialLoading&&!isLoading){setIsInitialLoading(false)}},[isLoading,isInitialLoading,setIsInitialLoading]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},!isInitialLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:isGroupStat?"default":"subdued",size:isGroupStat?"m":"s"},external_kbnSharedDeps_ElasticNumeral_default()(count).format(defaultNumberFormat))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(ProgressContainer,null,isLoading?external_kbnSharedDeps_React_default.a.createElement(LoadingContent,{"data-test-subj":"stat-value-loading-spinner",lines:1}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{color:isGroupStat?"primary":"subdued",max:max,size:"m",value:count}))))};StatValueComponent.displayName="StatValueComponent";const stat_value_StatValue=external_kbnSharedDeps_React_default.a.memo(StatValueComponent);const getOverviewHostStats=data=>{var _data$auditbeatAuditd,_data$auditbeatFIM,_data$auditbeatLogin,_data$auditbeatPackag,_data$auditbeatProces,_data$auditbeatUser,_data$endgameDns,_data$endgameFile,_data$endgameImageLoa,_data$endgameNetwork,_data$endgameProcess,_data$endgameRegistry,_data$endgameSecurity,_data$filebeatSystemM,_data$winlogbeatSecur,_data$winlogbeatMWSys;return[{count:(_data$auditbeatAuditd=data.auditbeatAuditd)!==null&&_data$auditbeatAuditd!==void 0?_data$auditbeatAuditd:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatAuditTitle",defaultMessage:"Audit"}),id:"auditbeatAuditd"},{count:(_data$auditbeatFIM=data.auditbeatFIM)!==null&&_data$auditbeatFIM!==void 0?_data$auditbeatFIM:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatFimTitle",defaultMessage:"File Integrity Module"}),id:"auditbeatFIM"},{count:(_data$auditbeatLogin=data.auditbeatLogin)!==null&&_data$auditbeatLogin!==void 0?_data$auditbeatLogin:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatLoginTitle",defaultMessage:"Login"}),id:"auditbeatLogin"},{count:(_data$auditbeatPackag=data.auditbeatPackage)!==null&&_data$auditbeatPackag!==void 0?_data$auditbeatPackag:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatPackageTitle",defaultMessage:"Package"}),id:"auditbeatPackage"},{count:(_data$auditbeatProces=data.auditbeatProcess)!==null&&_data$auditbeatProces!==void 0?_data$auditbeatProces:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatProcessTitle",defaultMessage:"Process"}),id:"auditbeatProcess"},{count:(_data$auditbeatUser=data.auditbeatUser)!==null&&_data$auditbeatUser!==void 0?_data$auditbeatUser:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatUserTitle",defaultMessage:"User"}),id:"auditbeatUser"},{count:(_data$endgameDns=data.endgameDns)!==null&&_data$endgameDns!==void 0?_data$endgameDns:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameDnsTitle",defaultMessage:"DNS"}),id:"endgameDns"},{count:(_data$endgameFile=data.endgameFile)!==null&&_data$endgameFile!==void 0?_data$endgameFile:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameFileTitle",defaultMessage:"File"}),id:"endgameFile"},{count:(_data$endgameImageLoa=data.endgameImageLoad)!==null&&_data$endgameImageLoa!==void 0?_data$endgameImageLoa:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameImageLoadTitle",defaultMessage:"Image Load"}),id:"endgameImageLoad"},{count:(_data$endgameNetwork=data.endgameNetwork)!==null&&_data$endgameNetwork!==void 0?_data$endgameNetwork:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameNetworkTitle",defaultMessage:"Network"}),id:"endgameNetwork"},{count:(_data$endgameProcess=data.endgameProcess)!==null&&_data$endgameProcess!==void 0?_data$endgameProcess:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameProcessTitle",defaultMessage:"Process"}),id:"endgameProcess"},{count:(_data$endgameRegistry=data.endgameRegistry)!==null&&_data$endgameRegistry!==void 0?_data$endgameRegistry:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameRegistryTitle",defaultMessage:"Registry"}),id:"endgameRegistry"},{count:(_data$endgameSecurity=data.endgameSecurity)!==null&&_data$endgameSecurity!==void 0?_data$endgameSecurity:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameSecurityTitle",defaultMessage:"Security"}),id:"endgameSecurity"},{count:(_data$filebeatSystemM=data.filebeatSystemModule)!==null&&_data$filebeatSystemM!==void 0?_data$filebeatSystemM:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.filebeatSystemModuleTitle",defaultMessage:"System Module"}),id:"filebeatSystemModule"},{count:(_data$winlogbeatSecur=data.winlogbeatSecurity)!==null&&_data$winlogbeatSecur!==void 0?_data$winlogbeatSecur:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.winlogbeatSecurityTitle",defaultMessage:"Security"}),id:"winlogbeatSecurity"},{count:(_data$winlogbeatMWSys=data.winlogbeatMWSysmonOperational)!==null&&_data$winlogbeatMWSys!==void 0?_data$winlogbeatMWSys:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.winlogbeatMWSysmonOperational",defaultMessage:"Microsoft-Windows-Sysmon/Operational"}),id:"winlogbeatMWSysmonOperational"}]};const HostStatsContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HostStatsContainer",componentId:"ej4zfy-0"})([".accordion-button{width:100%;}"]);const hostStatGroups=[{groupId:"auditbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatAuditd","auditbeatFIM","auditbeatLogin","auditbeatPackage","auditbeatProcess","auditbeatUser"]},{groupId:"endgame",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostStatGroupElasticEndpointSecurity",defaultMessage:"Endpoint Security"}),statIds:["endgameDns","endgameFile","endgameImageLoad","endgameNetwork","endgameProcess","endgameRegistry","endgameSecurity"]},{groupId:"filebeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatSystemModule"]},{groupId:"winlogbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostStatGroupWinlogbeat",defaultMessage:"Winlogbeat"}),statIds:["winlogbeatSecurity","winlogbeatMWSysmonOperational"]}];const Title=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Title",componentId:"ej4zfy-1"})(["margin-left:24px;"]);const AccordionContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"AccordionContent",componentId:"ej4zfy-2"})(["margin-top:8px;"]);const OverviewHostStatsComponent=({data:data,loading:loading})=>{const allHostStats=getOverviewHostStats(data);const allHostStatsCount=allHostStats.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(HostStatsContainer,{"data-test-subj":"overview-hosts-stats"},hostStatGroups.map((statGroup,i)=>{const statsForGroup=allHostStats.filter(s=>statGroup.statIds.includes(s.id));const statsForGroupCount=statsForGroup.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:statGroup.groupId},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{id:"host-stat-accordion-group".concat(statGroup.groupId),buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,statGroup.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:statsForGroupCount,isGroupStat:true,isLoading:loading,max:allHostStatsCount}))),buttonContentClassName:"accordion-button"},external_kbnSharedDeps_React_default.a.createElement(AccordionContent,null,statsForGroup.map(stat=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{key:stat.id,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement(Title,null,stat.title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"host-stat-".concat(stat.id),grow:false},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:stat.count,isGroupStat:false,isLoading:loading,max:statsForGroupCount})))))))}))};const OverviewHostStats=external_kbnSharedDeps_React_default.a.memo(OverviewHostStatsComponent);function components_overview_host_slicedToArray(arr,i){return components_overview_host_arrayWithHoles(arr)||components_overview_host_iterableToArrayLimit(arr,i)||components_overview_host_unsupportedIterableToArray(arr,i)||components_overview_host_nonIterableRest()}function components_overview_host_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function components_overview_host_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return components_overview_host_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return components_overview_host_arrayLikeToArray(o,minLen)}function components_overview_host_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function components_overview_host_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function components_overview_host_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const OverviewHostStatsManage=Object(manage_query["a"])(OverviewHostStats);const OverviewHostComponent=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate,setQuery:setQuery})=>{const _useFormatUrl=Object(link_to["n"])(app_types["a"].hosts),formatUrl=_useFormatUrl.formatUrl,urlSearch=_useFormatUrl.search;const navigateToApp=Object(lib_kibana["h"])().services.application.navigateToApp;const _useUiSetting$=Object(lib_kibana["l"])(constants["A"]),_useUiSetting$2=components_overview_host_slicedToArray(_useUiSetting$,1),defaultNumberFormat=_useUiSetting$2[0];const _useHostOverview=useHostOverview({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate}),_useHostOverview2=components_overview_host_slicedToArray(_useHostOverview,2),loading=_useHostOverview2[0],_useHostOverview2$=_useHostOverview2[1],overviewHost=_useHostOverview2$.overviewHost,id=_useHostOverview2$.id,inspect=_useHostOverview2$.inspect,refetch=_useHostOverview2$.refetch;const goToHost=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp("".concat(constants["f"],":").concat(app_types["a"].hosts),{path:Object(link_to["i"])(urlSearch)})},[navigateToApp,urlSearch]);const hostEventsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getOverviewHostStats(overviewHost).reduce((total,stat)=>total+stat.count,0),[overviewHost]);const formattedHostEventsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_ElasticNumeral_default()(hostEventsCount).format(defaultNumberFormat),[defaultNumberFormat,hostEventsCount]);const hostPageButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["g"],{onClick:goToHost,href:formatUrl(Object(link_to["i"])())},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostsAction",defaultMessage:"View hosts"})),[goToHost,formatUrl]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(components_inspect["b"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{id:overview_host_ID,subtitle:!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(overviewHost)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"Showing: {formattedHostEventsCount} {hostEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewHost.hostsSubtitle",values:{hostEventsCount:hostEventsCount,formattedHostEventsCount:formattedHostEventsCount}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,""),title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostsTitle",defaultMessage:"Host events"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,hostPageButton)),external_kbnSharedDeps_React_default.a.createElement(OverviewHostStatsManage,{loading:loading,data:overviewHost,setQuery:setQuery,id:id,inspect:inspect,refetch:refetch}))))};OverviewHostComponent.displayName="OverviewHostComponent";const OverviewHost=external_kbnSharedDeps_React_default.a.memo(OverviewHostComponent);const ERROR_NETWORK_OVERVIEW=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"});const FAIL_NETWORK_OVERVIEW=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"});function overview_network_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function overview_network_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){overview_network_ownKeys(Object(source),true).forEach((function(key){overview_network_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{overview_network_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function overview_network_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function overview_network_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function overview_network_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){overview_network_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){overview_network_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function overview_network_slicedToArray(arr,i){return overview_network_arrayWithHoles(arr)||overview_network_iterableToArrayLimit(arr,i)||overview_network_unsupportedIterableToArray(arr,i)||overview_network_nonIterableRest()}function overview_network_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function overview_network_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return overview_network_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return overview_network_arrayLikeToArray(o,minLen)}function overview_network_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function overview_network_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function overview_network_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const overview_network_ID="overviewNetworkQuery";const useNetworkOverview=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const _useKibana$services=Object(lib_kibana["h"])().services,data=_useKibana$services.data,notifications=_useKibana$services.notifications;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=overview_network_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(!skip?{defaultIndex:indexNames,factoryQueryType:security_solution["NetworkQueries"].overview,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}}:null),_useState4=overview_network_slicedToArray(_useState3,2),overviewNetworkRequest=_useState4[0],setNetworkRequest=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])({overviewNetwork:{},id:overview_network_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current}),_useState6=overview_network_slicedToArray(_useState5,2),overviewNetworkResponse=_useState6[0],setNetworkOverviewResponse=_useState6[1];const overviewNetworkSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}let didCancel=false;const asyncSearch=function(){var _ref=overview_network_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var searchSubscription$;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:abortCtrl.current=new AbortController;setLoading(true);searchSubscription$=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){if(!didCancel){setLoading(false);setNetworkOverviewResponse(prevResponse=>overview_network_objectSpread(overview_network_objectSpread({},prevResponse),{},{overviewNetwork:response.overviewNetwork,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}))}searchSubscription$.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){if(!didCancel){setLoading(false)}notifications.toasts.addWarning(ERROR_NETWORK_OVERVIEW);searchSubscription$.unsubscribe()}},error:msg=>{if(!(msg instanceof kibanaUtils_common_["AbortError"])){notifications.toasts.addDanger({title:FAIL_NETWORK_OVERVIEW,text:msg.message})}}});case 3:case"end":return _context.stop()}}),_callee)})));return function asyncSearch(){return _ref.apply(this,arguments)}}();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch;return()=>{didCancel=true;abortCtrl.current.abort()}},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkRequest(prevRequest=>{const myRequest=overview_network_objectSpread(overview_network_objectSpread({},prevRequest!==null&&prevRequest!==void 0?prevRequest:{}),{},{defaultIndex:indexNames,factoryQueryType:security_solution["NetworkQueries"].overview,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}});if(!skip&&!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{overviewNetworkSearch(overviewNetworkRequest)},[overviewNetworkRequest,overviewNetworkSearch]);return[loading,overviewNetworkResponse]};const getOverviewNetworkStats=data=>{var _data$auditbeatSocket,_data$filebeatCisco,_data$filebeatNetflow,_data$filebeatPanw,_data$filebeatSuricat,_data$filebeatZeek,_data$packetbeatDNS,_data$packetbeatFlow,_data$packetbeatTLS;return[{count:(_data$auditbeatSocket=data.auditbeatSocket)!==null&&_data$auditbeatSocket!==void 0?_data$auditbeatSocket:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatSocketTitle",defaultMessage:"Socket"}),id:"auditbeatSocket"},{count:(_data$filebeatCisco=data.filebeatCisco)!==null&&_data$filebeatCisco!==void 0?_data$filebeatCisco:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.filebeatCiscoTitle",defaultMessage:"Cisco"}),id:"filebeatCisco"},{count:(_data$filebeatNetflow=data.filebeatNetflow)!==null&&_data$filebeatNetflow!==void 0?_data$filebeatNetflow:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.filebeatNetflowTitle",defaultMessage:"Netflow"}),id:"filebeatNetflow"},{count:(_data$filebeatPanw=data.filebeatPanw)!==null&&_data$filebeatPanw!==void 0?_data$filebeatPanw:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.filebeatPanwTitle",defaultMessage:"Palo Alto Networks"}),id:"filebeatPanw"},{count:(_data$filebeatSuricat=data.filebeatSuricata)!==null&&_data$filebeatSuricat!==void 0?_data$filebeatSuricat:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.fileBeatSuricataTitle",defaultMessage:"Suricata"}),id:"filebeatSuricata"},{count:(_data$filebeatZeek=data.filebeatZeek)!==null&&_data$filebeatZeek!==void 0?_data$filebeatZeek:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.fileBeatZeekTitle",defaultMessage:"Zeek"}),id:"filebeatZeek"},{count:(_data$packetbeatDNS=data.packetbeatDNS)!==null&&_data$packetbeatDNS!==void 0?_data$packetbeatDNS:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.packetBeatDnsTitle",defaultMessage:"DNS"}),id:"packetbeatDNS"},{count:(_data$packetbeatFlow=data.packetbeatFlow)!==null&&_data$packetbeatFlow!==void 0?_data$packetbeatFlow:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.packetBeatFlowTitle",defaultMessage:"Flow"}),id:"packetbeatFlow"},{count:(_data$packetbeatTLS=data.packetbeatTLS)!==null&&_data$packetbeatTLS!==void 0?_data$packetbeatTLS:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.packetbeatTLSTitle",defaultMessage:"TLS"}),id:"packetbeatTLS"}]};const networkStatGroups=[{groupId:"auditbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.networkStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatSocket"]},{groupId:"filebeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.networkStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatCisco","filebeatNetflow","filebeatPanw","filebeatSuricata","filebeatZeek"]},{groupId:"packetbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.networkStatGroupPacketbeat",defaultMessage:"Packetbeat"}),statIds:["packetbeatDNS","packetbeatFlow","packetbeatTLS"]}];const NetworkStatsContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"NetworkStatsContainer",componentId:"sc-1wm45zw-0"})([".accordion-button{width:100%;}"]);const overview_network_stats_Title=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Title",componentId:"sc-1wm45zw-1"})(["margin-left:24px;"]);const overview_network_stats_AccordionContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-1wm45zw-2"})(["margin-top:8px;"]);const OverviewNetworkStatsComponent=({data:data,loading:loading})=>{const allNetworkStats=getOverviewNetworkStats(data);const allNetworkStatsCount=allNetworkStats.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(NetworkStatsContainer,{"data-test-subj":"overview-network-stats"},networkStatGroups.map((statGroup,i)=>{const statsForGroup=allNetworkStats.filter(s=>statGroup.statIds.includes(s.id));const statsForGroupCount=statsForGroup.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:statGroup.groupId},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{id:"network-stat-accordion-group".concat(statGroup.groupId),buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":"network-stat-group-".concat(statGroup.groupId),justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,statGroup.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:statsForGroupCount,isGroupStat:true,isLoading:loading,max:allNetworkStatsCount}))),buttonContentClassName:"accordion-button"},external_kbnSharedDeps_React_default.a.createElement(overview_network_stats_AccordionContent,null,statsForGroup.map(stat=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{key:stat.id,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement(overview_network_stats_Title,null,stat.title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"network-stat-".concat(stat.id),grow:false},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:stat.count,isGroupStat:false,isLoading:loading,max:statsForGroupCount})))))))}))};const OverviewNetworkStats=external_kbnSharedDeps_React_default.a.memo(OverviewNetworkStatsComponent);function components_overview_network_slicedToArray(arr,i){return components_overview_network_arrayWithHoles(arr)||components_overview_network_iterableToArrayLimit(arr,i)||components_overview_network_unsupportedIterableToArray(arr,i)||components_overview_network_nonIterableRest()}function components_overview_network_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function components_overview_network_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return components_overview_network_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return components_overview_network_arrayLikeToArray(o,minLen)}function components_overview_network_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function components_overview_network_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function components_overview_network_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const OverviewNetworkStatsManage=Object(manage_query["a"])(OverviewNetworkStats);const OverviewNetworkComponent=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate,setQuery:setQuery})=>{const _useFormatUrl=Object(link_to["n"])(app_types["a"].network),formatUrl=_useFormatUrl.formatUrl,urlSearch=_useFormatUrl.search;const navigateToApp=Object(lib_kibana["h"])().services.application.navigateToApp;const _useUiSetting$=Object(lib_kibana["l"])(constants["A"]),_useUiSetting$2=components_overview_network_slicedToArray(_useUiSetting$,1),defaultNumberFormat=_useUiSetting$2[0];const _useNetworkOverview=useNetworkOverview({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate}),_useNetworkOverview2=components_overview_network_slicedToArray(_useNetworkOverview,2),loading=_useNetworkOverview2[0],_useNetworkOverview2$=_useNetworkOverview2[1],overviewNetwork=_useNetworkOverview2$.overviewNetwork,id=_useNetworkOverview2$.id,inspect=_useNetworkOverview2$.inspect,refetch=_useNetworkOverview2$.refetch;const goToNetwork=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp("".concat(constants["f"],":").concat(app_types["a"].network),{path:Object(link_to["k"])(urlSearch)})},[navigateToApp,urlSearch]);const networkEventsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getOverviewNetworkStats(overviewNetwork).reduce((total,stat)=>total+stat.count,0),[overviewNetwork]);const formattedNetworkEventsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_ElasticNumeral_default()(networkEventsCount).format(defaultNumberFormat),[defaultNumberFormat,networkEventsCount]);const networkPageButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["g"],{"data-test-subj":"overview-network-go-to-network-page",onClick:goToNetwork,href:formatUrl(Object(link_to["k"])())},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.networkAction",defaultMessage:"View network"})),[goToNetwork,formatUrl]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(components_inspect["b"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{"data-test-subj":"overview-network-query"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{id:overview_network_ID,subtitle:!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(overviewNetwork)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"Showing: {formattedNetworkEventsCount} {networkEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewNetwork.networkSubtitle",values:{formattedNetworkEventsCount:formattedNetworkEventsCount,networkEventsCount:networkEventsCount}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,""),title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.networkTitle",defaultMessage:"Network events"})},networkPageButton),external_kbnSharedDeps_React_default.a.createElement(OverviewNetworkStatsManage,{loading:loading,data:overviewNetwork,id:id,inspect:inspect,setQuery:setQuery,refetch:refetch})))))};OverviewNetworkComponent.displayName="OverviewNetworkComponent";const OverviewNetwork=external_kbnSharedDeps_React_default.a.memo(OverviewNetworkComponent);const HorizontalSpacer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"HorizontalSpacer",componentId:"sc-1b49qwl-0"})(["width:24px;"]);const event_counts_NO_FILTERS=[];const event_counts_DEFAULT_QUERY={query:"",language:"kuery"};const EventCountsComponent=({filters:filters=event_counts_NO_FILTERS,from:from,indexNames:indexNames,indexPattern:indexPattern,query:query=event_counts_DEFAULT_QUERY,setQuery:setQuery,to:to})=>{const kibana=Object(lib_kibana["h"])();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(OverviewHost,{endDate:to,filterQuery:Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:[...filters,...alerts_query_tab_body["b"]]}),indexNames:indexNames,startDate:from,setQuery:setQuery})),external_kbnSharedDeps_React_default.a.createElement(HorizontalSpacer,{grow:false}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(OverviewNetwork,{endDate:to,filterQuery:Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:[...filters,...filterNetworkData]}),indexNames:indexNames,startDate:from,setQuery:setQuery})))};const EventCounts=external_kbnSharedDeps_React_default.a.memo(EventCountsComponent);const COMMENTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentCases.commentsTooltip",{defaultMessage:"Comments"});const MY_RECENTLY_REPORTED_CASES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.overview.myRecentlyReportedCasesButtonLabel",{defaultMessage:"My recently reported cases"});const NO_CASES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentCases.noCasesMessage",{defaultMessage:"No cases have been created yet. Put your detective hat on and"});const RECENTLY_CREATED_CASES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.overview.recentlyCreatedCasesButtonLabel",{defaultMessage:"Recently created cases"});const START_A_NEW_CASE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentCases.startNewCaseLink",{defaultMessage:"start a new case"});const VIEW_ALL_CASES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentCases.viewAllCasesLink",{defaultMessage:"View all cases"});const CASES_FILTER_CONTROL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentCases.controlLegend",{defaultMessage:"Cases filter"});const MY_RECENTLY_REPORTED_ID="myRecentlyReported";const toggleButtonIcons=[{id:"recentlyCreated",label:RECENTLY_CREATED_CASES,iconType:"folderExclamation"},{id:MY_RECENTLY_REPORTED_ID,label:MY_RECENTLY_REPORTED_CASES,iconType:"reporter"}];const Filters=external_kbnSharedDeps_React_default.a.memo(({filterBy:filterBy,setFilterBy:setFilterBy,showMyRecentlyReported:showMyRecentlyReported})=>{const options=Object(external_kbnSharedDeps_React_["useMemo"])(()=>showMyRecentlyReported?toggleButtonIcons:toggleButtonIcons.filter(x=>x.id!==MY_RECENTLY_REPORTED_ID),[showMyRecentlyReported]);const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(filterMode=>{setFilterBy(filterMode)},[setFilterBy]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{options:options,idSelected:filterBy,onChange:onChange,isIconOnly:true,legend:CASES_FILTER_CONTROL})});Filters.displayName="Filters";const ERROR_RETRIEVING_USER_DETAILS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.errorRetrievingUserDetailsMessage",{defaultMessage:"Recent Timelines: An error occurred while retrieving user details"});const FAVORITES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.favoritesButtonLabel",{defaultMessage:"Favorites"});const NO_FAVORITE_TIMELINES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.noFavoriteTimelinesMessage",{defaultMessage:"You haven't favorited any timelines yet. Get out there and start threat hunting!"});const LAST_UPDATED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.lastUpdatedButtonLabel",{defaultMessage:"Last updated"});const NO_TIMELINES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.noTimelinesMessage",{defaultMessage:"You haven't created any timelines yet. Get out there and start threat hunting!"});const NOTES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.notesTooltip",{defaultMessage:"Notes"});const OPEN_AS_DUPLICATE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.openAsDuplicateTooltip",{defaultMessage:"Open as a timeline duplicate"});const OPEN_AS_DUPLICATE_TEMPLATE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.openAsDuplicateTemplateTooltip",{defaultMessage:"Open as a template duplicate"});const PINNED_EVENTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.pinnedEventsTooltip",{defaultMessage:"Pinned events"});const UNTITLED_TIMELINE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.untitledTimelineLabel",{defaultMessage:"Untitled timeline"});const VIEW_ALL_TIMELINES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.viewAllTimelinesLink",{defaultMessage:"View all timelines"});const TIMELINES_FILTER_CONTROL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.filterControlLegend",{defaultMessage:"Timelines filter"});const filters_toggleButtonIcons=[{id:"favorites",label:FAVORITES,iconType:"starFilled"},{id:"recently-updated",label:LAST_UPDATED,iconType:"documentEdit"}];const filters_Filters=external_kbnSharedDeps_React_default.a.memo(({filterBy:filterBy,setFilterBy:setFilterBy})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{options:filters_toggleButtonIcons,idSelected:filterBy,onChange:f=>{setFilterBy(f)},isIconOnly:true,legend:TIMELINES_FILTER_CONTROL}));filters_Filters.displayName="Filters";var use_get_cases=__webpack_require__(448);const LoadingPlaceholdersComponent=({lines:lines,placeholders:placeholders})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,[...Array(placeholders).keys()].map((_,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:i},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{lines:lines}),i!==placeholders-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}))));LoadingPlaceholdersComponent.displayName="LoadingPlaceholdersComponent";const LoadingPlaceholders=external_kbnSharedDeps_React_default.a.memo(LoadingPlaceholdersComponent);var redirect_to_case=__webpack_require__(188);const NoCasesComponent=()=>{const _useFormatUrl=Object(link_to["n"])(app_types["a"].case),formatUrl=_useFormatUrl.formatUrl,search=_useFormatUrl.search;const navigateToApp=Object(lib_kibana["h"])().services.application.navigateToApp;const goToCreateCase=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp("".concat(constants["f"],":").concat(app_types["a"].case),{path:Object(redirect_to_case["e"])(search)})},[navigateToApp,search]);const newCaseLink=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["f"],{"data-test-subj":"no-cases-create-case",onClick:goToCreateCase,href:formatUrl(Object(redirect_to_case["e"])())}," ".concat(START_A_NEW_CASE)),[formatUrl,goToCreateCase]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("span",null,NO_CASES),newCaseLink,"!")};NoCasesComponent.displayName="NoCasesComponent";const NoCases=external_kbnSharedDeps_React_default.a.memo(NoCasesComponent);var open_timeline_helpers=__webpack_require__(136);const counts_Icon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiIcon"]).withConfig({displayName:"Icon",componentId:"sc-1ht70gq-0"})(["margin-right:8px;"]);const counts_FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroup",componentId:"sc-1ht70gq-1"})(["margin-right:16px;"]);const IconWithCount=external_kbnSharedDeps_React_default.a.memo(({count:count,icon:icon,tooltip:tooltip})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:tooltip},external_kbnSharedDeps_React_default.a.createElement(counts_FlexGroup,{alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(counts_Icon,{color:"subdued",size:"s",type:icon})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},count)))));IconWithCount.displayName="IconWithCount";const RecentTimelineCounts=external_kbnSharedDeps_React_default.a.memo(({timeline:timeline})=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(IconWithCount,{count:Object(open_timeline_helpers["e"])(timeline),icon:"pinFilled",tooltip:PINNED_EVENTS}),external_kbnSharedDeps_React_default.a.createElement(IconWithCount,{count:Object(open_timeline_helpers["d"])(timeline),icon:"editorComment",tooltip:NOTES})));RecentTimelineCounts.displayName="RecentTimelineCounts";const MarkdownContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MarkdownContainer",componentId:"nw1m7p-0"})(["max-height:150px;overflow-y:auto;width:300px;"]);const RecentCasesComponent=({cases:cases})=>{const _useFormatUrl=Object(link_to["n"])(app_types["a"].case),formatUrl=_useFormatUrl.formatUrl,search=_useFormatUrl.search;const navigateToApp=Object(lib_kibana["h"])().services.application.navigateToApp;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,cases.map((c,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{key:c.id,gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:ev=>{ev.preventDefault();navigateToApp("".concat(constants["f"],":").concat(app_types["a"].case),{path:Object(redirect_to_case["a"])({id:c.id,search:search})})},href:formatUrl(Object(redirect_to_case["a"])({id:c.id}))},c.title)),external_kbnSharedDeps_React_default.a.createElement(IconWithCount,{count:c.totalComment,icon:"editorComment",tooltip:COMMENTS}),c.description&&c.description.length&&external_kbnSharedDeps_React_default.a.createElement(MarkdownContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(markdown_editor["MarkdownRenderer"],{disableLinks:true},c.description))),i!==cases.length-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})))))};RecentCasesComponent.displayName="RecentCasesComponent";const RecentCases=external_kbnSharedDeps_React_default.a.memo(RecentCasesComponent);function recent_cases_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function recent_cases_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){recent_cases_ownKeys(Object(source),true).forEach((function(key){recent_cases_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{recent_cases_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function recent_cases_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const usePrevious=value=>{const ref=Object(external_kbnSharedDeps_React_["useRef"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{ref.current=value});return ref.current};const MAX_CASES_TO_SHOW=3;const queryParams=recent_cases_objectSpread(recent_cases_objectSpread({},use_get_cases["b"]),{},{perPage:MAX_CASES_TO_SHOW});const StatefulRecentCasesComponent=external_kbnSharedDeps_React_default.a.memo(({filterOptions:filterOptions})=>{const _useFormatUrl=Object(link_to["n"])(app_types["a"].case),formatUrl=_useFormatUrl.formatUrl;const navigateToApp=Object(lib_kibana["h"])().services.application.navigateToApp;const previousFilterOptions=usePrevious(filterOptions);const _useGetCases=Object(use_get_cases["c"])(queryParams),data=_useGetCases.data,loading=_useGetCases.loading,setFilters=_useGetCases.setFilters;const isLoadingCases=Object(external_kbnSharedDeps_React_["useMemo"])(()=>loading.indexOf("cases")>-1||loading.indexOf("caseUpdate")>-1,[loading]);const goToCases=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp("".concat(constants["f"],":").concat(app_types["a"].case))},[navigateToApp]);const allCasesLink=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:goToCases,href:formatUrl("")}," ",VIEW_ALL_CASES),[goToCases,formatUrl]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(previousFilterOptions!==undefined&&previousFilterOptions!==filterOptions){setFilters(filterOptions)}},[previousFilterOptions,filterOptions,setFilters]);const content=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isLoadingCases?external_kbnSharedDeps_React_default.a.createElement(LoadingPlaceholders,{lines:2,placeholders:3}):!isLoadingCases&&data.cases.length===0?external_kbnSharedDeps_React_default.a.createElement(NoCases,null):external_kbnSharedDeps_React_default.a.createElement(RecentCases,{cases:data.cases}),[isLoadingCases,data]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},content,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},allCasesLink))});StatefulRecentCasesComponent.displayName="StatefulRecentCasesComponent";const StatefulRecentCases=external_kbnSharedDeps_React_default.a.memo(StatefulRecentCasesComponent);var containers_all=__webpack_require__(302);const RecentTimelineHeader=external_kbnSharedDeps_React_default.a.memo(({onOpenTimeline:onOpenTimeline,timeline:timeline,timeline:{title:title,savedObjectId:savedObjectId}})=>{const onClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onOpenTimeline({duplicate:false,timelineId:"".concat(savedObjectId)}),[onOpenTimeline,savedObjectId]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{onClick:onClick},Object(open_timeline_helpers["f"])(timeline)?UNTITLED_TIMELINE:title))});RecentTimelineHeader.displayName="RecentTimelineHeader";var with_hover_actions=__webpack_require__(230);const RecentTimelinesItem=external_kbnSharedDeps_React_default.a.memo(({timeline:timeline,onOpenTimeline:onOpenTimeline,isLastItem:isLastItem})=>{const handleClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onOpenTimeline({duplicate:true,timelineId:"".concat(timeline.savedObjectId)}),[onOpenTimeline,timeline.savedObjectId]);const render=Object(external_kbnSharedDeps_React_["useCallback"])(showHoverContent=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(RecentTimelineHeader,{onOpenTimeline:onOpenTimeline,timeline:timeline}),external_kbnSharedDeps_React_default.a.createElement(RecentTimelineCounts,{timeline:timeline}),timeline.description&&timeline.description.length&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},timeline.description)),showHoverContent&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:timeline.timelineType===types_timeline["h"].default?OPEN_AS_DUPLICATE:OPEN_AS_DUPLICATE_TEMPLATE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":timeline.timelineType===types_timeline["h"].default?OPEN_AS_DUPLICATE:OPEN_AS_DUPLICATE_TEMPLATE,"data-test-subj":"open-duplicate",isDisabled:timeline.savedObjectId==null,iconSize:"s",iconType:"copy",onClick:handleClick,size:"s"})))),[handleClick,onOpenTimeline,timeline]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(with_hover_actions["a"],{render:render}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,!isLastItem&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})))});RecentTimelinesItem.displayName="RecentTimelinesItem";const RecentTimelines=external_kbnSharedDeps_React_default.a.memo(({noTimelinesMessage:noTimelinesMessage,onOpenTimeline:onOpenTimeline,timelines:timelines})=>{const content=Object(external_kbnSharedDeps_React_["useMemo"])(()=>timelines.map((timeline,index)=>external_kbnSharedDeps_React_default.a.createElement(RecentTimelinesItem,{key:"".concat(timeline.savedObjectId,"-").concat(timeline.title),timeline:timeline,onOpenTimeline:onOpenTimeline,isLastItem:index===timelines.length-1})),[onOpenTimeline,timelines]);if(timelines.length===0){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},noTimelinesMessage))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,content)});RecentTimelines.displayName="RecentTimelines";var use_timeline_status=__webpack_require__(578);const PAGE_SIZE=3;const StatefulRecentTimelinesComponent=external_kbnSharedDeps_React_default.a.memo(({apolloClient:apolloClient,filterBy:filterBy,updateIsLoading:updateIsLoading,updateTimeline:updateTimeline})=>{const _useFormatUrl=Object(link_to["n"])(app_types["a"].timelines),formatUrl=_useFormatUrl.formatUrl;const navigateToApp=Object(lib_kibana["h"])().services.application.navigateToApp;const onOpenTimeline=Object(external_kbnSharedDeps_React_["useCallback"])(({duplicate:duplicate,timelineId:timelineId})=>{Object(open_timeline_helpers["h"])({apolloClient:apolloClient,duplicate:duplicate,timelineId:timelineId,updateIsLoading:updateIsLoading,updateTimeline:updateTimeline})},[apolloClient,updateIsLoading,updateTimeline]);const goToTimelines=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp("".concat(constants["f"],":").concat(app_types["a"].timelines))},[navigateToApp]);const noTimelinesMessage=filterBy==="favorites"?NO_FAVORITE_TIMELINES:NO_TIMELINES;const linkAllTimelines=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:goToTimelines,href:formatUrl("")},VIEW_ALL_TIMELINES),[goToTimelines,formatUrl]);const loadingPlaceholders=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(LoadingPlaceholders,{lines:2,placeholders:filterBy==="favorites"?1:PAGE_SIZE}),[filterBy]);const _useGetAllTimeline=Object(containers_all["b"])(),fetchAllTimeline=_useGetAllTimeline.fetchAllTimeline,timelines=_useGetAllTimeline.timelines,loading=_useGetAllTimeline.loading;const timelineType=types_timeline["h"].default;const _useTimelineStatus=Object(use_timeline_status["a"])({timelineType:timelineType}),timelineStatus=_useTimelineStatus.timelineStatus;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{fetchAllTimeline({pageInfo:{pageIndex:1,pageSize:PAGE_SIZE},search:"",sort:{sortField:graphql_types["g"].updated,sortOrder:graphql_types["a"].desc},onlyUserFavorite:filterBy==="favorites",status:timelineStatus,timelineType:timelineType})},[fetchAllTimeline,filterBy,timelineStatus,timelineType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,loading?loadingPlaceholders:external_kbnSharedDeps_React_default.a.createElement(RecentTimelines,{noTimelinesMessage:noTimelinesMessage,onOpenTimeline:onOpenTimeline,timelines:timelines}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},linkAllTimelines))});StatefulRecentTimelinesComponent.displayName="StatefulRecentTimelinesComponent";const recent_timelines_mapDispatchToProps=dispatch=>({updateIsLoading:({id:id,isLoading:isLoading})=>dispatch(Object(timeline_actions["updateIsLoading"])({id:id,isLoading:isLoading})),updateTimeline:Object(open_timeline_helpers["b"])(dispatch)});const recent_timelines_connector=Object(react_redux_lib["connect"])(null,recent_timelines_mapDispatchToProps);const StatefulRecentTimelines=recent_timelines_connector(StatefulRecentTimelinesComponent);function helpers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function helpers_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){helpers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){helpers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const removeSnapshotFromVersion=kibanaVersion=>{var _kibanaVersion$replac;return(_kibanaVersion$replac=kibanaVersion===null||kibanaVersion===void 0?void 0:kibanaVersion.replace(/-SNAPSHOT/gi,""))!==null&&_kibanaVersion$replac!==void 0?_kibanaVersion$replac:kibanaVersion};const getNewsFeedUrl=({newsFeedUrlSetting:newsFeedUrlSetting,getKibanaVersion:getKibanaVersion})=>[newsFeedUrlSetting===null||newsFeedUrlSetting===void 0?void 0:newsFeedUrlSetting.trim().replace(/\/$/,""),"v".concat(removeSnapshotFromVersion(getKibanaVersion()),".json")].join("/");const NEWS_FEED_FALLBACK_LANGUAGE="en";const getLocale=fallback=>{var _document$documentEle;if(document.documentElement.lang===""){return fallback}return(_document$documentEle=document.documentElement.lang)!==null&&_document$documentEle!==void 0?_document$documentEle:fallback};const NO_NEWS_ITEMS=[];const getNewsItemsFromApiResponse=response=>{const locale=getLocale(NEWS_FEED_FALLBACK_LANGUAGE);if(response==null||response.items==null){return NO_NEWS_ITEMS}return response.items.filter(x=>x!=null).map(x=>{var _ref,_get,_x$expire_on,_x$hash,_ref2,_get2,_ref3,_get3,_x$publish_on,_ref4,_get4;return{description:(_ref=(_get=Object(external_kbnSharedDeps_LodashFp_["get"])(locale,x.description))!==null&&_get!==void 0?_get:Object(external_kbnSharedDeps_LodashFp_["get"])(NEWS_FEED_FALLBACK_LANGUAGE,x.description))!==null&&_ref!==void 0?_ref:"",expireOn:new Date((_x$expire_on=x.expire_on)!==null&&_x$expire_on!==void 0?_x$expire_on:""),hash:(_x$hash=x.hash)!==null&&_x$hash!==void 0?_x$hash:uuid_default.a.v4(),imageUrl:(_ref2=(_get2=Object(external_kbnSharedDeps_LodashFp_["get"])(locale,x.image_url))!==null&&_get2!==void 0?_get2:Object(external_kbnSharedDeps_LodashFp_["get"])(NEWS_FEED_FALLBACK_LANGUAGE,x.image_url))!==null&&_ref2!==void 0?_ref2:null,linkUrl:(_ref3=(_get3=Object(external_kbnSharedDeps_LodashFp_["get"])(locale,x.link_url))!==null&&_get3!==void 0?_get3:Object(external_kbnSharedDeps_LodashFp_["get"])(NEWS_FEED_FALLBACK_LANGUAGE,x.link_url))!==null&&_ref3!==void 0?_ref3:"",publishOn:new Date((_x$publish_on=x.publish_on)!==null&&_x$publish_on!==void 0?_x$publish_on:""),title:(_ref4=(_get4=Object(external_kbnSharedDeps_LodashFp_["get"])(locale,x.title))!==null&&_get4!==void 0?_get4:Object(external_kbnSharedDeps_LodashFp_["get"])(NEWS_FEED_FALLBACK_LANGUAGE,x.title))!==null&&_ref4!==void 0?_ref4:""}})};const fetchNews=function(){var _ref5=helpers_asyncToGenerator(regeneratorRuntime.mark((function _callee({newsFeedUrl:newsFeedUrl}){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",lib_kibana["b"].get().http.fetch(newsFeedUrl,{method:"GET",credentials:"omit",mode:"cors"}));case 1:case"end":return _context.stop()}}),_callee)})));return function fetchNews(_x){return _ref5.apply(this,arguments)}}();const showNewsItem=({publishOn:publishOn,expireOn:expireOn})=>external_kbnSharedDeps_Moment_default()(Date.now()).isAfter(publishOn)&&external_kbnSharedDeps_Moment_default()(Date.now()).isBefore(expireOn);const SidebarHeader=external_kbnSharedDeps_React_default.a.memo(({children:children,title:title})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h2",null,title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},children)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"})));SidebarHeader.displayName="SidebarHeader";const NO_NEWS_MESSAGE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.newsFeed.noNewsMessage",{defaultMessage:"Your current news feed URL returned no recent news."});const NO_NEWS_MESSAGE_ADMIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.newsFeed.noNewsMessageForAdmin",{defaultMessage:"Your current news feed URL returned no recent news. You may update the URL or disable security news via"});const ADVANCED_SETTINGS_LINK_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.newsFeed.advancedSettingsLinkTitle",{defaultMessage:"SIEM advanced settings"});const NoNews=external_kbnSharedDeps_React_default.a.memo(()=>{var _capabilities$managem;const _useKibana$services$a=Object(lib_kibana["h"])().services.application,getUrlForApp=_useKibana$services$a.getUrlForApp,navigateToApp=_useKibana$services$a.navigateToApp,capabilities=_useKibana$services$a.capabilities;const canSeeAdvancedSettings=(_capabilities$managem=capabilities.management.kibana.settings)!==null&&_capabilities$managem!==void 0?_capabilities$managem:false;const goToKibanaSettings=Object(external_kbnSharedDeps_React_["useCallback"])(()=>navigateToApp("management",{path:"/kibana/settings"}),[navigateToApp]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},canSeeAdvancedSettings?NO_NEWS_MESSAGE_ADMIN:NO_NEWS_MESSAGE,canSeeAdvancedSettings&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null," ",external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:goToKibanaSettings,href:"".concat(getUrlForApp("management",{path:"/kibana/settings"}))},ADVANCED_SETTINGS_LINK_TITLE),"."))});NoNews.displayName="NoNews";const REL_NOOPENER="noopener";const REL_NOFOLLOW="nofollow";const REL_NOREFERRER="noreferrer";const NewsLink=({href:href,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:href,rel:"".concat(REL_NOOPENER," ").concat(REL_NOFOLLOW," ").concat(REL_NOREFERRER),target:"_blank"},children);const NewsItemPreviewImage=external_kbnSharedDeps_StyledComponents_default.a.img.withConfig({displayName:"NewsItemPreviewImage",componentId:"e9sq8j-0"})(["height:56px;margin-left:16px;min-width:56px;padding:4px;width:56px;"]);const Post=external_kbnSharedDeps_React_default.a.memo(({newsItem:newsItem})=>{const linkUrl=newsItem.linkUrl,title=newsItem.title,publishOn=newsItem.publishOn,description=newsItem.description,imageUrl=newsItem.imageUrl;if(!showNewsItem(newsItem)){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(NewsLink,{href:linkUrl},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(formatted_date["e"],{value:publishOn}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",null,description),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},imageUrl&&external_kbnSharedDeps_React_default.a.createElement(NewsLink,{href:linkUrl},external_kbnSharedDeps_React_default.a.createElement(NewsItemPreviewImage,{alt:title,className:"euiPanel",src:imageUrl}))))});Post.displayName="Post";const SHOW_PLACEHOLDERS=5;const LINES_PER_LOADING_PLACEHOLDER=4;const NewsFeedComponent=({news:news})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(SidebarHeader,{title:overview_pages_translations["b"]}),news==null?external_kbnSharedDeps_React_default.a.createElement(LoadingPlaceholders,{lines:LINES_PER_LOADING_PLACEHOLDER,placeholders:SHOW_PLACEHOLDERS}):news.length===0?external_kbnSharedDeps_React_default.a.createElement(NoNews,null):news.map(n=>external_kbnSharedDeps_React_default.a.createElement(Post,{key:n.hash,newsItem:n})));NewsFeedComponent.displayName="NewsFeedComponent";const NewsFeed=external_kbnSharedDeps_React_default.a.memo(NewsFeedComponent);function news_feed_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function news_feed_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){news_feed_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){news_feed_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function news_feed_slicedToArray(arr,i){return news_feed_arrayWithHoles(arr)||news_feed_iterableToArrayLimit(arr,i)||news_feed_unsupportedIterableToArray(arr,i)||news_feed_nonIterableRest()}function news_feed_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function news_feed_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return news_feed_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return news_feed_arrayLikeToArray(o,minLen)}function news_feed_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function news_feed_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function news_feed_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const StatefulNewsFeed=external_kbnSharedDeps_React_default.a.memo(({enableNewsFeedSetting:enableNewsFeedSetting,newsFeedSetting:newsFeedSetting})=>{const kibanaNewsfeedEnabled=Object(lib_kibana["h"])().services.newsfeed;const _useUiSetting$=Object(lib_kibana["l"])(enableNewsFeedSetting),_useUiSetting$2=news_feed_slicedToArray(_useUiSetting$,1),enableNewsFeed=_useUiSetting$2[0];const _useUiSetting$3=Object(lib_kibana["l"])(newsFeedSetting),_useUiSetting$4=news_feed_slicedToArray(_useUiSetting$3,1),newsFeedUrlSetting=_useUiSetting$4[0];const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=news_feed_slicedToArray(_useState,2),news=_useState2[0],setNews=_useState2[1];const newsfeedEnabled=kibanaNewsfeedEnabled&&enableNewsFeed;const newsFeedUrl=getNewsFeedUrl({newsFeedUrlSetting:newsFeedUrlSetting,getKibanaVersion:()=>lib_kibana["b"].getKibanaVersion()});Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let canceled=false;const fetchData=function(){var _ref=news_feed_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var apiResponse;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetchNews({newsFeedUrl:newsFeedUrl});case 3:apiResponse=_context.sent;if(!canceled){setNews(getNewsItemsFromApiResponse(apiResponse))}_context.next=10;break;case 7:_context.prev=7;_context.t0=_context["catch"](0);if(!canceled){setNews([])}case 10:case"end":return _context.stop()}}),_callee,null,[[0,7]])})));return function fetchData(){return _ref.apply(this,arguments)}}();if(newsfeedEnabled){fetchData()}return()=>{canceled=true}},[newsfeedEnabled,newsFeedUrl]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,newsfeedEnabled?external_kbnSharedDeps_React_default.a.createElement(NewsFeed,{news:news}):null)});StatefulNewsFeed.displayName="StatefulNewsFeed";var apollo_context=__webpack_require__(184);function sidebar_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function sidebar_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){sidebar_ownKeys(Object(source),true).forEach((function(key){sidebar_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{sidebar_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function sidebar_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const SidebarFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"SidebarFlexGroup",componentId:"s31pt6-0"})(["width:305px;"]);const SidebarSpacerComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xxl"}));SidebarSpacerComponent.displayName="SidebarSpacerComponent";const Spacer=external_kbnSharedDeps_React_default.a.memo(SidebarSpacerComponent);const Sidebar=external_kbnSharedDeps_React_default.a.memo(({recentCasesFilterBy:recentCasesFilterBy,recentTimelinesFilterBy:recentTimelinesFilterBy,setRecentCasesFilterBy:setRecentCasesFilterBy,setRecentTimelinesFilterBy:setRecentTimelinesFilterBy})=>{const currentUser=Object(lib_kibana["d"])();const apolloClient=Object(apollo_context["b"])();const recentCasesFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(Filters,{filterBy:recentCasesFilterBy,setFilterBy:setRecentCasesFilterBy,showMyRecentlyReported:currentUser!=null}),[currentUser,recentCasesFilterBy,setRecentCasesFilterBy]);const recentCasesFilterOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>recentCasesFilterBy==="myRecentlyReported"&&currentUser!=null?sidebar_objectSpread(sidebar_objectSpread({},use_get_cases["a"]),{},{reporters:[{email:currentUser.email,full_name:currentUser.fullName,username:currentUser.username}]}):use_get_cases["a"],[currentUser,recentCasesFilterBy]);const recentTimelinesFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(filters_Filters,{filterBy:recentTimelinesFilterBy,setFilterBy:setRecentTimelinesFilterBy}),[recentTimelinesFilterBy,setRecentTimelinesFilterBy]);return external_kbnSharedDeps_React_default.a.createElement(SidebarFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(SidebarHeader,{title:overview_pages_translations["c"]},recentCasesFilters),external_kbnSharedDeps_React_default.a.createElement(StatefulRecentCases,{filterOptions:recentCasesFilterOptions})),external_kbnSharedDeps_React_default.a.createElement(Spacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(SidebarHeader,{title:overview_pages_translations["d"]},recentTimelinesFilters),external_kbnSharedDeps_React_default.a.createElement(StatefulRecentTimelines,{apolloClient:apolloClient,filterBy:recentTimelinesFilterBy})),external_kbnSharedDeps_React_default.a.createElement(Spacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(StatefulNewsFeed,{enableNewsFeedSetting:constants["O"],newsFeedSetting:constants["V"]})))});Sidebar.displayName="Sidebar";function sidebar_slicedToArray(arr,i){return sidebar_arrayWithHoles(arr)||sidebar_iterableToArrayLimit(arr,i)||sidebar_unsupportedIterableToArray(arr,i)||sidebar_nonIterableRest()}function sidebar_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function sidebar_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return sidebar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sidebar_arrayLikeToArray(o,minLen)}function sidebar_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function sidebar_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function sidebar_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const StatefulSidebar=external_kbnSharedDeps_React_default.a.memo(()=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])("favorites"),_useState2=sidebar_slicedToArray(_useState,2),recentTimelinesFilterBy=_useState2[0],setRecentTimelinesFilterBy=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])("recentlyCreated"),_useState4=sidebar_slicedToArray(_useState3,2),recentCasesFilterBy=_useState4[0],setRecentCasesFilterBy=_useState4[1];return external_kbnSharedDeps_React_default.a.createElement(Sidebar,{recentCasesFilterBy:recentCasesFilterBy,setRecentCasesFilterBy:setRecentCasesFilterBy,recentTimelinesFilterBy:recentTimelinesFilterBy,setRecentTimelinesFilterBy:setRecentTimelinesFilterBy})});StatefulSidebar.displayName="StatefulSidebar";var signals_by_category=__webpack_require__(626);var routing=__webpack_require__(139);var use_navigate_to_app_event_handler=__webpack_require__(174);var management_common_constants=__webpack_require__(102);const useManagementFormatUrl=managementPath=>"".concat(Object(lib_kibana["h"])().services.application.getUrlForApp(management_common_constants["b"])).concat(managementPath);const EndpointNotice=Object(external_kbnSharedDeps_React_["memo"])(({onDismiss:onDismiss})=>{const endpointsPath=Object(routing["d"])({name:"endpointList"});const endpointsLink=useManagementFormatUrl(endpointsPath);const handleGetStartedClick=Object(use_navigate_to_app_event_handler["a"])(management_common_constants["b"],{path:endpointsPath});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{"data-test-subj":"endpoint-prompt-banner",iconType:"cheer",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("b",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endpointNotice.introducing",defaultMessage:"Introducing: "})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endpointNotice.title",defaultMessage:"Endpoint Security (beta)"}))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endpointNotice.message",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:handleGetStartedClick,href:endpointsLink},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endpointNotice.tryButton",defaultMessage:"Try Endpoint Security (beta)"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onDismiss},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endpointNotice.dismiss",defaultMessage:"Dismiss message"}))))});EndpointNotice.displayName="EndpointNotice";var use_messages_storage=__webpack_require__(632);var ingest_enabled=__webpack_require__(337);var components_sourcerer=__webpack_require__(694);function overview_slicedToArray(arr,i){return overview_arrayWithHoles(arr)||overview_iterableToArrayLimit(arr,i)||overview_unsupportedIterableToArray(arr,i)||overview_nonIterableRest()}function overview_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function overview_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return overview_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return overview_arrayLikeToArray(o,minLen)}function overview_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function overview_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function overview_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const overview_DEFAULT_QUERY={query:"",language:"kuery"};const overview_NO_FILTERS=[];const SidebarFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"SidebarFlexItem",componentId:"g6j99s-0"})(["margin-right:24px;"]);const OverviewComponent=({filters:filters=overview_NO_FILTERS,query:query=overview_DEFAULT_QUERY,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker})=>{const _useGlobalTime=Object(use_global_time["a"])(),from=_useGlobalTime.from,deleteQuery=_useGlobalTime.deleteQuery,setQuery=_useGlobalTime.setQuery,to=_useGlobalTime.to;const _useSourcererScope=Object(sourcerer["b"])(),indicesExist=_useSourcererScope.indicesExist,indexPattern=_useSourcererScope.indexPattern,selectedPatterns=_useSourcererScope.selectedPatterns;const endpointMetadataIndex=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[constants["Q"]],[]);const _useFetchIndex=Object(source["b"])(endpointMetadataIndex,true),_useFetchIndex2=overview_slicedToArray(_useFetchIndex,2),metadataIndexExists=_useFetchIndex2[1].indexExists;const _useMessagesStorage=Object(use_messages_storage["a"])(),addMessage=_useMessagesStorage.addMessage,hasMessage=_useMessagesStorage.hasMessage;const hasDismissEndpointNoticeMessage=Object(external_kbnSharedDeps_React_["useMemo"])(()=>hasMessage("management","dismissEndpointNotice"),[hasMessage]);const _useState=Object(external_kbnSharedDeps_React_["useState"])(hasDismissEndpointNoticeMessage),_useState2=overview_slicedToArray(_useState,2),dismissMessage=_useState2[0],setDismissMessage=_useState2[1];const dismissEndpointNotice=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setDismissMessage(true);addMessage("management","dismissEndpointNotice")},[addMessage]);const _useIngestEnabledChec=Object(ingest_enabled["a"])(),isIngestEnabled=_useIngestEnabledChec.allEnabled;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],null,external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{id:"global",indexPattern:indexPattern})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,!dismissMessage&&!metadataIndexExists&&isIngestEnabled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(EndpointNotice,{onDismiss:dismissEndpointNotice}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(components_sourcerer["a"],{scope:model["SourcererScopeName"].default}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(SidebarFlexItem,{grow:false},external_kbnSharedDeps_React_default.a.createElement(StatefulSidebar,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(signals_by_category["a"],{filters:filters,from:from,indexPattern:indexPattern,query:query,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,setQuery:setQuery,to:to}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AlertsByCategory,{deleteQuery:deleteQuery,filters:filters,from:from,indexPattern:indexPattern,indexNames:selectedPatterns,query:query,setQuery:setQuery,to:to})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(events_by_dataset["a"],{deleteQuery:deleteQuery,filters:filters,from:from,indexPattern:indexPattern,indexNames:selectedPatterns,query:query,setQuery:setQuery,to:to})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(EventCounts,{filters:filters,from:from,indexNames:selectedPatterns,indexPattern:indexPattern,query:query,setQuery:setQuery,to:to}))))))):external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].overview}))};const overview_makeMapStateToProps=()=>{const getGlobalFiltersQuerySelector=common_store["inputsSelectors"].globalFiltersQuerySelector();const getGlobalQuerySelector=common_store["inputsSelectors"].globalQuerySelector();const mapStateToProps=state=>({query:getGlobalQuerySelector(state),filters:getGlobalFiltersQuerySelector(state)});return mapStateToProps};const overview_mapDispatchToProps={setAbsoluteRangeDatePicker:inputs_actions["setAbsoluteRangeDatePicker"]};const overview_connector=Object(react_redux_lib["connect"])(overview_makeMapStateToProps,overview_mapDispatchToProps);const StatefulOverview=overview_connector(external_kbnSharedDeps_React_default.a.memo(OverviewComponent));const pages_Overview=Object(external_kbnSharedDeps_React_["memo"])(()=>external_kbnSharedDeps_React_default.a.createElement(StatefulOverview,null));pages_Overview.displayName="Overview";const OverviewRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",render:()=>external_kbnSharedDeps_React_default.a.createElement(pages_Overview,null)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)}));class overview_Overview{setup(){}start(){return{SubPluginRoutes:OverviewRoutes}}}var pages=__webpack_require__(708);const TimelinesRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",render:()=>external_kbnSharedDeps_React_default.a.createElement(pages["a"],null)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)}));var dist=__webpack_require__(203);var store_timeline_helpers=__webpack_require__(382);const EMPTY_TIMELINE_BY_ID={};function timeline_reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function timeline_reducer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){timeline_reducer_ownKeys(Object(source),true).forEach((function(key){timeline_reducer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{timeline_reducer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function timeline_reducer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const initialTimelineState={timelineById:EMPTY_TIMELINE_BY_ID,autoSavedWarningMsg:{timelineId:null,newTimelineModel:null},showCallOutUnauthorizedMsg:false,insertTimeline:null};const timelineReducer=Object(dist["reducerWithInitialState"])(initialTimelineState).case(timeline_actions["addTimeline"],(state,{id:id,timeline:timeline})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["f"])({id:id,timeline:timeline,timelineById:state.timelineById})})).case(timeline_actions["createTimeline"],(state,{id:id,dataProviders:dataProviders,dateRange:dateRange,excludedRowRendererIds:excludedRowRendererIds,show:show,columns:columns,itemsPerPage:itemsPerPage,indexNames:indexNames,kqlQuery:kqlQuery,sort:sort,showCheckboxes:showCheckboxes,timelineType:timelineType=types_timeline["h"].default,filters:filters})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["a"])({columns:columns,dataProviders:dataProviders,dateRange:dateRange,excludedRowRendererIds:excludedRowRendererIds,filters:filters,id:id,itemsPerPage:itemsPerPage,indexNames:indexNames,kqlQuery:kqlQuery,sort:sort,show:show,showCheckboxes:showCheckboxes,timelineById:state.timelineById,timelineType:timelineType})})).case(timeline_actions["upsertColumn"],(state,{column:column,id:id,index:index})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["O"])({column:column,id:id,index:index,timelineById:state.timelineById})})).case(timeline_actions["addHistory"],(state,{id:id,historyId:historyId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["b"])({id:id,historyId:historyId,timelineById:state.timelineById})})).case(timeline_actions["addNote"],(state,{id:id,noteId:noteId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["c"])({id:id,noteId:noteId,timelineById:state.timelineById})})).case(timeline_actions["addNoteToEvent"],(state,{id:id,noteId:noteId,eventId:eventId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["d"])({id:id,noteId:noteId,eventId:eventId,timelineById:state.timelineById})})).case(timeline_actions["toggleExpandedEvent"],(state,{timelineId:timelineId,event:event})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById),{},{[timelineId]:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById[timelineId]),{},{expandedEvent:event})})})).case(timeline_actions["addProvider"],(state,{id:id,provider:provider})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["e"])({id:id,provider:provider,timelineById:state.timelineById})})).case(timeline_actions["applyKqlFilterQuery"],(state,{id:id,filterQuery:filterQuery})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["h"])({id:id,filterQuery:filterQuery,timelineById:state.timelineById})})).case(timeline_actions["setKqlFilterQueryDraft"],(state,{id:id,filterQueryDraft:filterQueryDraft})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["t"])({id:id,filterQueryDraft:filterQueryDraft,timelineById:state.timelineById})})).case(timeline_actions["showTimeline"],(state,{id:id,show:show})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["L"])({id:id,show:show,timelineById:state.timelineById})})).case(timeline_actions["updateTimelineGraphEventId"],(state,{id:id,graphEventId:graphEventId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["s"])({id:id,graphEventId:graphEventId,timelineById:state.timelineById})})).case(timeline_actions["applyDeltaToColumnWidth"],(state,{id:id,columnId:columnId,delta:delta})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["g"])({id:id,columnId:columnId,delta:delta,timelineById:state.timelineById})})).case(timeline_actions["pinEvent"],(state,{id:id,eventId:eventId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["j"])({id:id,eventId:eventId,timelineById:state.timelineById})})).case(timeline_actions["removeColumn"],(state,{id:id,columnId:columnId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["k"])({id:id,columnId:columnId,timelineById:state.timelineById})})).case(timeline_actions["removeProvider"],(state,{id:id,providerId:providerId,andProviderId:andProviderId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["l"])({id:id,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions["startTimelineSaving"],(state,{id:id})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById),{},{[id]:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById[id]),{},{isSaving:true})})})).case(timeline_actions["endTimelineSaving"],(state,{id:id})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById),{},{[id]:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById[id]),{},{isSaving:false})})})).case(timeline_actions["setEventsDeleted"],(state,{id:id,eventIds:eventIds,isDeleted:isDeleted})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["m"])({id:id,eventIds:eventIds,timelineById:state.timelineById,isDeleted:isDeleted})})).case(timeline_actions["clearEventsDeleted"],(state,{id:id})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById),{},{[id]:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById[id]),{},{deletedEventIds:[]})})})).case(timeline_actions["setEventsLoading"],(state,{id:id,eventIds:eventIds,isLoading:isLoading})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["n"])({id:id,eventIds:eventIds,timelineById:state.timelineById,isLoading:isLoading})})).case(timeline_actions["clearEventsLoading"],(state,{id:id})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById),{},{[id]:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById[id]),{},{loadingEventIds:[]})})})).case(timeline_actions["setExcludedRowRendererIds"],(state,{id:id,excludedRowRendererIds:excludedRowRendererIds})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["q"])({id:id,excludedRowRendererIds:excludedRowRendererIds,timelineById:state.timelineById})})).case(timeline_actions["setSelected"],(state,{id:id,eventIds:eventIds,isSelected:isSelected,isSelectAllChecked:isSelectAllChecked})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["o"])({id:id,eventIds:eventIds,timelineById:state.timelineById,isSelected:isSelected,isSelectAllChecked:isSelectAllChecked})})).case(timeline_actions["clearSelected"],(state,{id:id})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById),{},{[id]:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById[id]),{},{selectedEventIds:{},isSelectAllChecked:false})})})).case(timeline_actions["updateIsLoading"],(state,{id:id,isLoading:isLoading})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById),{},{[id]:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById[id]),{},{isLoading:isLoading})})})).case(timeline_actions["updateTimeline"],(state,{id:id,timeline:timeline})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById),{},{[id]:timeline})})).case(timeline_actions["unPinEvent"],(state,{id:id,eventId:eventId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["p"])({id:id,eventId:eventId,timelineById:state.timelineById})})).case(timeline_actions["updateColumns"],(state,{id:id,columns:columns})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["v"])({id:id,columns:columns,timelineById:state.timelineById})})).case(timeline_actions["updateDescription"],(state,{id:id,description:description})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["w"])({id:id,description:description,timelineById:state.timelineById})})).case(timeline_actions["updateEventType"],(state,{id:id,eventType:eventType})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["x"])({id:id,eventType:eventType,timelineById:state.timelineById})})).case(timeline_actions["updateIsFavorite"],(state,{id:id,isFavorite:isFavorite})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["y"])({id:id,isFavorite:isFavorite,timelineById:state.timelineById})})).case(timeline_actions["updateIsLive"],(state,{id:id,isLive:isLive})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["z"])({id:id,isLive:isLive,timelineById:state.timelineById})})).case(timeline_actions["updateKqlMode"],(state,{id:id,kqlMode:kqlMode})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["B"])({id:id,kqlMode:kqlMode,timelineById:state.timelineById})})).case(timeline_actions["updateTitle"],(state,{id:id,title:title,disableAutoSave:disableAutoSave})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["N"])({id:id,title:title,timelineById:state.timelineById})})).case(timeline_actions["updateProviders"],(state,{id:id,providers:providers})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["J"])({id:id,providers:providers,timelineById:state.timelineById})})).case(timeline_actions["updateRange"],(state,{id:id,start:start,end:end})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["K"])({id:id,start:start,end:end,timelineById:state.timelineById})})).case(timeline_actions["updateSort"],(state,{id:id,sort:sort})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["M"])({id:id,sort:sort,timelineById:state.timelineById})})).case(timeline_actions["updateDataProviderEnabled"],(state,{id:id,enabled:enabled,providerId:providerId,andProviderId:andProviderId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["E"])({id:id,enabled:enabled,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions["updateDataProviderExcluded"],(state,{id:id,excluded:excluded,providerId:providerId,andProviderId:andProviderId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["F"])({id:id,excluded:excluded,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions["dataProviderEdited"],(state,{andProviderId:andProviderId,excluded:excluded,field:field,id:id,operator:operator,providerId:providerId,value:value})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["H"])({andProviderId:andProviderId,excluded:excluded,field:field,id:id,operator:operator,providerId:providerId,timelineById:state.timelineById,value:value})})).case(timeline_actions["updateDataProviderType"],(state,{id:id,type:type,providerId:providerId,andProviderId:andProviderId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["I"])({id:id,type:type,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions["updateDataProviderKqlQuery"],(state,{id:id,kqlQuery:kqlQuery,providerId:providerId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["G"])({id:id,kqlQuery:kqlQuery,providerId:providerId,timelineById:state.timelineById})})).case(timeline_actions["updateItemsPerPage"],(state,{id:id,itemsPerPage:itemsPerPage})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["A"])({id:id,itemsPerPage:itemsPerPage,timelineById:state.timelineById})})).case(timeline_actions["updatePageIndex"],(state,{id:id,activePage:activePage})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["C"])({id:id,activePage:activePage,timelineById:state.timelineById})})).case(timeline_actions["updateItemsPerPageOptions"],(state,{id:id,itemsPerPageOptions:itemsPerPageOptions})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["D"])({id:id,itemsPerPageOptions:itemsPerPageOptions,timelineById:state.timelineById})})).case(timeline_actions["updateAutoSaveMsg"],(state,{timelineId:timelineId,newTimelineModel:newTimelineModel})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{autoSavedWarningMsg:{timelineId:timelineId,newTimelineModel:newTimelineModel}})).case(timeline_actions["showCallOutUnauthorizedMsg"],state=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{showCallOutUnauthorizedMsg:true})).case(timeline_actions["setSavedQueryId"],(state,{id:id,savedQueryId:savedQueryId})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["u"])({id:id,savedQueryId:savedQueryId,timelineById:state.timelineById})})).case(timeline_actions["setFilters"],(state,{id:id,filters:filters})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:Object(store_timeline_helpers["r"])({id:id,filters:filters,timelineById:state.timelineById})})).case(timeline_actions["setInsertTimeline"],(state,insertTimeline)=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{insertTimeline:insertTimeline})).case(timeline_actions["updateIndexNames"],(state,{id:id,indexNames:indexNames})=>timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state),{},{timelineById:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById),{},{[id]:timeline_reducer_objectSpread(timeline_reducer_objectSpread({},state.timelineById[id]),{},{indexNames:indexNames})})})).build();class timelines_Timelines{setup(){}start(){return{SubPluginRoutes:TimelinesRoutes,store:{initialState:{timeline:initialTimelineState},reducer:{timeline:timelineReducer}}}}}var management_pages=__webpack_require__(672);const ManagementRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",component:management_pages["a"]}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)}));var selectors=__webpack_require__(163);function policy_details_reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function policy_details_reducer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){policy_details_reducer_ownKeys(Object(source),true).forEach((function(key){policy_details_reducer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{policy_details_reducer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function policy_details_reducer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const updatePolicyConfigInPolicyData=(policyData,policyConfig)=>policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},policyData),{},{inputs:policyData.inputs.map(input=>policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},input),{},{config:input.config&&policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},input.config),{},{policy:policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},input.config.policy),{},{value:policyConfig})})}))});const initialPolicyDetailsState=()=>({policyItem:undefined,isLoading:false,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0}});const policyDetailsReducer=(state=initialPolicyDetailsState(),action)=>{if(action.type==="serverReturnedPolicyDetailsData"||action.type==="serverReturnedUpdatedPolicyDetailsData"){return policy_details_reducer_objectSpread(policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},state),action.payload),{},{isLoading:false})}if(action.type==="serverFailedToReturnPolicyDetailsData"){return policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},state),{},{isLoading:false,apiError:action.payload})}if(action.type==="serverReturnedPolicyDetailsAgentSummaryData"){return policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},state),action.payload)}if(action.type==="serverReturnedPolicyDetailsUpdateFailure"){return policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},state),{},{isLoading:false,updateStatus:action.payload})}if(action.type==="userClickedPolicyDetailsSaveButton"){return policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},state),{},{isLoading:true,updateApiError:undefined})}if(action.type==="userChangedUrl"){const newState=policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},state),{},{location:action.payload});const isCurrentlyOnDetailsPage=Object(selectors["g"])(newState);const wasPreviouslyOnDetailsPage=Object(selectors["g"])(state);if(isCurrentlyOnDetailsPage){if(!wasPreviouslyOnDetailsPage){return policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},newState),{},{isLoading:true})}return newState}return policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},initialPolicyDetailsState()),{},{location:action.payload})}if(action.type==="userChangedPolicyConfig"){if(!state.policyItem){return state}const newState=policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},state),{},{policyItem:policy_details_reducer_objectSpread({},state.policyItem)});const newPolicy=policy_details_reducer_objectSpread({},Object(selectors["c"])(state));newState.policyItem.inputs[0].config.policy.value=newPolicy;Object.entries(action.payload.policyConfig).forEach(([section,newSettings])=>{newPolicy[section]=policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},newPolicy[section]),newSettings)});return newState}if(action.type==="userChangedAntivirusRegistration"){if(state.policyItem){const policyConfig=Object(selectors["c"])(state);return policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},state),{},{policyItem:updatePolicyConfigInPolicyData(state.policyItem,policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},policyConfig),{},{windows:policy_details_reducer_objectSpread(policy_details_reducer_objectSpread({},policyConfig.windows),{},{antivirus_registration:{enabled:action.payload.enabled}})}))})}else{return state}}return state};var policy_list_selectors=__webpack_require__(428);function policy_list_reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function policy_list_reducer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){policy_list_reducer_ownKeys(Object(source),true).forEach((function(key){policy_list_reducer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{policy_list_reducer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function policy_list_reducer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const initialPolicyListState=()=>({policyItems:[],endpointPackageInfo:undefined,isLoading:false,isDeleting:false,deleteStatus:undefined,apiError:undefined,pageIndex:0,pageSize:10,total:0,location:undefined,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0}});const policyListReducer=(state=initialPolicyListState(),action)=>{if(action.type==="serverReturnedPolicyListData"){return policy_list_reducer_objectSpread(policy_list_reducer_objectSpread(policy_list_reducer_objectSpread({},state),action.payload),{},{isLoading:false,isDeleting:false})}if(action.type==="serverFailedToReturnPolicyListData"){return policy_list_reducer_objectSpread(policy_list_reducer_objectSpread({},state),{},{apiError:action.payload,isLoading:false,isDeleting:false})}if(action.type==="serverDeletedPolicyFailure"){return policy_list_reducer_objectSpread(policy_list_reducer_objectSpread(policy_list_reducer_objectSpread({},state),action.payload),{},{isLoading:false,isDeleting:false})}if(action.type==="serverDeletedPolicy"){return policy_list_reducer_objectSpread(policy_list_reducer_objectSpread({},state),{},{deleteStatus:action.payload.success,isLoading:true,isDeleting:false})}if(action.type==="userClickedPolicyListDeleteButton"){return policy_list_reducer_objectSpread(policy_list_reducer_objectSpread({},state),{},{isLoading:false,isDeleting:true})}if(action.type==="serverReturnedPolicyAgentsSummaryForDelete"){return policy_list_reducer_objectSpread(policy_list_reducer_objectSpread({},state),action.payload)}if(action.type==="serverReturnedPolicyAgentsSummaryForDeleteFailure"){return policy_list_reducer_objectSpread(policy_list_reducer_objectSpread({},state),action.payload)}if(action.type==="serverReturnedEndpointPackageInfo"){return policy_list_reducer_objectSpread(policy_list_reducer_objectSpread({},state),{},{endpointPackageInfo:action.payload})}if(action.type==="userChangedUrl"){const newState=policy_list_reducer_objectSpread(policy_list_reducer_objectSpread({},state),{},{location:action.payload});const isCurrentlyOnListPage=Object(policy_list_selectors["isOnPolicyListPage"])(newState);const wasPreviouslyOnListPage=Object(policy_list_selectors["isOnPolicyListPage"])(state);if(isCurrentlyOnListPage){if(!wasPreviouslyOnListPage){return policy_list_reducer_objectSpread(policy_list_reducer_objectSpread({},newState),{},{apiError:undefined,isLoading:true,isDeleting:false})}return newState}return initialPolicyListState()}return state};var store_selectors=__webpack_require__(212);function store_reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function store_reducer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){store_reducer_ownKeys(Object(source),true).forEach((function(key){store_reducer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{store_reducer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function store_reducer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const initialEndpointListState={hosts:[],pageSize:10,pageIndex:0,total:0,loading:false,error:undefined,details:undefined,detailsLoading:false,detailsError:undefined,policyResponse:undefined,policyResponseLoading:false,policyResponseError:undefined,location:undefined,policyItems:[],selectedPolicyId:undefined,policyItemsLoading:false,endpointPackageInfo:undefined,nonExistingPolicies:{},agentPolicies:{},endpointsExist:true,patterns:[],patternsError:undefined,isAutoRefreshEnabled:true,autoRefreshInterval:management_common_constants["a"],agentsWithEndpointsTotal:0,agentsWithEndpointsTotalError:undefined,endpointsTotal:0,endpointsTotalError:undefined,queryStrategyVersion:undefined,policyVersionInfo:undefined};const endpointListReducer=(state=initialEndpointListState,action)=>{if(action.type==="serverReturnedEndpointList"){const _action$payload=action.payload,hosts=_action$payload.hosts,total=_action$payload.total,pageSize=_action$payload.request_page_size,pageIndex=_action$payload.request_page_index,queryStrategyVersion=_action$payload.query_strategy_version,policyVersionInfo=_action$payload.policy_info;return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{hosts:hosts,total:total,pageSize:pageSize,pageIndex:pageIndex,queryStrategyVersion:queryStrategyVersion,policyVersionInfo:policyVersionInfo,loading:false,error:undefined})}else if(action.type==="serverFailedToReturnEndpointList"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{error:action.payload,loading:false})}else if(action.type==="serverReturnedEndpointNonExistingPolicies"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{nonExistingPolicies:store_reducer_objectSpread(store_reducer_objectSpread({},state.nonExistingPolicies),action.payload)})}else if(action.type==="serverReturnedEndpointAgentPolicies"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{agentPolicies:store_reducer_objectSpread(store_reducer_objectSpread({},state.agentPolicies),action.payload)})}else if(action.type==="serverReturnedMetadataPatterns"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{patterns:action.payload,patternsError:undefined})}else if(action.type==="serverFailedToReturnMetadataPatterns"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{patternsError:action.payload})}else if(action.type==="serverReturnedEndpointDetails"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{details:action.payload.metadata,policyVersionInfo:action.payload.policy_info,detailsLoading:false,detailsError:undefined})}else if(action.type==="serverFailedToReturnEndpointDetails"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{detailsError:action.payload,detailsLoading:false})}else if(action.type==="serverReturnedPoliciesForOnboarding"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{policyItems:action.payload.policyItems,policyItemsLoading:false})}else if(action.type==="serverFailedToReturnPoliciesForOnboarding"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{error:action.payload,policyItemsLoading:false})}else if(action.type==="serverReturnedEndpointPolicyResponse"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{policyResponse:action.payload.policy_response,policyResponseLoading:false,policyResponseError:undefined})}else if(action.type==="serverFailedToReturnEndpointPolicyResponse"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{policyResponseError:action.payload,policyResponseLoading:false})}else if(action.type==="userSelectedEndpointPolicy"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{selectedPolicyId:action.payload.selectedPolicyId,policyResponseLoading:false})}else if(action.type==="serverCancelledEndpointListLoading"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{loading:false})}else if(action.type==="serverCancelledPolicyItemsLoading"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{policyItemsLoading:false})}else if(action.type==="serverReturnedEndpointPackageInfo"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{endpointPackageInfo:action.payload})}else if(action.type==="serverReturnedEndpointExistValue"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{endpointsExist:action.payload})}else if(action.type==="serverReturnedAgenstWithEndpointsTotal"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{agentsWithEndpointsTotal:action.payload,agentsWithEndpointsTotalError:undefined})}else if(action.type==="serverFailedToReturnAgenstWithEndpointsTotal"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{agentsWithEndpointsTotalError:action.payload})}else if(action.type==="serverReturnedEndpointsTotal"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{endpointsTotal:action.payload,endpointsTotalError:undefined})}else if(action.type==="serverFailedToReturnEndpointsTotal"){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{endpointsTotalError:action.payload})}else if(action.type==="userUpdatedEndpointListRefreshOptions"){var _action$payload$isAut,_action$payload$autoR;return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{isAutoRefreshEnabled:(_action$payload$isAut=action.payload.isAutoRefreshEnabled)!==null&&_action$payload$isAut!==void 0?_action$payload$isAut:state.isAutoRefreshEnabled,autoRefreshInterval:(_action$payload$autoR=action.payload.autoRefreshInterval)!==null&&_action$payload$autoR!==void 0?_action$payload$autoR:state.autoRefreshInterval})}else if(action.type==="userChangedUrl"){const newState=store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{location:action.payload});const isCurrentlyOnListPage=Object(store_selectors["isOnEndpointPage"])(newState)&&!Object(store_selectors["hasSelectedEndpoint"])(newState);const wasPreviouslyOnListPage=Object(store_selectors["isOnEndpointPage"])(state)&&!Object(store_selectors["hasSelectedEndpoint"])(state);const isCurrentlyOnDetailsPage=Object(store_selectors["isOnEndpointPage"])(newState)&&Object(store_selectors["hasSelectedEndpoint"])(newState);const wasPreviouslyOnDetailsPage=Object(store_selectors["isOnEndpointPage"])(state)&&Object(store_selectors["hasSelectedEndpoint"])(state);if(isCurrentlyOnListPage){if(!wasPreviouslyOnListPage){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{location:action.payload,loading:true,policyItemsLoading:true,error:undefined,detailsError:undefined})}}else if(isCurrentlyOnDetailsPage){if(wasPreviouslyOnDetailsPage||wasPreviouslyOnListPage){return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{location:action.payload,detailsLoading:true,policyResponseLoading:true,error:undefined,detailsError:undefined,policyResponseError:undefined})}else{return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{location:action.payload,loading:true,detailsLoading:true,policyResponseLoading:true,error:undefined,detailsError:undefined,policyResponseError:undefined,policyItemsLoading:true})}}return store_reducer_objectSpread(store_reducer_objectSpread({},state),{},{location:action.payload,error:undefined,detailsError:undefined,policyResponseError:undefined,endpointsExist:true})}return state};var querystring_es3=__webpack_require__(340);function trusted_apps_store_reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function trusted_apps_store_reducer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){trusted_apps_store_reducer_ownKeys(Object(source),true).forEach((function(key){trusted_apps_store_reducer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{trusted_apps_store_reducer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function trusted_apps_store_reducer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const isTrustedAppsPageLocation=location=>{var _location$pathname;return Object(external_kbnSharedDeps_ReactRouterDom_["matchPath"])((_location$pathname=location.pathname)!==null&&_location$pathname!==void 0?_location$pathname:"",{path:management_common_constants["j"],exact:true})!==null};const trustedAppsListDataOutdated=(state,action)=>trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state),{},{listView:trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state.listView),{},{freshDataTimestamp:Date.now()})});const trustedAppsListResourceStateChanged=(state,action)=>trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state),{},{listView:trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state.listView),{},{listResourceState:action.payload.newState})});const trustedAppDeletionSubmissionResourceStateChanged=(state,action)=>trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state),{},{deletionDialog:trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state.deletionDialog),{},{submissionResourceState:action.payload.newState})});const trustedAppDeletionDialogStarted=(state,action)=>trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state),{},{deletionDialog:{entry:action.payload.entry,confirmed:false,submissionResourceState:{type:"UninitialisedResourceState"}}});const trustedAppDeletionDialogConfirmed=(state,action)=>trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state),{},{deletionDialog:trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state.deletionDialog),{},{confirmed:true})});const trustedAppDeletionDialogClosed=(state,action)=>trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state),{},{deletionDialog:initialDeletionDialogState()});const userChangedUrl=(state,action)=>{if(isTrustedAppsPageLocation(action.payload)){const parsedUrlsParams=Object(querystring_es3["parse"])(action.payload.search.slice(1));const location=Object(routing["b"])(parsedUrlsParams);return trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state),{},{createView:location.show?state.createView:undefined,active:true,location:location})}else{return initialTrustedAppsPageState()}};const trustedAppsCreateResourceChanged=(state,action)=>trusted_apps_store_reducer_objectSpread(trusted_apps_store_reducer_objectSpread({},state),{},{createView:action.payload});const initialDeletionDialogState=()=>({confirmed:false,submissionResourceState:{type:"UninitialisedResourceState"}});const initialTrustedAppsPageState=()=>({listView:{listResourceState:{type:"UninitialisedResourceState"},freshDataTimestamp:Date.now()},deletionDialog:initialDeletionDialogState(),createView:undefined,location:{page_index:management_common_constants["c"],page_size:management_common_constants["d"],show:undefined,view_type:"grid"},active:false});const trustedAppsPageReducer=(state=initialTrustedAppsPageState(),action)=>{switch(action.type){case"trustedAppsListDataOutdated":return trustedAppsListDataOutdated(state,action);case"trustedAppsListResourceStateChanged":return trustedAppsListResourceStateChanged(state,action);case"trustedAppDeletionSubmissionResourceStateChanged":return trustedAppDeletionSubmissionResourceStateChanged(state,action);case"trustedAppDeletionDialogStarted":return trustedAppDeletionDialogStarted(state,action);case"trustedAppDeletionDialogConfirmed":return trustedAppDeletionDialogConfirmed(state,action);case"trustedAppDeletionDialogClosed":return trustedAppDeletionDialogClosed(state,action);case"userChangedUrl":return userChangedUrl(state,action);case"userClickedSaveNewTrustedAppButton":case"serverReturnedCreateTrustedAppSuccess":case"serverReturnedCreateTrustedAppFailure":return trustedAppsCreateResourceChanged(state,action)}return state};const immutableCombineReducers=redux["combineReducers"];const mockManagementState={[management_common_constants["n"]]:initialPolicyListState(),[management_common_constants["m"]]:initialPolicyDetailsState(),[management_common_constants["k"]]:initialEndpointListState,[management_common_constants["o"]]:initialTrustedAppsPageState()};const managementReducer=immutableCombineReducers({[management_common_constants["n"]]:policyListReducer,[management_common_constants["m"]]:policyDetailsReducer,[management_common_constants["k"]]:endpointListReducer,[management_common_constants["o"]]:trustedAppsPageReducer});var policy_list_action=__webpack_require__(670);var fleet_common_=__webpack_require__(70);function ingest_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function ingest_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){ingest_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){ingest_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function ingest_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function ingest_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ingest_ownKeys(Object(source),true).forEach((function(key){ingest_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ingest_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function ingest_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const INGEST_API_ROOT="/api/fleet";const INGEST_API_PACKAGE_POLICIES="".concat(INGEST_API_ROOT,"/package_policies");const INGEST_API_AGENT_POLICIES="".concat(INGEST_API_ROOT,"/agent_policies");const INGEST_API_FLEET_AGENT_STATUS="".concat(INGEST_API_ROOT,"/agent-status");const INGEST_API_FLEET_AGENTS="".concat(INGEST_API_ROOT,"/agents");const INGEST_API_EPM_PACKAGES="".concat(INGEST_API_ROOT,"/epm/packages");const INGEST_API_DELETE_PACKAGE_POLICY="".concat(INGEST_API_PACKAGE_POLICIES,"/delete");const sendGetEndpointSpecificPackagePolicies=(http,options={})=>{var _options$query;return http.get(INGEST_API_PACKAGE_POLICIES,ingest_objectSpread(ingest_objectSpread({},options),{},{query:ingest_objectSpread(ingest_objectSpread({},options.query),{},{kuery:"".concat((options===null||options===void 0?void 0:(_options$query=options.query)===null||_options$query===void 0?void 0:_options$query.kuery)?"".concat(options.query.kuery," and "):"").concat(fleet_common_["PACKAGE_POLICY_SAVED_OBJECT_TYPE"],".package.name: endpoint")})}))};const sendGetPackagePolicy=(http,packagePolicyId,options)=>http.get("".concat(INGEST_API_PACKAGE_POLICIES,"/").concat(packagePolicyId),options);const sendDeletePackagePolicy=(http,body,options)=>http.post(INGEST_API_DELETE_PACKAGE_POLICY,ingest_objectSpread(ingest_objectSpread({},options),{},{body:JSON.stringify(body.body)}));const sendGetAgentPolicyList=(http,options)=>http.get(INGEST_API_AGENT_POLICIES,options);const sendPutPackagePolicy=(http,packagePolicyId,packagePolicy,options={})=>http.put("".concat(INGEST_API_PACKAGE_POLICIES,"/").concat(packagePolicyId),ingest_objectSpread(ingest_objectSpread({},options),{},{body:JSON.stringify(packagePolicy)}));const sendGetFleetAgentStatusForPolicy=(http,policyId,options={})=>http.get(INGEST_API_FLEET_AGENT_STATUS,ingest_objectSpread(ingest_objectSpread({},options),{},{query:{policyId:policyId}}));const sendGetFleetAgentsWithEndpoint=(http,options={})=>http.get(INGEST_API_FLEET_AGENTS,ingest_objectSpread(ingest_objectSpread({},options),{},{query:{page:1,perPage:1,kuery:'fleet-agents.packages : "endpoint"'}}));const sendGetEndpointSecurityPackage=function(){var _ref=ingest_asyncToGenerator(regeneratorRuntime.mark((function _callee(http){var options,securityPackages,endpointPackageInfo;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:options={query:{category:"security"}};_context.next=3;return http.get(INGEST_API_EPM_PACKAGES,options);case 3:securityPackages=_context.sent;endpointPackageInfo=securityPackages.response.find(epmPackage=>epmPackage.name==="endpoint");if(endpointPackageInfo){_context.next=7;break}throw new Error("Endpoint package was not found.");case 7:return _context.abrupt("return",endpointPackageInfo);case 8:case"end":return _context.stop()}}),_callee)})));return function sendGetEndpointSecurityPackage(_x){return _ref.apply(this,arguments)}}();function middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function middleware_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const policyListMiddlewareFactory=coreStart=>{const http=coreStart.http;return({getState:getState,dispatch:dispatch})=>next=>function(){var _ref=middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee(action){var state,_urlSearchParams,pageIndex,pageSize,response,_err$body,policyId,packagePolicyIds,apiResponse,_err$body2,agentPolicyId,_err$body3;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:next(action);state=getState();if(!(action.type==="userChangedUrl"&&Object(policy_list_selectors["isOnPolicyListPage"])(state)||action.type==="serverDeletedPolicy")){_context.next=18;break}if(!Object(policy_list_selectors["endpointPackageInfo"])(state)){sendGetEndpointSecurityPackage(http).then(packageInfo=>{dispatch({type:"serverReturnedEndpointPackageInfo",payload:packageInfo})}).catch(error=>{console.error(error)})}_urlSearchParams=Object(policy_list_selectors["urlSearchParams"])(state),pageIndex=_urlSearchParams.page_index,pageSize=_urlSearchParams.page_size;_context.prev=5;_context.next=8;return sendGetEndpointSpecificPackagePolicies(http,{query:{perPage:pageSize,page:pageIndex+1}});case 8:response=_context.sent;_context.next=15;break;case 11:_context.prev=11;_context.t0=_context["catch"](5);dispatch({type:"serverFailedToReturnPolicyListData",payload:(_err$body=_context.t0.body)!==null&&_err$body!==void 0?_err$body:_context.t0});return _context.abrupt("return");case 15:dispatch({type:"serverReturnedPolicyListData",payload:{policyItems:response?response.items:initialPolicyListState().policyItems,pageIndex:pageIndex,pageSize:pageSize,total:response?response.total:initialPolicyListState().total}});_context.next=47;break;case 18:if(!(action.type==="userClickedPolicyListDeleteButton")){_context.next=34;break}policyId=action.payload.policyId;packagePolicyIds=[policyId];_context.prev=21;_context.next=24;return sendDeletePackagePolicy(http,{body:{packagePolicyIds:packagePolicyIds}});case 24:apiResponse=_context.sent;_context.next=31;break;case 27:_context.prev=27;_context.t1=_context["catch"](21);dispatch({type:"serverDeletedPolicyFailure",payload:(_err$body2=_context.t1.body)!==null&&_err$body2!==void 0?_err$body2:_context.t1});return _context.abrupt("return");case 31:dispatch({type:"serverDeletedPolicy",payload:{id:apiResponse?apiResponse[0].id:"",success:true}});_context.next=47;break;case 34:if(!(action.type==="userOpenedPolicyListDeleteModal")){_context.next=47;break}agentPolicyId=action.payload.agentPolicyId;_context.prev=36;_context.next=39;return sendGetFleetAgentStatusForPolicy(http,agentPolicyId);case 39:apiResponse=_context.sent;_context.next=46;break;case 42:_context.prev=42;_context.t2=_context["catch"](36);dispatch({type:"serverReturnedPolicyAgentsSummaryForDeleteFailure",payload:(_err$body3=_context.t2.body)!==null&&_err$body3!==void 0?_err$body3:_context.t2});return _context.abrupt("return");case 46:dispatch({type:"serverReturnedPolicyAgentsSummaryForDelete",payload:{agentStatusSummary:apiResponse.results}});case 47:case"end":return _context.stop()}}),_callee,null,[[5,11],[21,27],[36,42]])})));return function(_x){return _ref.apply(this,arguments)}}()};var policy_config=__webpack_require__(649);function policy_details_middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function policy_details_middleware_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){policy_details_middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){policy_details_middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const policyDetailsMiddlewareFactory=coreStart=>{const http=coreStart.http;return({getState:getState,dispatch:dispatch})=>next=>function(){var _ref=policy_details_middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee(action){var state,id,policyItem,_yield$sendGetFleetAg,results,_ref2,updatedPolicyItem,apiResponse;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:next(action);state=getState();if(!(action.type==="userChangedUrl"&&Object(selectors["g"])(state))){_context.next=24;break}id=Object(selectors["k"])(state);_context.prev=4;_context.next=7;return sendGetPackagePolicy(http,id);case 7:policyItem=_context.sent.item;if(policyItem.inputs[0].config.policy.value.windows.popup.malware.message===""){policyItem.inputs[0].config.policy.value.windows.popup.malware.message=policy_config["a"];policyItem.inputs[0].config.policy.value.mac.popup.malware.message=policy_config["a"]}_context.next=15;break;case 11:_context.prev=11;_context.t0=_context["catch"](4);dispatch({type:"serverFailedToReturnPolicyDetailsData",payload:_context.t0.body||_context.t0});return _context.abrupt("return");case 15:dispatch({type:"serverReturnedPolicyDetailsData",payload:{policyItem:policyItem}});if(!policyItem.policy_id){_context.next=22;break}_context.next=19;return sendGetFleetAgentStatusForPolicy(http,policyItem.policy_id);case 19:_yield$sendGetFleetAg=_context.sent;results=_yield$sendGetFleetAg.results;dispatch({type:"serverReturnedPolicyDetailsAgentSummaryData",payload:{agentStatusSummary:results}});case 22:_context.next=38;break;case 24:if(!(action.type==="userClickedPolicyDetailsSaveButton")){_context.next=38;break}_ref2=Object(selectors["i"])(state),id=_ref2.id;updatedPolicyItem=Object(selectors["j"])(state);_context.prev=27;_context.next=30;return sendPutPackagePolicy(http,id,updatedPolicyItem).catch(error=>{if(!error.response||error.response.status!==409){return Promise.reject(error)}return sendGetPackagePolicy(http,id).then(packagePolicy=>{const latestUpdatedPolicyItem=packagePolicy.item;latestUpdatedPolicyItem.inputs[0].config.policy=updatedPolicyItem.inputs[0].config.policy;return sendPutPackagePolicy(http,id,Object(selectors["d"])(latestUpdatedPolicyItem))})});case 30:apiResponse=_context.sent;_context.next=37;break;case 33:_context.prev=33;_context.t1=_context["catch"](27);dispatch({type:"serverReturnedPolicyDetailsUpdateFailure",payload:{success:false,error:_context.t1.body||_context.t1}});return _context.abrupt("return");case 37:dispatch({type:"serverReturnedUpdatedPolicyDetailsData",payload:{policyItem:apiResponse.item,updateStatus:{success:true}}});case 38:case"end":return _context.stop()}}),_callee,null,[[4,11],[27,33]])})));return function(_x){return _ref.apply(this,arguments)}}()};var policy_details_action=__webpack_require__(671);var endpoint_constants=__webpack_require__(342);function store_middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function store_middleware_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){store_middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){store_middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const endpointMiddlewareFactory=(coreStart,depsStart)=>{function fetchIndexPatterns(){return _fetchIndexPatterns.apply(this,arguments)}function _fetchIndexPatterns(){_fetchIndexPatterns=store_middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var indexPatterns,fields,indexPattern;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:indexPatterns=depsStart.data.indexPatterns;_context2.next=3;return indexPatterns.getFieldsForWildcard({pattern:endpoint_constants["e"]});case 3:fields=_context2.sent;indexPattern={title:endpoint_constants["e"],fields:fields};return _context2.abrupt("return",[indexPattern]);case 6:case"end":return _context2.stop()}}),_callee2)})));return _fetchIndexPatterns.apply(this,arguments)}return({getState:getState,dispatch:dispatch})=>next=>function(){var _ref=store_middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee(action){var packageInfo,_uiQueryParams,pageIndex,pageSize,endpointResponse,decodedQuery,endpointsTotalCount,agentsWithEndpoint,ingestPolicies,indexPatterns,http,policyDataResponse,_error$body,_uiQueryParams2,response,_uiQueryParams3,selectedEndpoint,policyResponse;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:next(action);if(!((action.type==="userChangedUrl"||action.type==="appRequestedEndpointList")&&Object(store_selectors["isOnEndpointPage"])(getState())&&Object(store_selectors["hasSelectedEndpoint"])(getState())!==true)){_context.next=90;break}if(Object(store_selectors["endpointPackageInfo"])(getState())){_context.next=13;break}_context.prev=3;_context.next=6;return sendGetEndpointSecurityPackage(coreStart.http);case 6:packageInfo=_context.sent;dispatch({type:"serverReturnedEndpointPackageInfo",payload:packageInfo});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context["catch"](3);console.error(_context.t0);case 13:_uiQueryParams=Object(store_selectors["uiQueryParams"])(getState()),pageIndex=_uiQueryParams.page_index,pageSize=_uiQueryParams.page_size;_context.prev=14;decodedQuery=Object(store_selectors["searchBarQuery"])(getState());_context.next=18;return coreStart.http.post("/api/endpoint/metadata",{body:JSON.stringify({paging_properties:[{page_index:pageIndex},{page_size:pageSize}],filters:{kql:decodedQuery.query}})});case 18:endpointResponse=_context.sent;endpointResponse.request_page_index=Number(pageIndex);dispatch({type:"serverReturnedEndpointList",payload:endpointResponse});_context.prev=21;_context.next=24;return endpointsTotal(coreStart.http);case 24:endpointsTotalCount=_context.sent;dispatch({type:"serverReturnedEndpointsTotal",payload:endpointsTotalCount});_context.next=31;break;case 28:_context.prev=28;_context.t1=_context["catch"](21);dispatch({type:"serverFailedToReturnEndpointsTotal",payload:_context.t1});case 31:_context.prev=31;_context.next=34;return sendGetFleetAgentsWithEndpoint(coreStart.http);case 34:agentsWithEndpoint=_context.sent;dispatch({type:"serverReturnedAgenstWithEndpointsTotal",payload:agentsWithEndpoint.total});_context.next=41;break;case 38:_context.prev=38;_context.t2=_context["catch"](31);dispatch({type:"serverFailedToReturnAgenstWithEndpointsTotal",payload:_context.t2});case 41:_context.prev=41;_context.next=44;return getAgentAndPoliciesForEndpointsList(coreStart.http,endpointResponse.hosts,Object(store_selectors["nonExistingPolicies"])(getState()));case 44:ingestPolicies=_context.sent;if((ingestPolicies===null||ingestPolicies===void 0?void 0:ingestPolicies.packagePolicy)!==undefined){dispatch({type:"serverReturnedEndpointNonExistingPolicies",payload:ingestPolicies.packagePolicy})}if((ingestPolicies===null||ingestPolicies===void 0?void 0:ingestPolicies.agentPolicy)!==undefined){dispatch({type:"serverReturnedEndpointAgentPolicies",payload:ingestPolicies.agentPolicy})}_context.next=52;break;case 49:_context.prev=49;_context.t3=_context["catch"](41);console.error(_context.t3);case 52:_context.next=57;break;case 54:_context.prev=54;_context.t4=_context["catch"](14);dispatch({type:"serverFailedToReturnEndpointList",payload:_context.t4});case 57:if(!(Object(store_selectors["patterns"])(getState()).length===0&&Object(store_selectors["isTransformEnabled"])(getState()))){_context.next=68;break}_context.prev=58;_context.next=61;return fetchIndexPatterns();case 61:indexPatterns=_context.sent;if(indexPatterns!==undefined){dispatch({type:"serverReturnedMetadataPatterns",payload:indexPatterns})}_context.next=68;break;case 65:_context.prev=65;_context.t5=_context["catch"](58);dispatch({type:"serverFailedToReturnMetadataPatterns",payload:_context.t5});case 68:if(!(endpointResponse&&endpointResponse.hosts.length===0)){_context.next=88;break}http=coreStart.http;_context.next=72;return doEndpointsExist(http);case 72:if(!_context.sent){_context.next=74;break}return _context.abrupt("return");case 74:dispatch({type:"serverReturnedEndpointExistValue",payload:false});_context.prev=75;_context.next=78;return sendGetEndpointSpecificPackagePolicies(http,{query:{perPage:50,page:1}});case 78:policyDataResponse=_context.sent;dispatch({type:"serverReturnedPoliciesForOnboarding",payload:{policyItems:policyDataResponse.items}});_context.next=86;break;case 82:_context.prev=82;_context.t6=_context["catch"](75);dispatch({type:"serverFailedToReturnPoliciesForOnboarding",payload:(_error$body=_context.t6.body)!==null&&_error$body!==void 0?_error$body:_context.t6});return _context.abrupt("return");case 86:_context.next=90;break;case 88:dispatch({type:"serverCancelledPolicyItemsLoading"});dispatch({type:"serverReturnedEndpointExistValue",payload:true});case 90:if(!(action.type==="userChangedUrl"&&Object(store_selectors["hasSelectedEndpoint"])(getState())===true)){_context.next=151;break}dispatch({type:"serverCancelledPolicyItemsLoading"});if(!(Object(store_selectors["listData"])(getState()).length===0)){_context.next=118;break}_uiQueryParams2=Object(store_selectors["uiQueryParams"])(getState()),pageIndex=_uiQueryParams2.page_index,pageSize=_uiQueryParams2.page_size;_context.prev=94;_context.next=97;return coreStart.http.post("/api/endpoint/metadata",{body:JSON.stringify({paging_properties:[{page_index:pageIndex},{page_size:pageSize}]})});case 97:response=_context.sent;response.request_page_index=Number(pageIndex);dispatch({type:"serverReturnedEndpointList",payload:response});_context.prev=100;_context.next=103;return getAgentAndPoliciesForEndpointsList(coreStart.http,response.hosts,Object(store_selectors["nonExistingPolicies"])(getState()));case 103:ingestPolicies=_context.sent;if((ingestPolicies===null||ingestPolicies===void 0?void 0:ingestPolicies.packagePolicy)!==undefined){dispatch({type:"serverReturnedEndpointNonExistingPolicies",payload:ingestPolicies.packagePolicy})}if((ingestPolicies===null||ingestPolicies===void 0?void 0:ingestPolicies.agentPolicy)!==undefined){dispatch({type:"serverReturnedEndpointAgentPolicies",payload:ingestPolicies.agentPolicy})}_context.next=111;break;case 108:_context.prev=108;_context.t7=_context["catch"](100);console.error(_context.t7);case 111:_context.next=116;break;case 113:_context.prev=113;_context.t8=_context["catch"](94);dispatch({type:"serverFailedToReturnEndpointList",payload:_context.t8});case 116:_context.next=119;break;case 118:dispatch({type:"serverCancelledEndpointListLoading"});case 119:_uiQueryParams3=Object(store_selectors["uiQueryParams"])(getState()),selectedEndpoint=_uiQueryParams3.selected_endpoint;_context.prev=120;_context.next=123;return coreStart.http.get("/api/endpoint/metadata/".concat(selectedEndpoint));case 123:response=_context.sent;dispatch({type:"serverReturnedEndpointDetails",payload:response});_context.prev=125;_context.next=128;return getAgentAndPoliciesForEndpointsList(coreStart.http,[response],Object(store_selectors["nonExistingPolicies"])(getState()));case 128:ingestPolicies=_context.sent;if(ingestPolicies!==undefined){dispatch({type:"serverReturnedEndpointNonExistingPolicies",payload:ingestPolicies.packagePolicy})}if((ingestPolicies===null||ingestPolicies===void 0?void 0:ingestPolicies.agentPolicy)!==undefined){dispatch({type:"serverReturnedEndpointAgentPolicies",payload:ingestPolicies.agentPolicy})}_context.next=136;break;case 133:_context.prev=133;_context.t9=_context["catch"](125);console.error(_context.t9);case 136:_context.next=141;break;case 138:_context.prev=138;_context.t10=_context["catch"](120);dispatch({type:"serverFailedToReturnEndpointDetails",payload:_context.t10});case 141:_context.prev=141;_context.next=144;return coreStart.http.get("/api/endpoint/policy_response",{query:{agentId:selectedEndpoint}});case 144:policyResponse=_context.sent;dispatch({type:"serverReturnedEndpointPolicyResponse",payload:policyResponse});_context.next=151;break;case 148:_context.prev=148;_context.t11=_context["catch"](141);dispatch({type:"serverFailedToReturnEndpointPolicyResponse",payload:_context.t11});case 151:case"end":return _context.stop()}}),_callee,null,[[3,10],[14,54],[21,28],[31,38],[41,49],[58,65],[75,82],[94,113],[100,108],[120,138],[125,133],[141,148]])})));return function(_x){return _ref.apply(this,arguments)}}()};const getAgentAndPoliciesForEndpointsList=function(){var _ref2=store_middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee3(http,hosts,currentNonExistingPolicies){var policyIdsToCheck,policiesFound,nonExistingPackagePoliciesAndExistingAgentPolicies;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(!(hosts.length===0)){_context3.next=2;break}return _context3.abrupt("return");case 2:policyIdsToCheck=Array.from(new Set(hosts.filter(host=>!currentNonExistingPolicies[host.metadata.Endpoint.policy.applied.id]).map(host=>host.metadata.Endpoint.policy.applied.id)));if(!(policyIdsToCheck.length===0)){_context3.next=5;break}return _context3.abrupt("return");case 5:_context3.next=7;return sendGetAgentPolicyList(http,{query:{kuery:"".concat(fleet_common_["AGENT_POLICY_SAVED_OBJECT_TYPE"],".package_policies: (").concat(policyIdsToCheck.join(" or "),")")}});case 7:policiesFound=_context3.sent.items.reduce((list,agentPolicy)=>{agentPolicy.package_policies.forEach(packagePolicy=>{list.packagePolicy[packagePolicy]=true;list.agentPolicy[packagePolicy]=agentPolicy.id});return list},{packagePolicy:{},agentPolicy:{}});nonExistingPackagePoliciesAndExistingAgentPolicies=policyIdsToCheck.reduce((list,policyId)=>{if(policiesFound.packagePolicy[policyId]){list.agentPolicy[policyId]=policiesFound.agentPolicy[policyId];return list}list.packagePolicy[policyId]=true;return list},{packagePolicy:{},agentPolicy:{}});if(!(Object.keys(nonExistingPackagePoliciesAndExistingAgentPolicies.packagePolicy).length===0&&Object.keys(nonExistingPackagePoliciesAndExistingAgentPolicies.agentPolicy).length===0)){_context3.next=11;break}return _context3.abrupt("return");case 11:return _context3.abrupt("return",nonExistingPackagePoliciesAndExistingAgentPolicies);case 12:case"end":return _context3.stop()}}),_callee3)})));return function getAgentAndPoliciesForEndpointsList(_x2,_x3,_x4){return _ref2.apply(this,arguments)}}();const endpointsTotal=function(){var _ref3=store_middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee4(http){return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return http.post("/api/endpoint/metadata",{body:JSON.stringify({paging_properties:[{page_index:0},{page_size:1}]})});case 3:return _context4.abrupt("return",_context4.sent.total);case 6:_context4.prev=6;_context4.t0=_context4["catch"](0);console.error("error while trying to check for total endpoints");console.error(_context4.t0);case 10:return _context4.abrupt("return",0);case 11:case"end":return _context4.stop()}}),_callee4,null,[[0,6]])})));return function endpointsTotal(_x5){return _ref3.apply(this,arguments)}}();const doEndpointsExist=function(){var _ref4=store_middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee5(http){return regeneratorRuntime.wrap((function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return endpointsTotal(http);case 3:_context5.t0=_context5.sent;return _context5.abrupt("return",_context5.t0>0);case 7:_context5.prev=7;_context5.t1=_context5["catch"](0);console.error("error while trying to check if endpoints exist");console.error(_context5.t1);case 11:return _context5.abrupt("return",false);case 12:case"end":return _context5.stop()}}),_callee5,null,[[0,7]])})));return function doEndpointsExist(_x6){return _ref4.apply(this,arguments)}}();const resolvePathVariables=(path,variables)=>Object.keys(variables).reduce((acc,paramName)=>acc.replace(new RegExp("{".concat(paramName,"}"),"g"),String(variables[paramName])),path);function service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function service_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}class service_TrustedAppsHttpService{constructor(http){this.http=http}getTrustedAppsList(request){var _this=this;return service_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",_this.http.get(endpoint_constants["c"],{query:request}));case 1:case"end":return _context.stop()}}),_callee)})))()}deleteTrustedApp(request){var _this2=this;return service_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",_this2.http.delete(resolvePathVariables(endpoint_constants["b"],request)));case 1:case"end":return _context2.stop()}}),_callee2)})))()}createTrustedApp(request){var _this3=this;return service_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",_this3.http.post(endpoint_constants["a"],{body:JSON.stringify(request)}));case 1:case"end":return _context3.stop()}}),_callee3)})))()}}var trusted_apps_state=__webpack_require__(650);var trusted_apps_store_selectors=__webpack_require__(196);function trusted_apps_store_middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function trusted_apps_store_middleware_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){trusted_apps_store_middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){trusted_apps_store_middleware_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const createTrustedAppsListResourceStateChangedAction=newState=>({type:"trustedAppsListResourceStateChanged",payload:{newState:newState}});const refreshListIfNeeded=function(){var _ref=trusted_apps_store_middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee(store,trustedAppsService){var pageIndex,pageSize,response;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!Object(trusted_apps_store_selectors["t"])(store.getState())){_context.next=14;break}store.dispatch(createTrustedAppsListResourceStateChangedAction({type:"LoadingResourceState",previousState:Object(trusted_apps_store_selectors["l"])(store.getState())}));_context.prev=2;pageIndex=Object(trusted_apps_store_selectors["c"])(store.getState());pageSize=Object(trusted_apps_store_selectors["d"])(store.getState());_context.next=7;return trustedAppsService.getTrustedAppsList({page:pageIndex+1,per_page:pageSize});case 7:response=_context.sent;store.dispatch(createTrustedAppsListResourceStateChangedAction({type:"LoadedResourceState",data:{items:response.data,pageIndex:pageIndex,pageSize:pageSize,totalItemsCount:response.total,timestamp:Date.now()}}));_context.next=14;break;case 11:_context.prev=11;_context.t0=_context["catch"](2);store.dispatch(createTrustedAppsListResourceStateChangedAction({type:"FailedResourceState",error:_context.t0,lastLoadedState:Object(trusted_apps_store_selectors["h"])(store.getState())}));case 14:case"end":return _context.stop()}}),_callee,null,[[2,11]])})));return function refreshListIfNeeded(_x,_x2){return _ref.apply(this,arguments)}}();const createTrustedAppDeletionSubmissionResourceStateChanged=newState=>({type:"trustedAppDeletionSubmissionResourceStateChanged",payload:{newState:newState}});const submitDeletionIfNeeded=function(){var _ref2=trusted_apps_store_middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee2(store,trustedAppsService){var submissionResourceState,entry;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:submissionResourceState=Object(trusted_apps_store_selectors["g"])(store.getState());entry=Object(trusted_apps_store_selectors["e"])(store.getState());if(!(Object(trusted_apps_state["isStaleResourceState"])(submissionResourceState)&&entry!==undefined)){_context2.next=15;break}store.dispatch(createTrustedAppDeletionSubmissionResourceStateChanged({type:"LoadingResourceState",previousState:submissionResourceState}));_context2.prev=4;_context2.next=7;return trustedAppsService.deleteTrustedApp({id:entry.id});case 7:store.dispatch(createTrustedAppDeletionSubmissionResourceStateChanged({type:"LoadedResourceState",data:null}));store.dispatch({type:"trustedAppDeletionDialogClosed"});store.dispatch({type:"trustedAppsListDataOutdated"});_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2["catch"](4);store.dispatch(createTrustedAppDeletionSubmissionResourceStateChanged({type:"FailedResourceState",error:_context2.t0,lastLoadedState:Object(trusted_apps_state["getLastLoadedResourceState"])(submissionResourceState)}));case 15:case"end":return _context2.stop()}}),_callee2,null,[[4,12]])})));return function submitDeletionIfNeeded(_x3,_x4){return _ref2.apply(this,arguments)}}();const createTrustedApp=function(){var _ref3=trusted_apps_store_middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee3(store,trustedAppsService){var dispatch,getState,newTrustedApp,createdTrustedApp;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:dispatch=store.dispatch,getState=store.getState;if(!Object(trusted_apps_store_selectors["o"])(getState())){_context3.next=14;break}_context3.prev=2;newTrustedApp=Object(trusted_apps_store_selectors["n"])(getState());_context3.next=6;return trustedAppsService.createTrustedApp(newTrustedApp);case 6:createdTrustedApp=_context3.sent.data;dispatch({type:"serverReturnedCreateTrustedAppSuccess",payload:{type:"success",data:createdTrustedApp}});store.dispatch({type:"trustedAppsListDataOutdated"});_context3.next=14;break;case 11:_context3.prev=11;_context3.t0=_context3["catch"](2);dispatch({type:"serverReturnedCreateTrustedAppFailure",payload:{type:"failure",data:_context3.t0.body||_context3.t0}});case 14:case"end":return _context3.stop()}}),_callee3,null,[[2,11]])})));return function createTrustedApp(_x5,_x6){return _ref3.apply(this,arguments)}}();const createTrustedAppsPageMiddleware=trustedAppsService=>store=>next=>function(){var _ref4=trusted_apps_store_middleware_asyncToGenerator(regeneratorRuntime.mark((function _callee4(action){return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:next(action);if(!(action.type==="userChangedUrl"||action.type==="trustedAppsListDataOutdated")){_context4.next=4;break}_context4.next=4;return refreshListIfNeeded(store,trustedAppsService);case 4:if(!(action.type==="trustedAppDeletionDialogConfirmed")){_context4.next=7;break}_context4.next=7;return submitDeletionIfNeeded(store,trustedAppsService);case 7:if(action.type==="userClickedSaveNewTrustedAppButton"){createTrustedApp(store,trustedAppsService)}case 8:case"end":return _context4.stop()}}),_callee4)})));return function(_x7){return _ref4.apply(this,arguments)}}();const trustedAppsPageMiddlewareFactory=coreStart=>createTrustedAppsPageMiddleware(new service_TrustedAppsHttpService(coreStart.http));const createSubStateSelector=namespace=>state=>state[management_common_constants["l"]][namespace];const managementMiddlewareFactory=(coreStart,depsStart)=>[Object(common_store["substateMiddlewareFactory"])(createSubStateSelector(management_common_constants["n"]),policyListMiddlewareFactory(coreStart,depsStart)),Object(common_store["substateMiddlewareFactory"])(createSubStateSelector(management_common_constants["m"]),policyDetailsMiddlewareFactory(coreStart,depsStart)),Object(common_store["substateMiddlewareFactory"])(createSubStateSelector(management_common_constants["k"]),endpointMiddlewareFactory(coreStart,depsStart)),Object(common_store["substateMiddlewareFactory"])(createSubStateSelector(management_common_constants["o"]),trustedAppsPageMiddlewareFactory(coreStart,depsStart))];class management_Management{setup(){}start(core,plugins){return{SubPluginRoutes:ManagementRoutes,store:{initialState:{management:undefined},reducer:{management:managementReducer},middleware:managementMiddlewareFactory(core,plugins)}}}}const subPluginClasses={Detections:detections_Detections,Cases:cases_Cases,Hosts:public_hosts_Hosts,Network:public_network_Network,Overview:overview_Overview,Timelines:timelines_Timelines,Management:management_Management}},147:function(module,exports,__webpack_require__){"use strict";module.exports=whitespace;var fromCode=String.fromCharCode;var re=/\s/;function whitespace(character){return re.test(typeof character==="number"?fromCode(character):character.charAt(0))}},175:function(module,exports){module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){var target={};for(var i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target}},213:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return ISSUE_TYPES_API_ERROR}));__webpack_require__.d(__webpack_exports__,"a",(function(){return FIELDS_API_ERROR}));__webpack_require__.d(__webpack_exports__,"c",(function(){return ISSUES_API_ERROR}));__webpack_require__.d(__webpack_exports__,"b",(function(){return GET_ISSUE_API_ERROR}));__webpack_require__.d(__webpack_exports__,"h",(function(){return SEARCH_ISSUES_COMBO_BOX_ARIA_LABEL}));__webpack_require__.d(__webpack_exports__,"j",(function(){return SEARCH_ISSUES_PLACEHOLDER}));__webpack_require__.d(__webpack_exports__,"i",(function(){return SEARCH_ISSUES_LOADING}));__webpack_require__.d(__webpack_exports__,"g",(function(){return PRIORITY}));__webpack_require__.d(__webpack_exports__,"d",(function(){return ISSUE_TYPE}));__webpack_require__.d(__webpack_exports__,"f",(function(){return PARENT_ISSUE}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);const ISSUE_TYPES_API_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.jira.unableToGetIssueTypesMessage",{defaultMessage:"Unable to get issue types"});const FIELDS_API_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.jira.unableToGetFieldsMessage",{defaultMessage:"Unable to get fields"});const ISSUES_API_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.jira.unableToGetIssuesMessage",{defaultMessage:"Unable to get issues"});const GET_ISSUE_API_ERROR=id=>_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.jira.unableToGetIssueMessage",{defaultMessage:"Unable to get issue with id {id}",values:{id:id}});const SEARCH_ISSUES_COMBO_BOX_ARIA_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.jira.searchIssuesComboBoxAriaLabel",{defaultMessage:"Type to search"});const SEARCH_ISSUES_PLACEHOLDER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.jira.searchIssuesComboBoxPlaceholder",{defaultMessage:"Type to search"});const SEARCH_ISSUES_LOADING=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.jira.searchIssuesLoading",{defaultMessage:"Loading..."});const PRIORITY=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.case.settings.jira.prioritySelectFieldLabel",{defaultMessage:"Priority"});const ISSUE_TYPE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.case.settings.jira.issueTypesSelectFieldLabel",{defaultMessage:"Issue type"});const PARENT_ISSUE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.case.settings.jira.parentIssueSearchLabel",{defaultMessage:"Parent issue"})},240:function(module,exports){exports=module.exports=trim;function trim(str){if(str.trim)return str.trim();return exports.right(exports.left(str))}exports.left=function(str){if(str.trimLeft)return str.trimLeft();return str.replace(/^\s\s*/,"")};exports.right=function(str){if(str.trimRight)return str.trimRight();var whitespace_pattern=/\s/,i=str.length;while(whitespace_pattern.test(str.charAt(--i)));return str.slice(0,i+1)}},270:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return connectorsConfiguration}));var _triggers_actions_ui_public_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(77);var _triggers_actions_ui_public_common__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_triggers_actions_ui_public_common__WEBPACK_IMPORTED_MODULE_0__);const connectorsConfiguration={".servicenow":_triggers_actions_ui_public_common__WEBPACK_IMPORTED_MODULE_0__["ServiceNowConnectorConfiguration"],".jira":_triggers_actions_ui_public_common__WEBPACK_IMPORTED_MODULE_0__["JiraConnectorConfiguration"],".resilient":_triggers_actions_ui_public_common__WEBPACK_IMPORTED_MODULE_0__["ResilientConnectorConfiguration"]}},343:function(module,exports,__webpack_require__){"use strict";module.exports=decimal;function decimal(character){var code=typeof character==="string"?character.charCodeAt(0):character;return code>=48&&code<=57}},344:function(module,exports,__webpack_require__){"use strict";module.exports=visit;var visitParents=__webpack_require__(1042);var CONTINUE=visitParents.CONTINUE;var SKIP=visitParents.SKIP;var EXIT=visitParents.EXIT;visit.CONTINUE=CONTINUE;visit.SKIP=SKIP;visit.EXIT=EXIT;function visit(tree,test,visitor,reverse){if(typeof test==="function"&&typeof visitor!=="function"){reverse=visitor;visitor=test;test=null}visitParents(tree,test,overload,reverse);function overload(node,parents){var parent=parents[parents.length-1];var index=parent?parent.children.indexOf(node):null;return visitor(node,index,parent)}}},345:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return INCIDENT_TYPES_API_ERROR}));__webpack_require__.d(__webpack_exports__,"d",(function(){return SEVERITY_API_ERROR}));__webpack_require__.d(__webpack_exports__,"c",(function(){return INCIDENT_TYPES_PLACEHOLDER}));__webpack_require__.d(__webpack_exports__,"b",(function(){return INCIDENT_TYPES_LABEL}));__webpack_require__.d(__webpack_exports__,"e",(function(){return SEVERITY_LABEL}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);const INCIDENT_TYPES_API_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.case.settings.resilient.unableToGetIncidentTypesMessage",{defaultMessage:"Unable to get incident types"});const SEVERITY_API_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.case.settings.resilient.unableToGetSeverityMessage",{defaultMessage:"Unable to get severity"});const INCIDENT_TYPES_PLACEHOLDER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.case.settings.resilient.incidentTypesPlaceholder",{defaultMessage:"Choose types"});const INCIDENT_TYPES_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.case.settings.resilient.incidentTypesLabel",{defaultMessage:"Incident Types"});const SEVERITY_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.case.settings.resilient.severityLabel",{defaultMessage:"Severity"})},431:function(module,exports,__webpack_require__){(function(process){function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),(function(p){return!!p})),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=substr(path,-1)==="/";path=normalizeArray(filter(path.split("/"),(function(p){return!!p})),!isAbsolute).join("/");if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path};exports.isAbsolute=function(path){return path.charAt(0)==="/"};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,(function(p,index){if(typeof p!=="string"){throw new TypeError("Arguments to path.join must be strings")}return p})).join("/"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!=="")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!=="")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){if(typeof path!=="string")path=path+"";if(path.length===0)return".";var code=path.charCodeAt(0);var hasRoot=code===47;var end=-1;var matchedSlash=true;for(var i=path.length-1;i>=1;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){end=i;break}}else{matchedSlash=false}}if(end===-1)return hasRoot?"/":".";if(hasRoot&&end===1){return"/"}return path.slice(0,end)};function basename(path){if(typeof path!=="string")path=path+"";var start=0;var end=-1;var matchedSlash=true;var i;for(i=path.length-1;i>=0;--i){if(path.charCodeAt(i)===47){if(!matchedSlash){start=i+1;break}}else if(end===-1){matchedSlash=false;end=i+1}}if(end===-1)return"";return path.slice(start,end)}exports.basename=function(path,ext){var f=basename(path);if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){if(typeof path!=="string")path=path+"";var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var preDotState=0;for(var i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break}continue}if(end===-1){matchedSlash=false;end=i+1}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1}else if(startDot!==-1){preDotState=-1}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){return""}return path.slice(startDot,end)};function filter(xs,f){if(xs.filter)return xs.filter(f);var res=[];for(var i=0;i<xs.length;i++){if(f(xs[i],i,xs))res.push(xs[i])}return res}var substr="ab".substr(-1)==="b"?function(str,start,len){return str.substr(start,len)}:function(str,start,len){if(start<0)start=str.length+start;return str.substr(start,len)}}).call(this,__webpack_require__(180))},432:function(module,exports,__webpack_require__){"use strict";var legacy=__webpack_require__(1031);var invalid=__webpack_require__(1032);var decimal=__webpack_require__(343);var hexadecimal=__webpack_require__(1033);var alphanumerical=__webpack_require__(1034);var decodeEntity=__webpack_require__(1035);module.exports=parseEntities;var own={}.hasOwnProperty;var fromCharCode=String.fromCharCode;var noop=Function.prototype;var defaults={warning:null,reference:null,text:null,warningContext:null,referenceContext:null,textContext:null,position:{},additional:null,attribute:false,nonTerminated:true};var NAMED="named";var HEXADECIMAL="hexadecimal";var DECIMAL="decimal";var BASE={};BASE[HEXADECIMAL]=16;BASE[DECIMAL]=10;var TESTS={};TESTS[NAMED]=alphanumerical;TESTS[DECIMAL]=decimal;TESTS[HEXADECIMAL]=hexadecimal;var NAMED_NOT_TERMINATED=1;var NUMERIC_NOT_TERMINATED=2;var NAMED_EMPTY=3;var NUMERIC_EMPTY=4;var NAMED_UNKNOWN=5;var NUMERIC_DISALLOWED=6;var NUMERIC_PROHIBITED=7;var MESSAGES={};MESSAGES[NAMED_NOT_TERMINATED]="Named character references must be terminated by a semicolon";MESSAGES[NUMERIC_NOT_TERMINATED]="Numeric character references must be terminated by a semicolon";MESSAGES[NAMED_EMPTY]="Named character references cannot be empty";MESSAGES[NUMERIC_EMPTY]="Numeric character references cannot be empty";MESSAGES[NAMED_UNKNOWN]="Named character references must be known";MESSAGES[NUMERIC_DISALLOWED]="Numeric character references cannot be disallowed";MESSAGES[NUMERIC_PROHIBITED]="Numeric character references cannot be outside the permissible Unicode range";function parseEntities(value,options){var settings={};var option;var key;if(!options){options={}}for(key in defaults){option=options[key];settings[key]=option===null||option===undefined?defaults[key]:option}if(settings.position.indent||settings.position.start){settings.indent=settings.position.indent||[];settings.position=settings.position.start}return parse(value,settings)}function parse(value,settings){var additional=settings.additional;var nonTerminated=settings.nonTerminated;var handleText=settings.text;var handleReference=settings.reference;var handleWarning=settings.warning;var textContext=settings.textContext;var referenceContext=settings.referenceContext;var warningContext=settings.warningContext;var pos=settings.position;var indent=settings.indent||[];var length=value.length;var index=0;var lines=-1;var column=pos.column||1;var line=pos.line||1;var queue="";var result=[];var entityCharacters;var namedEntity;var terminated;var characters;var character;var reference;var following;var warning;var reason;var output;var entity;var begin;var start;var type;var test;var prev;var next;var diff;var end;prev=now();warning=handleWarning?parseError:noop;index--;length++;while(++index<length){if(character==="\n"){column=indent[lines]||1}character=at(index);if(character!=="&"){if(character==="\n"){line++;lines++;column=0}if(character){queue+=character;column++}else{flush()}}else{following=at(index+1);if(following==="\t"||following==="\n"||following==="\f"||following===" "||following==="<"||following==="&"||following===""||additional&&following===additional){queue+=character;column++;continue}start=index+1;begin=start;end=start;if(following!=="#"){type=NAMED}else{end=++begin;following=at(end);if(following==="x"||following==="X"){type=HEXADECIMAL;end=++begin}else{type=DECIMAL}}entityCharacters="";entity="";characters="";test=TESTS[type];end--;while(++end<length){following=at(end);if(!test(following)){break}characters+=following;if(type===NAMED&&own.call(legacy,characters)){entityCharacters=characters;entity=legacy[characters]}}terminated=at(end)===";";if(terminated){end++;namedEntity=type===NAMED?decodeEntity(characters):false;if(namedEntity){entityCharacters=characters;entity=namedEntity}}diff=1+end-start;if(!terminated&&!nonTerminated){}else if(!characters){if(type!==NAMED){warning(NUMERIC_EMPTY,diff)}}else if(type===NAMED){if(terminated&&!entity){warning(NAMED_UNKNOWN,1)}else{if(entityCharacters!==characters){end=begin+entityCharacters.length;diff=1+end-begin;terminated=false}if(!terminated){reason=entityCharacters?NAMED_NOT_TERMINATED:NAMED_EMPTY;if(!settings.attribute){warning(reason,diff)}else{following=at(end);if(following==="="){warning(reason,diff);entity=null}else if(alphanumerical(following)){entity=null}else{warning(reason,diff)}}}}reference=entity}else{if(!terminated){warning(NUMERIC_NOT_TERMINATED,diff)}reference=parseInt(characters,BASE[type]);if(prohibited(reference)){warning(NUMERIC_PROHIBITED,diff);reference="�"}else if(reference in invalid){warning(NUMERIC_DISALLOWED,diff);reference=invalid[reference]}else{output="";if(disallowed(reference)){warning(NUMERIC_DISALLOWED,diff)}if(reference>65535){reference-=65536;output+=fromCharCode(reference>>>(10&1023)|55296);reference=56320|reference&1023}reference=output+fromCharCode(reference)}}if(!reference){characters=value.slice(start-1,end);queue+=characters;column+=characters.length;index=end-1}else{flush();prev=now();index=end-1;column+=end-start+1;result.push(reference);next=now();next.offset++;if(handleReference){handleReference.call(referenceContext,reference,{start:prev,end:next},value.slice(start-1,end))}prev=next}}}return result.join("");function now(){return{line:line,column:column,offset:index+(pos.offset||0)}}function parseError(code,offset){var position=now();position.column+=offset;position.offset+=offset;handleWarning.call(warningContext,MESSAGES[code],position,code)}function at(position){return value.charAt(position)}function flush(){if(queue){result.push(queue);if(handleText){handleText.call(textContext,queue,{start:prev,end:now()})}queue=""}}}function prohibited(code){return code>=55296&&code<=57343||code>1114111}function disallowed(code){return code>=1&&code<=8||code===11||code>=13&&code<=31||code>=127&&code<=159||code>=64976&&code<=65007||(code&65535)===65535||(code&65535)===65534}},433:function(module,exports,__webpack_require__){"use strict";
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var res="";var cache;module.exports=repeat;function repeat(str,num){if(typeof str!=="string"){throw new TypeError("expected a string")}if(num===1)return str;if(num===2)return str+str;var max=str.length*num;if(cache!==str||typeof cache==="undefined"){cache=str;res=""}else if(res.length>=max){return res.substr(0,max)}while(max>res.length&&num>1){if(num&1){res+=str}num>>=1;str+=str}res+=str;res=res.substr(0,max);return res}},434:function(module,exports,__webpack_require__){"use strict";module.exports=trimTrailingLines;var line="\n";function trimTrailingLines(value){var val=String(value);var index=val.length;while(val.charAt(--index)===line){}return val.slice(0,index+1)}},435:function(module,exports,__webpack_require__){"use strict";module.exports=interrupt;function interrupt(interruptors,tokenizers,ctx,params){var bools=["pedantic","commonmark"];var count=bools.length;var length=interruptors.length;var index=-1;var interruptor;var config;var fn;var offset;var bool;var ignore;while(++index<length){interruptor=interruptors[index];config=interruptor[1]||{};fn=interruptor[0];offset=-1;ignore=false;while(++offset<count){bool=bools[offset];if(config[bool]!==undefined&&config[bool]!==ctx.options[bool]){ignore=true;break}}if(ignore){continue}if(tokenizers[fn].apply(ctx,params)){return true}}return false}},436:function(module,exports,__webpack_require__){"use strict";var collapseWhiteSpace=__webpack_require__(1055);module.exports=normalize;function normalize(value){return collapseWhiteSpace(value).toLowerCase()}},661:function(module,exports,__webpack_require__){"use strict";module.exports=alphabetical;function alphabetical(character){var code=typeof character==="string"?character.charCodeAt(0):character;return code>=97&&code<=122||code>=65&&code<=90}},662:function(module,exports,__webpack_require__){"use strict";module.exports={position:true,gfm:true,commonmark:false,footnotes:false,pedantic:false,blocks:__webpack_require__(1039)}},663:function(module,exports,__webpack_require__){"use strict";module.exports=indentation;var characters={" ":1,"\t":4};function indentation(value){var index=0;var indent=0;var character=value.charAt(index);var stops={};var size;while(character in characters){size=characters[character];indent+=size;if(size>1){indent=Math.floor(indent/size)*size}stops[indent]=index;character=value.charAt(++index)}return{indent:indent,stops:stops}}},664:function(module,exports,__webpack_require__){"use strict";var attributeName="[a-zA-Z_:][a-zA-Z0-9:._-]*";var unquoted="[^\"'=<>`\\u0000-\\u0020]+";var singleQuoted="'[^']*'";var doubleQuoted='"[^"]*"';var attributeValue="(?:"+unquoted+"|"+singleQuoted+"|"+doubleQuoted+")";var attribute="(?:\\s+"+attributeName+"(?:\\s*=\\s*"+attributeValue+")?)";var openTag="<[A-Za-z][A-Za-z0-9\\-]*"+attribute+"*\\s*\\/?>";var closeTag="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>";var comment="\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e";var processing="<[?].*?[?]>";var declaration="<![A-Za-z]+\\s+[^>]*>";var cdata="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>";exports.openCloseTag=new RegExp("^(?:"+openTag+"|"+closeTag+")");exports.tag=new RegExp("^(?:"+openTag+"|"+closeTag+"|"+comment+"|"+processing+"|"+declaration+"|"+cdata+")")},665:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("<",fromIndex)}},666:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var link=value.indexOf("[",fromIndex);var image=value.indexOf("![",fromIndex);if(image===-1){return link}return link<image?link:image}},667:function(module,exports){},668:function(module,exports){},669:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return SEVERITY_HIGH}));__webpack_require__.d(__webpack_exports__,"e",(function(){return SEVERITY_MEDIUM}));__webpack_require__.d(__webpack_exports__,"d",(function(){return SEVERITY_LOW}));__webpack_require__.d(__webpack_exports__,"f",(function(){return URGENCY}));__webpack_require__.d(__webpack_exports__,"b",(function(){return SEVERITY}));__webpack_require__.d(__webpack_exports__,"a",(function(){return IMPACT}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);const SEVERITY_HIGH=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.servicenow.severitySelectHighOptionLabel",{defaultMessage:"High"});const SEVERITY_MEDIUM=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.servicenow.severitySelectMediumOptionLabel",{defaultMessage:"Medium"});const SEVERITY_LOW=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.servicenow.severitySelectLowOptionLabel",{defaultMessage:"Low"});const URGENCY=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.serviceNow.urgencySelectFieldLabel",{defaultMessage:"Urgency"});const SEVERITY=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.serviceNow.severitySelectFieldLabel",{defaultMessage:"Severity"});const IMPACT=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.components.settings.serviceNow.impactSelectFieldLabel",{defaultMessage:"Impact"})},670:function(module,exports){},671:function(module,exports){}}]);