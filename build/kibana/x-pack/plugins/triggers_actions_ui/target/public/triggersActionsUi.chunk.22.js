/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["triggersActionsUi_bundle_jsonpfunction"]=window["triggersActionsUi_bundle_jsonpfunction"]||[]).push([[22],{209:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",(function(){return IndexActionConnectorFields}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__);var _kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8);var _kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__);var _common_lib_get_time_options__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(21);var _common_index_controls__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(39);var _common_lib_kibana__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(37);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const IndexActionConnectorFields=({action:action,editActionConfig:editActionConfig,errors:errors,readOnly:readOnly})=>{const _useKibana$services=Object(_common_lib_kibana__WEBPACK_IMPORTED_MODULE_6__["b"])().services,http=_useKibana$services.http,docLinks=_useKibana$services.docLinks;const _action$config=action.config,index=_action$config.index,refresh=_action$config.refresh,executionTimeField=_action$config.executionTimeField;const _useState=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])(executionTimeField!=null),_useState2=_slicedToArray(_useState,2),hasTimeFieldCheckbox=_useState2[0],setTimeFieldCheckboxState=_useState2[1];const _useState3=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])([]),_useState4=_slicedToArray(_useState3,2),indexPatterns=_useState4[0],setIndexPatterns=_useState4[1];const _useState5=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])([]),_useState6=_slicedToArray(_useState5,2),indexOptions=_useState6[0],setIndexOptions=_useState6[1];const _useState7=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])([_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["a"]]),_useState8=_slicedToArray(_useState7,2),timeFieldOptions=_useState8[0],setTimeFieldOptions=_useState8[1];const _useState9=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])(false),_useState10=_slicedToArray(_useState9,2),isIndiciesLoading=_useState10[0],setIsIndiciesLoading=_useState10[1];Object(react__WEBPACK_IMPORTED_MODULE_0__["useEffect"])(()=>{const indexPatternsFunction=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var currentEsFields,timeFields;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.t0=setIndexPatterns;_context.next=3;return Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["d"])();case 3:_context.t1=_context.sent;(0,_context.t0)(_context.t1);if(!index){_context.next=11;break}_context.next=8;return Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["b"])(http,[index]);case 8:currentEsFields=_context.sent;timeFields=Object(_common_lib_get_time_options__WEBPACK_IMPORTED_MODULE_4__["a"])(currentEsFields);setTimeFieldOptions([_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["a"],...timeFields]);case 11:case"end":return _context.stop()}}),_callee)})));return function indexPatternsFunction(){return _ref.apply(this,arguments)}}();indexPatternsFunction()},[]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiTitle"],{size:"s"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h5",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{defaultMessage:"Write to index",id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.connectorSectionTitle"}))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiFormRow"],{id:"indexConnectorSelectSearchBox",fullWidth:true,label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.indicesToQueryLabel",defaultMessage:"Index"}),isInvalid:errors.index.length>0&&index!==undefined,error:errors.index,helpText:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.howToBroadenSearchQueryDescription",defaultMessage:"Use * to broaden your query."}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"s"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiLink"],{href:"".concat(docLinks.ELASTIC_WEBSITE_URL,"guide/en/kibana/").concat(docLinks.DOC_LINK_VERSION,"/index-action-type.html"),target:"_blank"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.configureIndexHelpLabel",defaultMessage:"Configuring index connector."})))},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiComboBox"],{fullWidth:true,singleSelection:{asPlainText:true},async:true,isLoading:isIndiciesLoading,isInvalid:errors.index.length>0&&index!==undefined,noSuggestions:!indexOptions.length,options:indexOptions,"data-test-subj":"connectorIndexesComboBox",selectedOptions:index?[{value:index,label:index}]:[],isDisabled:readOnly,onChange:function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(selected){var indices,currentEsFields,timeFields;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:editActionConfig("index",selected.length>0?selected[0].value:"");indices=selected.map(s=>s.value);if(!(indices.length===0)){_context2.next=5;break}setTimeFieldOptions([]);return _context2.abrupt("return");case 5:_context2.next=7;return Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["b"])(http,indices);case 7:currentEsFields=_context2.sent;timeFields=Object(_common_lib_get_time_options__WEBPACK_IMPORTED_MODULE_4__["a"])(currentEsFields);setTimeFieldOptions([_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["a"],...timeFields]);case 10:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref2.apply(this,arguments)}}(),onSearchChange:function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(search){return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:setIsIndiciesLoading(true);_context3.t0=setIndexOptions;_context3.next=4;return Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["c"])(http,search,indexPatterns);case 4:_context3.t1=_context3.sent;(0,_context3.t0)(_context3.t1);setIsIndiciesLoading(false);case 7:case"end":return _context3.stop()}}),_callee3)})));return function(_x2){return _ref3.apply(this,arguments)}}(),onBlur:()=>{if(!index){editActionConfig("index","")}}})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSwitch"],{"data-test-subj":"indexRefreshCheckbox",checked:refresh||false,disabled:readOnly,onChange:e=>{editActionConfig("refresh",e.target.checked)},label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.refreshLabel",defaultMessage:"Refresh index"})," ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiIconTip"],{position:"right",type:"questionInCircle",content:_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].translate("xpack.triggersActionsUI.components.builtinActionTypes.indexAction.refreshTooltip",{defaultMessage:"Refresh the affected shards to make this operation visible to search."})}))}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSwitch"],{"data-test-subj":"hasTimeFieldCheckbox",checked:hasTimeFieldCheckbox||false,disabled:readOnly,onChange:()=>{setTimeFieldCheckboxState(!hasTimeFieldCheckbox);if(hasTimeFieldCheckbox){editActionConfig("executionTimeField",null)}},label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.defineTimeFieldLabel",defaultMessage:"Define time field for each document"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiIconTip"],{position:"right",type:"questionInCircle",content:_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].translate("xpack.triggersActionsUI.components.builtinActionTypes.indexAction.definedateFieldTooltip",{defaultMessage:"Automatically add a time field to each document when it's indexed."})}))}),hasTimeFieldCheckbox?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiFormRow"],{id:"executionTimeField",fullWidth:true,label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.executionTimeFieldLabel",defaultMessage:"Time field"})},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSelect"],{options:timeFieldOptions,fullWidth:true,name:"executionTimeField","data-test-subj":"executionTimeFieldSelect",value:executionTimeField!==null&&executionTimeField!==void 0?executionTimeField:"",onChange:e=>{editActionConfig("executionTimeField",nullableString(e.target.value))},onBlur:()=>{if(executionTimeField===undefined){editActionConfig("executionTimeField",null)}}}))):null)};function nullableString(str){if(str==null||str.trim()==="")return null;return str}}}]);