/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["triggersActionsUi_bundle_jsonpfunction"]=window["triggersActionsUi_bundle_jsonpfunction"]||[]).push([[7,5],{102:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return actionTypeCompare}));function actionTypeCompare(a,b,preconfiguredConnectors){const aEnabled=getIsEnabledValue(a,preconfiguredConnectors);const bEnabled=getIsEnabledValue(b,preconfiguredConnectors);if(aEnabled===true&&bEnabled===false){return-1}if(aEnabled===false&&bEnabled===true){return 1}return a.name.localeCompare(b.name)}const getIsEnabledValue=(actionType,preconfiguredConnectors)=>{let isEnabled=actionType.enabled;if(!actionType.enabledInConfig&&preconfiguredConnectors&&preconfiguredConnectors.length>0){isEnabled=preconfiguredConnectors.find(connector=>connector.actionTypeId===actionType.id)!==undefined}return isEnabled}},103:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(104);case"v7light":return __webpack_require__(106);case"v8dark":return __webpack_require__(108);case"v8light":return __webpack_require__(110)}},104:function(module,exports,__webpack_require__){var api=__webpack_require__(27);var content=__webpack_require__(105);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},105:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(28);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".actCheckActionTypeEnabled__disabledActionWarningCard {\n  background-color: #25262E; }\n\n.actAccordionActionForm {\n  background-color: #25262E; }\n\n.actAccordionActionForm .euiCard {\n  box-shadow: none; }\n\n.actAccordionActionForm__button {\n  padding: 12px; }\n\n.actConnectorsListGrid .euiToolTipAnchor,\n.actConnectorsListGrid .euiCard {\n  height: 100%; }\n",""]);module.exports=exports},106:function(module,exports,__webpack_require__){var api=__webpack_require__(27);var content=__webpack_require__(107);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},107:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(28);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".actCheckActionTypeEnabled__disabledActionWarningCard {\n  background-color: #F8F8F8; }\n\n.actAccordionActionForm {\n  background-color: #F8F8F8; }\n\n.actAccordionActionForm .euiCard {\n  box-shadow: none; }\n\n.actAccordionActionForm__button {\n  padding: 12px; }\n\n.actConnectorsListGrid .euiToolTipAnchor,\n.actConnectorsListGrid .euiCard {\n  height: 100%; }\n",""]);module.exports=exports},108:function(module,exports,__webpack_require__){var api=__webpack_require__(27);var content=__webpack_require__(109);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},109:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(28);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".actCheckActionTypeEnabled__disabledActionWarningCard {\n  background-color: #25262E; }\n\n.actAccordionActionForm {\n  background-color: #25262E; }\n\n.actAccordionActionForm .euiCard {\n  box-shadow: none; }\n\n.actAccordionActionForm__button {\n  padding: 12px; }\n\n.actConnectorsListGrid .euiToolTipAnchor,\n.actConnectorsListGrid .euiCard {\n  height: 100%; }\n",""]);module.exports=exports},110:function(module,exports,__webpack_require__){var api=__webpack_require__(27);var content=__webpack_require__(111);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},111:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(28);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".actCheckActionTypeEnabled__disabledActionWarningCard {\n  background-color: #F8F8F8; }\n\n.actAccordionActionForm {\n  background-color: #F8F8F8; }\n\n.actAccordionActionForm .euiCard {\n  box-shadow: none; }\n\n.actAccordionActionForm__button {\n  padding: 12px; }\n\n.actConnectorsListGrid .euiToolTipAnchor,\n.actConnectorsListGrid .euiCard {\n  height: 100%; }\n",""]);module.exports=exports},159:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(160);case"v7light":return __webpack_require__(162);case"v8dark":return __webpack_require__(164);case"v8light":return __webpack_require__(166)}},160:function(module,exports,__webpack_require__){var api=__webpack_require__(27);var content=__webpack_require__(161);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},161:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(28);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".actConnectorModal {\n  z-index: 9000; }\n\n.euiComboBoxOptionsList {\n  z-index: 9001; }\n",""]);module.exports=exports},162:function(module,exports,__webpack_require__){var api=__webpack_require__(27);var content=__webpack_require__(163);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},163:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(28);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".actConnectorModal {\n  z-index: 9000; }\n\n.euiComboBoxOptionsList {\n  z-index: 9001; }\n",""]);module.exports=exports},164:function(module,exports,__webpack_require__){var api=__webpack_require__(27);var content=__webpack_require__(165);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},165:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(28);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".actConnectorModal {\n  z-index: 9000; }\n\n.euiComboBoxOptionsList {\n  z-index: 9001; }\n",""]);module.exports=exports},166:function(module,exports,__webpack_require__){var api=__webpack_require__(27);var content=__webpack_require__(167);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},167:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(28);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".actConnectorModal {\n  z-index: 9000; }\n\n.euiComboBoxOptionsList {\n  z-index: 9001; }\n",""]);module.exports=exports},51:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"ActionForm",(function(){return ActionForm}));__webpack_require__.d(__webpack_exports__,"default",(function(){return ActionForm}));var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(8);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var action_connector_api=__webpack_require__(38);const SectionLoading=({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"xl"}),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},children),"data-test-subj":"sectionLoading"});var action_connector_form=__webpack_require__(92);var connector_reducer=__webpack_require__(93);var connector_add_modal=__webpack_require__(159);var lib_capabilities=__webpack_require__(75);var kibana=__webpack_require__(37);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ConnectorAddModal=({actionType:actionType,onClose:onClose,postSaveEventHandler:postSaveEventHandler,consumer:consumer,actionTypeRegistry:actionTypeRegistry})=>{const _useKibana$services=Object(kibana["b"])().services,http=_useKibana$services.http,toasts=_useKibana$services.notifications.toasts,capabilities=_useKibana$services.application.capabilities;let hasErrors=false;const initialConnector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({actionTypeId:actionType.id,config:{},secrets:{}}),[actionType.id]);const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=_slicedToArray(_useState,2),isSaving=_useState2[0],setIsSaving=_useState2[1];const canSave=Object(lib_capabilities["d"])(capabilities);const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(connector_reducer["a"],{connector:initialConnector}),_useReducer2=_slicedToArray(_useReducer,2),connector=_useReducer2[0].connector,dispatch=_useReducer2[1];const setConnector=value=>{dispatch({command:{type:"setConnector"},payload:{key:"connector",value:value}})};const _useState3=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState4=_slicedToArray(_useState3,2),serverError=_useState4[0],setServerError=_useState4[1];const closeModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setConnector(initialConnector);setServerError(undefined);onClose()},[initialConnector,onClose]);const actionTypeModel=actionTypeRegistry.get(actionType.id);const errors=_objectSpread(_objectSpread({},actionTypeModel===null||actionTypeModel===void 0?void 0:actionTypeModel.validateConnector(connector).errors),Object(action_connector_form["b"])(connector).errors);hasErrors=!!Object.keys(errors).find(errorKey=>errors[errorKey].length>=1);const onActionConnectorSave=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return Object(action_connector_api["a"])({http:http,connector:connector}).then(savedConnector=>{if(toasts){toasts.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.addModalConnectorForm.updateSuccessNotificationText",{defaultMessage:"Created '{connectorName}'",values:{connectorName:savedConnector.name}}))}return savedConnector}).catch(errorRes=>{setServerError(errorRes);return undefined});case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop()}}),_callee)})));return function onActionConnectorSave(){return _ref.apply(this,arguments)}}();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],{className:"actConnectorModal"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModal"],{onClose:closeModal},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalHeader"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalHeaderTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",alignItems:"center"},actionTypeModel&&actionTypeModel.iconClass?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:actionTypeModel.iconClass,size:"xl"})):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",{id:"flyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"{actionTypeName} connector",id:"xpack.triggersActionsUI.sections.addModalConnectorForm.flyoutTitle",values:{actionTypeName:actionType.name}}))))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalBody"],null,external_kbnSharedDeps_React_default.a.createElement(action_connector_form["a"],{connector:connector,actionTypeName:actionType.name,dispatch:dispatch,serverError:serverError,errors:errors,actionTypeRegistry:actionTypeRegistry,consumer:consumer})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:closeModal},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.addModalConnectorForm.cancelButtonLabel",{defaultMessage:"Cancel"})),canSave?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,color:"secondary","data-test-subj":"saveActionButtonModal",type:"submit",iconType:"check",isDisabled:hasErrors,isLoading:isSaving,onClick:_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var savedAction;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setIsSaving(true);_context2.next=3;return onActionConnectorSave();case 3:savedAction=_context2.sent;setIsSaving(false);if(savedAction){if(postSaveEventHandler){postSaveEventHandler(savedAction)}closeModal()}case 6:case"end":return _context2.stop()}}),_callee2)})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.addModalConnectorForm.saveButtonLabel",defaultMessage:"Save"})):null)))};var common_=__webpack_require__(10);var check_action_type_enabled=__webpack_require__(95);function transformActionVariables(actionVariables){const alwaysProvidedVars=getAlwaysProvidedActionVariables();const contextVars=actionVariables.context?prefixKeys(actionVariables.context,"context."):[];const paramsVars=prefixKeys(actionVariables.params,"params.");const stateVars=prefixKeys(actionVariables.state,"state.");return alwaysProvidedVars.concat(contextVars,paramsVars,stateVars)}function prefixKeys(actionVariables,prefix){return actionVariables.map(actionVariable=>({name:"".concat(prefix).concat(actionVariable.name),description:actionVariable.description}))}function getAlwaysProvidedActionVariables(){const result=[];result.push({name:"alertId",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.actionVariables.alertIdLabel",{defaultMessage:"The id of the alert."})});result.push({name:"alertName",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.actionVariables.alertNameLabel",{defaultMessage:"The name of the alert."})});result.push({name:"spaceId",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.actionVariables.spaceIdLabel",{defaultMessage:"The spaceId of the alert."})});result.push({name:"tags",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.actionVariables.tagsLabel",{defaultMessage:"The tags of the alert."})});result.push({name:"date",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.actionVariables.dateLabel",{defaultMessage:"The date the alert scheduled the action."})});result.push({name:"alertInstanceId",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.actionVariables.alertInstanceIdLabel",{defaultMessage:"The alert instance id that scheduled actions for the alert."})});result.push({name:"alertActionGroup",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.actionVariables.alertActionGroupLabel",{defaultMessage:"The alert action group that was used to scheduled actions for the alert."})});return result}var constants=__webpack_require__(3);function action_type_form_slicedToArray(arr,i){return action_type_form_arrayWithHoles(arr)||action_type_form_iterableToArrayLimit(arr,i)||action_type_form_unsupportedIterableToArray(arr,i)||action_type_form_nonIterableRest()}function action_type_form_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function action_type_form_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return action_type_form_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return action_type_form_arrayLikeToArray(o,minLen)}function action_type_form_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function action_type_form_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function action_type_form_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const preconfiguredMessage=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.actionForm.preconfiguredTitleMessage",{defaultMessage:"(preconfigured)"});const ActionTypeForm=({actionItem:actionItem,actionConnector:actionConnector,actionParamsErrors:actionParamsErrors,index:index,onAddConnector:onAddConnector,onConnectorSelected:onConnectorSelected,onDeleteAction:onDeleteAction,setActionParamsProperty:setActionParamsProperty,actionTypesIndex:actionTypesIndex,connectors:connectors,defaultActionGroupId:defaultActionGroupId,defaultActionMessage:defaultActionMessage,messageVariables:messageVariables,actionGroups:actionGroups,setActionGroupIdByIndex:setActionGroupIdByIndex,actionTypeRegistry:actionTypeRegistry})=>{var _actionGroups$find;const capabilities=Object(kibana["b"])().services.application.capabilities;const _useState=Object(external_kbnSharedDeps_React_["useState"])(true),_useState2=action_type_form_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])([]),_useState4=action_type_form_slicedToArray(_useState3,2),availableActionVariables=_useState4[0],setAvailableActionVariables=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState6=action_type_form_slicedToArray(_useState5,2),availableDefaultActionMessage=_useState6[0],setAvailableDefaultActionMessage=_useState6[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setAvailableActionVariables(getAvailableActionVariables(messageVariables,actionItem.group));const res=actionItem.group===common_["ResolvedActionGroup"].id?constants["e"]:defaultActionMessage;setAvailableDefaultActionMessage(res)},[actionItem.group]);const canSave=Object(lib_capabilities["d"])(capabilities);const getSelectedOptions=actionItemId=>{const selectedConnector=connectors.find(connector=>connector.id===actionItemId);if(!selectedConnector||actionTypesIndex&&!actionTypesIndex[selectedConnector.actionTypeId].enabledInConfig&&!selectedConnector.isPreconfigured){return[]}const optionTitle="".concat(selectedConnector.name," ").concat(selectedConnector.isPreconfigured?preconfiguredMessage:"");return[{label:optionTitle,value:optionTitle,id:actionItemId,"data-test-subj":"itemActionConnector"}]};const actionType=actionTypesIndex[actionItem.actionTypeId];const optionsList=connectors.filter(connectorItem=>connectorItem.actionTypeId===actionItem.actionTypeId&&(actionType.enabledInConfig||connectorItem.isPreconfigured)).map(({name:name,id:id,isPreconfigured:isPreconfigured})=>({label:"".concat(name," ").concat(isPreconfigured?preconfiguredMessage:""),key:id,id:id}));const actionTypeRegistered=actionTypeRegistry.get(actionConnector.actionTypeId);if(!actionTypeRegistered)return null;const ParamsFieldsComponent=actionTypeRegistered.actionParamsFields;const checkEnabledResult=Object(check_action_type_enabled["a"])(actionTypesIndex[actionConnector.actionTypeId],connectors.filter(connector=>connector.isPreconfigured));const defaultActionGroup=actionGroups===null||actionGroups===void 0?void 0:actionGroups.find(({id:id})=>id===defaultActionGroupId);const selectedActionGroup=(_actionGroups$find=actionGroups===null||actionGroups===void 0?void 0:actionGroups.find(({id:id})=>id===actionItem.group))!==null&&_actionGroups$find!==void 0?_actionGroups$find:defaultActionGroup;const accordionContent=checkEnabledResult.isEnabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,actionGroups&&selectedActionGroup&&setActionGroupIdByIndex&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{component:"div"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormControlLayout"],{fullWidth:true,prepend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:"addNewActionConnectorActionGroup-".concat(actionItem.actionTypeId)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertForm.actionRunWhenInActionGroup",defaultMessage:"Run When"}))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{fullWidth:true,id:"addNewActionConnectorActionGroup-".concat(actionItem.actionTypeId),"data-test-subj":"addNewActionConnectorActionGroup-".concat(index),options:actionGroups.map(({id:value,name:name})=>({value:value,inputDisplay:name,"data-test-subj":"addNewActionConnectorActionGroup-".concat(index,"-option-").concat(value)})),valueOfSelected:selectedActionGroup.id,onChange:group=>{setActionGroupIdByIndex(group,index)}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{component:"div"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertForm.actionIdLabel",defaultMessage:"{connectorInstance} connector",values:{connectorInstance:actionTypesIndex?actionTypesIndex[actionConnector.actionTypeId].name:actionConnector.actionTypeId}}),labelAppend:canSave&&actionTypesIndex&&actionTypesIndex[actionConnector.actionTypeId].enabledInConfig?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs","data-test-subj":"addNewActionConnectorButton-".concat(actionItem.actionTypeId),onClick:onAddConnector},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"Add connector",id:"xpack.triggersActionsUI.sections.alertForm.addNewConnectorEmptyButton"})):null},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{fullWidth:true,singleSelection:{asPlainText:true},options:optionsList,id:"selectActionConnector-".concat(actionItem.id),"data-test-subj":"selectActionConnector-".concat(actionItem.actionTypeId),selectedOptions:getSelectedOptions(actionItem.id),onChange:selectedOptions=>{var _selectedOptions$0$id;onConnectorSelected((_selectedOptions$0$id=selectedOptions[0].id)!==null&&_selectedOptions$0$id!==void 0?_selectedOptions$0$id:"")},isClearable:false})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xl"}),ParamsFieldsComponent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiErrorBoundary"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Suspense"],{fallback:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})))},external_kbnSharedDeps_React_default.a.createElement(ParamsFieldsComponent,{actionParams:actionItem.params,index:index,errors:actionParamsErrors.errors,editAction:setActionParamsProperty,messageVariables:availableActionVariables,defaultMessage:availableDefaultActionMessage,actionConnector:actionConnector}))):null):checkEnabledResult.messageCard;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{initialIsOpen:true,id:index.toString(),onToggle:setIsOpen,paddingSize:"l",className:"actAccordionActionForm",buttonContentClassName:"actAccordionActionForm__button","data-test-subj":"alertActionAccordion-".concat(index),buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"l",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:actionTypeRegistered.iconClass,size:"m"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"{actionConnectorName}",id:"xpack.triggersActionsUI.sections.alertForm.existingAlertActionTypeEditTitle",values:{actionConnectorName:"".concat(actionConnector.name," ").concat(actionConnector.isPreconfigured?preconfiguredMessage:"")}})),selectedActionGroup&&!isOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],null,selectedActionGroup.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},checkEnabledResult.isEnabled===false&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{type:"alert",color:"danger",content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertForm.actionDisabledTitle",{defaultMessage:"This action is disabled"}),position:"right"})))))))),extraAction:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),onClick:onDeleteAction})},accordionContent),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}))};function getAvailableActionVariables(actionVariables,actionGroup){if(!actionVariables){return[]}const filteredActionVariables=actionGroup===common_["ResolvedActionGroup"].id?{params:actionVariables.params,state:actionVariables.state}:actionVariables;return transformActionVariables(filteredActionVariables).sort((a,b)=>a.name.toUpperCase().localeCompare(b.name.toUpperCase()))}const AddConnectorInline=({actionTypesIndex:actionTypesIndex,actionItem:actionItem,index:index,onAddConnector:onAddConnector,onDeleteConnector:onDeleteConnector,actionTypeRegistry:actionTypeRegistry,emptyActionsIds:emptyActionsIds,defaultActionGroupId:defaultActionGroupId})=>{const capabilities=Object(kibana["b"])().services.application.capabilities;const canSave=Object(lib_capabilities["d"])(capabilities);const actionTypeName=actionTypesIndex?actionTypesIndex[actionItem.actionTypeId].name:actionItem.actionTypeId;const actionTypeRegistered=actionTypeRegistry.get(actionItem.actionTypeId);if(!actionTypeRegistered||actionItem.group!==defaultActionGroupId)return null;const noConnectorsLabel=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertForm.emptyConnectorsLabel",defaultMessage:"No {actionTypeName} connectors",values:{actionTypeName:actionTypeName}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{initialIsOpen:true,id:index.toString(),className:"actAccordionActionForm",buttonContentClassName:"actAccordionActionForm__button","data-test-subj":"alertActionAccordion-".concat(index),buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:actionTypeRegistered.iconClass,size:"m"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"{actionConnectorName}",id:"xpack.triggersActionsUI.sections.alertForm.newAlertActionTypeEditTitle",values:{actionConnectorName:actionTypeRegistered.actionTypeTitle}}))))),extraAction:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),onClick:onDeleteConnector}),paddingSize:"l"},canSave?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:emptyActionsIds.find(emptyId=>actionItem.id===emptyId)?noConnectorsLabel:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertForm.unableToLoadConnectorTitle",{defaultMessage:"Unable to load connector."}),color:"warning"}),actions:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"primary",fill:true,size:"s","data-test-subj":"createActionConnectorButton",onClick:onAddConnector},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertForm.addConnectorButtonLabel",defaultMessage:"Create a connector"}))]}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:noConnectorsLabel},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertForm.unauthorizedToCreateForEmptyConnectors",defaultMessage:"Only authorized users can configure a connector. Contact your administrator."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}))};var action_type_compare=__webpack_require__(102);var common_constants=__webpack_require__(12);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=action_form_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function action_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function action_form_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){action_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){action_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function action_form_slicedToArray(arr,i){return action_form_arrayWithHoles(arr)||action_form_iterableToArrayLimit(arr,i)||action_form_unsupportedIterableToArray(arr,i)||action_form_nonIterableRest()}function action_form_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function action_form_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return action_form_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return action_form_arrayLikeToArray(o,minLen)}function action_form_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function action_form_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function action_form_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ActionForm=({actions:actions,defaultActionGroupId:defaultActionGroupId,actionGroups:actionGroups,setActionIdByIndex:setActionIdByIndex,setActionGroupIdByIndex:setActionGroupIdByIndex,setAlertProperty:setAlertProperty,setActionParamsProperty:setActionParamsProperty,actionTypes:actionTypes,messageVariables:messageVariables,defaultActionMessage:defaultActionMessage,setHasActionsDisabled:setHasActionsDisabled,setHasActionsWithBrokenConnector:setHasActionsWithBrokenConnector,actionTypeRegistry:actionTypeRegistry})=>{const _useKibana$services=Object(kibana["b"])().services,http=_useKibana$services.http,toasts=_useKibana$services.notifications.toasts;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=action_form_slicedToArray(_useState,2),addModalVisible=_useState2[0],setAddModalVisibility=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState4=action_form_slicedToArray(_useState3,2),activeActionItem=_useState4[0],setActiveActionItem=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(true),_useState6=action_form_slicedToArray(_useState5,2),isAddActionPanelOpen=_useState6[0],setIsAddActionPanelOpen=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])([]),_useState8=action_form_slicedToArray(_useState7,2),connectors=_useState8[0],setConnectors=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])(false),_useState10=action_form_slicedToArray(_useState9,2),isLoadingConnectors=_useState10[0],setIsLoadingConnectors=_useState10[1];const _useState11=Object(external_kbnSharedDeps_React_["useState"])(false),_useState12=action_form_slicedToArray(_useState11,2),isLoadingActionTypes=_useState12[0],setIsLoadingActionTypes=_useState12[1];const _useState13=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState14=action_form_slicedToArray(_useState13,2),actionTypesIndex=_useState14[0],setActionTypesIndex=_useState14[1];const _useState15=Object(external_kbnSharedDeps_React_["useState"])([]),_useState16=action_form_slicedToArray(_useState15,2),emptyActionsIds=_useState16[0],setEmptyActionsIds=_useState16[1];const closeAddConnectorModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setAddModalVisibility(false),[setAddModalVisibility]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{action_form_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var registeredActionTypes,index,_iterator,_step,actionTypeItem;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setIsLoadingActionTypes(true);if(!(actionTypes!==null&&actionTypes!==void 0)){_context.next=6;break}_context.t0=actionTypes;_context.next=9;break;case 6:_context.next=8;return Object(action_connector_api["d"])({http:http});case 8:_context.t0=_context.sent;case 9:registeredActionTypes=_context.t0.sort((a,b)=>a.name.localeCompare(b.name));index={};_iterator=_createForOfIteratorHelper(registeredActionTypes);try{for(_iterator.s();!(_step=_iterator.n()).done;){actionTypeItem=_step.value;index[actionTypeItem.id]=actionTypeItem}}catch(err){_iterator.e(err)}finally{_iterator.f()}setActionTypesIndex(index);_context.next=19;break;case 16:_context.prev=16;_context.t1=_context["catch"](0);toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertForm.unableToLoadActionTypesMessage",{defaultMessage:"Unable to load action types"})});case 19:_context.prev=19;setIsLoadingActionTypes(false);return _context.finish(19);case 22:case"end":return _context.stop()}}),_callee,null,[[0,16,19,22]])})))()},[]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{action_form_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var loadedConnectors;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setIsLoadingConnectors(true);_context2.next=4;return Object(action_connector_api["e"])({http:http});case 4:loadedConnectors=_context2.sent;setConnectors(loadedConnectors);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2["catch"](0);toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertForm.unableToLoadActionsMessage",{defaultMessage:"Unable to load connectors"})});case 11:_context2.prev=11;setIsLoadingConnectors(false);return _context2.finish(11);case 14:case"end":return _context2.stop()}}),_callee2,null,[[0,8,11,14]])})))()},[]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const setActionTypesAvalilability=()=>{const preconfiguredConnectors=connectors.filter(connector=>connector.isPreconfigured);const hasActionsDisabled=actions.some(action=>actionTypesIndex&&!actionTypesIndex[action.actionTypeId].enabled&&!Object(check_action_type_enabled["a"])(actionTypesIndex[action.actionTypeId],preconfiguredConnectors).isEnabled);if(setHasActionsDisabled){setHasActionsDisabled(hasActionsDisabled)}};if(connectors.length>0&&actionTypesIndex){setActionTypesAvalilability()}},[connectors,actionTypesIndex]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const hasActionWithBrokenConnector=actions.some(action=>!connectors.find(connector=>connector.id===action.id));if(setHasActionsWithBrokenConnector){setHasActionsWithBrokenConnector(hasActionWithBrokenConnector)}},[actions,connectors]);function addActionType(actionTypeModel){if(!defaultActionGroupId){toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertForm.unableToAddAction",{defaultMessage:"Unable to add action, because default action group is not defined"})});return}setIsAddActionPanelOpen(false);const actionTypeConnectors=connectors.filter(field=>field.actionTypeId===actionTypeModel.id);if(actionTypeConnectors.length>0){actions.push({id:"",actionTypeId:actionTypeModel.id,group:defaultActionGroupId,params:{}});setActionIdByIndex(actionTypeConnectors[0].id,actions.length-1)}if(actionTypeConnectors.length===0){actions.push({id:"",actionTypeId:actionTypeModel.id,group:defaultActionGroupId,params:{}});setActionIdByIndex(actions.length.toString(),actions.length-1);setEmptyActionsIds([...emptyActionsIds,actions.length.toString()])}}let actionTypeNodes=null;let hasDisabledByLicenseActionTypes=false;if(actionTypesIndex){const preconfiguredConnectors=connectors.filter(connector=>connector.isPreconfigured);actionTypeNodes=actionTypeRegistry.list().filter(({id:id})=>actionTypes!==null&&actionTypes!==void 0?actionTypes:!common_constants["DEFAULT_HIDDEN_ACTION_TYPES"].includes(id)).filter(item=>actionTypesIndex[item.id]).filter(item=>!!item.actionParamsFields).sort((a,b)=>Object(action_type_compare["a"])(actionTypesIndex[a.id],actionTypesIndex[b.id],preconfiguredConnectors)).map((function(item,index){const actionType=actionTypesIndex[item.id];const checkEnabledResult=Object(check_action_type_enabled["a"])(actionTypesIndex[item.id],preconfiguredConnectors);if(!actionType.enabledInConfig&&!checkEnabledResult.isEnabled){return null}if(!actionType.enabledInLicense){hasDisabledByLicenseActionTypes=true}const keyPadItem=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiKeyPadMenuItem"],{key:index,isDisabled:!checkEnabledResult.isEnabled,"data-test-subj":"".concat(item.id,"-ActionTypeSelectOption"),label:actionTypesIndex[item.id].name,onClick:()=>addActionType(item)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"xl",type:item.iconClass}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:"keypad-".concat(item.id)},checkEnabledResult.isEnabled&&keyPadItem,checkEnabledResult.isEnabled===false&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:checkEnabledResult.message},keyPadItem))}))}return isLoadingConnectors?external_kbnSharedDeps_React_default.a.createElement(SectionLoading,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertForm.loadingConnectorsDescription",defaultMessage:"Loading connectors…"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"Actions",id:"xpack.triggersActionsUI.sections.alertForm.actionSectionsTitle"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),actionTypesIndex&&actions.map((actionItem,index)=>{var _actionTypeRegistry$g;const actionConnector=connectors.find(field=>field.id===actionItem.id);if(!actionConnector){return external_kbnSharedDeps_React_default.a.createElement(AddConnectorInline,{actionTypesIndex:actionTypesIndex,actionItem:actionItem,index:index,key:"action-form-action-at-".concat(index),actionTypeRegistry:actionTypeRegistry,defaultActionGroupId:defaultActionGroupId,emptyActionsIds:emptyActionsIds,onDeleteConnector:()=>{const updatedActions=actions.filter((_item,i)=>i!==index);setAlertProperty(updatedActions);setIsAddActionPanelOpen(updatedActions.filter(item=>item.id!==actionItem.id).length===0);setActiveActionItem(undefined)},onAddConnector:()=>{setActiveActionItem({actionTypeId:actionItem.actionTypeId,index:index});setAddModalVisibility(true)}})}const actionParamsErrors=(_actionTypeRegistry$g=actionTypeRegistry.get(actionItem.actionTypeId))===null||_actionTypeRegistry$g===void 0?void 0:_actionTypeRegistry$g.validateParams(actionItem.params);return external_kbnSharedDeps_React_default.a.createElement(ActionTypeForm,{actionItem:actionItem,actionConnector:actionConnector,actionParamsErrors:actionParamsErrors,index:index,key:"action-form-action-at-".concat(index),setActionParamsProperty:setActionParamsProperty,actionTypesIndex:actionTypesIndex,connectors:connectors,defaultActionGroupId:defaultActionGroupId,defaultActionMessage:defaultActionMessage,messageVariables:messageVariables,actionGroups:actionGroups,setActionGroupIdByIndex:setActionGroupIdByIndex,onAddConnector:()=>{setActiveActionItem({actionTypeId:actionItem.actionTypeId,index:index});setAddModalVisibility(true)},onConnectorSelected:id=>{setActionIdByIndex(id,index)},actionTypeRegistry:actionTypeRegistry,onDeleteAction:()=>{const updatedActions=actions.filter((_item,i)=>i!==index);setAlertProperty(updatedActions);setIsAddActionPanelOpen(updatedActions.filter(item=>item.id!==actionItem.id).length===0);setActiveActionItem(undefined)}})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),isAddActionPanelOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{id:"alertActionTypeTitle",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"Select an action type",id:"xpack.triggersActionsUI.sections.alertForm.selectAlertActionTypeTitle"})))),hasDisabledByLicenseActionTypes&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:common_constants["VIEW_LICENSE_OPTIONS_LINK"],target:"_blank",external:true,className:"actActionForm__getMoreActionsLink"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"Get more actions",id:"xpack.triggersActionsUI.sections.actionForm.getMoreActionsTitle"})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",wrap:true},isLoadingActionTypes?external_kbnSharedDeps_React_default.a.createElement(SectionLoading,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertForm.loadingActionTypesDescription",defaultMessage:"Loading action types…"})):actionTypeNodes)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s","data-test-subj":"addAlertActionButton",onClick:()=>setIsAddActionPanelOpen(true)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertForm.addActionButtonLabel",defaultMessage:"Add action"})))),actionTypesIndex&&activeActionItem&&addModalVisible?external_kbnSharedDeps_React_default.a.createElement(ConnectorAddModal,{key:activeActionItem.index,actionType:actionTypesIndex[activeActionItem.actionTypeId],onClose:closeAddConnectorModal,postSaveEventHandler:savedAction=>{connectors.push(savedAction);setActionIdByIndex(savedAction.id,activeActionItem.index)},actionTypeRegistry:actionTypeRegistry}):null)}},75:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return hasShowActionsCapability}));__webpack_require__.d(__webpack_exports__,"d",(function(){return hasSaveActionsCapability}));__webpack_require__.d(__webpack_exports__,"c",(function(){return hasExecuteActionsCapability}));__webpack_require__.d(__webpack_exports__,"b",(function(){return hasDeleteActionsCapability}));__webpack_require__.d(__webpack_exports__,"a",(function(){return hasAllPrivilege}));const hasShowActionsCapability=capabilities=>{var _capabilities$actions;return capabilities===null||capabilities===void 0?void 0:(_capabilities$actions=capabilities.actions)===null||_capabilities$actions===void 0?void 0:_capabilities$actions.show};const hasSaveActionsCapability=capabilities=>{var _capabilities$actions2;return capabilities===null||capabilities===void 0?void 0:(_capabilities$actions2=capabilities.actions)===null||_capabilities$actions2===void 0?void 0:_capabilities$actions2.save};const hasExecuteActionsCapability=capabilities=>{var _capabilities$actions3;return capabilities===null||capabilities===void 0?void 0:(_capabilities$actions3=capabilities.actions)===null||_capabilities$actions3===void 0?void 0:_capabilities$actions3.execute};const hasDeleteActionsCapability=capabilities=>{var _capabilities$actions4;return capabilities===null||capabilities===void 0?void 0:(_capabilities$actions4=capabilities.actions)===null||_capabilities$actions4===void 0?void 0:_capabilities$actions4.delete};function hasAllPrivilege(alert,alertType){var _alertType$authorized,_alertType$authorized2;return(_alertType$authorized=alertType===null||alertType===void 0?void 0:(_alertType$authorized2=alertType.authorizedConsumers[alert.consumer])===null||_alertType$authorized2===void 0?void 0:_alertType$authorized2.all)!==null&&_alertType$authorized!==void 0?_alertType$authorized:false}function hasReadPrivilege(alert,alertType){var _alertType$authorized3,_alertType$authorized4;return(_alertType$authorized3=alertType===null||alertType===void 0?void 0:(_alertType$authorized4=alertType.authorizedConsumers[alert.consumer])===null||_alertType$authorized4===void 0?void 0:_alertType$authorized4.read)!==null&&_alertType$authorized3!==void 0?_alertType$authorized3:false}},92:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return validateBaseProperties}));__webpack_require__.d(__webpack_exports__,"a",(function(){return ActionConnectorForm}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__);var _kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8);var _kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3__);var _lib_capabilities__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(75);var _common_lib_kibana__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(37);function validateBaseProperties(actionObject){const validationResult={errors:{}};const verrors={name:new Array};validationResult.errors=verrors;if(!actionObject.name){verrors.name.push(_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.triggersActionsUI.sections.actionConnectorForm.error.requiredNameText",{defaultMessage:"Name is required."}))}return validationResult}const ActionConnectorForm=({connector:connector,dispatch:dispatch,actionTypeName:actionTypeName,serverError:serverError,errors:errors,actionTypeRegistry:actionTypeRegistry,consumer:consumer})=>{const _useKibana$services=Object(_common_lib_kibana__WEBPACK_IMPORTED_MODULE_5__["b"])().services,docLinks=_useKibana$services.docLinks,capabilities=_useKibana$services.application.capabilities;const canSave=Object(_lib_capabilities__WEBPACK_IMPORTED_MODULE_4__["d"])(capabilities);const setActionProperty=(key,value)=>{dispatch({command:{type:"setProperty"},payload:{key:key,value:value}})};const setActionConfigProperty=(key,value)=>{dispatch({command:{type:"setConfigProperty"},payload:{key:key,value:value}})};const setActionSecretsProperty=(key,value)=>{dispatch({command:{type:"setSecretsProperty"},payload:{key:key,value:value}})};const actionTypeRegistered=actionTypeRegistry.get(connector.actionTypeId);if(!actionTypeRegistered)return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__["Fragment"],null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiCallOut"],{title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.triggersActionsUI.sections.actionConnectorForm.actions.actionTypeConfigurationWarningTitleText",{defaultMessage:"Action type not registered"}),color:"warning",iconType:"help"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiText"],null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3__["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.actionConnectorForm.actions.actionConfigurationWarningDescriptionText",defaultMessage:"To create this connector, you must configure at least one {actionType} account. {docLink}",values:{actionType:actionTypeName,docLink:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiLink"],{href:"".concat(docLinks.ELASTIC_WEBSITE_URL,"guide/en/kibana/").concat(docLinks.DOC_LINK_VERSION,"/action-types.html"),target:"_blank"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3__["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.actionConnectorForm.actions.actionConfigurationWarningHelpLinkText",defaultMessage:"Learn more."}))}})))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],null));const FieldsComponent=actionTypeRegistered.actionConnectorFields;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiForm"],{isInvalid:!!serverError,error:serverError===null||serverError===void 0?void 0:serverError.body.message},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiFormRow"],{id:"actionName",fullWidth:true,label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3__["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.actionConnectorForm.actionNameLabel",defaultMessage:"Connector name"}),isInvalid:errors.name.length>0&&connector.name!==undefined,error:errors.name},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiFieldText"],{fullWidth:true,readOnly:!canSave,isInvalid:errors.name.length>0&&connector.name!==undefined,name:"name",placeholder:"Untitled","data-test-subj":"nameInput",value:connector.name||"",onChange:e=>{setActionProperty("name",e.target.value)},onBlur:()=>{if(!connector.name){setActionProperty("name","")}}})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"m"}),FieldsComponent!==null?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiTitle"],{size:"xxs"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h4",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3__["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.actionConnectorForm.connectorSettingsLabel",defaultMessage:"Connector settings"}))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"s"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiErrorBoundary"],null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__["Suspense"],{fallback:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiFlexGroup"],{justifyContent:"center"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiFlexItem"],{grow:false},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiLoadingSpinner"],{size:"m"})))},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(FieldsComponent,{action:connector,errors:errors,readOnly:!canSave,editActionConfig:setActionConfigProperty,editActionSecrets:setActionSecretsProperty,consumer:consumer})))):null)}},93:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return connectorReducer}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(16);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const connectorReducer=(state,action)=>{const command=action.command,payload=action.payload;const connector=state.connector;switch(command.type){case"setConnector":{const key=payload.key,value=payload.value;if(key==="connector"){return _objectSpread(_objectSpread({},state),{},{connector:value})}else{return state}}case"setProperty":{const key=payload.key,value=payload.value;if(Object(lodash__WEBPACK_IMPORTED_MODULE_0__["isEqual"])(connector[key],value)){return state}else{return _objectSpread(_objectSpread({},state),{},{connector:_objectSpread(_objectSpread({},connector),{},{[key]:value})})}}case"setConfigProperty":{const key=payload.key,value=payload.value;if(Object(lodash__WEBPACK_IMPORTED_MODULE_0__["isEqual"])(connector.config[key],value)){return state}else{return _objectSpread(_objectSpread({},state),{},{connector:_objectSpread(_objectSpread({},connector),{},{config:_objectSpread(_objectSpread({},connector.config),{},{[key]:value})})})}}case"setSecretsProperty":{const key=payload.key,value=payload.value;if(Object(lodash__WEBPACK_IMPORTED_MODULE_0__["isEqual"])(connector.secrets[key],value)){return state}else{return _objectSpread(_objectSpread({},state),{},{connector:_objectSpread(_objectSpread({},connector),{},{secrets:_objectSpread(_objectSpread({},connector.secrets),{},{[key]:value})})})}}}}},95:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return checkActionTypeEnabled}));__webpack_require__.d(__webpack_exports__,"a",(function(){return checkActionFormActionTypeEnabled}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var lodash__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(16);var lodash__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__);var _kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8);var _kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2);var _elastic_eui__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_4__);var _common_constants__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(12);var _check_action_type_enabled_scss__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(103);var _check_action_type_enabled_scss__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_check_action_type_enabled_scss__WEBPACK_IMPORTED_MODULE_6__);const getLicenseCheckResult=actionType=>({isEnabled:false,message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.triggersActionsUI.checkActionTypeEnabled.actionTypeDisabledByLicenseMessage",{defaultMessage:"This connector requires a {minimumLicenseRequired} license.",values:{minimumLicenseRequired:Object(lodash__WEBPACK_IMPORTED_MODULE_1__["upperFirst"])(actionType.minimumLicenseRequired)}}),messageCard:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_4__["EuiCard"],{titleSize:"xs",title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.triggersActionsUI.sections.alertForm.actionTypeDisabledByLicenseMessageTitle",{defaultMessage:"This feature requires a {minimumLicenseRequired} license.",values:{minimumLicenseRequired:Object(lodash__WEBPACK_IMPORTED_MODULE_1__["upperFirst"])(actionType.minimumLicenseRequired)}}),description:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.triggersActionsUI.sections.alertForm.actionTypeDisabledByLicenseMessageDescription",{defaultMessage:"To re-enable this action, please upgrade your license."}),className:"actCheckActionTypeEnabled__disabledActionWarningCard",children:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_4__["EuiLink"],{href:_common_constants__WEBPACK_IMPORTED_MODULE_5__["VIEW_LICENSE_OPTIONS_LINK"],target:"_blank"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_3__["FormattedMessage"],{defaultMessage:"View license options",id:"xpack.triggersActionsUI.sections.alertForm.actionTypeDisabledByLicenseLinkTitle"}))})});const configurationCheckResult={isEnabled:false,message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.triggersActionsUI.checkActionTypeEnabled.actionTypeDisabledByConfigMessage",{defaultMessage:"This connector is disabled by the Kibana configuration."}),messageCard:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_4__["EuiCard"],{title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.triggersActionsUI.sections.alertForm.actionTypeDisabledByConfigMessageTitle",{defaultMessage:"This feature is disabled by the Kibana configuration."}),description:"",className:"actCheckActionTypeEnabled__disabledActionWarningCard"})};function checkActionTypeEnabled(actionType){if((actionType===null||actionType===void 0?void 0:actionType.enabledInLicense)===false){return getLicenseCheckResult(actionType)}if((actionType===null||actionType===void 0?void 0:actionType.enabledInConfig)===false){return configurationCheckResult}return{isEnabled:true}}function checkActionFormActionTypeEnabled(actionType,preconfiguredConnectors){if((actionType===null||actionType===void 0?void 0:actionType.enabledInLicense)===false){return getLicenseCheckResult(actionType)}if((actionType===null||actionType===void 0?void 0:actionType.enabledInConfig)===false&&!preconfiguredConnectors.find(preconfiguredConnector=>preconfiguredConnector.actionTypeId===actionType.id)){return configurationCheckResult}return{isEnabled:true}}}}]);