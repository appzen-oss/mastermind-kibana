/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["triggersActionsUi_bundle_jsonpfunction"]=window["triggersActionsUi_bundle_jsonpfunction"]||[]).push([[17],{100:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return alertsStatusesTranslationsMapping}));__webpack_require__.d(__webpack_exports__,"a",(function(){return alertsErrorReasonTranslationsMapping}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);const ALERT_STATUS_OK=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.sections.alertsList.alertStatusOk",{defaultMessage:"Ok"});const ALERT_STATUS_ACTIVE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.sections.alertsList.alertStatusActive",{defaultMessage:"Active"});const ALERT_STATUS_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.sections.alertsList.alertStatusError",{defaultMessage:"Error"});const ALERT_STATUS_PENDING=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.sections.alertsList.alertStatusPending",{defaultMessage:"Pending"});const ALERT_STATUS_UNKNOWN=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.sections.alertsList.alertStatusUnknown",{defaultMessage:"Unknown"});const alertsStatusesTranslationsMapping={ok:ALERT_STATUS_OK,active:ALERT_STATUS_ACTIVE,error:ALERT_STATUS_ERROR,pending:ALERT_STATUS_PENDING,unknown:ALERT_STATUS_UNKNOWN};const ALERT_ERROR_UNKNOWN_REASON=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonUnknown",{defaultMessage:"An error occurred for unknown reasons."});const ALERT_ERROR_READING_REASON=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonReading",{defaultMessage:"An error occurred when reading the alert."});const ALERT_ERROR_DECRYPTING_REASON=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonDecrypting",{defaultMessage:"An error occurred when decrypting the alert."});const ALERT_ERROR_EXECUTION_REASON=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonRunning",{defaultMessage:"An error occurred when running the alert."});const alertsErrorReasonTranslationsMapping={read:ALERT_ERROR_READING_REASON,decrypt:ALERT_ERROR_DECRYPTING_REASON,execute:ALERT_ERROR_EXECUTION_REASON,unknown:ALERT_ERROR_UNKNOWN_REASON}},130:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return getAlertingSectionBreadcrumb}));__webpack_require__.d(__webpack_exports__,"a",(function(){return getAlertDetailsBreadcrumb}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);var _constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3);const getAlertingSectionBreadcrumb=type=>{switch(type){case"connectors":return{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.connectors.breadcrumbTitle",{defaultMessage:"Connectors"}),href:"".concat(_constants__WEBPACK_IMPORTED_MODULE_1__["h"])};case"alerts":return{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.alerts.breadcrumbTitle",{defaultMessage:"Alerts"}),href:"".concat(_constants__WEBPACK_IMPORTED_MODULE_1__["g"])};default:return{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.home.breadcrumbTitle",{defaultMessage:"Alerts and Actions"}),href:"".concat(_constants__WEBPACK_IMPORTED_MODULE_1__["i"])}}};const getAlertDetailsBreadcrumb=(id,name)=>({text:name,href:"".concat(_constants__WEBPACK_IMPORTED_MODULE_1__["f"].replace(":alertId",id))})},131:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getCurrentDocTitle}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);const getCurrentDocTitle=page=>{let updatedTitle;switch(page){case"connectors":updatedTitle=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.connectors.breadcrumbTitle",{defaultMessage:"Connectors"});break;case"alerts":updatedTitle=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.alerts.breadcrumbTitle",{defaultMessage:"Alerts"});break;default:updatedTitle=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.triggersActionsUI.home.breadcrumbTitle",{defaultMessage:"Alerts and Actions"})}return updatedTitle}},72:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"AlertDetailsRoute",(function(){return AlertDetailsRoute}));__webpack_require__.d(__webpack_exports__,"getAlertData",(function(){return getAlertData}));__webpack_require__.d(__webpack_exports__,"default",(function(){return AlertDetailsRouteWithApi}));var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var external_kbnSharedDeps_Lodash_=__webpack_require__(16);var external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(19);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(8);var lib_capabilities=__webpack_require__(75);var breadcrumb=__webpack_require__(130);var doc_title=__webpack_require__(131);var with_bulk_alert_api_operations=__webpack_require__(91);var external_kbnSharedDeps_Moment_=__webpack_require__(40);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var external_kbnSharedDeps_ElasticEuiLibServices_=__webpack_require__(70);var constants=__webpack_require__(3);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const alertInstancesTableColumns=(onMuteAction,readOnly)=>[{field:"instance",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.instance",{defaultMessage:"Instance"}),sortable:false,truncateText:true,"data-test-subj":"alertInstancesTableCell-instance",render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{anchorClassName:"eui-textTruncate",content:value},external_kbnSharedDeps_React_default.a.createElement("span",null,value))},{field:"status",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.status",{defaultMessage:"Status"}),width:"100px",render:(value,instance)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:value.healthColor},value.label,value.actionGroup?" (".concat(value.actionGroup,")"):""),sortable:false,"data-test-subj":"alertInstancesTableCell-status"},{field:"start",width:"200px",render:(value,instance)=>value?external_kbnSharedDeps_Moment_default()(value).format("D MMM YYYY @ HH:mm:ss"):"",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.start",{defaultMessage:"Start"}),sortable:false,"data-test-subj":"alertInstancesTableCell-start"},{field:"duration",align:external_kbnSharedDeps_ElasticEuiLibServices_["CENTER_ALIGNMENT"],render:(value,instance)=>value?durationAsString(external_kbnSharedDeps_Moment_default.a.duration(value)):"",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.duration",{defaultMessage:"Duration"}),sortable:false,width:"100px","data-test-subj":"alertInstancesTableCell-duration"},{field:"",align:external_kbnSharedDeps_ElasticEuiLibServices_["RIGHT_ALIGNMENT"],width:"60px",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.mute",{defaultMessage:"Mute"}),render:alertInstance=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:"mute",showLabel:false,compressed:true,checked:alertInstance.isMuted,disabled:readOnly,"data-test-subj":"muteAlertInstanceButton_".concat(alertInstance.instance),onChange:()=>onMuteAction(alertInstance)})),sortable:false,"data-test-subj":"alertInstancesTableCell-actions"}];function durationAsString(duration){return[duration.hours(),duration.minutes(),duration.seconds()].map(value=>Object(external_kbnSharedDeps_Lodash_["padStart"])("".concat(value),2,"0")).join(":")}function AlertInstances({alert:alert,alertType:alertType,readOnly:readOnly,alertInstanceSummary:alertInstanceSummary,muteAlertInstance:muteAlertInstance,unmuteAlertInstance:unmuteAlertInstance,requestRefresh:requestRefresh,durationEpoch:durationEpoch=Date.now()}){const _useState=Object(external_kbnSharedDeps_React_["useState"])({index:0,size:constants["c"]}),_useState2=_slicedToArray(_useState,2),pagination=_useState2[0],setPagination=_useState2[1];const alertInstances=Object.entries(alertInstanceSummary.instances).map(([instanceId,instance])=>alertInstanceToListItem(durationEpoch,alertType,instanceId,instance)).sort((leftInstance,rightInstance)=>leftInstance.sortPriority-rightInstance.sortPriority);const pageOfAlertInstances=getPage(alertInstances,pagination);const onMuteAction=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(instance){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return instance.isMuted?unmuteAlertInstance(alert,instance.instance):muteAlertInstance(alert,instance.instance);case 2:requestRefresh();case 3:case"end":return _context.stop()}}),_callee)})));return function onMuteAction(_x){return _ref.apply(this,arguments)}}();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement("input",{type:"hidden","data-test-subj":"alertInstancesDurationEpoch",name:"alertInstancesDurationEpoch",value:durationEpoch}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{items:pageOfAlertInstances,pagination:{pageIndex:pagination.index,pageSize:pagination.size,totalItemCount:alertInstances.length},onChange:({page:changedPage})=>{setPagination(changedPage)},rowProps:()=>({"data-test-subj":"alert-instance-row"}),cellProps:()=>({"data-test-subj":"cell"}),columns:alertInstancesTableColumns(onMuteAction,readOnly),"data-test-subj":"alertInstancesList",tableLayout:"fixed"}))}const AlertInstancesWithApi=Object(with_bulk_alert_api_operations["a"])(AlertInstances);function getPage(items,pagination){return Object(external_kbnSharedDeps_Lodash_["chunk"])(items,pagination.size)[pagination.index]||[]}const ACTIVE_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.status.active",{defaultMessage:"Active"});const INACTIVE_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.status.inactive",{defaultMessage:"OK"});function getActionGroupName(alertType,actionGroupId){var _alertType$actionGrou;actionGroupId=actionGroupId||alertType.defaultActionGroupId;const actionGroup=alertType===null||alertType===void 0?void 0:(_alertType$actionGrou=alertType.actionGroups)===null||_alertType$actionGrou===void 0?void 0:_alertType$actionGrou.find(group=>group.id===actionGroupId);return actionGroup===null||actionGroup===void 0?void 0:actionGroup.name}function alertInstanceToListItem(durationEpoch,alertType,instanceId,instance){const isMuted=!!(instance===null||instance===void 0?void 0:instance.muted);const status=(instance===null||instance===void 0?void 0:instance.status)==="Active"?{label:ACTIVE_LABEL,actionGroup:getActionGroupName(alertType,instance===null||instance===void 0?void 0:instance.actionGroupId),healthColor:"primary"}:{label:INACTIVE_LABEL,healthColor:"subdued"};const start=(instance===null||instance===void 0?void 0:instance.activeStartDate)?new Date(instance.activeStartDate):undefined;const duration=start?durationEpoch-start.valueOf():0;const sortPriority=getSortPriorityByStatus(instance===null||instance===void 0?void 0:instance.status);return{instance:instanceId,status:status,start:start,duration:duration,isMuted:isMuted,sortPriority:sortPriority}}function getSortPriorityByStatus(status){switch(status){case"Active":return 0;case"OK":return 1}return 2}var kibana=__webpack_require__(37);function alert_instances_route_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function alert_instances_route_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){alert_instances_route_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){alert_instances_route_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function alert_instances_route_slicedToArray(arr,i){return alert_instances_route_arrayWithHoles(arr)||alert_instances_route_iterableToArrayLimit(arr,i)||alert_instances_route_unsupportedIterableToArray(arr,i)||alert_instances_route_nonIterableRest()}function alert_instances_route_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function alert_instances_route_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return alert_instances_route_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return alert_instances_route_arrayLikeToArray(o,minLen)}function alert_instances_route_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function alert_instances_route_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function alert_instances_route_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AlertInstancesRoute=({alert:alert,alertType:alertType,readOnly:readOnly,requestRefresh:requestRefresh,loadAlertInstanceSummary:loadAlertInstanceSummary})=>{const toasts=Object(kibana["b"])().services.notifications.toasts;const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=alert_instances_route_slicedToArray(_useState,2),alertInstanceSummary=_useState2[0],setAlertInstanceSummary=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{getAlertInstanceSummary(alert.id,loadAlertInstanceSummary,setAlertInstanceSummary,toasts)},[alert]);return alertInstanceSummary?external_kbnSharedDeps_React_default.a.createElement(AlertInstancesWithApi,{requestRefresh:requestRefresh,alert:alert,alertType:alertType,readOnly:readOnly,alertInstanceSummary:alertInstanceSummary}):external_kbnSharedDeps_React_default.a.createElement("div",{style:{textAlign:"center",margin:"4em 0em"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"l"}))};function getAlertInstanceSummary(_x,_x2,_x3,_x4){return _getAlertInstanceSummary.apply(this,arguments)}function _getAlertInstanceSummary(){_getAlertInstanceSummary=alert_instances_route_asyncToGenerator(regeneratorRuntime.mark((function _callee(alertId,loadAlertInstanceSummary,setAlertInstanceSummary,toasts){var loadedInstanceSummary;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return loadAlertInstanceSummary(alertId);case 3:loadedInstanceSummary=_context.sent;setAlertInstanceSummary(loadedInstanceSummary);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context["catch"](0);toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertDetails.unableToLoadAlertInstanceSummaryMessage",{defaultMessage:"Unable to load alert instance summary: {message}",values:{message:_context.t0.message}})});case 10:case"end":return _context.stop()}}),_callee,null,[[0,7]])})));return _getAlertInstanceSummary.apply(this,arguments)}const AlertInstancesRouteWithApi=Object(with_bulk_alert_api_operations["a"])(AlertInstancesRoute);var Option=__webpack_require__(77);var pipeable=__webpack_require__(86);function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function view_in_app_slicedToArray(arr,i){return view_in_app_arrayWithHoles(arr)||view_in_app_iterableToArrayLimit(arr,i)||view_in_app_unsupportedIterableToArray(arr,i)||view_in_app_nonIterableRest()}function view_in_app_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function view_in_app_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return view_in_app_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return view_in_app_arrayLikeToArray(o,minLen)}function view_in_app_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function view_in_app_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function view_in_app_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const NO_NAVIGATION=false;const ViewInApp=({alert:alert})=>{const _useKibana$services=Object(kibana["b"])().services,navigateToApp=_useKibana$services.application.navigateToApp,maybeAlerting=_useKibana$services.alerts;const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=view_in_app_slicedToArray(_useState,2),alertNavigation=_useState2[0],setAlertNavigation=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{Object(pipeable["pipe"])(Object(Option["fromNullable"])(maybeAlerting),Object(Option["fold"])(()=>setAlertNavigation(NO_NAVIGATION),alerts=>alerts.getNavigation(alert.id).then(nav=>nav?setAlertNavigation(nav):setAlertNavigation(NO_NAVIGATION)).catch(()=>{setAlertNavigation(NO_NAVIGATION)})))},[alert.id,maybeAlerting]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],_extends({"data-test-subj":"alertDetails-viewInApp",isLoading:alertNavigation===null,disabled:!hasNavigation(alertNavigation),iconType:"popout"},getNavigationHandler(alertNavigation,alert,navigateToApp)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertDetails.viewAlertInAppButtonLabel",defaultMessage:"View in app"}))};function hasNavigation(alertNavigation){return alertNavigation?alertNavigation.hasOwnProperty("state")||alertNavigation.hasOwnProperty("path"):NO_NAVIGATION}function getNavigationHandler(alertNavigation,alert,navigateToApp){return hasNavigation(alertNavigation)?{onClick:()=>{navigateToApp(alert.consumer,alertNavigation)}}:{}}var alert_form=__webpack_require__(14);var alerts_context=__webpack_require__(34);var translations=__webpack_require__(100);var alert_reducer=__webpack_require__(98);function alert_details_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function alert_details_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){alert_details_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){alert_details_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _objectDestructuringEmpty(obj){if(obj==null)throw new TypeError("Cannot destructure undefined")}function alert_details_slicedToArray(arr,i){return alert_details_arrayWithHoles(arr)||alert_details_iterableToArrayLimit(arr,i)||alert_details_unsupportedIterableToArray(arr,i)||alert_details_nonIterableRest()}function alert_details_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function alert_details_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return alert_details_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return alert_details_arrayLikeToArray(o,minLen)}function alert_details_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function alert_details_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function alert_details_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AlertDetails=({alert:alert,alertType:alertType,actionTypes:actionTypes,disableAlert:disableAlert,enableAlert:enableAlert,unmuteAlert:unmuteAlert,muteAlert:muteAlert,requestRefresh:requestRefresh})=>{var _alert$executionStatu;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const _useKibana$services=Object(kibana["b"])().services,http=_useKibana$services.http,toasts=_useKibana$services.notifications.toasts,capabilities=_useKibana$services.application.capabilities,alertTypeRegistry=_useKibana$services.alertTypeRegistry,actionTypeRegistry=_useKibana$services.actionTypeRegistry,uiSettings=_useKibana$services.uiSettings,docLinks=_useKibana$services.docLinks,charts=_useKibana$services.charts,data=_useKibana$services.data,setBreadcrumbs=_useKibana$services.setBreadcrumbs,chrome=_useKibana$services.chrome;const _useReducer=Object(external_kbnSharedDeps_React_["useReducer"])(alert_reducer["a"],{alert:alert}),_useReducer2=alert_details_slicedToArray(_useReducer,2);_objectDestructuringEmpty(_useReducer2[0]);const dispatch=_useReducer2[1];const setInitialAlert=value=>{dispatch({command:{type:"setAlert"},payload:{key:"alert",value:value}})};Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setBreadcrumbs([Object(breadcrumb["b"])("alerts"),Object(breadcrumb["a"])(alert.id,alert.name)]);chrome.docTitle.change(Object(doc_title["a"])("alerts"))},[]);const canExecuteActions=Object(lib_capabilities["c"])(capabilities);const canSaveAlert=Object(lib_capabilities["a"])(alert,alertType)&&(canExecuteActions||!canExecuteActions&&alert.actions.length===0);const actionTypesByTypeId=Object(external_kbnSharedDeps_Lodash_["keyBy"])(actionTypes,"id");const hasEditButton=canSaveAlert&&(alertTypeRegistry.has(alert.alertTypeId)?!alertTypeRegistry.get(alert.alertTypeId).requiresAppContext:false);const alertActions=alert.actions;const uniqueActions=Array.from(new Set(alertActions.map(item=>item.actionTypeId)));const _useState=Object(external_kbnSharedDeps_React_["useState"])(alert.enabled),_useState2=alert_details_slicedToArray(_useState,2),isEnabled=_useState2[0],setIsEnabled=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(alert.muteAll),_useState4=alert_details_slicedToArray(_useState3,2),isMuted=_useState4[0],setIsMuted=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=alert_details_slicedToArray(_useState5,2),editFlyoutVisible=_useState6[0],setEditFlyoutVisibility=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=alert_details_slicedToArray(_useState7,2),dissmissAlertErrors=_useState8[0],setDissmissAlertErrors=_useState8[1];const setAlert=function(){var _ref=alert_details_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:history.push(constants["f"].replace(":alertId",alert.id));case 1:case"end":return _context.stop()}}),_callee)})));return function setAlert(){return _ref.apply(this,arguments)}}();const getAlertStatusErrorReasonText=()=>{if(alert.executionStatus.error&&alert.executionStatus.error.reason){return translations["a"][alert.executionStatus.error.reason]}else{return translations["a"].unknown}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPage"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageBody"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentHeader"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentHeaderSection"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"alertDetailsTitle"},alert.name)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentHeaderSection"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"xs"},hasEditButton?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"openEditAlertFlyoutButton",iconType:"pencil",onClick:()=>setEditFlyoutVisibility(true),name:"edit"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertDetails.editAlertButtonLabel",defaultMessage:"Edit"})),editFlyoutVisible&&external_kbnSharedDeps_React_default.a.createElement(alerts_context["a"],{value:{http:http,actionTypeRegistry:actionTypeRegistry,alertTypeRegistry:alertTypeRegistry,toastNotifications:toasts,uiSettings:uiSettings,docLinks:docLinks,charts:charts,dataFieldsFormats:data.fieldFormats,reloadAlerts:setAlert,capabilities:capabilities,dataUi:data.ui,dataIndexPatterns:data.indexPatterns}},external_kbnSharedDeps_React_default.a.createElement(alert_form["e"],{initialAlert:alert,onClose:()=>{setInitialAlert(alert);setEditFlyoutVisibility(false)}})))):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ViewInApp,{alert:alert}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContentBody"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true,responsive:false,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertsList.alertsListTable.columns.alertTypeTitle",defaultMessage:"Type"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{"data-test-subj":"alertTypeLabel"},alertType.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},uniqueActions&&uniqueActions.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertsList.alertsListTable.columns.actionsTex",defaultMessage:"Actions"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true,gutterSize:"s"},uniqueActions.map((action,index)=>{var _actionTypesByTypeId$;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:index,grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow","data-test-subj":"actionTypeLabel"},(_actionTypesByTypeId$=actionTypesByTypeId[action].name)!==null&&_actionTypesByTypeId$!==void 0?_actionTypesByTypeId$:action))}))):null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd",wrap:true,responsive:false,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{name:"disable",disabled:!canSaveAlert,checked:!isEnabled,"data-test-subj":"disableSwitch",onChange:alert_details_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!isEnabled){_context2.next=6;break}setIsEnabled(false);_context2.next=4;return disableAlert(alert);case 4:_context2.next=9;break;case 6:setIsEnabled(true);_context2.next=9;return enableAlert(alert);case 9:requestRefresh();case 10:case"end":return _context2.stop()}}),_callee2)}))),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertDetails.collapsedItemActons.disableTitle",defaultMessage:"Disable"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{name:"mute",checked:isMuted,disabled:!canSaveAlert||!isEnabled,"data-test-subj":"muteSwitch",onChange:alert_details_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(!isMuted){_context3.next=6;break}setIsMuted(false);_context3.next=4;return unmuteAlert(alert);case 4:_context3.next=9;break;case 6:setIsMuted(true);_context3.next=9;return muteAlert(alert);case 9:requestRefresh();case 10:case"end":return _context3.stop()}}),_callee3)}))),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertDetails.collapsedItemActons.muteTitle",defaultMessage:"Mute"})}))))),!dissmissAlertErrors&&alert.executionStatus.status==="error"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger","data-test-subj":"alertErrorBanner",size:"s",title:getAlertStatusErrorReasonText(),iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"danger","data-test-subj":"alertErrorMessageText"},(_alert$executionStatu=alert.executionStatus.error)===null||_alert$executionStatu===void 0?void 0:_alert$executionStatu.message),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"danger",onClick:()=>setDissmissAlertErrors(true)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertDetails.dismissButtonTitle",defaultMessage:"Dismiss"}))))):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,alert.enabled?external_kbnSharedDeps_React_default.a.createElement(AlertInstancesRouteWithApi,{requestRefresh:requestRefresh,alert:alert,alertType:alertType,readOnly:!canSaveAlert}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:"Disabled Alert",color:"warning",iconType:"help"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.triggersActionsUI.sections.alertDetails.alertInstances.disabledAlert",defaultMessage:"This alert is disabled and cannot be displayed. Toggle Disable ↑ to activate it."}))))))))))};const AlertDetailsWithApi=Object(with_bulk_alert_api_operations["a"])(AlertDetails);var value_validators=__webpack_require__(4);var action_connector_api=__webpack_require__(38);function with_actions_api_operations_extends(){with_actions_api_operations_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return with_actions_api_operations_extends.apply(this,arguments)}function with_actions_api_operations_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function with_actions_api_operations_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){with_actions_api_operations_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){with_actions_api_operations_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function withActionOperations(WrappedComponent){return props=>{const http=Object(kibana["b"])().services.http;if(!http){throw new Error("KibanaContext has not been initalized correctly.")}return external_kbnSharedDeps_React_default.a.createElement(WrappedComponent,with_actions_api_operations_extends({},props,{loadActionTypes:with_actions_api_operations_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",Object(action_connector_api["d"])({http:http}));case 1:case"end":return _context.stop()}}),_callee)})))}))}}function alert_details_route_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function alert_details_route_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){alert_details_route_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){alert_details_route_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function alert_details_route_slicedToArray(arr,i){return alert_details_route_arrayWithHoles(arr)||alert_details_route_iterableToArrayLimit(arr,i)||alert_details_route_unsupportedIterableToArray(arr,i)||alert_details_route_nonIterableRest()}function alert_details_route_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function alert_details_route_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return alert_details_route_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return alert_details_route_arrayLikeToArray(o,minLen)}function alert_details_route_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function alert_details_route_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function alert_details_route_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AlertDetailsRoute=({match:{params:{alertId:alertId}},loadAlert:loadAlert,loadAlertTypes:loadAlertTypes,loadActionTypes:loadActionTypes})=>{const _useKibana$services=Object(kibana["b"])().services,http=_useKibana$services.http,toasts=_useKibana$services.notifications.toasts;const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=alert_details_route_slicedToArray(_useState,2),alert=_useState2[0],setAlert=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(null),_useState4=alert_details_route_slicedToArray(_useState3,2),alertType=_useState4[0],setAlertType=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(null),_useState6=alert_details_route_slicedToArray(_useState5,2),actionTypes=_useState6[0],setActionTypes=_useState6[1];const _React$useState=external_kbnSharedDeps_React_default.a.useState(),_React$useState2=alert_details_route_slicedToArray(_React$useState,2),refreshToken=_React$useState2[0],requestRefresh=_React$useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{getAlertData(alertId,loadAlert,loadAlertTypes,loadActionTypes,setAlert,setAlertType,setActionTypes,toasts)},[alertId,http,loadActionTypes,loadAlert,loadAlertTypes,toasts,refreshToken]);return alert&&alertType&&actionTypes?external_kbnSharedDeps_React_default.a.createElement(AlertDetailsWithApi,{alert:alert,alertType:alertType,actionTypes:actionTypes,requestRefresh:alert_details_route_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",requestRefresh(Date.now()));case 1:case"end":return _context.stop()}}),_callee)})))}):external_kbnSharedDeps_React_default.a.createElement("div",{style:{textAlign:"center",margin:"4em 0em"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"l"}))};function getAlertData(_x,_x2,_x3,_x4,_x5,_x6,_x7,_x8){return _getAlertData.apply(this,arguments)}function _getAlertData(){_getAlertData=alert_details_route_asyncToGenerator(regeneratorRuntime.mark((function _callee2(alertId,loadAlert,loadAlertTypes,loadActionTypes,setAlert,setAlertType,setActionTypes,toasts){var loadedAlert,_yield$Promise$all,_yield$Promise$all2,loadedAlertType,loadedActionTypes;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return loadAlert(alertId);case 3:loadedAlert=_context2.sent;setAlert(loadedAlert);_context2.next=7;return Promise.all([loadAlertTypes().then(types=>types.find(type=>type.id===loadedAlert.alertTypeId)).then(Object(value_validators["b"])("Invalid Alert Type: ".concat(loadedAlert.alertTypeId))),loadActionTypes().then(Object(value_validators["c"])(new Set(loadedAlert.actions.map(action=>action.actionTypeId)),requiredActionType=>"Invalid Action Type: ".concat(requiredActionType),action=>action.id))]);case 7:_yield$Promise$all=_context2.sent;_yield$Promise$all2=alert_details_route_slicedToArray(_yield$Promise$all,2);loadedAlertType=_yield$Promise$all2[0];loadedActionTypes=_yield$Promise$all2[1];setAlertType(loadedAlertType);setActionTypes(loadedActionTypes);_context2.next=18;break;case 15:_context2.prev=15;_context2.t0=_context2["catch"](0);toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.triggersActionsUI.sections.alertDetails.unableToLoadAlertMessage",{defaultMessage:"Unable to load alert: {message}",values:{message:_context2.t0.message}})});case 18:case"end":return _context2.stop()}}),_callee2,null,[[0,15]])})));return _getAlertData.apply(this,arguments)}const AlertDetailsRouteWithApi=withActionOperations(Object(with_bulk_alert_api_operations["a"])(AlertDetailsRoute))},91:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return withBulkAlertOperations}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _lib_alert_api__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(88);var _common_lib_kibana__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(37);function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function withBulkAlertOperations(WrappedComponent){return props=>{const http=Object(_common_lib_kibana__WEBPACK_IMPORTED_MODULE_2__["b"])().services.http;if(!http){throw new Error("KibanaContext has not been initalized correctly.")}return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(WrappedComponent,_extends({},props,{muteAlerts:function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(items){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["p"])({http:http,ids:items.filter(item=>!isAlertMuted(item)).map(item=>item.id)}));case 1:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),unmuteAlerts:function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(items){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["s"])({http:http,ids:items.filter(isAlertMuted).map(item=>item.id)}));case 1:case"end":return _context2.stop()}}),_callee2)})));return function(_x2){return _ref2.apply(this,arguments)}}(),enableAlerts:function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(items){return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["f"])({http:http,ids:items.filter(isAlertDisabled).map(item=>item.id)}));case 1:case"end":return _context3.stop()}}),_callee3)})));return function(_x3){return _ref3.apply(this,arguments)}}(),disableAlerts:function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(items){return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["d"])({http:http,ids:items.filter(item=>!isAlertDisabled(item)).map(item=>item.id)}));case 1:case"end":return _context4.stop()}}),_callee4)})));return function(_x4){return _ref4.apply(this,arguments)}}(),deleteAlerts:function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(items){return regeneratorRuntime.wrap((function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _context5.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["b"])({http:http,ids:items.map(item=>item.id)}));case 1:case"end":return _context5.stop()}}),_callee5)})));return function(_x5){return _ref5.apply(this,arguments)}}(),muteAlert:function(){var _ref6=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(alert){return regeneratorRuntime.wrap((function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:if(isAlertMuted(alert)){_context6.next=2;break}return _context6.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["n"])({http:http,id:alert.id}));case 2:case"end":return _context6.stop()}}),_callee6)})));return function(_x6){return _ref6.apply(this,arguments)}}(),unmuteAlert:function(){var _ref7=_asyncToGenerator(regeneratorRuntime.mark((function _callee7(alert){return regeneratorRuntime.wrap((function _callee7$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:if(!isAlertMuted(alert)){_context7.next=2;break}return _context7.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["q"])({http:http,id:alert.id}));case 2:case"end":return _context7.stop()}}),_callee7)})));return function(_x7){return _ref7.apply(this,arguments)}}(),muteAlertInstance:function(){var _ref8=_asyncToGenerator(regeneratorRuntime.mark((function _callee8(alert,instanceId){return regeneratorRuntime.wrap((function _callee8$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:if(isAlertInstanceMuted(alert,instanceId)){_context8.next=2;break}return _context8.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["o"])({http:http,id:alert.id,instanceId:instanceId}));case 2:case"end":return _context8.stop()}}),_callee8)})));return function(_x8,_x9){return _ref8.apply(this,arguments)}}(),unmuteAlertInstance:function(){var _ref9=_asyncToGenerator(regeneratorRuntime.mark((function _callee9(alert,instanceId){return regeneratorRuntime.wrap((function _callee9$(_context9){while(1)switch(_context9.prev=_context9.next){case 0:if(!isAlertInstanceMuted(alert,instanceId)){_context9.next=2;break}return _context9.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["r"])({http:http,id:alert.id,instanceId:instanceId}));case 2:case"end":return _context9.stop()}}),_callee9)})));return function(_x10,_x11){return _ref9.apply(this,arguments)}}(),enableAlert:function(){var _ref10=_asyncToGenerator(regeneratorRuntime.mark((function _callee10(alert){return regeneratorRuntime.wrap((function _callee10$(_context10){while(1)switch(_context10.prev=_context10.next){case 0:if(!isAlertDisabled(alert)){_context10.next=2;break}return _context10.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["e"])({http:http,id:alert.id}));case 2:case"end":return _context10.stop()}}),_callee10)})));return function(_x12){return _ref10.apply(this,arguments)}}(),disableAlert:function(){var _ref11=_asyncToGenerator(regeneratorRuntime.mark((function _callee11(alert){return regeneratorRuntime.wrap((function _callee11$(_context11){while(1)switch(_context11.prev=_context11.next){case 0:if(isAlertDisabled(alert)){_context11.next=2;break}return _context11.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["c"])({http:http,id:alert.id}));case 2:case"end":return _context11.stop()}}),_callee11)})));return function(_x13){return _ref11.apply(this,arguments)}}(),deleteAlert:function(){var _ref12=_asyncToGenerator(regeneratorRuntime.mark((function _callee12(alert){return regeneratorRuntime.wrap((function _callee12$(_context12){while(1)switch(_context12.prev=_context12.next){case 0:return _context12.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["b"])({http:http,ids:[alert.id]}));case 1:case"end":return _context12.stop()}}),_callee12)})));return function(_x14){return _ref12.apply(this,arguments)}}(),loadAlert:function(){var _ref13=_asyncToGenerator(regeneratorRuntime.mark((function _callee13(alertId){return regeneratorRuntime.wrap((function _callee13$(_context13){while(1)switch(_context13.prev=_context13.next){case 0:return _context13.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["h"])({http:http,alertId:alertId}));case 1:case"end":return _context13.stop()}}),_callee13)})));return function(_x15){return _ref13.apply(this,arguments)}}(),loadAlertState:function(){var _ref14=_asyncToGenerator(regeneratorRuntime.mark((function _callee14(alertId){return regeneratorRuntime.wrap((function _callee14$(_context14){while(1)switch(_context14.prev=_context14.next){case 0:return _context14.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["k"])({http:http,alertId:alertId}));case 1:case"end":return _context14.stop()}}),_callee14)})));return function(_x16){return _ref14.apply(this,arguments)}}(),loadAlertInstanceSummary:function(){var _ref15=_asyncToGenerator(regeneratorRuntime.mark((function _callee15(alertId){return regeneratorRuntime.wrap((function _callee15$(_context15){while(1)switch(_context15.prev=_context15.next){case 0:return _context15.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["j"])({http:http,alertId:alertId}));case 1:case"end":return _context15.stop()}}),_callee15)})));return function(_x17){return _ref15.apply(this,arguments)}}(),loadAlertTypes:_asyncToGenerator(regeneratorRuntime.mark((function _callee16(){return regeneratorRuntime.wrap((function _callee16$(_context16){while(1)switch(_context16.prev=_context16.next){case 0:return _context16.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["l"])({http:http}));case 1:case"end":return _context16.stop()}}),_callee16)}))),getHealth:_asyncToGenerator(regeneratorRuntime.mark((function _callee17(){return regeneratorRuntime.wrap((function _callee17$(_context17){while(1)switch(_context17.prev=_context17.next){case 0:return _context17.abrupt("return",Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__["g"])({http:http}));case 1:case"end":return _context17.stop()}}),_callee17)})))}))}}function isAlertDisabled(alert){return alert.enabled===false}function isAlertMuted(alert){return alert.muteAll===true}function isAlertInstanceMuted(alert,instanceId){return alert.mutedInstanceIds.findIndex(muted=>muted===instanceId)>=0}},98:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return alertReducer}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(16);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const alertReducer=(state,action)=>{const alert=state.alert;switch(action.command.type){case"setAlert":{const _ref=action.payload,key=_ref.key,value=_ref.value;if(key==="alert"){return _objectSpread(_objectSpread({},state),{},{alert:value})}else{return state}}case"setProperty":{const _ref2=action.payload,key=_ref2.key,value=_ref2.value;if(Object(lodash__WEBPACK_IMPORTED_MODULE_0__["isEqual"])(alert[key],value)){return state}else{return _objectSpread(_objectSpread({},state),{},{alert:_objectSpread(_objectSpread({},alert),{},{[key]:value})})}}case"setScheduleProperty":{const _ref3=action.payload,key=_ref3.key,value=_ref3.value;if(alert.schedule&&Object(lodash__WEBPACK_IMPORTED_MODULE_0__["isEqual"])(alert.schedule[key],value)){return state}else{return _objectSpread(_objectSpread({},state),{},{alert:_objectSpread(_objectSpread({},alert),{},{schedule:_objectSpread(_objectSpread({},alert.schedule),{},{[key]:value})})})}}case"setAlertParams":{const _ref4=action.payload,key=_ref4.key,value=_ref4.value;if(Object(lodash__WEBPACK_IMPORTED_MODULE_0__["isEqual"])(alert.params[key],value)){return state}else{return _objectSpread(_objectSpread({},state),{},{alert:_objectSpread(_objectSpread({},alert),{},{params:_objectSpread(_objectSpread({},alert.params),{},{[key]:value})})})}}case"setAlertActionParams":{const _ref5=action.payload,key=_ref5.key,value=_ref5.value,index=_ref5.index;if(index===undefined||Object(lodash__WEBPACK_IMPORTED_MODULE_0__["isEqual"])(alert.actions[index][key],value)){return state}else{const oldAction=alert.actions.splice(index,1)[0];const updatedAction=_objectSpread(_objectSpread({},oldAction),{},{params:_objectSpread(_objectSpread({},oldAction.params),{},{[key]:value})});alert.actions.splice(index,0,updatedAction);return _objectSpread(_objectSpread({},state),{},{alert:_objectSpread(_objectSpread({},alert),{},{actions:[...alert.actions]})})}}case"setAlertActionProperty":{const _ref6=action.payload,key=_ref6.key,value=_ref6.value,index=_ref6.index;if(index===undefined||Object(lodash__WEBPACK_IMPORTED_MODULE_0__["isEqual"])(alert.actions[index][key],value)){return state}else{const oldAction=alert.actions.splice(index,1)[0];const updatedAction=_objectSpread(_objectSpread({},oldAction),{},{[key]:value});alert.actions.splice(index,0,updatedAction);return _objectSpread(_objectSpread({},state),{},{alert:_objectSpread(_objectSpread({},alert),{},{actions:[...alert.actions]})})}}}}}}]);