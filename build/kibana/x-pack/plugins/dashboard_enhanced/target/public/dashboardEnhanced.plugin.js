/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=13)})([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/embeddableEnhanced/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,exports){},function(module,exports){},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/share/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_val_loader_dist_cjs_js_key_dashboardEnhanced_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14);var _node_modules_val_loader_dist_cjs_js_key_dashboardEnhanced_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_val_loader_dist_cjs_js_key_dashboardEnhanced_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__);__kbnBundles__.define("plugin/dashboardEnhanced/public",__webpack_require__,15)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__["dashboardEnhanced"]},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"DashboardEnhancedSetupContract",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"DashboardEnhancedSetupDependencies",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"DashboardEnhancedStartContract",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"DashboardEnhancedStartDependencies",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"DashboardEnhancedAbstractDashboardDrilldown",(function(){return abstract_dashboard_drilldown_AbstractDashboardDrilldown}));__webpack_require__.d(__webpack_exports__,"DashboardEnhancedAbstractDashboardDrilldownConfig",(function(){return types["Config"]}));__webpack_require__.d(__webpack_exports__,"DashboardEnhancedAbstractDashboardDrilldownParams",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var public_=__webpack_require__(3);var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var kibanaReact_public_=__webpack_require__(5);var embeddableEnhanced_public_=__webpack_require__(4);var uiActions_public_=__webpack_require__(6);function ensureNestedTriggers(triggers){if(!triggers.includes(uiActions_public_["APPLY_FILTER_TRIGGER"])&&(triggers.includes(uiActions_public_["VALUE_CLICK_TRIGGER"])||triggers.includes(uiActions_public_["SELECT_RANGE_TRIGGER"]))){return[...triggers,uiActions_public_["APPLY_FILTER_TRIGGER"]]}return triggers}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const OPEN_FLYOUT_ADD_DRILLDOWN="OPEN_FLYOUT_ADD_DRILLDOWN";class flyout_create_drilldown_FlyoutCreateDrilldownAction{constructor(params){this.params=params;_defineProperty(this,"type",OPEN_FLYOUT_ADD_DRILLDOWN);_defineProperty(this,"id",OPEN_FLYOUT_ADD_DRILLDOWN);_defineProperty(this,"order",12);_defineProperty(this,"grouping",embeddableEnhanced_public_["embeddableEnhancedDrilldownGrouping"])}getDisplayName(){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.dashboard.FlyoutCreateDrilldownAction.displayName",{defaultMessage:"Create drilldown"})}getIconType(){return"plusInCircle"}isEmbeddableCompatible(context){if(!Object(embeddableEnhanced_public_["isEnhancedEmbeddable"])(context.embeddable))return false;const supportedTriggers=context.embeddable.supportedTriggers();if(!supportedTriggers||!supportedTriggers.length)return false;if(context.embeddable.getRoot().type!=="dashboard")return false;const allPossibleTriggers=this.params.start().plugins.uiActionsEnhanced.getActionFactories().map(factory=>factory.supportedTriggers()).reduce((res,next)=>res.concat(next),[]);return ensureNestedTriggers(supportedTriggers).some(trigger=>allPossibleTriggers.includes(trigger))}isCompatible(context){var _this=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee(){var isEditMode;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:isEditMode=context.embeddable.getInput().viewMode==="edit";return _context.abrupt("return",isEditMode&&_this.isEmbeddableCompatible(context));case 2:case"end":return _context.stop()}}),_callee)})))()}execute(context){var _this2=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _this2$params$start,core,plugins,embeddable,handle;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_this2$params$start=_this2.params.start(),core=_this2$params$start.core,plugins=_this2$params$start.plugins;embeddable=context.embeddable;if(Object(embeddableEnhanced_public_["isEnhancedEmbeddable"])(embeddable)){_context2.next=4;break}throw new Error("Need embeddable to be EnhancedEmbeddable to execute FlyoutCreateDrilldownAction.");case 4:handle=core.overlays.openFlyout(Object(kibanaReact_public_["toMountPoint"])(external_kbnSharedDeps_React_default.a.createElement(plugins.uiActionsEnhanced.FlyoutManageDrilldowns,{onClose:()=>handle.close(),viewMode:"create",dynamicActionManager:embeddable.enhancements.dynamicActions,triggers:[...ensureNestedTriggers(embeddable.supportedTriggers()),public_["CONTEXT_MENU_TRIGGER"]],placeContext:{embeddable:embeddable}})),{ownFocus:true,"data-test-subj":"createDrilldownFlyout"});case 5:case"end":return _context2.stop()}}),_callee2)})))()}}const txtDisplayName=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.dashboard.panel.openFlyoutEditDrilldown.displayName",{defaultMessage:"Manage drilldowns"});var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var kibanaUtils_public_=__webpack_require__(8);const MenuItem=({context:context})=>{const _useContainerState=Object(kibanaUtils_public_["useContainerState"])(context.embeddable.enhancements.dynamicActions.state),events=_useContainerState.events;const count=events.length;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},txtDisplayName),count>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiNotificationBadge"],null,count)))};function flyout_edit_drilldown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function flyout_edit_drilldown_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){flyout_edit_drilldown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){flyout_edit_drilldown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function flyout_edit_drilldown_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const OPEN_FLYOUT_EDIT_DRILLDOWN="OPEN_FLYOUT_EDIT_DRILLDOWN";class flyout_edit_drilldown_FlyoutEditDrilldownAction{constructor(params){this.params=params;flyout_edit_drilldown_defineProperty(this,"type",OPEN_FLYOUT_EDIT_DRILLDOWN);flyout_edit_drilldown_defineProperty(this,"id",OPEN_FLYOUT_EDIT_DRILLDOWN);flyout_edit_drilldown_defineProperty(this,"order",10);flyout_edit_drilldown_defineProperty(this,"grouping",embeddableEnhanced_public_["embeddableEnhancedDrilldownGrouping"]);flyout_edit_drilldown_defineProperty(this,"MenuItem",Object(kibanaReact_public_["reactToUiComponent"])(MenuItem))}getDisplayName(){return txtDisplayName}getIconType(){return"list"}isCompatible({embeddable:embeddable}){return flyout_edit_drilldown_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(embeddable.getInput().viewMode!==public_["ViewMode"].EDIT)){_context.next=2;break}return _context.abrupt("return",false);case 2:if(Object(embeddableEnhanced_public_["isEnhancedEmbeddable"])(embeddable)){_context.next=4;break}return _context.abrupt("return",false);case 4:return _context.abrupt("return",embeddable.enhancements.dynamicActions.state.get().events.length>0);case 5:case"end":return _context.stop()}}),_callee)})))()}execute(context){var _this=this;return flyout_edit_drilldown_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _this$params$start,core,plugins,embeddable,handle;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_this$params$start=_this.params.start(),core=_this$params$start.core,plugins=_this$params$start.plugins;embeddable=context.embeddable;if(Object(embeddableEnhanced_public_["isEnhancedEmbeddable"])(embeddable)){_context2.next=4;break}throw new Error("Need embeddable to be EnhancedEmbeddable to execute FlyoutEditDrilldownAction.");case 4:handle=core.overlays.openFlyout(Object(kibanaReact_public_["toMountPoint"])(external_kbnSharedDeps_React_default.a.createElement(plugins.uiActionsEnhanced.FlyoutManageDrilldowns,{onClose:()=>handle.close(),viewMode:"manage",dynamicActionManager:embeddable.enhancements.dynamicActions,triggers:[...ensureNestedTriggers(embeddable.supportedTriggers()),public_["CONTEXT_MENU_TRIGGER"]],placeContext:{embeddable:embeddable}})),{ownFocus:true,"data-test-subj":"editDrilldownFlyout"});case 5:case"end":return _context2.stop()}}),_callee2)})))()}}const EMBEDDABLE_TO_DASHBOARD_DRILLDOWN="DASHBOARD_TO_DASHBOARD_DRILLDOWN";var data_public_=__webpack_require__(7);var external_kbnSharedDeps_Lodash_=__webpack_require__(9);const txtChooseDestinationDashboard=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.dashboard.components.DashboardDrilldownConfig.chooseDestinationDashboard",{defaultMessage:"Choose destination dashboard"});const txtUseCurrentFilters=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.dashboard.components.DashboardDrilldownConfig.useCurrentFilters",{defaultMessage:"Use filters and query from origin dashboard"});const txtUseCurrentDateRange=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.dashboard.components.DashboardDrilldownConfig.useCurrentDateRange",{defaultMessage:"Use date range from origin dashboard"});const DashboardDrilldownConfig=({activeDashboardId:activeDashboardId,dashboards:dashboards,currentFilters:currentFilters,keepRange:keepRange,onDashboardSelect:onDashboardSelect,onCurrentFiltersToggle:onCurrentFiltersToggle,onKeepRangeToggle:onKeepRangeToggle,onSearchChange:onSearchChange,isLoading:isLoading,error:error})=>{var _dashboards$find;const selectedTitle=((_dashboards$find=dashboards.find(item=>item.value===activeDashboardId))===null||_dashboards$find===void 0?void 0:_dashboards$find.label)||"";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:txtChooseDestinationDashboard,fullWidth:true,isInvalid:!!error,error:error},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{async:true,selectedOptions:activeDashboardId?[{label:selectedTitle,value:activeDashboardId}]:[],options:dashboards,onChange:([{value:value=""}={value:""}])=>onDashboardSelect(value),onSearchChange:onSearchChange,isLoading:isLoading,singleSelection:{asPlainText:true},fullWidth:true,"data-test-subj":"dashboardDrilldownSelectDashboard",isInvalid:!!error})),!!onCurrentFiltersToggle&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{hasChildLabel:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{name:"useCurrentFilters",label:txtUseCurrentFilters,checked:!!currentFilters,onChange:onCurrentFiltersToggle})),!!onKeepRangeToggle&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{hasChildLabel:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{name:"useCurrentDateRange",label:txtUseCurrentDateRange,checked:!!keepRange,onChange:onKeepRangeToggle})))};const txtDestinationDashboardNotFound=dashboardId=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.dashboard.drilldown.errorDestinationDashboardIsMissing",{defaultMessage:"Destination dashboard ('{dashboardId}') no longer exists. Choose another dashboard.",values:{dashboardId:dashboardId}});function collect_config_container_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function collect_config_container_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){collect_config_container_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){collect_config_container_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){collect_config_container_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function collect_config_container_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const mergeDashboards=(dashboards,selectedDashboard)=>{if(selectedDashboard&&Object(external_kbnSharedDeps_Lodash_["findIndex"])(dashboards,{value:selectedDashboard.value})===-1){return[selectedDashboard,...dashboards]}return dashboards};const dashboardSavedObjectToMenuItem=savedObject=>({value:savedObject.id,label:savedObject.attributes.title});class collect_config_container_CollectConfigContainer extends external_kbnSharedDeps_React_default.a.Component{constructor(props){super(props);collect_config_container_defineProperty(this,"isMounted",true);collect_config_container_defineProperty(this,"state",{dashboards:[],isLoading:false,searchString:undefined,selectedDashboard:undefined,error:undefined});collect_config_container_defineProperty(this,"debouncedLoadDashboards",void 0);this.debouncedLoadDashboards=Object(external_kbnSharedDeps_Lodash_["debounce"])(this.loadDashboards.bind(this),500)}componentDidMount(){this.loadSelectedDashboard();this.loadDashboards()}componentWillUnmount(){this.isMounted=false}render(){const _this$props=this.props,config=_this$props.config,onConfig=_this$props.onConfig;const _this$state=this.state,dashboards=_this$state.dashboards,selectedDashboard=_this$state.selectedDashboard,isLoading=_this$state.isLoading,error=_this$state.error;return external_kbnSharedDeps_React_default.a.createElement(DashboardDrilldownConfig,{activeDashboardId:config.dashboardId,dashboards:mergeDashboards(dashboards,selectedDashboard),currentFilters:config.useCurrentFilters,keepRange:config.useCurrentDateRange,isLoading:isLoading,error:error,onDashboardSelect:dashboardId=>{onConfig(_objectSpread(_objectSpread({},config),{},{dashboardId:dashboardId}));if(this.state.error){this.setState({error:undefined})}},onSearchChange:this.debouncedLoadDashboards,onCurrentFiltersToggle:()=>onConfig(_objectSpread(_objectSpread({},config),{},{useCurrentFilters:!config.useCurrentFilters})),onKeepRangeToggle:()=>onConfig(_objectSpread(_objectSpread({},config),{},{useCurrentDateRange:!config.useCurrentDateRange}))})}loadSelectedDashboard(){var _this=this;return collect_config_container_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _savedObject$error;var _this$props2,config,start,savedObject;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_this$props2=_this.props,config=_this$props2.config,start=_this$props2.params.start;if(config.dashboardId){_context.next=3;break}return _context.abrupt("return");case 3:_context.next=5;return start().core.savedObjects.client.get("dashboard",config.dashboardId);case 5:savedObject=_context.sent;if(_this.isMounted){_context.next=8;break}return _context.abrupt("return");case 8:if(!(((_savedObject$error=savedObject.error)===null||_savedObject$error===void 0?void 0:_savedObject$error.statusCode)===404)){_context.next=12;break}_this.setState({error:txtDestinationDashboardNotFound(config.dashboardId)});_this.props.onConfig(_objectSpread(_objectSpread({},config),{},{dashboardId:undefined}));return _context.abrupt("return");case 12:if(!savedObject.error){_context.next=16;break}_this.setState({error:savedObject.error.message});_this.props.onConfig(_objectSpread(_objectSpread({},config),{},{dashboardId:undefined}));return _context.abrupt("return");case 16:_this.setState({selectedDashboard:dashboardSavedObjectToMenuItem(savedObject)});case 17:case"end":return _context.stop()}}),_callee)})))()}loadDashboards(searchString){var _this2=this;return collect_config_container_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var savedObjectsClient,_yield$savedObjectsCl,savedObjects,dashboardList;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_this2.setState({searchString:searchString,isLoading:true});savedObjectsClient=_this2.props.params.start().core.savedObjects.client;_context2.next=4;return savedObjectsClient.find({type:"dashboard",search:searchString?"".concat(searchString,"*"):undefined,searchFields:["title^3","description"],defaultSearchOperator:"AND",perPage:100});case 4:_yield$savedObjectsCl=_context2.sent;savedObjects=_yield$savedObjectsCl.savedObjects;if(_this2.isMounted){_context2.next=8;break}return _context2.abrupt("return");case 8:if(!(searchString!==_this2.state.searchString)){_context2.next=10;break}return _context2.abrupt("return");case 10:dashboardList=savedObjects.map(dashboardSavedObjectToMenuItem);_this2.setState({dashboards:dashboardList,isLoading:false});case 12:case"end":return _context2.stop()}}),_callee2)})))()}}const txtGoToDashboard=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.dashboard.drilldown.goToDashboard",{defaultMessage:"Go to Dashboard"});function abstract_dashboard_drilldown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function abstract_dashboard_drilldown_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){abstract_dashboard_drilldown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){abstract_dashboard_drilldown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function abstract_dashboard_drilldown_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class abstract_dashboard_drilldown_AbstractDashboardDrilldown{constructor(params){var _this=this;this.params=params;abstract_dashboard_drilldown_defineProperty(this,"id",void 0);abstract_dashboard_drilldown_defineProperty(this,"supportedTriggers",void 0);abstract_dashboard_drilldown_defineProperty(this,"order",100);abstract_dashboard_drilldown_defineProperty(this,"getDisplayName",()=>txtGoToDashboard);abstract_dashboard_drilldown_defineProperty(this,"euiIcon","dashboardApp");abstract_dashboard_drilldown_defineProperty(this,"ReactCollectConfig",props=>external_kbnSharedDeps_React_default.a.createElement(collect_config_container_CollectConfigContainer,_extends({},props,{params:this.params})));abstract_dashboard_drilldown_defineProperty(this,"CollectConfig",Object(kibanaReact_public_["reactToUiComponent"])(this.ReactCollectConfig));abstract_dashboard_drilldown_defineProperty(this,"createConfig",()=>({dashboardId:"",useCurrentFilters:true,useCurrentDateRange:true}));abstract_dashboard_drilldown_defineProperty(this,"isConfigValid",config=>{if(!config.dashboardId)return false;return true});abstract_dashboard_drilldown_defineProperty(this,"getHref",function(){var _ref=abstract_dashboard_drilldown_asyncToGenerator(regeneratorRuntime.mark((function _callee(config,context){var url;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return _this.getURL(config,context);case 2:url=_context.sent;return _context.abrupt("return",url.path);case 4:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref.apply(this,arguments)}}());abstract_dashboard_drilldown_defineProperty(this,"execute",function(){var _ref2=abstract_dashboard_drilldown_asyncToGenerator(regeneratorRuntime.mark((function _callee2(config,context){var url;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _this.getURL(config,context);case 2:url=_context2.sent;_context2.next=5;return _this.params.start().core.application.navigateToApp(url.appName,{path:url.appPath});case 5:case"end":return _context2.stop()}}),_callee2)})));return function(_x3,_x4){return _ref2.apply(this,arguments)}}())}get urlGenerator(){const urlGenerator=this.params.start().plugins.dashboard.dashboardUrlGenerator;if(!urlGenerator)throw new Error("Dashboard URL generator is required for dashboard drilldown.");return urlGenerator}}var types=__webpack_require__(10);var share_public_=__webpack_require__(12);function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function dashboard_drilldown_persistable_state_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function dashboard_drilldown_persistable_state_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){dashboard_drilldown_persistable_state_ownKeys(Object(source),true).forEach((function(key){dashboard_drilldown_persistable_state_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{dashboard_drilldown_persistable_state_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function dashboard_drilldown_persistable_state_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const generateRefName=(state,id)=>"drilldown:".concat(id,":").concat(state.eventId,":dashboardId");const injectDashboardId=(state,dashboardId)=>dashboard_drilldown_persistable_state_objectSpread(dashboard_drilldown_persistable_state_objectSpread({},state),{},{action:dashboard_drilldown_persistable_state_objectSpread(dashboard_drilldown_persistable_state_objectSpread({},state.action),{},{config:dashboard_drilldown_persistable_state_objectSpread(dashboard_drilldown_persistable_state_objectSpread({},state.action.config),{},{dashboardId:dashboardId})})});const createInject=({drilldownId:drilldownId})=>(state,references)=>{const action=state.action;const refName=generateRefName(state,drilldownId);const ref=references.find(r=>r.name===refName);if(!ref)return state;if(ref.id&&ref.id===action.config.dashboardId)return state;return injectDashboardId(state,ref.id)};const createExtract=({drilldownId:drilldownId})=>state=>{const action=state.action;const references=action.config.dashboardId?[{name:generateRefName(state,drilldownId),type:"dashboard",id:action.config.dashboardId}]:[];const _action$config=action.config,dashboardId=_action$config.dashboardId,restOfConfig=_objectWithoutProperties(_action$config,["dashboardId"]);return{state:dashboard_drilldown_persistable_state_objectSpread(dashboard_drilldown_persistable_state_objectSpread({},state),{},{action:dashboard_drilldown_persistable_state_objectSpread(dashboard_drilldown_persistable_state_objectSpread({},state.action),{},{config:restOfConfig})}),references:references}};const constants_EMBEDDABLE_TO_DASHBOARD_DRILLDOWN="DASHBOARD_TO_DASHBOARD_DRILLDOWN";var dashboard_drilldown_types=__webpack_require__(11);function embeddable_to_dashboard_drilldown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function embeddable_to_dashboard_drilldown_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){embeddable_to_dashboard_drilldown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){embeddable_to_dashboard_drilldown_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function embeddable_to_dashboard_drilldown_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class embeddable_to_dashboard_drilldown_EmbeddableToDashboardDrilldown extends abstract_dashboard_drilldown_AbstractDashboardDrilldown{constructor(...args){super(...args);embeddable_to_dashboard_drilldown_defineProperty(this,"id",EMBEDDABLE_TO_DASHBOARD_DRILLDOWN);embeddable_to_dashboard_drilldown_defineProperty(this,"supportedTriggers",()=>[uiActions_public_["APPLY_FILTER_TRIGGER"]]);embeddable_to_dashboard_drilldown_defineProperty(this,"inject",createInject({drilldownId:this.id}));embeddable_to_dashboard_drilldown_defineProperty(this,"extract",createExtract({drilldownId:this.id}))}getURL(config,context){var _this=this;return embeddable_to_dashboard_drilldown_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var state,_input$filters,input,_esFilters$extractTim,filtersFromEvent,timeRangeFromEvent,_state$filters,path,url;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:state={dashboardId:config.dashboardId};if(context.embeddable){input=context.embeddable.getInput();if(Object(data_public_["isQuery"])(input.query)&&config.useCurrentFilters)state.query=input.query;if(Object(data_public_["isTimeRange"])(input.timeRange)&&config.useCurrentDateRange)state.timeRange=input.timeRange;if(Object(data_public_["isFilters"])(input.filters))state.filters=config.useCurrentFilters?input.filters:(_input$filters=input.filters)===null||_input$filters===void 0?void 0:_input$filters.filter(f=>data_public_["esFilters"].isFilterPinned(f))}_esFilters$extractTim=data_public_["esFilters"].extractTimeRange(context.filters,context.timeFieldName),filtersFromEvent=_esFilters$extractTim.restOfFilters,timeRangeFromEvent=_esFilters$extractTim.timeRange;if(filtersFromEvent){state.filters=[...(_state$filters=state.filters)!==null&&_state$filters!==void 0?_state$filters:[],...filtersFromEvent]}if(timeRangeFromEvent){state.timeRange=timeRangeFromEvent}_context.next=7;return _this.urlGenerator.createUrl(state);case 7:path=_context.sent;url=new share_public_["KibanaURL"](path);return _context.abrupt("return",url);case 10:case"end":return _context.stop()}}),_callee)})))()}}class dashboard_drilldowns_services_DashboardDrilldownsService{bootstrap(core,plugins,{enableDrilldowns:enableDrilldowns}){if(enableDrilldowns){this.setupDrilldowns(core,plugins)}}setupDrilldowns(core,{uiActionsEnhanced:uiActions}){const start=Object(kibanaUtils_public_["createStartServicesGetter"])(core.getStartServices);const actionFlyoutCreateDrilldown=new flyout_create_drilldown_FlyoutCreateDrilldownAction({start:start});uiActions.addTriggerAction(public_["CONTEXT_MENU_TRIGGER"],actionFlyoutCreateDrilldown);const actionFlyoutEditDrilldown=new flyout_edit_drilldown_FlyoutEditDrilldownAction({start:start});uiActions.addTriggerAction(public_["CONTEXT_MENU_TRIGGER"],actionFlyoutEditDrilldown);const dashboardToDashboardDrilldown=new embeddable_to_dashboard_drilldown_EmbeddableToDashboardDrilldown({start:start});uiActions.registerDrilldown(dashboardToDashboardDrilldown)}}function plugin_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class plugin_DashboardEnhancedPlugin{constructor(context){this.context=context;plugin_defineProperty(this,"drilldowns",new dashboard_drilldowns_services_DashboardDrilldownsService)}setup(core,plugins){this.drilldowns.bootstrap(core,plugins,{enableDrilldowns:true});return{}}start(core,plugins){return{}}stop(){}}function public_plugin(context){return new plugin_DashboardEnhancedPlugin(context)}}]);