/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["painlessLab_bundle_jsonpfunction"]=window["painlessLab_bundle_jsonpfunction"]||[]).push([[1],{25:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return renderApp}));var external_kbnSharedDeps_React_=__webpack_require__(1);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(22);var public_=__webpack_require__(20);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(0);const defaultLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.contextDefaultLabel",{defaultMessage:"Basic"});const filterLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.contextFilterLabel",{defaultMessage:"Filter"});const scoreLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.contextScoreLabel",{defaultMessage:"Score"});const painlessContextOptions=[{value:"painless_test",inputDisplay:defaultLabel,"data-test-subj":"basicButtonDropdown",dropdownDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("strong",null,defaultLabel),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",{className:"euiTextColor--subdued"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.context.defaultLabel",{defaultMessage:"The script result will be converted to a string"}))))},{value:"filter",inputDisplay:filterLabel,"data-test-subj":"filterButtonDropdown",dropdownDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("strong",null,filterLabel),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",{className:"euiTextColor--subdued"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.context.filterLabel",{defaultMessage:"Use the context of a filter's script query"}))))},{value:"score",inputDisplay:scoreLabel,"data-test-subj":"scoreButtonDropdown",dropdownDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("strong",null,scoreLabel),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",{className:"euiTextColor--subdued"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.context.scoreLabel",{defaultMessage:"Use the context of a script_score function in function_score query"}))))}];const exampleScript='boolean isInCircle(def posX, def posY, def circleX, def circleY, def radius) {\n  double distanceFromCircleCenter = Math.sqrt(Math.pow(circleX - posX, 2) + Math.pow(circleY - posY, 2));\n  return distanceFromCircleCenter <= radius;\n}\n\nboolean isOnCircle(def posX, def posY, def circleX, def circleY, def radius, def thickness, def squashY) {\n  double distanceFromCircleCenter = Math.sqrt(Math.pow(circleX - posX, 2) + Math.pow((circleY - posY) / squashY, 2));\n  return (\n    distanceFromCircleCenter >= radius - thickness\n    && distanceFromCircleCenter <= radius + thickness\n  );\n}\n\ndef result = \'\';\nint charCount = 0;\n\n// Canvas dimensions\nint width = 31;\nint height = 31;\ndouble halfWidth = Math.floor(width * 0.5);\ndouble halfHeight = Math.floor(height * 0.5);\n\n// Style constants\ndouble strokeWidth = 0.6;\n\n// Smiley face configuration\nint headSize = 13;\ndouble headSquashY = 0.78;\nint eyePositionX = 10;\nint eyePositionY = 12;\nint eyeSize = 1;\nint mouthSize = 15;\nint mouthPositionX = width / 2;\nint mouthPositionY = 5;\nint mouthOffsetY = 11;\n\nfor (int y = 0; y < height; y++) {\n  for (int x = 0; x < width; x++) {\n    boolean isHead = isOnCircle(x, y, halfWidth, halfHeight, headSize, strokeWidth, headSquashY);\n    boolean isLeftEye = isInCircle(x, y, eyePositionX, eyePositionY, eyeSize);\n    boolean isRightEye = isInCircle(x, y, width - eyePositionX - 1, eyePositionY, eyeSize);\n    boolean isMouth = isOnCircle(x, y, mouthPositionX, mouthPositionY, mouthSize, strokeWidth, 1) && y > mouthPositionY + mouthOffsetY;\n\n    if (isLeftEye || isRightEye || isMouth || isHead) {\n      result += "*";\n    } else {\n      result += ".";\n    }\n\n    result += " ";\n\n    // Make sure the smiley face doesn\'t deform as the container changes width.\n    charCount++;\n    if (charCount % width === 0) {\n      result += "\\\\n";\n    }\n  }\n}\n\nreturn result;';const initialPayload={context:painlessContextOptions[0].value,code:exampleScript,parameters:'{\n  "string_parameter": "string value",\n  "number_parameter": 1.5,\n  "boolean_parameter": true\n}',index:"my-index",document:'{\n  "my_field": "field_value"\n}',query:""};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const AppContext=Object(external_kbnSharedDeps_React_["createContext"])(undefined);const validatePayload=payload=>{const index=payload.index;const indexExists=Boolean(index||index.trim());return{isValid:indexExists,fields:{index:indexExists}}};const AppContextProvider=({children:children,value:{http:http,links:links,chrome:chrome}})=>{const PAINLESS_LAB_KEY="painlessLabState";const _useState=Object(external_kbnSharedDeps_React_["useState"])(()=>{const defaultPayload=_objectSpread(_objectSpread({},initialPayload),JSON.parse(localStorage.getItem(PAINLESS_LAB_KEY)||"{}"));return{payload:defaultPayload,validation:validatePayload(defaultPayload)}}),_useState2=_slicedToArray(_useState,2),store=_useState2[0],setStore=_useState2[1];const updatePayload=changes=>{const nextPayload=_objectSpread(_objectSpread({},store.payload),changes);localStorage.setItem(PAINLESS_LAB_KEY,JSON.stringify(nextPayload));setStore({payload:nextPayload,validation:validatePayload(nextPayload)})};return external_kbnSharedDeps_React_default.a.createElement(AppContext.Provider,{value:{updatePayload:updatePayload,store:store,services:{http:http,chrome:chrome},links:links}},children)};const useAppContext=()=>{const ctx=Object(external_kbnSharedDeps_React_["useContext"])(AppContext);if(!ctx){throw new Error("AppContext can only be used inside of AppContextProvider!")}return ctx};let PayloadFormat;(function(PayloadFormat){PayloadFormat["UGLY"]="ugly";PayloadFormat["PRETTY"]="pretty"})(PayloadFormat||(PayloadFormat={}));function prettifyPayload(payload="",indentationLevel=0){const indentation=new Array(indentationLevel+1).join(" ");return payload.replace(/\n/g,"\n".concat(indentation))}function formatRequestPayload({code:code,context:context,parameters:parameters,index:index,document:document,query:query},format=PayloadFormat.UGLY){const isAdvancedContext=context==="filter"||context==="score";let formattedCode;let formattedParameters;let formattedContext;let formattedIndex;let formattedDocument;let formattedQuery;if(format===PayloadFormat.UGLY){formattedCode=JSON.stringify(code);formattedParameters=parameters;formattedContext=context;formattedIndex=index;formattedDocument=document;formattedQuery=query}else{formattedCode='"""'.concat(prettifyPayload(code,4),'"""');formattedParameters=prettifyPayload(parameters,4);formattedContext=prettifyPayload(context,6);formattedIndex=prettifyPayload(index);formattedDocument=prettifyPayload(document,4);formattedQuery=prettifyPayload(query,4)}const requestPayload='{\n  "script": {\n    "source": '.concat(formattedCode).concat(parameters?',\n    "params": '.concat(formattedParameters):"","\n  }").concat(isAdvancedContext?',\n  "context": "'.concat(formattedContext,'",\n  "context_setup": {\n    "index": "').concat(formattedIndex,'",\n    "document": ').concat(formattedDocument).concat(query&&context==="score"?',\n    "query": '.concat(formattedQuery):"","\n  }"):"","\n}");return requestPayload}function formatJson(json){try{return JSON.stringify(json,null,2)}catch(e){return"Invalid JSON ".concat(String(json))}}function formatResponse(response){if(!response){return""}if(typeof response.result==="string"){return response.result.replace(/\\n/g,"\n")}else if(response.error){return formatExecutionError(response.error)}return formatJson(response)}function formatExecutionError(executionErrorOrError){if(executionErrorOrError instanceof Error){return executionErrorOrError.message}if(executionErrorOrError.script_stack&&executionErrorOrError.caused_by&&executionErrorOrError.position){return"Unhandled Exception ".concat(executionErrorOrError.caused_by.type,"\n\n").concat(executionErrorOrError.caused_by.reason,"\n\nStack:\n").concat(formatJson(executionErrorOrError.script_stack),"\n")}return formatJson(executionErrorOrError)}var external_kbnSharedDeps_Lodash_=__webpack_require__(23);var constants=__webpack_require__(5);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_submit_code_slicedToArray(arr,i){return use_submit_code_arrayWithHoles(arr)||use_submit_code_iterableToArrayLimit(arr,i)||use_submit_code_unsupportedIterableToArray(arr,i)||use_submit_code_nonIterableRest()}function use_submit_code_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_submit_code_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_submit_code_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_submit_code_arrayLikeToArray(o,minLen)}function use_submit_code_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_submit_code_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_submit_code_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const DEBOUNCE_MS=800;const useSubmitCode=http=>{const currentRequestIdRef=Object(external_kbnSharedDeps_React_["useRef"])(0);const _useState=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState2=use_submit_code_slicedToArray(_useState,2),response=_useState2[0],setResponse=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=use_submit_code_slicedToArray(_useState3,2),inProgress=_useState4[0],setInProgress=_useState4[1];const submit=Object(external_kbnSharedDeps_React_["useCallback"])(Object(external_kbnSharedDeps_Lodash_["debounce"])(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(config){var requestId,result;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setInProgress(true);requestId=++currentRequestIdRef.current;_context.prev=2;_context.next=5;return http.post("".concat(constants["a"],"/execute"),{body:JSON.stringify(formatRequestPayload(config,PayloadFormat.UGLY))});case 5:result=_context.sent;if(currentRequestIdRef.current===requestId){setResponse(result);setInProgress(false)}_context.next=12;break;case 9:_context.prev=9;_context.t0=_context["catch"](2);if(currentRequestIdRef.current===requestId){setResponse({error:_context.t0});setInProgress(false)}case 12:case"end":return _context.stop()}}),_callee,null,[[2,9]])})));return function(_x){return _ref.apply(this,arguments)}}(),DEBOUNCE_MS,{trailing:true}),[http]);return{response:response,inProgress:inProgress,submit:submit}};function OutputTab({response:response}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{language:"json",paddingSize:"s",isCopyable:true},formatResponse(response)))}var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(21);const ParametersTab=()=>{const _useAppContext=useAppContext(),payload=_useAppContext.store.payload,updatePayload=_useAppContext.updatePayload,links=_useAppContext.links;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.parametersFieldTooltipText",{defaultMessage:'These variables are assigned to the "params" object in your script'})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.painlessLab.parametersFieldLabel",defaultMessage:"Parameters (JSON)"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"questionInCircle",color:"subdued"}))),fullWidth:true,labelAppend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:links.modulesScriptingPreferParams,target:"_blank"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.parametersFieldDocLinkText",{defaultMessage:"Parameters docs"})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(public_["CodeEditor"],{languageId:"json",height:600,value:payload.parameters,onChange:nextParams=>updatePayload({parameters:nextParams}),options:{fontSize:12,minimap:{enabled:false},scrollBeyondLastLine:false,wordWrap:"on",wrappingIndent:"indent",automaticLayout:true},editorDidMount:editor=>{const model=editor.getModel();if(model){model.updateOptions({tabSize:2})}}}))))};const ContextTab=()=>{const _useAppContext=useAppContext(),_useAppContext$store=_useAppContext.store,payload=_useAppContext$store.payload,validation=_useAppContext$store.validation,updatePayload=_useAppContext.updatePayload,links=_useAppContext.links;const context=payload.context,document=payload.document,index=payload.index,query=payload.query;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.contextFieldTooltipText",{defaultMessage:"Different contexts provide different functions on the ctx object"})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.painlessLab.contextFieldLabel",defaultMessage:"Execution context"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"questionInCircle",color:"subdued"}))),labelAppend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:links.painlessExecuteAPIContexts,target:"_blank"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.contextFieldDocLinkText",{defaultMessage:"Context docs"}))),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{options:painlessContextOptions,valueOfSelected:context,onChange:nextContext=>updatePayload({context:nextContext}),itemLayoutAlign:"top",hasDividers:true,fullWidth:true})),["filter","score"].indexOf(context)!==-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.indexFieldTooltipText",{defaultMessage:"Index mappings must be compatible with the sample document's fields"})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.painlessLab.indexFieldLabel",defaultMessage:"Index name"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"questionInCircle",color:"subdued"}))),fullWidth:true,isInvalid:!validation.fields.index,error:validation.fields.index?[]:[external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.indexFieldMissingErrorMessage",{defaultMessage:"Enter an index name"})]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,value:index||"",onChange:e=>{const nextIndex=e.target.value;updatePayload({index:nextIndex})},isInvalid:!validation.fields.index})),"score".indexOf(context)!==-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.queryFieldTooltipText",{defaultMessage:"Use query to specify that that _score will be used to calculate score."})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.painlessLab.queryFieldLabel",defaultMessage:"Query"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"questionInCircle",color:"subdued"}))),labelAppend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:links.esQueryDSL,target:"_blank"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.queryFieldDocLinkText",{defaultMessage:"Query DSL docs"}))),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(public_["CodeEditor"],{languageId:"json",height:150,value:query,onChange:nextQuery=>updatePayload({query:nextQuery}),options:{fontSize:12,minimap:{enabled:false},scrollBeyondLastLine:false,wordWrap:"on",wrappingIndent:"indent",automaticLayout:true}}))),["filter","score"].indexOf(context)!==-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.documentFieldTooltipText",{defaultMessage:"Your script can access this document's fields"})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.painlessLab.documentFieldLabel",defaultMessage:"Sample document (JSON)"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"questionInCircle",color:"subdued"}))),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(public_["CodeEditor"],{languageId:"json",height:400,value:document,onChange:nextDocument=>updatePayload({document:nextDocument}),options:{fontSize:12,minimap:{enabled:false},scrollBeyondLastLine:false,wordWrap:"on",wrappingIndent:"indent",automaticLayout:true}}))))};const OutputPane=({isLoading:isLoading,response:response})=>{const outputTabLabel=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"}):response&&response.error?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert",color:"danger"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"check",color:"secondary"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.outputTabLabel",{defaultMessage:"Output"})));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{className:"painlessLabRightPane"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabbedContent"],{className:"painlessLabRightPane__tabs","data-test-subj":"painlessTabs",size:"s",tabs:[{id:"output",name:outputTabLabel,content:external_kbnSharedDeps_React_default.a.createElement(OutputTab,{response:response})},{id:"parameters",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.parametersTabLabel",{defaultMessage:"Parameters"}),content:external_kbnSharedDeps_React_default.a.createElement(ParametersTab,null)},{id:"context",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.contextTabLabel",{defaultMessage:"Context"}),content:external_kbnSharedDeps_React_default.a.createElement(ContextTab,null)}]}))};function main_controls_slicedToArray(arr,i){return main_controls_arrayWithHoles(arr)||main_controls_iterableToArrayLimit(arr,i)||main_controls_unsupportedIterableToArray(arr,i)||main_controls_nonIterableRest()}function main_controls_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function main_controls_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return main_controls_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return main_controls_arrayLikeToArray(o,minLen)}function main_controls_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function main_controls_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function main_controls_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function MainControls({toggleRequestFlyout:toggleRequestFlyout,isRequestFlyoutOpen:isRequestFlyoutOpen,reset:reset,links:links}){const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=main_controls_slicedToArray(_useState,2),isHelpOpen=_useState2[0],setIsHelpOpen=_useState2[1];const items=[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:"walkthrough",icon:"popout",href:links.painlessWalkthrough,target:"_blank",onClick:()=>setIsHelpOpen(false)},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.walkthroughButtonLabel",{defaultMessage:"Walkthrough"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:"api",icon:"popout",href:links.painlessAPIReference,target:"_blank",onClick:()=>setIsHelpOpen(false)},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.apiReferenceButtonLabel",{defaultMessage:"API reference"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:"languageSpec",icon:"popout",href:links.painlessLangSpec,target:"_blank",onClick:()=>setIsHelpOpen(false)},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.languageSpecButtonLabel",{defaultMessage:"Language spec"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:"reset",icon:"bolt",onClick:()=>{reset();setIsHelpOpen(false)}},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.resetButtonLabel",{defaultMessage:"Reset script"}))];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBottomBar"],{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"painlessLabHelpContextMenu",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"s",iconType:"help",iconSide:"left",color:"ghost",onClick:()=>setIsHelpOpen(!isHelpOpen)},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.helpButtonLabel",{defaultMessage:"Help"})),isOpen:isHelpOpen,closePopover:()=>setIsHelpOpen(false),panelPaddingSize:"none",anchorPosition:"upLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:items}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"s",color:"ghost",onClick:toggleRequestFlyout,"data-test-subj":"btnViewRequest"},isRequestFlyoutOpen?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.hideRequestButtonLabel",{defaultMessage:"Hide API request"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.showRequestButtonLabel",{defaultMessage:"Show API request"})))))}var external_kbnSharedDeps_KbnMonaco_=__webpack_require__(24);function Editor({code:code,onChange:onChange}){return external_kbnSharedDeps_React_default.a.createElement(public_["CodeEditor"],{languageId:external_kbnSharedDeps_KbnMonaco_["PainlessLang"].ID,width:"99%",height:"100%",value:code,onChange:onChange,options:{fontSize:12,minimap:{enabled:false},scrollBeyondLastLine:false,wordWrap:"on",wrappingIndent:"indent",automaticLayout:true}})}const RequestFlyout=({onClose:onClose,requestBody:requestBody,response:response,links:links})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyout"],{onClose:onClose,maxWidth:640},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"xs",alignItems:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.flyoutTitle",{defaultMessage:"API request"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"s",flush:"right",href:links.painlessExecuteAPI,target:"_blank",iconType:"help"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.flyoutDocLink",{defaultMessage:"API documentation"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutBody"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabbedContent"],{size:"s",tabs:[{id:"request",name:"Request",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{language:"json",paddingSize:"s",isCopyable:true},"POST _scripts/painless/_execute\n",requestBody)},{id:"response",name:"Response",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{language:"json",paddingSize:"s",isCopyable:true},response)}]}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"painlessLabBottomBarPlaceholder"})));function main_slicedToArray(arr,i){return main_arrayWithHoles(arr)||main_iterableToArrayLimit(arr,i)||main_unsupportedIterableToArray(arr,i)||main_nonIterableRest()}function main_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function main_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return main_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return main_arrayLikeToArray(o,minLen)}function main_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function main_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function main_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const Main=()=>{const _useAppContext=useAppContext(),_useAppContext$store=_useAppContext.store,payload=_useAppContext$store.payload,validation=_useAppContext$store.validation,updatePayload=_useAppContext.updatePayload,http=_useAppContext.services.http,links=_useAppContext.links;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=main_slicedToArray(_useState,2),isRequestFlyoutOpen=_useState2[0],setRequestFlyoutOpen=_useState2[1];const _useSubmitCode=useSubmitCode(http),inProgress=_useSubmitCode.inProgress,response=_useSubmitCode.response,submit=_useSubmitCode.submit;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(validation.isValid){submit(payload)}},[payload,submit,validation.isValid]);const toggleRequestFlyout=()=>{setRequestFlyoutOpen(!isRequestFlyoutOpen)};return external_kbnSharedDeps_React_default.a.createElement("div",{className:"painlessLabMainContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{className:"painlessLabPanelsContainer",responsive:false,gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"painlessLabLeftPane"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{className:"euiScreenReaderOnly"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.painlessLab.title",{defaultMessage:"Painless Lab"}))),external_kbnSharedDeps_React_default.a.createElement(Editor,{code:payload.code,onChange:nextCode=>updatePayload({code:nextCode})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(OutputPane,{isLoading:inProgress,response:response}))),external_kbnSharedDeps_React_default.a.createElement(MainControls,{links:links,isLoading:inProgress,toggleRequestFlyout:toggleRequestFlyout,isRequestFlyoutOpen:isRequestFlyoutOpen,reset:()=>updatePayload({code:exampleScript})}),isRequestFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(RequestFlyout,{links:links,onClose:()=>setRequestFlyoutOpen(false),requestBody:formatRequestPayload(payload,PayloadFormat.PRETTY),response:response?formatJson(response.result||response.error):""}))};function renderApp(element,{http:http,I18nContext:I18nContext,uiSettings:uiSettings,links:links,chrome:chrome}){if(!element){return()=>undefined}const _createKibanaReactCon=Object(public_["createKibanaReactContext"])({uiSettings:uiSettings}),KibanaReactContextProvider=_createKibanaReactCon.Provider;Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(I18nContext,null,external_kbnSharedDeps_React_default.a.createElement(KibanaReactContextProvider,null,external_kbnSharedDeps_React_default.a.createElement(AppContextProvider,{value:{http:http,links:links,chrome:chrome}},external_kbnSharedDeps_React_default.a.createElement(Main,null)))),element);return()=>Object(external_kbnSharedDeps_ReactDom_["unmountComponentAtNode"])(element)}}}]);