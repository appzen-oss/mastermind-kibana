/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["infra_bundle_jsonpfunction"]=window["infra_bundle_jsonpfunction"]||[]).push([[11],{116:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(2);function useMountedState(){var mountedRef=react_1.useRef(false);var get=react_1.useCallback((function(){return mountedRef.current}),[]);react_1.useEffect((function(){mountedRef.current=true;return function(){mountedRef.current=false}}));return get}exports.default=useMountedState},133:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return useSourceId}));__webpack_require__.d(__webpack_exports__,"a",(function(){return replaceSourceIdInQueryString}));var lib=__webpack_require__(0);var pipeable=__webpack_require__(14);var Either=__webpack_require__(11);var lib_function=__webpack_require__(16);var use_url_state=__webpack_require__(96);const SOURCE_ID_URL_STATE_KEY="sourceId";const useSourceId=()=>Object(use_url_state["b"])({defaultState:"default",decodeUrlState:decodeSourceIdUrlState,encodeUrlState:encodeSourceIdUrlState,urlStateKey:SOURCE_ID_URL_STATE_KEY});const replaceSourceIdInQueryString=sourceId=>Object(use_url_state["a"])(SOURCE_ID_URL_STATE_KEY,sourceId);const sourceIdRuntimeType=lib["union"]([lib["string"],lib["undefined"]]);const encodeSourceIdUrlState=sourceIdRuntimeType.encode;const decodeSourceIdUrlState=value=>Object(pipeable["pipe"])(sourceIdRuntimeType.decode(value),Object(Either["fold"])(Object(lib_function["constant"])(undefined),lib_function["identity"]))},491:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(59);var react_1=__webpack_require__(2);var useTimeoutFn_1=tslib_1.__importDefault(__webpack_require__(492));function useDebounce(fn,ms,deps){if(ms===void 0){ms=0}if(deps===void 0){deps=[]}var _a=useTimeoutFn_1.default(fn,ms),isReady=_a[0],cancel=_a[1],reset=_a[2];react_1.useEffect(reset,deps);return[isReady,cancel]}exports.default=useDebounce},492:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(2);function useTimeoutFn(fn,ms){if(ms===void 0){ms=0}var ready=react_1.useRef(false);var timeout=react_1.useRef();var callback=react_1.useRef(fn);var isReady=react_1.useCallback((function(){return ready.current}),[]);var set=react_1.useCallback((function(){ready.current=false;timeout.current&&clearTimeout(timeout.current);timeout.current=setTimeout((function(){ready.current=true;callback.current()}),ms)}),[ms]);var clear=react_1.useCallback((function(){ready.current=null;timeout.current&&clearTimeout(timeout.current)}),[]);react_1.useEffect((function(){callback.current=fn}),[fn]);react_1.useEffect((function(){set();return clear}),[ms]);return[isReady,clear,set]}exports.default=useTimeoutFn},496:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"ExpressionEditor",(function(){return ExpressionEditor}));__webpack_require__.d(__webpack_exports__,"SourceStatusWrapper",(function(){return SourceStatusWrapper}));__webpack_require__.d(__webpack_exports__,"Editor",(function(){return Editor}));__webpack_require__.d(__webpack_exports__,"ExpressionLike",(function(){return ExpressionLike}));var external_kbnSharedDeps_React_=__webpack_require__(2);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(7);var useMount=__webpack_require__(107);var useMount_default=__webpack_require__.n(useMount);const GroupBySelector=({onChange:onChange,fields:fields,selectedGroups:selectedGroups=[],label:label,placeholder:placeholder})=>{const handleChange=Object(external_kbnSharedDeps_React_["useCallback"])(selectedOptions=>{const groupBy=selectedOptions.map(option=>option.label);onChange(groupBy)},[onChange]);const formattedSelectedGroups=Object(external_kbnSharedDeps_React_["useMemo"])(()=>selectedGroups.map(group=>({label:group})),[selectedGroups]);const options=Object(external_kbnSharedDeps_React_["useMemo"])(()=>fields.filter(field=>field.aggregatable).map(field=>({label:field.name})),[fields]);return external_kbnSharedDeps_React_default.a.createElement("div",{style:{minWidth:"300px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{placeholder:placeholder,"aria-label":label,fullWidth:true,singleSelection:false,selectedOptions:formattedSelectedGroups,options:options,onChange:handleChange,isClearable:true}))};function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const DEFAULT_GROUP_BY_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerting.alertFlyout.groupByLabel",{defaultMessage:"Group By"});const EVERYTHING_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerting.alertFlyout.groupBy.placeholder",{defaultMessage:"Nothing (ungrouped)"});const GroupByExpression=({selectedGroups:selectedGroups=[],fields:fields,label:label,onChange:onChange})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=_slicedToArray(_useState,2),isPopoverOpen=_useState2[0],setIsPopoverOpen=_useState2[1];const expressionValue=Object(external_kbnSharedDeps_React_["useMemo"])(()=>selectedGroups.length>0?selectedGroups.join(", "):EVERYTHING_PLACEHOLDER,[selectedGroups]);const labelProp=label!==null&&label!==void 0?label:DEFAULT_GROUP_BY_LABEL;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"groupByExpression",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:labelProp,uppercase:true,value:expressionValue,isActive:isPopoverOpen,onClick:()=>setIsPopoverOpen(true)}),isOpen:isPopoverOpen,closePopover:()=>setIsPopoverOpen(false),ownFocus:true,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement("div",{style:{zIndex:11e3}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,labelProp),external_kbnSharedDeps_React_default.a.createElement(GroupBySelector,{selectedGroups:selectedGroups,onChange:onChange,fields:fields,label:labelProp,placeholder:EVERYTHING_PLACEHOLDER})))))};var public_=__webpack_require__(18);var types=__webpack_require__(5);var external_kbnSharedDeps_Lodash_=__webpack_require__(4);function threshold_slicedToArray(arr,i){return threshold_arrayWithHoles(arr)||threshold_iterableToArrayLimit(arr,i)||threshold_unsupportedIterableToArray(arr,i)||threshold_nonIterableRest()}function threshold_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function threshold_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return threshold_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return threshold_arrayLikeToArray(o,minLen)}function threshold_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function threshold_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function threshold_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const thresholdPrefix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdPrefix",{defaultMessage:"is"});const popoverTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdPopoverTitle",{defaultMessage:"Threshold"});const getComparatorOptions=()=>[{value:types["a"].LT,text:types["b"][types["a"].LT]},{value:types["a"].LT_OR_EQ,text:types["b"][types["a"].LT_OR_EQ]},{value:types["a"].GT,text:types["b"][types["a"].GT]},{value:types["a"].GT_OR_EQ,text:types["b"][types["a"].GT_OR_EQ]}];const Threshold=({comparator:comparator,value:value,updateThreshold:updateThreshold,errors:errors})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=threshold_slicedToArray(_useState,2),isThresholdPopoverOpen=_useState2[0],setThresholdPopoverOpenState=_useState2[1];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"threshold",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:thresholdPrefix,uppercase:true,value:"".concat(comparator?types["b"][comparator]:""," ").concat(value?value:""),isActive:isThresholdPopoverOpen,onClick:()=>setThresholdPopoverOpenState(true)}),isOpen:isThresholdPopoverOpen,closePopover:()=>setThresholdPopoverOpenState(false),ownFocus:true,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,popoverTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,value:comparator,onChange:e=>updateThreshold({comparator:e.target.value}),options:getComparatorOptions()}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:errors.value.length>0,error:errors.value},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{compressed:true,value:value,onChange:e=>{const number=parseFloat(e.target.value);updateThreshold({value:Object(external_kbnSharedDeps_Lodash_["isNumber"])(number)&&Object(external_kbnSharedDeps_Lodash_["isFinite"])(number)?number:undefined})}}))))))))};var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(12);function criterion_slicedToArray(arr,i){return criterion_arrayWithHoles(arr)||criterion_iterableToArrayLimit(arr,i)||criterion_unsupportedIterableToArray(arr,i)||criterion_nonIterableRest()}function criterion_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function criterion_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return criterion_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return criterion_arrayLikeToArray(o,minLen)}function criterion_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function criterion_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function criterion_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const firstCriterionFieldPrefix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.firstCriterionFieldPrefix",{defaultMessage:"with"});const successiveCriterionFieldPrefix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.successiveCriterionFieldPrefix",{defaultMessage:"and"});const criterionFieldTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.criterionFieldTitle",{defaultMessage:"Field"});const criterionComparatorValueTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.criterionComparatorValueTitle",{defaultMessage:"Comparison : Value"});const getCompatibleComparatorsForField=fieldInfo=>{if((fieldInfo===null||fieldInfo===void 0?void 0:fieldInfo.type)==="number"){return[{value:types["a"].GT,text:types["b"][types["a"].GT]},{value:types["a"].GT_OR_EQ,text:types["b"][types["a"].GT_OR_EQ]},{value:types["a"].LT,text:types["b"][types["a"].LT]},{value:types["a"].LT_OR_EQ,text:types["b"][types["a"].LT_OR_EQ]},{value:types["a"].EQ,text:types["b"]["".concat(types["a"].EQ,":number")]},{value:types["a"].NOT_EQ,text:types["b"]["".concat(types["a"].NOT_EQ,":number")]}]}else if(fieldInfo===null||fieldInfo===void 0?void 0:fieldInfo.aggregatable){return[{value:types["a"].EQ,text:types["b"][types["a"].EQ]},{value:types["a"].NOT_EQ,text:types["b"][types["a"].NOT_EQ]}]}else{return[{value:types["a"].MATCH,text:types["b"][types["a"].MATCH]},{value:types["a"].NOT_MATCH,text:types["b"][types["a"].NOT_MATCH]},{value:types["a"].MATCH_PHRASE,text:types["b"][types["a"].MATCH_PHRASE]},{value:types["a"].NOT_MATCH_PHRASE,text:types["b"][types["a"].NOT_MATCH_PHRASE]}]}};const getFieldInfo=(fields,fieldName)=>fields.find(field=>field.name===fieldName);const Criterion=({idx:idx,fields:fields,criterion:criterion,updateCriterion:updateCriterion,removeCriterion:removeCriterion,canDelete:canDelete,errors:errors})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=criterion_slicedToArray(_useState,2),isFieldPopoverOpen=_useState2[0],setIsFieldPopoverOpen=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=criterion_slicedToArray(_useState3,2),isComparatorPopoverOpen=_useState4[0],setIsComparatorPopoverOpen=_useState4[1];const fieldOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>fields.map(field=>({value:field.name,text:field.name})),[fields]);const fieldInfo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getFieldInfo(fields,criterion.field),[fields,criterion]);const compatibleComparatorOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getCompatibleComparatorsForField(fieldInfo),[fieldInfo]);const handleFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const fieldName=e.target.value;const nextFieldInfo=getFieldInfo(fields,fieldName);if(fieldInfo&&nextFieldInfo&&(fieldInfo.type!==nextFieldInfo.type||fieldInfo.aggregatable!==nextFieldInfo.aggregatable)){const compatibleComparators=getCompatibleComparatorsForField(nextFieldInfo);updateCriterion(idx,{field:fieldName,comparator:compatibleComparators[0].value,value:undefined})}else{updateCriterion(idx,{field:fieldName})}},[fieldInfo,fields,idx,updateCriterion]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"criterion-field",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:idx===0?firstCriterionFieldPrefix:successiveCriterionFieldPrefix,uppercase:true,value:criterion.field,isActive:isFieldPopoverOpen,color:errors.field.length===0?"secondary":"danger",onClick:e=>{e.stopPropagation();setIsFieldPopoverOpen(true)}}),isOpen:isFieldPopoverOpen,closePopover:()=>setIsFieldPopoverOpen(false),ownFocus:true,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,criterionFieldTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:errors.field.length>0,error:errors.field},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,value:criterion.field,onChange:handleFieldChange,options:fieldOptions}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"criterion-comparator-value",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:types["b"]["".concat(criterion.comparator,":").concat(fieldInfo===null||fieldInfo===void 0?void 0:fieldInfo.type)]?types["b"]["".concat(criterion.comparator,":").concat(fieldInfo===null||fieldInfo===void 0?void 0:fieldInfo.type)]:types["b"][criterion.comparator],uppercase:true,value:criterion.value,isActive:isComparatorPopoverOpen,color:errors.comparator.length===0&&errors.value.length===0?"secondary":"danger",onClick:e=>{e.stopPropagation();setIsComparatorPopoverOpen(true)}}),isOpen:isComparatorPopoverOpen,closePopover:()=>setIsComparatorPopoverOpen(false),ownFocus:true,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,criterionComparatorValueTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:errors.comparator.length>0,error:errors.comparator},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,value:criterion.comparator,onChange:e=>updateCriterion(idx,{comparator:e.target.value}),options:compatibleComparatorOptions}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:errors.value.length>0,error:errors.value},(fieldInfo===null||fieldInfo===void 0?void 0:fieldInfo.type)==="number"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{compressed:true,value:criterion.value,onChange:e=>{const number=parseFloat(e.target.value);updateCriterion(idx,{value:Object(external_kbnSharedDeps_Lodash_["isNumber"])(number)&&Object(external_kbnSharedDeps_Lodash_["isFinite"])(number)?number:undefined})}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{compressed:true,value:criterion.value,onChange:e=>updateCriterion(idx,{value:e.target.value})}))))))))),canDelete&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.removeCondition",{defaultMessage:"Remove condition"}),color:"danger",iconType:"trash",onClick:e=>{e.stopPropagation();removeCriterion(idx)}})))};var useDebounce=__webpack_require__(491);var useDebounce_default=__webpack_require__.n(useDebounce);var external_kbnSharedDeps_ElasticCharts_=__webpack_require__(61);var external_kbnSharedDeps_Moment_=__webpack_require__(58);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var formatters_number=__webpack_require__(6);const tooltipProps={headerFormatter:tooltipValue=>external_kbnSharedDeps_Moment_default()(tooltipValue.value).format("Y-MM-DD HH:mm:ss")};const NUM_BUCKETS=20;const TIME_LABELS={s:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerts.timeLabels.seconds",{defaultMessage:"seconds"}),m:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerts.timeLabels.minutes",{defaultMessage:"minutes"}),h:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerts.timeLabels.hours",{defaultMessage:"hours"}),d:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerts.timeLabels.days",{defaultMessage:"days"})};const useDateFormatter=(xMin,xMax)=>{const dateFormatter=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(typeof xMin==="number"&&typeof xMax==="number"){return Object(external_kbnSharedDeps_ElasticCharts_["niceTimeFormatter"])([xMin,xMax])}else{return value=>"".concat(value)}},[xMin,xMax]);return dateFormatter};const yAxisFormatter=formatters_number["a"];const getDomain=(series,stacked=false)=>{let min=null;let max=null;const valuesByTimestamp=series.reduce((acc,serie)=>{serie.points.forEach(point=>{const valuesForTimestamp=acc[point.timestamp]||[];acc[point.timestamp]=[...valuesForTimestamp,point.value]});return acc},{});const pointValues=Object.values(valuesByTimestamp);pointValues.forEach(results=>{const maxResult=stacked?Object(external_kbnSharedDeps_Lodash_["sum"])(results):Object(external_kbnSharedDeps_Lodash_["max"])(results);const minResult=Object(external_kbnSharedDeps_Lodash_["min"])(results);if(maxResult&&(!max||maxResult>max)){max=maxResult}if(minResult&&(!min||minResult<min)){min=minResult}});const timestampValues=Object.keys(valuesByTimestamp).map(Number);const minTimestamp=Object(external_kbnSharedDeps_Lodash_["min"])(timestampValues)||0;const maxTimestamp=Object(external_kbnSharedDeps_Lodash_["max"])(timestampValues)||0;return{yMin:min||0,yMax:max||0,xMin:minTimestamp,xMax:maxTimestamp}};const getChartTheme=isDarkMode=>isDarkMode?external_kbnSharedDeps_ElasticCharts_["DARK_THEME"]:external_kbnSharedDeps_ElasticCharts_["LIGHT_THEME"];const EmptyContainer=({children:children})=>external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:"100%",height:150,display:"flex",justifyContent:"center",alignItems:"center"}},children);const ChartContainer=({children:children})=>external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:"100%",height:150}},children);const NoDataState=()=>external_kbnSharedDeps_React_default.a.createElement(EmptyContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued","data-test-subj":"noChartData"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.alerts.charts.noDataMessage",defaultMessage:"No chart data available"})));const LoadingState=()=>external_kbnSharedDeps_React_default.a.createElement(EmptyContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued","data-test-subj":"loadingData"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.alerts.charts.loadingMessage",defaultMessage:"Loading"})));const ErrorState=()=>external_kbnSharedDeps_React_default.a.createElement(EmptyContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued","data-test-subj":"chartErrorState"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.alerts.charts.errorMessage",defaultMessage:"Uh oh, something went wrong"})));var color_palette=__webpack_require__(85);var log_alerts=__webpack_require__(209);var use_tracked_promise=__webpack_require__(79);var http_api=__webpack_require__(86);var runtime_types=__webpack_require__(13);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_chart_preview_data_slicedToArray(arr,i){return use_chart_preview_data_arrayWithHoles(arr)||use_chart_preview_data_iterableToArrayLimit(arr,i)||use_chart_preview_data_unsupportedIterableToArray(arr,i)||use_chart_preview_data_nonIterableRest()}function use_chart_preview_data_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_chart_preview_data_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_chart_preview_data_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_chart_preview_data_arrayLikeToArray(o,minLen)}function use_chart_preview_data_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_chart_preview_data_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_chart_preview_data_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useChartPreviewData=({context:context,sourceId:sourceId,alertParams:alertParams,buckets:buckets})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])([]),_useState2=use_chart_preview_data_slicedToArray(_useState,2),chartPreviewData=_useState2[0],setChartPreviewData=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=use_chart_preview_data_slicedToArray(_useState3,2),hasError=_useState4[0],setHasError=_useState4[1];const _useTrackedPromise=Object(use_tracked_promise["b"])({cancelPreviousOn:"creation",createPromise:function(){var _createPromise=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setHasError(false);_context.next=3;return callGetChartPreviewDataAPI(sourceId,context.http.fetch,alertParams,buckets);case 3:return _context.abrupt("return",_context.sent);case 4:case"end":return _context.stop()}}),_callee)})));function createPromise(){return _createPromise.apply(this,arguments)}return createPromise}(),onResolve:({data:{series:series}})=>{setHasError(false);setChartPreviewData(series)},onReject:error=>{setHasError(true)}},[sourceId,context.http.fetch,alertParams,buckets]),_useTrackedPromise2=use_chart_preview_data_slicedToArray(_useTrackedPromise,2),getChartPreviewDataRequest=_useTrackedPromise2[0],getChartPreviewData=_useTrackedPromise2[1];const isLoading=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getChartPreviewDataRequest.state==="pending",[getChartPreviewDataRequest.state]);return{chartPreviewData:chartPreviewData,hasError:hasError,isLoading:isLoading,getChartPreviewData:getChartPreviewData}};const callGetChartPreviewDataAPI=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(sourceId,fetch,alertParams,buckets){var response;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(http_api["a"],{method:"POST",body:JSON.stringify(http_api["m"].encode({data:{sourceId:sourceId,alertParams:alertParams,buckets:buckets}}))});case 2:response=_context2.sent;return _context2.abrupt("return",Object(runtime_types["b"])(http_api["n"])(response));case 4:case"end":return _context2.stop()}}),_callee2)})));return function callGetChartPreviewDataAPI(_x,_x2,_x3,_x4){return _ref.apply(this,arguments)}}();function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const GROUP_LIMIT=5;const CriterionPreview=({alertParams:alertParams,context:context,chartCriterion:chartCriterion,sourceId:sourceId,showThreshold:showThreshold})=>{const chartAlertParams=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const field=chartCriterion.field,comparator=chartCriterion.comparator,value=chartCriterion.value;const criteria=field&&comparator&&value?[{field:field,comparator:comparator,value:value}]:[];const params={criteria:criteria,timeSize:alertParams.timeSize,timeUnit:alertParams.timeUnit,groupBy:alertParams.groupBy};try{return Object(runtime_types["b"])(log_alerts["b"])(params)}catch(error){return null}},[alertParams.timeSize,alertParams.timeUnit,alertParams.groupBy,chartCriterion]);if(chartAlertParams===null||chartAlertParams.criteria.length===0)return null;return external_kbnSharedDeps_React_default.a.createElement(CriterionPreviewChart,{buckets:!chartAlertParams.groupBy||chartAlertParams.groupBy.length===0?NUM_BUCKETS:NUM_BUCKETS/4,context:context,sourceId:sourceId,threshold:alertParams.count,chartAlertParams:chartAlertParams,showThreshold:showThreshold})};const CriterionPreviewChart=({buckets:buckets,context:context,sourceId:sourceId,threshold:threshold,chartAlertParams:chartAlertParams,showThreshold:showThreshold})=>{var _context$uiSettings;const isDarkMode=((_context$uiSettings=context.uiSettings)===null||_context$uiSettings===void 0?void 0:_context$uiSettings.get("theme:darkMode"))||false;const _useChartPreviewData=useChartPreviewData({context:context,sourceId:sourceId,alertParams:chartAlertParams,buckets:buckets}),getChartPreviewData=_useChartPreviewData.getChartPreviewData,isLoading=_useChartPreviewData.isLoading,hasError=_useChartPreviewData.hasError,series=_useChartPreviewData.chartPreviewData;useDebounce_default()(()=>{getChartPreviewData()},500,[getChartPreviewData]);const isStacked=false;const timeSize=chartAlertParams.timeSize,timeUnit=chartAlertParams.timeUnit,groupBy=chartAlertParams.groupBy;const isGrouped=groupBy&&groupBy.length>0?true:false;const isAbove=showThreshold&&threshold&&threshold.comparator?[types["a"].GT,types["a"].GT_OR_EQ].includes(threshold.comparator):false;const isBelow=showThreshold&&threshold&&threshold.comparator?[types["a"].LT,types["a"].LT_OR_EQ].includes(threshold.comparator):false;const filteredSeries=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(!isGrouped){return series}const sortedByMax=series.sort((a,b)=>{const aMax=Math.max(...a.points.map(point=>point.value));const bMax=Math.max(...b.points.map(point=>point.value));return bMax-aMax});const sortedSeries=!isAbove&&!isBelow||isAbove?sortedByMax:sortedByMax.reverse();return sortedSeries.slice(0,GROUP_LIMIT)},[series,isGrouped,isAbove,isBelow]);const barSeries=Object(external_kbnSharedDeps_React_["useMemo"])(()=>filteredSeries.reduce((acc,serie)=>{const barPoints=serie.points.reduce((pointAcc,point)=>[...pointAcc,_objectSpread(_objectSpread({},point),{},{groupBy:serie.id})],[]);return[...acc,...barPoints]},[]),[filteredSeries]);const lookback=timeSize*buckets;const hasData=series.length>0;const _getDomain=getDomain(filteredSeries,isStacked),yMin=_getDomain.yMin,yMax=_getDomain.yMax,xMin=_getDomain.xMin,xMax=_getDomain.xMax;const chartDomain={max:showThreshold&&threshold&&threshold.value?Math.max(yMax,threshold.value)*1.1:yMax*1.1,min:showThreshold&&threshold&&threshold.value?Math.min(yMin,threshold.value):yMin};if(showThreshold&&threshold&&threshold.value&&chartDomain.min===threshold.value){chartDomain.min=chartDomain.min*.9}const THRESHOLD_OPACITY=.3;const groupByLabel=groupBy&&groupBy.length>0?groupBy.join(", "):null;const dateFormatter=useDateFormatter(xMin,xMax);const timeLabel=TIME_LABELS[timeUnit];if(isLoading){return external_kbnSharedDeps_React_default.a.createElement(LoadingState,null)}else if(hasError){return external_kbnSharedDeps_React_default.a.createElement(ErrorState,null)}else if(!hasData){return external_kbnSharedDeps_React_default.a.createElement(NoDataState,null)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ChartContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["BarSeries"],{id:"criterion-preview",xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,xAccessor:"timestamp",yAccessors:["value"],splitSeriesAccessors:["groupBy"],stackAccessors:isStacked?["timestamp"]:undefined,data:barSeries,barSeriesStyle:{rectBorder:{stroke:!isGrouped?Object(color_palette["b"])(color_palette["a"].color0):undefined,strokeWidth:1,visible:true},rect:{opacity:1}},color:!isGrouped?Object(color_palette["b"])(color_palette["a"].color0):undefined}),showThreshold&&threshold&&threshold.value?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["LineAnnotation"],{id:"threshold-line",domainType:external_kbnSharedDeps_ElasticCharts_["AnnotationDomainTypes"].YDomain,dataValues:[{dataValue:threshold.value}],style:{line:{strokeWidth:2,stroke:Object(color_palette["b"])(color_palette["a"].color1),opacity:1}}}):null,showThreshold&&threshold&&threshold.value&&isBelow?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["RectAnnotation"],{id:"below-threshold",style:{fill:Object(color_palette["b"])(color_palette["a"].color1),opacity:THRESHOLD_OPACITY},dataValues:[{coordinates:{x0:xMin,x1:xMax,y0:chartDomain.min,y1:threshold.value}}]}):null,showThreshold&&threshold&&threshold.value&&isAbove?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["RectAnnotation"],{id:"above-threshold",style:{fill:Object(color_palette["b"])(color_palette["a"].color1),opacity:THRESHOLD_OPACITY},dataValues:[{coordinates:{x0:xMin,x1:xMax,y0:threshold.value,y1:chartDomain.max}}]}):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:"timestamp",position:external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,showOverlappingTicks:true,tickFormat:dateFormatter}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:"values",position:external_kbnSharedDeps_ElasticCharts_["Position"].Left,tickFormat:yAxisFormatter,domain:chartDomain}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],{tooltip:tooltipProps,theme:getChartTheme(isDarkMode)}))),external_kbnSharedDeps_React_default.a.createElement("div",{style:{textAlign:"center"}},groupByLabel!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.logs.alerts.dataTimeRangeLabelWithGrouping",defaultMessage:"Last {lookback} {timeLabel} of data, grouped by {groupByLabel} (showing {displayedGroups}/{totalGroups} groups)",values:{groupByLabel:groupByLabel,timeLabel:timeLabel,lookback:lookback,displayedGroups:filteredSeries.length,totalGroups:series.length}})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.logs.alerts.dataTimeRangeLabel",defaultMessage:"Last {lookback} {timeLabel} of data",values:{timeLabel:timeLabel,lookback:lookback}}))))};function criteria_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function criteria_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){criteria_ownKeys(Object(source),true).forEach((function(key){criteria_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{criteria_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function criteria_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}const DEFAULT_CRITERIA={field:"log.level",comparator:types["a"].EQ,value:"error"};const QueryAText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alerting.threshold.ratioCriteriaQueryAText",{defaultMessage:"Query A"});const QueryBText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alerting.threshold.ratioCriteriaQueryBText",{defaultMessage:"Query B"});const Criteria=props=>{const criteria=props.criteria,errors=props.errors;if(!criteria||criteria.length===0)return null;return!Object(types["i"])(criteria)?external_kbnSharedDeps_React_default.a.createElement(CountCriteria,_extends({},props,{criteria:criteria,errors:errors})):external_kbnSharedDeps_React_default.a.createElement(RatioCriteria,_extends({},props,{criteria:criteria,errors:errors}))};const CriteriaWrapper=props=>{const updateCriterion=props.updateCriterion,removeCriterion=props.removeCriterion,addCriterion=props.addCriterion,criteria=props.criteria,fields=props.fields,errors=props.errors,alertParams=props.alertParams,context=props.context,sourceId=props.sourceId,_props$isRatio=props.isRatio,isRatio=_props$isRatio===void 0?false:_props$isRatio;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},criteria.map((criterion,idx)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{id:"criterion-".concat(idx),buttonContent:external_kbnSharedDeps_React_default.a.createElement(Criterion,{idx:idx,fields:fields,criterion:criterion,updateCriterion:updateCriterion,removeCriterion:removeCriterion,canDelete:criteria.length>1,errors:errors[idx]}),key:idx,arrowDisplay:"right"},external_kbnSharedDeps_React_default.a.createElement(CriterionPreview,{alertParams:alertParams,context:context,chartCriterion:criterion,sourceId:sourceId,showThreshold:!isRatio}))),external_kbnSharedDeps_React_default.a.createElement(AddCriterionButton,{addCriterion:addCriterion})))};const RatioCriteria=props=>{const criteria=props.criteria,errors=props.errors,updateCriteria=props.updateCriteria;const handleUpdateNumeratorCriteria=Object(external_kbnSharedDeps_React_["useCallback"])(criteriaParam=>{const nextCriteria=[criteriaParam,Object(types["f"])(criteria)];updateCriteria(nextCriteria)},[updateCriteria,criteria]);const handleUpdateDenominatorCriteria=Object(external_kbnSharedDeps_React_["useCallback"])(criteriaParam=>{const nextCriteria=[Object(types["g"])(criteria),criteriaParam];updateCriteria(nextCriteria)},[updateCriteria,criteria]);const _useCriteriaState=useCriteriaState(Object(types["g"])(criteria),handleUpdateNumeratorCriteria),updateNumeratorCriterion=_useCriteriaState.updateCriterion,addNumeratorCriterion=_useCriteriaState.addCriterion,removeNumeratorCriterion=_useCriteriaState.removeCriterion;const _useCriteriaState2=useCriteriaState(Object(types["f"])(criteria),handleUpdateDenominatorCriteria),updateDenominatorCriterion=_useCriteriaState2.updateCriterion,addDenominatorCriterion=_useCriteriaState2.addCriterion,removeDenominatorCriterion=_useCriteriaState2.removeCriterion;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xxl"}),external_kbnSharedDeps_React_default.a.createElement(ExpressionLike,{text:QueryAText}),external_kbnSharedDeps_React_default.a.createElement(CriteriaWrapper,_extends({},props,{criteria:Object(types["g"])(criteria),updateCriterion:updateNumeratorCriterion,addCriterion:addNumeratorCriterion,removeCriterion:removeNumeratorCriterion,errors:errors[0],isRatio:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(ExpressionLike,{text:QueryBText}),external_kbnSharedDeps_React_default.a.createElement(CriteriaWrapper,_extends({},props,{criteria:Object(types["f"])(criteria),updateCriterion:updateDenominatorCriterion,addCriterion:addDenominatorCriterion,removeCriterion:removeDenominatorCriterion,errors:errors[1],isRatio:true})))};const CountCriteria=props=>{const criteria=props.criteria,updateCriteria=props.updateCriteria,errors=props.errors;const handleUpdateCriteria=Object(external_kbnSharedDeps_React_["useCallback"])(criteriaParam=>{updateCriteria(criteriaParam)},[updateCriteria]);const _useCriteriaState3=useCriteriaState(criteria,handleUpdateCriteria),updateCriterion=_useCriteriaState3.updateCriterion,addCriterion=_useCriteriaState3.addCriterion,removeCriterion=_useCriteriaState3.removeCriterion;return external_kbnSharedDeps_React_default.a.createElement(CriteriaWrapper,_extends({},props,{updateCriterion:updateCriterion,addCriterion:addCriterion,removeCriterion:removeCriterion,errors:errors[0]}))};const useCriteriaState=(criteria,onUpdateCriteria)=>{const updateCriterion=Object(external_kbnSharedDeps_React_["useCallback"])((idx,criterionParams)=>{const nextCriteria=criteria.map((criterion,index)=>idx===index?criteria_objectSpread(criteria_objectSpread({},criterion),criterionParams):criterion);onUpdateCriteria(nextCriteria)},[criteria,onUpdateCriteria]);const addCriterion=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const nextCriteria=criteria?[...criteria,DEFAULT_CRITERIA]:[DEFAULT_CRITERIA];onUpdateCriteria(nextCriteria)},[criteria,onUpdateCriteria]);const removeCriterion=Object(external_kbnSharedDeps_React_["useCallback"])(idx=>{const nextCriteria=criteria.filter((criterion,index)=>index!==idx);onUpdateCriteria(nextCriteria)},[criteria,onUpdateCriteria]);return{updateCriterion:updateCriterion,addCriterion:addCriterion,removeCriterion:removeCriterion}};const AddCriterionButton=({addCriterion:addCriterion})=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{color:"primary",iconSide:"left",flush:"left",iconType:"plusInCircleFilled",onClick:addCriterion},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.logs.alertFlyout.addCondition",defaultMessage:"Add condition"})));function type_switcher_slicedToArray(arr,i){return type_switcher_arrayWithHoles(arr)||type_switcher_iterableToArrayLimit(arr,i)||type_switcher_unsupportedIterableToArray(arr,i)||type_switcher_nonIterableRest()}function type_switcher_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function type_switcher_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return type_switcher_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return type_switcher_arrayLikeToArray(o,minLen)}function type_switcher_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function type_switcher_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function type_switcher_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const typePrefix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdTypePrefix",{defaultMessage:"when the"});const countSuffix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdTypeCountSuffix",{defaultMessage:"of log entries"});const ratioSuffix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdTypeRatioSuffix",{defaultMessage:"of Query A to Query B"});const countI18n=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdTypeCount",{defaultMessage:"count"});const ratioI18n=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdTypeRatio",{defaultMessage:"ratio"});const getOptions=()=>[{value:"ratio",text:ratioI18n},{value:"count",text:countI18n}];const getThresholdType=criteria=>Object(types["i"])(criteria)?"ratio":"count";const TypeSwitcher=({criteria:criteria,updateType:updateType})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=type_switcher_slicedToArray(_useState,2),isThresholdTypePopoverOpen=_useState2[0],setThresholdTypePopoverOpenState=_useState2[1];const thresholdType=getThresholdType(criteria);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"thresholdType",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:typePrefix,uppercase:true,value:thresholdType==="ratio"?ratioI18n:countI18n,isActive:isThresholdTypePopoverOpen,onClick:()=>setThresholdTypePopoverOpenState(true)}),external_kbnSharedDeps_React_default.a.createElement(ExpressionLike,{text:thresholdType==="ratio"?ratioSuffix.toUpperCase():countSuffix.toUpperCase()})),isOpen:isThresholdTypePopoverOpen,closePopover:()=>setThresholdTypePopoverOpenState(false),ownFocus:true,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,value:thresholdType,onChange:e=>updateType(thresholdType==="ratio"?"count":"ratio"),options:getOptions()}))))))};var source_id=__webpack_require__(133);var log_source=__webpack_require__(81);function editor_extends(){editor_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return editor_extends.apply(this,arguments)}function editor_slicedToArray(arr,i){return editor_arrayWithHoles(arr)||editor_iterableToArrayLimit(arr,i)||editor_unsupportedIterableToArray(arr,i)||editor_nonIterableRest()}function editor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return editor_arrayLikeToArray(o,minLen)}function editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function editor_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function editor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function editor_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function editor_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){editor_ownKeys(Object(source),true).forEach((function(key){editor_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{editor_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const editor_DEFAULT_CRITERIA={field:"log.level",comparator:types["a"].EQ,value:"error"};const DEFAULT_BASE_EXPRESSION={timeSize:5,timeUnit:"m"};const DEFAULT_COUNT_EXPRESSION=editor_objectSpread(editor_objectSpread({},DEFAULT_BASE_EXPRESSION),{},{count:{value:75,comparator:types["a"].GT},criteria:[editor_DEFAULT_CRITERIA]});const DEFAULT_RATIO_EXPRESSION=editor_objectSpread(editor_objectSpread({},DEFAULT_BASE_EXPRESSION),{},{count:{value:2,comparator:types["a"].GT},criteria:[[editor_DEFAULT_CRITERIA],[{field:"log.level",comparator:types["a"].EQ,value:"warning"}]]});const ExpressionEditor=props=>{var _props$alertsContext$;const isInternal=(_props$alertsContext$=props.alertsContext.metadata)===null||_props$alertsContext$===void 0?void 0:_props$alertsContext$.isInternal;const _useSourceId=Object(source_id["b"])(),_useSourceId2=editor_slicedToArray(_useSourceId,1),sourceId=_useSourceId2[0];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isInternal?external_kbnSharedDeps_React_default.a.createElement(SourceStatusWrapper,props,external_kbnSharedDeps_React_default.a.createElement(Editor,editor_extends({},props,{sourceId:sourceId}))):external_kbnSharedDeps_React_default.a.createElement(log_source["a"],{sourceId:sourceId,fetch:props.alertsContext.http.fetch},external_kbnSharedDeps_React_default.a.createElement(SourceStatusWrapper,props,external_kbnSharedDeps_React_default.a.createElement(Editor,editor_extends({},props,{sourceId:sourceId})))))};const SourceStatusWrapper=props=>{const _useLogSourceContext=Object(log_source["c"])(),initialize=_useLogSourceContext.initialize,isLoadingSourceStatus=_useLogSourceContext.isLoadingSourceStatus,isUninitialized=_useLogSourceContext.isUninitialized,hasFailedLoadingSourceStatus=_useLogSourceContext.hasFailedLoadingSourceStatus,loadSourceStatus=_useLogSourceContext.loadSourceStatus;const children=props.children;useMount_default()(()=>{initialize()});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isLoadingSourceStatus||isUninitialized?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"})):hasFailedLoadingSourceStatus?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.sourceStatusError",{defaultMessage:"Sorry, there was a problem loading field information"}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:loadSourceStatus,iconType:"refresh"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.sourceStatusErrorTryAgain",{defaultMessage:"Try again"}))):children)};const Editor=props=>{var _alertParams$count,_alertParams$count2;const setAlertParams=props.setAlertParams,alertParams=props.alertParams,errors=props.errors,alertsContext=props.alertsContext,sourceId=props.sourceId;const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=editor_slicedToArray(_useState,2),hasSetDefaults=_useState2[0],setHasSetDefaults=_useState2[1];const _useLogSourceContext2=Object(log_source["c"])(),sourceStatus=_useLogSourceContext2.sourceStatus;useMount_default()(()=>{for(var _i2=0,_Object$entries=Object.entries(editor_objectSpread(editor_objectSpread({},DEFAULT_COUNT_EXPRESSION),alertParams));_i2<_Object$entries.length;_i2++){const _Object$entries$_i=editor_slicedToArray(_Object$entries[_i2],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];setAlertParams(key,value)}setHasSetDefaults(true)});const supportedFields=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(sourceStatus===null||sourceStatus===void 0?void 0:sourceStatus.logIndexFields){return sourceStatus.logIndexFields.filter(field=>(field.type==="string"||field.type==="number")&&field.searchable)}else{return[]}},[sourceStatus]);const groupByFields=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(sourceStatus===null||sourceStatus===void 0?void 0:sourceStatus.logIndexFields){return sourceStatus.logIndexFields.filter(field=>field.type==="string"&&field.aggregatable)}else{return[]}},[sourceStatus]);const updateThreshold=Object(external_kbnSharedDeps_React_["useCallback"])(thresholdParams=>{const nextThresholdParams=editor_objectSpread(editor_objectSpread({},alertParams.count),thresholdParams);setAlertParams("count",nextThresholdParams)},[alertParams.count,setAlertParams]);const updateCriteria=Object(external_kbnSharedDeps_React_["useCallback"])(criteria=>{setAlertParams("criteria",criteria)},[setAlertParams]);const updateTimeSize=Object(external_kbnSharedDeps_React_["useCallback"])(ts=>{setAlertParams("timeSize",ts)},[setAlertParams]);const updateTimeUnit=Object(external_kbnSharedDeps_React_["useCallback"])(tu=>{setAlertParams("timeUnit",tu)},[setAlertParams]);const updateGroupBy=Object(external_kbnSharedDeps_React_["useCallback"])(groups=>{setAlertParams("groupBy",groups)},[setAlertParams]);const updateType=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{const defaults=type==="count"?DEFAULT_COUNT_EXPRESSION:DEFAULT_RATIO_EXPRESSION;for(var _i3=0,_Object$entries2=Object.entries({criteria:defaults.criteria,count:defaults.count});_i3<_Object$entries2.length;_i3++){const _Object$entries2$_i=editor_slicedToArray(_Object$entries2[_i3],2),key=_Object$entries2$_i[0],value=_Object$entries2$_i[1];setAlertParams(key,value)}},[setAlertParams]);if(!hasSetDefaults)return null;const criteriaComponent=alertParams.criteria?external_kbnSharedDeps_React_default.a.createElement(Criteria,{fields:supportedFields,criteria:alertParams.criteria,errors:errors.criteria,alertParams:alertParams,context:alertsContext,sourceId:sourceId,updateCriteria:updateCriteria}):null;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(TypeSwitcher,{criteria:alertParams.criteria||[],updateType:updateType}),alertParams.criteria&&!Object(types["i"])(alertParams.criteria)&&criteriaComponent,external_kbnSharedDeps_React_default.a.createElement(Threshold,{comparator:(_alertParams$count=alertParams.count)===null||_alertParams$count===void 0?void 0:_alertParams$count.comparator,value:(_alertParams$count2=alertParams.count)===null||_alertParams$count2===void 0?void 0:_alertParams$count2.value,updateThreshold:updateThreshold,errors:errors.threshold}),external_kbnSharedDeps_React_default.a.createElement(public_["ForLastExpression"],{timeWindowSize:alertParams.timeSize,timeWindowUnit:alertParams.timeUnit,onChangeWindowSize:updateTimeSize,onChangeWindowUnit:updateTimeUnit,errors:{timeWindowSize:errors.timeWindowSize,timeSizeUnit:errors.timeSizeUnit}}),external_kbnSharedDeps_React_default.a.createElement(GroupByExpression,{selectedGroups:alertParams.groupBy,onChange:updateGroupBy,fields:groupByFields}),alertParams.criteria&&Object(types["i"])(alertParams.criteria)&&criteriaComponent,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}))};var editor=__webpack_exports__["default"]=ExpressionEditor;const ExpressionLike=({text:text})=>external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiExpression euiExpression-isUppercase euiExpression--secondary"},external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiExpression__description"},text))},76:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var React=__webpack_require__(2);var isDev="production"!=="production";var NO_PROVIDER="_NP_";function createUseContext(context){return function(){var value=React.useContext(context);if(isDev&&value===NO_PROVIDER){console.warn("[constate] Component not wrapped within a Provider.")}return value}}function constate(useValue){for(var _len=arguments.length,splitValues=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){splitValues[_key-1]=arguments[_key]}var Context=React.createContext(NO_PROVIDER);var Provider=function Provider(props){var value=useValue(props);var createMemoDeps=splitValues[0];var deps=createMemoDeps&&createMemoDeps(value);if(isDev&&Array.isArray(deps)){console.warn("[constate] Passing `createMemoDeps` as the second argument is deprecated.","Please, use `React.useMemo` in your custom hook instead.","See https://github.com/diegohaz/constate/issues/98")}var memoizedValue=Array.isArray(deps)?React.useMemo((function(){return value}),deps):value;return React.createElement(Context.Provider,{value:memoizedValue},props.children)};if(isDev&&useValue.name){Context.displayName=useValue.name+".Context";Provider.displayName=useValue.name+".Provider"}var useContext=createUseContext(Context);useContext.Context=Context;useContext.Provider=Provider;var tuple=[];if(!splitValues.length){tuple.push(Provider,createUseContext(Context))}else{var contexts=[];var SplitProvider=function SplitProvider(props){var value=useValue(props);var children=props.children;for(var i=0;i<contexts.length;i+=1){var context=contexts[i];var splitValue=splitValues[i];children=React.createElement(context.Provider,{value:splitValue(value)},children)}return children};if(isDev&&useValue.name){SplitProvider.displayName=useValue.name+".Provider"}tuple.push(SplitProvider);for(var i=0;i<splitValues.length;i+=1){var context=React.createContext(NO_PROVIDER);contexts.push(context);tuple.push(createUseContext(context))}}for(var _i=0;_i<tuple.length;_i+=1){useContext[_i]=tuple[_i]}if(typeof Symbol==="function"&&Symbol.iterator){useContext[Symbol.iterator]=function(){return tuple[Symbol.iterator]()}}return useContext}exports.default=constate},79:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return useTrackedPromise}));__webpack_require__.d(__webpack_exports__,"a",(function(){return CanceledPromiseError}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(116);var react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1__);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useTrackedPromise=({createPromise:createPromise,onResolve:onResolve=noOp,onReject:onReject=noOp,cancelPreviousOn:cancelPreviousOn="never",triggerOrThrow:triggerOrThrow="whenMounted"},dependencies)=>{const isComponentMounted=react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1___default()();const shouldTriggerOrThrow=Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(()=>{switch(triggerOrThrow){case"always":return true;case"whenMounted":return isComponentMounted()}},[isComponentMounted,triggerOrThrow]);const pendingPromises=Object(react__WEBPACK_IMPORTED_MODULE_0__["useRef"])([]);const _useState=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])({state:"uninitialized"}),_useState2=_slicedToArray(_useState,2),promiseState=_useState2[0],setPromiseState=_useState2[1];const execute=Object(react__WEBPACK_IMPORTED_MODULE_0__["useMemo"])(()=>(...args)=>{let rejectCancellationPromise;const cancellationPromise=new Promise((_,reject)=>{rejectCancellationPromise=reject});const previousPendingPromises=pendingPromises.current;const cancelPreviousPendingPromises=()=>{previousPendingPromises.forEach(promise=>promise.cancel())};const newPromise=createPromise(...args);const newCancelablePromise=Promise.race([newPromise,cancellationPromise]);setPromiseState({state:"pending",promise:newCancelablePromise});if(cancelPreviousOn==="creation"){cancelPreviousPendingPromises()}const newPendingPromise={cancel:()=>{rejectCancellationPromise(new CanceledPromiseError)},cancelSilently:()=>{rejectCancellationPromise(new SilentCanceledPromiseError)},promise:newCancelablePromise.then(value=>{setPromiseState(previousPromiseState=>previousPromiseState.state==="pending"&&previousPromiseState.promise===newCancelablePromise?{state:"resolved",promise:newPendingPromise.promise,value:value}:previousPromiseState);if(["settlement","resolution"].includes(cancelPreviousOn)){cancelPreviousPendingPromises()}pendingPromises.current=pendingPromises.current.filter(pendingPromise=>pendingPromise.promise!==newPendingPromise.promise);if(onResolve&&shouldTriggerOrThrow()){onResolve(value)}return value},value=>{if(!(value instanceof SilentCanceledPromiseError)){setPromiseState(previousPromiseState=>previousPromiseState.state==="pending"&&previousPromiseState.promise===newCancelablePromise?{state:"rejected",promise:newCancelablePromise,value:value}:previousPromiseState)}if(["settlement","rejection"].includes(cancelPreviousOn)){cancelPreviousPendingPromises()}pendingPromises.current=pendingPromises.current.filter(pendingPromise=>pendingPromise.promise!==newPendingPromise.promise);if(shouldTriggerOrThrow()){if(onReject){onReject(value)}throw value}})};pendingPromises.current=[...pendingPromises.current,newPendingPromise];newPendingPromise.promise.catch(noOp);return newPendingPromise.promise},dependencies);Object(react__WEBPACK_IMPORTED_MODULE_0__["useEffect"])(()=>()=>{pendingPromises.current.forEach(promise=>promise.cancelSilently())},[]);return[promiseState,execute]};class CanceledPromiseError extends Error{constructor(message){super(message);_defineProperty(this,"isCanceled",true);Object.setPrototypeOf(this,new.target.prototype)}}class SilentCanceledPromiseError extends CanceledPromiseError{}const noOp=()=>undefined},83:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return ItemTypeRT}));__webpack_require__.d(__webpack_exports__,"b",(function(){return InventoryVisTypeRT}));__webpack_require__.d(__webpack_exports__,"a",(function(){return InventoryMetricRT}));__webpack_require__.d(__webpack_exports__,"d",(function(){return MetricsUIAggregationRT}));__webpack_require__.d(__webpack_exports__,"e",(function(){return SnapshotMetricTypeRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var io_ts__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(io_ts__WEBPACK_IMPORTED_MODULE_0__);const ItemTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({host:null,pod:null,container:null,awsEC2:null,awsS3:null,awsSQS:null,awsRDS:null});const InventoryVisTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({line:null,area:null,bar:null});const InventoryFormatterTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({abbreviatedNumber:null,bits:null,bytes:null,number:null,percent:null,highPercision:null});const InventoryMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({hostSystemOverview:null,hostCpuUsage:null,hostFilesystem:null,hostK8sOverview:null,hostK8sCpuCap:null,hostK8sDiskCap:null,hostK8sMemoryCap:null,hostK8sPodCap:null,hostLoad:null,hostMemoryUsage:null,hostNetworkTraffic:null,hostDockerOverview:null,hostDockerInfo:null,hostDockerTop5ByCpu:null,hostDockerTop5ByMemory:null,podOverview:null,podCpuUsage:null,podMemoryUsage:null,podLogUsage:null,podNetworkTraffic:null,containerOverview:null,containerCpuKernel:null,containerCpuUsage:null,containerDiskIOOps:null,containerDiskIOBytes:null,containerMemory:null,containerNetworkTraffic:null,nginxHits:null,nginxRequestRate:null,nginxActiveConnections:null,nginxRequestsPerConnection:null,awsOverview:null,awsCpuUtilization:null,awsNetworkBytes:null,awsNetworkPackets:null,awsDiskioBytes:null,awsDiskioOps:null,awsEC2CpuUtilization:null,awsEC2NetworkTraffic:null,awsEC2DiskIOBytes:null,awsS3TotalRequests:null,awsS3NumberOfObjects:null,awsS3BucketSize:null,awsS3DownloadBytes:null,awsS3UploadBytes:null,awsRDSCpuTotal:null,awsRDSConnections:null,awsRDSQueriesExecuted:null,awsRDSActiveTransactions:null,awsRDSLatency:null,awsSQSMessagesVisible:null,awsSQSMessagesDelayed:null,awsSQSMessagesSent:null,awsSQSMessagesEmpty:null,awsSQSOldestMessage:null,custom:null});const TSVBMetricTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({avg:null,max:null,min:null,calculation:null,cardinality:null,series_agg:null,positive_only:null,derivative:null,count:null,sum:null,cumulative_sum:null});const TSVBMetricModelCountRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("count")});const TSVBMetricModelBasicMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:TSVBMetricTypeRT}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})]);const TSVBMetricModelVariableRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],name:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]});const TSVBMetricModelBucketScriptRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],script:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("calculation"),variables:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](TSVBMetricModelVariableRT)});const TSVBMetricModelDerivativeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],unit:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("derivative")});const TSVBMetricModelSeriesAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],function:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("series_agg")});const TSVBPercentileItemRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],value:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"]});const TSVBMetricModePercentileAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("percentile"),percentiles:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](TSVBPercentileItemRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})]);const TSVBMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([TSVBMetricModelCountRT,TSVBMetricModelBasicMetricRT,TSVBMetricModelBucketScriptRT,TSVBMetricModelDerivativeRT,TSVBMetricModePercentileAggRT,TSVBMetricModelSeriesAggRT]);const TSVBSeriesRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](TSVBMetricRT),split_mode:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({terms_field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],terms_size:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],terms_order_by:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],filter:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({query:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],language:io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({lucene:null,kuery:null})})})]);const TSVBMetricModelRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:InventoryMetricRT,requires:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]),index_pattern:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"])]),interval:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],time_field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],series:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](TSVBSeriesRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({filter:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],map_field_to:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],id_type:io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({cloud:null,node:null}),drop_last_bucket:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"]})]);const ESBasicMetricAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"],io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})]));const ESPercentileAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({percentiles:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],percents:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["number"])})});const ESCaridnalityAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({cardinality:io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],script:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})});const ESBucketScriptAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({bucket_script:io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"],io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]])),script:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({source:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],lang:io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({painless:null,expression:null})})}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({gap_policy:io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({skip:null,insert_zeros:null})})])});const ESCumulativeSumAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({cumulative_sum:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})});const ESDerivativeAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({derivative:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],gap_policy:io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({skip:null,insert_zeros:null}),unit:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})});const ESSumBucketAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({sum_bucket:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})});const ESTopHitsAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({top_hits:io_ts__WEBPACK_IMPORTED_MODULE_0__["object"]});const ESTermsWithAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["recursion"]("SnapshotModelRT",()=>io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({terms:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]}),aggregations:MetricsUIAggregationRT}));const ESAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([ESBasicMetricAggRT,ESPercentileAggRT,ESBucketScriptAggRT,ESCumulativeSumAggRT,ESDerivativeAggRT,ESSumBucketAggRT,ESTermsWithAggregationRT,ESCaridnalityAggRT,ESTopHitsAggRT]);const MetricsUIAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],ESAggregationRT);const SnapshotMetricTypeKeys={count:null,cpu:null,load:null,memory:null,tx:null,rx:null,logRate:null,diskIOReadBytes:null,diskIOWriteBytes:null,s3TotalRequests:null,s3NumberOfObjects:null,s3BucketSize:null,s3DownloadBytes:null,s3UploadBytes:null,rdsConnections:null,rdsQueriesExecuted:null,rdsActiveTransactions:null,rdsLatency:null,sqsMessagesVisible:null,sqsMessagesDelayed:null,sqsMessagesSent:null,sqsMessagesEmpty:null,sqsOldestMessage:null,custom:null};const SnapshotMetricTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"](SnapshotMetricTypeKeys)},85:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Color}));__webpack_require__.d(__webpack_exports__,"b",(function(){return colorTransformer}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__);let Color;(function(Color){Color["color0"]="color0";Color["color1"]="color1";Color["color2"]="color2";Color["color3"]="color3";Color["color4"]="color4";Color["color5"]="color5";Color["color6"]="color6";Color["color7"]="color7";Color["color8"]="color8";Color["color9"]="color9"})(Color||(Color={}));const euiPalette=Object(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["euiPaletteColorBlind"])();const defaultPalette={[Color.color0]:euiPalette[1],[Color.color1]:euiPalette[2],[Color.color2]:euiPalette[0],[Color.color3]:euiPalette[3],[Color.color4]:euiPalette[4],[Color.color5]:euiPalette[5],[Color.color6]:euiPalette[6],[Color.color7]:euiPalette[7],[Color.color8]:euiPalette[8],[Color.color9]:euiPalette[9]};const createPaletteTransformer=palette=>color=>palette[color];const colorTransformer=createPaletteTransformer(defaultPalette);const sampleColor=(usedColors=[])=>{const available=Object(lodash__WEBPACK_IMPORTED_MODULE_0__["difference"])(Object(lodash__WEBPACK_IMPORTED_MODULE_0__["values"])(Color),usedColors);return Object(lodash__WEBPACK_IMPORTED_MODULE_0__["first"])(available)||Color.color0}},93:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return METRIC_EXPLORER_AGGREGATIONS}));__webpack_require__.d(__webpack_exports__,"c",(function(){return metricsExplorerAggregationRT}));__webpack_require__.d(__webpack_exports__,"d",(function(){return metricsExplorerMetricRT}));__webpack_require__.d(__webpack_exports__,"b",(function(){return afterKeyObjectRT}));__webpack_require__.d(__webpack_exports__,"e",(function(){return metricsExplorerResponseRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var io_ts__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(io_ts__WEBPACK_IMPORTED_MODULE_0__);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const METRIC_EXPLORER_AGGREGATIONS=["avg","max","min","cardinality","rate","count","sum","p95","p99"];const metricsExplorerAggregationKeys=METRIC_EXPLORER_AGGREGATIONS.reduce((acc,agg)=>_objectSpread(_objectSpread({},acc),{},{[agg]:null}),{});const metricsExplorerAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"](metricsExplorerAggregationKeys);const metricsExplorerMetricRequiredFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({aggregation:metricsExplorerAggregationRT});const metricsExplorerMetricOptionalFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]])});const metricsExplorerMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([metricsExplorerMetricRequiredFieldsRT,metricsExplorerMetricOptionalFieldsRT]);const timeRangeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],from:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],to:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],interval:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]});const metricsExplorerRequestBodyRequiredFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({timerange:timeRangeRT,indexPattern:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](metricsExplorerMetricRT)});const groupByRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]]);const afterKeyObjectRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"]]));const metricsExplorerRequestBodyOptionalFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({groupBy:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([groupByRT,io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](groupByRT)]),afterKey:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"],afterKeyObjectRT]),limit:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]]),filterQuery:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]]),forceInterval:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"],dropLastBucket:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"]});const metricsExplorerRequestBodyRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([metricsExplorerRequestBodyRequiredFieldsRT,metricsExplorerRequestBodyOptionalFieldsRT]);const metricsExplorerPageInfoRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({total:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],afterKey:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],afterKeyObjectRT])});const metricsExplorerColumnTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({date:null,number:null,string:null});const metricsExplorerColumnRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({name:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:metricsExplorerColumnTypeRT});const metricsExplorerRowRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({timestamp:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"]}),io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"],io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["object"])]))]);const metricsExplorerSeriesRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],columns:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](metricsExplorerColumnRT),rows:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](metricsExplorerRowRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({keys:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"])})]);const metricsExplorerResponseRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({series:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](metricsExplorerSeriesRT),pageInfo:metricsExplorerPageInfoRT})},96:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return useUrlState}));__webpack_require__.d(__webpack_exports__,"a",(function(){return replaceStateKeyInQueryString}));var query_string__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(26);var query_string__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(query_string__WEBPACK_IMPORTED_MODULE_0__);var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2);var react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);var rison_node__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(17);var rison_node__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(rison_node__WEBPACK_IMPORTED_MODULE_2__);var react_router_dom__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(60);var react_router_dom__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(react_router_dom__WEBPACK_IMPORTED_MODULE_3__);var _src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(28);var _src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_4__);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useUrlState=({defaultState:defaultState,decodeUrlState:decodeUrlState,encodeUrlState:encodeUrlState,urlStateKey:urlStateKey,writeDefaultState:writeDefaultState=false})=>{const history=Object(react_router_dom__WEBPACK_IMPORTED_MODULE_3__["useHistory"])();const queryString=(history===null||history===void 0?void 0:history.location)?getQueryStringFromLocation(history.location):"";const urlStateString=Object(react__WEBPACK_IMPORTED_MODULE_1__["useMemo"])(()=>{if(!queryString){return}return getParamFromQueryString(queryString,urlStateKey)},[queryString,urlStateKey]);const decodedState=Object(react__WEBPACK_IMPORTED_MODULE_1__["useMemo"])(()=>decodeUrlState(decodeRisonUrlState(urlStateString)),[decodeUrlState,urlStateString]);const state=Object(react__WEBPACK_IMPORTED_MODULE_1__["useMemo"])(()=>typeof decodedState!=="undefined"?decodedState:defaultState,[defaultState,decodedState]);const setState=Object(react__WEBPACK_IMPORTED_MODULE_1__["useCallback"])(newState=>{if(!history||!history.location){return}const currentLocation=history.location;const newLocation=replaceQueryStringInLocation(currentLocation,replaceStateKeyInQueryString(urlStateKey,typeof newState!=="undefined"?encodeUrlState(newState):undefined)(getQueryStringFromLocation(currentLocation)));if(newLocation!==currentLocation){history.replace(newLocation)}},[encodeUrlState,history,urlStateKey]);const _useState=Object(react__WEBPACK_IMPORTED_MODULE_1__["useState"])(writeDefaultState&&typeof decodedState==="undefined"),_useState2=_slicedToArray(_useState,2),shouldInitialize=_useState2[0],setShouldInitialize=_useState2[1];Object(react__WEBPACK_IMPORTED_MODULE_1__["useEffect"])(()=>{if(shouldInitialize){setShouldInitialize(false);setState(defaultState)}},[shouldInitialize,setState,defaultState]);return[state,setState]};const decodeRisonUrlState=value=>{try{return value?Object(rison_node__WEBPACK_IMPORTED_MODULE_2__["decode"])(value):undefined}catch(error){if(error instanceof Error&&error.message.startsWith("rison decoder error")){return{}}throw error}};const encodeRisonUrlState=state=>Object(rison_node__WEBPACK_IMPORTED_MODULE_2__["encode"])(state);const getQueryStringFromLocation=location=>location.search.substring(1);const getParamFromQueryString=(queryString,key)=>{const parsedQueryString=Object(query_string__WEBPACK_IMPORTED_MODULE_0__["parse"])(queryString,{sort:false});const queryParam=parsedQueryString[key];return Array.isArray(queryParam)?queryParam[0]:queryParam};const replaceStateKeyInQueryString=(stateKey,urlState)=>queryString=>{const previousQueryValues=Object(query_string__WEBPACK_IMPORTED_MODULE_0__["parse"])(queryString,{sort:false});const newValue=typeof urlState==="undefined"?previousQueryValues:_objectSpread(_objectSpread({},previousQueryValues),{},{[stateKey]:encodeRisonUrlState(urlState)});return Object(query_string__WEBPACK_IMPORTED_MODULE_0__["stringify"])(_src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_4__["url"].encodeQuery(newValue),{sort:false,encode:false})};const replaceQueryStringInLocation=(location,queryString)=>{if(queryString===getQueryStringFromLocation(location)){return location}else{return _objectSpread(_objectSpread({},location),{},{search:"?".concat(queryString)})}}}}]);