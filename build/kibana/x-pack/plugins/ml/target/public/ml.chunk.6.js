/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["ml_bundle_jsonpfunction"]=window["ml_bundle_jsonpfunction"]||[]).push([[6],{104:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return EVENT_RATE_FIELD_ID}));__webpack_require__.d(__webpack_exports__,"b",(function(){return mlCategory}));var _src_plugins_data_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(41);var _src_plugins_data_common__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_0__);var _constants_field_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(88);const EVENT_RATE_FIELD_ID="__ml_event_rate_count__";const METRIC_AGG_TYPE="metrics";const mlCategory={id:_constants_field_types__WEBPACK_IMPORTED_MODULE_1__["b"],name:_constants_field_types__WEBPACK_IMPORTED_MODULE_1__["b"],type:_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_0__["ES_FIELD_TYPES"].KEYWORD,aggregatable:false}},108:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"i",(function(){return getDataGridSchemasFromFieldTypes}));__webpack_require__.d(__webpack_exports__,"h",(function(){return getDataGridSchemaFromKibanaFieldType}));__webpack_require__.d(__webpack_exports__,"k",(function(){return getFieldsFromKibanaIndexPattern}));__webpack_require__.d(__webpack_exports__,"m",(function(){return multiColumnSortFactory}));__webpack_require__.d(__webpack_exports__,"n",(function(){return showDataGridColumnChartErrorMessageToast}));__webpack_require__.d(__webpack_exports__,"p",(function(){return useRenderCellValue}));__webpack_require__.d(__webpack_exports__,"l",(function(){return getProcessedFields}));__webpack_require__.d(__webpack_exports__,"j",(function(){return getFieldType}));__webpack_require__.d(__webpack_exports__,"a",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"o",(function(){return useDataGrid}));__webpack_require__.d(__webpack_exports__,"b",(function(){return DataGrid}));__webpack_require__.d(__webpack_exports__,"c",(function(){return types["DataGridItem"]}));__webpack_require__.d(__webpack_exports__,"d",(function(){return types["EsSorting"]}));__webpack_require__.d(__webpack_exports__,"e",(function(){return types["RenderCellValue"]}));__webpack_require__.d(__webpack_exports__,"f",(function(){return types["UseDataGridReturnType"]}));__webpack_require__.d(__webpack_exports__,"g",(function(){return types["UseIndexDataReturnType"]}));var external_kbnSharedDeps_MomentTimezone_=__webpack_require__(38);var external_kbnSharedDeps_MomentTimezone_default=__webpack_require__.n(external_kbnSharedDeps_MomentTimezone_);var external_kbnSharedDeps_React_=__webpack_require__(10);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);var public_=__webpack_require__(30);var data_frame_analytics=__webpack_require__(70);var errors=__webpack_require__(64);var fields=__webpack_require__(79);var constants=__webpack_require__(127);var date_utils=__webpack_require__(58);var object_utils=__webpack_require__(255);var field_format_service=__webpack_require__(115);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const INIT_MAX_COLUMNS=10;const euiDataGridStyle={border:"all",fontSize:"s",cellPadding:"s",stripes:false,rowHover:"none",header:"shade"};const euiDataGridToolbarSettings={showColumnSelector:true,showStyleSelector:false,showSortSelector:true,showFullScreenSelector:false};const getFieldsFromKibanaIndexPattern=indexPattern=>{const allFields=indexPattern.fields.map(f=>f.name);const indexPatternFields=allFields.filter(f=>{if(indexPattern.metaFields.includes(f)){return false}const fieldParts=f.split(".");const lastPart=fieldParts.pop();if(lastPart==="keyword"&&allFields.includes(fieldParts.join("."))){return false}return true});return indexPatternFields};const getDataGridSchemasFromFieldTypes=(fieldTypes,resultsField)=>Object.keys(fieldTypes).map(field=>{let schema;const isSortable=true;const type=fieldTypes[field];const isNumber=type!==undefined&&(fields["a"].has(type)||fields["b"].has(type));if(isNumber){schema="numeric"}switch(type){case"date":schema="datetime";break;case"geo_point":schema="json";break;case"boolean":schema="boolean";break;case"text":schema=NON_AGGREGATABLE}if(field==="".concat(resultsField,".").concat(constants["c"])){schema="numeric"}if(field.includes("".concat(resultsField,".").concat(constants["d"]))){schema="json"}if(field.includes("".concat(resultsField,".").concat(constants["a"]))){schema="featureImportance"}return{id:field,schema:schema,isSortable:isSortable}});const NON_AGGREGATABLE="non-aggregatable";const getDataGridSchemaFromKibanaFieldType=field=>{let schema;switch(field===null||field===void 0?void 0:field.type){case public_["KBN_FIELD_TYPES"].BOOLEAN:schema="boolean";break;case public_["KBN_FIELD_TYPES"].DATE:schema="datetime";break;case public_["KBN_FIELD_TYPES"].GEO_POINT:case public_["KBN_FIELD_TYPES"].GEO_SHAPE:schema="json";break;case public_["KBN_FIELD_TYPES"].NUMBER:schema="numeric";break}if(schema===undefined&&(field===null||field===void 0?void 0:field.aggregatable)===false){return NON_AGGREGATABLE}return schema};const getClassName=(className,isClassTypeBoolean)=>{if(isClassTypeBoolean){return className==="true"}return className};const getFeatureImportance=(row,mlResultsField,isClassTypeBoolean=false)=>{const featureNames=row["".concat(mlResultsField,".feature_importance.feature_name")];const classNames=row["".concat(mlResultsField,".feature_importance.classes.class_name")];const classImportance=row["".concat(mlResultsField,".feature_importance.classes.importance")];if(featureNames===undefined){return[]}if(classNames!==undefined&&classImportance!==undefined){const overallClassNames=classNames===null||classNames===void 0?void 0:classNames.slice(0,classNames.length/featureNames.length);return featureNames.map((fName,index)=>{const offset=overallClassNames.length*index;const featureClassImportance=classImportance.slice(offset,offset+overallClassNames.length);return{feature_name:fName,classes:overallClassNames.map((fClassName,fIndex)=>({class_name:getClassName(fClassName,isClassTypeBoolean),importance:featureClassImportance[fIndex]}))}})}const importance=row["".concat(mlResultsField,".feature_importance.importance")];return featureNames.map((fName,index)=>({feature_name:fName,importance:importance[index]}))};const getTopClasses=(row,mlResultsField)=>{const classNames=row["".concat(mlResultsField,".top_classes.class_name")];const classProbabilities=row["".concat(mlResultsField,".top_classes.class_probability")];const classScores=row["".concat(mlResultsField,".top_classes.class_score")];if(classNames===undefined||classProbabilities===undefined||classScores===undefined){return[]}return classNames.map((className,index)=>({class_name:className,class_probability:classProbabilities[index],class_score:classScores[index]}))};const useRenderCellValue=(indexPattern,pagination,tableItems,resultsField,cellPropsCallback)=>{const renderCellValue=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({rowIndex:rowIndex,columnId:columnId,setCellProps:setCellProps})=>{const adjustedRowIndex=rowIndex-pagination.pageIndex*pagination.pageSize;const fullItem=tableItems[adjustedRowIndex];if(fullItem===undefined){return null}if(indexPattern===undefined){return null}let format;if(indexPattern!==undefined){format=field_format_service["a"].getFieldFormatFromIndexPattern(indexPattern,columnId,"")}function getCellValue(cId){if(tableItems.hasOwnProperty(adjustedRowIndex)){const item=tableItems[adjustedRowIndex];if(item.hasOwnProperty(cId)){return item[cId]}if(cId==="".concat(resultsField,".feature_importance")){return getFeatureImportance(fullItem,resultsField!==null&&resultsField!==void 0?resultsField:data_frame_analytics["b"])}if(cId==="".concat(resultsField,".top_classes")){return getTopClasses(fullItem,resultsField!==null&&resultsField!==void 0?resultsField:data_frame_analytics["b"])}return Object(object_utils["a"])(tableItems[adjustedRowIndex],cId,null)}return null}const cellValue=getCellValue(columnId);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(typeof cellPropsCallback==="function"){cellPropsCallback(columnId,cellValue,fullItem,setCellProps)}},[columnId,cellValue]);if(typeof cellValue==="object"&&cellValue!==null){return JSON.stringify(cellValue)}if(cellValue===undefined||cellValue===null){return null}if(format!==undefined){return format.convert(cellValue,"text")}if(typeof cellValue==="string"||cellValue===null){return cellValue}const field=indexPattern.fields.getByName(columnId);if((field===null||field===void 0?void 0:field.type)===public_["KBN_FIELD_TYPES"].DATE){return Object(date_utils["c"])(external_kbnSharedDeps_MomentTimezone_default()(cellValue).unix()*1e3)}if(typeof cellValue==="boolean"){return cellValue?"true":"false"}return cellValue},[indexPattern===null||indexPattern===void 0?void 0:indexPattern.fields,pagination.pageIndex,pagination.pageSize,tableItems]);return renderCellValue};const multiColumnSortFactory=sortingColumns=>{const isString=arg=>typeof arg==="string";const sortFn=(a,b,sortingColumnIndex=0)=>{const sort=sortingColumns[sortingColumnIndex];const aValue=Object(object_utils["a"])(a,sort.id,null);const bValue=Object(object_utils["a"])(b,sort.id,null);if(typeof aValue==="number"&&typeof bValue==="number"){if(aValue<bValue){return sort.direction==="asc"?-1:1}if(aValue>bValue){return sort.direction==="asc"?1:-1}}if(isString(aValue)&&isString(bValue)){if(aValue.localeCompare(bValue)===-1){return sort.direction==="asc"?-1:1}if(aValue.localeCompare(bValue)===1){return sort.direction==="asc"?1:-1}}if(sortingColumnIndex+1<sortingColumns.length){return sortFn(a,b,sortingColumnIndex+1)}return 0};return sortFn};const showDataGridColumnChartErrorMessageToast=(e,toastNotifications)=>{const error=Object(errors["i"])(e);toastNotifications.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGrid.columnChart.ErrorMessageToast",{defaultMessage:"An error occurred fetching the histogram charts data: {error}",values:{error:error!==""?error:e}}))};const getProcessedFields=(originalObj,omitBy)=>{const obj=_objectSpread({},originalObj);for(var _i=0,_Object$keys=Object.keys(obj);_i<_Object$keys.length;_i++){const key=_Object$keys[_i];if(omitBy===undefined){if(Array.isArray(obj[key])&&obj[key].length===1){obj[key]=obj[key][0]}}else{if(omitBy(key)===false)if(Array.isArray(obj[key])&&obj[key].length===1){obj[key]=obj[key][0]}}}return obj};var external_kbnSharedDeps_Moment_=__webpack_require__(28);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var external_kbnSharedDeps_Rxjs_=__webpack_require__(17);var useObservable=__webpack_require__(117);var useObservable_default=__webpack_require__.n(useObservable);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(26);function use_column_chart_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_column_chart_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_column_chart_ownKeys(Object(source),true).forEach((function(key){use_column_chart_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_column_chart_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_column_chart_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const hoveredRow$=new external_kbnSharedDeps_Rxjs_["BehaviorSubject"](null);const BAR_COLOR=Object(external_kbnSharedDeps_ElasticEui_["euiPaletteColorBlind"])()[0];const BAR_COLOR_BLUR=Object(external_kbnSharedDeps_ElasticEui_["euiPaletteColorBlind"])({rotations:2})[10];const MAX_CHART_COLUMNS=20;const getXScaleType=kbnFieldType=>{switch(kbnFieldType){case public_["KBN_FIELD_TYPES"].BOOLEAN:case public_["KBN_FIELD_TYPES"].IP:case public_["KBN_FIELD_TYPES"].STRING:return"ordinal";case public_["KBN_FIELD_TYPES"].DATE:return"time";case public_["KBN_FIELD_TYPES"].NUMBER:return"linear"}};const getFieldType=schema=>{if(schema===NON_AGGREGATABLE){return undefined}let fieldType;switch(schema){case"datetime":fieldType=public_["KBN_FIELD_TYPES"].DATE;break;case"numeric":fieldType=public_["KBN_FIELD_TYPES"].NUMBER;break;case"boolean":fieldType=public_["KBN_FIELD_TYPES"].BOOLEAN;break;case"json":fieldType=public_["KBN_FIELD_TYPES"].OBJECT;break;default:fieldType=public_["KBN_FIELD_TYPES"].STRING}return fieldType};const isNumericChartData=arg=>arg.hasOwnProperty("data")&&arg.hasOwnProperty("id")&&arg.hasOwnProperty("interval")&&arg.hasOwnProperty("stats")&&arg.hasOwnProperty("type");const isOrdinalChartData=arg=>arg.hasOwnProperty("data")&&arg.hasOwnProperty("cardinality")&&arg.hasOwnProperty("id")&&arg.hasOwnProperty("type");const isUnsupportedChartData=arg=>arg.hasOwnProperty("type")&&arg.type==="unsupported";const getLegendText=chartData=>{if(chartData.type==="unsupported"){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGridChart.histogramNotAvailable",{defaultMessage:"Chart not supported."})}if(chartData.data.length===0){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGridChart.notEnoughData",{defaultMessage:"0 documents contain field."})}if(chartData.type==="boolean"){return external_kbnSharedDeps_React_default.a.createElement("table",{className:"mlDataGridChart__legendBoolean"},external_kbnSharedDeps_React_default.a.createElement("tbody",null,external_kbnSharedDeps_React_default.a.createElement("tr",null,chartData.data[0]!==undefined&&external_kbnSharedDeps_React_default.a.createElement("td",null,chartData.data[0].key_as_string),chartData.data[1]!==undefined&&external_kbnSharedDeps_React_default.a.createElement("td",null,chartData.data[1].key_as_string))))}if(isOrdinalChartData(chartData)&&chartData.cardinality<=MAX_CHART_COLUMNS){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGridChart.singleCategoryLegend",{defaultMessage:"{cardinality, plural, one {# category} other {# categories}}",values:{cardinality:chartData.cardinality}})}if(isOrdinalChartData(chartData)&&chartData.cardinality>MAX_CHART_COLUMNS){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGridChart.topCategoriesLegend",{defaultMessage:"top {MAX_CHART_COLUMNS} of {cardinality} categories",values:{cardinality:chartData.cardinality,MAX_CHART_COLUMNS:MAX_CHART_COLUMNS}})}if(isNumericChartData(chartData)){const fromValue=Math.round(chartData.stats[0]*100)/100;const toValue=Math.round(chartData.stats[1]*100)/100;return fromValue!==toValue?"".concat(fromValue," - ").concat(toValue):""+fromValue}return""};const useColumnChart=(chartData,columnType)=>{const fieldType=getFieldType(columnType.schema);const hoveredRow=useObservable_default()(hoveredRow$);const xScaleType=getXScaleType(fieldType);const getColor=d=>{if(hoveredRow===undefined||hoveredRow===null){return BAR_COLOR}if(isOrdinalChartData(chartData)&&xScaleType==="ordinal"&&hoveredRow._source[columnType.id]===d.key){return BAR_COLOR}if(isNumericChartData(chartData)&&xScaleType==="linear"&&hoveredRow._source[columnType.id]>=+d.key&&hoveredRow._source[columnType.id]<+d.key+chartData.interval){return BAR_COLOR}if(isNumericChartData(chartData)&&xScaleType==="time"&&external_kbnSharedDeps_Moment_default()(hoveredRow._source[columnType.id]).unix()*1e3>=+d.key&&external_kbnSharedDeps_Moment_default()(hoveredRow._source[columnType.id]).unix()*1e3<+d.key+chartData.interval){return BAR_COLOR}return BAR_COLOR_BLUR};let data=[];if(isOrdinalChartData(chartData)){data=chartData.data.map(d=>{var _d$key_as_string;return use_column_chart_objectSpread(use_column_chart_objectSpread({},d),{},{key_as_string:(_d$key_as_string=d.key_as_string)!==null&&_d$key_as_string!==void 0?_d$key_as_string:d.key,color:getColor(d)})})}else if(isNumericChartData(chartData)){data=chartData.data.map(d=>use_column_chart_objectSpread(use_column_chart_objectSpread({},d),{},{key_as_string:d.key_as_string||d.key,color:getColor(d)}))}return{data:data,legendText:getLegendText(chartData),xScaleType:xScaleType}};var common=__webpack_require__(61);var classnames=__webpack_require__(259);var classnames_default=__webpack_require__.n(classnames);var external_kbnSharedDeps_ElasticCharts_=__webpack_require__(31);var column_chart=__webpack_require__(373);const ColumnChart=({chartData:chartData,columnType:columnType,dataTestSubj:dataTestSubj})=>{const _useColumnChart=useColumnChart(chartData,columnType),data=_useColumnChart.data,legendText=_useColumnChart.legendText,xScaleType=_useColumnChart.xScaleType;return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":dataTestSubj},!isUnsupportedChartData(chartData)&&data.length>0&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataGridChart__histogram","data-test-subj":"".concat(dataTestSubj,"-histogram")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],{theme:{background:{color:"transparent"},chartMargins:{left:0,right:0,top:0,bottom:1},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.1}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["BarSeries"],{id:"histogram",name:"count",xScaleType:xScaleType,yScaleType:"linear",xAccessor:"key_as_string",yAccessors:["doc_count"],styleAccessor:d=>d.datum.color,data:data}))),external_kbnSharedDeps_React_default.a.createElement("div",{className:classnames_default()("mlDataGridChart__legend",{"mlDataGridChart__legend--numeric":columnType.schema==="number"}),"data-test-subj":"".concat(dataTestSubj,"-legend")},legendText),external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"".concat(dataTestSubj,"-id")},columnType.id))};function use_data_grid_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_data_grid_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_data_grid_ownKeys(Object(source),true).forEach((function(key){use_data_grid_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_data_grid_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_data_grid_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useDataGrid=(columns,defaultPageSize=5,defaultVisibleColumnsCount=INIT_MAX_COLUMNS,defaultVisibleColumnsFilter)=>{const defaultPagination={pageIndex:0,pageSize:defaultPageSize};const _useState=Object(external_kbnSharedDeps_React_["useState"])(""),_useState2=_slicedToArray(_useState,2),noDataMessage=_useState2[0],setNoDataMessage=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(""),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(common["i"].UNUSED),_useState6=_slicedToArray(_useState5,2),status=_useState6[0],setStatus=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(0),_useState8=_slicedToArray(_useState7,2),rowCount=_useState8[0],setRowCount=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])([]),_useState10=_slicedToArray(_useState9,2),columnCharts=_useState10[0],setColumnCharts=_useState10[1];const _useState11=Object(external_kbnSharedDeps_React_["useState"])([]),_useState12=_slicedToArray(_useState11,2),tableItems=_useState12[0],setTableItems=_useState12[1];const _useState13=Object(external_kbnSharedDeps_React_["useState"])(defaultPagination),_useState14=_slicedToArray(_useState13,2),pagination=_useState14[0],setPagination=_useState14[1];const _useState15=Object(external_kbnSharedDeps_React_["useState"])([]),_useState16=_slicedToArray(_useState15,2),sortingColumns=_useState16[0],setSortingColumns=_useState16[1];const _useState17=Object(external_kbnSharedDeps_React_["useState"])(false),_useState18=_slicedToArray(_useState17,2),chartsVisible=_useState18[0],setChartsVisible=_useState18[1];const toggleChartVisibility=()=>{setChartsVisible(!chartsVisible)};const onChangeItemsPerPage=Object(external_kbnSharedDeps_React_["useCallback"])(pageSize=>{setPagination(p=>{const pageIndex=Math.floor(p.pageSize*p.pageIndex/pageSize);return{pageIndex:pageIndex,pageSize:pageSize}})},[]);const onChangePage=Object(external_kbnSharedDeps_React_["useCallback"])(pageIndex=>setPagination(p=>use_data_grid_objectSpread(use_data_grid_objectSpread({},p),{},{pageIndex:pageIndex})),[]);const resetPagination=()=>setPagination(defaultPagination);const _useState19=Object(external_kbnSharedDeps_React_["useState"])([]),_useState20=_slicedToArray(_useState19,2),visibleColumns=_useState20[0],setVisibleColumns=_useState20[1];const columnIds=columns.map(c=>c.id);const filteredColumnIds=defaultVisibleColumnsFilter!==undefined?columnIds.filter(defaultVisibleColumnsFilter):columnIds;const defaultVisibleColumns=filteredColumnIds.splice(0,defaultVisibleColumnsCount);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setVisibleColumns(defaultVisibleColumns)},[defaultVisibleColumns.join()]);const _useState21=Object(external_kbnSharedDeps_React_["useState"])([]),_useState22=_slicedToArray(_useState21,2),invalidSortingColumnns=_useState22[0],setInvalidSortingColumnns=_useState22[1];const onSort=Object(external_kbnSharedDeps_React_["useCallback"])(sc=>{const updatedInvalidSortingColumnns=sc.reduce((arr,current)=>{const columnType=columns.find(dgc=>dgc.id===current.id);if((columnType===null||columnType===void 0?void 0:columnType.schema)==="json"){arr.push(current.id)}return arr},[]);setInvalidSortingColumnns(updatedInvalidSortingColumnns);if(updatedInvalidSortingColumnns.length===0){setSortingColumns(sc)}},[columns]);const columnsWithCharts=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const updatedColumns=columns.map((c,index)=>{const chartData=columnCharts.find(cd=>cd.id===c.id);return use_data_grid_objectSpread(use_data_grid_objectSpread({},c),{},{display:chartData!==undefined&&chartsVisible===true?external_kbnSharedDeps_React_default.a.createElement(ColumnChart,{chartData:chartData,columnType:c,dataTestSubj:"mlDataGridChart-".concat(index)}):undefined})});return updatedColumns.sort((a,b)=>{if(visibleColumns.indexOf(a.id)===-1&&visibleColumns.indexOf(b.id)>-1){return 1}if(visibleColumns.indexOf(b.id)===-1&&visibleColumns.indexOf(a.id)>-1){return-1}if(visibleColumns.indexOf(a.id)===-1&&visibleColumns.indexOf(b.id)===-1){return a.id.localeCompare(b.id)}return visibleColumns.indexOf(a.id)-visibleColumns.indexOf(b.id)})},[columns,columnCharts,chartsVisible,JSON.stringify(visibleColumns)]);return{chartsVisible:chartsVisible,chartsButtonVisible:true,columnsWithCharts:columnsWithCharts,errorMessage:errorMessage,invalidSortingColumnns:invalidSortingColumnns,noDataMessage:noDataMessage,onChangeItemsPerPage:onChangeItemsPerPage,onChangePage:onChangePage,onSort:onSort,pagination:pagination,resetPagination:resetPagination,rowCount:rowCount,setColumnCharts:setColumnCharts,setErrorMessage:setErrorMessage,setNoDataMessage:setNoDataMessage,setPagination:setPagination,setRowCount:setRowCount,setSortingColumns:setSortingColumns,setStatus:setStatus,setTableItems:setTableItems,setVisibleColumns:setVisibleColumns,sortingColumns:sortingColumns,status:status,tableItems:tableItems,toggleChartVisibility:toggleChartVisibility,visibleColumns:visibleColumns}};var external_kbnSharedDeps_Lodash_=__webpack_require__(7);var field_histograms=__webpack_require__(260);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(27);var d3=__webpack_require__(89);var d3_default=__webpack_require__.n(d3);var feature_importance=__webpack_require__(165);function use_classification_path_data_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_classification_path_data_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_classification_path_data_ownKeys(Object(source),true).forEach((function(key){use_classification_path_data_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_classification_path_data_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_classification_path_data_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const FEATURE_NAME="feature_name";const FEATURE_IMPORTANCE="importance";const RESIDUAL_IMPORTANCE_ERROR_MARGIN=1e-5;const decisionPathFeatureOtherTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataframe.analytics.decisionPathFeatureOtherTitle",{defaultMessage:"other"});const isDecisionPathData=decisionPathData=>Array.isArray(decisionPathData)&&decisionPathData.length>0&&decisionPathData[0].length===3;const getStringBasedClassName=v=>{if(v===undefined||v===null){return""}if(typeof v==="boolean"){return v?"True":"False"}if(typeof v==="number"){return v.toString()}return v};const formatValue=(number,precision=3,fractionDigits=1)=>{if(Math.abs(number)<10){return Number(number.toPrecision(precision)).toString()}return number.toFixed(fractionDigits)};const useDecisionPathData=({baseline:baseline,featureImportance:featureImportance,predictedValue:predictedValue,predictedProbability:predictedProbability})=>{const decisionPathData=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(baseline===undefined)return;if(Object(feature_importance["c"])(baseline)){return buildRegressionDecisionPathData({baseline:baseline.baseline,featureImportance:featureImportance,predictedValue:predictedValue})}if(Object(feature_importance["a"])(baseline)){return buildClassificationDecisionPathData({baselines:baseline.classes,featureImportance:featureImportance,currentClass:predictedValue,predictedProbability:predictedProbability})}},[baseline,featureImportance,predictedValue]);return{decisionPathData:decisionPathData}};const buildRegressionDecisionPathData=({baseline:baseline,featureImportance:featureImportance,predictedValue:predictedValue})=>{const mappedFeatureImportance=featureImportance.map(d=>use_classification_path_data_objectSpread(use_classification_path_data_objectSpread({},d),{},{absImportance:Math.abs(d[FEATURE_IMPORTANCE])}));if(baseline&&predictedValue!==undefined&&Number.isFinite(predictedValue)){const adjustedImportance=predictedValue-mappedFeatureImportance.reduce((accumulator,currentValue)=>accumulator+currentValue.importance,0)-baseline;mappedFeatureImportance.push({[FEATURE_NAME]:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataframe.analytics.decisionPathFeatureBaselineTitle",{defaultMessage:"baseline"}),[FEATURE_IMPORTANCE]:baseline,absImportance:-1});if(Math.abs(adjustedImportance)>RESIDUAL_IMPORTANCE_ERROR_MARGIN){mappedFeatureImportance.push({[FEATURE_NAME]:decisionPathFeatureOtherTitle,[FEATURE_IMPORTANCE]:adjustedImportance,absImportance:0})}}const filteredFeatureImportance=mappedFeatureImportance.filter(f=>f!==undefined);const finalResult=filteredFeatureImportance.sort((a,b)=>b.absImportance-a.absImportance).map(d=>[d[FEATURE_NAME],d[FEATURE_IMPORTANCE],NaN]);let cumulativeSum=0;for(let i=filteredFeatureImportance.length-1;i>=0;i--){cumulativeSum+=finalResult[i][1];finalResult[i][2]=cumulativeSum}return finalResult};const addAdjustedProbability=({predictedProbability:predictedProbability,decisionPlotData:decisionPlotData})=>{if(predictedProbability&&decisionPlotData.length>0){const adjustedResidualImportance=predictedProbability-decisionPlotData[0][2];if(Math.abs(adjustedResidualImportance)>RESIDUAL_IMPORTANCE_ERROR_MARGIN){decisionPlotData.forEach(row=>row[2]=row[2]+adjustedResidualImportance);decisionPlotData.push([decisionPathFeatureOtherTitle,adjustedResidualImportance,decisionPlotData[decisionPlotData.length-1][2]-adjustedResidualImportance])}}return decisionPlotData};const processBinaryClassificationDecisionPathData=({decisionPlotData:decisionPlotData,startingBaseline:startingBaseline,predictedProbability:predictedProbability})=>{const finalResult=decisionPlotData;let logOddSoFar=startingBaseline;for(let i=finalResult.length-1;i>=0;i--){logOddSoFar+=finalResult[i][1];const predictionProbabilitySoFar=Math.exp(logOddSoFar)/(Math.exp(logOddSoFar)+1);finalResult[i][2]=predictionProbabilitySoFar}return addAdjustedProbability({predictedProbability:predictedProbability,decisionPlotData:finalResult})};const processMultiClassClassificationDecisionPathData=({baselines:baselines,decisionPlotData:decisionPlotData,startingBaseline:startingBaseline,featureImportance:featureImportance,predictedProbability:predictedProbability})=>{const denominator=computeMultiClassImportanceDenominator({baselines:baselines,featureImportance:featureImportance});const baseline=startingBaseline;let featureImportanceRunningSum=0;for(let i=decisionPlotData.length-1;i>=0;i--){featureImportanceRunningSum+=decisionPlotData[i][1];const numerator=Math.exp(baseline+featureImportanceRunningSum);decisionPlotData[i][2]=numerator/denominator}return addAdjustedProbability({predictedProbability:predictedProbability,decisionPlotData:decisionPlotData})};const computeMultiClassImportanceDenominator=({baselines:baselines,featureImportance:featureImportance})=>{let denominator=0;for(let x=0;x<baselines.length;x++){let featureImportanceOfClassX=0;for(let i=0;i<featureImportance.length;i++){const feature=featureImportance[i];const classFeatureImportance=Array.isArray(feature.classes)?feature.classes.find(c=>getStringBasedClassName(c.class_name)===getStringBasedClassName(baselines[x].class_name)):feature;if(classFeatureImportance&&classFeatureImportance.importance!==undefined&&typeof classFeatureImportance[FEATURE_IMPORTANCE]==="number"){featureImportanceOfClassX+=classFeatureImportance.importance}}denominator+=Math.exp(baselines[x].baseline+featureImportanceOfClassX)}return denominator};const buildClassificationDecisionPathData=({baselines:baselines,featureImportance:featureImportance,currentClass:currentClass,predictedProbability:predictedProbability})=>{if(currentClass===undefined||!(Array.isArray(baselines)&&baselines.length>=2))return[];const mappedFeatureImportance=featureImportance.map(feature=>{const classFeatureImportance=Array.isArray(feature.classes)?feature.classes.find(c=>getStringBasedClassName(c.class_name)===getStringBasedClassName(currentClass)):feature;if(classFeatureImportance&&typeof classFeatureImportance[FEATURE_IMPORTANCE]==="number"){return{[FEATURE_NAME]:feature[FEATURE_NAME],[FEATURE_IMPORTANCE]:classFeatureImportance[FEATURE_IMPORTANCE],absImportance:Math.abs(classFeatureImportance[FEATURE_IMPORTANCE])}}return undefined});const baselineClass=baselines.find(bl=>getStringBasedClassName(bl.class_name)===getStringBasedClassName(currentClass));const startingBaseline=(baselineClass===null||baselineClass===void 0?void 0:baselineClass.baseline)?baselineClass===null||baselineClass===void 0?void 0:baselineClass.baseline:0;const filteredFeatureImportance=mappedFeatureImportance.filter(f=>f!==undefined);const decisionPlotData=filteredFeatureImportance.sort((a,b)=>b.absImportance-a.absImportance).map(d=>[d[FEATURE_NAME],d[FEATURE_IMPORTANCE],NaN]);if(baselines.length===2){return processBinaryClassificationDecisionPathData({startingBaseline:startingBaseline,decisionPlotData:decisionPlotData,predictedProbability:predictedProbability})}return processMultiClassClassificationDecisionPathData({baselines:baselines,decisionPlotData:decisionPlotData,startingBaseline:startingBaseline,featureImportance:featureImportance,predictedProbability:predictedProbability})};var external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(33);var external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_);var format_value=__webpack_require__(109);const euiColorFullShade=external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorFullShade,euiColorMediumShade=external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorMediumShade;const axisColor=euiColorMediumShade;const baselineStyle={line:{strokeWidth:1,stroke:euiColorFullShade,opacity:.75},details:{fontFamily:"Arial",fontSize:10,fontStyle:"bold",fill:euiColorMediumShade,padding:0}};const axes={axisLine:{stroke:axisColor},tickLabel:{fontSize:10,fill:axisColor},tickLine:{stroke:axisColor},gridLine:{horizontal:{dash:[1,2]},vertical:{strokeWidth:0}}};const theme={axes:axes};const DECISION_PATH_MARGIN=125;const DECISION_PATH_ROW_HEIGHT=10;const AnnotationBaselineMarker=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"dot",size:"m"});const DecisionPathChart=({decisionPathData:decisionPathData,predictionFieldName:predictionFieldName,minDomain:minDomain,maxDomain:maxDomain,baseline:baseline})=>{const baselineData=Object(external_kbnSharedDeps_React_["useMemo"])(()=>baseline&&Object(feature_importance["c"])(baseline)?[{dataValue:baseline.baseline,header:Object(format_value["a"])(baseline.baseline,"").toString(),details:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathBaselineText",{defaultMessage:"baseline (average of predictions for all data points in the training data set)"})}]:undefined,[baseline]);const tickFormatter=Object(external_kbnSharedDeps_React_["useCallback"])(d=>Object(format_value["a"])(d,"").toString(),[]);return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlDFADecisionPathChart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],{size:{height:DECISION_PATH_MARGIN+decisionPathData.length*DECISION_PATH_ROW_HEIGHT}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],{theme:theme,rotation:90}),baselineData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["LineAnnotation"],{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathBaseline",domainType:external_kbnSharedDeps_ElasticCharts_["AnnotationDomainTypes"].YDomain,dataValues:baselineData,style:baselineStyle,marker:AnnotationBaselineMarker}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathXAxis",tickFormat:tickFormatter,title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathXAxisTitle",{defaultMessage:"Prediction for '{predictionFieldName}'",values:{predictionFieldName:predictionFieldName}}),showGridLines:false,position:external_kbnSharedDeps_ElasticCharts_["Position"].Top,showOverlappingTicks:true,domain:minDomain&&maxDomain?{min:minDomain,max:maxDomain}:undefined}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{showGridLines:true,id:"left",position:external_kbnSharedDeps_ElasticCharts_["Position"].Left}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["LineSeries"],{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathLine",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathLineTitle",{defaultMessage:"Prediction"}),xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Ordinal,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,xAccessor:0,yAccessors:[2],data:decisionPathData})))};const MissingDecisionPathCallout=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.dataframe.analytics.explorationResults.regressionDecisionPathDataMissingCallout",defaultMessage:"No decision path data available."}));function decision_path_regression_slicedToArray(arr,i){return decision_path_regression_arrayWithHoles(arr)||decision_path_regression_iterableToArrayLimit(arr,i)||decision_path_regression_unsupportedIterableToArray(arr,i)||decision_path_regression_nonIterableRest()}function decision_path_regression_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function decision_path_regression_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return decision_path_regression_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return decision_path_regression_arrayLikeToArray(o,minLen)}function decision_path_regression_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function decision_path_regression_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function decision_path_regression_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const RegressionDecisionPath=({baseline:baseline,featureImportance:featureImportance,predictedValue:predictedValue,predictionFieldName:predictionFieldName})=>{const _useDecisionPathData=useDecisionPathData({baseline:baseline,featureImportance:featureImportance,predictedValue:predictedValue}),decisionPathData=_useDecisionPathData.decisionPathData;const domain=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{let maxDomain;let minDomain;if(decisionPathData&&isDecisionPathData(decisionPathData)){const _d3$extent=d3_default.a.extent(decisionPathData,d=>d[2]),_d3$extent2=decision_path_regression_slicedToArray(_d3$extent,2),min=_d3$extent2[0],max=_d3$extent2[1];maxDomain=max;minDomain=min;const buffer=Math.abs(maxDomain-minDomain)*.1;maxDomain=(typeof baseline==="number"?Math.max(maxDomain,baseline):maxDomain)+buffer;minDomain=(typeof baseline==="number"?Math.min(minDomain,baseline):minDomain)-buffer}return{maxDomain:maxDomain,minDomain:minDomain}},[decisionPathData,baseline]);if(!decisionPathData)return external_kbnSharedDeps_React_default.a.createElement(MissingDecisionPathCallout,null);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,baseline===undefined&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{size:"s",heading:"p",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.dataframe.analytics.explorationResults.missingBaselineCallout",defaultMessage:"Unable to calculate baseline value, which might result in a shifted decision path."}),color:"warning",iconType:"alert"}),external_kbnSharedDeps_React_default.a.createElement(DecisionPathChart,{decisionPathData:decisionPathData,predictionFieldName:predictionFieldName,minDomain:domain.minDomain,maxDomain:domain.maxDomain,baseline:baseline}))};const DecisionPathJSONViewer=({featureImportance:featureImportance})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{isCopyable:true},JSON.stringify(featureImportance));function decision_path_classification_slicedToArray(arr,i){return decision_path_classification_arrayWithHoles(arr)||decision_path_classification_iterableToArrayLimit(arr,i)||decision_path_classification_unsupportedIterableToArray(arr,i)||decision_path_classification_nonIterableRest()}function decision_path_classification_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function decision_path_classification_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return decision_path_classification_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return decision_path_classification_arrayLikeToArray(o,minLen)}function decision_path_classification_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function decision_path_classification_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function decision_path_classification_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const ClassificationDecisionPath=({featureImportance:featureImportance,predictedValue:predictedValue,topClasses:topClasses,predictionFieldName:predictionFieldName,predictedProbability:predictedProbability,baseline:baseline})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(getStringBasedClassName(topClasses[0].class_name)),_useState2=decision_path_classification_slicedToArray(_useState,2),currentClass=_useState2[0],setCurrentClass=_useState2[1];const _useDecisionPathData=useDecisionPathData({baseline:baseline,featureImportance:featureImportance,predictedValue:currentClass,predictedProbability:predictedProbability}),decisionPathData=_useDecisionPathData.decisionPathData;const options=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const predictionValueStr=getStringBasedClassName(predictedValue);return Array.isArray(topClasses)?topClasses.map(c=>{const className=getStringBasedClassName(c.class_name);return{value:className,inputDisplay:className===predictionValueStr?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"success",style:{lineHeight:"inherit"}},className):className}}):undefined},[topClasses,predictedValue]);const domain=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{let maxDomain;let minDomain;if(decisionPathData&&isDecisionPathData(decisionPathData)){const _d3$extent=d3_default.a.extent(decisionPathData,d=>d[2]),_d3$extent2=decision_path_classification_slicedToArray(_d3$extent,2),min=_d3$extent2[0],max=_d3$extent2[1];const buffer=Math.abs(max-min)*.1;maxDomain=max+buffer;minDomain=min-buffer}return{maxDomain:maxDomain,minDomain:minDomain}},[decisionPathData]);if(!decisionPathData)return external_kbnSharedDeps_React_default.a.createElement(MissingDecisionPathCallout,null);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataframe.analytics.explorationResults.classificationDecisionPathClassNameTitle",{defaultMessage:"Class name"}))),options!==undefined&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{"data-test-subj":"mlDFADecisionPathClassNameSelect",compressed:true,options:options,valueOfSelected:currentClass,onChange:setCurrentClass}),external_kbnSharedDeps_React_default.a.createElement(DecisionPathChart,{decisionPathData:decisionPathData,predictionFieldName:predictionFieldName,minDomain:domain.minDomain,maxDomain:domain.maxDomain}))};var kibana=__webpack_require__(51);function decision_path_popover_slicedToArray(arr,i){return decision_path_popover_arrayWithHoles(arr)||decision_path_popover_iterableToArrayLimit(arr,i)||decision_path_popover_unsupportedIterableToArray(arr,i)||decision_path_popover_nonIterableRest()}function decision_path_popover_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function decision_path_popover_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return decision_path_popover_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return decision_path_popover_arrayLikeToArray(o,minLen)}function decision_path_popover_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function decision_path_popover_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function decision_path_popover_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var DECISION_PATH_TABS;(function(DECISION_PATH_TABS){DECISION_PATH_TABS["CHART"]="decision_path_chart";DECISION_PATH_TABS["JSON"]="decision_path_json"})(DECISION_PATH_TABS||(DECISION_PATH_TABS={}));const DecisionPathPopover=({baseline:baseline,featureImportance:featureImportance,predictedValue:predictedValue,topClasses:topClasses,analysisType:analysisType,predictionFieldName:predictionFieldName,predictedProbability:predictedProbability})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(DECISION_PATH_TABS.CHART),_useState2=decision_path_popover_slicedToArray(_useState,2),selectedTabId=_useState2[0],setSelectedTabId=_useState2[1];const _useMlKibana=Object(kibana["a"])(),docLinks=_useMlKibana.services.docLinks;const ELASTIC_WEBSITE_URL=docLinks.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=docLinks.DOC_LINK_VERSION;if(featureImportance.length<2){return external_kbnSharedDeps_React_default.a.createElement(DecisionPathJSONViewer,{featureImportance:featureImportance})}const tabs=[{id:DECISION_PATH_TABS.CHART,name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathPlotTab",defaultMessage:"Decision plot"})},{id:DECISION_PATH_TABS.JSON,name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathJSONTab",defaultMessage:"JSON"})}];return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlDFADecisionPathPopover"},external_kbnSharedDeps_React_default.a.createElement("div",{style:{display:"flex",width:300}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},tabs.map(tab=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"mlDFADecisionPathPopoverTab-".concat(tab.id),isSelected:tab.id===selectedTabId,onClick:()=>setSelectedTabId(tab.id),key:tab.id},tab.name)))),selectedTabId===DECISION_PATH_TABS.CHART&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued",style:{paddingTop:5}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathPlotHelpText",defaultMessage:"SHAP decision plots use {linkedFeatureImportanceValues} to show how models arrive at the predicted value for '{predictionFieldName}'.",values:{predictionFieldName:predictionFieldName,linkedFeatureImportanceValues:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"".concat(ELASTIC_WEBSITE_URL,"guide/en/machine-learning/").concat(DOC_LINK_VERSION,"/ml-feature-importance.html"),target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.dataframe.analytics.explorationResults.linkedFeatureImportanceValues",defaultMessage:"feature importance values"}))}})),analysisType===common["a"].CLASSIFICATION&&Object(feature_importance["a"])(baseline)&&external_kbnSharedDeps_React_default.a.createElement(ClassificationDecisionPath,{featureImportance:featureImportance,topClasses:topClasses,predictedValue:getStringBasedClassName(predictedValue),predictedProbability:predictedProbability,predictionFieldName:predictionFieldName,baseline:baseline}),analysisType===common["a"].REGRESSION&&Object(feature_importance["c"])(baseline)&&predictedValue!==undefined&&external_kbnSharedDeps_React_default.a.createElement(RegressionDecisionPath,{featureImportance:featureImportance,baseline:baseline,predictedValue:typeof predictedValue==="string"?parseFloat(predictedValue):predictedValue,predictionFieldName:predictionFieldName})),selectedTabId===DECISION_PATH_TABS.JSON&&external_kbnSharedDeps_React_default.a.createElement(DecisionPathJSONViewer,{featureImportance:featureImportance}))};var data_grid=__webpack_require__(382);function data_grid_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function data_grid_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){data_grid_ownKeys(Object(source),true).forEach((function(key){data_grid_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{data_grid_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function data_grid_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const DataGridTitle=({title:title})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("span",null,title));function isWithHeader(arg){return typeof(arg===null||arg===void 0?void 0:arg.title)==="string"&&(arg===null||arg===void 0?void 0:arg.title)!==""}const DataGrid=Object(external_kbnSharedDeps_React_["memo"])(props=>{const baseline=props.baseline,chartsVisible=props.chartsVisible,chartsButtonVisible=props.chartsButtonVisible,columnsWithCharts=props.columnsWithCharts,dataTestSubj=props.dataTestSubj,errorMessage=props.errorMessage,invalidSortingColumnns=props.invalidSortingColumnns,noDataMessage=props.noDataMessage,onChangeItemsPerPage=props.onChangeItemsPerPage,onChangePage=props.onChangePage,onSort=props.onSort,pagination=props.pagination,setVisibleColumns=props.setVisibleColumns,renderCellValue=props.renderCellValue,rowCount=props.rowCount,sortingColumns=props.sortingColumns,status=props.status,data=props.tableItems,toastNotifications=props.toastNotifications,toggleChartVisibility=props.toggleChartVisibility,visibleColumns=props.visibleColumns,predictionFieldName=props.predictionFieldName,resultsField=props.resultsField,analysisType=props.analysisType;const columnsWithChartsActionized=columnsWithCharts.map(d=>{if(chartsVisible===true){d.actions=false}return d});const popOverContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>analysisType===common["a"].REGRESSION||analysisType===common["a"].CLASSIFICATION?{featureImportance:({children:children})=>{var _children$props;const rowIndex=children===null||children===void 0?void 0:(_children$props=children.props)===null||_children$props===void 0?void 0:_children$props.visibleRowIndex;const row=data[rowIndex];if(!row)return external_kbnSharedDeps_React_default.a.createElement("div",null);const mlResultsField=resultsField!==null&&resultsField!==void 0?resultsField:data_frame_analytics["b"];let predictedValue;let predictedProbability;let topClasses=[];if(predictionFieldName!==undefined&&row&&row["".concat(mlResultsField,".").concat(predictionFieldName)]!==undefined){predictedValue=row["".concat(mlResultsField,".").concat(predictionFieldName)];topClasses=getTopClasses(row,mlResultsField);predictedProbability=row["".concat(mlResultsField,".prediction_probability")]}const isClassTypeBoolean=topClasses.reduce((p,c)=>typeof c.class_name==="boolean"||p,false);const parsedFIArray=getFeatureImportance(row,mlResultsField,isClassTypeBoolean);return external_kbnSharedDeps_React_default.a.createElement(DecisionPathPopover,{analysisType:analysisType,predictedValue:predictedValue,predictedProbability:predictedProbability,baseline:baseline,featureImportance:parsedFIArray,topClasses:topClasses,predictionFieldName:predictionFieldName?predictionFieldName.replace("_prediction",""):undefined})}}:undefined,[baseline,data]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(invalidSortingColumnns.length>0){invalidSortingColumnns.forEach(columnId=>{toastNotifications.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGrid.invalidSortingColumnError",{defaultMessage:"The column '{columnId}' cannot be used for sorting.",values:{columnId:columnId}}))})}},[invalidSortingColumnns,toastNotifications]);if(status===common["i"].LOADED&&data.length===0){return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"".concat(dataTestSubj," empty")},isWithHeader(props)&&external_kbnSharedDeps_React_default.a.createElement(DataGridTitle,{title:props.title}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGrid.IndexNoDataCalloutTitle",{defaultMessage:"Empty index query result."}),color:"primary"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGrid.IndexNoDataCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure you have sufficient permissions, the index contains documents and your query is not too restrictive."}))))}if(noDataMessage!==""){return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"".concat(dataTestSubj," empty")},isWithHeader(props)&&external_kbnSharedDeps_React_default.a.createElement(DataGridTitle,{title:props.title}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGrid.dataGridNoDataCalloutTitle",{defaultMessage:"Index preview not available"}),color:"primary"},external_kbnSharedDeps_React_default.a.createElement("p",null,noDataMessage)))}let errorCallout;if(status===common["i"].ERROR){if(errorMessage&&!errorMessage.includes("failed to create query")){errorCallout=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataframe.analytics.exploration.querySyntaxError",{defaultMessage:"An error occurred loading the index data. Please ensure your query syntax is valid."}),color:"danger",iconType:"cross"},external_kbnSharedDeps_React_default.a.createElement("p",null,errorMessage))}else{errorCallout=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGrid.indexDataError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],{language:"json",fontSize:"s",paddingSize:"s",isCopyable:true},errorMessage))}}return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"".concat(dataTestSubj," ").concat(status===common["i"].ERROR?"error":"loaded")},isWithHeader(props)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(DataGridTitle,{title:props.title})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCopy"],{beforeMessage:props.copyToClipboardDescription,textToCopy:props.copyToClipboard},copy=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{onClick:copy,iconType:"copyClipboard","aria-label":props.copyToClipboardDescription})))),errorCallout!==undefined&&external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"".concat(dataTestSubj," error")},errorCallout,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"})),external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataGrid"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDataGrid"],{"aria-label":isWithHeader(props)?props.title:"",columns:columnsWithChartsActionized.map(c=>{c.initialWidth=165;return c}),columnVisibility:{visibleColumns:visibleColumns,setVisibleColumns:setVisibleColumns},gridStyle:euiDataGridStyle,rowCount:rowCount,renderCellValue:renderCellValue,sorting:{columns:sortingColumns,onSort:onSort},toolbarVisibility:data_grid_objectSpread(data_grid_objectSpread({},euiDataGridToolbarSettings),chartsButtonVisible?{additionalControls:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGrid.histogramButtonToolTipContent",{defaultMessage:"Queries run to fetch histogram chart data will use a sample size per shard of {samplerShardSize} documents.",values:{samplerShardSize:field_histograms["a"]}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"aria-checked":chartsVisible,className:"euiDataGrid__controlBtn".concat(chartsVisible?" euiDataGrid__controlBtn--active":""),"data-test-subj":"".concat(dataTestSubj,"HistogramButton"),size:"xs",iconType:"visBarVertical",color:"text",onClick:toggleChartVisibility},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataGrid.histogramButtonText",{defaultMessage:"Histogram charts"})))}:{}),popoverContents:popOverContent,pagination:data_grid_objectSpread(data_grid_objectSpread({},pagination),{},{pageSizeOptions:[5,10,25],onChangeItemsPerPage:onChangeItemsPerPage,onChangePage:onChangePage})})))},(prevProps,nextProps)=>Object(external_kbnSharedDeps_Lodash_["isEqual"])(pickProps(prevProps),pickProps(nextProps)));function pickProps(props){return[props.columnsWithCharts,props.dataTestSubj,props.errorMessage,props.invalidSortingColumnns,props.noDataMessage,props.pagination,props.rowCount,props.sortingColumns,props.status,props.tableItems,props.visibleColumns,...isWithHeader(props)?[props.copyToClipboard,props.copyToClipboardDescription,props.title]:[]]}var types=__webpack_require__(130)},109:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return formatValue}));__webpack_require__.d(__webpack_exports__,"a",(function(){return formatSingleValue}));var moment__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(28);var moment__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);const SIGFIGS_IF_ROUNDING=3;function formatValue(value,mlFunction,fieldFormat,record){if(Array.isArray(value)){if(value.length===1){return formatSingleValue(value[0],mlFunction,fieldFormat,record)}else{const values=value.map(val=>formatSingleValue(val,mlFunction,undefined,record));return"[".concat(values,"]")}}else{return formatSingleValue(value,mlFunction,fieldFormat,record)}}function formatSingleValue(value,mlFunction,fieldFormat,record){if(value===undefined||value===null){return""}if(mlFunction==="time_of_week"){const d=record!==undefined&&record.timestamp!==undefined?new Date(record.timestamp):new Date;const utcMoment=moment__WEBPACK_IMPORTED_MODULE_0___default.a.utc(d).startOf("week").add(value,"s");return moment__WEBPACK_IMPORTED_MODULE_0___default()(utcMoment.valueOf()).format("ddd HH:mm")}else if(mlFunction==="time_of_day"){const d=record!==undefined&&record.timestamp!==undefined?new Date(record.timestamp):new Date;const utcMoment=moment__WEBPACK_IMPORTED_MODULE_0___default.a.utc(d).startOf("day").add(value,"s");return moment__WEBPACK_IMPORTED_MODULE_0___default()(utcMoment.valueOf()).format("HH:mm")}else{if(fieldFormat!==undefined){return fieldFormat.convert(value,"text")}else{const absValue=Math.abs(value);if(absValue>=1e4||absValue===Math.floor(absValue)){if(fieldFormat!==undefined){return fieldFormat.convert(value,"text")}else{return Number(value.toFixed(0))}}else if(absValue>=10){return Number(value.toFixed(1))}else{let multiple;if(value>0){multiple=Math.pow(10,SIGFIGS_IF_ROUNDING-Math.floor(Math.log(value)/Math.LN10)-1)}else{multiple=Math.pow(10,SIGFIGS_IF_ROUNDING-Math.floor(Math.log(-1*value)/Math.LN10)-1)}return Math.round(value*multiple)/multiple}}}}},115:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return mlFieldFormatService}));var _common_util_job_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(56);var _util_index_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(71);var _job_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(57);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class FieldFormatService{constructor(){_defineProperty(this,"indexPatternIdsByJob",{});_defineProperty(this,"formatsByJob",{})}populateFormats(jobIds){return new Promise((resolve,reject)=>{jobIds.forEach(jobId=>{const jobObj=_job_service__WEBPACK_IMPORTED_MODULE_2__["a"].getJob(jobId);const datafeedIndices=jobObj.datafeed_config.indices;const id=Object(_util_index_utils__WEBPACK_IMPORTED_MODULE_1__["c"])(datafeedIndices.length?datafeedIndices[0]:"");if(id!==null){this.indexPatternIdsByJob[jobId]=id}});const promises=jobIds.map(jobId=>Promise.all([this.getFormatsForJob(jobId)]));Promise.all(promises).then(fmtsByJobByDetector=>{fmtsByJobByDetector.forEach((formatsByDetector,i)=>{this.formatsByJob[jobIds[i]]=formatsByDetector[0]});resolve(this.formatsByJob)}).catch(err=>{reject({formats:{},err:err})})})}getFieldFormat(jobId,detectorIndex){if(this.formatsByJob.hasOwnProperty(jobId)){return this.formatsByJob[jobId][detectorIndex]}}getFieldFormatFromIndexPattern(fullIndexPattern,fieldName,esAggName){let fieldFormat;if(esAggName!=="cardinality"){const fieldList=fullIndexPattern.fields;const field=fieldList.getByName(fieldName);if(field!==undefined){fieldFormat=fullIndexPattern.getFormatterForField(field)}}return fieldFormat}getFormatsForJob(jobId){return new Promise((resolve,reject)=>{const jobObj=_job_service__WEBPACK_IMPORTED_MODULE_2__["a"].getJob(jobId);const detectors=jobObj.analysis_config.detectors||[];const formatsByDetector=[];const indexPatternId=this.indexPatternIdsByJob[jobId];if(indexPatternId!==undefined){Object(_util_index_utils__WEBPACK_IMPORTED_MODULE_1__["b"])(indexPatternId).then(indexPatternData=>{const fieldList=indexPatternData.fields;detectors.forEach(dtr=>{const esAgg=Object(_common_util_job_utils__WEBPACK_IMPORTED_MODULE_0__["p"])(dtr.function);if(dtr.field_name!==undefined&&esAgg!=="cardinality"){const field=fieldList.getByName(dtr.field_name);if(field!==undefined){formatsByDetector[dtr.detector_index]=indexPatternData.getFormatterForField(field)}}});resolve(formatsByDetector)}).catch(err=>{reject(err)})}else{resolve(formatsByDetector)}})}}const mlFieldFormatService=new FieldFormatService},117:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(35);var react_1=__webpack_require__(10);var useIsomorphicLayoutEffect_1=tslib_1.__importDefault(__webpack_require__(372));function useObservable(observable$,initialValue){var _a=react_1.useState(initialValue),value=_a[0],update=_a[1];useIsomorphicLayoutEffect_1.default((function(){var s=observable$.subscribe(update);return function(){return s.unsubscribe()}}),[observable$]);return value}exports.default=useObservable},127:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return FEATURE_IMPORTANCE}));__webpack_require__.d(__webpack_exports__,"b",(function(){return FEATURE_INFLUENCE}));__webpack_require__.d(__webpack_exports__,"d",(function(){return TOP_CLASSES}));__webpack_require__.d(__webpack_exports__,"c",(function(){return OUTLIER_SCORE}));const FEATURE_IMPORTANCE="feature_importance";const FEATURE_INFLUENCE="feature_influence";const TOP_CLASSES="top_classes";const OUTLIER_SCORE="outlier_score"},129:function(module,exports){},130:function(module,exports){},142:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return isGetDataFrameAnalyticsStatsResponseOk}));__webpack_require__.d(__webpack_exports__,"a",(function(){return getAnalyticsFactory}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);var _services_ml_api_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(50);var _common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(61);var _components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(78);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const isGetDataFrameAnalyticsStatsResponseOk=arg=>({}.hasOwnProperty.call(arg,"count")&&{}.hasOwnProperty.call(arg,"data_frame_analytics")&&Array.isArray(arg.data_frame_analytics));function getInitialAnalyticsStats(){return{total:{label:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.overview.statsBar.totalAnalyticsLabel",{defaultMessage:"Total analytics jobs"}),value:0,show:true},started:{label:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.overview.statsBar.runningAnalyticsLabel",{defaultMessage:"Running"}),value:0,show:true},stopped:{label:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.overview.statsBar.stoppedAnalyticsLabel",{defaultMessage:"Stopped"}),value:0,show:true},failed:{label:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.overview.statsBar.failedAnalyticsLabel",{defaultMessage:"Failed"}),value:0,show:false}}}function getAnalyticsJobsStats(analyticsStats){const resultStats=analyticsStats.data_frame_analytics.reduce((acc,{state:state})=>{if(Object(_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__["f"])(state)){acc.failed.value=++acc.failed.value}else if(Object(_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__["g"])(state)){acc.started.value=++acc.started.value}else if(Object(_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__["i"])(state)){acc.stopped.value=++acc.stopped.value}return acc},getInitialAnalyticsStats());resultStats.failed.show=resultStats.failed.value>0;resultStats.total.value=analyticsStats.count;return resultStats}const getAnalyticsFactory=(setAnalytics,setAnalyticsStats,setErrorMessage,setIsInitialized,blockRefresh,isManagementTable)=>{let concurrentLoads=0;const getAnalytics=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(forceRefresh=false){var analyticsConfigs,analyticsStats,spaces,allSpaces,analyticsStatsResult,tableRows;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(forceRefresh===true||blockRefresh===false)){_context.next=40;break}_common__WEBPACK_IMPORTED_MODULE_2__["F"].next(_common__WEBPACK_IMPORTED_MODULE_2__["n"].LOADING);concurrentLoads++;if(!(concurrentLoads>1)){_context.next=5;break}return _context.abrupt("return");case 5:_context.prev=5;_context.next=8;return _services_ml_api_service__WEBPACK_IMPORTED_MODULE_1__["ml"].dataFrameAnalytics.getDataFrameAnalytics();case 8:analyticsConfigs=_context.sent;_context.next=11;return _services_ml_api_service__WEBPACK_IMPORTED_MODULE_1__["ml"].dataFrameAnalytics.getDataFrameAnalyticsStats();case 11:analyticsStats=_context.sent;spaces={};if(!isManagementTable){_context.next=18;break}_context.next=16;return _services_ml_api_service__WEBPACK_IMPORTED_MODULE_1__["ml"].savedObjects.jobsSpaces();case 16:allSpaces=_context.sent;spaces=allSpaces["data-frame-analytics"];case 18:analyticsStatsResult=isGetDataFrameAnalyticsStatsResponseOk(analyticsStats)?getAnalyticsJobsStats(analyticsStats):undefined;tableRows=analyticsConfigs.data_frame_analytics.reduce((reducedtableRows,config)=>{var _spaces$config$id;const stats=isGetDataFrameAnalyticsStatsResponseOk(analyticsStats)?analyticsStats.data_frame_analytics.find(d=>config.id===d.id):undefined;if(!Object(_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__["h"])(stats)){return reducedtableRows}reducedtableRows.push({checkpointing:{},config:config,id:config.id,job_type:Object(_common__WEBPACK_IMPORTED_MODULE_2__["t"])(config.analysis),mode:_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__["a"].BATCH,state:stats.state,stats:stats,spaceIds:(_spaces$config$id=spaces[config.id])!==null&&_spaces$config$id!==void 0?_spaces$config$id:[]});return reducedtableRows},[]);setAnalytics(tableRows);setAnalyticsStats(analyticsStatsResult);setErrorMessage(undefined);setIsInitialized(true);_common__WEBPACK_IMPORTED_MODULE_2__["F"].next(_common__WEBPACK_IMPORTED_MODULE_2__["n"].IDLE);_context.next=35;break;case 27:_context.prev=27;_context.t0=_context["catch"](5);_common__WEBPACK_IMPORTED_MODULE_2__["F"].next(_common__WEBPACK_IMPORTED_MODULE_2__["n"].ERROR);_common__WEBPACK_IMPORTED_MODULE_2__["F"].next(_common__WEBPACK_IMPORTED_MODULE_2__["n"].IDLE);setAnalytics([]);setAnalyticsStats(undefined);setErrorMessage(_context.t0);setIsInitialized(true);case 35:concurrentLoads--;if(!(concurrentLoads>0)){_context.next=40;break}concurrentLoads=0;getAnalytics(true);return _context.abrupt("return");case 40:case"end":return _context.stop()}}),_callee,null,[[5,27]])})));return function getAnalytics(){return _ref.apply(this,arguments)}}();return getAnalytics}},163:function(module,exports){},164:function(module,exports){},165:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return isClassificationTotalFeatureImportance}));__webpack_require__.d(__webpack_exports__,"d",(function(){return isRegressionTotalFeatureImportance}));__webpack_require__.d(__webpack_exports__,"a",(function(){return isClassificationFeatureImportanceBaseline}));__webpack_require__.d(__webpack_exports__,"c",(function(){return isRegressionFeatureImportanceBaseline}));function isClassificationTotalFeatureImportance(summary){return summary.classes!==undefined}function isRegressionTotalFeatureImportance(summary){return summary.importance!==undefined}function isClassificationFeatureImportanceBaseline(baselineData){return typeof baselineData==="object"&&baselineData.hasOwnProperty("classes")&&Array.isArray(baselineData.classes)}function isRegressionFeatureImportanceBaseline(baselineData){return typeof baselineData==="object"&&baselineData.hasOwnProperty("baseline")}},199:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return apmUserMlCapabilities}));__webpack_require__.d(__webpack_exports__,"f",(function(){return userMlCapabilities}));__webpack_require__.d(__webpack_exports__,"a",(function(){return adminMlCapabilities}));__webpack_require__.d(__webpack_exports__,"c",(function(){return basicLicenseMlCapabilities}));__webpack_require__.d(__webpack_exports__,"d",(function(){return getDefaultCapabilities}));__webpack_require__.d(__webpack_exports__,"e",(function(){return getPluginPrivileges}));var _constants_app__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4);var _saved_objects__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(246);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const apmUserMlCapabilities={canGetJobs:false,canAccessML:false};const userMlCapabilities={canAccessML:false,canGetJobs:false,canGetDatafeeds:false,canGetCalendars:false,canFindFileStructure:false,canGetDataFrameAnalytics:false,canGetAnnotations:false,canCreateAnnotation:false,canDeleteAnnotation:false};const adminMlCapabilities={canCreateJob:false,canDeleteJob:false,canOpenJob:false,canCloseJob:false,canUpdateJob:false,canForecastJob:false,canCreateDatafeed:false,canDeleteDatafeed:false,canStartStopDatafeed:false,canUpdateDatafeed:false,canPreviewDatafeed:false,canGetFilters:false,canCreateCalendar:false,canDeleteCalendar:false,canCreateFilter:false,canDeleteFilter:false,canCreateDataFrameAnalytics:false,canDeleteDataFrameAnalytics:false,canStartStopDataFrameAnalytics:false};const basicLicenseMlCapabilities=["canAccessML","canFindFileStructure"];function getDefaultCapabilities(){return _objectSpread(_objectSpread({},userMlCapabilities),adminMlCapabilities)}function getPluginPrivileges(){const apmUserMlCapabilitiesKeys=Object.keys(apmUserMlCapabilities);const userMlCapabilitiesKeys=Object.keys(userMlCapabilities);const adminMlCapabilitiesKeys=Object.keys(adminMlCapabilities);const allMlCapabilitiesKeys=[...adminMlCapabilitiesKeys,...userMlCapabilitiesKeys];const savedObjects=["index-pattern","dashboard","search","visualization",_saved_objects__WEBPACK_IMPORTED_MODULE_1__["a"]];const privilege={app:[_constants_app__WEBPACK_IMPORTED_MODULE_0__["c"],"kibana"],excludeFromBasePrivileges:true,management:{insightsAndAlerting:["jobsListLink"]},catalogue:[_constants_app__WEBPACK_IMPORTED_MODULE_0__["c"]]};return{admin:_objectSpread(_objectSpread({},privilege),{},{api:allMlCapabilitiesKeys.map(k=>"ml:".concat(k)),catalogue:[_constants_app__WEBPACK_IMPORTED_MODULE_0__["c"],"".concat(_constants_app__WEBPACK_IMPORTED_MODULE_0__["c"],"_file_data_visualizer")],ui:allMlCapabilitiesKeys,savedObject:{all:savedObjects,read:savedObjects}}),user:_objectSpread(_objectSpread({},privilege),{},{api:userMlCapabilitiesKeys.map(k=>"ml:".concat(k)),catalogue:[_constants_app__WEBPACK_IMPORTED_MODULE_0__["c"]],management:{insightsAndAlerting:[]},ui:userMlCapabilitiesKeys,savedObject:{all:[],read:savedObjects}}),apmUser:{excludeFromBasePrivileges:true,app:[],catalogue:[],savedObject:{all:[],read:[_saved_objects__WEBPACK_IMPORTED_MODULE_1__["a"]]},api:apmUserMlCapabilitiesKeys.map(k=>"ml:".concat(k)),ui:apmUserMlCapabilitiesKeys}}}},200:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _job__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(248);var _job__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_job__WEBPACK_IMPORTED_MODULE_0__);for(var __WEBPACK_IMPORT_KEY__ in _job__WEBPACK_IMPORTED_MODULE_0__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _job__WEBPACK_IMPORTED_MODULE_0__[key]}))})(__WEBPACK_IMPORT_KEY__);var _job_stats__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(249);var _job_stats__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_job_stats__WEBPACK_IMPORTED_MODULE_1__);for(var __WEBPACK_IMPORT_KEY__ in _job_stats__WEBPACK_IMPORTED_MODULE_1__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _job_stats__WEBPACK_IMPORTED_MODULE_1__[key]}))})(__WEBPACK_IMPORT_KEY__);var _datafeed__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(163);var _datafeed__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_datafeed__WEBPACK_IMPORTED_MODULE_2__);for(var __WEBPACK_IMPORT_KEY__ in _datafeed__WEBPACK_IMPORTED_MODULE_2__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _datafeed__WEBPACK_IMPORTED_MODULE_2__[key]}))})(__WEBPACK_IMPORT_KEY__);var _datafeed_stats__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(164);var _datafeed_stats__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_datafeed_stats__WEBPACK_IMPORTED_MODULE_3__);for(var __WEBPACK_IMPORT_KEY__ in _datafeed_stats__WEBPACK_IMPORTED_MODULE_3__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _datafeed_stats__WEBPACK_IMPORTED_MODULE_3__[key]}))})(__WEBPACK_IMPORT_KEY__);var _combined_job__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(250);__webpack_require__.d(__webpack_exports__,"expandCombinedJobConfig",(function(){return _combined_job__WEBPACK_IMPORTED_MODULE_4__["a"]}));__webpack_require__.d(__webpack_exports__,"isCombinedJobWithStats",(function(){return _combined_job__WEBPACK_IMPORTED_MODULE_4__["b"]}));var _summary_job__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(251);__webpack_require__.d(__webpack_exports__,"Datafeed",(function(){return _summary_job__WEBPACK_IMPORTED_MODULE_5__["a"]}));__webpack_require__.d(__webpack_exports__,"DatafeedStats",(function(){return _summary_job__WEBPACK_IMPORTED_MODULE_5__["b"]}));var _model_snapshot__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(252);var _model_snapshot__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_model_snapshot__WEBPACK_IMPORTED_MODULE_6__);for(var __WEBPACK_IMPORT_KEY__ in _model_snapshot__WEBPACK_IMPORTED_MODULE_6__)if(["default","expandCombinedJobConfig","isCombinedJobWithStats","Datafeed","DatafeedStats"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _model_snapshot__WEBPACK_IMPORTED_MODULE_6__[key]}))})(__WEBPACK_IMPORT_KEY__)},201:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getMetricChangeDescription}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);function getMetricChangeDescription(actualProp,typicalProp){if(actualProp===undefined||typicalProp===undefined){return{iconType:"empty",message:""}}let iconType="alert";let message;let actual=0;let typical=0;if(Array.isArray(actualProp)){if(actualProp.length===1){actual=actualProp[0]}else{return{iconType:"alert",message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.unusualValuesDescription",{defaultMessage:"Unusual values"})}}}else{actual=actualProp}if(Array.isArray(typicalProp)){if(typicalProp.length===1){typical=typicalProp[0]}}else{typical=typicalProp}if(actual===typical){message=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.actualSameAsTypicalDescription",{defaultMessage:"actual same as typical"})}else{const isHigher=actual>typical;iconType=isHigher?"sortUp":"sortDown";if(typical!==0&&actual!==0){const factor=isHigher?actual/typical:typical/actual;if(factor>1.5){if(factor<=100){message=isHigher?_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:Math.round(factor)}}):_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:Math.round(factor)}})}else{message=isHigher?_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.moreThan100xHigherDescription",{defaultMessage:"More than 100x higher"}):_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.moreThan100xLowerDescription",{defaultMessage:"More than 100x lower"})}}else if(factor>=1.05){message=isHigher?_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:factor.toPrecision(2)}}):_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:factor.toPrecision(2)}})}else{message=isHigher?_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.unusuallyHighDescription",{defaultMessage:"Unusually high"}):_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.unusuallyLowDescription",{defaultMessage:"Unusually low"})}}else{if(actual===0){message=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.unexpectedZeroValueDescription",{defaultMessage:"Unexpected zero value"})}else{message=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.formatters.metricChangeDescription.unexpectedNonZeroValueDescription",{defaultMessage:"Unexpected non-zero value"})}}}return{iconType:iconType,message:message}}},203:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useTrainedModelsApiService}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _index__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(50);var _contexts_kibana__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(51);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function trainedModelsApiProvider(httpService){const apiBasePath=Object(_index__WEBPACK_IMPORTED_MODULE_1__["basePath"])();return{getTrainedModels(modelId,params){let model=modelId!==null&&modelId!==void 0?modelId:"";if(Array.isArray(modelId)){model=modelId.join(",")}return httpService.http(_objectSpread({path:"".concat(apiBasePath,"/trained_models").concat(model&&"/".concat(model)),method:"GET"},params?{query:params}:{}))},getTrainedModelStats(modelId,params){let model=modelId!==null&&modelId!==void 0?modelId:"_all";if(Array.isArray(modelId)){model=modelId.join(",")}return httpService.http({path:"".concat(apiBasePath,"/trained_models/").concat(model,"/_stats"),method:"GET"})},getTrainedModelPipelines(modelId){let model=modelId;if(Array.isArray(modelId)){model=modelId.join(",")}return httpService.http({path:"".concat(apiBasePath,"/trained_models/").concat(model,"/pipelines"),method:"GET"})},deleteTrainedModel(modelId){return httpService.http({path:"".concat(apiBasePath,"/trained_models/").concat(modelId),method:"DELETE"})}}}function useTrainedModelsApiService(){const _useMlKibana=Object(_contexts_kibana__WEBPACK_IMPORTED_MODULE_2__["a"])(),httpService=_useMlKibana.services.mlServices.httpService;return Object(react__WEBPACK_IMPORTED_MODULE_0__["useMemo"])(()=>trainedModelsApiProvider(httpService),[httpService])}},246:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ML_SAVED_OBJECT_TYPE}));const ML_SAVED_OBJECT_TYPE="ml-job"},248:function(module,exports){},249:function(module,exports){},250:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return expandCombinedJobConfig}));__webpack_require__.d(__webpack_exports__,"b",(function(){return isCombinedJobWithStats}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);function expandCombinedJobConfig(combinedJob){const combinedJobClone=Object(lodash__WEBPACK_IMPORTED_MODULE_0__["cloneDeep"])(combinedJob);const job=combinedJobClone;const datafeed=combinedJobClone.datafeed_config;delete job.datafeed_config;return{job:job,datafeed:datafeed}}function isCombinedJobWithStats(arg){return typeof arg.job_id==="string"}},251:function(module,__webpack_exports__,__webpack_require__){"use strict";var _datafeed__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(163);var _datafeed__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_datafeed__WEBPACK_IMPORTED_MODULE_0__);__webpack_require__.d(__webpack_exports__,"a",(function(){return _datafeed__WEBPACK_IMPORTED_MODULE_0__["Datafeed"]}));var _datafeed_stats__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(164);var _datafeed_stats__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_datafeed_stats__WEBPACK_IMPORTED_MODULE_1__);__webpack_require__.d(__webpack_exports__,"b",(function(){return _datafeed_stats__WEBPACK_IMPORTED_MODULE_1__["DatafeedStats"]}))},252:function(module,exports){},260:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DEFAULT_SAMPLER_SHARD_SIZE}));const DEFAULT_SAMPLER_SHARD_SIZE=5e3},372:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(10);var useIsomorphicLayoutEffect=typeof window!=="undefined"?react_1.useLayoutEffect:react_1.useEffect;exports.default=useIsomorphicLayoutEffect},373:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(374);case"v7light":return __webpack_require__(376);case"v8dark":return __webpack_require__(378);case"v8light":return __webpack_require__(380)}},374:function(module,exports,__webpack_require__){var api=__webpack_require__(52);var content=__webpack_require__(375);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},375:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(53);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".mlDataGridChart__histogram {\n  width: 100%;\n  height: 72px; }\n\n.mlDataGridChart__legend {\n  max-width: 100%;\n  overflow: hidden !important;\n  text-overflow: ellipsis !important;\n  white-space: nowrap !important;\n  word-wrap: normal !important;\n  font-size: 12px;\n  font-size: 0.75rem;\n  line-height: 1.5;\n  color: #535966;\n  display: block;\n  overflow-x: hidden;\n  margin: 4px 0px 0px 0px;\n  font-style: italic;\n  font-weight: normal;\n  text-align: left; }\n\n.mlDataGridChart__legend--numeric {\n  text-align: right; }\n\n.mlDataGridChart__legendBoolean {\n  width: 100%; }\n  .mlDataGridChart__legendBoolean td {\n    text-align: center; }\n\n/* Override to align column header to bottom of cell when no chart is available */\n.mlDataGrid .euiDataGridHeaderCell__content {\n  margin-top: auto; }\n",""]);module.exports=exports},376:function(module,exports,__webpack_require__){var api=__webpack_require__(52);var content=__webpack_require__(377);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},377:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(53);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".mlDataGridChart__histogram {\n  width: 100%;\n  height: 72px; }\n\n.mlDataGridChart__legend {\n  max-width: 100%;\n  overflow: hidden !important;\n  text-overflow: ellipsis !important;\n  white-space: nowrap !important;\n  word-wrap: normal !important;\n  font-size: 12px;\n  font-size: 0.75rem;\n  line-height: 1.5;\n  color: #909090;\n  display: block;\n  overflow-x: hidden;\n  margin: 4px 0px 0px 0px;\n  font-style: italic;\n  font-weight: normal;\n  text-align: left; }\n\n.mlDataGridChart__legend--numeric {\n  text-align: right; }\n\n.mlDataGridChart__legendBoolean {\n  width: 100%; }\n  .mlDataGridChart__legendBoolean td {\n    text-align: center; }\n\n/* Override to align column header to bottom of cell when no chart is available */\n.mlDataGrid .euiDataGridHeaderCell__content {\n  margin-top: auto; }\n",""]);module.exports=exports},378:function(module,exports,__webpack_require__){var api=__webpack_require__(52);var content=__webpack_require__(379);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},379:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(53);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".mlDataGridChart__histogram {\n  width: 100%;\n  height: 72px; }\n\n.mlDataGridChart__legend {\n  max-width: 100%;\n  overflow: hidden !important;\n  text-overflow: ellipsis !important;\n  white-space: nowrap !important;\n  word-wrap: normal !important;\n  font-size: 12px;\n  font-size: 0.85714rem;\n  line-height: 1.5;\n  color: #535966;\n  display: block;\n  overflow-x: hidden;\n  margin: 4px 0px 0px 0px;\n  font-style: italic;\n  font-weight: normal;\n  text-align: left; }\n\n.mlDataGridChart__legend--numeric {\n  text-align: right; }\n\n.mlDataGridChart__legendBoolean {\n  width: 100%; }\n  .mlDataGridChart__legendBoolean td {\n    text-align: center; }\n\n/* Override to align column header to bottom of cell when no chart is available */\n.mlDataGrid .euiDataGridHeaderCell__content {\n  margin-top: auto; }\n",""]);module.exports=exports},380:function(module,exports,__webpack_require__){var api=__webpack_require__(52);var content=__webpack_require__(381);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},381:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(53);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".mlDataGridChart__histogram {\n  width: 100%;\n  height: 72px; }\n\n.mlDataGridChart__legend {\n  max-width: 100%;\n  overflow: hidden !important;\n  text-overflow: ellipsis !important;\n  white-space: nowrap !important;\n  word-wrap: normal !important;\n  font-size: 12px;\n  font-size: 0.85714rem;\n  line-height: 1.5;\n  color: #909090;\n  display: block;\n  overflow-x: hidden;\n  margin: 4px 0px 0px 0px;\n  font-style: italic;\n  font-weight: normal;\n  text-align: left; }\n\n.mlDataGridChart__legend--numeric {\n  text-align: right; }\n\n.mlDataGridChart__legendBoolean {\n  width: 100%; }\n  .mlDataGridChart__legendBoolean td {\n    text-align: center; }\n\n/* Override to align column header to bottom of cell when no chart is available */\n.mlDataGrid .euiDataGridHeaderCell__content {\n  margin-top: auto; }\n",""]);module.exports=exports},382:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(383);case"v7light":return __webpack_require__(385);case"v8dark":return __webpack_require__(387);case"v8light":return __webpack_require__(389)}},383:function(module,exports,__webpack_require__){var api=__webpack_require__(52);var content=__webpack_require__(384);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},384:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(53);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".mlDataGrid .euiDataGridRowCell--boolean {\n  text-transform: none; }\n",""]);module.exports=exports},385:function(module,exports,__webpack_require__){var api=__webpack_require__(52);var content=__webpack_require__(386);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},386:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(53);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".mlDataGrid .euiDataGridRowCell--boolean {\n  text-transform: none; }\n",""]);module.exports=exports},387:function(module,exports,__webpack_require__){var api=__webpack_require__(52);var content=__webpack_require__(388);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},388:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(53);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".mlDataGrid .euiDataGridRowCell--boolean {\n  text-transform: none; }\n",""]);module.exports=exports},389:function(module,exports,__webpack_require__){var api=__webpack_require__(52);var content=__webpack_require__(390);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},390:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(53);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".mlDataGrid .euiDataGridRowCell--boolean {\n  text-transform: none; }\n",""]);module.exports=exports},54:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ANALYSIS_ADVANCED_FIELDS}));__webpack_require__.d(__webpack_exports__,"h",(function(){return OUTLIER_ANALYSIS_METHOD}));__webpack_require__.d(__webpack_exports__,"l",(function(){return SEARCH_SIZE}));__webpack_require__.d(__webpack_exports__,"o",(function(){return TRAINING_PERCENT_MIN}));__webpack_require__.d(__webpack_exports__,"n",(function(){return TRAINING_PERCENT_MAX}));__webpack_require__.d(__webpack_exports__,"g",(function(){return NUM_TOP_FEATURE_IMPORTANCE_VALUES_MIN}));__webpack_require__.d(__webpack_exports__,"q",(function(){return defaultSearchQuery}));__webpack_require__.d(__webpack_exports__,"s",(function(){return getDefaultTrainingFilterQuery}));__webpack_require__.d(__webpack_exports__,"e",(function(){return INDEX_STATUS}));__webpack_require__.d(__webpack_exports__,"y",(function(){return getTrainingPercent}));__webpack_require__.d(__webpack_exports__,"u",(function(){return getNumTopClasses}));__webpack_require__.d(__webpack_exports__,"v",(function(){return getNumTopFeatureImportanceValues}));__webpack_require__.d(__webpack_exports__,"F",(function(){return isResultsSearchBoolQuery}));__webpack_require__.d(__webpack_exports__,"E",(function(){return isRegressionEvaluateResponse}));__webpack_require__.d(__webpack_exports__,"B",(function(){return isClassificationEvaluateResponse}));__webpack_require__.d(__webpack_exports__,"i",(function(){return REFRESH_ANALYTICS_LIST_STATE}));__webpack_require__.d(__webpack_exports__,"I",(function(){return refreshAnalyticsList$}));__webpack_require__.d(__webpack_exports__,"J",(function(){return useRefreshAnalyticsList}));__webpack_require__.d(__webpack_exports__,"c",(function(){return EMPTY_STAT}));__webpack_require__.d(__webpack_exports__,"z",(function(){return getValuesFromResponse}));__webpack_require__.d(__webpack_exports__,"j",(function(){return REGRESSION_STATS}));__webpack_require__.d(__webpack_exports__,"H",(function(){return loadEvalData}));__webpack_require__.d(__webpack_exports__,"G",(function(){return loadDocsCount}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var rxjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(17);var rxjs__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_1__);var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(18);var rxjs_operators__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__);var lodash__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7);var lodash__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_3__);var _services_ml_api_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(50);var _common_util_errors__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(64);var _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(86);__webpack_require__.d(__webpack_exports__,"C",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["g"]}));__webpack_require__.d(__webpack_exports__,"D",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["h"]}));__webpack_require__.d(__webpack_exports__,"A",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["f"]}));__webpack_require__.d(__webpack_exports__,"x",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["e"]}));__webpack_require__.d(__webpack_exports__,"t",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["c"]}));__webpack_require__.d(__webpack_exports__,"w",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["d"]}));var _common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(70);__webpack_require__.d(__webpack_exports__,"b",(function(){return _common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__["a"]}));__webpack_require__.d(__webpack_exports__,"r",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["a"]}));function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}let ANALYSIS_ADVANCED_FIELDS;(function(ANALYSIS_ADVANCED_FIELDS){ANALYSIS_ADVANCED_FIELDS["ETA"]="eta";ANALYSIS_ADVANCED_FIELDS["FEATURE_BAG_FRACTION"]="feature_bag_fraction";ANALYSIS_ADVANCED_FIELDS["FEATURE_INFLUENCE_THRESHOLD"]="feature_influence_threshold";ANALYSIS_ADVANCED_FIELDS["GAMMA"]="gamma";ANALYSIS_ADVANCED_FIELDS["LAMBDA"]="lambda";ANALYSIS_ADVANCED_FIELDS["MAX_TREES"]="max_trees";ANALYSIS_ADVANCED_FIELDS["METHOD"]="method";ANALYSIS_ADVANCED_FIELDS["N_NEIGHBORS"]="n_neighbors";ANALYSIS_ADVANCED_FIELDS["NUM_TOP_CLASSES"]="num_top_classes";ANALYSIS_ADVANCED_FIELDS["NUM_TOP_FEATURE_IMPORTANCE_VALUES"]="num_top_feature_importance_values";ANALYSIS_ADVANCED_FIELDS["OUTLIER_FRACTION"]="outlier_fraction";ANALYSIS_ADVANCED_FIELDS["RANDOMIZE_SEED"]="randomize_seed"})(ANALYSIS_ADVANCED_FIELDS||(ANALYSIS_ADVANCED_FIELDS={}));let OUTLIER_ANALYSIS_METHOD;(function(OUTLIER_ANALYSIS_METHOD){OUTLIER_ANALYSIS_METHOD["LOF"]="lof";OUTLIER_ANALYSIS_METHOD["LDOF"]="ldof";OUTLIER_ANALYSIS_METHOD["DISTANCE_KTH_NN"]="distance_kth_nn";OUTLIER_ANALYSIS_METHOD["DISTANCE_KNN"]="distance_knn"})(OUTLIER_ANALYSIS_METHOD||(OUTLIER_ANALYSIS_METHOD={}));const SEARCH_SIZE=1e3;const TRAINING_PERCENT_MIN=1;const TRAINING_PERCENT_MAX=100;const NUM_TOP_FEATURE_IMPORTANCE_VALUES_MIN=0;const defaultSearchQuery={match_all:{}};const getDefaultTrainingFilterQuery=(resultsField,isTraining)=>({bool:{minimum_should_match:1,should:[{match:{["".concat(resultsField,".is_training")]:isTraining}}]}});let INDEX_STATUS;(function(INDEX_STATUS){INDEX_STATUS[INDEX_STATUS["UNUSED"]=0]="UNUSED";INDEX_STATUS[INDEX_STATUS["LOADING"]=1]="LOADING";INDEX_STATUS[INDEX_STATUS["LOADED"]=2]="LOADED";INDEX_STATUS[INDEX_STATUS["ERROR"]=3]="ERROR"})(INDEX_STATUS||(INDEX_STATUS={}));const getTrainingPercent=analysis=>{let trainingPercent;if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["h"])(analysis)){trainingPercent=analysis.regression.training_percent}if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["f"])(analysis)){trainingPercent=analysis.classification.training_percent}return trainingPercent};const getNumTopClasses=analysis=>{let numTopClasses;if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["f"])(analysis)&&analysis.classification.num_top_classes!==undefined){numTopClasses=analysis.classification.num_top_classes}return numTopClasses};const getNumTopFeatureImportanceValues=analysis=>{let numTopFeatureImportanceValues;if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["h"])(analysis)&&analysis.regression.num_top_feature_importance_values!==undefined){numTopFeatureImportanceValues=analysis.regression.num_top_feature_importance_values}else if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__["f"])(analysis)&&analysis.classification.num_top_feature_importance_values!==undefined){numTopFeatureImportanceValues=analysis.classification.num_top_feature_importance_values}return numTopFeatureImportanceValues};const isResultsSearchBoolQuery=arg=>{if(arg===undefined)return false;const keys=Object.keys(arg);return keys.length===1&&keys[0]==="bool"};const isQueryStringQuery=arg=>{if(arg===undefined)return false;const keys=Object.keys(arg);return keys.length===1&&keys[0]==="query_string"};const isRegressionEvaluateResponse=arg=>{var _arg$regression,_arg$regression2;const keys=Object.keys(arg);return keys.length===1&&keys[0]===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__["a"].REGRESSION&&(arg===null||arg===void 0?void 0:(_arg$regression=arg.regression)===null||_arg$regression===void 0?void 0:_arg$regression.mse)!==undefined&&(arg===null||arg===void 0?void 0:(_arg$regression2=arg.regression)===null||_arg$regression2===void 0?void 0:_arg$regression2.r_squared)!==undefined};const isClassificationEvaluateResponse=arg=>{var _arg$classification;const keys=Object.keys(arg);return keys.length===1&&keys[0]===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__["a"].CLASSIFICATION&&(arg===null||arg===void 0?void 0:(_arg$classification=arg.classification)===null||_arg$classification===void 0?void 0:_arg$classification.multiclass_confusion_matrix)!==undefined};let REFRESH_ANALYTICS_LIST_STATE;(function(REFRESH_ANALYTICS_LIST_STATE){REFRESH_ANALYTICS_LIST_STATE["ERROR"]="error";REFRESH_ANALYTICS_LIST_STATE["IDLE"]="idle";REFRESH_ANALYTICS_LIST_STATE["LOADING"]="loading";REFRESH_ANALYTICS_LIST_STATE["REFRESH"]="refresh"})(REFRESH_ANALYTICS_LIST_STATE||(REFRESH_ANALYTICS_LIST_STATE={}));const refreshAnalyticsList$=new rxjs__WEBPACK_IMPORTED_MODULE_1__["BehaviorSubject"](REFRESH_ANALYTICS_LIST_STATE.IDLE);const useRefreshAnalyticsList=(callback={},isManagementTable=false)=>{Object(react__WEBPACK_IMPORTED_MODULE_0__["useEffect"])(()=>{const distinct$=refreshAnalyticsList$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__["distinctUntilChanged"])());const subscriptions=[];if(typeof callback.onRefresh==="function"){if(isManagementTable)callback.onRefresh();subscriptions.push(distinct$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__["filter"])(state=>state===REFRESH_ANALYTICS_LIST_STATE.REFRESH)).subscribe(()=>{if(typeof callback.onRefresh==="function"){callback.onRefresh()}}))}if(typeof callback.isLoading==="function"){subscriptions.push(distinct$.subscribe(state=>typeof callback.isLoading==="function"&&callback.isLoading(state===REFRESH_ANALYTICS_LIST_STATE.LOADING)))}return()=>{subscriptions.map(sub=>sub.unsubscribe())}},[callback.onRefresh]);return{refresh:()=>{refreshAnalyticsList$.next(REFRESH_ANALYTICS_LIST_STATE.REFRESH);refreshAnalyticsList$.next(REFRESH_ANALYTICS_LIST_STATE.LOADING)}}};const DEFAULT_SIG_FIGS=3;const EMPTY_STAT="--";function getValuesFromResponse(response){const results={mse:EMPTY_STAT,msle:EMPTY_STAT,huber:EMPTY_STAT,r_squared:EMPTY_STAT};if(response===null||response===void 0?void 0:response.regression){for(const statType in response.regression){if(response.regression.hasOwnProperty(statType)){var _response$regression;let currentStatValue=(_response$regression=response.regression[statType])===null||_response$regression===void 0?void 0:_response$regression.value;if(currentStatValue&&!isNaN(currentStatValue)){currentStatValue=Number(currentStatValue.toPrecision(DEFAULT_SIG_FIGS))}results[statType]=currentStatValue}}}return results}function getEvalQueryBody({resultsField:resultsField,isTraining:isTraining,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery}){let query;const trainingQuery={term:{["".concat(resultsField,".is_training")]:{value:isTraining}}};const searchQueryClone=Object(lodash__WEBPACK_IMPORTED_MODULE_3__["cloneDeep"])(searchQuery);if(isResultsSearchBoolQuery(searchQueryClone)){if(searchQueryClone.bool.must===undefined){searchQueryClone.bool.must=[]}if(isTraining!==undefined){searchQueryClone.bool.must.push(trainingQuery)}query=searchQueryClone}else if(isQueryStringQuery(searchQueryClone)){query={bool:{must:[searchQueryClone]}};if(isTraining!==undefined){query.bool.must.push(trainingQuery)}}else{query={bool:{must:isTraining!==undefined?[trainingQuery]:[]}}}return query}let REGRESSION_STATS;(function(REGRESSION_STATS){REGRESSION_STATS["MSE"]="mse";REGRESSION_STATS["MSLE"]="msle";REGRESSION_STATS["R_SQUARED"]="rSquared";REGRESSION_STATS["HUBER"]="huber"})(REGRESSION_STATS||(REGRESSION_STATS={}));const loadEvalData=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee({isTraining:isTraining,index:index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:predictionFieldName,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery,jobType:jobType,requiresKeyword:requiresKeyword}){var results,defaultPredictionField,predictedField,query,metrics,config,evalResult;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:results={success:false,eval:null,error:null};defaultPredictionField="".concat(dependentVariable,"_prediction");predictedField="".concat(resultsField,".").concat(predictionFieldName?predictionFieldName:defaultPredictionField);if(jobType===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__["a"].CLASSIFICATION&&requiresKeyword===true){predictedField="".concat(predictedField,".keyword")}query=getEvalQueryBody({resultsField:resultsField,isTraining:isTraining,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery});metrics={classification:{multiclass_confusion_matrix:{}},regression:{r_squared:{},mse:{},msle:{},huber:{}}};config={index:index,query:query,evaluation:{[jobType]:{actual_field:dependentVariable,predicted_field:predictedField,metrics:metrics[jobType]}}};_context.prev=7;_context.next=10;return _services_ml_api_service__WEBPACK_IMPORTED_MODULE_4__["ml"].dataFrameAnalytics.evaluateDataFrameAnalytics(config);case 10:evalResult=_context.sent;results.success=true;results.eval=evalResult;return _context.abrupt("return",results);case 16:_context.prev=16;_context.t0=_context["catch"](7);results.error=Object(_common_util_errors__WEBPACK_IMPORTED_MODULE_5__["i"])(_context.t0);return _context.abrupt("return",results);case 20:case"end":return _context.stop()}}),_callee,null,[[7,16]])})));return function loadEvalData(_x){return _ref.apply(this,arguments)}}();const loadDocsCount=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2({ignoreDefaultQuery:ignoreDefaultQuery=true,isTraining:isTraining,searchQuery:searchQuery,resultsField:resultsField,destIndex:destIndex}){var query,body,resp,docsCount;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:query=getEvalQueryBody({resultsField:resultsField,isTraining:isTraining,ignoreDefaultQuery:ignoreDefaultQuery,searchQuery:searchQuery});_context2.prev=1;body={track_total_hits:true,query:query};_context2.next=5;return _services_ml_api_service__WEBPACK_IMPORTED_MODULE_4__["ml"].esSearch({index:destIndex,size:0,body:body});case 5:resp=_context2.sent;docsCount=resp.hits.total&&resp.hits.total.value;return _context2.abrupt("return",{docsCount:docsCount,success:docsCount!==undefined});case 10:_context2.prev=10;_context2.t0=_context2["catch"](1);return _context2.abrupt("return",{docsCount:null,success:false});case 13:case"end":return _context2.stop()}}),_callee2,null,[[1,10]])})));return function loadDocsCount(_x2){return _ref2.apply(this,arguments)}}()},57:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return mlJobService}));var external_kbnSharedDeps_Lodash_=__webpack_require__(7);var external_kbnSharedDeps_Moment_=__webpack_require__(28);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);var ml_api_service=__webpack_require__(50);var toast_notification_service=__webpack_require__(63);function relativeToAbsolute(url){const a=document.createElement("a");a.setAttribute("href",url);return a.href}function isWebUrl(url){const absoluteUrl=relativeToAbsolute(url);return/^https?:\/\//.test(absoluteUrl)}var job_utils=__webpack_require__(56);var time_format=__webpack_require__(114);var parse_interval=__webpack_require__(66);var date_utils=__webpack_require__(58);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}let jobs=[];let datafeedIds={};class job_service_JobService{constructor(){_defineProperty(this,"loadJobsWrapper",()=>this.loadJobs().then((function(resp){return resp})).catch((function(error){console.log("Error loading jobs in route resolve.",error);Promise.resolve([])})));this.tempJobCloningObjects={job:undefined,skipTimeRangeStep:false,start:undefined,end:undefined,calendars:undefined};this.jobs=[];this.basicJobs={};this.jobDescriptions={};this.detectorsByJob={};this.customUrlsByJob={};this.jobStats={activeNodes:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.jobService.activeMLNodesLabel",{defaultMessage:"Active ML nodes"}),value:0,show:true},total:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.jobService.totalJobsLabel",{defaultMessage:"Total jobs"}),value:0,show:true},open:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.jobService.openJobsLabel",{defaultMessage:"Open jobs"}),value:0,show:true},closed:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.jobService.closedJobsLabel",{defaultMessage:"Closed jobs"}),value:0,show:true},failed:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.jobService.failedJobsLabel",{defaultMessage:"Failed jobs"}),value:0,show:false},activeDatafeeds:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.jobService.activeDatafeedsLabel",{defaultMessage:"Active datafeeds"}),value:0,show:true}}}getBlankJob(){return{job_id:"",description:"",groups:[],analysis_config:{bucket_span:"15m",influencers:[],detectors:[]},data_description:{time_field:"",time_format:"",field_delimiter:"",quote_character:'"',format:"delimited"}}}loadJobs(){return new Promise((resolve,reject)=>{jobs=[];datafeedIds={};ml_api_service["ml"].getJobs().then(resp=>{jobs=resp.jobs;ml_api_service["ml"].getJobStats().then(statsResp=>{for(let i=0;i<jobs.length;i++){const job=jobs[i];job.data_counts={};job.model_size_stats={};job.datafeed_config={};for(let j=0;j<statsResp.jobs.length;j++){const jobStats=statsResp.jobs[j];if(job.job_id===jobStats.job_id){job.state=jobStats.state;job.data_counts=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(jobStats.data_counts);job.model_size_stats=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(jobStats.model_size_stats);if(jobStats.node){job.node=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(jobStats.node)}if(jobStats.open_time){job.open_time=jobStats.open_time}}}}this.loadDatafeeds().then(datafeedsResp=>{for(let i=0;i<jobs.length;i++){for(let j=0;j<datafeedsResp.datafeeds.length;j++){if(jobs[i].job_id===datafeedsResp.datafeeds[j].job_id){jobs[i].datafeed_config=datafeedsResp.datafeeds[j];datafeedIds[jobs[i].job_id]=datafeedsResp.datafeeds[j].datafeed_id}}}processBasicJobInfo(this,jobs);this.jobs=jobs;resolve({jobs:this.jobs})})}).catch(err=>{error(err)})}).catch(err=>{error(err)});function error(err){console.log("jobService error getting list of jobs:",err);Object(toast_notification_service["a"])().displayErrorToast(err);reject({jobs:jobs,err:err})}})}refreshJob(jobId){return new Promise((resolve,reject)=>{ml_api_service["ml"].getJobs({jobId:jobId}).then(resp=>{if(resp.jobs&&resp.jobs.length){const newJob=resp.jobs[0];ml_api_service["ml"].getJobStats({jobId:jobId}).then(statsResp=>{for(let j=0;j<statsResp.jobs.length;j++){if(newJob.job_id===statsResp.jobs[j].job_id){const statsJob=statsResp.jobs[j];newJob.state=statsJob.state;newJob.data_counts={};newJob.model_size_stats={};newJob.data_counts=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(statsJob.data_counts);newJob.model_size_stats=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(statsJob.model_size_stats);if(newJob.node){newJob.node=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(statsJob.node)}if(statsJob.open_time){newJob.open_time=statsJob.open_time}}}for(let i=0;i<jobs.length;i++){if(jobs[i].job_id===newJob.job_id){jobs[i]=newJob}}const datafeedId=this.getDatafeedId(jobId);this.loadDatafeeds(datafeedId).then(datafeedsResp=>{for(let i=0;i<jobs.length;i++){for(let j=0;j<datafeedsResp.datafeeds.length;j++){if(jobs[i].job_id===datafeedsResp.datafeeds[j].job_id){jobs[i].datafeed_config=datafeedsResp.datafeeds[j];datafeedIds[jobs[i].job_id]=datafeedsResp.datafeeds[j].datafeed_id}}}this.jobs=jobs;resolve({jobs:this.jobs})})}).catch(err=>{error(err)})}}).catch(err=>{error(err)});function error(err){console.log("JobService error getting list of jobs:",err);Object(toast_notification_service["a"])().displayErrorToast(err);reject({jobs:jobs,err:err})}})}loadDatafeeds(datafeedId){return new Promise((resolve,reject)=>{const sId=datafeedId!==undefined?{datafeed_id:datafeedId}:undefined;ml_api_service["ml"].getDatafeeds(sId).then(resp=>{const datafeeds=resp.datafeeds;ml_api_service["ml"].getDatafeedStats().then(statsResp=>{for(let i=0;i<datafeeds.length;i++){const datafeed=datafeeds[i];for(let j=0;j<statsResp.datafeeds.length;j++){if(datafeed.datafeed_id===statsResp.datafeeds[j].datafeed_id){datafeed.state=statsResp.datafeeds[j].state}}}resolve({datafeeds:datafeeds})}).catch(err=>{error(err)})}).catch(err=>{error(err)});function error(err){console.log("loadDatafeeds error getting list of datafeeds:",err);Object(toast_notification_service["a"])().displayErrorToast(err);reject({jobs:jobs,err:err})}})}updateSingleJobDatafeedState(jobId){return new Promise((resolve,reject)=>{const datafeedId=this.getDatafeedId(jobId);ml_api_service["ml"].getDatafeedStats({datafeedId:datafeedId}).then(resp=>{const datafeeds=resp.datafeeds;let state="UNKNOWN";if(datafeeds&&datafeeds.length){state=datafeeds[0].state}resolve(state)}).catch(resp=>{reject(resp)})})}saveNewJob(job){function func(resp){console.log("Response for job query:",resp);const success=checkSaveResponse(resp,job);return{success:success,job:job,resp:resp}}return ml_api_service["ml"].addJob({jobId:job.job_id,job:job}).then(func).catch(func)}cloneJob(job){const tempJob=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(job);delete tempJob.state;delete tempJob.job_version;delete tempJob.data_counts;delete tempJob.create_time;delete tempJob.finished_time;delete tempJob.last_data_time;delete tempJob.model_size_stats;delete tempJob.node;delete tempJob.average_bucket_processing_time_ms;delete tempJob.model_snapshot_id;delete tempJob.open_time;delete tempJob.established_model_memory;delete tempJob.calendars;delete tempJob.timing_stats;delete tempJob.forecasts_stats;delete tempJob.assignment_explanation;delete tempJob.analysis_config.use_per_partition_normalization;Object(external_kbnSharedDeps_Lodash_["each"])(tempJob.analysis_config.detectors,d=>{delete d.detector_index});if(tempJob.datafeed_config){delete tempJob.datafeed_config.datafeed_id;delete tempJob.datafeed_config.job_id;delete tempJob.datafeed_config.state;delete tempJob.datafeed_config.node;delete tempJob.datafeed_config.timing_stats;delete tempJob.datafeed_config.assignment_explanation;if(tempJob.datafeed_config.query_delay){const interval=Object(parse_interval["a"])(tempJob.datafeed_config.query_delay);if(interval!==null){const queryDelay=interval.asSeconds();if(queryDelay>60&&queryDelay<120){delete tempJob.datafeed_config.query_delay}}}}if(tempJob.custom_settings&&tempJob.custom_settings.created_by){delete tempJob.custom_settings.created_by}return tempJob}getJob(jobId){const job=Object(external_kbnSharedDeps_Lodash_["find"])(jobs,j=>j.job_id===jobId);return job}searchPreview(job){return new Promise((resolve,reject)=>{if(job.datafeed_config){let query={match_all:{}};if(job.datafeed_config.query){query=job.datafeed_config.query}ml_api_service["ml"].getTimeFieldRange({index:job.datafeed_config.indices,timeFieldName:job.data_description.time_field,query:query}).then(timeRange=>{const bucketSpan=Object(parse_interval["a"])(job.analysis_config.bucket_span);const earliestMs=timeRange.start.epoch;const latestMs=+timeRange.start.epoch+10*bucketSpan.asMilliseconds();const body={query:{bool:{must:[{range:{[job.data_description.time_field]:{gte:earliestMs,lt:latestMs,format:"epoch_millis"}}},query]}}};const aggregations=job.datafeed_config.aggs||job.datafeed_config.aggregations;if(aggregations&&Object.keys(aggregations).length){body.size=0;body.aggregations=aggregations;const scriptFields=job.datafeed_config.script_fields;if(scriptFields&&Object.keys(scriptFields).length){body.script_fields=scriptFields}}else{body.size=job_utils["a"];const scriptFields=job.datafeed_config.script_fields;if(scriptFields&&Object.keys(scriptFields).length){body.script_fields=scriptFields}const fields={};if(job.analysis_config.detectors){Object(external_kbnSharedDeps_Lodash_["each"])(job.analysis_config.detectors,dtr=>{if(dtr.by_field_name){fields[dtr.by_field_name]={}}if(dtr.field_name){fields[dtr.field_name]={}}if(dtr.over_field_name){fields[dtr.over_field_name]={}}if(dtr.partition_field_name){fields[dtr.partition_field_name]={}}})}if(job.analysis_config.influencers){Object(external_kbnSharedDeps_Lodash_["each"])(job.analysis_config.influencers,inf=>{fields[inf]={}})}if(job.analysis_config.categorization_field_name){fields[job.analysis_config.categorization_field_name]={}}if(job.analysis_config.summary_count_field_name){fields[job.analysis_config.summary_count_field_name]={}}if(job.data_description.time_field){fields[job.data_description.time_field]={}}const fieldsList=Object.keys(fields);if(fieldsList.length){body.fields=fieldsList;body._source=false}}const data=_objectSpread({index:job.datafeed_config.indices,body:body},job.datafeed_config.indices_options||{});ml_api_service["ml"].esSearch(data).then(resp=>{resolve(resp)}).catch(resp=>{reject(resp)})}).catch(resp=>{reject(resp)})}})}openJob(jobId){return ml_api_service["ml"].openJob({jobId:jobId})}closeJob(jobId){return ml_api_service["ml"].closeJob({jobId:jobId})}saveNewDatafeed(datafeedConfig,jobId){const datafeedId="datafeed-".concat(jobId);datafeedConfig.job_id=jobId;return ml_api_service["ml"].addDatafeed({datafeedId:datafeedId,datafeedConfig:datafeedConfig})}startDatafeed(datafeedId,jobId,start,end){return new Promise((resolve,reject)=>{if(Object(external_kbnSharedDeps_Lodash_["isNumber"])(end)){end++}ml_api_service["ml"].startDatafeed({datafeedId:datafeedId,start:start,end:end}).then(resp=>{resolve(resp)}).catch(err=>{console.log("jobService error starting datafeed:",err);reject(err)})})}forceStartDatafeeds(dIds,start,end){return ml_api_service["ml"].jobs.forceStartDatafeeds(dIds,start,end)}stopDatafeeds(dIds){return ml_api_service["ml"].jobs.stopDatafeeds(dIds)}deleteJobs(jIds){return ml_api_service["ml"].jobs.deleteJobs(jIds)}closeJobs(jIds){return ml_api_service["ml"].jobs.closeJobs(jIds)}validateDetector(detector){return new Promise((resolve,reject)=>{if(detector){ml_api_service["ml"].validateDetector({detector:detector}).then(resp=>{resolve(resp)}).catch(resp=>{reject(resp)})}else{reject({})}})}getDatafeedId(jobId){let datafeedId=datafeedIds[jobId];if(datafeedId===undefined){datafeedId="datafeed-".concat(jobId)}return datafeedId}getDatafeedPreview(datafeedId){return ml_api_service["ml"].datafeedPreview({datafeedId:datafeedId})}getJobGroups(){const groups=[];const tempGroups={};this.jobs.forEach(job=>{if(Array.isArray(job.groups)){job.groups.forEach(group=>{if(tempGroups[group]===undefined){tempGroups[group]=[job]}else{tempGroups[group].push(job)}})}});Object(external_kbnSharedDeps_Lodash_["each"])(tempGroups,(js,id)=>{groups.push({id:id,jobs:js})});return groups}createResultsUrlForJobs(jobsList,resultsPage,timeRange){return createResultsUrlForJobs(jobsList,resultsPage,timeRange)}createResultsUrl(jobIds,from,to,resultsPage){return createResultsUrl(jobIds,from,to,resultsPage)}getJobAndGroupIds(){return _asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return ml_api_service["ml"].jobs.getAllJobAndGroupIds();case 3:return _context.abrupt("return",_context.sent);case 6:_context.prev=6;_context.t0=_context["catch"](0);return _context.abrupt("return",{jobIds:[],groupIds:[]});case 9:case"end":return _context.stop()}}),_callee,null,[[0,6]])})))()}}function checkSaveResponse(resp,origJob){if(resp){if(resp.job_id){if(resp.job_id===origJob.job_id){console.log("checkSaveResponse(): save successful");return true}}else{if(resp.errorCode){console.log("checkSaveResponse(): save failed",resp);return false}}}else{console.log("checkSaveResponse(): response is empty");return false}}function processBasicJobInfo(localJobService,jobsList){const processedJobsList=[];const detectorsByJob={};const customUrlsByJob={};const jobsListCopy=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(jobsList);Object(external_kbnSharedDeps_Lodash_["each"])(jobsListCopy,jobObj=>{const analysisConfig=jobObj.analysis_config;const bucketSpan=Object(parse_interval["a"])(analysisConfig.bucket_span);const job={id:jobObj.job_id,bucketSpanSeconds:bucketSpan.asSeconds()};if(jobObj.description!==undefined&&/^\s*$/.test(jobObj.description)===false){job.description=jobObj.description}else{job.description=jobObj.job_id}job.detectors=Object(external_kbnSharedDeps_Lodash_["get"])(analysisConfig,"detectors",[]);detectorsByJob[job.id]=job.detectors;if(jobObj.custom_settings!==undefined&&jobObj.custom_settings.custom_urls!==undefined){job.customUrls=[];Object(external_kbnSharedDeps_Lodash_["each"])(jobObj.custom_settings.custom_urls,url=>{if(url.url_name!==undefined&&url.url_value!==undefined&&isWebUrl(url.url_value)){job.customUrls.push(url)}});if(job.customUrls.length>0){customUrlsByJob[job.id]=job.customUrls}}localJobService.jobDescriptions[job.id]=job.description;localJobService.basicJobs[job.id]=job;processedJobsList.push(job)});localJobService.detectorsByJob=detectorsByJob;localJobService.customUrlsByJob=customUrlsByJob;return processedJobsList}function createResultsUrlForJobs(jobsList,resultsPage,userTimeRange){let from=undefined;let to=undefined;let mode="absolute";const jobIds=jobsList.map(j=>j.id);if(Object(date_utils["e"])(userTimeRange)){from=userTimeRange.from;to=userTimeRange.to;const fromFieldAValidDate=external_kbnSharedDeps_Moment_default()(userTimeRange.from).isValid();const toFieldAValidDate=external_kbnSharedDeps_Moment_default()(userTimeRange.to).isValid();if(!fromFieldAValidDate&&!toFieldAValidDate){return createResultsUrl(jobIds,from,to,resultsPage,"quick")}}else{if(userTimeRange){mode="invalid"}if(jobsList.length===1){from=jobsList[0].earliestTimestampMs;to=jobsList[0].latestResultsTimestampMs}else{const jobsWithData=jobsList.filter(j=>j.earliestTimestampMs!==undefined);if(jobsWithData.length>0){from=Math.min(...jobsWithData.map(j=>j.earliestTimestampMs));to=Math.max(...jobsWithData.map(j=>j.latestResultsTimestampMs))}}}const fromString=external_kbnSharedDeps_Moment_default()(from).format(time_format["a"]);const toString=external_kbnSharedDeps_Moment_default()(to).format(time_format["a"]);return createResultsUrl(jobIds,fromString,toString,resultsPage,mode)}function createResultsUrl(jobIds,start,end,resultsPage,mode="absolute"){const idString=jobIds.map(j=>"'".concat(j,"'")).join(",");let from;let to;let path="";if(resultsPage!==undefined){path+=resultsPage}if(mode==="quick"){from=start;to=end}else{from=external_kbnSharedDeps_Moment_default()(start).toISOString();to=external_kbnSharedDeps_Moment_default()(end).toISOString()}path+="?_g=(ml:(jobIds:!(".concat(idString,"))");path+=",refreshInterval:(display:Off,pause:!t,value:0),time:(from:'".concat(from,"'");path+=",to:'".concat(to,"'");if(mode==="invalid"){path+=",mode:invalid"}path+="))&_a=(query:(query_string:(analyze_wildcard:!t,query:'*')))";return path}const mlJobService=new job_service_JobService},61:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"t",(function(){return analytics["r"]}));__webpack_require__.d(__webpack_exports__,"w",(function(){return analytics["t"]}));__webpack_require__.d(__webpack_exports__,"A",(function(){return analytics["x"]}));__webpack_require__.d(__webpack_exports__,"v",(function(){return analytics["s"]}));__webpack_require__.d(__webpack_exports__,"C",(function(){return analytics["C"]}));__webpack_require__.d(__webpack_exports__,"F",(function(){return analytics["I"]}));__webpack_require__.d(__webpack_exports__,"H",(function(){return analytics["J"]}));__webpack_require__.d(__webpack_exports__,"r",(function(){return analytics["UpdateDataFrameAnalyticsConfig"]}));__webpack_require__.d(__webpack_exports__,"k",(function(){return analytics["IndexPattern"]}));__webpack_require__.d(__webpack_exports__,"n",(function(){return analytics["i"]}));__webpack_require__.d(__webpack_exports__,"m",(function(){return analytics["h"]}));__webpack_require__.d(__webpack_exports__,"o",(function(){return analytics["RegressionEvaluateResponse"]}));__webpack_require__.d(__webpack_exports__,"B",(function(){return analytics["z"]}));__webpack_require__.d(__webpack_exports__,"E",(function(){return analytics["H"]}));__webpack_require__.d(__webpack_exports__,"D",(function(){return analytics["G"]}));__webpack_require__.d(__webpack_exports__,"h",(function(){return analytics["Eval"]}));__webpack_require__.d(__webpack_exports__,"z",(function(){return analytics["w"]}));__webpack_require__.d(__webpack_exports__,"i",(function(){return analytics["e"]}));__webpack_require__.d(__webpack_exports__,"p",(function(){return analytics["l"]}));__webpack_require__.d(__webpack_exports__,"s",(function(){return analytics["q"]}));__webpack_require__.d(__webpack_exports__,"q",(function(){return analytics["SearchQuery"]}));__webpack_require__.d(__webpack_exports__,"a",(function(){return analytics["b"]}));__webpack_require__.d(__webpack_exports__,"u",(function(){return common_fields["j"]}));__webpack_require__.d(__webpack_exports__,"G",(function(){return common_fields["l"]}));__webpack_require__.d(__webpack_exports__,"g",(function(){return common_fields["EsId"]}));__webpack_require__.d(__webpack_exports__,"d",(function(){return common_fields["EsDoc"]}));__webpack_require__.d(__webpack_exports__,"e",(function(){return common_fields["EsDocSource"]}));__webpack_require__.d(__webpack_exports__,"f",(function(){return common_fields["EsFieldName"]}));__webpack_require__.d(__webpack_exports__,"l",(function(){return common_fields["g"]}));__webpack_require__.d(__webpack_exports__,"x",(function(){return getIndexData}));__webpack_require__.d(__webpack_exports__,"y",(function(){return getIndexFields}));__webpack_require__.d(__webpack_exports__,"I",(function(){return useResultsViewConfig}));__webpack_require__.d(__webpack_exports__,"b",(function(){return data_frame_analytics["DataFrameAnalyticsConfig"]}));__webpack_require__.d(__webpack_exports__,"c",(function(){return data_frame_analytics["DataFrameAnalyticsId"]}));__webpack_require__.d(__webpack_exports__,"j",(function(){return data_frame_analytics["IndexName"]}));var analytics=__webpack_require__(54);var common_fields=__webpack_require__(79);var errors=__webpack_require__(64);var data_grid=__webpack_require__(108);var ml_api_service=__webpack_require__(50);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const getIndexData=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(jobConfig,dataGrid,searchQuery,options){var pagination,setErrorMessage,setRowCount,setStatus,setTableItems,sortingColumns,sort,pageIndex,pageSize,resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(jobConfig!==undefined)){_context.next=17;break}pagination=dataGrid.pagination,setErrorMessage=dataGrid.setErrorMessage,setRowCount=dataGrid.setRowCount,setStatus=dataGrid.setStatus,setTableItems=dataGrid.setTableItems,sortingColumns=dataGrid.sortingColumns;setErrorMessage("");setStatus(analytics["e"].LOADING);_context.prev=4;sort=sortingColumns.map(column=>{const id=column.id;column.id=Object(common_fields["k"])(id)?"".concat(id,".keyword"):id;return column}).reduce((s,column)=>{s[column.id]={order:column.direction};return s},{});pageIndex=pagination.pageIndex,pageSize=pagination.pageSize;_context.next=9;return ml_api_service["ml"].esSearch({index:jobConfig.dest.index,body:_objectSpread({fields:["*"],_source:false,query:searchQuery,from:pageIndex*pageSize,size:pageSize},Object.keys(sort).length>0?{sort:sort}:{})});case 9:resp=_context.sent;if(!options.didCancel){setRowCount(resp.hits.total.value);setTableItems(resp.hits.hits.map(d=>Object(data_grid["l"])(d.fields,key=>key.startsWith("".concat(jobConfig.dest.results_field,".feature_importance")))));setStatus(analytics["e"].LOADED)}_context.next=17;break;case 13:_context.prev=13;_context.t0=_context["catch"](4);setErrorMessage(Object(errors["i"])(_context.t0));setStatus(analytics["e"].ERROR);case 17:case"end":return _context.stop()}}),_callee,null,[[4,13]])})));return function getIndexData(_x,_x2,_x3,_x4){return _ref.apply(this,arguments)}}();var new_job_capabilities_service=__webpack_require__(65);const getIndexFields=(jobConfig,needsDestIndexFields)=>{const fields=new_job_capabilities_service["b"].fields;if(jobConfig!==undefined){const _getDefaultFieldsFrom=Object(common_fields["j"])(fields,jobConfig,needsDestIndexFields),defaultSelected=_getDefaultFieldsFrom.selectedFields,docFields=_getDefaultFieldsFrom.docFields;const types={};const allFields=[];docFields.forEach(field=>{types[field.id]=field.type;allFields.push(field.id)});return{defaultSelectedFields:defaultSelected.map(field=>field.id),fieldTypes:types,tableFields:allFields}}else{return{defaultSelectedFields:[],fieldTypes:{},tableFields:[]}}};var external_kbnSharedDeps_React_=__webpack_require__(10);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);var index_utils=__webpack_require__(71);var ml=__webpack_require__(74);var get_analytics=__webpack_require__(142);var trained_models=__webpack_require__(203);var toast_notification_service=__webpack_require__(63);var analytics_utils=__webpack_require__(86);function use_results_view_config_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_results_view_config_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_results_view_config_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_results_view_config_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useResultsViewConfig=jobId=>{const mlContext=Object(ml["b"])();const trainedModelsApiService=Object(trained_models["a"])();const _useState=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState2=_slicedToArray(_useState,2),indexPattern=_useState2[0],setIndexPattern=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState4=_slicedToArray(_useState3,2),indexPatternErrorMessage=_useState4[0],setIndexPatternErrorMessage=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=_slicedToArray(_useState5,2),isInitialized=_useState6[0],setIsInitialized=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(false),_useState8=_slicedToArray(_useState7,2),needsDestIndexPattern=_useState8[0],setNeedsDestIndexPattern=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])(false),_useState10=_slicedToArray(_useState9,2),isLoadingJobConfig=_useState10[0],setIsLoadingJobConfig=_useState10[1];const _useState11=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState12=_slicedToArray(_useState11,2),jobConfig=_useState12[0],setJobConfig=_useState12[1];const _useState13=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState14=_slicedToArray(_useState13,2),jobCapsServiceErrorMessage=_useState14[0],setJobCapsServiceErrorMessage=_useState14[1];const _useState15=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState16=_slicedToArray(_useState15,2),jobConfigErrorMessage=_useState16[0],setJobConfigErrorMessage=_useState16[1];const _useState17=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState18=_slicedToArray(_useState17,2),jobStatus=_useState18[0],setJobStatus=_useState18[1];const _useState19=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState20=_slicedToArray(_useState19,2),totalFeatureImportance=_useState20[0],setTotalFeatureImportance=_useState20[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{use_results_view_config_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var analyticsConfigs,analyticsStats,stats,jobConfigUpdate,_inferenceModel$metad,inferenceModels,inferenceModel,_inferenceModel$metad2,destIndex,destIndexPatternId,indexP,sourceIndex,sourceIndexPatternId;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoadingJobConfig(false);_context.prev=1;_context.next=4;return ml_api_service["ml"].dataFrameAnalytics.getDataFrameAnalytics(jobId);case 4:analyticsConfigs=_context.sent;_context.next=7;return ml_api_service["ml"].dataFrameAnalytics.getDataFrameAnalyticsStats(jobId);case 7:analyticsStats=_context.sent;stats=Object(get_analytics["b"])(analyticsStats)?analyticsStats.data_frame_analytics[0]:undefined;if(stats!==undefined&&stats.state){setJobStatus(stats.state)}if(!(Array.isArray(analyticsConfigs.data_frame_analytics)&&analyticsConfigs.data_frame_analytics.length>0)){_context.next=65;break}jobConfigUpdate=analyticsConfigs.data_frame_analytics[0];if(!(Object(analytics_utils["f"])(jobConfigUpdate.analysis)||Object(analytics_utils["h"])(jobConfigUpdate.analysis))){_context.next=24;break}_context.prev=13;_context.next=16;return trainedModelsApiService.getTrainedModels("".concat(jobId,"*"),{include:"total_feature_importance"});case 16:inferenceModels=_context.sent;inferenceModel=inferenceModels.find(model=>{var _model$metadata,_model$metadata$analy;return((_model$metadata=model.metadata)===null||_model$metadata===void 0?void 0:(_model$metadata$analy=_model$metadata.analytics_config)===null||_model$metadata$analy===void 0?void 0:_model$metadata$analy.id)===jobId});if(Array.isArray(inferenceModel===null||inferenceModel===void 0?void 0:(_inferenceModel$metad=inferenceModel.metadata)===null||_inferenceModel$metad===void 0?void 0:_inferenceModel$metad.total_feature_importance)===true){setTotalFeatureImportance(inferenceModel===null||inferenceModel===void 0?void 0:(_inferenceModel$metad2=inferenceModel.metadata)===null||_inferenceModel$metad2===void 0?void 0:_inferenceModel$metad2.total_feature_importance)}_context.next=24;break;case 21:_context.prev=21;_context.t0=_context["catch"](13);Object(toast_notification_service["a"])().displayErrorToast(_context.t0);case 24:_context.prev=24;destIndex=Array.isArray(jobConfigUpdate.dest.index)?jobConfigUpdate.dest.index[0]:jobConfigUpdate.dest.index;destIndexPatternId=Object(index_utils["c"])(destIndex)||destIndex;_context.prev=27;_context.next=30;return mlContext.indexPatterns.get(destIndexPatternId);case 30:indexP=_context.sent;_context.next=36;break;case 33:_context.prev=33;_context.t1=_context["catch"](27);indexP=undefined;case 36:if(!(indexP===undefined)){_context.next=49;break}setNeedsDestIndexPattern(true);sourceIndex=jobConfigUpdate.source.index[0];sourceIndexPatternId=Object(index_utils["c"])(sourceIndex)||sourceIndex;_context.prev=40;_context.next=43;return mlContext.indexPatterns.get(sourceIndexPatternId);case 43:indexP=_context.sent;_context.next=49;break;case 46:_context.prev=46;_context.t2=_context["catch"](40);indexP=undefined;case 49:if(!(indexP!==undefined)){_context.next=58;break}_context.next=52;return new_job_capabilities_service["b"].initializeFromIndexPattern(indexP,false,false);case 52:setJobConfig(analyticsConfigs.data_frame_analytics[0]);setIndexPattern(indexP);setIsInitialized(true);setIsLoadingJobConfig(false);_context.next=59;break;case 58:setIndexPatternErrorMessage(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.dataframe.analytics.results.indexPatternsMissingErrorMessage",{defaultMessage:"To view this page, a Kibana index pattern is necessary for either the destination or source index of this analytics job."}));case 59:_context.next=65;break;case 61:_context.prev=61;_context.t3=_context["catch"](24);setJobCapsServiceErrorMessage(Object(errors["i"])(_context.t3));setIsLoadingJobConfig(false);case 65:_context.next=71;break;case 67:_context.prev=67;_context.t4=_context["catch"](1);setJobConfigErrorMessage(Object(errors["i"])(_context.t4));setIsLoadingJobConfig(false);case 71:case"end":return _context.stop()}}),_callee,null,[[1,67],[13,21],[24,61],[27,33],[40,46]])})))()},[]);return{indexPattern:indexPattern,indexPatternErrorMessage:indexPatternErrorMessage,isInitialized:isInitialized,isLoadingJobConfig:isLoadingJobConfig,jobCapsServiceErrorMessage:jobCapsServiceErrorMessage,jobConfig:jobConfig,jobConfigErrorMessage:jobConfigErrorMessage,jobStatus:jobStatus,needsDestIndexPattern:needsDestIndexPattern,totalFeatureImportance:totalFeatureImportance}};var data_frame_analytics=__webpack_require__(129)},63:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return toastNotificationServiceProvider}));__webpack_require__.d(__webpack_exports__,"c",(function(){return useToastNotificationService}));__webpack_require__.d(__webpack_exports__,"a",(function(){return getToastNotificationService}));var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);var external_kbnSharedDeps_React_=__webpack_require__(10);var dependency_cache=__webpack_require__(16);var kibana=__webpack_require__(51);var errors=__webpack_require__(64);function toastNotificationServiceProvider(toastNotifications){function displayDangerToast(toastOrTitle,options){toastNotifications.addDanger(toastOrTitle,options)}function displayWarningToast(toastOrTitle,options){toastNotifications.addWarning(toastOrTitle,options)}function displaySuccessToast(toastOrTitle,options){toastNotifications.addSuccess(toastOrTitle,options)}function displayErrorToast(error,title){const errorObj=Object(errors["j"])(error);toastNotifications.addError(new errors["g"](errorObj,error),{title:title!==null&&title!==void 0?title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.toastNotificationService.errorTitle",{defaultMessage:"An error has occurred"})})}return{displayDangerToast:displayDangerToast,displayWarningToast:displayWarningToast,displaySuccessToast:displaySuccessToast,displayErrorToast:displayErrorToast}}function getToastNotificationService(){const toastNotifications=Object(dependency_cache["l"])();return toastNotificationServiceProvider(toastNotifications)}function useToastNotificationService(){const _useNotifications=Object(kibana["e"])(),toasts=_useNotifications.toasts;return Object(external_kbnSharedDeps_React_["useMemo"])(()=>toastNotificationServiceProvider(toasts),[])}},64:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",(function(){return MLRequestFailure}));__webpack_require__.d(__webpack_exports__,"i",(function(){return extractErrorMessage}));__webpack_require__.d(__webpack_exports__,"j",(function(){return extractErrorProperties}));__webpack_require__.d(__webpack_exports__,"b",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"a",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"c",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"d",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"e",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"f",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"h",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"k",(function(){return isBoomError}));__webpack_require__.d(__webpack_exports__,"l",(function(){return isErrorString}));__webpack_require__.d(__webpack_exports__,"m",(function(){return isEsErrorBody}));__webpack_require__.d(__webpack_exports__,"n",(function(){return isMLResponseError}));class MLRequestFailure extends Error{constructor(error,resp){super(error.message);Object.setPrototypeOf(this,new.target.prototype);if(typeof resp!=="string"&&typeof resp!=="undefined"){if("body"in resp){this.stack=JSON.stringify(resp.body,null,2)}else{try{this.stack=JSON.stringify(resp,null,2)}catch(e){}}}}}function isEsErrorBody(error){var _error$error;return error&&((_error$error=error.error)===null||_error$error===void 0?void 0:_error$error.reason)!==undefined}function isErrorString(error){return typeof error==="string"}function isErrorMessage(error){return error&&error.message!==undefined&&typeof error.message==="string"}function isMLResponseError(error){return typeof error.body==="object"&&"message"in error.body}function isBoomError(error){return error.isBoom===true}const extractErrorProperties=error=>{if(isEsErrorBody(error)){return{message:error.error.reason,statusCode:error.status,fullError:error}}if(isErrorString(error)){return{message:error}}if(isBoomError(error)){return{message:error.output.payload.message,statusCode:error.output.payload.statusCode}}if((error===null||error===void 0?void 0:error.body)===undefined&&!(error===null||error===void 0?void 0:error.message)){return{message:""}}if(typeof error.body==="string"){return{message:error.body}}if(isMLResponseError(error)){var _error$body$attribute,_error$body$attribute2;if(typeof error.body.attributes==="object"&&typeof((_error$body$attribute=error.body.attributes.body)===null||_error$body$attribute===void 0?void 0:(_error$body$attribute2=_error$body$attribute.error)===null||_error$body$attribute2===void 0?void 0:_error$body$attribute2.reason)==="string"){return{message:error.body.attributes.body.error.reason,statusCode:error.body.statusCode,fullError:error.body.attributes.body}}else{return{message:error.body.message,statusCode:error.body.statusCode}}}if(isErrorMessage(error)){return{message:error.message}}return{message:""}};const extractErrorMessage=error=>{const errorObj=extractErrorProperties(error);return errorObj.message}},65:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return loadNewJobCapabilities}));__webpack_require__.d(__webpack_exports__,"b",(function(){return newJobCapsService}));var _common_types_fields__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(104);var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(30);var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__);var _ml_api_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(50);var _util_index_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(71);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function loadNewJobCapabilities(indexPatternId,savedSearchId,indexPatterns){return new Promise(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(resolve,reject){var indexPattern,_yield$getIndexPatter;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(indexPatternId!==undefined)){_context.next=9;break}_context.next=3;return indexPatterns.get(indexPatternId);case 3:indexPattern=_context.sent;_context.next=6;return newJobCapsService.initializeFromIndexPattern(indexPattern);case 6:resolve(newJobCapsService.newJobCaps);_context.next=24;break;case 9:if(!(savedSearchId!==undefined)){_context.next=23;break}_context.next=12;return Object(_util_index_utils__WEBPACK_IMPORTED_MODULE_3__["a"])(savedSearchId);case 12:_yield$getIndexPatter=_context.sent;indexPattern=_yield$getIndexPatter.indexPattern;if(!(indexPattern===null)){_context.next=18;break}console.error("Cannot retrieve index pattern from saved search");reject();return _context.abrupt("return");case 18:_context.next=20;return newJobCapsService.initializeFromIndexPattern(indexPattern);case 20:resolve(newJobCapsService.newJobCaps);_context.next=24;break;case 23:reject();case 24:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref.apply(this,arguments)}}())}const categoryFieldTypes=[_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].TEXT,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].KEYWORD,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].IP];class NewJobCapsService{constructor(){_defineProperty(this,"_fields",[]);_defineProperty(this,"_catFields",[]);_defineProperty(this,"_dateFields",[]);_defineProperty(this,"_aggs",[]);_defineProperty(this,"_includeEventRateField",true);_defineProperty(this,"_removeTextFields",true)}get fields(){return this._fields}get catFields(){return this._catFields}get dateFields(){return this._dateFields}get aggs(){return this._aggs}get newJobCaps(){return{fields:this._fields,aggs:this._aggs}}get categoryFields(){return this._fields.filter(f=>categoryFieldTypes.includes(f.type))}initializeFromIndexPattern(indexPattern,includeEventRateField=true,removeTextFields=true){var _this=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var resp,_createObjects,allFields,aggs,_processTextAndKeywor,fieldsPreferringKeyword,fieldsPreferringText,catFields,dateFields,fields;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_this._includeEventRateField=includeEventRateField;_this._removeTextFields=removeTextFields;_context2.next=5;return _ml_api_service__WEBPACK_IMPORTED_MODULE_2__["ml"].jobs.newJobCaps(indexPattern.title,indexPattern.type==="rollup");case 5:resp=_context2.sent;_createObjects=createObjects(resp,indexPattern.title),allFields=_createObjects.fields,aggs=_createObjects.aggs;if(_this._includeEventRateField===true){addEventRateField(aggs,allFields)}_processTextAndKeywor=processTextAndKeywordFields(allFields),fieldsPreferringKeyword=_processTextAndKeywor.fieldsPreferringKeyword,fieldsPreferringText=_processTextAndKeywor.fieldsPreferringText;catFields=fieldsPreferringText.filter(f=>f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].KEYWORD||f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].TEXT);dateFields=fieldsPreferringText.filter(f=>f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].DATE);fields=_this._removeTextFields?fieldsPreferringKeyword:allFields;_this._fields=fields;_this._catFields=catFields;_this._dateFields=dateFields;_this._aggs=aggs;_context2.next=21;break;case 18:_context2.prev=18;_context2.t0=_context2["catch"](0);console.error("Unable to load new job capabilities",_context2.t0);case 21:case"end":return _context2.stop()}}),_callee2,null,[[0,18]])})))()}getFieldById(id){const field=this._fields.find(f=>f.id===id);return field===undefined?null:field}getAggById(id){const agg=this._aggs.find(f=>f.id===id);return agg===undefined?null:agg}}function createObjects(resp,indexPatternTitle){const results=resp[indexPatternTitle];const fields=[];const aggs=[];const aggMap={};const aggIdMap={};if(results!==undefined){results.aggs.forEach(a=>{const agg=_objectSpread(_objectSpread({},a),a.fieldIds!==undefined?{fields:[]}:{});aggMap[agg.id]=agg;aggs.push(agg)});results.fields.forEach(f=>{const field=_objectSpread(_objectSpread({},f),{},{aggs:[]});if(field.aggIds!==undefined){aggIdMap[field.id]=field.aggIds}fields.push(field)});fields.forEach(field=>{aggIdMap[field.id].forEach(aggId=>{mix(field,aggMap[aggId])})})}fields.forEach(f=>delete f.aggIds);aggs.forEach(a=>delete a.fieldIds);return{fields:fields,aggs:aggs}}function mix(field,agg){if(agg.fields===undefined){agg.fields=[]}if(field.aggs===undefined){field.aggs=[]}agg.fields.push(field);field.aggs.push(agg)}function addEventRateField(aggs,fields){const eventRateField={id:_common_types_fields__WEBPACK_IMPORTED_MODULE_0__["a"],name:"Event rate",type:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].INTEGER,aggregatable:true,aggs:[]};aggs.forEach(a=>{if(eventRateField.aggs!==undefined&&a.fields===undefined){a.fields=[eventRateField];eventRateField.aggs.push(a)}});fields.splice(0,0,eventRateField)}function processTextAndKeywordFields(fields){const keywordIds=fields.filter(f=>f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].KEYWORD).map(f=>f.id);const textIds=fields.filter(f=>f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].TEXT).map(f=>f.id);const fieldsPreferringKeyword=fields.filter(f=>f.type!==_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].TEXT||f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].TEXT&&keywordIds.includes("".concat(f.id,".keyword"))===false);const fieldsPreferringText=fields.filter(f=>f.type!==_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].KEYWORD||f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["ES_FIELD_TYPES"].KEYWORD&&textIds.includes(f.id.replace(/\.keyword$/,""))===false);return{fieldsPreferringKeyword:fieldsPreferringKeyword,fieldsPreferringText:fieldsPreferringText}}const newJobCapsService=new NewJobCapsService},70:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ANALYSIS_CONFIG_TYPE}));__webpack_require__.d(__webpack_exports__,"b",(function(){return DEFAULT_RESULTS_FIELD}));__webpack_require__.d(__webpack_exports__,"c",(function(){return JOB_MAP_NODE_TYPES}));const ANALYSIS_CONFIG_TYPE={OUTLIER_DETECTION:"outlier_detection",REGRESSION:"regression",CLASSIFICATION:"classification"};const DEFAULT_RESULTS_FIELD="ml";const JOB_MAP_NODE_TYPES={ANALYTICS:"analytics",TRANSFORM:"transform",INDEX:"index",TRAINED_MODEL:"trainedModel"}},71:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",(function(){return loadIndexPatterns}));__webpack_require__.d(__webpack_exports__,"h",(function(){return loadSavedSearches}));__webpack_require__.d(__webpack_exports__,"e",(function(){return getIndexPatternsContract}));__webpack_require__.d(__webpack_exports__,"d",(function(){return getIndexPatternNames}));__webpack_require__.d(__webpack_exports__,"c",(function(){return getIndexPatternIdFromName}));__webpack_require__.d(__webpack_exports__,"a",(function(){return getIndexPatternAndSavedSearch}));__webpack_require__.d(__webpack_exports__,"f",(function(){return getQueryFromSavedSearch}));__webpack_require__.d(__webpack_exports__,"b",(function(){return getIndexPatternById}));__webpack_require__.d(__webpack_exports__,"i",(function(){return timeBasedIndexCheck}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);var _dependency_cache__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(16);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}let indexPatternCache=[];let savedSearchesCache=[];let indexPatternsContract=null;function loadIndexPatterns(indexPatterns){indexPatternsContract=indexPatterns;const savedObjectsClient=Object(_dependency_cache__WEBPACK_IMPORTED_MODULE_1__["j"])();return savedObjectsClient.find({type:"index-pattern",fields:["id","title","type","fields"],perPage:1e4}).then(response=>{indexPatternCache=response.savedObjects;return indexPatternCache})}function loadSavedSearches(){const savedObjectsClient=Object(_dependency_cache__WEBPACK_IMPORTED_MODULE_1__["j"])();return savedObjectsClient.find({type:"search",perPage:1e4}).then(response=>{savedSearchesCache=response.savedObjects;return savedSearchesCache})}function loadSavedSearchById(_x){return _loadSavedSearchById.apply(this,arguments)}function _loadSavedSearchById(){_loadSavedSearchById=_asyncToGenerator(regeneratorRuntime.mark((function _callee(id){var savedObjectsClient,ss;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:savedObjectsClient=Object(_dependency_cache__WEBPACK_IMPORTED_MODULE_1__["j"])();_context.next=3;return savedObjectsClient.get("search",id);case 3:ss=_context.sent;return _context.abrupt("return",ss.error===undefined?ss:null);case 5:case"end":return _context.stop()}}),_callee)})));return _loadSavedSearchById.apply(this,arguments)}function getIndexPatterns(){return indexPatternCache}function getIndexPatternsContract(){return indexPatternsContract}function getIndexPatternNames(){return indexPatternCache.map(i=>i.attributes&&i.attributes.title)}function getIndexPatternIdFromName(name){for(let j=0;j<indexPatternCache.length;j++){if(indexPatternCache[j].get("title")===name){return indexPatternCache[j].id}}return null}function getIndexPatternAndSavedSearch(_x2){return _getIndexPatternAndSavedSearch.apply(this,arguments)}function _getIndexPatternAndSavedSearch(){_getIndexPatternAndSavedSearch=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(savedSearchId){var _ss$references$find;var resp,ss,indexPatternId;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:resp={savedSearch:null,indexPattern:null};if(!(savedSearchId===undefined)){_context2.next=3;break}return _context2.abrupt("return",resp);case 3:_context2.next=5;return loadSavedSearchById(savedSearchId);case 5:ss=_context2.sent;if(!(ss===null)){_context2.next=8;break}return _context2.abrupt("return",resp);case 8:indexPatternId=(_ss$references$find=ss.references.find(r=>r.type==="index-pattern"))===null||_ss$references$find===void 0?void 0:_ss$references$find.id;_context2.next=11;return getIndexPatternById(indexPatternId);case 11:resp.indexPattern=_context2.sent;resp.savedSearch=ss;return _context2.abrupt("return",resp);case 14:case"end":return _context2.stop()}}),_callee2)})));return _getIndexPatternAndSavedSearch.apply(this,arguments)}function getQueryFromSavedSearch(savedSearch){const search=savedSearch.attributes.kibanaSavedObjectMeta;return JSON.parse(search.searchSourceJSON)}function getIndexPatternById(id){if(indexPatternsContract!==null){if(id){return indexPatternsContract.get(id)}else{return indexPatternsContract.create({})}}else{throw new Error("Index patterns are not initialized!")}}function getSavedSearchById(id){return savedSearchesCache.find(s=>s.id===id)}function timeBasedIndexCheck(indexPattern,showNotification=false){if(!indexPattern.isTimeBased()){if(showNotification){const toastNotifications=Object(_dependency_cache__WEBPACK_IMPORTED_MODULE_1__["l"])();toastNotifications.addWarning({title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.indexPatternNotBasedOnTimeSeriesNotificationTitle",{defaultMessage:"The index pattern {indexPatternTitle} is not based on a time series",values:{indexPatternTitle:indexPattern.title}}),text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.ml.indexPatternNotBasedOnTimeSeriesNotificationDescription",{defaultMessage:"Anomaly detection only runs over time-based indices"})})}return false}else{return true}}},74:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MlContext}));__webpack_require__.d(__webpack_exports__,"b",(function(){return useMlContext}));var external_kbnSharedDeps_React_=__webpack_require__(10);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);const MlContext=external_kbnSharedDeps_React_default.a.createContext({});const useMlContext=()=>{const context=Object(external_kbnSharedDeps_React_["useContext"])(MlContext);if(context.combinedQuery===undefined||context.currentIndexPattern===undefined||context.currentSavedSearch===undefined||context.indexPatterns===undefined||context.kibanaConfig===undefined){throw new Error("required attribute is undefined")}return context}},78:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return DATA_FRAME_TASK_STATE}));__webpack_require__.d(__webpack_exports__,"a",(function(){return DATA_FRAME_MODE}));__webpack_require__.d(__webpack_exports__,"f",(function(){return isDataFrameAnalyticsFailed}));__webpack_require__.d(__webpack_exports__,"g",(function(){return isDataFrameAnalyticsRunning}));__webpack_require__.d(__webpack_exports__,"i",(function(){return isDataFrameAnalyticsStopped}));__webpack_require__.d(__webpack_exports__,"h",(function(){return isDataFrameAnalyticsStats}));__webpack_require__.d(__webpack_exports__,"d",(function(){return getDataFrameAnalyticsProgressPhase}));__webpack_require__.d(__webpack_exports__,"c",(function(){return DataFrameAnalyticsListColumn}));__webpack_require__.d(__webpack_exports__,"e",(function(){return isCompletedAnalyticsJob}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(26);let DATA_FRAME_TASK_STATE;(function(DATA_FRAME_TASK_STATE){DATA_FRAME_TASK_STATE["ANALYZING"]="analyzing";DATA_FRAME_TASK_STATE["FAILED"]="failed";DATA_FRAME_TASK_STATE["REINDEXING"]="reindexing";DATA_FRAME_TASK_STATE["STARTED"]="started";DATA_FRAME_TASK_STATE["STARTING"]="starting";DATA_FRAME_TASK_STATE["STOPPED"]="stopped"})(DATA_FRAME_TASK_STATE||(DATA_FRAME_TASK_STATE={}));function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}let DATA_FRAME_MODE;(function(DATA_FRAME_MODE){DATA_FRAME_MODE["BATCH"]="batch";DATA_FRAME_MODE["CONTINUOUS"]="continuous"})(DATA_FRAME_MODE||(DATA_FRAME_MODE={}));function isDataFrameAnalyticsFailed(state){return state===DATA_FRAME_TASK_STATE.FAILED}function isDataFrameAnalyticsRunning(state){return state===DATA_FRAME_TASK_STATE.ANALYZING||state===DATA_FRAME_TASK_STATE.REINDEXING||state===DATA_FRAME_TASK_STATE.STARTED||state===DATA_FRAME_TASK_STATE.STARTING}function isDataFrameAnalyticsStopped(state){return state===DATA_FRAME_TASK_STATE.STOPPED}function isDataFrameAnalyticsStats(arg){return typeof arg==="object"&&arg!==null&&{}.hasOwnProperty.call(arg,"state")&&Object.values(DATA_FRAME_TASK_STATE).includes(arg.state)&&{}.hasOwnProperty.call(arg,"progress")&&Array.isArray(arg.progress)}function getDataFrameAnalyticsProgress(stats){if(isDataFrameAnalyticsStats(stats)){return Math.round(stats.progress.reduce((p,c)=>p+c.progress_percent,0)/stats.progress.length)}return undefined}function getDataFrameAnalyticsProgressPhase(stats){let phase=0;let progress=0;var _iterator=_createForOfIteratorHelper(stats.progress),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){const progressPhase=_step.value;phase++;progress=progressPhase.progress_percent;if(progressPhase.progress_percent<100){break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return{currentPhase:phase,progress:progress,totalPhases:stats.progress.length}}const DataFrameAnalyticsListColumn={configDestIndex:"config.dest.index",configSourceIndex:"config.source.index",configCreateTime:"config.create_time",description:"config.description",id:"id",memoryStatus:"stats.memory_usage.status"};function isCompletedAnalyticsJob(stats){const progress=getDataFrameAnalyticsProgress(stats);return stats.state===DATA_FRAME_TASK_STATE.STOPPED&&progress===100}},79:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",(function(){return MAX_COLUMNS}));__webpack_require__.d(__webpack_exports__,"a",(function(){return BASIC_NUMERICAL_TYPES}));__webpack_require__.d(__webpack_exports__,"b",(function(){return EXTENDED_NUMERICAL_TYPES}));__webpack_require__.d(__webpack_exports__,"h",(function(){return ML__ID_COPY}));__webpack_require__.d(__webpack_exports__,"i",(function(){return ML__INCREMENTAL_ID}));__webpack_require__.d(__webpack_exports__,"k",(function(){return isKeywordAndTextType}));__webpack_require__.d(__webpack_exports__,"l",(function(){return sortExplorationResultsFields}));__webpack_require__.d(__webpack_exports__,"j",(function(){return getDefaultFieldsFromJobCaps}));var _analytics__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(54);var _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86);var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(30);var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__);var _services_new_job_capabilities_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(65);var _constants__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(127);const MAX_COLUMNS=10;const DEFAULT_REGRESSION_COLUMNS=8;const BASIC_NUMERICAL_TYPES=new Set([_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].UNSIGNED_LONG,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].LONG,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].INTEGER,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].SHORT,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].BYTE]);const EXTENDED_NUMERICAL_TYPES=new Set([_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].DOUBLE,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].FLOAT,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].HALF_FLOAT,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].SCALED_FLOAT]);const ML__ID_COPY="ml__id_copy";const ML__INCREMENTAL_ID="ml__incremental_id";const isKeywordAndTextType=fieldName=>{var _fields$find;const fields=_services_new_job_capabilities_service__WEBPACK_IMPORTED_MODULE_3__["b"].fields;const fieldType=(_fields$find=fields.find(field=>field.name===fieldName))===null||_fields$find===void 0?void 0:_fields$find.type;let isBothTypes=false;if(fieldType!==undefined&&fieldType===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].KEYWORD){const field=_services_new_job_capabilities_service__WEBPACK_IMPORTED_MODULE_3__["b"].getFieldById(fieldName.replace(/\.keyword$/,""));isBothTypes=field!==null&&field.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].TEXT}else if(fieldType!==undefined&&fieldType===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].TEXT){const field=_services_new_job_capabilities_service__WEBPACK_IMPORTED_MODULE_3__["b"].getFieldById("".concat(fieldName,".keyword"));isBothTypes=field!==null&&field.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].KEYWORD}return isBothTypes};const sortExplorationResultsFields=(a,b,jobConfig)=>{const resultsField=jobConfig.dest.results_field;if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__["g"])(jobConfig.analysis)){if(a==="".concat(resultsField,".").concat(_constants__WEBPACK_IMPORTED_MODULE_4__["c"])){return-1}if(b==="".concat(resultsField,".").concat(_constants__WEBPACK_IMPORTED_MODULE_4__["c"])){return 1}}if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__["f"])(jobConfig.analysis)||Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__["h"])(jobConfig.analysis)){const dependentVariable=Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__["c"])(jobConfig.analysis);const predictedField=Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__["d"])(resultsField,jobConfig.analysis,true);if(a==="".concat(resultsField,".is_training")){return-1}if(b==="".concat(resultsField,".is_training")){return 1}if(a===predictedField){return-1}if(b===predictedField){return 1}if(a===dependentVariable||a===dependentVariable.replace(/\.keyword$/,"")){return-1}if(b===dependentVariable||b===dependentVariable.replace(/\.keyword$/,"")){return 1}if(a==="".concat(resultsField,".prediction_probability")){return-1}if(b==="".concat(resultsField,".prediction_probability")){return 1}}const typeofA=typeof a;const typeofB=typeof b;const tokensA=a.split(".");const prefixA=tokensA[0];const tokensB=b.split(".");const prefixB=tokensB[0];if(prefixA===resultsField&&tokensA.length>1&&prefixB!==resultsField){tokensA.shift();tokensA.shift();if(tokensA.join(".")===b)return 1;return tokensA.join(".").localeCompare(b)}if(prefixB===resultsField&&tokensB.length>1&&prefixA!==resultsField){tokensB.shift();tokensB.shift();if(tokensB.join(".")===a)return-1;return a.localeCompare(tokensB.join("."))}if(typeofA!=="string"&&typeofB==="string"){return 1}if(typeofA==="string"&&typeofB!=="string"){return-1}if(typeofA==="string"&&typeofB==="string"){return a.localeCompare(b)}return a.localeCompare(b)};const getDefaultFieldsFromJobCaps=(fields,jobConfig,needsDestIndexFields)=>{const fieldsObj={selectedFields:[],docFields:[]};if(fields.length===0){return fieldsObj}const resultsField=jobConfig.dest.results_field;const featureImportanceFields=[];const topClassesFields=[];const allFields=[];let type;let predictedField;if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__["g"])(jobConfig.analysis)){if(needsDestIndexFields===true){allFields.push({id:"".concat(resultsField,".").concat(_constants__WEBPACK_IMPORTED_MODULE_4__["c"]),name:"".concat(resultsField,".").concat(_constants__WEBPACK_IMPORTED_MODULE_4__["c"]),type:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["KBN_FIELD_TYPES"].NUMBER})}}if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__["f"])(jobConfig.analysis)||Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__["h"])(jobConfig.analysis)){var _newJobCapsService$ge;const dependentVariable=Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__["c"])(jobConfig.analysis);type=(_newJobCapsService$ge=_services_new_job_capabilities_service__WEBPACK_IMPORTED_MODULE_3__["b"].getFieldById(dependentVariable))===null||_newJobCapsService$ge===void 0?void 0:_newJobCapsService$ge.type;const predictionFieldName=Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__["e"])(jobConfig.analysis);const numTopFeatureImportanceValues=Object(_analytics__WEBPACK_IMPORTED_MODULE_0__["v"])(jobConfig.analysis);const numTopClasses=Object(_analytics__WEBPACK_IMPORTED_MODULE_0__["u"])(jobConfig.analysis);const defaultPredictionField="".concat(dependentVariable,"_prediction");predictedField="".concat(resultsField,".").concat(predictionFieldName?predictionFieldName:defaultPredictionField);if((numTopFeatureImportanceValues!==null&&numTopFeatureImportanceValues!==void 0?numTopFeatureImportanceValues:0)>0){featureImportanceFields.push({id:"".concat(resultsField,".").concat(_constants__WEBPACK_IMPORTED_MODULE_4__["a"]),name:"".concat(resultsField,".").concat(_constants__WEBPACK_IMPORTED_MODULE_4__["a"]),type:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["KBN_FIELD_TYPES"].UNKNOWN});fields=fields.filter(field=>!field.name.includes("".concat(resultsField,".").concat(_constants__WEBPACK_IMPORTED_MODULE_4__["a"],".")))}if((numTopClasses!==null&&numTopClasses!==void 0?numTopClasses:0)>0){topClassesFields.push({id:"".concat(resultsField,".").concat(_constants__WEBPACK_IMPORTED_MODULE_4__["d"]),name:"".concat(resultsField,".").concat(_constants__WEBPACK_IMPORTED_MODULE_4__["d"]),type:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["KBN_FIELD_TYPES"].UNKNOWN});fields=fields.filter(field=>!field.name.includes("".concat(resultsField,".").concat(_constants__WEBPACK_IMPORTED_MODULE_4__["d"],".")))}if(needsDestIndexFields===true){allFields.push({id:"".concat(resultsField,".is_training"),name:"".concat(resultsField,".is_training"),type:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["ES_FIELD_TYPES"].BOOLEAN},{id:predictedField,name:predictedField,type:type})}}allFields.push(...fields,...featureImportanceFields,...topClassesFields);allFields.sort(({name:a},{name:b})=>sortExplorationResultsFields(a,b,jobConfig));let selectedFields=allFields.filter(field=>field.name===predictedField||!field.name.includes(".keyword"));if(selectedFields.length>DEFAULT_REGRESSION_COLUMNS){selectedFields=selectedFields.slice(0,DEFAULT_REGRESSION_COLUMNS)}return{selectedFields:selectedFields,docFields:allFields,depVarType:type}}},86:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",(function(){return isOutlierAnalysis}));__webpack_require__.d(__webpack_exports__,"h",(function(){return isRegressionAnalysis}));__webpack_require__.d(__webpack_exports__,"f",(function(){return isClassificationAnalysis}));__webpack_require__.d(__webpack_exports__,"c",(function(){return getDependentVar}));__webpack_require__.d(__webpack_exports__,"e",(function(){return getPredictionFieldName}));__webpack_require__.d(__webpack_exports__,"b",(function(){return getDefaultPredictionFieldName}));__webpack_require__.d(__webpack_exports__,"d",(function(){return getPredictedFieldName}));__webpack_require__.d(__webpack_exports__,"a",(function(){return getAnalysisType}));var _constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(70);const isOutlierAnalysis=arg=>{if(typeof arg!=="object"||arg===null)return false;const keys=Object.keys(arg);return keys.length===1&&keys[0]===_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_0__["a"].OUTLIER_DETECTION};const isRegressionAnalysis=arg=>{if(typeof arg!=="object"||arg===null)return false;const keys=Object.keys(arg);return keys.length===1&&keys[0]===_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_0__["a"].REGRESSION};const isClassificationAnalysis=arg=>{if(typeof arg!=="object"||arg===null)return false;const keys=Object.keys(arg);return keys.length===1&&keys[0]===_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_0__["a"].CLASSIFICATION};const getDependentVar=analysis=>{let depVar="";if(isRegressionAnalysis(analysis)){depVar=analysis.regression.dependent_variable}if(isClassificationAnalysis(analysis)){depVar=analysis.classification.dependent_variable}return depVar};const getPredictionFieldName=analysis=>{let predictionFieldName;if(isRegressionAnalysis(analysis)&&analysis.regression.prediction_field_name!==undefined){predictionFieldName=analysis.regression.prediction_field_name}else if(isClassificationAnalysis(analysis)&&analysis.classification.prediction_field_name!==undefined){predictionFieldName=analysis.classification.prediction_field_name}return predictionFieldName};const getDefaultPredictionFieldName=analysis=>"".concat(getDependentVar(analysis),"_prediction");const getPredictedFieldName=(resultsField,analysis,forSort)=>{const predictionFieldName=getPredictionFieldName(analysis);const predictedField="".concat(resultsField,".").concat(predictionFieldName?predictionFieldName:getDefaultPredictionFieldName(analysis));return predictedField};const getAnalysisType=analysis=>{const keys=Object.keys(analysis||{});if(keys.length===1){return keys[0]}return"unknown"}}}]);