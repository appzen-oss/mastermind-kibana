(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=62)})([function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4);for(var __WEBPACK_IMPORT_KEY__ in _types__WEBPACK_IMPORTED_MODULE_0__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _types__WEBPACK_IMPORTED_MODULE_0__[key]}))})(__WEBPACK_IMPORT_KEY__);var _ast__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(17);for(var __WEBPACK_IMPORT_KEY__ in _ast__WEBPACK_IMPORTED_MODULE_1__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _ast__WEBPACK_IMPORTED_MODULE_1__[key]}))})(__WEBPACK_IMPORT_KEY__);var _fonts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(19);__webpack_require__.d(__webpack_exports__,"americanTypewriter",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["americanTypewriter"]}));__webpack_require__.d(__webpack_exports__,"arial",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["arial"]}));__webpack_require__.d(__webpack_exports__,"baskerville",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["baskerville"]}));__webpack_require__.d(__webpack_exports__,"bookAntiqua",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["bookAntiqua"]}));__webpack_require__.d(__webpack_exports__,"brushScript",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["brushScript"]}));__webpack_require__.d(__webpack_exports__,"chalkboard",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["chalkboard"]}));__webpack_require__.d(__webpack_exports__,"didot",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["didot"]}));__webpack_require__.d(__webpack_exports__,"futura",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["futura"]}));__webpack_require__.d(__webpack_exports__,"gillSans",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["gillSans"]}));__webpack_require__.d(__webpack_exports__,"helveticaNeue",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["helveticaNeue"]}));__webpack_require__.d(__webpack_exports__,"hoeflerText",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["hoeflerText"]}));__webpack_require__.d(__webpack_exports__,"lucidaGrande",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["lucidaGrande"]}));__webpack_require__.d(__webpack_exports__,"myriad",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["myriad"]}));__webpack_require__.d(__webpack_exports__,"openSans",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["openSans"]}));__webpack_require__.d(__webpack_exports__,"optima",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["optima"]}));__webpack_require__.d(__webpack_exports__,"palatino",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["palatino"]}));__webpack_require__.d(__webpack_exports__,"fonts",(function(){return _fonts__WEBPACK_IMPORTED_MODULE_2__["fonts"]}));var _expression_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10);for(var __WEBPACK_IMPORT_KEY__ in _expression_types__WEBPACK_IMPORTED_MODULE_3__)if(["default","americanTypewriter","arial","baskerville","bookAntiqua","brushScript","chalkboard","didot","futura","gillSans","helveticaNeue","hoeflerText","lucidaGrande","myriad","openSans","optima","palatino","fonts"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _expression_types__WEBPACK_IMPORTED_MODULE_3__[key]}))})(__WEBPACK_IMPORT_KEY__);var _expression_functions__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(26);for(var __WEBPACK_IMPORT_KEY__ in _expression_functions__WEBPACK_IMPORTED_MODULE_4__)if(["default","americanTypewriter","arial","baskerville","bookAntiqua","brushScript","chalkboard","didot","futura","gillSans","helveticaNeue","hoeflerText","lucidaGrande","myriad","openSans","optima","palatino","fonts"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _expression_functions__WEBPACK_IMPORTED_MODULE_4__[key]}))})(__WEBPACK_IMPORT_KEY__);var _expression_renderers__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(28);for(var __WEBPACK_IMPORT_KEY__ in _expression_renderers__WEBPACK_IMPORTED_MODULE_5__)if(["default","americanTypewriter","arial","baskerville","bookAntiqua","brushScript","chalkboard","didot","futura","gillSans","helveticaNeue","hoeflerText","lucidaGrande","myriad","openSans","optima","palatino","fonts"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _expression_renderers__WEBPACK_IMPORTED_MODULE_5__[key]}))})(__WEBPACK_IMPORT_KEY__);var _executor__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(16);__webpack_require__.d(__webpack_exports__,"defaultState",(function(){return _executor__WEBPACK_IMPORTED_MODULE_6__["e"]}));__webpack_require__.d(__webpack_exports__,"pureTransitions",(function(){return _executor__WEBPACK_IMPORTED_MODULE_6__["g"]}));__webpack_require__.d(__webpack_exports__,"pureSelectors",(function(){return _executor__WEBPACK_IMPORTED_MODULE_6__["f"]}));__webpack_require__.d(__webpack_exports__,"createExecutorContainer",(function(){return _executor__WEBPACK_IMPORTED_MODULE_6__["d"]}));__webpack_require__.d(__webpack_exports__,"TypesRegistry",(function(){return _executor__WEBPACK_IMPORTED_MODULE_6__["c"]}));__webpack_require__.d(__webpack_exports__,"FunctionsRegistry",(function(){return _executor__WEBPACK_IMPORTED_MODULE_6__["b"]}));__webpack_require__.d(__webpack_exports__,"Executor",(function(){return _executor__WEBPACK_IMPORTED_MODULE_6__["a"]}));var _execution__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(56);for(var __WEBPACK_IMPORT_KEY__ in _execution__WEBPACK_IMPORTED_MODULE_7__)if(["default","americanTypewriter","arial","baskerville","bookAntiqua","brushScript","chalkboard","didot","futura","gillSans","helveticaNeue","hoeflerText","lucidaGrande","myriad","openSans","optima","palatino","fonts","defaultState","pureTransitions","pureSelectors","createExecutorContainer","TypesRegistry","FunctionsRegistry","Executor"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _execution__WEBPACK_IMPORTED_MODULE_7__[key]}))})(__WEBPACK_IMPORT_KEY__);var _service__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(58);__webpack_require__.d(__webpack_exports__,"ExpressionsService",(function(){return _service__WEBPACK_IMPORTED_MODULE_8__["a"]}));var _util__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(7);__webpack_require__.d(__webpack_exports__,"createError",(function(){return _util__WEBPACK_IMPORTED_MODULE_9__["a"]}));__webpack_require__.d(__webpack_exports__,"getByAlias",(function(){return _util__WEBPACK_IMPORTED_MODULE_9__["b"]}))},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(13);var _common__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_common__WEBPACK_IMPORTED_MODULE_0__);__webpack_require__.d(__webpack_exports__,"TypeToString",(function(){return _common__WEBPACK_IMPORTED_MODULE_0__["TypeToString"]}));__webpack_require__.d(__webpack_exports__,"KnownTypeToString",(function(){return _common__WEBPACK_IMPORTED_MODULE_0__["KnownTypeToString"]}));__webpack_require__.d(__webpack_exports__,"TypeString",(function(){return _common__WEBPACK_IMPORTED_MODULE_0__["TypeString"]}));__webpack_require__.d(__webpack_exports__,"UnmappedTypeStrings",(function(){return _common__WEBPACK_IMPORTED_MODULE_0__["UnmappedTypeStrings"]}));__webpack_require__.d(__webpack_exports__,"SerializedFieldFormat",(function(){return _common__WEBPACK_IMPORTED_MODULE_0__["SerializedFieldFormat"]}));var _style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(40);__webpack_require__.d(__webpack_exports__,"BackgroundRepeat",(function(){return _style__WEBPACK_IMPORTED_MODULE_1__["a"]}));__webpack_require__.d(__webpack_exports__,"BackgroundSize",(function(){return _style__WEBPACK_IMPORTED_MODULE_1__["b"]}));__webpack_require__.d(__webpack_exports__,"FontStyle",(function(){return _style__WEBPACK_IMPORTED_MODULE_1__["c"]}));__webpack_require__.d(__webpack_exports__,"FontWeight",(function(){return _style__WEBPACK_IMPORTED_MODULE_1__["d"]}));__webpack_require__.d(__webpack_exports__,"Overflow",(function(){return _style__WEBPACK_IMPORTED_MODULE_1__["e"]}));__webpack_require__.d(__webpack_exports__,"TextAlignment",(function(){return _style__WEBPACK_IMPORTED_MODULE_1__["f"]}));__webpack_require__.d(__webpack_exports__,"TextDecoration",(function(){return _style__WEBPACK_IMPORTED_MODULE_1__["g"]}));var _registry__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(41);var _registry__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_registry__WEBPACK_IMPORTED_MODULE_2__);for(var __WEBPACK_IMPORT_KEY__ in _registry__WEBPACK_IMPORTED_MODULE_2__)if(["default","TypeToString","KnownTypeToString","TypeString","UnmappedTypeStrings","SerializedFieldFormat","BackgroundRepeat","BackgroundSize","FontStyle","FontWeight","Overflow","TextAlignment","TextDecoration"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _registry__WEBPACK_IMPORTED_MODULE_2__[key]}))})(__WEBPACK_IMPORT_KEY__)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return getBucketIdentifier}));__webpack_require__.d(__webpack_exports__,"a",(function(){return buildResultColumns}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getBucketIdentifier(row,groupColumns){return(groupColumns||[]).map(groupColumnId=>row[groupColumnId]==null?"":String(row[groupColumnId])).join("|")}function buildResultColumns(input,outputColumnId,inputColumnId,outputColumnName){if(input.columns.some(column=>column.id===outputColumnId)){throw new Error(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("expressions.functions.seriesCalculations.columnConflictMessage",{defaultMessage:"Specified outputColumnId {columnId} already exists. Please pick another column id.",values:{columnId:outputColumnId}}))}const inputColumnDefinition=input.columns.find(column=>column.id===inputColumnId);if(!inputColumnDefinition){return}const outputColumnDefinition=_objectSpread(_objectSpread({},inputColumnDefinition),{},{id:outputColumnId,name:outputColumnName||outputColumnId});const resultColumns=[...input.columns];resultColumns.splice(resultColumns.indexOf(inputColumnDefinition)+1,0,outputColumnDefinition);return resultColumns}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getType}));function getType(node){if(node==null)return"null";if(typeof node==="object"){if(!node.type)throw new Error("Objects must have a type property");return node.type}return typeof node}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createError}));__webpack_require__.d(__webpack_exports__,"b",(function(){return get_by_alias["a"]}));const createError=err=>({type:"error",error:{stack:true?undefined:undefined,message:typeof err==="string"?err:String(err.message),name:typeof err==="object"?err.name||"Error":"Error",original:err instanceof Error?err:typeof err==="object"&&"original"in err&&err.original instanceof Error?err.original:undefined}});var get_by_alias=__webpack_require__(20)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return format}));const _require=__webpack_require__(42),toExpression=_require.toExpression;function format(ast,type){return toExpression(ast,type)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return isExpressionAstBuilder}));__webpack_require__.d(__webpack_exports__,"b",(function(){return isExpressionAst}));__webpack_require__.d(__webpack_exports__,"a",(function(){return buildExpression}));var _build_function__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(24);var _format__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8);var _parse__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(14);function isExpressionAstBuilder(val){return(val===null||val===void 0?void 0:val.type)==="expression_builder"}function isExpressionAst(val){return(val===null||val===void 0?void 0:val.type)==="expression"}const generateExpressionAst=fns=>({type:"expression",chain:fns.map(fn=>fn.toAst())});function buildExpression(initialState){const chainToFunctionBuilder=chain=>chain.map(fn=>Object(_build_function__WEBPACK_IMPORTED_MODULE_0__["a"])(fn.function,fn.arguments));const extractFunctionsFromState=state=>{if(typeof state==="string"){return chainToFunctionBuilder(Object(_parse__WEBPACK_IMPORTED_MODULE_2__["a"])(state,"expression").chain)}else if(!Array.isArray(state)){return chainToFunctionBuilder(state.chain)}return state};const fns=initialState?extractFunctionsFromState(initialState):[];return{type:"expression_builder",functions:fns,findFunction(fnName){const foundFns=[];return fns.reduce((found,currFn)=>{Object.values(currFn.arguments).forEach(values=>{values.forEach(value=>{if(isExpressionAstBuilder(value)){found=found.concat(value.findFunction(fnName))}})});if(currFn.name===fnName){found.push(currFn)}return found},foundFns)},toAst(){if(fns.length<1){throw new Error("Functions have not been added to the expression builder")}return generateExpressionAst(fns)},toString(){if(fns.length<1){throw new Error("Functions have not been added to the expression builder")}return Object(_format__WEBPACK_IMPORTED_MODULE_1__["a"])(generateExpressionAst(fns),"expression")}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(49);var _types__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_types__WEBPACK_IMPORTED_MODULE_0__);for(var __WEBPACK_IMPORT_KEY__ in _types__WEBPACK_IMPORTED_MODULE_0__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _types__WEBPACK_IMPORTED_MODULE_0__[key]}))})(__WEBPACK_IMPORT_KEY__);var _get_type__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6);__webpack_require__.d(__webpack_exports__,"getType",(function(){return _get_type__WEBPACK_IMPORTED_MODULE_1__["a"]}));var _serialize_provider__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(50);__webpack_require__.d(__webpack_exports__,"serializeProvider",(function(){return _serialize_provider__WEBPACK_IMPORTED_MODULE_2__["a"]}));var _expression_type__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(25);__webpack_require__.d(__webpack_exports__,"ExpressionType",(function(){return _expression_type__WEBPACK_IMPORTED_MODULE_3__["a"]}));var _specs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(33);__webpack_require__.d(__webpack_exports__,"typeSpecs",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["q"]}));__webpack_require__.d(__webpack_exports__,"boolean",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["a"]}));__webpack_require__.d(__webpack_exports__,"isDatatable",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["f"]}));__webpack_require__.d(__webpack_exports__,"datatable",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["b"]}));__webpack_require__.d(__webpack_exports__,"isExpressionValueError",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["g"]}));__webpack_require__.d(__webpack_exports__,"error",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["c"]}));__webpack_require__.d(__webpack_exports__,"filter",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["d"]}));__webpack_require__.d(__webpack_exports__,"image",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["e"]}));__webpack_require__.d(__webpack_exports__,"nullType",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["h"]}));__webpack_require__.d(__webpack_exports__,"num",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["i"]}));__webpack_require__.d(__webpack_exports__,"number",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["j"]}));__webpack_require__.d(__webpack_exports__,"pointseries",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["k"]}));__webpack_require__.d(__webpack_exports__,"range",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["l"]}));__webpack_require__.d(__webpack_exports__,"render",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["m"]}));__webpack_require__.d(__webpack_exports__,"shape",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["n"]}));__webpack_require__.d(__webpack_exports__,"string",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["o"]}));__webpack_require__.d(__webpack_exports__,"style",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["p"]}))},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,exports){module.exports=__kbnSharedDeps__.Rxjs},function(module,exports){},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return parse}));const _require=__webpack_require__(42),parseRaw=_require.parse;function parse(expression,startRule){try{return parseRaw(String(expression),{startRule:startRule})}catch(e){throw new Error("Unable to parse expression: ".concat(e.message))}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return isExpressionValueError}));__webpack_require__.d(__webpack_exports__,"a",(function(){return error}));var _get_type__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6);const name="error";const isExpressionValueError=value=>Object(_get_type__WEBPACK_IMPORTED_MODULE_0__["a"])(value)==="error";const error={name:name,to:{render:input=>({type:"render",as:name,value:{error:input.error,info:input.info}})}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return defaultState}));__webpack_require__.d(__webpack_exports__,"g",(function(){return pureTransitions}));__webpack_require__.d(__webpack_exports__,"f",(function(){return pureSelectors}));__webpack_require__.d(__webpack_exports__,"d",(function(){return createExecutorContainer}));__webpack_require__.d(__webpack_exports__,"c",(function(){return TypesRegistry}));__webpack_require__.d(__webpack_exports__,"b",(function(){return FunctionsRegistry}));__webpack_require__.d(__webpack_exports__,"a",(function(){return executor_Executor}));var state_containers_=__webpack_require__(35);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const defaultState={functions:{},types:{},context:{}};const pureTransitions={addFunction:state=>fn=>_objectSpread(_objectSpread({},state),{},{functions:_objectSpread(_objectSpread({},state.functions),{},{[fn.name]:fn})}),addType:state=>type=>_objectSpread(_objectSpread({},state),{},{types:_objectSpread(_objectSpread({},state.types),{},{[type.name]:type})}),extendContext:state=>extraContext=>_objectSpread(_objectSpread({},state),{},{context:_objectSpread(_objectSpread({},state.context),extraContext)})};const pureSelectors={getFunction:state=>id=>state.functions[id]||null,getType:state=>id=>state.types[id]||null,getContext:({context:context})=>()=>context};const createExecutorContainer=(state=defaultState)=>{const container=Object(state_containers_["createStateContainer"])(state,pureTransitions,pureSelectors);return container};var external_kbnSharedDeps_Lodash_=__webpack_require__(2);var expression_functions=__webpack_require__(26);var execution_execution=__webpack_require__(30);var expression_type=__webpack_require__(25);var specs=__webpack_require__(33);var expression_functions_specs=__webpack_require__(34);var util=__webpack_require__(7);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function executor_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function executor_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){executor_ownKeys(Object(source),true).forEach((function(key){executor_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{executor_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function executor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class TypesRegistry{constructor(executor){this.executor=executor}register(typeDefinition){this.executor.registerType(typeDefinition)}get(id){return this.executor.state.selectors.getType(id)}toJS(){return this.executor.getTypes()}toArray(){return Object.values(this.toJS())}}class FunctionsRegistry{constructor(executor){this.executor=executor}register(functionDefinition){this.executor.registerFunction(functionDefinition)}get(id){return this.executor.state.selectors.getFunction(id)}toJS(){return this.executor.getFunctions()}toArray(){return Object.values(this.toJS())}}class executor_Executor{static createWithDefaults(state){const executor=new executor_Executor(state);var _iterator=_createForOfIteratorHelper(specs["q"]),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){const type=_step.value;executor.registerType(type)}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _iterator2=_createForOfIteratorHelper(expression_functions_specs["e"]),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){const func=_step2.value;executor.registerFunction(func)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return executor}constructor(state){executor_defineProperty(this,"state",void 0);executor_defineProperty(this,"functions",void 0);executor_defineProperty(this,"types",void 0);this.state=createExecutorContainer(state);this.functions=new FunctionsRegistry(this);this.types=new TypesRegistry(this)}registerFunction(functionDefinition){const fn=new expression_functions["ExpressionFunction"](typeof functionDefinition==="object"?functionDefinition:functionDefinition());this.state.transitions.addFunction(fn)}getFunction(name){return this.state.get().functions[name]}getFunctions(){return executor_objectSpread({},this.state.get().functions)}registerType(typeDefinition){const type=new expression_type["a"](typeof typeDefinition==="object"?typeDefinition:typeDefinition());this.state.transitions.addType(type)}getType(name){return this.state.get().types[name]}getTypes(){return executor_objectSpread({},this.state.get().types)}extendContext(extraContext){this.state.transitions.extendContext(extraContext)}get context(){return this.state.selectors.getContext()}run(ast,input,params={}){var _this=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee(){var execution;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:execution=_this.createExecution(ast,params);execution.start(input);_context.next=4;return execution.result;case 4:return _context.abrupt("return",_context.sent);case 5:case"end":return _context.stop()}}),_callee)})))()}createExecution(ast,params={}){const executionParams={executor:this,params:executor_objectSpread(executor_objectSpread({},params),{},{extraContext:this.context})};if(typeof ast==="string")executionParams.expression=ast;else executionParams.ast=ast;const execution=new execution_execution["a"](executionParams);return execution}walkAst(ast,action){var _iterator3=_createForOfIteratorHelper(ast.chain),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){const link=_step3.value;const fnName=link.function,fnArgs=link.arguments;const fn=Object(util["b"])(this.state.get().functions,fnName);if(fn){link.arguments=Object(external_kbnSharedDeps_Lodash_["mapValues"])(fnArgs,(asts,argName)=>asts.map(arg=>{if(typeof arg==="object"){return this.walkAst(arg,action)}return arg}));action(fn,link)}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return ast}inject(ast,references){return this.walkAst(Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(ast),(fn,link)=>{link.arguments=fn.inject(link.arguments,references)})}extract(ast){const allReferences=[];const newAst=this.walkAst(Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(ast),(fn,link)=>{const _fn$extract=fn.extract(link.arguments),state=_fn$extract.state,references=_fn$extract.references;link.arguments=state;allReferences.push(...references)});return{state:newAst,references:allReferences}}telemetry(ast,telemetryData){this.walkAst(Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(ast),(fn,link)=>{telemetryData=fn.telemetry(link.arguments,telemetryData)});return telemetryData}migrate(ast,version){return this.walkAst(Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(ast),(fn,link)=>{if(!fn.migrations[version])return link;const updatedAst=fn.migrations[version](link);link.arguments=updatedAst.arguments;link.type=updatedAst.type})}fork(){const initialState=this.state.get();const fork=new executor_Executor(initialState);this.state.state$.subscribe(({types:types,functions:functions,context:context})=>{const state=fork.state.get();fork.state.set(executor_objectSpread(executor_objectSpread({},state),{},{types:executor_objectSpread(executor_objectSpread({},types),state.types),functions:executor_objectSpread(executor_objectSpread({},functions),state.functions),context:executor_objectSpread(executor_objectSpread({},context),state.context)}))});return fork}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _build_expression__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9);__webpack_require__.d(__webpack_exports__,"isExpressionAstBuilder",(function(){return _build_expression__WEBPACK_IMPORTED_MODULE_0__["c"]}));__webpack_require__.d(__webpack_exports__,"isExpressionAst",(function(){return _build_expression__WEBPACK_IMPORTED_MODULE_0__["b"]}));__webpack_require__.d(__webpack_exports__,"buildExpression",(function(){return _build_expression__WEBPACK_IMPORTED_MODULE_0__["a"]}));var _build_function__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(24);__webpack_require__.d(__webpack_exports__,"buildExpressionFunction",(function(){return _build_function__WEBPACK_IMPORTED_MODULE_1__["a"]}));var _format_expression__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(46);__webpack_require__.d(__webpack_exports__,"formatExpression",(function(){return _format_expression__WEBPACK_IMPORTED_MODULE_2__["a"]}));var _format__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8);__webpack_require__.d(__webpack_exports__,"format",(function(){return _format__WEBPACK_IMPORTED_MODULE_3__["a"]}));var _parse_expression__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(47);__webpack_require__.d(__webpack_exports__,"parseExpression",(function(){return _parse_expression__WEBPACK_IMPORTED_MODULE_4__["a"]}));var _parse__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(14);__webpack_require__.d(__webpack_exports__,"parse",(function(){return _parse__WEBPACK_IMPORTED_MODULE_5__["a"]}));var _types__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(48);var _types__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_types__WEBPACK_IMPORTED_MODULE_6__);for(var __WEBPACK_IMPORT_KEY__ in _types__WEBPACK_IMPORTED_MODULE_6__)if(["default","isExpressionAstBuilder","isExpressionAst","buildExpression","buildExpressionFunction","formatExpression","format","parseExpression","parse"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _types__WEBPACK_IMPORTED_MODULE_6__[key]}))})(__WEBPACK_IMPORT_KEY__)},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"americanTypewriter",(function(){return americanTypewriter}));__webpack_require__.d(__webpack_exports__,"arial",(function(){return arial}));__webpack_require__.d(__webpack_exports__,"baskerville",(function(){return baskerville}));__webpack_require__.d(__webpack_exports__,"bookAntiqua",(function(){return bookAntiqua}));__webpack_require__.d(__webpack_exports__,"brushScript",(function(){return brushScript}));__webpack_require__.d(__webpack_exports__,"chalkboard",(function(){return chalkboard}));__webpack_require__.d(__webpack_exports__,"didot",(function(){return didot}));__webpack_require__.d(__webpack_exports__,"futura",(function(){return futura}));__webpack_require__.d(__webpack_exports__,"gillSans",(function(){return gillSans}));__webpack_require__.d(__webpack_exports__,"helveticaNeue",(function(){return helveticaNeue}));__webpack_require__.d(__webpack_exports__,"hoeflerText",(function(){return hoeflerText}));__webpack_require__.d(__webpack_exports__,"lucidaGrande",(function(){return lucidaGrande}));__webpack_require__.d(__webpack_exports__,"myriad",(function(){return myriad}));__webpack_require__.d(__webpack_exports__,"openSans",(function(){return openSans}));__webpack_require__.d(__webpack_exports__,"optima",(function(){return optima}));__webpack_require__.d(__webpack_exports__,"palatino",(function(){return palatino}));__webpack_require__.d(__webpack_exports__,"fonts",(function(){return fonts}));function createFont(font){return font}const americanTypewriter=createFont({label:"American Typewriter",value:"'American Typewriter', 'Courier New', Courier, Monaco, mono"});const arial=createFont({label:"Arial",value:"Arial, sans-serif"});const baskerville=createFont({label:"Baskerville",value:"Baskerville, Georgia, Garamond, 'Times New Roman', Times, serif"});const bookAntiqua=createFont({label:"Book Antiqua",value:"'Book Antiqua', Georgia, Garamond, 'Times New Roman', Times, serif"});const brushScript=createFont({label:"Brush Script",value:"'Brush Script MT', 'Comic Sans', sans-serif"});const chalkboard=createFont({label:"Chalkboard",value:"Chalkboard, 'Comic Sans', sans-serif"});const didot=createFont({label:"Didot",value:"Didot, Georgia, Garamond, 'Times New Roman', Times, serif"});const futura=createFont({label:"Futura",value:"Futura, Impact, Helvetica, Arial, sans-serif"});const gillSans=createFont({label:"Gill Sans",value:"'Gill Sans', 'Lucida Grande', 'Lucida Sans Unicode', Verdana, Helvetica, Arial, sans-serif"});const helveticaNeue=createFont({label:"Helvetica Neue",value:"'Helvetica Neue', Helvetica, Arial, sans-serif"});const hoeflerText=createFont({label:"Hoefler Text",value:"'Hoefler Text', Garamond, Georgia, 'Times New Roman', Times, serif"});const lucidaGrande=createFont({label:"Lucida Grande",value:"'Lucida Grande', 'Lucida Sans Unicode', Lucida, Verdana, Helvetica, Arial, sans-serif"});const myriad=createFont({label:"Myriad",value:"Myriad, Helvetica, Arial, sans-serif"});const openSans=createFont({label:"Open Sans",value:"'Open Sans', Helvetica, Arial, sans-serif"});const optima=createFont({label:"Optima",value:"Optima, 'Lucida Grande', 'Lucida Sans Unicode', Verdana, Helvetica, Arial, sans-serif"});const palatino=createFont({label:"Palatino",value:"Palatino, 'Book Antiqua', Georgia, Garamond, 'Times New Roman', Times, serif"});const fonts=[americanTypewriter,arial,baskerville,bookAntiqua,brushScript,chalkboard,didot,futura,gillSans,helveticaNeue,hoeflerText,lucidaGrande,myriad,openSans,optima,palatino]},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getByAlias}));function getByAlias(node,nodeName){const lowerCaseName=nodeName.toLowerCase();return Object.values(node).find(({name:name,aliases:aliases})=>{if(!name)return false;if(name.toLowerCase()===lowerCaseName)return true;return(aliases||[]).some(alias=>alias.toLowerCase()===lowerCaseName)})}},function(module,exports,__webpack_require__){"use strict";var isOldIE=function isOldIE(){var memo;return function memorize(){if(typeof memo==="undefined"){memo=Boolean(window&&document&&document.all&&!window.atob)}return memo}}();var getTarget=function getTarget(){var memo={};return function memorize(target){if(typeof memo[target]==="undefined"){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement){try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}}memo[target]=styleTarget}return memo[target]}}();var stylesInDom=[];function getIndexByIdentifier(identifier){var result=-1;for(var i=0;i<stylesInDom.length;i++){if(stylesInDom[i].identifier===identifier){result=i;break}}return result}function modulesToDom(list,options){var idCountMap={};var identifiers=[];for(var i=0;i<list.length;i++){var item=list[i];var id=options.base?item[0]+options.base:item[0];var count=idCountMap[id]||0;var identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier);var obj={css:item[1],media:item[2],sourceMap:item[3]};if(index!==-1){stylesInDom[index].references++;stylesInDom[index].updater(obj)}else{stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1})}identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style");var attributes=options.attributes||{};if(typeof attributes.nonce==="undefined"){var nonce=true?__webpack_require__.nc:undefined;if(nonce){attributes.nonce=nonce}}Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])}));if(typeof options.insert==="function"){options.insert(style)}else{var target=getTarget(options.insert||"head");if(!target){throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.")}target.appendChild(style)}return style}function removeStyleElement(style){if(style.parentNode===null){return false}style.parentNode.removeChild(style)}var replaceText=function replaceText(){var textStore=[];return function replace(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet){style.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=style.childNodes;if(childNodes[index]){style.removeChild(childNodes[index])}if(childNodes.length){style.insertBefore(cssNode,childNodes[index])}else{style.appendChild(cssNode)}}}function applyToTag(style,options,obj){var css=obj.css;var media=obj.media;var sourceMap=obj.sourceMap;if(media){style.setAttribute("media",media)}else{style.removeAttribute("media")}if(sourceMap&&btoa){css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")}if(style.styleSheet){style.styleSheet.cssText=css}else{while(style.firstChild){style.removeChild(style.firstChild)}style.appendChild(document.createTextNode(css))}}var singleton=null;var singletonCounter=0;function addStyle(obj,options){var style;var update;var remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options));update=applyToSingletonTag.bind(null,style,styleIndex,false);remove=applyToSingletonTag.bind(null,style,styleIndex,true)}else{style=insertStyleElement(options);update=applyToTag.bind(null,style,options);remove=function remove(){removeStyleElement(style)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap){return}update(obj=newObj)}else{remove()}}}module.exports=function(list,options){options=options||{};if(!options.singleton&&typeof options.singleton!=="boolean"){options.singleton=isOldIE()}list=list||[];var lastIdentifiers=modulesToDom(list,options);return function update(newList){newList=newList||[];if(Object.prototype.toString.call(newList)!=="[object Array]"){return}for(var i=0;i<lastIdentifiers.length;i++){var identifier=lastIdentifiers[i];var index=getIndexByIdentifier(identifier);stylesInDom[index].references--}var newLastIdentifiers=modulesToDom(newList,options);for(var _i=0;_i<lastIdentifiers.length;_i++){var _identifier=lastIdentifiers[_i];var _index=getIndexByIdentifier(_identifier);if(stylesInDom[_index].references===0){stylesInDom[_index].updater();stylesInDom.splice(_index,1)}}lastIdentifiers=newLastIdentifiers}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(useSourceMap){var list=[];list.toString=function toString(){return this.map((function(item){var content=cssWithMappingToString(item,useSourceMap);if(item[2]){return"@media ".concat(item[2]," {").concat(content,"}")}return content})).join("")};list.i=function(modules,mediaQuery,dedupe){if(typeof modules==="string"){modules=[[null,modules,""]]}var alreadyImportedModules={};if(dedupe){for(var i=0;i<this.length;i++){var id=this[i][0];if(id!=null){alreadyImportedModules[id]=true}}}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);if(dedupe&&alreadyImportedModules[item[0]]){continue}if(mediaQuery){if(!item[2]){item[2]=mediaQuery}else{item[2]="".concat(mediaQuery," and ").concat(item[2])}}list.push(item)}};return list};function cssWithMappingToString(item,useSourceMap){var content=item[1]||"";var cssMapping=item[3];if(!cssMapping){return content}if(useSourceMap&&typeof btoa==="function"){var sourceMapping=toComment(cssMapping);var sourceURLs=cssMapping.sources.map((function(source){return"/*# sourceURL=".concat(cssMapping.sourceRoot||"").concat(source," */")}));return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}return[content].join("\n")}function toComment(sourceMap){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));var data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64);return"/*# ".concat(data," */")}},function(module,exports){},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return buildExpressionFunction}));var _build_expression__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9);var _format__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8);function buildExpressionFunction(fnName,initialArgs){const args=Object.entries(initialArgs).reduce((acc,[key,value])=>{if(Array.isArray(value)){acc[key]=value.map(v=>Object(_build_expression__WEBPACK_IMPORTED_MODULE_0__["b"])(v)?Object(_build_expression__WEBPACK_IMPORTED_MODULE_0__["a"])(v):v)}else if(value!==undefined){acc[key]=Object(_build_expression__WEBPACK_IMPORTED_MODULE_0__["b"])(value)?[Object(_build_expression__WEBPACK_IMPORTED_MODULE_0__["a"])(value)]:[value]}else{delete acc[key]}return acc},initialArgs);return{type:"expression_function_builder",name:fnName,arguments:args,addArgument(key,value){if(value!==undefined){if(!args.hasOwnProperty(key)){args[key]=[]}args[key].push(value)}return this},getArgument(key){if(!args.hasOwnProperty(key)){return}return args[key]},replaceArgument(key,values){if(!args.hasOwnProperty(key)){throw new Error("Argument to replace does not exist on this function")}args[key]=values;return this},removeArgument(key){delete args[key];return this},toAst(){const ast={};return{type:"function",function:fnName,arguments:Object.entries(args).reduce((acc,[key,values])=>{acc[key]=values.map(val=>Object(_build_expression__WEBPACK_IMPORTED_MODULE_0__["c"])(val)?val.toAst():val);return acc},ast)}},toString(){return Object(_format__WEBPACK_IMPORTED_MODULE_1__["a"])({type:"expression",chain:[this.toAst()]},"expression")}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ExpressionType}));var _get_type__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class ExpressionType{constructor(definition){this.definition=definition;_defineProperty(this,"name",void 0);_defineProperty(this,"help",void 0);_defineProperty(this,"validate",void 0);_defineProperty(this,"create",void 0);_defineProperty(this,"serialize",void 0);_defineProperty(this,"deserialize",void 0);_defineProperty(this,"getToFn",typeName=>!this.definition.to?undefined:this.definition.to[typeName]||this.definition.to["*"]);_defineProperty(this,"getFromFn",typeName=>!this.definition.from?undefined:this.definition.from[typeName]||this.definition.from["*"]);_defineProperty(this,"castsTo",value=>typeof this.getToFn(value)==="function");_defineProperty(this,"castsFrom",value=>typeof this.getFromFn(value)==="function");_defineProperty(this,"to",(value,toTypeName,types)=>{const typeName=Object(_get_type__WEBPACK_IMPORTED_MODULE_0__["a"])(value);if(typeName!==this.name){throw new Error("Can not cast object of type '".concat(typeName,"' using '").concat(this.name,"'"))}else if(!this.castsTo(toTypeName)){throw new Error("Can not cast '".concat(typeName,"' to '").concat(toTypeName,"'"))}return this.getToFn(toTypeName)(value,types)});_defineProperty(this,"from",(value,types)=>{const typeName=Object(_get_type__WEBPACK_IMPORTED_MODULE_0__["a"])(value);if(!this.castsFrom(typeName)){throw new Error("Can not cast '".concat(this.name,"' from ").concat(typeName))}return this.getFromFn(typeName)(value,types)});const _definition=definition,name=_definition.name,help=_definition.help,deserialize=_definition.deserialize,serialize=_definition.serialize,validate=_definition.validate;this.name=name;this.help=help||"";this.validate=validate||(()=>{});this.create=definition.create;this.serialize=serialize;this.deserialize=deserialize}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(51);var _types__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_types__WEBPACK_IMPORTED_MODULE_0__);for(var __WEBPACK_IMPORT_KEY__ in _types__WEBPACK_IMPORTED_MODULE_0__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _types__WEBPACK_IMPORTED_MODULE_0__[key]}))})(__WEBPACK_IMPORT_KEY__);var _arguments__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(52);var _arguments__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_arguments__WEBPACK_IMPORTED_MODULE_1__);for(var __WEBPACK_IMPORT_KEY__ in _arguments__WEBPACK_IMPORTED_MODULE_1__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _arguments__WEBPACK_IMPORTED_MODULE_1__[key]}))})(__WEBPACK_IMPORT_KEY__);var _expression_function_parameter__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(27);__webpack_require__.d(__webpack_exports__,"ExpressionFunctionParameter",(function(){return _expression_function_parameter__WEBPACK_IMPORTED_MODULE_2__["a"]}));var _expression_function__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(53);__webpack_require__.d(__webpack_exports__,"ExpressionFunction",(function(){return _expression_function__WEBPACK_IMPORTED_MODULE_3__["a"]}));var _specs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(34);__webpack_require__.d(__webpack_exports__,"functionSpecs",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["e"]}));__webpack_require__.d(__webpack_exports__,"clog",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["a"]}));__webpack_require__.d(__webpack_exports__,"font",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["d"]}));__webpack_require__.d(__webpack_exports__,"variableSet",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["i"]}));__webpack_require__.d(__webpack_exports__,"variable",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["h"]}));__webpack_require__.d(__webpack_exports__,"theme",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["g"]}));__webpack_require__.d(__webpack_exports__,"cumulativeSum",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["b"]}));__webpack_require__.d(__webpack_exports__,"derivative",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["c"]}));__webpack_require__.d(__webpack_exports__,"movingAverage",(function(){return _specs__WEBPACK_IMPORTED_MODULE_4__["f"]}));var _series_calculation_helpers__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(5);__webpack_require__.d(__webpack_exports__,"getBucketIdentifier",(function(){return _series_calculation_helpers__WEBPACK_IMPORTED_MODULE_5__["b"]}));__webpack_require__.d(__webpack_exports__,"buildResultColumns",(function(){return _series_calculation_helpers__WEBPACK_IMPORTED_MODULE_5__["a"]}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ExpressionFunctionParameter}));function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class ExpressionFunctionParameter{constructor(name,arg){_defineProperty(this,"name",void 0);_defineProperty(this,"required",void 0);_defineProperty(this,"help",void 0);_defineProperty(this,"types",void 0);_defineProperty(this,"default",void 0);_defineProperty(this,"aliases",void 0);_defineProperty(this,"multi",void 0);_defineProperty(this,"resolve",void 0);_defineProperty(this,"options",void 0);const required=arg.required,help=arg.help,types=arg.types,aliases=arg.aliases,multi=arg.multi,resolve=arg.resolve,options=arg.options;if(name==="_"){throw Error("Arg names must not be _. Use it in aliases instead.")}this.name=name;this.required=!!required;this.help=help||"";this.types=types||[];this.default=arg.default;this.aliases=aliases||[];this.multi=!!multi;this.resolve=resolve==null?true:resolve;this.options=options||[]}accepts(type){if(!this.types.length)return true;return this.types.indexOf(type)>-1}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(54);var _types__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_types__WEBPACK_IMPORTED_MODULE_0__);for(var __WEBPACK_IMPORT_KEY__ in _types__WEBPACK_IMPORTED_MODULE_0__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _types__WEBPACK_IMPORTED_MODULE_0__[key]}))})(__WEBPACK_IMPORT_KEY__);var _expression_renderer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(29);__webpack_require__.d(__webpack_exports__,"ExpressionRenderer",(function(){return _expression_renderer__WEBPACK_IMPORTED_MODULE_1__["a"]}));var _expression_renderer_registry__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(55);__webpack_require__.d(__webpack_exports__,"ExpressionRendererRegistry",(function(){return _expression_renderer_registry__WEBPACK_IMPORTED_MODULE_2__["a"]}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ExpressionRenderer}));function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class ExpressionRenderer{constructor(config){_defineProperty(this,"name",void 0);_defineProperty(this,"displayName",void 0);_defineProperty(this,"help",void 0);_defineProperty(this,"validate",void 0);_defineProperty(this,"reuseDomNode",void 0);_defineProperty(this,"render",void 0);const name=config.name,displayName=config.displayName,help=config.help,validate=config.validate,reuseDomNode=config.reuseDomNode,render=config.render;this.name=name;this.displayName=displayName||name;this.help=help||"";this.validate=validate||(()=>{});this.reuseDomNode=Boolean(reuseDomNode);this.render=render}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Execution}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);var lodash__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2);var lodash__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);var _container__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(31);var _util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7);var _kibana_utils_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(18);var _kibana_utils_common__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_kibana_utils_common__WEBPACK_IMPORTED_MODULE_4__);var _inspector_common__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(38);var _inspector_common__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_inspector_common__WEBPACK_IMPORTED_MODULE_5__);var _expression_types_specs_error__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(15);var _ast__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(17);var _expression_types__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(10);var _util_get_by_alias__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(20);var _execution_contract__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(32);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const createAbortErrorValue=()=>Object(_util__WEBPACK_IMPORTED_MODULE_3__["a"])({message:"The expression was aborted.",name:"AbortError"});const createDefaultInspectorAdapters=()=>({requests:new _inspector_common__WEBPACK_IMPORTED_MODULE_5__["RequestAdapter"],data:new _inspector_common__WEBPACK_IMPORTED_MODULE_5__["DataAdapter"]});class Execution{race(promise){return Promise.race([this.abortRejection.promise,promise])}get result(){return this.firstResultFuture.promise}get inspectorAdapters(){return this.context.inspectorAdapters}constructor(execution){this.execution=execution;_defineProperty(this,"state",void 0);_defineProperty(this,"input",null);_defineProperty(this,"context",void 0);_defineProperty(this,"abortController",new AbortController);_defineProperty(this,"abortRejection",Object(_kibana_utils_common__WEBPACK_IMPORTED_MODULE_4__["abortSignalToPromise"])(this.abortController.signal));_defineProperty(this,"hasStarted",false);_defineProperty(this,"firstResultFuture",new _kibana_utils_common__WEBPACK_IMPORTED_MODULE_4__["Defer"]);_defineProperty(this,"contract",new _execution_contract__WEBPACK_IMPORTED_MODULE_10__["a"](this));_defineProperty(this,"expression",void 0);const _execution=execution,executor=_execution.executor;if(!execution.ast&&!execution.expression){throw new TypeError("Execution params should contain at least .ast or .expression key.")}else if(execution.ast&&execution.expression){throw new TypeError("Execution params cannot contain both .ast and .expression key.")}this.expression=execution.expression||Object(_ast__WEBPACK_IMPORTED_MODULE_7__["formatExpression"])(execution.ast);const ast=execution.ast||Object(_ast__WEBPACK_IMPORTED_MODULE_7__["parseExpression"])(this.expression);this.state=Object(_container__WEBPACK_IMPORTED_MODULE_2__["a"])(_objectSpread(_objectSpread({},executor.state.get()),{},{state:"not-started",ast:ast}));this.context=_objectSpread({getSearchContext:()=>this.execution.params.searchContext||{},getSearchSessionId:()=>execution.params.searchSessionId,variables:execution.params.variables||{},types:executor.getTypes(),abortSignal:this.abortController.signal,inspectorAdapters:execution.params.inspectorAdapters||createDefaultInspectorAdapters()},execution.params.extraContext)}cancel(){this.abortController.abort()}start(input=null){if(this.hasStarted)throw new Error("Execution already started.");this.hasStarted=true;this.input=input;this.state.transitions.start();const _this$firstResultFutu=this.firstResultFuture,resolve=_this$firstResultFutu.resolve,reject=_this$firstResultFutu.reject;const chainPromise=this.invokeChain(this.state.get().ast.chain,input);this.race(chainPromise).then(resolve,error=>{if(this.abortController.signal.aborted)resolve(createAbortErrorValue());else reject(error)});this.firstResultFuture.promise.then(result=>{this.state.transitions.setResult(result)},error=>{this.state.transitions.setError(error)}).finally(()=>{this.abortRejection.cleanup()})}invokeChain(chainArr,input){var _this=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _iterator,_step,link,fnName,fnArgs,fn,args,timeStart,_yield$_this$race,resolvedArgs,output,timeEnd,error;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(chainArr.length){_context.next=2;break}return _context.abrupt("return",input);case 2:_iterator=_createForOfIteratorHelper(chainArr);_context.prev=3;_iterator.s();case 5:if((_step=_iterator.n()).done){_context.next=39;break}link=_step.value;fnName=link.function,fnArgs=link.arguments;fn=Object(_util_get_by_alias__WEBPACK_IMPORTED_MODULE_9__["a"])(_this.state.get().functions,fnName);if(fn){_context.next=11;break}return _context.abrupt("return",Object(_util__WEBPACK_IMPORTED_MODULE_3__["a"])({name:"fn not found",message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("expressions.execution.functionNotFound",{defaultMessage:"Function {fnName} could not be found.",values:{fnName:fnName}})}));case 11:if(!fn.disabled){_context.next=13;break}return _context.abrupt("return",Object(_util__WEBPACK_IMPORTED_MODULE_3__["a"])({name:"fn is disabled",message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("expressions.execution.functionDisabled",{defaultMessage:"Function {fnName} is disabled.",values:{fnName:fnName}})}));case 13:args={};_context.prev=14;_context.next=17;return _this.race(_this.resolveArgs(fn,input,fnArgs));case 17:_yield$_this$race=_context.sent;resolvedArgs=_yield$_this$race.resolvedArgs;args=resolvedArgs;timeStart=_this.execution.params.debug?Object(_kibana_utils_common__WEBPACK_IMPORTED_MODULE_4__["now"])():0;_context.next=23;return _this.race(_this.invokeFunction(fn,input,resolvedArgs));case 23:output=_context.sent;if(_this.execution.params.debug){timeEnd=Object(_kibana_utils_common__WEBPACK_IMPORTED_MODULE_4__["now"])();link.debug={success:true,fn:fn.name,input:input,args:resolvedArgs,output:output,duration:timeEnd-timeStart}}if(!(Object(_expression_types__WEBPACK_IMPORTED_MODULE_8__["getType"])(output)==="error")){_context.next=27;break}return _context.abrupt("return",output);case 27:input=output;_context.next=37;break;case 30:_context.prev=30;_context.t0=_context["catch"](14);timeEnd=_this.execution.params.debug?Object(_kibana_utils_common__WEBPACK_IMPORTED_MODULE_4__["now"])():0;error=Object(_util__WEBPACK_IMPORTED_MODULE_3__["a"])(_context.t0);error.error.message="[".concat(fnName,"] > ").concat(error.error.message);if(_this.execution.params.debug){link.debug={success:false,fn:fn.name,input:input,args:args,error:error,rawError:_context.t0,duration:timeStart?timeEnd-timeStart:undefined}}return _context.abrupt("return",error);case 37:_context.next=5;break;case 39:_context.next=44;break;case 41:_context.prev=41;_context.t1=_context["catch"](3);_iterator.e(_context.t1);case 44:_context.prev=44;_iterator.f();return _context.finish(44);case 47:return _context.abrupt("return",input);case 48:case"end":return _context.stop()}}),_callee,null,[[3,41,44,47],[14,30]])})))()}invokeFunction(fn,input,args){var _this2=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var normalizedInput,output,returnType,expectedType,type;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:normalizedInput=_this2.cast(input,fn.inputTypes);_context2.next=3;return _this2.race(fn.fn(normalizedInput,args,_this2.context));case 3:output=_context2.sent;returnType=Object(_expression_types__WEBPACK_IMPORTED_MODULE_8__["getType"])(output);expectedType=fn.type;if(!(expectedType&&returnType!==expectedType)){_context2.next=8;break}throw new Error("Function '".concat(fn.name,"' should return '").concat(expectedType,"',")+" actually returned '".concat(returnType,"'"));case 8:type=_this2.context.types[fn.type];if(!(type&&type.validate)){_context2.next=17;break}_context2.prev=10;type.validate(output);_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2["catch"](10);throw new Error("Output of '".concat(fn.name,"' is not a valid type '").concat(fn.type,"': ").concat(_context2.t0));case 17:return _context2.abrupt("return",output);case 18:case"end":return _context2.stop()}}),_callee2,null,[[10,14]])})))()}cast(value,toTypeNames){if(!toTypeNames||toTypeNames.length===0)return value;const fromTypeName=Object(_expression_types__WEBPACK_IMPORTED_MODULE_8__["getType"])(value);if(toTypeNames.includes(fromTypeName))return value;const _this$state$get=this.state.get(),types=_this$state$get.types;const fromTypeDef=types[fromTypeName];var _iterator2=_createForOfIteratorHelper(toTypeNames),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){const toTypeName=_step2.value;if(fromTypeDef&&fromTypeDef.castsTo(toTypeName)){return fromTypeDef.to(value,toTypeName,types)}const toTypeDef=types[toTypeName];if(toTypeDef&&toTypeDef.castsFrom(fromTypeName))return toTypeDef.from(value,types)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}throw new Error("Can not cast '".concat(fromTypeName,"' to any of '").concat(toTypeNames.join(", "),"'"))}resolveArgs(fnDef,input,argAsts){var _this3=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var argDefs,dealiasedArgAsts,_i,_Object$values,argDef,_ref,aliases,argDefault,argName,required,errorArg,argAstsWithDefaults,resolveArgFns,argNames,resolvedArgValues,resolvedMultiArgs,resolvedArgs;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:argDefs=fnDef.args;dealiasedArgAsts=Object(lodash__WEBPACK_IMPORTED_MODULE_1__["reduce"])(argAsts,(acc,argAst,argName)=>{const argDef=Object(_util_get_by_alias__WEBPACK_IMPORTED_MODULE_9__["a"])(argDefs,argName);if(!argDef){throw new Error("Unknown argument '".concat(argName,"' passed to function '").concat(fnDef.name,"'"))}acc[argDef.name]=(acc[argDef.name]||[]).concat(argAst);return acc},{});_i=0,_Object$values=Object.values(argDefs);case 3:if(!(_i<_Object$values.length)){_context4.next=15;break}argDef=_Object$values[_i];_ref=argDef,aliases=_ref.aliases,argDefault=_ref.default,argName=_ref.name,required=_ref.required;if(!(typeof argDefault!=="undefined"||!required||typeof dealiasedArgAsts[argName]!=="undefined")){_context4.next=8;break}return _context4.abrupt("continue",12);case 8:if(!(!aliases||aliases.length===0)){_context4.next=10;break}throw new Error("".concat(fnDef.name," requires an argument"));case 10:errorArg=argName==="_"?aliases[0]:argName;throw new Error("".concat(fnDef.name,' requires an "').concat(errorArg,'" argument'));case 12:_i++;_context4.next=3;break;case 15:argAstsWithDefaults=Object(lodash__WEBPACK_IMPORTED_MODULE_1__["reduce"])(argDefs,(acc,argDef,argName)=>{if(typeof acc[argName]==="undefined"&&typeof argDef.default!=="undefined"){acc[argName]=[Object(_ast__WEBPACK_IMPORTED_MODULE_7__["parse"])(argDef.default,"argument")]}return acc},dealiasedArgAsts);resolveArgFns=Object(lodash__WEBPACK_IMPORTED_MODULE_1__["mapValues"])(argAstsWithDefaults,(asts,argName)=>asts.map(item=>function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(subInput=input){var output,casted;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _this3.interpret(item,subInput);case 2:output=_context3.sent;if(!Object(_expression_types_specs_error__WEBPACK_IMPORTED_MODULE_6__["b"])(output)){_context3.next=5;break}throw output.error;case 5:casted=_this3.cast(output,argDefs[argName].types);return _context3.abrupt("return",casted);case 7:case"end":return _context3.stop()}}),_callee3)})));return function(){return _ref2.apply(this,arguments)}}()));argNames=Object(lodash__WEBPACK_IMPORTED_MODULE_1__["keys"])(resolveArgFns);_context4.next=20;return Promise.all(argNames.map(argName=>{const interpretFns=resolveArgFns[argName];if(!argDefs[argName].resolve)return interpretFns;return Promise.all(interpretFns.map(fn=>fn()))}));case 20:resolvedArgValues=_context4.sent;resolvedMultiArgs=Object(lodash__WEBPACK_IMPORTED_MODULE_1__["zipObject"])(argNames,resolvedArgValues);resolvedArgs=Object(lodash__WEBPACK_IMPORTED_MODULE_1__["mapValues"])(resolvedMultiArgs,(argValues,argName)=>{if(argDefs[argName].multi)return argValues;return Object(lodash__WEBPACK_IMPORTED_MODULE_1__["last"])(argValues)});return _context4.abrupt("return",{resolvedArgs:resolvedArgs});case 24:case"end":return _context4.stop()}}),_callee4)})))()}interpret(ast,input){var _this4=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var execution;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.t0=Object(_expression_types__WEBPACK_IMPORTED_MODULE_8__["getType"])(ast);_context5.next=_context5.t0==="expression"?3:_context5.t0==="string"?8:_context5.t0==="number"?8:_context5.t0==="null"?8:_context5.t0==="boolean"?8:9;break;case 3:execution=_this4.execution.executor.createExecution(ast,_this4.execution.params);execution.start(input);_context5.next=7;return execution.result;case 7:return _context5.abrupt("return",_context5.sent);case 8:return _context5.abrupt("return",ast);case 9:throw new Error("Unknown AST object: ".concat(JSON.stringify(ast)));case 10:case"end":return _context5.stop()}}),_callee5)})))()}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return executionPureTransitions}));__webpack_require__.d(__webpack_exports__,"a",(function(){return createExecutionContainer}));var _kibana_utils_common_state_containers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(35);var _kibana_utils_common_state_containers__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kibana_utils_common_state_containers__WEBPACK_IMPORTED_MODULE_0__);var _executor__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(16);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const executionDefaultState=_objectSpread(_objectSpread({},_executor__WEBPACK_IMPORTED_MODULE_1__["e"]),{},{state:"not-started",ast:{type:"expression",chain:[]}});const executionPureTransitions={start:state=>()=>_objectSpread(_objectSpread({},state),{},{state:"pending"}),setResult:state=>result=>_objectSpread(_objectSpread({},state),{},{state:"result",result:result}),setError:state=>error=>_objectSpread(_objectSpread({},state),{},{state:"error",error:error})};const freeze=state=>state;const createExecutionContainer=(state=executionDefaultState)=>{const container=Object(_kibana_utils_common_state_containers__WEBPACK_IMPORTED_MODULE_0__["createStateContainer"])(state,executionPureTransitions,{},{freeze:freeze});return container}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ExecutionContract}));function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class ExecutionContract{get isPending(){const state=this.execution.state.get().state;const finished=state==="error"||state==="result";return!finished}constructor(execution){var _this=this;this.execution=execution;_defineProperty(this,"cancel",()=>{this.execution.cancel()});_defineProperty(this,"getData",_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _this.execution.result;case 3:return _context.abrupt("return",_context.sent);case 6:_context.prev=6;_context.t0=_context["catch"](0);return _context.abrupt("return",{type:"error",error:{name:_context.t0.name,message:_context.t0.message,stack:_context.t0.stack}});case 9:case"end":return _context.stop()}}),_callee,null,[[0,6]])}))));_defineProperty(this,"getExpression",()=>this.execution.expression);_defineProperty(this,"getAst",()=>this.execution.state.get().ast);_defineProperty(this,"inspect",()=>this.execution.inspectorAdapters)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"q",(function(){return typeSpecs}));__webpack_require__.d(__webpack_exports__,"a",(function(){return boolean_boolean}));__webpack_require__.d(__webpack_exports__,"f",(function(){return isDatatable}));__webpack_require__.d(__webpack_exports__,"b",(function(){return datatable}));__webpack_require__.d(__webpack_exports__,"g",(function(){return error["b"]}));__webpack_require__.d(__webpack_exports__,"c",(function(){return error["a"]}));__webpack_require__.d(__webpack_exports__,"d",(function(){return filter}));__webpack_require__.d(__webpack_exports__,"e",(function(){return image_image}));__webpack_require__.d(__webpack_exports__,"h",(function(){return nullType}));__webpack_require__.d(__webpack_exports__,"i",(function(){return num}));__webpack_require__.d(__webpack_exports__,"j",(function(){return number}));__webpack_require__.d(__webpack_exports__,"k",(function(){return pointseries}));__webpack_require__.d(__webpack_exports__,"l",(function(){return range}));__webpack_require__.d(__webpack_exports__,"m",(function(){return render}));__webpack_require__.d(__webpack_exports__,"n",(function(){return shape}));__webpack_require__.d(__webpack_exports__,"o",(function(){return string}));__webpack_require__.d(__webpack_exports__,"p",(function(){return style}));const boolean_name="boolean";const boolean_boolean={name:boolean_name,from:{null:()=>false,number:n=>Boolean(n),string:s=>Boolean(s)},to:{render:value=>{const text="".concat(value);return{type:"render",as:"text",value:{text:text}}},datatable:value=>({type:"datatable",columns:[{id:"value",name:"value",meta:{type:boolean_name}}],rows:[{value:value}]})}};var external_kbnSharedDeps_Lodash_=__webpack_require__(2);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const datatable_name="datatable";const isDatatable=datatable=>!!datatable&&typeof datatable==="object"&&datatable.type==="datatable";const datatable={name:datatable_name,validate:table=>{if(!table.columns){throw new Error("datatable must have a columns array, even if it is empty")}if(!table.rows){throw new Error("datatable must have a rows array, even if it is empty")}},serialize:table=>{const columns=table.columns,rows=table.rows;return _objectSpread(_objectSpread({},table),{},{rows:rows.map(row=>columns.map(column=>row[column.name]))})},deserialize:table=>{const columns=table.columns,rows=table.rows;return _objectSpread(_objectSpread({},table),{},{rows:rows.map(row=>Object(external_kbnSharedDeps_Lodash_["zipObject"])(Object(external_kbnSharedDeps_Lodash_["map"])(columns,"name"),row))})},from:{null:()=>({type:datatable_name,meta:{},rows:[],columns:[]}),pointseries:value=>({type:datatable_name,meta:{},rows:value.rows,columns:Object(external_kbnSharedDeps_Lodash_["map"])(value.columns,(val,colName)=>({id:colName,name:colName,meta:{type:val.type}}))})},to:{render:table=>({type:"render",as:"table",value:{datatable:table,paginate:true,perPage:10,showHeader:true}}),pointseries:table=>{const validFields=["x","y","color","size","text"];const columns=table.columns.filter(column=>validFields.includes(column.id));const rows=table.rows.map(row=>Object(external_kbnSharedDeps_Lodash_["pick"])(row,validFields));return{type:"pointseries",columns:columns.reduce((acc,column)=>{acc[column.name]={type:column.meta.type,expression:column.name,role:"dimension"};return acc},{}),rows:rows}}}};var error=__webpack_require__(15);const filter={name:"filter",from:{null:()=>({type:"filter",filterType:"filter",meta:{},and:[]})}};const image_name="image";const image_image={name:image_name,to:{render:input=>({type:"render",as:"image",value:input})}};const null_name="null";const nullType={name:null_name,from:{"*":()=>null}};var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);const num={name:"num",from:{null:()=>({type:"num",value:0}),boolean:b=>({type:"num",value:Number(b)}),string:n=>{const value=Number(n);if(Number.isNaN(value)){throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.types.number.fromStringConversionErrorMessage",{defaultMessage:'Can\'t typecast "{string}" string to number',values:{string:n}}))}return{type:"num",value:value}},"*":value=>({type:"num",value:Number(value)})},to:{render:({value:value})=>{const text="".concat(value);return{type:"render",as:"text",value:{text:text}}},datatable:({value:value})=>({type:"datatable",columns:[{id:"value",name:"value",meta:{type:"number"}}],rows:[{value:value}]})}};const number_name="number";const number={name:number_name,from:{null:()=>0,boolean:b=>Number(b),string:n=>{const value=Number(n);if(Number.isNaN(value)){throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.types.number.fromStringConversionErrorMessage",{defaultMessage:'Can\'t typecast "{string}" string to number',values:{string:n}}))}return value}},to:{render:value=>{const text="".concat(value);return{type:"render",as:"text",value:{text:text}}},datatable:value=>({type:"datatable",columns:[{id:"value",name:"value",meta:{type:"number"}}],rows:[{value:value}]})}};const pointseries_name="pointseries";const pointseries={name:pointseries_name,from:{null:()=>({type:pointseries_name,rows:[],columns:{}})},to:{render:(pseries,types)=>{const datatable=types.datatable.from(pseries,types);return{type:"render",as:"table",value:{datatable:datatable,showHeader:true}}}}};const range_name="range";const range={name:range_name,from:{null:()=>({type:"range",from:0,to:0})},to:{render:value=>{const text=(value===null||value===void 0?void 0:value.label)||"from ".concat(value.from," to ").concat(value.to);return{type:"render",as:"text",value:{text:text}}}}};const render_name="render";const render={name:render_name,from:{"*":v=>({type:render_name,as:"debug",value:v})}};const shape_name="shape";const shape={name:"shape",to:{render:input=>({type:"render",as:shape_name,value:input})}};const string_name="string";const string={name:string_name,from:{null:()=>"",boolean:b=>String(b),number:n=>String(n)},to:{render:text=>({type:"render",as:"text",value:{text:text}}),datatable:value=>({type:"datatable",columns:[{id:"value",name:"value",meta:{type:"string"}}],rows:[{value:value}]})}};const style_name="style";const style={name:style_name,from:{null:()=>({type:"style",spec:{},css:""})}};const typeSpecs=[boolean_boolean,datatable,error["a"],filter,image_image,nullType,num,number,pointseries,range,render,shape,string,style]},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return functionSpecs}));__webpack_require__.d(__webpack_exports__,"a",(function(){return clog}));__webpack_require__.d(__webpack_exports__,"d",(function(){return font}));__webpack_require__.d(__webpack_exports__,"i",(function(){return variableSet}));__webpack_require__.d(__webpack_exports__,"h",(function(){return variable}));__webpack_require__.d(__webpack_exports__,"g",(function(){return theme}));__webpack_require__.d(__webpack_exports__,"b",(function(){return cumulativeSum}));__webpack_require__.d(__webpack_exports__,"c",(function(){return derivative}));__webpack_require__.d(__webpack_exports__,"f",(function(){return movingAverage}));const clog={name:"clog",args:{},help:"Outputs the context to the console",fn:input=>{console.log(input);return input}};var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var fonts=__webpack_require__(19);var types=__webpack_require__(4);const dashify=str=>str.trim().replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\W/g,m=>/[-]/.test(m)?m:"-").replace(/^-+|-+$/g,"").toLowerCase();const inlineStyle=obj=>{if(!obj)return"";const styles=Object.keys(obj).map(key=>{const prop=dashify(key);const line=prop.concat(":").concat(String(obj[key]));return line});return styles.join(";")};const font={name:"font",aliases:[],type:"style",help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.fontHelpText",{defaultMessage:"Create a font style."}),inputTypes:["null"],args:{align:{default:'{ theme "font.align" default="left" }',help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.font.args.alignHelpText",{defaultMessage:"The horizontal text alignment."}),options:Object.values(types["TextAlignment"]),types:["string"]},color:{default:'{ theme "font.color" }',help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.font.args.colorHelpText",{defaultMessage:"The text color."}),types:["string"]},family:{default:'{ theme "font.family" default="'.concat(fonts["openSans"].value,'" }'),help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.font.args.familyHelpText",{defaultMessage:"An acceptable {css} web font string",values:{css:"CSS"}}),types:["string"]},italic:{default:'{ theme "font.italic" default=false }',help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.font.args.italicHelpText",{defaultMessage:"Italicize the text?"}),options:[true,false],types:["boolean"]},lHeight:{default:'{ theme "font.lHeight" }',aliases:["lineHeight"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.font.args.lHeightHelpText",{defaultMessage:"The line height in pixels"}),types:["number","null"]},size:{default:'{ theme "font.size" default=14 }',help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.font.args.sizeHelpText",{defaultMessage:"The font size in pixels"}),types:["number"]},underline:{default:'{ theme "font.underline" default=false }',help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.font.args.underlineHelpText",{defaultMessage:"Underline the text?"}),options:[true,false],types:["boolean"]},weight:{default:'{ theme "font.weight" default="normal" }',help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.font.args.weightHelpText",{defaultMessage:"The font weight. For example, {list}, or {end}.",values:{list:Object.values(types["FontWeight"]).slice(0,-1).map(weight=>'`"'.concat(weight,'"`')).join(", "),end:'`"'.concat(Object.values(types["FontWeight"]).slice(-1)[0],'"`')}}),options:Object.values(types["FontWeight"]),types:["string"]}},fn:(input,args)=>{if(!Object.values(types["FontWeight"]).includes(args.weight)){throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.font.invalidFontWeightErrorMessage",{defaultMessage:"Invalid font weight: '{weight}'",values:{weight:args.weight}}))}if(!Object.values(types["TextAlignment"]).includes(args.align)){throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.font.invalidTextAlignmentErrorMessage",{defaultMessage:"Invalid text alignment: '{align}'",values:{align:args.align}}))}const lineHeight=args.lHeight!=null?"".concat(args.lHeight,"px"):"1";const spec={fontFamily:args.family,fontWeight:args.weight,fontStyle:args.italic?types["FontStyle"].ITALIC:types["FontStyle"].NORMAL,textDecoration:args.underline?types["TextDecoration"].UNDERLINE:types["TextDecoration"].NONE,textAlign:args.align,fontSize:"".concat(args.size,"px"),lineHeight:lineHeight};if(args.color){spec.color=args.color}return{type:"style",spec:spec,css:inlineStyle(spec)}}};const variableSet={name:"var_set",help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.varset.help",{defaultMessage:"Updates the Kibana global context."}),args:{name:{types:["string"],aliases:["_"],required:true,help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.varset.name.help",{defaultMessage:"Specify the name of the variable."})},value:{aliases:["val"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.varset.val.help",{defaultMessage:"Specify the value for the variable. When unspecified, the input context is used."})}},fn(input,args,context){const variables=context.variables;variables[args.name]=args.value===undefined?input:args.value;return input}};const variable={name:"var",help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.var.help",{defaultMessage:"Updates the Kibana global context."}),args:{name:{types:["string"],aliases:["_"],required:true,help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.var.name.help",{defaultMessage:"Specify the name of the variable."})}},fn(input,args,context){const variables=context.variables;return variables[args.name]}};var external_kbnSharedDeps_Lodash_=__webpack_require__(2);const theme={name:"theme",aliases:[],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.themeHelpText",{defaultMessage:"Reads a theme setting."}),inputTypes:["null"],args:{variable:{aliases:["_"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.theme.args.variableHelpText",{defaultMessage:"Name of the theme variable to read."}),required:true,types:["string"]},default:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.theme.args.defaultHelpText",{defaultMessage:"default value in case theming info is not available."})}},fn:(input,args,handlers)=>{const vars=handlers.variables.theme||{};return Object(external_kbnSharedDeps_Lodash_["get"])(vars,args.variable,args.default)}};var series_calculation_helpers=__webpack_require__(5);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const cumulativeSum={name:"cumulative_sum",type:"datatable",inputTypes:["datatable"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.cumulativeSum.help",{defaultMessage:"Calculates the cumulative sum of a column in a data table"}),args:{by:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.cumulativeSum.args.byHelpText",{defaultMessage:"Column to split the cumulative sum calculation by"}),multi:true,types:["string"],required:false},inputColumnId:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.cumulativeSum.args.inputColumnIdHelpText",{defaultMessage:"Column to calculate the cumulative sum of"}),types:["string"],required:true},outputColumnId:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.cumulativeSum.args.outputColumnIdHelpText",{defaultMessage:"Column to store the resulting cumulative sum in"}),types:["string"],required:true},outputColumnName:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.cumulativeSum.args.outputColumnNameHelpText",{defaultMessage:"Name of the column to store the resulting cumulative sum in"}),types:["string"],required:false}},fn(input,{by:by,inputColumnId:inputColumnId,outputColumnId:outputColumnId,outputColumnName:outputColumnName}){const resultColumns=Object(series_calculation_helpers["a"])(input,outputColumnId,inputColumnId,outputColumnName);if(!resultColumns){return input}const accumulators={};return _objectSpread(_objectSpread({},input),{},{columns:resultColumns,rows:input.rows.map(row=>{var _accumulators$bucketI;const newRow=_objectSpread({},row);const bucketIdentifier=Object(series_calculation_helpers["b"])(row,by);const accumulatorValue=(_accumulators$bucketI=accumulators[bucketIdentifier])!==null&&_accumulators$bucketI!==void 0?_accumulators$bucketI:0;const currentValue=newRow[inputColumnId];if(currentValue!=null){newRow[outputColumnId]=Number(currentValue)+accumulatorValue;accumulators[bucketIdentifier]=newRow[outputColumnId]}else{newRow[outputColumnId]=accumulatorValue}return newRow})})}};function derivative_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function derivative_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){derivative_ownKeys(Object(source),true).forEach((function(key){derivative_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{derivative_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function derivative_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const derivative={name:"derivative",type:"datatable",inputTypes:["datatable"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.derivative.help",{defaultMessage:"Calculates the derivative of a column in a data table"}),args:{by:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.derivative.args.byHelpText",{defaultMessage:"Column to split the derivative calculation by"}),multi:true,types:["string"],required:false},inputColumnId:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.derivative.args.inputColumnIdHelpText",{defaultMessage:"Column to calculate the derivative of"}),types:["string"],required:true},outputColumnId:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.derivative.args.outputColumnIdHelpText",{defaultMessage:"Column to store the resulting derivative in"}),types:["string"],required:true},outputColumnName:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.derivative.args.outputColumnNameHelpText",{defaultMessage:"Name of the column to store the resulting derivative in"}),types:["string"],required:false}},fn(input,{by:by,inputColumnId:inputColumnId,outputColumnId:outputColumnId,outputColumnName:outputColumnName}){const resultColumns=Object(series_calculation_helpers["a"])(input,outputColumnId,inputColumnId,outputColumnName);if(!resultColumns){return input}const previousValues={};return derivative_objectSpread(derivative_objectSpread({},input),{},{columns:resultColumns,rows:input.rows.map(row=>{const newRow=derivative_objectSpread({},row);const bucketIdentifier=Object(series_calculation_helpers["b"])(row,by);const previousValue=previousValues[bucketIdentifier];const currentValue=newRow[inputColumnId];if(currentValue!=null&&previousValue!=null){newRow[outputColumnId]=Number(currentValue)-previousValue}else{newRow[outputColumnId]=undefined}if(currentValue!=null){previousValues[bucketIdentifier]=Number(currentValue)}else{previousValues[bucketIdentifier]=undefined}return newRow})})}};function moving_average_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function moving_average_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){moving_average_ownKeys(Object(source),true).forEach((function(key){moving_average_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{moving_average_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function moving_average_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const movingAverage={name:"moving_average",type:"datatable",inputTypes:["datatable"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.movingAverage.help",{defaultMessage:"Calculates the moving average of a column in a data table"}),args:{by:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.movingAverage.args.byHelpText",{defaultMessage:"Column to split the moving average calculation by"}),multi:true,types:["string"],required:false},inputColumnId:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.movingAverage.args.inputColumnIdHelpText",{defaultMessage:"Column to calculate the moving average of"}),types:["string"],required:true},outputColumnId:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.movingAverage.args.outputColumnIdHelpText",{defaultMessage:"Column to store the resulting moving average in"}),types:["string"],required:true},outputColumnName:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.movingAverage.args.outputColumnNameHelpText",{defaultMessage:"Name of the column to store the resulting moving average in"}),types:["string"],required:false},window:{help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.functions.movingAverage.args.windowHelpText",{defaultMessage:'The size of window to "slide" across the histogram.'}),types:["number"],default:5}},fn(input,{by:by,inputColumnId:inputColumnId,outputColumnId:outputColumnId,outputColumnName:outputColumnName,window:window}){const resultColumns=Object(series_calculation_helpers["a"])(input,outputColumnId,inputColumnId,outputColumnName);if(!resultColumns){return input}const lastNValuesByBucket={};return moving_average_objectSpread(moving_average_objectSpread({},input),{},{columns:resultColumns,rows:input.rows.map(row=>{const newRow=moving_average_objectSpread({},row);const bucketIdentifier=Object(series_calculation_helpers["b"])(row,by);const lastNValues=lastNValuesByBucket[bucketIdentifier];const currentValue=newRow[inputColumnId];if(lastNValues!=null&&currentValue!=null){const sum=lastNValues.reduce((acc,current)=>acc+current,0);newRow[outputColumnId]=sum/lastNValues.length}else{newRow[outputColumnId]=undefined}if(currentValue!=null){lastNValuesByBucket[bucketIdentifier]=[...lastNValues||[],Number(currentValue)].slice(-window)}return newRow})})}};const functionSpecs=[clog,font,variableSet,variable,theme,cumulativeSum,derivative,movingAverage]},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/common/state_containers");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getType=getType;function getType(node){if(node==null)return"null";if(typeof node==="object"){if(!node.type)throw new Error("Objects must have a type property");return node.type}return typeof node}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/inspector/common");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return BackgroundRepeat}));__webpack_require__.d(__webpack_exports__,"b",(function(){return BackgroundSize}));__webpack_require__.d(__webpack_exports__,"c",(function(){return FontStyle}));__webpack_require__.d(__webpack_exports__,"d",(function(){return FontWeight}));__webpack_require__.d(__webpack_exports__,"e",(function(){return Overflow}));__webpack_require__.d(__webpack_exports__,"f",(function(){return TextAlignment}));__webpack_require__.d(__webpack_exports__,"g",(function(){return TextDecoration}));let BackgroundRepeat;(function(BackgroundRepeat){BackgroundRepeat["REPEAT"]="repeat";BackgroundRepeat["REPEAT_NO"]="no-repeat";BackgroundRepeat["REPEAT_X"]="repeat-x";BackgroundRepeat["REPEAT_Y"]="repeat-y";BackgroundRepeat["ROUND"]="round";BackgroundRepeat["SPACE"]="space"})(BackgroundRepeat||(BackgroundRepeat={}));let BackgroundSize;(function(BackgroundSize){BackgroundSize["AUTO"]="auto";BackgroundSize["CONTAIN"]="contain";BackgroundSize["COVER"]="cover"})(BackgroundSize||(BackgroundSize={}));let FontStyle;(function(FontStyle){FontStyle["ITALIC"]="italic";FontStyle["NORMAL"]="normal"})(FontStyle||(FontStyle={}));let FontWeight;(function(FontWeight){FontWeight["NORMAL"]="normal";FontWeight["BOLD"]="bold";FontWeight["BOLDER"]="bolder";FontWeight["LIGHTER"]="lighter";FontWeight["ONE"]="100";FontWeight["TWO"]="200";FontWeight["THREE"]="300";FontWeight["FOUR"]="400";FontWeight["FIVE"]="500";FontWeight["SIX"]="600";FontWeight["SEVEN"]="700";FontWeight["EIGHT"]="800";FontWeight["NINE"]="900"})(FontWeight||(FontWeight={}));let Overflow;(function(Overflow){Overflow["AUTO"]="auto";Overflow["HIDDEN"]="hidden";Overflow["SCROLL"]="scroll";Overflow["VISIBLE"]="visible"})(Overflow||(Overflow={}));let TextAlignment;(function(TextAlignment){TextAlignment["CENTER"]="center";TextAlignment["JUSTIFY"]="justify";TextAlignment["LEFT"]="left";TextAlignment["RIGHT"]="right"})(TextAlignment||(TextAlignment={}));let TextDecoration;(function(TextDecoration){TextDecoration["NONE"]="none";TextDecoration["UNDERLINE"]="underline"})(TextDecoration||(TextDecoration={}))},function(module,exports){},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"fromExpression",{enumerable:true,get:function get(){return _ast.fromExpression}});Object.defineProperty(exports,"toExpression",{enumerable:true,get:function get(){return _ast.toExpression}});Object.defineProperty(exports,"safeElementFromExpression",{enumerable:true,get:function get(){return _ast.safeElementFromExpression}});Object.defineProperty(exports,"Fn",{enumerable:true,get:function get(){return _fn.Fn}});Object.defineProperty(exports,"getType",{enumerable:true,get:function get(){return _get_type.getType}});Object.defineProperty(exports,"castProvider",{enumerable:true,get:function get(){return _cast.castProvider}});Object.defineProperty(exports,"parse",{enumerable:true,get:function get(){return _grammar.parse}});Object.defineProperty(exports,"getByAlias",{enumerable:true,get:function get(){return _get_by_alias.getByAlias}});Object.defineProperty(exports,"Registry",{enumerable:true,get:function get(){return _registry.Registry}});Object.defineProperty(exports,"addRegistries",{enumerable:true,get:function get(){return _registries.addRegistries}});Object.defineProperty(exports,"register",{enumerable:true,get:function get(){return _registries.register}});Object.defineProperty(exports,"registryFactory",{enumerable:true,get:function get(){return _registries.registryFactory}});var _ast=__webpack_require__(73);var _fn=__webpack_require__(74);var _get_type=__webpack_require__(37);var _cast=__webpack_require__(76);var _grammar=__webpack_require__(43);var _get_by_alias=__webpack_require__(77);var _registry=__webpack_require__(78);var _registries=__webpack_require__(79)},function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(44);var _defineProperty2=_interopRequireDefault(__webpack_require__(45));function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){(0,_defineProperty2.default)(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function peg$subclass(child,parent){function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor}function peg$SyntaxError(message,expected,found,location){this.message=message;this.expected=expected;this.found=found;this.location=location;this.name="SyntaxError";if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,peg$SyntaxError)}}peg$subclass(peg$SyntaxError,Error);peg$SyntaxError.buildMessage=function(expected,found){var DESCRIBE_EXPECTATION_FNS={literal:function literal(expectation){return'"'+literalEscape(expectation.text)+'"'},class:function _class(expectation){var escapedParts="",i;for(i=0;i<expectation.parts.length;i++){escapedParts+=expectation.parts[i]instanceof Array?classEscape(expectation.parts[i][0])+"-"+classEscape(expectation.parts[i][1]):classEscape(expectation.parts[i])}return"["+(expectation.inverted?"^":"")+escapedParts+"]"},any:function any(expectation){return"any character"},end:function end(expectation){return"end of input"},other:function other(expectation){return expectation.description}};function hex(ch){return ch.charCodeAt(0).toString(16).toUpperCase()}function literalEscape(s){return s.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(ch){return"\\x0"+hex(ch)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(ch){return"\\x"+hex(ch)}))}function classEscape(s){return s.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(ch){return"\\x0"+hex(ch)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(ch){return"\\x"+hex(ch)}))}function describeExpectation(expectation){return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation)}function describeExpected(expected){var descriptions=new Array(expected.length),i,j;for(i=0;i<expected.length;i++){descriptions[i]=describeExpectation(expected[i])}descriptions.sort();if(descriptions.length>0){for(i=1,j=1;i<descriptions.length;i++){if(descriptions[i-1]!==descriptions[i]){descriptions[j]=descriptions[i];j++}}descriptions.length=j}switch(descriptions.length){case 1:return descriptions[0];case 2:return descriptions[0]+" or "+descriptions[1];default:return descriptions.slice(0,-1).join(", ")+", or "+descriptions[descriptions.length-1]}}function describeFound(found){return found?'"'+literalEscape(found)+'"':"end of input"}return"Expected "+describeExpected(expected)+" but "+describeFound(found)+" found."};function peg$parse(input,options){options=options!==void 0?options:{};var peg$FAILED={},peg$startRuleFunctions={expression:peg$parseexpression,argument:peg$parseargument},peg$startRuleFunction=peg$parseexpression,peg$c0="|",peg$c1=peg$literalExpectation("|",false),peg$c2=function peg$c2(first,fn){return fn},peg$c3=function peg$c3(first,rest){return addMeta({type:"expression",chain:first?[first].concat(rest):[]},text(),location())},peg$c4=peg$otherExpectation("function"),peg$c5=function peg$c5(name,arg_list){return addMeta({type:"function",function:name,arguments:arg_list},text(),location())},peg$c6="=",peg$c7=peg$literalExpectation("=",false),peg$c8=function peg$c8(name,value){return{name:name,value:value}},peg$c9=function peg$c9(value){return{name:"_",value:value}},peg$c10="$",peg$c11=peg$literalExpectation("$",false),peg$c12="{",peg$c13=peg$literalExpectation("{",false),peg$c14="}",peg$c15=peg$literalExpectation("}",false),peg$c16=function peg$c16(expression){return expression},peg$c17=function peg$c17(value){return addMeta(value,text(),location())},peg$c18=function peg$c18(arg){return arg},peg$c19=function peg$c19(args){return args.reduce((accumulator,{name:name,value:value})=>_objectSpread(_objectSpread({},accumulator),{},{[name]:(accumulator[name]||[]).concat(value)}),{})},peg$c20=/^[a-zA-Z0-9_\-]/,peg$c21=peg$classExpectation([["a","z"],["A","Z"],["0","9"],"_","-"],false,false),peg$c22=function peg$c22(name){return name.join("")},peg$c23=peg$otherExpectation("literal"),peg$c24='"',peg$c25=peg$literalExpectation('"',false),peg$c26=function peg$c26(chars){return chars.join("")},peg$c27="'",peg$c28=peg$literalExpectation("'",false),peg$c29=function peg$c29(string){var result=string.join("");if(result==="null")return null;if(result==="true")return true;if(result==="false")return false;if(isNaN(Number(result)))return result;return Number(result)},peg$c30=/^[ \t\r\n]/,peg$c31=peg$classExpectation([" ","\t","\r","\n"],false,false),peg$c32="\\",peg$c33=peg$literalExpectation("\\",false),peg$c34=/^["'(){}<>[\]$`|= \t\n\r]/,peg$c35=peg$classExpectation(['"',"'","(",")","{","}","<",">","[","]","$","`","|","="," ","\t","\n","\r"],false,false),peg$c36=function peg$c36(sequence){return sequence},peg$c37=/^[^"'(){}<>[\]$`|= \t\n\r]/,peg$c38=peg$classExpectation(['"',"'","(",")","{","}","<",">","[","]","$","`","|","="," ","\t","\n","\r"],true,false),peg$c39=/^[^"]/,peg$c40=peg$classExpectation(['"'],true,false),peg$c41=/^[^']/,peg$c42=peg$classExpectation(["'"],true,false),peg$currPos=0,peg$savedPos=0,peg$posDetailsCache=[{line:1,column:1}],peg$maxFailPos=0,peg$maxFailExpected=[],peg$silentFails=0,peg$result;if("startRule"in options){if(!(options.startRule in peg$startRuleFunctions)){throw new Error("Can't start parsing from rule \""+options.startRule+'".')}peg$startRuleFunction=peg$startRuleFunctions[options.startRule]}function text(){return input.substring(peg$savedPos,peg$currPos)}function location(){return peg$computeLocation(peg$savedPos,peg$currPos)}function expected(description,location){location=location!==void 0?location:peg$computeLocation(peg$savedPos,peg$currPos);throw peg$buildStructuredError([peg$otherExpectation(description)],input.substring(peg$savedPos,peg$currPos),location)}function error(message,location){location=location!==void 0?location:peg$computeLocation(peg$savedPos,peg$currPos);throw peg$buildSimpleError(message,location)}function peg$literalExpectation(text,ignoreCase){return{type:"literal",text:text,ignoreCase:ignoreCase}}function peg$classExpectation(parts,inverted,ignoreCase){return{type:"class",parts:parts,inverted:inverted,ignoreCase:ignoreCase}}function peg$anyExpectation(){return{type:"any"}}function peg$endExpectation(){return{type:"end"}}function peg$otherExpectation(description){return{type:"other",description:description}}function peg$computePosDetails(pos){var details=peg$posDetailsCache[pos],p;if(details){return details}else{p=pos-1;while(!peg$posDetailsCache[p]){p--}details=peg$posDetailsCache[p];details={line:details.line,column:details.column};while(p<pos){if(input.charCodeAt(p)===10){details.line++;details.column=1}else{details.column++}p++}peg$posDetailsCache[pos]=details;return details}}function peg$computeLocation(startPos,endPos){var startPosDetails=peg$computePosDetails(startPos),endPosDetails=peg$computePosDetails(endPos);return{start:{offset:startPos,line:startPosDetails.line,column:startPosDetails.column},end:{offset:endPos,line:endPosDetails.line,column:endPosDetails.column}}}function peg$fail(expected){if(peg$currPos<peg$maxFailPos){return}if(peg$currPos>peg$maxFailPos){peg$maxFailPos=peg$currPos;peg$maxFailExpected=[]}peg$maxFailExpected.push(expected)}function peg$buildSimpleError(message,location){return new peg$SyntaxError(message,null,null,location)}function peg$buildStructuredError(expected,found,location){return new peg$SyntaxError(peg$SyntaxError.buildMessage(expected,found),expected,found,location)}function peg$parseexpression(){var s0,s1,s2,s3,s4,s5,s6,s7;s0=peg$currPos;s1=peg$parsespace();if(s1===peg$FAILED){s1=null}if(s1!==peg$FAILED){s2=peg$parsefunction();if(s2===peg$FAILED){s2=null}if(s2!==peg$FAILED){s3=[];s4=peg$currPos;if(input.charCodeAt(peg$currPos)===124){s5=peg$c0;peg$currPos++}else{s5=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c1)}}if(s5!==peg$FAILED){s6=peg$parsespace();if(s6===peg$FAILED){s6=null}if(s6!==peg$FAILED){s7=peg$parsefunction();if(s7!==peg$FAILED){peg$savedPos=s4;s5=peg$c2(s2,s7);s4=s5}else{peg$currPos=s4;s4=peg$FAILED}}else{peg$currPos=s4;s4=peg$FAILED}}else{peg$currPos=s4;s4=peg$FAILED}while(s4!==peg$FAILED){s3.push(s4);s4=peg$currPos;if(input.charCodeAt(peg$currPos)===124){s5=peg$c0;peg$currPos++}else{s5=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c1)}}if(s5!==peg$FAILED){s6=peg$parsespace();if(s6===peg$FAILED){s6=null}if(s6!==peg$FAILED){s7=peg$parsefunction();if(s7!==peg$FAILED){peg$savedPos=s4;s5=peg$c2(s2,s7);s4=s5}else{peg$currPos=s4;s4=peg$FAILED}}else{peg$currPos=s4;s4=peg$FAILED}}else{peg$currPos=s4;s4=peg$FAILED}}if(s3!==peg$FAILED){peg$savedPos=s0;s1=peg$c3(s2,s3);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}return s0}function peg$parsefunction(){var s0,s1,s2;peg$silentFails++;s0=peg$currPos;s1=peg$parseidentifier();if(s1!==peg$FAILED){s2=peg$parsearg_list();if(s2!==peg$FAILED){peg$savedPos=s0;s1=peg$c5(s1,s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}peg$silentFails--;if(s0===peg$FAILED){s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c4)}}return s0}function peg$parseargument_assignment(){var s0,s1,s2,s3,s4,s5;s0=peg$currPos;s1=peg$parseidentifier();if(s1!==peg$FAILED){s2=peg$parsespace();if(s2===peg$FAILED){s2=null}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===61){s3=peg$c6;peg$currPos++}else{s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c7)}}if(s3!==peg$FAILED){s4=peg$parsespace();if(s4===peg$FAILED){s4=null}if(s4!==peg$FAILED){s5=peg$parseargument();if(s5!==peg$FAILED){peg$savedPos=s0;s1=peg$c8(s1,s5);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){s0=peg$currPos;s1=peg$parseargument();if(s1!==peg$FAILED){peg$savedPos=s0;s1=peg$c9(s1)}s0=s1}return s0}function peg$parseargument(){var s0,s1,s2,s3,s4;s0=peg$currPos;if(input.charCodeAt(peg$currPos)===36){s1=peg$c10;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c11)}}if(s1===peg$FAILED){s1=null}if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===123){s2=peg$c12;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c13)}}if(s2!==peg$FAILED){s3=peg$parseexpression();if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===125){s4=peg$c14;peg$currPos++}else{s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c15)}}if(s4!==peg$FAILED){peg$savedPos=s0;s1=peg$c16(s3);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){s0=peg$currPos;s1=peg$parseliteral();if(s1!==peg$FAILED){peg$savedPos=s0;s1=peg$c17(s1)}s0=s1}return s0}function peg$parsearg_list(){var s0,s1,s2,s3,s4;s0=peg$currPos;s1=[];s2=peg$currPos;s3=peg$parsespace();if(s3!==peg$FAILED){s4=peg$parseargument_assignment();if(s4!==peg$FAILED){peg$savedPos=s2;s3=peg$c18(s4);s2=s3}else{peg$currPos=s2;s2=peg$FAILED}}else{peg$currPos=s2;s2=peg$FAILED}while(s2!==peg$FAILED){s1.push(s2);s2=peg$currPos;s3=peg$parsespace();if(s3!==peg$FAILED){s4=peg$parseargument_assignment();if(s4!==peg$FAILED){peg$savedPos=s2;s3=peg$c18(s4);s2=s3}else{peg$currPos=s2;s2=peg$FAILED}}else{peg$currPos=s2;s2=peg$FAILED}}if(s1!==peg$FAILED){s2=peg$parsespace();if(s2===peg$FAILED){s2=null}if(s2!==peg$FAILED){peg$savedPos=s0;s1=peg$c19(s1);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}return s0}function peg$parseidentifier(){var s0,s1,s2;s0=peg$currPos;s1=[];if(peg$c20.test(input.charAt(peg$currPos))){s2=input.charAt(peg$currPos);peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c21)}}if(s2!==peg$FAILED){while(s2!==peg$FAILED){s1.push(s2);if(peg$c20.test(input.charAt(peg$currPos))){s2=input.charAt(peg$currPos);peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c21)}}}}else{s1=peg$FAILED}if(s1!==peg$FAILED){peg$savedPos=s0;s1=peg$c22(s1)}s0=s1;return s0}function peg$parseliteral(){var s0,s1;peg$silentFails++;s0=peg$parsephrase();if(s0===peg$FAILED){s0=peg$parseunquoted_string_or_number()}peg$silentFails--;if(s0===peg$FAILED){s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c23)}}return s0}function peg$parsephrase(){var s0,s1,s2,s3;s0=peg$currPos;if(input.charCodeAt(peg$currPos)===34){s1=peg$c24;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c25)}}if(s1!==peg$FAILED){s2=[];s3=peg$parsedq_char();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parsedq_char()}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===34){s3=peg$c24;peg$currPos++}else{s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c25)}}if(s3!==peg$FAILED){peg$savedPos=s0;s1=peg$c26(s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){s0=peg$currPos;if(input.charCodeAt(peg$currPos)===39){s1=peg$c27;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c28)}}if(s1!==peg$FAILED){s2=[];s3=peg$parsesq_char();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parsesq_char()}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===39){s3=peg$c27;peg$currPos++}else{s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c28)}}if(s3!==peg$FAILED){peg$savedPos=s0;s1=peg$c26(s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}}return s0}function peg$parseunquoted_string_or_number(){var s0,s1,s2;s0=peg$currPos;s1=[];s2=peg$parseunquoted();if(s2!==peg$FAILED){while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseunquoted()}}else{s1=peg$FAILED}if(s1!==peg$FAILED){peg$savedPos=s0;s1=peg$c29(s1)}s0=s1;return s0}function peg$parsespace(){var s0,s1;s0=[];if(peg$c30.test(input.charAt(peg$currPos))){s1=input.charAt(peg$currPos);peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c31)}}if(s1!==peg$FAILED){while(s1!==peg$FAILED){s0.push(s1);if(peg$c30.test(input.charAt(peg$currPos))){s1=input.charAt(peg$currPos);peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c31)}}}}else{s0=peg$FAILED}return s0}function peg$parseunquoted(){var s0,s1,s2;s0=peg$currPos;if(input.charCodeAt(peg$currPos)===92){s1=peg$c32;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}if(s1!==peg$FAILED){if(peg$c34.test(input.charAt(peg$currPos))){s2=input.charAt(peg$currPos);peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c35)}}if(s2===peg$FAILED){if(input.charCodeAt(peg$currPos)===92){s2=peg$c32;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}}if(s2!==peg$FAILED){peg$savedPos=s0;s1=peg$c36(s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){if(peg$c37.test(input.charAt(peg$currPos))){s0=input.charAt(peg$currPos);peg$currPos++}else{s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c38)}}}return s0}function peg$parsedq_char(){var s0,s1,s2;s0=peg$currPos;if(input.charCodeAt(peg$currPos)===92){s1=peg$c32;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===34){s2=peg$c24;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c25)}}if(s2===peg$FAILED){if(input.charCodeAt(peg$currPos)===92){s2=peg$c32;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}}if(s2!==peg$FAILED){peg$savedPos=s0;s1=peg$c36(s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){if(peg$c39.test(input.charAt(peg$currPos))){s0=input.charAt(peg$currPos);peg$currPos++}else{s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c40)}}}return s0}function peg$parsesq_char(){var s0,s1,s2;s0=peg$currPos;if(input.charCodeAt(peg$currPos)===92){s1=peg$c32;peg$currPos++}else{s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===39){s2=peg$c27;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c28)}}if(s2===peg$FAILED){if(input.charCodeAt(peg$currPos)===92){s2=peg$c32;peg$currPos++}else{s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c33)}}}if(s2!==peg$FAILED){peg$savedPos=s0;s1=peg$c36(s2);s0=s1}else{peg$currPos=s0;s0=peg$FAILED}}else{peg$currPos=s0;s0=peg$FAILED}if(s0===peg$FAILED){if(peg$c41.test(input.charAt(peg$currPos))){s0=input.charAt(peg$currPos);peg$currPos++}else{s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c42)}}}return s0}function addMeta(node,text,{start:{offset:start},end:{offset:end}}){if(!options.addMeta)return node;return{node:node,text:text,start:start,end:end}}peg$result=peg$startRuleFunction();if(peg$result!==peg$FAILED&&peg$currPos===input.length){return peg$result}else{if(peg$result!==peg$FAILED&&peg$currPos<input.length){peg$fail(peg$endExpectation())}throw peg$buildStructuredError(peg$maxFailExpected,peg$maxFailPos<input.length?input.charAt(peg$maxFailPos):null,peg$maxFailPos<input.length?peg$computeLocation(peg$maxFailPos,peg$maxFailPos+1):peg$computeLocation(peg$maxFailPos,peg$maxFailPos))}}module.exports={SyntaxError:peg$SyntaxError,parse:peg$parse}},function(module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}module.exports=_interopRequireDefault},function(module,exports){function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}module.exports=_defineProperty},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return formatExpression}));var _format__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8);function formatExpression(ast){return Object(_format__WEBPACK_IMPORTED_MODULE_0__["a"])(ast,"expression")}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return parseExpression}));var _parse__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14);function parseExpression(expression){return Object(_parse__WEBPACK_IMPORTED_MODULE_0__["a"])(expression,"expression")}},function(module,exports){},function(module,exports){},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return serializeProvider}));var _get_type__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6);const identity=x=>x;const serializeProvider=types=>({serialize:value=>(types[Object(_get_type__WEBPACK_IMPORTED_MODULE_0__["a"])(value)].serialize||identity)(value),deserialize:value=>(types[Object(_get_type__WEBPACK_IMPORTED_MODULE_0__["a"])(value)].deserialize||identity)(value)})},function(module,exports){},function(module,exports){},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ExpressionFunction}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);var _expression_function_parameter__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(27);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class ExpressionFunction{constructor(functionDefinition){_defineProperty(this,"name",void 0);_defineProperty(this,"aliases",void 0);_defineProperty(this,"type",void 0);_defineProperty(this,"fn",void 0);_defineProperty(this,"help",void 0);_defineProperty(this,"args",{});_defineProperty(this,"inputTypes",void 0);_defineProperty(this,"disabled",void 0);_defineProperty(this,"telemetry",void 0);_defineProperty(this,"extract",void 0);_defineProperty(this,"inject",void 0);_defineProperty(this,"migrations",void 0);_defineProperty(this,"accepts",type=>{if(!this.inputTypes)return true;return this.inputTypes.indexOf(type)>-1});const name=functionDefinition.name,_type=functionDefinition.type,aliases=functionDefinition.aliases,fn=functionDefinition.fn,help=functionDefinition.help,args=functionDefinition.args,inputTypes=functionDefinition.inputTypes,context=functionDefinition.context,disabled=functionDefinition.disabled,telemetry=functionDefinition.telemetry,inject=functionDefinition.inject,extract=functionDefinition.extract,migrations=functionDefinition.migrations;this.name=name;this.type=_type;this.aliases=aliases||[];this.fn=(input,params,handlers)=>Promise.resolve(fn(input,params,handlers));this.help=help||"";this.inputTypes=inputTypes||(context===null||context===void 0?void 0:context.types);this.disabled=disabled||false;this.telemetry=telemetry||((s,c)=>c);this.inject=inject||lodash__WEBPACK_IMPORTED_MODULE_0__["identity"];this.extract=extract||(s=>({state:s,references:[]}));this.migrations=migrations||{};for(var _i=0,_Object$entries=Object.entries(args||{});_i<_Object$entries.length;_i++){const _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],arg=_Object$entries$_i[1];this.args[key]=new _expression_function_parameter__WEBPACK_IMPORTED_MODULE_1__["a"](key,arg)}}}},function(module,exports){},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ExpressionRendererRegistry}));var _expression_renderer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(29);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class ExpressionRendererRegistry{constructor(){_defineProperty(this,"renderers",new Map)}register(definition){if(typeof definition==="function")definition=definition();const renderer=new _expression_renderer__WEBPACK_IMPORTED_MODULE_0__["a"](definition);this.renderers.set(renderer.name,renderer)}get(id){return this.renderers.get(id)||null}toJS(){return this.toArray().reduce((acc,renderer)=>_objectSpread(_objectSpread({},acc),{},{[renderer.name]:renderer}),{})}toArray(){return[...this.renderers.values()]}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(57);var _types__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_types__WEBPACK_IMPORTED_MODULE_0__);for(var __WEBPACK_IMPORT_KEY__ in _types__WEBPACK_IMPORTED_MODULE_0__)if(["default"].indexOf(__WEBPACK_IMPORT_KEY__)<0)(function(key){__webpack_require__.d(__webpack_exports__,key,(function(){return _types__WEBPACK_IMPORTED_MODULE_0__[key]}))})(__WEBPACK_IMPORT_KEY__);var _container__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(31);__webpack_require__.d(__webpack_exports__,"executionPureTransitions",(function(){return _container__WEBPACK_IMPORTED_MODULE_1__["b"]}));__webpack_require__.d(__webpack_exports__,"createExecutionContainer",(function(){return _container__WEBPACK_IMPORTED_MODULE_1__["a"]}));var _execution__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(30);__webpack_require__.d(__webpack_exports__,"Execution",(function(){return _execution__WEBPACK_IMPORTED_MODULE_2__["a"]}));var _execution_contract__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(32);__webpack_require__.d(__webpack_exports__,"ExecutionContract",(function(){return _execution_contract__WEBPACK_IMPORTED_MODULE_3__["a"]}))},function(module,exports){},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return expressions_services_ExpressionsService}));var executor=__webpack_require__(16);var expression_renderers=__webpack_require__(28);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class expressions_services_ExpressionsService{constructor({executor:_executor=executor["a"].createWithDefaults(),renderers:_renderers=new expression_renderers["ExpressionRendererRegistry"]}={}){_defineProperty(this,"executor",void 0);_defineProperty(this,"renderers",void 0);_defineProperty(this,"registerFunction",functionDefinition=>this.executor.registerFunction(functionDefinition));_defineProperty(this,"registerType",typeDefinition=>this.executor.registerType(typeDefinition));_defineProperty(this,"registerRenderer",definition=>this.renderers.register(definition));_defineProperty(this,"run",(ast,input,params)=>this.executor.run(ast,input,params));_defineProperty(this,"getFunction",name=>this.executor.getFunction(name));_defineProperty(this,"getFunctions",()=>this.executor.getFunctions());_defineProperty(this,"getRenderer",name=>this.renderers.get(name));_defineProperty(this,"getRenderers",()=>this.renderers.toJS());_defineProperty(this,"getType",name=>this.executor.getType(name));_defineProperty(this,"getTypes",()=>this.executor.getTypes());_defineProperty(this,"execute",(ast,input,params)=>{const execution=this.executor.createExecution(ast,params);execution.start(input);return execution.contract});_defineProperty(this,"fork",()=>{const executor=this.executor.fork();const renderers=this.renderers;const fork=new expressions_services_ExpressionsService({executor:executor,renderers:renderers});return fork});_defineProperty(this,"telemetry",(state,telemetryData={})=>this.executor.telemetry(state,telemetryData));_defineProperty(this,"extract",state=>this.executor.extract(state));_defineProperty(this,"inject",(state,references)=>this.executor.inject(state,references));_defineProperty(this,"migrate",(state,version)=>this.executor.migrate(state,version));this.executor=_executor;this.renderers=_renderers}setup(){return this}start(){return this}stop(){}}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){"use strict";var hasOwn={}.hasOwnProperty;function classNames(){var classes=[];for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(!arg)continue;var argType=typeof arg;if(argType==="string"||argType==="number"){classes.push(arg)}else if(Array.isArray(arg)&&arg.length){var inner=classNames.apply(null,arg);if(inner){classes.push(inner)}}else if(argType==="object"){for(var key in arg){if(hasOwn.call(arg,key)&&arg[key]){classes.push(key)}}}}return classes.join(" ")}if(true&&module.exports){classNames.default=classNames;module.exports=classNames}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{}})()},function(module,exports){module.exports=__kbnSharedDeps__.Theme.euiLightVars},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(80);var fast_shallow_equal_1=__webpack_require__(81);var useCustomCompareEffect_1=tslib_1.__importDefault(__webpack_require__(82));var isPrimitive=function(val){return val!==Object(val)};var shallowEqualDepsList=function(prevDeps,nextDeps){return prevDeps.every((function(dep,index){return fast_shallow_equal_1.equal(dep,nextDeps[index])}))};var useShallowCompareEffect=function(effect,deps){if(false){}useCustomCompareEffect_1.default(effect,deps,shallowEqualDepsList)};exports.default=useShallowCompareEffect},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_val_loader_dist_cjs_js_key_expressions_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(63);var _node_modules_val_loader_dist_cjs_js_key_expressions_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_val_loader_dist_cjs_js_key_expressions_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__);__kbnBundles__.define("plugin/expressions/public",__webpack_require__,83);__kbnBundles__.define("plugin/expressions/common",__webpack_require__,0);__kbnBundles__.define("plugin/expressions/common/fonts",__webpack_require__,19)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__["expressions"]},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(65);case"v7light":return __webpack_require__(67);case"v8dark":return __webpack_require__(69);case"v8light":return __webpack_require__(71)}},function(module,exports,__webpack_require__){var api=__webpack_require__(21);var content=__webpack_require__(66);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(22);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,"/* Expressions plugin styles */\n.expExpressionRenderer {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%; }\n\n.expExpressionRenderer__expression {\n  width: 100%;\n  height: 100%; }\n\n.expExpressionRenderer-isEmpty .expExpressionRenderer__expression,\n.expExpressionRenderer-hasError .expExpressionRenderer__expression {\n  display: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(21);var content=__webpack_require__(68);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(22);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,"/* Expressions plugin styles */\n.expExpressionRenderer {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%; }\n\n.expExpressionRenderer__expression {\n  width: 100%;\n  height: 100%; }\n\n.expExpressionRenderer-isEmpty .expExpressionRenderer__expression,\n.expExpressionRenderer-hasError .expExpressionRenderer__expression {\n  display: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(21);var content=__webpack_require__(70);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(22);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,"/* Expressions plugin styles */\n.expExpressionRenderer {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%; }\n\n.expExpressionRenderer__expression {\n  width: 100%;\n  height: 100%; }\n\n.expExpressionRenderer-isEmpty .expExpressionRenderer__expression,\n.expExpressionRenderer-hasError .expExpressionRenderer__expression {\n  display: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(21);var content=__webpack_require__(72);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(22);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,"/* Expressions plugin styles */\n.expExpressionRenderer {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%; }\n\n.expExpressionRenderer__expression {\n  width: 100%;\n  height: 100%; }\n\n.expExpressionRenderer-isEmpty .expExpressionRenderer__expression,\n.expExpressionRenderer-hasError .expExpressionRenderer__expression {\n  display: none; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fromExpression=fromExpression;exports.safeElementFromExpression=safeElementFromExpression;exports.toExpression=toExpression;var _get_type=__webpack_require__(37);var _grammar=__webpack_require__(43);function getArgumentString(arg,argKey,level=0){const type=(0,_get_type.getType)(arg);function maybeArgKey(argKey,argString){return argKey==null||argKey==="_"?argString:"".concat(argKey,"=").concat(argString)}if(type==="string"){const escapedArg=arg.replace(/[\\"]/g,"\\$&");return maybeArgKey(argKey,'"'.concat(escapedArg,'"'))}if(type==="boolean"||type==="null"||type==="number"){return maybeArgKey(argKey,"".concat(arg))}if(type==="expression"){return maybeArgKey(argKey,"{".concat(getExpression(arg.chain,level+1),"}"))}throw new Error("Invalid argument type in AST: ".concat(type))}function getExpressionArgs(block,level=0){const args=block.arguments;const hasValidArgs=typeof args==="object"&&args!=null&&!Array.isArray(args);if(!hasValidArgs)throw new Error("Arguments can only be an object");const argKeys=Object.keys(args);const MAX_LINE_LENGTH=80;return argKeys.map(argKey=>args[argKey].reduce((acc,arg)=>{const argString=getArgumentString(arg,argKey,level);const lineLength=acc.split("\n").pop().length;if(level===0&&lineLength+argString.length>MAX_LINE_LENGTH){return"".concat(acc,"\n  ").concat(argString)}if(lineLength>0)return"".concat(acc," ").concat(argString);return argString},""))}function fnWithArgs(fnName,args){if(!args||args.length===0)return fnName;return"".concat(fnName," ").concat(args.join(" "))}function getExpression(chain,level=0){if(!chain)throw new Error("Expressions must contain a chain");const separator=level>0?" | ":"\n| ";return chain.map(chainObj=>{const type=(0,_get_type.getType)(chainObj);if(type==="function"){const fn=chainObj.function;if(!fn||fn.length===0)throw new Error("Functions must have a function name");const expArgs=getExpressionArgs(chainObj,level);return fnWithArgs(fn,expArgs)}},[]).join(separator)}function fromExpression(expression,type="expression"){try{return(0,_grammar.parse)(String(expression),{startRule:type})}catch(e){throw new Error("Unable to parse expression: ".concat(e.message))}}function safeElementFromExpression(expression){try{return fromExpression(expression)}catch(e){return fromExpression("markdown\n\"## Crud.\nCanvas could not parse this element's expression. I am so sorry this error isn't more useful. I promise it will be soon.\n\nThanks for understanding,\n#### Management\n\"")}}function toExpression(astObj,type="expression"){if(type==="argument")return getArgumentString(astObj);const validType=["expression","function"].includes((0,_get_type.getType)(astObj));if(!validType)throw new Error("Expression must be an expression or argument function");if((0,_get_type.getType)(astObj)==="expression"){if(!Array.isArray(astObj.chain))throw new Error("Expressions must contain a chain");return getExpression(astObj.chain)}const expArgs=getExpressionArgs(astObj);return fnWithArgs(astObj.function,expArgs)}},function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(44);Object.defineProperty(exports,"__esModule",{value:true});exports.Fn=Fn;var _defineProperty2=_interopRequireDefault(__webpack_require__(45));var _lodash=__webpack_require__(2);var _arg=__webpack_require__(75);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){(0,_defineProperty2.default)(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function Fn(config){this.name=config.name;this.type=config.type;this.aliases=config.aliases||[];this.fn=(...args)=>Promise.resolve(config.fn(...args));this.help=config.help||"";this.args=(0,_lodash.mapValues)(config.args||{},(arg,name)=>new _arg.Arg(_objectSpread({name:name},arg)));this.context=config.context||{};this.accepts=type=>{if(!this.context.types)return true;return(0,_lodash.includes)(this.context.types,type)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Arg=Arg;var _lodash=__webpack_require__(2);function Arg(config){if(config.name==="_")throw Error("Arg names must not be _. Use it in aliases instead.");this.name=config.name;this.required=config.required||false;this.help=config.help||"";this.types=config.types||[];this.default=config.default;this.aliases=config.aliases||[];this.multi=config.multi==null?false:config.multi;this.resolve=config.resolve==null?true:config.resolve;this.options=config.options||[];this.accepts=type=>{if(!this.types.length)return true;return(0,_lodash.includes)(config.types,type)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.castProvider=castProvider;var _get_type=__webpack_require__(37);function castProvider(types){return function cast(node,toTypeNames){if(!toTypeNames||toTypeNames.length===0)return node;const fromTypeName=(0,_get_type.getType)(node);if(toTypeNames.includes(fromTypeName))return node;const fromTypeDef=types[fromTypeName];for(let i=0;i<toTypeNames.length;i++){if(fromTypeDef&&fromTypeDef.castsTo(toTypeNames[i])){return fromTypeDef.to(node,toTypeNames[i],types)}const toTypeDef=types[toTypeNames[i]];if(toTypeDef&&toTypeDef.castsFrom(fromTypeName))return toTypeDef.from(node,types)}throw new Error("Can not cast '".concat(fromTypeName,"' to any of '").concat(toTypeNames.join(", "),"'"))}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getByAlias=getByAlias;function getByAlias(specs,name){const lowerCaseName=name.toLowerCase();return Object.values(specs).find(({name:name,aliases:aliases})=>{if(name.toLowerCase()===lowerCaseName)return true;return(aliases||[]).some(alias=>alias.toLowerCase()===lowerCaseName)})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Registry=void 0;var _lodash=__webpack_require__(2);class Registry{constructor(prop="name"){if(typeof prop!=="string")throw new Error("Registry property name must be a string");this._prop=prop;this._indexed=new Object}wrapper(obj){return obj}register(fn){const obj=typeof fn==="function"?fn():fn;if(typeof obj!=="object"||!obj[this._prop]){throw new Error("Registered functions must return an object with a ".concat(this._prop," property"))}this._indexed[obj[this._prop].toLowerCase()]=this.wrapper(obj)}toJS(){return Object.keys(this._indexed).reduce((acc,key)=>{acc[key]=this.get(key);return acc},{})}toArray(){return Object.keys(this._indexed).map(key=>this.get(key))}get(name){if(name===undefined)return null;const lowerCaseName=name.toLowerCase();return this._indexed[lowerCaseName]?(0,_lodash.clone)(this._indexed[lowerCaseName]):null}getProp(){return this._prop}reset(){this._indexed=new Object}}exports.Registry=Registry},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.addRegistries=addRegistries;exports.register=register;exports.registryFactory=registryFactory;function addRegistries(registries,newRegistries){Object.keys(newRegistries).forEach(registryName=>{if(registries[registryName]){throw new Error('There is already a registry named "'.concat(registryName,'".'))}registries[registryName]=newRegistries[registryName]});return registries}function register(registries,specs){Object.keys(specs).forEach(registryName=>{if(!registries[registryName]){throw new Error('There is no registry named "'.concat(registryName,'".'))}if(!registries[registryName].register){throw new Error('Registry "'.concat(registryName,'" must have a register function.'))}specs[registryName].forEach(f=>registries[registryName].register(f))});return registries}function registryFactory(registries){return{registries(){return registries},register(specs){return register(registries,specs)}}}},function(module,exports){module.exports=__kbnSharedDeps__.TsLib},function(module,exports){var keyList=Object.keys;exports.equal=function equal(a,b){if(a===b)return true;if(!(a instanceof Object)||!(b instanceof Object))return false;var keys=keyList(a);var length=keys.length;for(var i=0;i<length;i++)if(!(keys[i]in b))return false;for(var i=0;i<length;i++)if(a[keys[i]]!==b[keys[i]])return false;return length===keyList(b).length}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(3);var isPrimitive=function(val){return val!==Object(val)};var useCustomCompareEffect=function(effect,deps,depsEqual){if(false){}var ref=react_1.useRef(undefined);if(!ref.current||!depsEqual(deps,ref.current)){ref.current=deps}react_1.useEffect(effect,ref.current)};exports.default=useCustomCompareEffect},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"Plugin",(function(){return plugin_ExpressionsPublicPlugin}));__webpack_require__.d(__webpack_exports__,"ExpressionsPublicPlugin",(function(){return plugin_ExpressionsPublicPlugin}));__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));__webpack_require__.d(__webpack_exports__,"ExpressionExecutor",(function(){return types["ExpressionExecutor"]}));__webpack_require__.d(__webpack_exports__,"IExpressionLoaderParams",(function(){return types["IExpressionLoaderParams"]}));__webpack_require__.d(__webpack_exports__,"ExpressionRenderError",(function(){return types["ExpressionRenderError"]}));__webpack_require__.d(__webpack_exports__,"ExpressionRendererComponent",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"ReactExpressionRenderer",(function(){return ReactExpressionRenderer}));__webpack_require__.d(__webpack_exports__,"ReactExpressionRendererProps",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"ReactExpressionRendererType",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"ExpressionRenderHandler",(function(){return render_ExpressionRenderHandler}));__webpack_require__.d(__webpack_exports__,"ExpressionRendererEvent",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"AnyExpressionFunctionDefinition",(function(){return common["AnyExpressionFunctionDefinition"]}));__webpack_require__.d(__webpack_exports__,"AnyExpressionTypeDefinition",(function(){return common["AnyExpressionTypeDefinition"]}));__webpack_require__.d(__webpack_exports__,"ArgumentType",(function(){return common["ArgumentType"]}));__webpack_require__.d(__webpack_exports__,"buildExpression",(function(){return common["buildExpression"]}));__webpack_require__.d(__webpack_exports__,"buildExpressionFunction",(function(){return common["buildExpressionFunction"]}));__webpack_require__.d(__webpack_exports__,"Datatable",(function(){return common["Datatable"]}));__webpack_require__.d(__webpack_exports__,"DatatableColumn",(function(){return common["DatatableColumn"]}));__webpack_require__.d(__webpack_exports__,"DatatableColumnType",(function(){return common["DatatableColumnType"]}));__webpack_require__.d(__webpack_exports__,"DatatableRow",(function(){return common["DatatableRow"]}));__webpack_require__.d(__webpack_exports__,"Execution",(function(){return common["Execution"]}));__webpack_require__.d(__webpack_exports__,"ExecutionContract",(function(){return common["ExecutionContract"]}));__webpack_require__.d(__webpack_exports__,"ExecutionContainer",(function(){return common["ExecutionContainer"]}));__webpack_require__.d(__webpack_exports__,"ExecutionContext",(function(){return common["ExecutionContext"]}));__webpack_require__.d(__webpack_exports__,"ExecutionParams",(function(){return common["ExecutionParams"]}));__webpack_require__.d(__webpack_exports__,"ExecutionState",(function(){return common["ExecutionState"]}));__webpack_require__.d(__webpack_exports__,"Executor",(function(){return common["Executor"]}));__webpack_require__.d(__webpack_exports__,"ExecutorContainer",(function(){return common["ExecutorContainer"]}));__webpack_require__.d(__webpack_exports__,"ExecutorState",(function(){return common["ExecutorState"]}));__webpack_require__.d(__webpack_exports__,"ExpressionAstArgument",(function(){return common["ExpressionAstArgument"]}));__webpack_require__.d(__webpack_exports__,"ExpressionAstExpression",(function(){return common["ExpressionAstExpression"]}));__webpack_require__.d(__webpack_exports__,"ExpressionAstExpressionBuilder",(function(){return common["ExpressionAstExpressionBuilder"]}));__webpack_require__.d(__webpack_exports__,"ExpressionAstFunction",(function(){return common["ExpressionAstFunction"]}));__webpack_require__.d(__webpack_exports__,"ExpressionAstFunctionBuilder",(function(){return common["ExpressionAstFunctionBuilder"]}));__webpack_require__.d(__webpack_exports__,"ExpressionAstNode",(function(){return common["ExpressionAstNode"]}));__webpack_require__.d(__webpack_exports__,"ExpressionFunction",(function(){return common["ExpressionFunction"]}));__webpack_require__.d(__webpack_exports__,"ExpressionFunctionDefinition",(function(){return common["ExpressionFunctionDefinition"]}));__webpack_require__.d(__webpack_exports__,"ExpressionFunctionDefinitions",(function(){return common["ExpressionFunctionDefinitions"]}));__webpack_require__.d(__webpack_exports__,"ExpressionFunctionParameter",(function(){return common["ExpressionFunctionParameter"]}));__webpack_require__.d(__webpack_exports__,"ExpressionImage",(function(){return common["ExpressionImage"]}));__webpack_require__.d(__webpack_exports__,"ExpressionRenderDefinition",(function(){return common["ExpressionRenderDefinition"]}));__webpack_require__.d(__webpack_exports__,"ExpressionRenderer",(function(){return common["ExpressionRenderer"]}));__webpack_require__.d(__webpack_exports__,"ExpressionRendererRegistry",(function(){return common["ExpressionRendererRegistry"]}));__webpack_require__.d(__webpack_exports__,"ExpressionType",(function(){return common["ExpressionType"]}));__webpack_require__.d(__webpack_exports__,"ExpressionTypeDefinition",(function(){return common["ExpressionTypeDefinition"]}));__webpack_require__.d(__webpack_exports__,"ExpressionTypeStyle",(function(){return common["ExpressionTypeStyle"]}));__webpack_require__.d(__webpack_exports__,"ExpressionValue",(function(){return common["ExpressionValue"]}));__webpack_require__.d(__webpack_exports__,"ExpressionValueBoxed",(function(){return common["ExpressionValueBoxed"]}));__webpack_require__.d(__webpack_exports__,"ExpressionValueConverter",(function(){return common["ExpressionValueConverter"]}));__webpack_require__.d(__webpack_exports__,"ExpressionValueError",(function(){return common["ExpressionValueError"]}));__webpack_require__.d(__webpack_exports__,"ExpressionValueNum",(function(){return common["ExpressionValueNum"]}));__webpack_require__.d(__webpack_exports__,"ExpressionValueRender",(function(){return common["ExpressionValueRender"]}));__webpack_require__.d(__webpack_exports__,"ExpressionValueUnboxed",(function(){return common["ExpressionValueUnboxed"]}));__webpack_require__.d(__webpack_exports__,"ExpressionValueFilter",(function(){return common["ExpressionValueFilter"]}));__webpack_require__.d(__webpack_exports__,"Font",(function(){return common["Font"]}));__webpack_require__.d(__webpack_exports__,"FontLabel",(function(){return common["FontLabel"]}));__webpack_require__.d(__webpack_exports__,"FontStyle",(function(){return common["FontStyle"]}));__webpack_require__.d(__webpack_exports__,"FontValue",(function(){return common["FontValue"]}));__webpack_require__.d(__webpack_exports__,"FontWeight",(function(){return common["FontWeight"]}));__webpack_require__.d(__webpack_exports__,"format",(function(){return common["format"]}));__webpack_require__.d(__webpack_exports__,"formatExpression",(function(){return common["formatExpression"]}));__webpack_require__.d(__webpack_exports__,"FunctionsRegistry",(function(){return common["FunctionsRegistry"]}));__webpack_require__.d(__webpack_exports__,"IInterpreterRenderHandlers",(function(){return common["IInterpreterRenderHandlers"]}));__webpack_require__.d(__webpack_exports__,"InterpreterErrorType",(function(){return common["InterpreterErrorType"]}));__webpack_require__.d(__webpack_exports__,"IRegistry",(function(){return common["IRegistry"]}));__webpack_require__.d(__webpack_exports__,"isExpressionAstBuilder",(function(){return common["isExpressionAstBuilder"]}));__webpack_require__.d(__webpack_exports__,"KnownTypeToString",(function(){return common["KnownTypeToString"]}));__webpack_require__.d(__webpack_exports__,"Overflow",(function(){return common["Overflow"]}));__webpack_require__.d(__webpack_exports__,"parse",(function(){return common["parse"]}));__webpack_require__.d(__webpack_exports__,"parseExpression",(function(){return common["parseExpression"]}));__webpack_require__.d(__webpack_exports__,"PointSeries",(function(){return common["PointSeries"]}));__webpack_require__.d(__webpack_exports__,"PointSeriesColumn",(function(){return common["PointSeriesColumn"]}));__webpack_require__.d(__webpack_exports__,"PointSeriesColumnName",(function(){return common["PointSeriesColumnName"]}));__webpack_require__.d(__webpack_exports__,"PointSeriesColumns",(function(){return common["PointSeriesColumns"]}));__webpack_require__.d(__webpack_exports__,"PointSeriesRow",(function(){return common["PointSeriesRow"]}));__webpack_require__.d(__webpack_exports__,"Range",(function(){return common["Range"]}));__webpack_require__.d(__webpack_exports__,"SerializedDatatable",(function(){return common["SerializedDatatable"]}));__webpack_require__.d(__webpack_exports__,"SerializedFieldFormat",(function(){return common["SerializedFieldFormat"]}));__webpack_require__.d(__webpack_exports__,"Style",(function(){return common["Style"]}));__webpack_require__.d(__webpack_exports__,"TextAlignment",(function(){return common["TextAlignment"]}));__webpack_require__.d(__webpack_exports__,"TextDecoration",(function(){return common["TextDecoration"]}));__webpack_require__.d(__webpack_exports__,"TypesRegistry",(function(){return common["TypesRegistry"]}));__webpack_require__.d(__webpack_exports__,"TypeString",(function(){return common["TypeString"]}));__webpack_require__.d(__webpack_exports__,"TypeToString",(function(){return common["TypeToString"]}));__webpack_require__.d(__webpack_exports__,"UnmappedTypeStrings",(function(){return common["UnmappedTypeStrings"]}));__webpack_require__.d(__webpack_exports__,"Render",(function(){return common["ExpressionValueRender"]}));__webpack_require__.d(__webpack_exports__,"ExpressionsService",(function(){return common["ExpressionsService"]}));__webpack_require__.d(__webpack_exports__,"ExpressionsServiceSetup",(function(){return common["ExpressionsServiceSetup"]}));__webpack_require__.d(__webpack_exports__,"ExpressionsServiceStart",(function(){return common["ExpressionsServiceStart"]}));var public_0=__webpack_require__(64);var common=__webpack_require__(0);var public_=__webpack_require__(36);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const _createGetterSetter=Object(public_["createGetterSetter"])("Notifications"),_createGetterSetter2=_slicedToArray(_createGetterSetter,2),getNotifications=_createGetterSetter2[0],setNotifications=_createGetterSetter2[1];const _createGetterSetter3=Object(public_["createGetterSetter"])("Renderers registry"),_createGetterSetter4=_slicedToArray(_createGetterSetter3,2),getRenderersRegistry=_createGetterSetter4[0],setRenderersRegistry=_createGetterSetter4[1];const _createGetterSetter5=Object(public_["createGetterSetter"])("ExpressionsService"),_createGetterSetter6=_slicedToArray(_createGetterSetter5,2),getExpressionsService=_createGetterSetter6[0],setExpressionsService=_createGetterSetter6[1];var external_kbnSharedDeps_React_=__webpack_require__(3);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var classnames=__webpack_require__(59);var classnames_default=__webpack_require__.n(classnames);var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(11);var useShallowCompareEffect=__webpack_require__(61);var useShallowCompareEffect_default=__webpack_require__.n(useShallowCompareEffect);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(39);var external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(60);var external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_);var external_kbnSharedDeps_Rxjs_=__webpack_require__(12);var external_kbnSharedDeps_Lodash_=__webpack_require__(2);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);const renderErrorHandler=(element,error,handlers)=>{if(error.name==="AbortError"){handlers.done();return}getNotifications().toasts.addError(error,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("expressions.defaultErrorRenderer.errorTitle",{defaultMessage:"Error in visualisation"}),toastMessage:error.message});handlers.done()};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class render_ExpressionRenderHandler{constructor(element,{onRenderError:onRenderError,renderMode:renderMode}={}){var _this=this;_defineProperty(this,"render$",void 0);_defineProperty(this,"update$",void 0);_defineProperty(this,"events$",void 0);_defineProperty(this,"element",void 0);_defineProperty(this,"destroyFn",void 0);_defineProperty(this,"renderCount",0);_defineProperty(this,"renderSubject",void 0);_defineProperty(this,"eventsSubject",void 0);_defineProperty(this,"updateSubject",void 0);_defineProperty(this,"handlers",void 0);_defineProperty(this,"onRenderError",void 0);_defineProperty(this,"render",function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(data,uiState={}){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(!data||typeof data!=="object")){_context.next=2;break}return _context.abrupt("return",_this.handleRenderError(new Error("invalid data provided to the expression renderer")));case 2:if(!(data.type!=="render"||!data.as)){_context.next=8;break}if(!(data.type==="error")){_context.next=7;break}return _context.abrupt("return",_this.handleRenderError(data.error));case 7:return _context.abrupt("return",_this.handleRenderError(new Error("invalid data provided to the expression renderer")));case 8:if(getRenderersRegistry().get(data.as)){_context.next=10;break}return _context.abrupt("return",_this.handleRenderError(new Error("invalid renderer id '".concat(data.as,"'"))));case 10:_context.prev=10;_context.next=13;return getRenderersRegistry().get(data.as).render(_this.element,data.value,_objectSpread(_objectSpread({},_this.handlers),{},{uiState:uiState}));case 13:_context.next=18;break;case 15:_context.prev=15;_context.t0=_context["catch"](10);return _context.abrupt("return",_this.handleRenderError(_context.t0));case 18:case"end":return _context.stop()}}),_callee,null,[[10,15]])})));return function(_x){return _ref.apply(this,arguments)}}());_defineProperty(this,"destroy",()=>{this.renderSubject.complete();this.eventsSubject.complete();this.updateSubject.complete();if(this.destroyFn){this.destroyFn()}});_defineProperty(this,"getElement",()=>this.element);_defineProperty(this,"handleRenderError",error=>{this.onRenderError(this.element,error,this.handlers)});this.element=element;this.eventsSubject=new external_kbnSharedDeps_Rxjs_["Subject"];this.events$=this.eventsSubject.asObservable();this.onRenderError=onRenderError||renderErrorHandler;this.renderSubject=new external_kbnSharedDeps_Rxjs_["BehaviorSubject"](null);this.render$=this.renderSubject.asObservable().pipe(Object(external_kbnSharedDeps_RxjsOperators_["filter"])(_=>_!==null));this.updateSubject=new external_kbnSharedDeps_Rxjs_["Subject"];this.update$=this.updateSubject.asObservable();this.handlers={onDestroy:fn=>{this.destroyFn=fn},done:()=>{this.renderCount++;this.renderSubject.next(this.renderCount)},reload:()=>{this.updateSubject.next(null)},update:params=>{this.updateSubject.next(params)},event:data=>{this.eventsSubject.next(data)},getRenderMode:()=>renderMode||"display"}}}function render(element,data,options){const handler=new render_ExpressionRenderHandler(element,options);handler.render(data);return handler}function loader_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function loader_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){loader_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){loader_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function loader_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class loader_ExpressionLoader{constructor(element,_expression,_params){var _this=this;loader_defineProperty(this,"data$",void 0);loader_defineProperty(this,"update$",void 0);loader_defineProperty(this,"render$",void 0);loader_defineProperty(this,"events$",void 0);loader_defineProperty(this,"loading$",void 0);loader_defineProperty(this,"execution",void 0);loader_defineProperty(this,"renderHandler",void 0);loader_defineProperty(this,"dataSubject",void 0);loader_defineProperty(this,"loadingSubject",void 0);loader_defineProperty(this,"data",void 0);loader_defineProperty(this,"params",{});loader_defineProperty(this,"loadData",function(){var _ref=loader_asyncToGenerator(regeneratorRuntime.mark((function _callee(expression,params){var prevDataHandler,data;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this.execution&&_this.execution.isPending){_this.execution.cancel()}_this.setParams(params);_this.execution=getExpressionsService().execute(expression,params.context,{searchContext:params.searchContext,variables:params.variables||{},inspectorAdapters:params.inspectorAdapters,searchSessionId:params.searchSessionId,debug:params.debug});prevDataHandler=_this.execution;_context.next=6;return prevDataHandler.getData();case 6:data=_context.sent;if(!(_this.execution!==prevDataHandler)){_context.next=9;break}return _context.abrupt("return");case 9:_this.dataSubject.next(data);case 10:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref.apply(this,arguments)}}());this.dataSubject=new external_kbnSharedDeps_Rxjs_["Subject"];this.data$=this.dataSubject.asObservable();this.loadingSubject=new external_kbnSharedDeps_Rxjs_["BehaviorSubject"](false);this.loading$=this.loadingSubject.asObservable().pipe(Object(external_kbnSharedDeps_RxjsOperators_["filter"])(_=>_===true),Object(external_kbnSharedDeps_RxjsOperators_["map"])(()=>void 0));this.renderHandler=new render_ExpressionRenderHandler(element,{onRenderError:_params&&_params.onRenderError,renderMode:_params===null||_params===void 0?void 0:_params.renderMode});this.render$=this.renderHandler.render$;this.update$=this.renderHandler.update$;this.events$=this.renderHandler.events$;this.update$.subscribe(value=>{if(value){const newExpression=value.newExpression,newParams=value.newParams;this.update(newExpression,newParams)}});this.data$.subscribe(data=>{this.render(data)});this.render$.subscribe(()=>{this.loadingSubject.next(false)});this.setParams(_params);if(_expression){this.loadingSubject.next(true);this.loadData(_expression,this.params)}}destroy(){this.dataSubject.complete();this.loadingSubject.complete();this.renderHandler.destroy();if(this.execution){this.execution.cancel()}}cancel(){if(this.execution){this.execution.cancel()}}getExpression(){if(this.execution){return this.execution.getExpression()}}getAst(){if(this.execution){return this.execution.getAst()}}getElement(){return this.renderHandler.getElement()}inspect(){return this.execution?this.execution.inspect():undefined}update(expression,params){this.setParams(params);this.loadingSubject.next(true);if(expression){this.loadData(expression,this.params)}else if(this.data){this.render(this.data)}}render(data){this.renderHandler.render(data,this.params.uiState)}setParams(params){var _this$execution;if(!params||!Object.keys(params).length){return}if(params.searchContext){this.params.searchContext=Object(external_kbnSharedDeps_Lodash_["defaults"])({},params.searchContext,this.params.searchContext||{})}if(params.uiState&&this.params){this.params.uiState=params.uiState}if(params.variables&&this.params){this.params.variables=params.variables}if(params.searchSessionId&&this.params){this.params.searchSessionId=params.searchSessionId}this.params.debug=Boolean(params.debug);this.params.inspectorAdapters=params.inspectorAdapters||((_this$execution=this.execution)===null||_this$execution===void 0?void 0:_this$execution.inspect())}}const loader=(element,expression,params)=>new loader_ExpressionLoader(element,expression,params);function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function react_expression_renderer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function react_expression_renderer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){react_expression_renderer_ownKeys(Object(source),true).forEach((function(key){react_expression_renderer_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{react_expression_renderer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function react_expression_renderer_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function react_expression_renderer_slicedToArray(arr,i){return react_expression_renderer_arrayWithHoles(arr)||react_expression_renderer_iterableToArrayLimit(arr,i)||react_expression_renderer_unsupportedIterableToArray(arr,i)||react_expression_renderer_nonIterableRest()}function react_expression_renderer_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function react_expression_renderer_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return react_expression_renderer_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return react_expression_renderer_arrayLikeToArray(o,minLen)}function react_expression_renderer_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function react_expression_renderer_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function react_expression_renderer_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}const defaultState={isEmpty:true,isLoading:false,error:null};const ReactExpressionRenderer=_ref=>{let className=_ref.className,dataAttrs=_ref.dataAttrs,padding=_ref.padding,renderError=_ref.renderError,expression=_ref.expression,onEvent=_ref.onEvent,onData$=_ref.onData$,reload$=_ref.reload$,debounce=_ref.debounce,expressionLoaderOptions=_objectWithoutProperties(_ref,["className","dataAttrs","padding","renderError","expression","onEvent","onData$","reload$","debounce"]);const mountpoint=Object(external_kbnSharedDeps_React_["useRef"])(null);const _useState=Object(external_kbnSharedDeps_React_["useState"])(react_expression_renderer_objectSpread({},defaultState)),_useState2=react_expression_renderer_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];const hasCustomRenderErrorHandler=!!renderError;const expressionLoaderRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const hasHandledErrorRef=Object(external_kbnSharedDeps_React_["useRef"])(false);const errorRenderHandlerRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const _useState3=Object(external_kbnSharedDeps_React_["useState"])(expression),_useState4=react_expression_renderer_slicedToArray(_useState3,2),debouncedExpression=_useState4[0],setDebouncedExpression=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(debounce===undefined){return}const handler=setTimeout(()=>{setDebouncedExpression(expression)},debounce);return()=>{clearTimeout(handler)}},[expression,debounce]);const activeExpression=debounce!==undefined?debouncedExpression:expression;const waitingForDebounceToComplete=debounce!==undefined&&expression!==debouncedExpression;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const subs=[];expressionLoaderRef.current=new loader_ExpressionLoader(mountpoint.current,activeExpression,react_expression_renderer_objectSpread(react_expression_renderer_objectSpread({},expressionLoaderOptions),{},{onRenderError:hasCustomRenderErrorHandler?(domNode,error,handlers)=>{errorRenderHandlerRef.current=handlers;setState(()=>react_expression_renderer_objectSpread(react_expression_renderer_objectSpread({},defaultState),{},{isEmpty:false,error:error}));if(expressionLoaderOptions.onRenderError){expressionLoaderOptions.onRenderError(domNode,error,handlers)}}:expressionLoaderOptions.onRenderError}));if(onEvent){subs.push(expressionLoaderRef.current.events$.subscribe(event=>{onEvent(event)}))}if(onData$){subs.push(expressionLoaderRef.current.data$.subscribe(newData=>{var _expressionLoaderRef$;onData$(newData,(_expressionLoaderRef$=expressionLoaderRef.current)===null||_expressionLoaderRef$===void 0?void 0:_expressionLoaderRef$.inspect())}))}subs.push(expressionLoaderRef.current.loading$.subscribe(()=>{hasHandledErrorRef.current=false;setState(prevState=>react_expression_renderer_objectSpread(react_expression_renderer_objectSpread({},prevState),{},{isLoading:true}))}),expressionLoaderRef.current.render$.pipe(Object(external_kbnSharedDeps_RxjsOperators_["filter"])(()=>!hasHandledErrorRef.current)).subscribe(item=>{setState(()=>react_expression_renderer_objectSpread(react_expression_renderer_objectSpread({},defaultState),{},{isEmpty:false}))}));return()=>{subs.forEach(s=>s.unsubscribe());if(expressionLoaderRef.current){expressionLoaderRef.current.destroy();expressionLoaderRef.current=null}errorRenderHandlerRef.current=null}},[hasCustomRenderErrorHandler,onEvent]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const subscription=reload$===null||reload$===void 0?void 0:reload$.subscribe(()=>{if(expressionLoaderRef.current){expressionLoaderRef.current.update(activeExpression,expressionLoaderOptions)}});return()=>subscription===null||subscription===void 0?void 0:subscription.unsubscribe()},[reload$,activeExpression,...Object.values(expressionLoaderOptions)]);useShallowCompareEffect_default()(()=>{if(expressionLoaderRef.current){expressionLoaderRef.current.update(activeExpression,expressionLoaderOptions)}},[react_expression_renderer_objectSpread({activeExpression:activeExpression},expressionLoaderOptions)]);Object(external_kbnSharedDeps_React_["useLayoutEffect"])(()=>{if(state.error&&errorRenderHandlerRef.current){hasHandledErrorRef.current=true;errorRenderHandlerRef.current.done();errorRenderHandlerRef.current=null}},[state.error]);const classes=classnames_default()("expExpressionRenderer",{"expExpressionRenderer-isEmpty":state.isEmpty,"expExpressionRenderer-hasError":!!state.error,className:className});const expressionStyles={};if(padding){expressionStyles.padding=external_kbnSharedDeps_Theme_euiLightVars_default.a.paddingSizes[padding]}return external_kbnSharedDeps_React_default.a.createElement("div",_extends({},dataAttrs,{className:classes}),state.isEmpty&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingChart"],{mono:true,size:"l"}),(state.isLoading||waitingForDebounceToComplete)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{size:"xs",color:"accent",position:"absolute"}),!state.isLoading&&state.error&&renderError&&renderError(state.error.message,state.error),external_kbnSharedDeps_React_default.a.createElement("div",{className:"expExpressionRenderer__expression",style:expressionStyles,ref:mountpoint}))};function plugin_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function plugin_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){plugin_ownKeys(Object(source),true).forEach((function(key){plugin_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{plugin_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function plugin_slicedToArray(arr,i){return plugin_arrayWithHoles(arr)||plugin_iterableToArrayLimit(arr,i)||plugin_unsupportedIterableToArray(arr,i)||plugin_nonIterableRest()}function plugin_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function plugin_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return plugin_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return plugin_arrayLikeToArray(o,minLen)}function plugin_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function plugin_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function plugin_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function plugin_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function plugin_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){plugin_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){plugin_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function plugin_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class plugin_ExpressionsPublicPlugin{constructor(initializerContext){plugin_defineProperty(this,"expressions",new common["ExpressionsService"])}configureExecutor(core){const executor=this.expressions.executor;const getSavedObject=function(){var _ref=plugin_asyncToGenerator(regeneratorRuntime.mark((function _callee(type,id){var _yield$core$getStartS,_yield$core$getStartS2,start;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return core.getStartServices();case 2:_yield$core$getStartS=_context.sent;_yield$core$getStartS2=plugin_slicedToArray(_yield$core$getStartS,1);start=_yield$core$getStartS2[0];return _context.abrupt("return",start.savedObjects.client.get(type,id));case 6:case"end":return _context.stop()}}),_callee)})));return function getSavedObject(_x,_x2){return _ref.apply(this,arguments)}}();executor.extendContext({environment:"client",getSavedObject:getSavedObject})}setup(core){this.configureExecutor(core);const expressions=this.expressions;const renderers=expressions.renderers;setRenderersRegistry(renderers);setExpressionsService(expressions);const setup=expressions.setup();return Object.freeze(setup)}start(core){setNotifications(core.notifications);const expressions=this.expressions;const start=plugin_objectSpread(plugin_objectSpread({},expressions.start()),{},{ExpressionLoader:loader_ExpressionLoader,ExpressionRenderHandler:render_ExpressionRenderHandler,loader:loader,ReactExpressionRenderer:ReactExpressionRenderer,render:render});return Object.freeze(start)}stop(){this.expressions.stop()}}var types=__webpack_require__(23);function public_plugin(initializerContext){return new plugin_ExpressionsPublicPlugin(initializerContext)}}]);