(window["visualize_bundle_jsonpfunction"]=window["visualize_bundle_jsonpfunction"]||[]).push([[1],Array(30).concat([function(module,exports,__webpack_require__){"use strict";var isOldIE=function isOldIE(){var memo;return function memorize(){if(typeof memo==="undefined"){memo=Boolean(window&&document&&document.all&&!window.atob)}return memo}}();var getTarget=function getTarget(){var memo={};return function memorize(target){if(typeof memo[target]==="undefined"){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement){try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}}memo[target]=styleTarget}return memo[target]}}();var stylesInDom=[];function getIndexByIdentifier(identifier){var result=-1;for(var i=0;i<stylesInDom.length;i++){if(stylesInDom[i].identifier===identifier){result=i;break}}return result}function modulesToDom(list,options){var idCountMap={};var identifiers=[];for(var i=0;i<list.length;i++){var item=list[i];var id=options.base?item[0]+options.base:item[0];var count=idCountMap[id]||0;var identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier);var obj={css:item[1],media:item[2],sourceMap:item[3]};if(index!==-1){stylesInDom[index].references++;stylesInDom[index].updater(obj)}else{stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1})}identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style");var attributes=options.attributes||{};if(typeof attributes.nonce==="undefined"){var nonce=true?__webpack_require__.nc:undefined;if(nonce){attributes.nonce=nonce}}Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])}));if(typeof options.insert==="function"){options.insert(style)}else{var target=getTarget(options.insert||"head");if(!target){throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.")}target.appendChild(style)}return style}function removeStyleElement(style){if(style.parentNode===null){return false}style.parentNode.removeChild(style)}var replaceText=function replaceText(){var textStore=[];return function replace(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet){style.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=style.childNodes;if(childNodes[index]){style.removeChild(childNodes[index])}if(childNodes.length){style.insertBefore(cssNode,childNodes[index])}else{style.appendChild(cssNode)}}}function applyToTag(style,options,obj){var css=obj.css;var media=obj.media;var sourceMap=obj.sourceMap;if(media){style.setAttribute("media",media)}else{style.removeAttribute("media")}if(sourceMap&&btoa){css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")}if(style.styleSheet){style.styleSheet.cssText=css}else{while(style.firstChild){style.removeChild(style.firstChild)}style.appendChild(document.createTextNode(css))}}var singleton=null;var singletonCounter=0;function addStyle(obj,options){var style;var update;var remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options));update=applyToSingletonTag.bind(null,style,styleIndex,false);remove=applyToSingletonTag.bind(null,style,styleIndex,true)}else{style=insertStyleElement(options);update=applyToTag.bind(null,style,options);remove=function remove(){removeStyleElement(style)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap){return}update(obj=newObj)}else{remove()}}}module.exports=function(list,options){options=options||{};if(!options.singleton&&typeof options.singleton!=="boolean"){options.singleton=isOldIE()}list=list||[];var lastIdentifiers=modulesToDom(list,options);return function update(newList){newList=newList||[];if(Object.prototype.toString.call(newList)!=="[object Array]"){return}for(var i=0;i<lastIdentifiers.length;i++){var identifier=lastIdentifiers[i];var index=getIndexByIdentifier(identifier);stylesInDom[index].references--}var newLastIdentifiers=modulesToDom(newList,options);for(var _i=0;_i<lastIdentifiers.length;_i++){var _identifier=lastIdentifiers[_i];var _index=getIndexByIdentifier(_identifier);if(stylesInDom[_index].references===0){stylesInDom[_index].updater();stylesInDom.splice(_index,1)}}lastIdentifiers=newLastIdentifiers}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(useSourceMap){var list=[];list.toString=function toString(){return this.map((function(item){var content=cssWithMappingToString(item,useSourceMap);if(item[2]){return"@media ".concat(item[2]," {").concat(content,"}")}return content})).join("")};list.i=function(modules,mediaQuery,dedupe){if(typeof modules==="string"){modules=[[null,modules,""]]}var alreadyImportedModules={};if(dedupe){for(var i=0;i<this.length;i++){var id=this[i][0];if(id!=null){alreadyImportedModules[id]=true}}}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);if(dedupe&&alreadyImportedModules[item[0]]){continue}if(mediaQuery){if(!item[2]){item[2]=mediaQuery}else{item[2]="".concat(mediaQuery," and ").concat(item[2])}}list.push(item)}};return list};function cssWithMappingToString(item,useSourceMap){var content=item[1]||"";var cssMapping=item[3];if(!cssMapping){return content}if(useSourceMap&&typeof btoa==="function"){var sourceMapping=toComment(cssMapping);var sourceURLs=cssMapping.sources.map((function(source){return"/*# sourceURL=".concat(cssMapping.sourceRoot||"").concat(source," */")}));return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}return[content].join("\n")}function toComment(sourceMap){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));var data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64);return"/*# ".concat(data," */")}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(59);case"v7light":return __webpack_require__(61);case"v8dark":return __webpack_require__(63);case"v8light":return __webpack_require__(65)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(18);var useEffectOnce=function(effect){react_1.useEffect(effect,[])};exports.default=useEffectOnce},function(module,exports,__webpack_require__){"use strict";var R=typeof Reflect==="object"?Reflect:null;var ReflectApply=R&&typeof R.apply==="function"?R.apply:function ReflectApply(target,receiver,args){return Function.prototype.apply.call(target,receiver,args)};var ReflectOwnKeys;if(R&&typeof R.ownKeys==="function"){ReflectOwnKeys=R.ownKeys}else if(Object.getOwnPropertySymbols){ReflectOwnKeys=function ReflectOwnKeys(target){return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target))}}else{ReflectOwnKeys=function ReflectOwnKeys(target){return Object.getOwnPropertyNames(target)}}function ProcessEmitWarning(warning){if(console&&console.warn)console.warn(warning)}var NumberIsNaN=Number.isNaN||function NumberIsNaN(value){return value!==value};function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=undefined;var defaultMaxListeners=10;Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:true,get:function(){return defaultMaxListeners},set:function(arg){if(typeof arg!=="number"||arg<0||NumberIsNaN(arg)){throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+arg+".")}defaultMaxListeners=arg}});EventEmitter.init=function(){if(this._events===undefined||this._events===Object.getPrototypeOf(this)._events){this._events=Object.create(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined};EventEmitter.prototype.setMaxListeners=function setMaxListeners(n){if(typeof n!=="number"||n<0||NumberIsNaN(n)){throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".")}this._maxListeners=n;return this};function $getMaxListeners(that){if(that._maxListeners===undefined)return EventEmitter.defaultMaxListeners;return that._maxListeners}EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return $getMaxListeners(this)};EventEmitter.prototype.emit=function emit(type){var args=[];for(var i=1;i<arguments.length;i++)args.push(arguments[i]);var doError=type==="error";var events=this._events;if(events!==undefined)doError=doError&&events.error===undefined;else if(!doError)return false;if(doError){var er;if(args.length>0)er=args[0];if(er instanceof Error){throw er}var err=new Error("Unhandled error."+(er?" ("+er.message+")":""));err.context=er;throw err}var handler=events[type];if(handler===undefined)return false;if(typeof handler==="function"){ReflectApply(handler,this,args)}else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)ReflectApply(listeners[i],this,args)}return true};function _addListener(target,type,listener,prepend){var m;var events;var existing;if(typeof listener!=="function"){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}events=target._events;if(events===undefined){events=target._events=Object.create(null);target._eventsCount=0}else{if(events.newListener!==undefined){target.emit("newListener",type,listener.listener?listener.listener:listener);events=target._events}existing=events[type]}if(existing===undefined){existing=events[type]=listener;++target._eventsCount}else{if(typeof existing==="function"){existing=events[type]=prepend?[listener,existing]:[existing,listener]}else if(prepend){existing.unshift(listener)}else{existing.push(listener)}m=$getMaxListeners(target);if(m>0&&existing.length>m&&!existing.warned){existing.warned=true;var w=new Error("Possible EventEmitter memory leak detected. "+existing.length+" "+String(type)+" listeners "+"added. Use emitter.setMaxListeners() to "+"increase limit");w.name="MaxListenersExceededWarning";w.emitter=target;w.type=type;w.count=existing.length;ProcessEmitWarning(w)}}return target}EventEmitter.prototype.addListener=function addListener(type,listener){return _addListener(this,type,listener,false)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function prependListener(type,listener){return _addListener(this,type,listener,true)};function onceWrapper(){var args=[];for(var i=0;i<arguments.length;i++)args.push(arguments[i]);if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;ReflectApply(this.listener,this.target,args)}}function _onceWrap(target,type,listener){var state={fired:false,wrapFn:undefined,target:target,type:type,listener:listener};var wrapped=onceWrapper.bind(state);wrapped.listener=listener;state.wrapFn=wrapped;return wrapped}EventEmitter.prototype.once=function once(type,listener){if(typeof listener!=="function"){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}this.on(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.prependOnceListener=function prependOnceListener(type,listener){if(typeof listener!=="function"){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}this.prependListener(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.removeListener=function removeListener(type,listener){var list,events,position,i,originalListener;if(typeof listener!=="function"){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}events=this._events;if(events===undefined)return this;list=events[type];if(list===undefined)return this;if(list===listener||list.listener===listener){if(--this._eventsCount===0)this._events=Object.create(null);else{delete events[type];if(events.removeListener)this.emit("removeListener",type,list.listener||listener)}}else if(typeof list!=="function"){position=-1;for(i=list.length-1;i>=0;i--){if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener;position=i;break}}if(position<0)return this;if(position===0)list.shift();else{spliceOne(list,position)}if(list.length===1)events[type]=list[0];if(events.removeListener!==undefined)this.emit("removeListener",type,originalListener||listener)}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function removeAllListeners(type){var listeners,events,i;events=this._events;if(events===undefined)return this;if(events.removeListener===undefined){if(arguments.length===0){this._events=Object.create(null);this._eventsCount=0}else if(events[type]!==undefined){if(--this._eventsCount===0)this._events=Object.create(null);else delete events[type]}return this}if(arguments.length===0){var keys=Object.keys(events);var key;for(i=0;i<keys.length;++i){key=keys[i];if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}listeners=events[type];if(typeof listeners==="function"){this.removeListener(type,listeners)}else if(listeners!==undefined){for(i=listeners.length-1;i>=0;i--){this.removeListener(type,listeners[i])}}return this};function _listeners(target,type,unwrap){var events=target._events;if(events===undefined)return[];var evlistener=events[type];if(evlistener===undefined)return[];if(typeof evlistener==="function")return unwrap?[evlistener.listener||evlistener]:[evlistener];return unwrap?unwrapListeners(evlistener):arrayClone(evlistener,evlistener.length)}EventEmitter.prototype.listeners=function listeners(type){return _listeners(this,type,true)};EventEmitter.prototype.rawListeners=function rawListeners(type){return _listeners(this,type,false)};EventEmitter.listenerCount=function(emitter,type){if(typeof emitter.listenerCount==="function"){return emitter.listenerCount(type)}else{return listenerCount.call(emitter,type)}};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(type){var events=this._events;if(events!==undefined){var evlistener=events[type];if(typeof evlistener==="function"){return 1}else if(evlistener!==undefined){return evlistener.length}}return 0}EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(arr,n){var copy=new Array(n);for(var i=0;i<n;++i)copy[i]=arr[i];return copy}function spliceOne(list,index){for(;index+1<list.length;index++)list[index]=list[index+1];list.pop()}function unwrapListeners(arr){var ret=new Array(arr.length);for(var i=0;i<ret.length;++i){ret[i]=arr[i].listener||arr[i]}return ret}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(36);case"v7light":return __webpack_require__(38);case"v8dark":return __webpack_require__(40);case"v8light":return __webpack_require__(42)}},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(37);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(39);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(41);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(43);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(45);case"v7light":return __webpack_require__(47);case"v8dark":return __webpack_require__(49);case"v8light":return __webpack_require__(51)}},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(46);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visListingTable__typeImage,\n.visListingTable__typeIcon {\n  margin-right: 8px;\n  position: relative;\n  top: -1px; }\n\n.visListingTable__typeImage {\n  width: 16px;\n  height: 16px; }\n\n.visListingTable__experimentalIcon {\n  width: 24px;\n  vertical-align: baseline;\n  padding: 0 8px;\n  margin-left: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(48);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visListingTable__typeImage,\n.visListingTable__typeIcon {\n  margin-right: 8px;\n  position: relative;\n  top: -1px; }\n\n.visListingTable__typeImage {\n  width: 16px;\n  height: 16px; }\n\n.visListingTable__experimentalIcon {\n  width: 24px;\n  vertical-align: baseline;\n  padding: 0 8px;\n  margin-left: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(50);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visListingTable__typeImage,\n.visListingTable__typeIcon {\n  margin-right: 8px;\n  position: relative;\n  top: -1px; }\n\n.visListingTable__typeImage {\n  width: 16px;\n  height: 16px; }\n\n.visListingTable__experimentalIcon {\n  width: 24px;\n  vertical-align: baseline;\n  padding: 0 8px;\n  margin-left: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(52);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visListingTable__typeImage,\n.visListingTable__typeIcon {\n  margin-right: 8px;\n  position: relative;\n  top: -1px; }\n\n.visListingTable__typeImage {\n  width: 16px;\n  height: 16px; }\n\n.visListingTable__experimentalIcon {\n  width: 24px;\n  vertical-align: baseline;\n  padding: 0 8px;\n  margin-left: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){"use strict";const strictUriEncode=__webpack_require__(54);const decodeComponent=__webpack_require__(55);const splitOnFirst=__webpack_require__(56);const isNullOrUndefined=value=>value===null||value===undefined;function encoderForArrayFormat(options){switch(options.arrayFormat){case"index":return key=>(result,value)=>{const index=result.length;if(value===undefined||options.skipNull&&value===null||options.skipEmptyString&&value===""){return result}if(value===null){return[...result,[encode(key,options),"[",index,"]"].join("")]}return[...result,[encode(key,options),"[",encode(index,options),"]=",encode(value,options)].join("")]};case"bracket":return key=>(result,value)=>{if(value===undefined||options.skipNull&&value===null||options.skipEmptyString&&value===""){return result}if(value===null){return[...result,[encode(key,options),"[]"].join("")]}return[...result,[encode(key,options),"[]=",encode(value,options)].join("")]};case"comma":case"separator":return key=>(result,value)=>{if(value===null||value===undefined||value.length===0){return result}if(result.length===0){return[[encode(key,options),"=",encode(value,options)].join("")]}return[[result,encode(value,options)].join(options.arrayFormatSeparator)]};default:return key=>(result,value)=>{if(value===undefined||options.skipNull&&value===null||options.skipEmptyString&&value===""){return result}if(value===null){return[...result,encode(key,options)]}return[...result,[encode(key,options),"=",encode(value,options)].join("")]}}}function parserForArrayFormat(options){let result;switch(options.arrayFormat){case"index":return(key,value,accumulator)=>{result=/\[(\d*)\]$/.exec(key);key=key.replace(/\[\d*\]$/,"");if(!result){accumulator[key]=value;return}if(accumulator[key]===undefined){accumulator[key]={}}accumulator[key][result[1]]=value};case"bracket":return(key,value,accumulator)=>{result=/(\[\])$/.exec(key);key=key.replace(/\[\]$/,"");if(!result){accumulator[key]=value;return}if(accumulator[key]===undefined){accumulator[key]=[value];return}accumulator[key]=[].concat(accumulator[key],value)};case"comma":case"separator":return(key,value,accumulator)=>{const isArray=typeof value==="string"&&value.split("").indexOf(options.arrayFormatSeparator)>-1;const newValue=isArray?value.split(options.arrayFormatSeparator).map(item=>decode(item,options)):value===null?value:decode(value,options);accumulator[key]=newValue};default:return(key,value,accumulator)=>{if(accumulator[key]===undefined){accumulator[key]=value;return}accumulator[key]=[].concat(accumulator[key],value)}}}function validateArrayFormatSeparator(value){if(typeof value!=="string"||value.length!==1){throw new TypeError("arrayFormatSeparator must be single character string")}}function encode(value,options){if(options.encode){return options.strict?strictUriEncode(value):encodeURIComponent(value)}return value}function decode(value,options){if(options.decode){return decodeComponent(value)}return value}function keysSorter(input){if(Array.isArray(input)){return input.sort()}if(typeof input==="object"){return keysSorter(Object.keys(input)).sort((a,b)=>Number(a)-Number(b)).map(key=>input[key])}return input}function removeHash(input){const hashStart=input.indexOf("#");if(hashStart!==-1){input=input.slice(0,hashStart)}return input}function getHash(url){let hash="";const hashStart=url.indexOf("#");if(hashStart!==-1){hash=url.slice(hashStart)}return hash}function extract(input){input=removeHash(input);const queryStart=input.indexOf("?");if(queryStart===-1){return""}return input.slice(queryStart+1)}function parseValue(value,options){if(options.parseNumbers&&!Number.isNaN(Number(value))&&(typeof value==="string"&&value.trim()!=="")){value=Number(value)}else if(options.parseBooleans&&value!==null&&(value.toLowerCase()==="true"||value.toLowerCase()==="false")){value=value.toLowerCase()==="true"}return value}function parse(input,options){options=Object.assign({decode:true,sort:true,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:false,parseBooleans:false},options);validateArrayFormatSeparator(options.arrayFormatSeparator);const formatter=parserForArrayFormat(options);const ret=Object.create(null);if(typeof input!=="string"){return ret}input=input.trim().replace(/^[?#&]/,"");if(!input){return ret}for(const param of input.split("&")){let[key,value]=splitOnFirst(options.decode?param.replace(/\+/g," "):param,"=");value=value===undefined?null:["comma","separator"].includes(options.arrayFormat)?value:decode(value,options);formatter(decode(key,options),value,ret)}for(const key of Object.keys(ret)){const value=ret[key];if(typeof value==="object"&&value!==null){for(const k of Object.keys(value)){value[k]=parseValue(value[k],options)}}else{ret[key]=parseValue(value,options)}}if(options.sort===false){return ret}return(options.sort===true?Object.keys(ret).sort():Object.keys(ret).sort(options.sort)).reduce((result,key)=>{const value=ret[key];if(Boolean(value)&&typeof value==="object"&&!Array.isArray(value)){result[key]=keysSorter(value)}else{result[key]=value}return result},Object.create(null))}exports.extract=extract;exports.parse=parse;exports.stringify=(object,options)=>{if(!object){return""}options=Object.assign({encode:true,strict:true,arrayFormat:"none",arrayFormatSeparator:","},options);validateArrayFormatSeparator(options.arrayFormatSeparator);const shouldFilter=key=>options.skipNull&&isNullOrUndefined(object[key])||options.skipEmptyString&&object[key]==="";const formatter=encoderForArrayFormat(options);const objectCopy={};for(const key of Object.keys(object)){if(!shouldFilter(key)){objectCopy[key]=object[key]}}const keys=Object.keys(objectCopy);if(options.sort!==false){keys.sort(options.sort)}return keys.map(key=>{const value=object[key];if(value===undefined){return""}if(value===null){return encode(key,options)}if(Array.isArray(value)){return value.reduce(formatter(key),[]).join("&")}return encode(key,options)+"="+encode(value,options)}).filter(x=>x.length>0).join("&")};exports.parseUrl=(input,options)=>{options=Object.assign({decode:true},options);const[url,hash]=splitOnFirst(input,"#");return Object.assign({url:url.split("?")[0]||"",query:parse(extract(input),options)},options&&options.parseFragmentIdentifier&&hash?{fragmentIdentifier:decode(hash,options)}:{})};exports.stringifyUrl=(input,options)=>{options=Object.assign({encode:true,strict:true},options);const url=removeHash(input.url).split("?")[0]||"";const queryFromUrl=exports.extract(input.url);const parsedQueryFromUrl=exports.parse(queryFromUrl,{sort:false});const query=Object.assign(parsedQueryFromUrl,input.query);let queryString=exports.stringify(query,options);if(queryString){queryString=`?${queryString}`}let hash=getHash(input.url);if(input.fragmentIdentifier){hash=`#${encode(input.fragmentIdentifier,options)}`}return`${url}${queryString}${hash}`}},function(module,exports,__webpack_require__){"use strict";module.exports=str=>encodeURIComponent(str).replace(/[!'()*]/g,x=>`%${x.charCodeAt(0).toString(16).toUpperCase()}`)},function(module,exports,__webpack_require__){"use strict";var token="%[a-f0-9]{2}";var singleMatcher=new RegExp(token,"gi");var multiMatcher=new RegExp("("+token+")+","gi");function decodeComponents(components,split){try{return decodeURIComponent(components.join(""))}catch(err){}if(components.length===1){return components}split=split||1;var left=components.slice(0,split);var right=components.slice(split);return Array.prototype.concat.call([],decodeComponents(left),decodeComponents(right))}function decode(input){try{return decodeURIComponent(input)}catch(err){var tokens=input.match(singleMatcher);for(var i=1;i<tokens.length;i++){input=decodeComponents(tokens,i).join("");tokens=input.match(singleMatcher)}return input}}function customDecodeURIComponent(input){var replaceMap={"%FE%FF":"��","%FF%FE":"��"};var match=multiMatcher.exec(input);while(match){try{replaceMap[match[0]]=decodeURIComponent(match[0])}catch(err){var result=decode(match[0]);if(result!==match[0]){replaceMap[match[0]]=result}}match=multiMatcher.exec(input)}replaceMap["%C2"]="�";var entries=Object.keys(replaceMap);for(var i=0;i<entries.length;i++){var key=entries[i];input=input.replace(new RegExp(key,"g"),replaceMap[key])}return input}module.exports=function(encodedURI){if(typeof encodedURI!=="string"){throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof encodedURI+"`")}try{encodedURI=encodedURI.replace(/\+/g," ");return decodeURIComponent(encodedURI)}catch(err){return customDecodeURIComponent(encodedURI)}}},function(module,exports,__webpack_require__){"use strict";module.exports=(string,separator)=>{if(!(typeof string==="string"&&typeof separator==="string")){throw new TypeError("Expected the arguments to be of type `string`")}if(separator===""){return[string]}const separatorIndex=string.indexOf(separator);if(separatorIndex===-1){return[string]}return[string.slice(0,separatorIndex),string.slice(separatorIndex+separator.length)]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(26);var useEffectOnce_1=tslib_1.__importDefault(__webpack_require__(33));var useMount=function(fn){useEffectOnce_1.default((function(){fn()}))};exports.default=useMount},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(26);var react_1=__webpack_require__(18);var useEffectOnce_1=tslib_1.__importDefault(__webpack_require__(33));var useUnmount=function(fn){var fnRef=react_1.useRef(fn);fnRef.current=fn;useEffectOnce_1.default((function(){return function(){return fnRef.current()}}))};exports.default=useUnmount},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(60);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  /* 1. Without setting this to 0 you will run into a bug where the filter bar modal is hidden under\na tilemap in an iframe: https://github.com/elastic/kibana/issues/16457 */ }\n  .visEditor > * {\n    flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  .visEditor > .visualize {\n    height: 100%;\n    flex: 1 1 auto;\n    display: flex;\n    z-index: 0;\n    /* 1 */ }\n\n.visEditor__content {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  z-index: 0; }\n  .visEditor__content > * {\n    flex-shrink: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(62);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  /* 1. Without setting this to 0 you will run into a bug where the filter bar modal is hidden under\na tilemap in an iframe: https://github.com/elastic/kibana/issues/16457 */ }\n  .visEditor > * {\n    flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  .visEditor > .visualize {\n    height: 100%;\n    flex: 1 1 auto;\n    display: flex;\n    z-index: 0;\n    /* 1 */ }\n\n.visEditor__content {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  z-index: 0; }\n  .visEditor__content > * {\n    flex-shrink: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(64);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  /* 1. Without setting this to 0 you will run into a bug where the filter bar modal is hidden under\na tilemap in an iframe: https://github.com/elastic/kibana/issues/16457 */ }\n  .visEditor > * {\n    flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  .visEditor > .visualize {\n    height: 100%;\n    flex: 1 1 auto;\n    display: flex;\n    z-index: 0;\n    /* 1 */ }\n\n.visEditor__content {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  z-index: 0; }\n  .visEditor__content > * {\n    flex-shrink: 0; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(30);var content=__webpack_require__(66);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(31);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  /* 1. Without setting this to 0 you will run into a bug where the filter bar modal is hidden under\na tilemap in an iframe: https://github.com/elastic/kibana/issues/16457 */ }\n  .visEditor > * {\n    flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  .visEditor > .visualize {\n    height: 100%;\n    flex: 1 1 auto;\n    display: flex;\n    z-index: 0;\n    /* 1 */ }\n\n.visEditor__content {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  z-index: 0; }\n  .visEditor__content > * {\n    flex-shrink: 0; }\n",""]);module.exports=exports},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return renderApp}));var external_kbnSharedDeps_React_=__webpack_require__(18);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(27);var external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_);var external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(21);var public_=__webpack_require__(19);var application_app=__webpack_require__(35);var data_public_=__webpack_require__(2);var visualize_listing=__webpack_require__(44);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(3);var useUnmount=__webpack_require__(58);var useUnmount_default=__webpack_require__.n(useUnmount);var useMount=__webpack_require__(57);var useMount_default=__webpack_require__.n(useMount);var visualizations_public_=__webpack_require__(24);var visualize_constants=__webpack_require__(4);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(22);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(23);const getBadge=item=>{if(item.stage==="beta"){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBetaBadge"],{className:"visListingTable__betaIcon",label:"B",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.betaTitle",{defaultMessage:"Beta"}),tooltipContent:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.betaTooltip",{defaultMessage:"This visualization is in beta and is subject to change. The design and code is less mature than official GA "+"features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA "+"features"})})}else if(item.stage==="experimental"){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBetaBadge"],{className:"visListingTable__experimentalIcon",label:"E",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.experimentalTitle",{defaultMessage:"Experimental"}),tooltipContent:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.experimentalTooltip",{defaultMessage:"This visualization might be changed or removed in a future release and is not subject to the support SLA."})})}};const renderItemTypeIcon=item=>{let icon;if(item.image){icon=external_kbnSharedDeps_React_default.a.createElement("img",{className:"visListingTable__typeImage","aria-hidden":"true",alt:"",src:item.image})}else{icon=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{className:"visListingTable__typeIcon","aria-hidden":"true",type:item.icon||"empty",size:"m"})}return icon};const getTableColumns=(application,history,taggingApi)=>[{field:"title",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.titleColumnName",{defaultMessage:"Title"}),sortable:true,render:(field,{editApp:editApp,editUrl:editUrl,title:title,error:error})=>!error?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{onClick:()=>{if(editApp){application.navigateToApp(editApp,{path:editUrl})}else if(editUrl){history.push(editUrl)}},"data-test-subj":"visListingTitleLink-".concat(title.split(" ").join("-"))},field):field},{field:"typeTitle",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.typeColumnName",{defaultMessage:"Type"}),sortable:true,render:(field,record)=>!record.error?external_kbnSharedDeps_React_default.a.createElement("span",null,renderItemTypeIcon(record),record.typeTitle,getBadge(record)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{iconType:"alert",color:"warning"},record.error)},{field:"description",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.descriptionColumnName",{defaultMessage:"Description"}),sortable:true,render:(field,record)=>external_kbnSharedDeps_React_default.a.createElement("span",null,record.description)},...taggingApi?[taggingApi.ui.getTableColumnDefinition()]:[]];const getNoItemsMessage=createItem=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"visualizeApp",title:external_kbnSharedDeps_React_default.a.createElement("h1",{id:"visualizeListingHeading"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.listing.createNew.title",defaultMessage:"Create your first visualization"})),body:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.listing.createNew.description",defaultMessage:"You can create different visualizations based on your data."})),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:createItem,fill:true,iconType:"plusInCircle","data-test-subj":"createVisualizationPromptButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.listing.createNew.createButtonLabel",defaultMessage:"Create new visualization"}))});var savedObjects_public_=__webpack_require__(28);var kibanaUtils_public_=__webpack_require__(0);const appPrefixes={dashboards:{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.dashboard.prefix.breadcrumb",{defaultMessage:"Dashboard"})}};const defaultEditText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.editor.defaultEditBreadcrumbText",{defaultMessage:"Edit"});function getLandingBreadcrumbs(){return[{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.breadcrumb",{defaultMessage:"Visualize"}),href:"#".concat(visualize_constants["b"].LANDING_PAGE_PATH)}]}function getCreateBreadcrumbs(){return[...getLandingBreadcrumbs(),{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.editor.createBreadcrumb",{defaultMessage:"Create"})}]}function getBreadcrumbsPrefixedWithApp(originatingApp){const originatingAppBreadcrumb=appPrefixes[originatingApp];return[originatingAppBreadcrumb,...getLandingBreadcrumbs(),{text:defaultEditText}]}function getEditBreadcrumbs(text=defaultEditText){return[...getLandingBreadcrumbs(),{text:text}]}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const getTopNavConfig=({hasUnsavedChanges:hasUnsavedChanges,setHasUnsavedChanges:setHasUnsavedChanges,openInspector:openInspector,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,hasUnappliedChanges:hasUnappliedChanges,visInstance:visInstance,stateContainer:stateContainer,visualizationIdFromUrl:visualizationIdFromUrl,stateTransfer:stateTransfer,embeddableId:embeddableId,onAppLeave:onAppLeave},{application:application,chrome:chrome,history:history,share:share,setActiveUrl:setActiveUrl,toastNotifications:toastNotifications,visualizeCapabilities:visualizeCapabilities,i18n:{Context:I18nContext},dashboard:dashboard,savedObjectsTagging:savedObjectsTagging})=>{const vis=visInstance.vis,embeddableHandler=visInstance.embeddableHandler;const savedVis="savedVis"in visInstance?visInstance.savedVis:undefined;function doSave(_x){return _doSave.apply(this,arguments)}function _doSave(){_doSave=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(saveOptions){var _vis$data$searchSourc;var newlyCreated,id,appPath;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(savedVis){_context4.next=2;break}return _context4.abrupt("return",{});case 2:newlyCreated=!Boolean(savedVis.id)||savedVis.copyOnSave;stateContainer.transitions.setVis({title:savedVis.title});savedVis.searchSourceFields=(_vis$data$searchSourc=vis.data.searchSource)===null||_vis$data$searchSourc===void 0?void 0:_vis$data$searchSourc.getSerializedFields();savedVis.visState=stateContainer.getState().vis;savedVis.uiStateJSON=vis.uiState.toString();setHasUnsavedChanges(false);_context4.prev=8;_context4.next=11;return savedVis.save(saveOptions);case 11:id=_context4.sent;if(id){toastNotifications.addSuccess({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualization.successNotificationText",{defaultMessage:"Saved '{visTitle}'",values:{visTitle:savedVis.title}}),"data-test-subj":"saveVisualizationSuccess"});if(originatingApp&&saveOptions.returnToOrigin){appPath="".concat(visualize_constants["b"].EDIT_PATH,"/").concat(encodeURIComponent(id));history.replace(appPath);setActiveUrl(appPath);if(newlyCreated&&stateTransfer){stateTransfer.navigateToWithEmbeddablePackage(originatingApp,{state:{type:visualizations_public_["VISUALIZE_EMBEDDABLE_TYPE"],input:{savedObjectId:id}}})}else{application.navigateToApp(originatingApp)}}else{if(setOriginatingApp&&originatingApp&&newlyCreated){setOriginatingApp(undefined)}chrome.docTitle.change(savedVis.lastSavedTitle);chrome.setBreadcrumbs(getEditBreadcrumbs(savedVis.lastSavedTitle));if(id!==visualizationIdFromUrl){history.replace(_objectSpread(_objectSpread({},history.location),{},{pathname:"".concat(visualize_constants["b"].EDIT_PATH,"/").concat(id)}))}}}return _context4.abrupt("return",{id:id});case 16:_context4.prev=16;_context4.t0=_context4["catch"](8);console.error(_context4.t0);toastNotifications.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualization.failureNotificationText",{defaultMessage:"Error on saving '{visTitle}'",values:{visTitle:savedVis.title}}),text:_context4.t0.message,"data-test-subj":"saveVisualizationError"});return _context4.abrupt("return",{error:_context4.t0});case 21:case"end":return _context4.stop()}}),_callee4,null,[[8,16]])})));return _doSave.apply(this,arguments)}const createVisReference=()=>{if(!originatingApp){return}const state={input:{savedVis:vis.serialize()},embeddableId:embeddableId,type:visualizations_public_["VISUALIZE_EMBEDDABLE_TYPE"]};stateTransfer.navigateToWithEmbeddablePackage(originatingApp,{state:state})};const navigateToOriginatingApp=()=>{if(originatingApp){application.navigateToApp(originatingApp)}};const topNavMenu=[{id:"inspector",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.openInspectorButtonLabel",{defaultMessage:"inspect"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.openInspectorButtonAriaLabel",{defaultMessage:"Open Inspector for visualization"}),testId:"openInspectorButton",disableButton(){return!embeddableHandler.hasInspector||!embeddableHandler.hasInspector()},run:openInspector,tooltip(){if(!embeddableHandler.hasInspector||!embeddableHandler.hasInspector()){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.openInspectorDisabledButtonTooltip",{defaultMessage:"This visualization doesn't support any inspectors."})}}},{id:"share",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.shareVisualizationButtonLabel",{defaultMessage:"share"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.shareVisualizationButtonAriaLabel",{defaultMessage:"Share Visualization"}),testId:"shareTopNavButton",run:anchorElement=>{if(share&&!embeddableId){share.toggleShareContextMenu({anchorElement:anchorElement,allowEmbed:true,allowShortUrl:visualizeCapabilities.createShortUrl,shareableUrl:Object(kibanaUtils_public_["unhashUrl"])(window.location.href),objectId:savedVis===null||savedVis===void 0?void 0:savedVis.id,objectType:"visualization",sharingData:{title:savedVis===null||savedVis===void 0?void 0:savedVis.title},isDirty:hasUnappliedChanges||hasUnsavedChanges})}},disableButton:!share||!!embeddableId},...originatingApp==="dashboards"||originatingApp==="canvas"?[{id:"cancel",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.cancelButtonLabel",{defaultMessage:"Cancel"}),emphasize:false,description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.cancelButtonAriaLabel",{defaultMessage:"Return to the last app without saving changes"}),testId:"visualizeCancelAndReturnButton",tooltip(){if(hasUnappliedChanges||hasUnsavedChanges){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.cancelAndReturnButtonTooltip",{defaultMessage:"Discard your changes before finishing"})}},run:function(){var _run=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",navigateToOriginatingApp());case 1:case"end":return _context.stop()}}),_callee)})));function run(){return _run.apply(this,arguments)}return run}()}]:[],...visualizeCapabilities.save&&!embeddableId?[{id:"save",iconType:(savedVis===null||savedVis===void 0?void 0:savedVis.id)&&originatingApp?undefined:"save",label:(savedVis===null||savedVis===void 0?void 0:savedVis.id)&&originatingApp?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualizationAsButtonLabel",{defaultMessage:"save as"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualizationButtonLabel",{defaultMessage:"save"}),emphasize:savedVis&&!savedVis.id||!originatingApp,description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualizationButtonAriaLabel",{defaultMessage:"Save Visualization"}),className:(savedVis===null||savedVis===void 0?void 0:savedVis.id)&&originatingApp?"saveAsButton":"",testId:"visualizeSaveButton",disableButton:hasUnappliedChanges,tooltip(){if(hasUnappliedChanges){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualizationDisabledButtonTooltip",{defaultMessage:"Apply or Discard your changes before saving"})}},run:anchorElement=>{const onSave=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee2({newTitle:newTitle,newCopyOnSave:newCopyOnSave,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate,newDescription:newDescription,returnToOrigin:returnToOrigin}){var currentTitle,saveOptions,response;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(savedVis){_context2.next=2;break}return _context2.abrupt("return");case 2:currentTitle=savedVis.title;savedVis.title=newTitle;embeddableHandler.updateInput({title:newTitle});savedVis.copyOnSave=newCopyOnSave;savedVis.description=newDescription;if(savedObjectsTagging&&savedObjectsTagging.ui.hasTagDecoration(savedVis)){savedVis.setTags(selectedTags)}saveOptions={confirmOverwrite:false,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate,returnToOrigin:returnToOrigin};_context2.next=11;return doSave(saveOptions);case 11:response=_context2.sent;if(!response.id||response.error){savedVis.title=currentTitle}return _context2.abrupt("return",response);case 14:case"end":return _context2.stop()}}),_callee2)})));return function onSave(_x2){return _ref.apply(this,arguments)}}();let selectedTags=[];let options;if(savedVis&&savedObjectsTagging&&savedObjectsTagging.ui.hasTagDecoration(savedVis)){selectedTags=savedVis.getTags();options=external_kbnSharedDeps_React_default.a.createElement(savedObjectsTagging.ui.components.SavedObjectSaveModalTagSelector,{initialSelection:selectedTags,onTagsSelected:newSelection=>{selectedTags=newSelection}})}const saveModal=external_kbnSharedDeps_React_default.a.createElement(savedObjects_public_["SavedObjectSaveModalOrigin"],{documentInfo:savedVis||{title:""},onSave:onSave,options:options,getAppNameFromId:stateTransfer.getAppNameFromId,objectType:"visualization",onClose:()=>{},originatingApp:originatingApp});const isSaveAsButton=anchorElement.classList.contains("saveAsButton");onAppLeave(actions=>actions.default());if(originatingApp==="dashboards"&&dashboard.dashboardFeatureFlagConfig.allowByValueEmbeddables&&!isSaveAsButton){createVisReference()}else if(savedVis){Object(savedObjects_public_["showSaveModal"])(saveModal,I18nContext)}}}]:[],...originatingApp&&(savedVis&&savedVis.id||embeddableId)?[{id:"saveAndReturn",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveAndReturnVisualizationButtonLabel",{defaultMessage:"Save and return"}),emphasize:true,iconType:"checkInCircleFilled",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveAndReturnVisualizationButtonAriaLabel",{defaultMessage:"Finish editing visualization and return to the last app"}),testId:"visualizesaveAndReturnButton",disableButton:hasUnappliedChanges,tooltip(){if(hasUnappliedChanges){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveAndReturnVisualizationDisabledButtonTooltip",{defaultMessage:"Apply or Discard your changes before finishing"})}},run:function(){var _run2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var saveOptions;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:saveOptions={confirmOverwrite:false,returnToOrigin:true};onAppLeave(actions=>actions.default());if(!(originatingApp==="dashboards"&&dashboard.dashboardFeatureFlagConfig.allowByValueEmbeddables&&!savedVis)){_context3.next=4;break}return _context3.abrupt("return",createVisReference());case 4:return _context3.abrupt("return",doSave(saveOptions));case 5:case"end":return _context3.stop()}}),_callee3)})));function run(){return _run2.apply(this,arguments)}return run}()}]:[]];return topNavMenu};function utils_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function utils_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){utils_ownKeys(Object(source),true).forEach((function(key){utils_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{utils_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function utils_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const addHelpMenuToAppChrome=(chrome,docLinks)=>{chrome.setHelpExtension({appName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.helpMenu.appName",{defaultMessage:"Visualize"}),links:[{linkType:"documentation",href:"".concat(docLinks.ELASTIC_WEBSITE_URL,"guide/en/kibana/").concat(docLinks.DOC_LINK_VERSION,"/visualize.html")}]})};const addBadgeToAppChrome=chrome=>{chrome.setBadge({text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.badge.readOnly.tooltip",{defaultMessage:"Unable to save visualizations"}),iconType:"glasses"})};const getDefaultQuery=({data:data})=>data.query.queryString.getDefaultQuery();const visStateToEditorState=(visInstance,services)=>{var _vis$data$searchSourc,_vis$data$searchSourc2;const vis=visInstance.vis;const savedVisState=services.visualizations.convertFromSerializedVis(vis.serialize());const savedVis="savedVis"in visInstance?visInstance.savedVis:undefined;return{uiState:savedVis&&savedVis.uiStateJSON?JSON.parse(savedVis.uiStateJSON):vis.uiState.toJSON(),query:((_vis$data$searchSourc=vis.data.searchSource)===null||_vis$data$searchSourc===void 0?void 0:_vis$data$searchSourc.getOwnField("query"))||getDefaultQuery(services),filters:((_vis$data$searchSourc2=vis.data.searchSource)===null||_vis$data$searchSourc2===void 0?void 0:_vis$data$searchSourc2.getOwnField("filter"))||[],vis:utils_objectSpread(utils_objectSpread({},savedVisState.visState),{},{title:vis.title}),linked:savedVis&&savedVis.id?!!savedVis.savedSearchId:!!savedVisState.savedSearchId}};function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useChromeVisibility=chrome=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=_slicedToArray(_useState,2),isVisible=_useState2[0],setIsVisible=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const subscription=chrome.getIsVisible$().subscribe(value=>{setIsVisible(value)});return()=>subscription.unsubscribe()},[chrome]);return isVisible};var external_kbnSharedDeps_Lodash_=__webpack_require__(20);function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function use_editor_updates_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_editor_updates_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_editor_updates_ownKeys(Object(source),true).forEach((function(key){use_editor_updates_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_editor_updates_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_editor_updates_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_editor_updates_slicedToArray(arr,i){return use_editor_updates_arrayWithHoles(arr)||use_editor_updates_iterableToArrayLimit(arr,i)||use_editor_updates_unsupportedIterableToArray(arr,i)||use_editor_updates_nonIterableRest()}function use_editor_updates_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_editor_updates_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_editor_updates_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_editor_updates_arrayLikeToArray(o,minLen)}function use_editor_updates_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_editor_updates_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_editor_updates_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useEditorUpdates=(services,eventEmitter,setHasUnsavedChanges,appState,visInstance,visEditorController)=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=use_editor_updates_slicedToArray(_useState,2),isEmbeddableRendered=_useState2[0],setIsEmbeddableRendered=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=use_editor_updates_slicedToArray(_useState3,2),currentAppState=_useState4[0],setCurrentAppState=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(appState&&visInstance){const _services$data$query=services.data.query,timefilter=_services$data$query.timefilter.timefilter,filterManager=_services$data$query.filterManager,queryString=_services$data$query.queryString,state$=_services$data$query.state$;const embeddableHandler=visInstance.embeddableHandler,savedSearch=visInstance.savedSearch,vis=visInstance.vis;const savedVis="savedVis"in visInstance?visInstance.savedVis:undefined;const initialState=appState.getState();setCurrentAppState(initialState);const reloadVisualization=()=>{if(visEditorController){visEditorController.render({core:services,data:services.data,uiState:vis.uiState,timeRange:timefilter.getTime(),filters:filterManager.getFilters(),query:queryString.getQuery(),linked:!!vis.data.savedSearchId,savedSearch:savedSearch})}else{embeddableHandler.updateInput({timeRange:timefilter.getTime(),filters:filterManager.getFilters(),query:queryString.getQuery()})}};const subscriptions=state$.subscribe({next:reloadVisualization,error:services.fatalErrors.add});const handleLinkedSearch=linked=>{if(linked&&savedVis&&!savedVis.savedSearchId&&savedSearch){savedVis.savedSearchId=savedSearch.id;vis.data.savedSearchId=savedSearch.id;if(vis.data.searchSource){vis.data.searchSource.setParent(savedSearch.searchSource)}}else if(!linked&&savedVis&&savedVis.savedSearchId){delete savedVis.savedSearchId;delete vis.data.savedSearchId}else if(!linked&&!savedVis){delete vis.data.savedSearchId}};if(initialState.uiState){vis.uiState.setSilent(initialState.uiState)}const updateOnChange=()=>{appState.transitions.set("uiState",vis.uiState.getChanges())};vis.uiState.on("change",updateOnChange);const unsubscribeStateUpdates=appState.subscribe(state=>{setCurrentAppState(state);if(savedVis&&savedVis.id&&!services.history.location.pathname.includes(savedVis.id)){return}if(!Object(external_kbnSharedDeps_Lodash_["isEqual"])(state.uiState,vis.uiState.getChanges())){vis.uiState.set(state.uiState)}if(savedVis&&!Object(external_kbnSharedDeps_Lodash_["isEqual"])(use_editor_updates_objectSpread(use_editor_updates_objectSpread({},services.visualizations.convertFromSerializedVis(vis.serialize()).visState),{},{title:vis.title}),state.vis)){const _state$vis=state.vis,aggs=_state$vis.aggs,visState=_objectWithoutProperties(_state$vis,["aggs"]);vis.setState(use_editor_updates_objectSpread(use_editor_updates_objectSpread({},visState),{},{data:{aggs:aggs}}));embeddableHandler.reload();eventEmitter.emit("updateEditor")}handleLinkedSearch(state.linked);if(vis.data.searchSource){vis.data.searchSource.setField("query",state.query);vis.data.searchSource.setField("filter",state.filters)}reloadVisualization();setHasUnsavedChanges(true)});const updateOnEmbeddableRendered=()=>setIsEmbeddableRendered(true);eventEmitter.on("embeddableRendered",updateOnEmbeddableRendered);reloadVisualization();return()=>{setIsEmbeddableRendered(false);eventEmitter.off("embeddableRendered",updateOnEmbeddableRendered);subscriptions.unsubscribe();vis.uiState.off("change",updateOnChange);unsubscribeStateUpdates()}}},[appState,eventEmitter,visInstance,services,setHasUnsavedChanges,visEditorController]);return{isEmbeddableRendered:isEmbeddableRendered,currentAppState:currentAppState}};var query_string=__webpack_require__(53);var visDefaultEditor_public_=__webpack_require__(25);var discover_public_=__webpack_require__(29);function get_visualization_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function get_visualization_instance_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){get_visualization_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){get_visualization_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const createVisualizeEmbeddableAndLinkSavedSearch=function(){var _ref=get_visualization_instance_asyncToGenerator(regeneratorRuntime.mark((function _callee(vis,visualizeServices){var data,createVisEmbeddableFromObject,savedObjects,savedObjectsPublic,embeddableHandler,savedSearch;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:data=visualizeServices.data,createVisEmbeddableFromObject=visualizeServices.createVisEmbeddableFromObject,savedObjects=visualizeServices.savedObjects,savedObjectsPublic=visualizeServices.savedObjectsPublic;_context.next=3;return createVisEmbeddableFromObject(vis,{timeRange:data.query.timefilter.timefilter.getTime(),filters:data.query.filterManager.getFilters(),id:""});case 3:embeddableHandler=_context.sent;embeddableHandler.getOutput$().subscribe(output=>{if(output.error){data.search.showError(output.error.original||output.error)}});if(!vis.data.savedSearchId){_context.next=9;break}_context.next=8;return Object(discover_public_["createSavedSearchesLoader"])({savedObjectsClient:savedObjects.client,savedObjects:savedObjectsPublic}).get(vis.data.savedSearchId);case 8:savedSearch=_context.sent;case 9:return _context.abrupt("return",{savedSearch:savedSearch,embeddableHandler:embeddableHandler});case 10:case"end":return _context.stop()}}),_callee)})));return function createVisualizeEmbeddableAndLinkSavedSearch(_x,_x2){return _ref.apply(this,arguments)}}();const getVisualizationInstanceFromInput=function(){var _ref2=get_visualization_instance_asyncToGenerator(regeneratorRuntime.mark((function _callee2(visualizeServices,input){var visualizations,visState,vis,_yield$createVisualiz,embeddableHandler,savedSearch;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:visualizations=visualizeServices.visualizations;visState=input.savedVis;_context2.next=4;return visualizations.createVis(visState.type,Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(visState));case 4:vis=_context2.sent;if(!vis.type.setup){_context2.next=14;break}_context2.prev=6;_context2.next=9;return vis.type.setup(vis);case 9:vis=_context2.sent;_context2.next=14;break;case 12:_context2.prev=12;_context2.t0=_context2["catch"](6);case 14:_context2.next=16;return createVisualizeEmbeddableAndLinkSavedSearch(vis,visualizeServices);case 16:_yield$createVisualiz=_context2.sent;embeddableHandler=_yield$createVisualiz.embeddableHandler;savedSearch=_yield$createVisualiz.savedSearch;return _context2.abrupt("return",{vis:vis,embeddableHandler:embeddableHandler,savedSearch:savedSearch});case 20:case"end":return _context2.stop()}}),_callee2,null,[[6,12]])})));return function getVisualizationInstanceFromInput(_x3,_x4){return _ref2.apply(this,arguments)}}();const getVisualizationInstance=function(){var _ref3=get_visualization_instance_asyncToGenerator(regeneratorRuntime.mark((function _callee3(visualizeServices,opts){var visualizations,savedVisualizations,savedVis,serializedVis,vis,_yield$createVisualiz2,embeddableHandler,savedSearch;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:visualizations=visualizeServices.visualizations,savedVisualizations=visualizeServices.savedVisualizations;_context3.next=3;return savedVisualizations.get(opts);case 3:savedVis=_context3.sent;if(typeof opts!=="string"){savedVis.searchSourceFields={index:opts===null||opts===void 0?void 0:opts.indexPattern}}serializedVis=visualizations.convertToSerializedVis(savedVis);_context3.next=8;return visualizations.createVis(serializedVis.type,serializedVis);case 8:vis=_context3.sent;if(!vis.type.setup){_context3.next=18;break}_context3.prev=10;_context3.next=13;return vis.type.setup(vis);case 13:vis=_context3.sent;_context3.next=18;break;case 16:_context3.prev=16;_context3.t0=_context3["catch"](10);case 18:_context3.next=20;return createVisualizeEmbeddableAndLinkSavedSearch(vis,visualizeServices);case 20:_yield$createVisualiz2=_context3.sent;embeddableHandler=_yield$createVisualiz2.embeddableHandler;savedSearch=_yield$createVisualiz2.savedSearch;return _context3.abrupt("return",{vis:vis,embeddableHandler:embeddableHandler,savedSearch:savedSearch,savedVis:savedVis});case 24:case"end":return _context3.stop()}}),_callee3,null,[[10,16]])})));return function getVisualizationInstance(_x5,_x6){return _ref3.apply(this,arguments)}}();function use_saved_vis_instance_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_saved_vis_instance_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_saved_vis_instance_ownKeys(Object(source),true).forEach((function(key){use_saved_vis_instance_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_saved_vis_instance_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_saved_vis_instance_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_saved_vis_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_saved_vis_instance_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_saved_vis_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_saved_vis_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_saved_vis_instance_slicedToArray(arr,i){return use_saved_vis_instance_arrayWithHoles(arr)||use_saved_vis_instance_iterableToArrayLimit(arr,i)||use_saved_vis_instance_unsupportedIterableToArray(arr,i)||use_saved_vis_instance_nonIterableRest()}function use_saved_vis_instance_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_saved_vis_instance_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_saved_vis_instance_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_saved_vis_instance_arrayLikeToArray(o,minLen)}function use_saved_vis_instance_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_saved_vis_instance_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_saved_vis_instance_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useSavedVisInstance=(services,eventEmitter,isChromeVisible,visualizationIdFromUrl)=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])({}),_useState2=use_saved_vis_instance_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];const visEditorRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const visId=Object(external_kbnSharedDeps_React_["useRef"])("");Object(external_kbnSharedDeps_React_["useEffect"])(()=>{var _state$savedVisInstan;const navigateToApp=services.application.navigateToApp,chrome=services.chrome,history=services.history,basePath=services.http.basePath,setActiveUrl=services.setActiveUrl,toastNotifications=services.toastNotifications;const getSavedVisInstance=function(){var _ref=use_saved_vis_instance_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var savedVisInstance,searchParams,visTypes,visType,shouldHaveIndex,hasIndex,_savedVisInstance,embeddableHandler,savedVis,vis,visEditorController,Editor,managementRedirectTarget;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;if(!(history.location.pathname==="/create")){_context.next=16;break}searchParams=Object(query_string["parse"])(history.location.search);visTypes=services.visualizations.all();visType=visTypes.find(({name:name})=>name===searchParams.type);if(visType){_context.next=7;break}throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.createVisualization.noVisTypeErrorMessage",{defaultMessage:"You must provide a valid visualization type"}));case 7:shouldHaveIndex=visType.requiresSearch&&visType.options.showIndexSelection;hasIndex=searchParams.indexPattern||searchParams.savedSearchId;if(!(shouldHaveIndex&&!hasIndex)){_context.next=11;break}throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.createVisualization.noIndexPatternOrSavedSearchIdErrorMessage",{defaultMessage:"You must provide either an indexPattern or a savedSearchId"}));case 11:_context.next=13;return getVisualizationInstance(services,searchParams);case 13:savedVisInstance=_context.sent;_context.next=19;break;case 16:_context.next=18;return getVisualizationInstance(services,visualizationIdFromUrl);case 18:savedVisInstance=_context.sent;case 19:_savedVisInstance=savedVisInstance,embeddableHandler=_savedVisInstance.embeddableHandler,savedVis=_savedVisInstance.savedVis,vis=_savedVisInstance.vis;if(savedVis.id){chrome.setBreadcrumbs(getEditBreadcrumbs(savedVis.title));chrome.docTitle.change(savedVis.title)}else{chrome.setBreadcrumbs(getCreateBreadcrumbs())}if(visEditorRef.current){if(isChromeVisible){Editor=vis.type.editor||visDefaultEditor_public_["DefaultEditorController"];visEditorController=new Editor(visEditorRef.current,vis,eventEmitter,embeddableHandler)}else{embeddableHandler.render(visEditorRef.current)}}setState({savedVisInstance:savedVisInstance,visEditorController:visEditorController});_context.next=29;break;case 25:_context.prev=25;_context.t0=_context["catch"](0);managementRedirectTarget={app:"management",path:"kibana/objects/savedVisualizations/".concat(visualizationIdFromUrl)};try{Object(kibanaUtils_public_["redirectWhenMissing"])({history:history,navigateToApp:navigateToApp,toastNotifications:toastNotifications,basePath:basePath,mapping:{visualization:visualize_constants["b"].LANDING_PAGE_PATH,search:managementRedirectTarget,"index-pattern":managementRedirectTarget,"index-pattern-field":managementRedirectTarget},onBeforeRedirect(){setActiveUrl(visualize_constants["b"].LANDING_PAGE_PATH)}})(_context.t0)}catch(e){toastNotifications.addWarning({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.createVisualization.failedToLoadErrorMessage",{defaultMessage:"Failed to load the visualization"}),text:e.message});history.replace(visualize_constants["b"].LANDING_PAGE_PATH)}case 29:case"end":return _context.stop()}}),_callee,null,[[0,25]])})));return function getSavedVisInstance(){return _ref.apply(this,arguments)}}();if(isChromeVisible===undefined){return}if(!visId.current){visId.current=visualizationIdFromUrl||"new";getSavedVisInstance()}else if(visualizationIdFromUrl&&visId.current!==visualizationIdFromUrl&&((_state$savedVisInstan=state.savedVisInstance)===null||_state$savedVisInstan===void 0?void 0:_state$savedVisInstan.savedVis.id)!==visualizationIdFromUrl){visId.current=visualizationIdFromUrl;setState({});getSavedVisInstance()}},[eventEmitter,isChromeVisible,services,state.savedVisInstance,state.visEditorController,visualizationIdFromUrl]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{var _state$savedVisInstan2,_state$savedVisInstan3;if(state.visEditorController){state.visEditorController.destroy()}else if((_state$savedVisInstan2=state.savedVisInstance)===null||_state$savedVisInstan2===void 0?void 0:_state$savedVisInstan2.embeddableHandler){state.savedVisInstance.embeddableHandler.destroy()}if((_state$savedVisInstan3=state.savedVisInstance)===null||_state$savedVisInstan3===void 0?void 0:_state$savedVisInstan3.savedVis){state.savedVisInstance.savedVis.destroy()}},[state]);return use_saved_vis_instance_objectSpread(use_saved_vis_instance_objectSpread({},state),{},{visEditorRef:visEditorRef})};var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(5);function migrateLegacyQuery(query){if(!Object(external_kbnSharedDeps_Lodash_["has"])(query,"language")){return{query:query,language:"lucene"}}return query}function migrateAppState(appState){if(appState.vis.type!=="table"){return appState}const visAggs=Object(external_kbnSharedDeps_Lodash_["get"])(appState,"vis.aggs");if(visAggs){let splitCount=0;const migratedAggs=visAggs.map(agg=>{if(agg.schema!=="split"){return agg}splitCount++;if(splitCount===1){return agg}agg.schema="bucket";agg.params=Object(external_kbnSharedDeps_Lodash_["omit"])(agg.params,["row"]);return agg});if(splitCount<=1){return appState}appState.vis.aggs=migratedAggs}return appState}function create_visualize_app_state_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function create_visualize_app_state_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){create_visualize_app_state_ownKeys(Object(source),true).forEach((function(key){create_visualize_app_state_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{create_visualize_app_state_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function create_visualize_app_state_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const STATE_STORAGE_KEY="_a";function toObject(state){return Object(external_kbnSharedDeps_Lodash_["omitBy"])(state,(value,key)=>key.charAt(0)==="$"||key.charAt(0)==="_"||Object(external_kbnSharedDeps_Lodash_["isFunction"])(value))}const pureTransitions={set:state=>(prop,value)=>create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state),{},{[prop]:value}),setVis:state=>vis=>create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state),{},{vis:create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state.vis),vis)}),unlinkSavedSearch:state=>({query:query,parentFilters:parentFilters=[]})=>create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state),{},{query:query||state.query,filters:Object(external_kbnSharedDeps_Lodash_["union"])(state.filters,parentFilters),linked:false}),updateVisState:state=>newVisState=>create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state),{},{vis:toObject(newVisState)}),updateSavedQuery:state=>savedQueryId=>{const updatedState=create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state),{},{savedQuery:savedQueryId});if(!savedQueryId){delete updatedState.savedQuery}return updatedState}};function createVisualizeByValueAppState(stateDefaults){const initialState=migrateAppState(create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},stateDefaults),stateDefaults));const stateContainer=Object(kibanaUtils_public_["createStateContainer"])(initialState,pureTransitions);const stopStateSync=()=>{};return{stateContainer:stateContainer,stopStateSync:stopStateSync}}function createDefaultVisualizeAppState({stateDefaults:stateDefaults,kbnUrlStateStorage:kbnUrlStateStorage}){const urlState=kbnUrlStateStorage.get(STATE_STORAGE_KEY);const initialState=migrateAppState(create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},stateDefaults),urlState));kbnUrlStateStorage.set(STATE_STORAGE_KEY,initialState,{replace:true});const stateContainer=Object(kibanaUtils_public_["createStateContainer"])(initialState,pureTransitions);const _syncState=Object(kibanaUtils_public_["syncState"])({storageKey:STATE_STORAGE_KEY,stateContainer:create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},stateContainer),{},{set:state=>{if(state){stateContainer.set(state)}}}),stateStorage:kbnUrlStateStorage}),startStateSync=_syncState.start,stopStateSync=_syncState.stop;startStateSync();return{stateContainer:stateContainer,stopStateSync:stopStateSync}}function createVisualizeAppState({stateDefaults:stateDefaults,kbnUrlStateStorage:kbnUrlStateStorage,byValue:byValue}){if(byValue){return createVisualizeByValueAppState(stateDefaults)}return createDefaultVisualizeAppState({stateDefaults:stateDefaults,kbnUrlStateStorage:kbnUrlStateStorage})}function use_visualize_app_state_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_visualize_app_state_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_visualize_app_state_ownKeys(Object(source),true).forEach((function(key){use_visualize_app_state_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_visualize_app_state_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_visualize_app_state_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_visualize_app_state_objectWithoutProperties(source,excluded){if(source==null)return{};var target=use_visualize_app_state_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function use_visualize_app_state_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function use_visualize_app_state_slicedToArray(arr,i){return use_visualize_app_state_arrayWithHoles(arr)||use_visualize_app_state_iterableToArrayLimit(arr,i)||use_visualize_app_state_unsupportedIterableToArray(arr,i)||use_visualize_app_state_nonIterableRest()}function use_visualize_app_state_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_visualize_app_state_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_visualize_app_state_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_visualize_app_state_arrayLikeToArray(o,minLen)}function use_visualize_app_state_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_visualize_app_state_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_visualize_app_state_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useVisualizeAppState=(services,eventEmitter,instance)=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=use_visualize_app_state_slicedToArray(_useState,2),hasUnappliedChanges=_useState2[0],setHasUnappliedChanges=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(null),_useState4=use_visualize_app_state_slicedToArray(_useState3,2),appState=_useState4[0],setAppState=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(instance){const stateDefaults=visStateToEditorState(instance,services);const byValue=!("savedVis"in instance);const _createVisualizeAppSt=createVisualizeAppState({stateDefaults:stateDefaults,kbnUrlStateStorage:services.kbnUrlStateStorage,byValue:byValue}),stateContainer=_createVisualizeAppSt.stateContainer,stopStateSync=_createVisualizeAppSt.stopStateSync;const onDirtyStateChange=({isDirty:isDirty})=>{if(!isDirty){stateContainer.transitions.updateVisState(visStateToEditorState(instance,services).vis)}setHasUnappliedChanges(isDirty)};eventEmitter.on("dirtyStateChange",onDirtyStateChange);const _services$data$query=services.data.query,filterManager=_services$data$query.filterManager,queryString=_services$data$query.queryString;filterManager.setAppFilters(Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(stateContainer.getState().filters));queryString.setQuery(migrateLegacyQuery(stateContainer.getState().query));const stopSyncingAppFilters=Object(data_public_["connectToQueryState"])(services.data.query,{set:({filters:filters,query:query})=>{stateContainer.transitions.set("filters",filters);stateContainer.transitions.set("query",query)},get:()=>({filters:stateContainer.getState().filters,query:stateContainer.getState().query}),state$:stateContainer.state$.pipe(Object(external_kbnSharedDeps_RxjsOperators_["map"])(state=>({filters:state.filters,query:state.query})))},{filters:data_public_["esFilters"].FilterStateStore.APP_STATE,query:true});if(!Object(external_kbnSharedDeps_Lodash_["isEqual"])(stateContainer.getState().vis,stateDefaults.vis)){const _stateContainer$getSt=stateContainer.getState().vis,aggs=_stateContainer$getSt.aggs,visState=use_visualize_app_state_objectWithoutProperties(_stateContainer$getSt,["aggs"]);instance.vis.setState(use_visualize_app_state_objectSpread(use_visualize_app_state_objectSpread({},visState),{},{data:{aggs:aggs}})).then(()=>{setAppState(stateContainer)}).catch(error=>{services.toastNotifications.addWarning({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.visualizationLoadingFailedErrorMessage",{defaultMessage:"Failed to load the visualization"}),text:Object(public_["toMountPoint"])(external_kbnSharedDeps_React_default.a.createElement(public_["MarkdownSimple"],null,error.message))});services.history.replace("".concat(visualize_constants["b"].LANDING_PAGE_PATH,"?notFound=visualization"))})}else{setAppState(stateContainer)}return()=>{eventEmitter.off("dirtyStateChange",onDirtyStateChange);stopStateSync();stopSyncingAppFilters()}}},[eventEmitter,instance,services]);return{appState:appState,hasUnappliedChanges:hasUnappliedChanges}};const useLinkedSearchUpdates=(services,eventEmitter,appState,visInstance)=>{Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(appState&&visInstance&&visInstance.savedSearch&&visInstance.vis.data.searchSource){const savedSearch=visInstance.savedSearch;const searchSource=visInstance.vis.data.searchSource;const unlinkFromSavedSearch=()=>{const searchSourceParent=savedSearch.searchSource;const searchSourceGrandparent=searchSourceParent===null||searchSourceParent===void 0?void 0:searchSourceParent.getParent();const currentIndex=searchSourceParent===null||searchSourceParent===void 0?void 0:searchSourceParent.getField("index");searchSource.setField("index",currentIndex);searchSource.setParent(searchSourceGrandparent);appState.transitions.unlinkSavedSearch({query:searchSourceParent===null||searchSourceParent===void 0?void 0:searchSourceParent.getField("query"),parentFilters:(searchSourceParent===null||searchSourceParent===void 0?void 0:searchSourceParent.getOwnField("filter"))||[]});services.toastNotifications.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.linkedToSearch.unlinkSuccessNotificationText",{defaultMessage:"Unlinked from saved search '{searchTitle}'",values:{searchTitle:savedSearch.title}}))};eventEmitter.on("unlinkFromSavedSearch",unlinkFromSavedSearch);return()=>{eventEmitter.off("unlinkFromSavedSearch",unlinkFromSavedSearch)}}},[appState,eventEmitter,visInstance,services.toastNotifications])};function use_vis_byvalue_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_vis_byvalue_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_vis_byvalue_ownKeys(Object(source),true).forEach((function(key){use_vis_byvalue_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_vis_byvalue_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_vis_byvalue_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_vis_byvalue_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_vis_byvalue_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_vis_byvalue_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_vis_byvalue_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_vis_byvalue_slicedToArray(arr,i){return use_vis_byvalue_arrayWithHoles(arr)||use_vis_byvalue_iterableToArrayLimit(arr,i)||use_vis_byvalue_unsupportedIterableToArray(arr,i)||use_vis_byvalue_nonIterableRest()}function use_vis_byvalue_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_vis_byvalue_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_vis_byvalue_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_vis_byvalue_arrayLikeToArray(o,minLen)}function use_vis_byvalue_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_vis_byvalue_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_vis_byvalue_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const useVisByValue=(services,eventEmitter,isChromeVisible,valueInput,originatingApp)=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])({}),_useState2=use_vis_byvalue_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];const visEditorRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const loaded=Object(external_kbnSharedDeps_React_["useRef"])(false);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const chrome=services.chrome;const getVisInstance=function(){var _ref=use_vis_byvalue_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var byValueVisInstance,embeddableHandler,vis,Editor,visEditorController;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(!valueInput||loaded.current||!visEditorRef.current)){_context.next=2;break}return _context.abrupt("return");case 2:_context.next=4;return getVisualizationInstanceFromInput(services,valueInput);case 4:byValueVisInstance=_context.sent;embeddableHandler=byValueVisInstance.embeddableHandler,vis=byValueVisInstance.vis;Editor=vis.type.editor||visDefaultEditor_public_["DefaultEditorController"];visEditorController=new Editor(visEditorRef.current,vis,eventEmitter,embeddableHandler);if(chrome&&originatingApp){chrome.setBreadcrumbs(getBreadcrumbsPrefixedWithApp(originatingApp))}else if(chrome){chrome.setBreadcrumbs(getEditBreadcrumbs())}loaded.current=true;setState({byValueVisInstance:byValueVisInstance,visEditorController:visEditorController});case 11:case"end":return _context.stop()}}),_callee)})));return function getVisInstance(){return _ref.apply(this,arguments)}}();getVisInstance()},[eventEmitter,isChromeVisible,services,state.byValueVisInstance,state.visEditorController,valueInput,originatingApp]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{var _state$byValueVisInst;if(state.visEditorController){state.visEditorController.destroy()}else if((_state$byValueVisInst=state.byValueVisInstance)===null||_state$byValueVisInst===void 0?void 0:_state$byValueVisInst.embeddableHandler){state.byValueVisInstance.embeddableHandler.destroy()}},[state]);return use_vis_byvalue_objectSpread(use_vis_byvalue_objectSpread({},state),{},{visEditorRef:visEditorRef})};function visualize_listing_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function visualize_listing_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){visualize_listing_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){visualize_listing_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const VisualizeListing=()=>{const _useKibana=Object(public_["useKibana"])(),_useKibana$services=_useKibana.services,application=_useKibana$services.application,chrome=_useKibana$services.chrome,history=_useKibana$services.history,savedVisualizations=_useKibana$services.savedVisualizations,toastNotifications=_useKibana$services.toastNotifications,visualizations=_useKibana$services.visualizations,savedObjects=_useKibana$services.savedObjects,savedObjectsPublic=_useKibana$services.savedObjectsPublic,savedObjectsTagging=_useKibana$services.savedObjectsTagging,uiSettings=_useKibana$services.uiSettings,visualizeCapabilities=_useKibana$services.visualizeCapabilities;const _useLocation=Object(external_kbnSharedDeps_ReactRouterDom_["useLocation"])(),pathname=_useLocation.pathname;const closeNewVisModal=Object(external_kbnSharedDeps_React_["useRef"])(()=>{});const listingLimit=savedObjectsPublic.settings.getListingLimit();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(pathname==="/new"){closeNewVisModal.current=visualizations.showNewVisModal({onClose:()=>{history.push(visualize_constants["b"].LANDING_PAGE_PATH)}})}else{closeNewVisModal.current()}},[history,pathname,visualizations]);useMount_default()(()=>{chrome.setBreadcrumbs([{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.visualizeListingBreadcrumbsTitle",{defaultMessage:"Visualize"})}]);chrome.docTitle.change(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listingPageTitle",{defaultMessage:"Visualize"}))});useUnmount_default()(()=>closeNewVisModal.current());const createNewVis=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{closeNewVisModal.current=visualizations.showNewVisModal()},[visualizations]);const editItem=Object(external_kbnSharedDeps_React_["useCallback"])(({editUrl:editUrl,editApp:editApp})=>{if(editApp){application.navigateToApp(editApp,{path:editUrl});return}history.push(editUrl)},[application,history]);const noItemsFragment=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getNoItemsMessage(createNewVis),[createNewVis]);const tableColumns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getTableColumns(application,history,savedObjectsTagging),[application,history,savedObjectsTagging]);const fetchItems=Object(external_kbnSharedDeps_React_["useCallback"])(filter=>{let searchTerm=filter;let references;if(savedObjectsTagging){const parsedQuery=savedObjectsTagging.ui.parseSearchQuery(filter,{useName:true});searchTerm=parsedQuery.searchTerm;references=parsedQuery.tagReferences}const isLabsEnabled=uiSettings.get(visualizations_public_["VISUALIZE_ENABLE_LABS_SETTING"]);return savedVisualizations.findListItems(searchTerm,{size:listingLimit,references:references}).then(({total:total,hits:hits})=>({total:total,hits:hits.filter(result=>{var _result$type;return isLabsEnabled||((_result$type=result.type)===null||_result$type===void 0?void 0:_result$type.stage)!=="experimental"})}))},[listingLimit,savedVisualizations,uiSettings,savedObjectsTagging]);const deleteItems=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref=visualize_listing_asyncToGenerator(regeneratorRuntime.mark((function _callee(selectedItems){return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all(selectedItems.map(item=>savedObjects.client.delete(item.savedObjectType,item.id))).catch(error=>{toastNotifications.addError(error,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.visualizeListingDeleteErrorTitle",{defaultMessage:"Error deleting visualization"})})});case 2:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),[savedObjects.client,toastNotifications]);const searchFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>savedObjectsTagging?[savedObjectsTagging.ui.getSearchBarFilter({useName:true})]:[],[savedObjectsTagging]);return external_kbnSharedDeps_React_default.a.createElement(public_["TableListView"],{headingId:"visualizeListingHeading",createItem:createNewVis,tableCaption:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.listTitle",{defaultMessage:"Visualizations"}),findItems:fetchItems,deleteItems:visualizeCapabilities.delete?deleteItems:undefined,editItem:visualizeCapabilities.save?editItem:undefined,tableColumns:tableColumns,listingLimit:listingLimit,initialPageSize:savedObjectsPublic.settings.getPerPage(),initialFilter:"",rowHeader:"title",noItemsFragment:noItemsFragment,entityName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.entityName",{defaultMessage:"visualization"}),entityNamePlural:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.entityNamePlural",{defaultMessage:"visualizations"}),tableListTitle:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.listTitle",{defaultMessage:"Visualizations"}),toastNotifications:toastNotifications,searchFilters:searchFilters})};var visualize_editor=__webpack_require__(32);var events=__webpack_require__(34);function visualize_top_nav_slicedToArray(arr,i){return visualize_top_nav_arrayWithHoles(arr)||visualize_top_nav_iterableToArrayLimit(arr,i)||visualize_top_nav_unsupportedIterableToArray(arr,i)||visualize_top_nav_nonIterableRest()}function visualize_top_nav_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function visualize_top_nav_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return visualize_top_nav_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return visualize_top_nav_arrayLikeToArray(o,minLen)}function visualize_top_nav_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function visualize_top_nav_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function visualize_top_nav_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const TopNav=({currentAppState:currentAppState,isChromeVisible:isChromeVisible,isEmbeddableRendered:isEmbeddableRendered,hasUnsavedChanges:hasUnsavedChanges,setHasUnsavedChanges:setHasUnsavedChanges,hasUnappliedChanges:hasUnappliedChanges,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,visInstance:visInstance,stateContainer:stateContainer,visualizationIdFromUrl:visualizationIdFromUrl,embeddableId:embeddableId,onAppLeave:onAppLeave})=>{const _useKibana=Object(public_["useKibana"])(),services=_useKibana.services;const TopNavMenu=services.navigation.ui.TopNavMenu;const setHeaderActionMenu=services.setHeaderActionMenu,visualizeCapabilities=services.visualizeCapabilities;const embeddableHandler=visInstance.embeddableHandler,vis=visInstance.vis;const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=visualize_top_nav_slicedToArray(_useState,2),inspectorSession=_useState2[0],setInspectorSession=_useState2[1];const openInspector=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const session=embeddableHandler.openInspector();setInspectorSession(session)},[embeddableHandler]);const handleRefresh=Object(external_kbnSharedDeps_React_["useCallback"])((_payload,isUpdate)=>{if(isUpdate===false){visInstance.embeddableHandler.reload()}},[visInstance.embeddableHandler]);const stateTransfer=services.embeddable.getStateTransfer();const config=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(isEmbeddableRendered){return getTopNavConfig({hasUnsavedChanges:hasUnsavedChanges,setHasUnsavedChanges:setHasUnsavedChanges,hasUnappliedChanges:hasUnappliedChanges,openInspector:openInspector,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,visInstance:visInstance,stateContainer:stateContainer,visualizationIdFromUrl:visualizationIdFromUrl,stateTransfer:stateTransfer,embeddableId:embeddableId,onAppLeave:onAppLeave},services)}},[isEmbeddableRendered,hasUnsavedChanges,setHasUnsavedChanges,hasUnappliedChanges,openInspector,originatingApp,visInstance,setOriginatingApp,stateContainer,visualizationIdFromUrl,services,embeddableId,stateTransfer,onAppLeave]);const _useState3=Object(external_kbnSharedDeps_React_["useState"])(vis.data.indexPattern),_useState4=visualize_top_nav_slicedToArray(_useState3,2),indexPattern=_useState4[0],setIndexPattern=_useState4[1];const showDatePicker=()=>{const hasTimeField=vis.data.indexPattern?!!vis.data.indexPattern.timeFieldName:true;return vis.type.options.showTimePicker&&hasTimeField};const showFilterBar=vis.type.options.showFilterBar;const showQueryInput=vis.type.requiresSearch&&vis.type.options.showQueryBar;Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{if(inspectorSession){inspectorSession.close()}},[inspectorSession]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{onAppLeave(actions=>{if((originatingApp&&originatingApp==="dashboards"||originatingApp==="canvas")&&(hasUnappliedChanges||hasUnsavedChanges)){return actions.confirm(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.confirmModal.confirmTextDescription",{defaultMessage:"Leave Visualize editor with unsaved changes?"}),external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.confirmModal.title",{defaultMessage:"Unsaved changes"}))}return actions.default()})},[onAppLeave,hasUnappliedChanges,hasUnsavedChanges,visualizeCapabilities.save,originatingApp]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!vis.data.indexPattern){services.data.indexPatterns.getDefault().then(index=>{if(index){setIndexPattern(index)}})}},[services.data.indexPatterns,vis.data.indexPattern]);return isChromeVisible?external_kbnSharedDeps_React_default.a.createElement(TopNavMenu,{appName:visualize_constants["a"],config:config,setMenuMountPoint:setHeaderActionMenu,onQuerySubmit:handleRefresh,savedQueryId:currentAppState.savedQuery,onSavedQueryIdChange:stateContainer.transitions.updateSavedQuery,indexPatterns:indexPattern?[indexPattern]:undefined,screenTitle:vis.title,showAutoRefreshOnly:!showDatePicker(),showDatePicker:showDatePicker(),showFilterBar:showFilterBar,showQueryInput:showQueryInput,showSaveQuery:services.visualizeCapabilities.saveQuery,showSearchBar:true,useDefaultBehaviors:true}):showFilterBar?external_kbnSharedDeps_React_default.a.createElement(TopNavMenu,{appName:visualize_constants["a"],setMenuMountPoint:setHeaderActionMenu,indexPatterns:indexPattern?[indexPattern]:undefined,showSearchBar:true,showSaveQuery:false,showDatePicker:false,showQueryInput:false}):null};const VisualizeTopNav=Object(external_kbnSharedDeps_React_["memo"])(TopNav);const InfoComponent=()=>{const title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.experimentalVisInfoText",defaultMessage:"This visualization is experimental and is not subject to the support SLA of official GA features. For feedback, please create an issue in {githubLink}.",values:{githubLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{external:true,href:"https://github.com/elastic/kibana/issues/new/choose",target:"_blank"},"GitHub")}}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{className:"hide-for-sharing","data-test-subj":"experimentalVisInfo",size:"s",title:title,iconType:"beaker"})};const ExperimentalVisInfo=Object(external_kbnSharedDeps_React_["memo"])(InfoComponent);const VisualizeEditorCommon=({visInstance:visInstance,appState:appState,currentAppState:currentAppState,isChromeVisible:isChromeVisible,hasUnsavedChanges:hasUnsavedChanges,setHasUnsavedChanges:setHasUnsavedChanges,hasUnappliedChanges:hasUnappliedChanges,isEmbeddableRendered:isEmbeddableRendered,onAppLeave:onAppLeave,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,visualizationIdFromUrl:visualizationIdFromUrl,embeddableId:embeddableId,visEditorRef:visEditorRef})=>{var _visInstance$vis,_visInstance$vis$type,_visInstance$vis2,_visInstance$vis2$typ,_visInstance$vis2$typ2;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"app-container visEditor visEditor--".concat(visInstance===null||visInstance===void 0?void 0:visInstance.vis.type.name)},visInstance&&appState&&currentAppState&&external_kbnSharedDeps_React_default.a.createElement(VisualizeTopNav,{currentAppState:currentAppState,hasUnsavedChanges:hasUnsavedChanges,setHasUnsavedChanges:setHasUnsavedChanges,isChromeVisible:isChromeVisible,isEmbeddableRendered:isEmbeddableRendered,hasUnappliedChanges:hasUnappliedChanges,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,visInstance:visInstance,stateContainer:appState,visualizationIdFromUrl:visualizationIdFromUrl,embeddableId:embeddableId,onAppLeave:onAppLeave}),(visInstance===null||visInstance===void 0?void 0:(_visInstance$vis=visInstance.vis)===null||_visInstance$vis===void 0?void 0:(_visInstance$vis$type=_visInstance$vis.type)===null||_visInstance$vis$type===void 0?void 0:_visInstance$vis$type.stage)==="experimental"&&external_kbnSharedDeps_React_default.a.createElement(ExperimentalVisInfo,null),visInstance===null||visInstance===void 0?void 0:(_visInstance$vis2=visInstance.vis)===null||_visInstance$vis2===void 0?void 0:(_visInstance$vis2$typ=_visInstance$vis2.type)===null||_visInstance$vis2$typ===void 0?void 0:(_visInstance$vis2$typ2=_visInstance$vis2$typ.getInfoMessage)===null||_visInstance$vis2$typ2===void 0?void 0:_visInstance$vis2$typ2.call(_visInstance$vis2$typ,visInstance.vis),visInstance&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiScreenReaderOnly"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,"savedVis"in visInstance&&visInstance.savedVis.id?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.pageHeading",defaultMessage:"{chartName} {chartType} visualization",values:{chartName:visInstance.savedVis.title,chartType:visInstance.vis.type.title}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.byValue_pageHeading",defaultMessage:"Visualization of type {chartType} embedded into {originatingApp} app",values:{chartType:visInstance.vis.type.title,originatingApp:originatingApp||"dashboards"}}))),external_kbnSharedDeps_React_default.a.createElement("div",{className:isChromeVisible?"visEditor__content":"visualize",ref:visEditorRef}))};function visualize_editor_slicedToArray(arr,i){return visualize_editor_arrayWithHoles(arr)||visualize_editor_iterableToArrayLimit(arr,i)||visualize_editor_unsupportedIterableToArray(arr,i)||visualize_editor_nonIterableRest()}function visualize_editor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function visualize_editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return visualize_editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return visualize_editor_arrayLikeToArray(o,minLen)}function visualize_editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function visualize_editor_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function visualize_editor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const VisualizeEditor=({onAppLeave:onAppLeave})=>{const _useParams=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])(),visualizationIdFromUrl=_useParams.id;const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=visualize_editor_slicedToArray(_useState,2),originatingApp=_useState2[0],setOriginatingApp=_useState2[1];const _useKibana=Object(public_["useKibana"])(),services=_useKibana.services;const _useState3=Object(external_kbnSharedDeps_React_["useState"])(new events["EventEmitter"]),_useState4=visualize_editor_slicedToArray(_useState3,1),eventEmitter=_useState4[0];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(!visualizationIdFromUrl),_useState6=visualize_editor_slicedToArray(_useState5,2),hasUnsavedChanges=_useState6[0],setHasUnsavedChanges=_useState6[1];const isChromeVisible=useChromeVisibility(services.chrome);const _useSavedVisInstance=useSavedVisInstance(services,eventEmitter,isChromeVisible,visualizationIdFromUrl),savedVisInstance=_useSavedVisInstance.savedVisInstance,visEditorRef=_useSavedVisInstance.visEditorRef,visEditorController=_useSavedVisInstance.visEditorController;const _useVisualizeAppState=useVisualizeAppState(services,eventEmitter,savedVisInstance),appState=_useVisualizeAppState.appState,hasUnappliedChanges=_useVisualizeAppState.hasUnappliedChanges;const _useEditorUpdates=useEditorUpdates(services,eventEmitter,setHasUnsavedChanges,appState,savedVisInstance,visEditorController),isEmbeddableRendered=_useEditorUpdates.isEmbeddableRendered,currentAppState=_useEditorUpdates.currentAppState;useLinkedSearchUpdates(services,eventEmitter,appState,savedVisInstance);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const _ref=services.embeddable.getStateTransfer(services.scopedHistory).getIncomingEditorState({keysToRemoveAfterFetch:["id","input"]})||{},value=_ref.originatingApp;setOriginatingApp(value)},[services]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{eventEmitter.removeAllListeners()},[eventEmitter]);return external_kbnSharedDeps_React_default.a.createElement(VisualizeEditorCommon,{visInstance:savedVisInstance,appState:appState,currentAppState:currentAppState,isChromeVisible:isChromeVisible,hasUnsavedChanges:hasUnsavedChanges,hasUnappliedChanges:hasUnappliedChanges,isEmbeddableRendered:isEmbeddableRendered,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,visualizationIdFromUrl:visualizationIdFromUrl,setHasUnsavedChanges:setHasUnsavedChanges,visEditorRef:visEditorRef,onAppLeave:onAppLeave})};let bannerId;const VisualizeNoMatch=()=>{const _useKibana=Object(public_["useKibana"])(),services=_useKibana.services;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{services.restorePreviousUrl();const _services$urlForwardi=services.urlForwarding.navigateToLegacyKibanaUrl(services.history.location.pathname),navigated=_services$urlForwardi.navigated;if(!navigated){const bannerMessage=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.noMatchRoute.bannerTitleText",{defaultMessage:"Page not found"});bannerId=services.overlays.banners.replace(bannerId,Object(public_["toMountPoint"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"warning",iconType:"iInCircle",title:bannerMessage},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.noMatchRoute.bannerText",defaultMessage:"Visualize application doesn't recognize this route: {route}.",values:{route:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:window.location.href},services.history.location.pathname)}})))));setTimeout(()=>{services.overlays.banners.remove(bannerId)},15e3);services.history.replace(visualize_constants["b"].LANDING_PAGE_PATH)}},[services]);return null};var public_0=__webpack_require__(10);function visualize_byvalue_editor_slicedToArray(arr,i){return visualize_byvalue_editor_arrayWithHoles(arr)||visualize_byvalue_editor_iterableToArrayLimit(arr,i)||visualize_byvalue_editor_unsupportedIterableToArray(arr,i)||visualize_byvalue_editor_nonIterableRest()}function visualize_byvalue_editor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function visualize_byvalue_editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return visualize_byvalue_editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return visualize_byvalue_editor_arrayLikeToArray(o,minLen)}function visualize_byvalue_editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function visualize_byvalue_editor_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function visualize_byvalue_editor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}const VisualizeByValueEditor=({onAppLeave:onAppLeave})=>{const _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=visualize_byvalue_editor_slicedToArray(_useState,2),originatingApp=_useState2[0],setOriginatingApp=_useState2[1];const _useKibana=Object(public_["useKibana"])(),services=_useKibana.services;const _useState3=Object(external_kbnSharedDeps_React_["useState"])(new events["EventEmitter"]),_useState4=visualize_byvalue_editor_slicedToArray(_useState3,1),eventEmitter=_useState4[0];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=visualize_byvalue_editor_slicedToArray(_useState5,2),hasUnsavedChanges=_useState6[0],setHasUnsavedChanges=_useState6[1];const _useState7=Object(external_kbnSharedDeps_React_["useState"])(),_useState8=visualize_byvalue_editor_slicedToArray(_useState7,2),embeddableId=_useState8[0],setEmbeddableId=_useState8[1];const _useState9=Object(external_kbnSharedDeps_React_["useState"])(),_useState10=visualize_byvalue_editor_slicedToArray(_useState9,2),valueInput=_useState10[0],setValueInput=_useState10[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const _ref=services.embeddable.getStateTransfer(services.scopedHistory).getIncomingEditorState({keysToRemoveAfterFetch:["id","embeddableId","valueInput"]})||{},value=_ref.originatingApp,embeddableIdValue=_ref.embeddableId,valueInputValue=_ref.valueInput;setOriginatingApp(value);setValueInput(valueInputValue);setEmbeddableId(embeddableIdValue);if(!valueInputValue){services.history.replace(public_0["VisualizeConstants"].LANDING_PAGE_PATH)}},[services]);const isChromeVisible=useChromeVisibility(services.chrome);const _useVisByValue=useVisByValue(services,eventEmitter,isChromeVisible,valueInput,originatingApp),byValueVisInstance=_useVisByValue.byValueVisInstance,visEditorRef=_useVisByValue.visEditorRef,visEditorController=_useVisByValue.visEditorController;const _useVisualizeAppState=useVisualizeAppState(services,eventEmitter,byValueVisInstance),appState=_useVisualizeAppState.appState,hasUnappliedChanges=_useVisualizeAppState.hasUnappliedChanges;const _useEditorUpdates=useEditorUpdates(services,eventEmitter,setHasUnsavedChanges,appState,byValueVisInstance,visEditorController),isEmbeddableRendered=_useEditorUpdates.isEmbeddableRendered,currentAppState=_useEditorUpdates.currentAppState;useLinkedSearchUpdates(services,eventEmitter,appState,byValueVisInstance);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{eventEmitter.removeAllListeners()},[eventEmitter]);return external_kbnSharedDeps_React_default.a.createElement(VisualizeEditorCommon,{visInstance:byValueVisInstance,appState:appState,currentAppState:currentAppState,isChromeVisible:isChromeVisible,hasUnsavedChanges:hasUnsavedChanges,hasUnappliedChanges:hasUnappliedChanges,isEmbeddableRendered:isEmbeddableRendered,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,setHasUnsavedChanges:setHasUnsavedChanges,visEditorRef:visEditorRef,embeddableId:embeddableId,onAppLeave:onAppLeave})};const VisualizeApp=({onAppLeave:onAppLeave})=>{const _useKibana=Object(public_["useKibana"])(),_useKibana$services=_useKibana.services,query=_useKibana$services.data.query,kbnUrlStateStorage=_useKibana$services.kbnUrlStateStorage;const _useLocation=Object(external_kbnSharedDeps_ReactRouterDom_["useLocation"])(),pathname=_useLocation.pathname;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const _syncQueryStateWithUr=Object(data_public_["syncQueryStateWithUrl"])(query,kbnUrlStateStorage),stop=_syncQueryStateWithUr.stop;return()=>stop()},[query,kbnUrlStateStorage,pathname]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:"".concat(visualize_constants["b"].EDIT_BY_VALUE_PATH)},external_kbnSharedDeps_React_default.a.createElement(VisualizeByValueEditor,{onAppLeave:onAppLeave})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:[visualize_constants["b"].CREATE_PATH,"".concat(visualize_constants["b"].EDIT_PATH,"/:id")]},external_kbnSharedDeps_React_default.a.createElement(VisualizeEditor,{onAppLeave:onAppLeave})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:[visualize_constants["b"].LANDING_PAGE_PATH,visualize_constants["b"].WIZARD_STEP_1_PAGE_PATH]},external_kbnSharedDeps_React_default.a.createElement(VisualizeListing,null)),external_kbnSharedDeps_React_default.a.createElement(VisualizeNoMatch,null))};const renderApp=({element:element,onAppLeave:onAppLeave},services)=>{addHelpMenuToAppChrome(services.chrome,services.docLinks);if(!services.visualizeCapabilities.save){addBadgeToAppChrome(services.chrome)}const app=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Router"],{history:services.history},external_kbnSharedDeps_React_default.a.createElement(public_["KibanaContextProvider"],{services:services},external_kbnSharedDeps_React_default.a.createElement(services.i18n.Context,null,external_kbnSharedDeps_React_default.a.createElement(VisualizeApp,{onAppLeave:onAppLeave}))));external_kbnSharedDeps_ReactDom_default.a.render(app,element);return()=>external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(element)}}])]);