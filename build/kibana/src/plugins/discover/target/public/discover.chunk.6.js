(window["discover_bundle_jsonpfunction"]=window["discover_bundle_jsonpfunction"]||[]).push([[6],{163:function(module,exports,__webpack_require__){__webpack_require__(164);module.exports="ngRoute"},164:function(module,exports){
/**
 * @license AngularJS v1.8.0
 * (c) 2010-2020 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window,angular){"use strict";function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;i<ii;i++){dst[i]=src[i]}}else if(isObject(src)){dst=dst||{};for(var key in src){if(!(key.charAt(0)==="$"&&key.charAt(1)==="$")){dst[key]=src[key]}}}return dst||src}function routeToRegExp(path,opts){var keys=[];var pattern=path.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[?*])?/g,(function(_,slash,key,option){var optional=option==="?"||option==="*?";var star=option==="*"||option==="*?";keys.push({name:key,optional:optional});slash=slash||"";return(optional?"(?:"+slash:slash+"(?:")+(star?"(.+?)":"([^/]+)")+(optional?"?)?":")")})).replace(/([/$*])/g,"\\$1");if(opts.ignoreTrailingSlashes){pattern=pattern.replace(/\/+$/,"")+"/*"}return{keys:keys,regexp:new RegExp("^"+pattern+"(?:[?#]|$)",opts.caseInsensitiveMatch?"i":"")}}var isArray;var isObject;var isDefined;var noop;var ngRouteModule=angular.module("ngRoute",[]).info({angularVersion:"1.8.0"}).provider("$route",$RouteProvider).run(instantiateRoute);var $routeMinErr=angular.$$minErr("ngRoute");var isEagerInstantiationEnabled;function $RouteProvider(){isArray=angular.isArray;isObject=angular.isObject;isDefined=angular.isDefined;noop=angular.noop;function inherit(parent,extra){return angular.extend(Object.create(parent),extra)}var routes={};this.when=function(path,route){var routeCopy=shallowCopy(route);if(angular.isUndefined(routeCopy.reloadOnUrl)){routeCopy.reloadOnUrl=true}if(angular.isUndefined(routeCopy.reloadOnSearch)){routeCopy.reloadOnSearch=true}if(angular.isUndefined(routeCopy.caseInsensitiveMatch)){routeCopy.caseInsensitiveMatch=this.caseInsensitiveMatch}routes[path]=angular.extend(routeCopy,{originalPath:path},path&&routeToRegExp(path,routeCopy));if(path){var redirectPath=path[path.length-1]==="/"?path.substr(0,path.length-1):path+"/";routes[redirectPath]=angular.extend({originalPath:path,redirectTo:path},routeToRegExp(redirectPath,routeCopy))}return this};this.caseInsensitiveMatch=false;this.otherwise=function(params){if(typeof params==="string"){params={redirectTo:params}}this.when(null,params);return this};isEagerInstantiationEnabled=true;this.eagerInstantiationEnabled=function eagerInstantiationEnabled(enabled){if(isDefined(enabled)){isEagerInstantiationEnabled=enabled;return this}return isEagerInstantiationEnabled};this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce","$browser",function($rootScope,$location,$routeParams,$q,$injector,$templateRequest,$sce,$browser){var forceReload=false,preparedRoute,preparedRouteIsUpdateOnly,$route={routes:routes,reload:function(){forceReload=true;var fakeLocationEvent={defaultPrevented:false,preventDefault:function fakePreventDefault(){this.defaultPrevented=true;forceReload=false}};$rootScope.$evalAsync((function(){prepareRoute(fakeLocationEvent);if(!fakeLocationEvent.defaultPrevented)commitRoute()}))},updateParams:function(newParams){if(this.current&&this.current.$$route){newParams=angular.extend({},this.current.params,newParams);$location.path(interpolate(this.current.$$route.originalPath,newParams));$location.search(newParams)}else{throw $routeMinErr("norout","Tried updating route with no current route")}}};$rootScope.$on("$locationChangeStart",prepareRoute);$rootScope.$on("$locationChangeSuccess",commitRoute);return $route;function switchRouteMatcher(on,route){var keys=route.keys,params={};if(!route.regexp)return null;var m=route.regexp.exec(on);if(!m)return null;for(var i=1,len=m.length;i<len;++i){var key=keys[i-1];var val=m[i];if(key&&val){params[key.name]=val}}return params}function prepareRoute($locationEvent){var lastRoute=$route.current;preparedRoute=parseRoute();preparedRouteIsUpdateOnly=isNavigationUpdateOnly(preparedRoute,lastRoute);if(!preparedRouteIsUpdateOnly&&(lastRoute||preparedRoute)){if($rootScope.$broadcast("$routeChangeStart",preparedRoute,lastRoute).defaultPrevented){if($locationEvent){$locationEvent.preventDefault()}}}}function commitRoute(){var lastRoute=$route.current;var nextRoute=preparedRoute;if(preparedRouteIsUpdateOnly){lastRoute.params=nextRoute.params;angular.copy(lastRoute.params,$routeParams);$rootScope.$broadcast("$routeUpdate",lastRoute)}else if(nextRoute||lastRoute){forceReload=false;$route.current=nextRoute;var nextRoutePromise=$q.resolve(nextRoute);$browser.$$incOutstandingRequestCount("$route");nextRoutePromise.then(getRedirectionData).then(handlePossibleRedirection).then((function(keepProcessingRoute){return keepProcessingRoute&&nextRoutePromise.then(resolveLocals).then((function(locals){if(nextRoute===$route.current){if(nextRoute){nextRoute.locals=locals;angular.copy(nextRoute.params,$routeParams)}$rootScope.$broadcast("$routeChangeSuccess",nextRoute,lastRoute)}}))})).catch((function(error){if(nextRoute===$route.current){$rootScope.$broadcast("$routeChangeError",nextRoute,lastRoute,error)}})).finally((function(){$browser.$$completeOutstandingRequest(noop,"$route")}))}}function getRedirectionData(route){var data={route:route,hasRedirection:false};if(route){if(route.redirectTo){if(angular.isString(route.redirectTo)){data.path=interpolate(route.redirectTo,route.params);data.search=route.params;data.hasRedirection=true}else{var oldPath=$location.path();var oldSearch=$location.search();var newUrl=route.redirectTo(route.pathParams,oldPath,oldSearch);if(angular.isDefined(newUrl)){data.url=newUrl;data.hasRedirection=true}}}else if(route.resolveRedirectTo){return $q.resolve($injector.invoke(route.resolveRedirectTo)).then((function(newUrl){if(angular.isDefined(newUrl)){data.url=newUrl;data.hasRedirection=true}return data}))}}return data}function handlePossibleRedirection(data){var keepProcessingRoute=true;if(data.route!==$route.current){keepProcessingRoute=false}else if(data.hasRedirection){var oldUrl=$location.url();var newUrl=data.url;if(newUrl){$location.url(newUrl).replace()}else{newUrl=$location.path(data.path).search(data.search).replace().url()}if(newUrl!==oldUrl){keepProcessingRoute=false}}return keepProcessingRoute}function resolveLocals(route){if(route){var locals=angular.extend({},route.resolve);angular.forEach(locals,(function(value,key){locals[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value,null,null,key)}));var template=getTemplateFor(route);if(angular.isDefined(template)){locals["$template"]=template}return $q.all(locals)}}function getTemplateFor(route){var template,templateUrl;if(angular.isDefined(template=route.template)){if(angular.isFunction(template)){template=template(route.params)}}else if(angular.isDefined(templateUrl=route.templateUrl)){if(angular.isFunction(templateUrl)){templateUrl=templateUrl(route.params)}if(angular.isDefined(templateUrl)){route.loadedTemplateUrl=$sce.valueOf(templateUrl);template=$templateRequest(templateUrl)}}return template}function parseRoute(){var params,match;angular.forEach(routes,(function(route,path){if(!match&&(params=switchRouteMatcher($location.path(),route))){match=inherit(route,{params:angular.extend({},$location.search(),params),pathParams:params});match.$$route=route}}));return match||routes[null]&&inherit(routes[null],{params:{},pathParams:{}})}function isNavigationUpdateOnly(newRoute,oldRoute){return!forceReload&&newRoute&&oldRoute&&newRoute.$$route===oldRoute.$$route&&(!newRoute.reloadOnUrl||!newRoute.reloadOnSearch&&angular.equals(newRoute.pathParams,oldRoute.pathParams))}function interpolate(string,params){var result=[];angular.forEach((string||"").split(":"),(function(segment,i){if(i===0){result.push(segment)}else{var segmentMatch=segment.match(/(\w+)(?:[?*])?(.*)/);var key=segmentMatch[1];result.push(params[key]);result.push(segmentMatch[2]||"");delete params[key]}}));return result.join("")}}]}instantiateRoute.$inject=["$injector"];function instantiateRoute($injector){if(isEagerInstantiationEnabled){$injector.get("$route")}}ngRouteModule.provider("$routeParams",$RouteParamsProvider);function $RouteParamsProvider(){this.$get=function(){return{}}}ngRouteModule.directive("ngView",ngViewFactory);ngRouteModule.directive("ngView",ngViewFillContentFactory);ngViewFactory.$inject=["$route","$anchorScroll","$animate"];function ngViewFactory($route,$anchorScroll,$animate){return{restrict:"ECA",terminal:true,priority:400,transclude:"element",link:function(scope,$element,attr,ctrl,$transclude){var currentScope,currentElement,previousLeaveAnimation,autoScrollExp=attr.autoscroll,onloadExp=attr.onload||"";scope.$on("$routeChangeSuccess",update);update();function cleanupLastView(){if(previousLeaveAnimation){$animate.cancel(previousLeaveAnimation);previousLeaveAnimation=null}if(currentScope){currentScope.$destroy();currentScope=null}if(currentElement){previousLeaveAnimation=$animate.leave(currentElement);previousLeaveAnimation.done((function(response){if(response!==false)previousLeaveAnimation=null}));currentElement=null}}function update(){var locals=$route.current&&$route.current.locals,template=locals&&locals.$template;if(angular.isDefined(template)){var newScope=scope.$new();var current=$route.current;var clone=$transclude(newScope,(function(clone){$animate.enter(clone,null,currentElement||$element).done((function onNgViewEnter(response){if(response!==false&&angular.isDefined(autoScrollExp)&&(!autoScrollExp||scope.$eval(autoScrollExp))){$anchorScroll()}}));cleanupLastView()}));currentElement=clone;currentScope=current.scope=newScope;currentScope.$emit("$viewContentLoaded");currentScope.$eval(onloadExp)}else{cleanupLastView()}}}}}ngViewFillContentFactory.$inject=["$compile","$controller","$route"];function ngViewFillContentFactory($compile,$controller,$route){return{restrict:"ECA",priority:-400,link:function(scope,$element){var current=$route.current,locals=current.locals;$element.html(locals.$template);var link=$compile($element.contents());if(current.controller){locals.$scope=scope;var controller=$controller(current.controller,locals);if(current.controllerAs){scope[current.controllerAs]=controller}$element.data("$ngControllerController",controller);$element.children().data("$ngControllerController",controller)}scope[current.resolveAs||"$resolve"]=locals;link(scope)}}}})(window,window.angular)},165:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var angular_sanitize=__webpack_require__(56);var angular_route=__webpack_require__(163);var external_kbnSharedDeps_Lodash_=__webpack_require__(11);var external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_);var external_kbnSharedDeps_Rxjs_=__webpack_require__(17);var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(14);var external_kbnSharedDeps_Moment_=__webpack_require__(35);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var elastic_datemath=__webpack_require__(62);var elastic_datemath_default=__webpack_require__.n(elastic_datemath);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var public_=__webpack_require__(5);var data_public_=__webpack_require__(4);function migrateLegacyQuery(query){if(!Object(external_kbnSharedDeps_Lodash_["has"])(query,"language")){return{query:query,language:"lucene"}}return query}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const APP_STATE_URL_KEY="_a";function getState({getStateDefaults:getStateDefaults,storeInSessionStorage:storeInSessionStorage=false,history:history,toasts:toasts}){const defaultAppState=getStateDefaults?getStateDefaults():{};const stateStorage=Object(public_["createKbnUrlStateStorage"])(_objectSpread({useHash:storeInSessionStorage,history:history},toasts&&Object(public_["withNotifyOnErrors"])(toasts)));const appStateFromUrl=stateStorage.get(APP_STATE_URL_KEY);if(appStateFromUrl&&appStateFromUrl.query&&!appStateFromUrl.query.language){appStateFromUrl.query=migrateLegacyQuery(appStateFromUrl.query)}let initialAppState=_objectSpread(_objectSpread({},defaultAppState),appStateFromUrl);let previousAppState;const appStateContainer=Object(public_["createStateContainer"])(initialAppState);const appStateContainerModified=_objectSpread(_objectSpread({},appStateContainer),{},{set:value=>{if(value){previousAppState=appStateContainer.getState();appStateContainer.set(value)}}});const _syncState=Object(public_["syncState"])({storageKey:APP_STATE_URL_KEY,stateContainer:appStateContainerModified,stateStorage:stateStorage}),start=_syncState.start,stop=_syncState.stop;return{kbnUrlStateStorage:stateStorage,appStateContainer:appStateContainerModified,startSync:start,stopSync:stop,setAppState:newPartial=>setState(appStateContainerModified,newPartial),replaceUrlAppState:function(){var _replaceUrlAppState=_asyncToGenerator(regeneratorRuntime.mark((function _callee(newPartial={}){var state;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:state=_objectSpread(_objectSpread({},appStateContainer.getState()),newPartial);_context.next=3;return stateStorage.set(APP_STATE_URL_KEY,state,{replace:true});case 3:case"end":return _context.stop()}}),_callee)})));function replaceUrlAppState(){return _replaceUrlAppState.apply(this,arguments)}return replaceUrlAppState}(),resetInitialAppState:()=>{initialAppState=appStateContainer.getState()},resetAppState:()=>{const defaultState=getStateDefaults?getStateDefaults():{};setState(appStateContainerModified,defaultState)},getPreviousAppState:()=>previousAppState,flushToUrl:()=>stateStorage.flush(),isAppStateDirty:()=>!isEqualState(initialAppState,appStateContainer.getState())}}function setState(stateContainer,newState){const oldState=stateContainer.getState();const mergedState=_objectSpread(_objectSpread({},oldState),newState);if(!isEqualState(oldState,mergedState)){stateContainer.set(mergedState)}}function isEqualFilters(filtersA,filtersB){if(!filtersA&&!filtersB){return true}else if(!filtersA||!filtersB){return false}return data_public_["esFilters"].compareFilters(filtersA,filtersB,data_public_["esFilters"].COMPARE_ALL_OPTIONS)}function splitState(state={}){const _state$filters=state.filters,filters=_state$filters===void 0?[]:_state$filters,statePartial=_objectWithoutProperties(state,["filters"]);return{filters:filters,state:statePartial}}function isEqualState(stateA,stateB){if(!stateA&&!stateB){return true}else if(!stateA||!stateB){return false}const _stateA$filters=stateA.filters,stateAFilters=_stateA$filters===void 0?[]:_stateA$filters,stateAPartial=_objectWithoutProperties(stateA,["filters"]);const _stateB$filters=stateB.filters,stateBFilters=_stateB$filters===void 0?[]:_stateB$filters,stateBPartial=_objectWithoutProperties(stateB,["filters"]);return Object(external_kbnSharedDeps_Lodash_["isEqual"])(stateAPartial,stateBPartial)&&isEqualFilters(stateAFilters,stateBFilters)}var inspector_public_=__webpack_require__(39);var doc_table=__webpack_require__(49);var external_kbnSharedDeps_Jquery_=__webpack_require__(36);var external_kbnSharedDeps_Jquery_default=__webpack_require__.n(external_kbnSharedDeps_Jquery_);function createDebounceProviderTimeout($timeout){return function(func,wait,options){let timeout;let args;let self;let result;options=external_kbnSharedDeps_Lodash_default.a.defaults(options||{},{leading:false,trailing:true,invokeApply:true});function debounce(){self=this;args=arguments;const later=function later(){timeout=null;if(!options.leading||options.trailing){result=func.apply(self,args)}};const callNow=options.leading&&!timeout;if(timeout){$timeout.cancel(timeout)}timeout=$timeout(later,wait,options.invokeApply);if(callNow){result=func.apply(self,args)}return result}debounce.cancel=function(){$timeout.cancel(timeout);timeout=null};return debounce}}const SCROLLER_HEIGHT=20;function FixedScrollProvider($timeout){return{restrict:"A",link:function link($scope,$el){return createFixedScroll($scope,$timeout)($el)}}}function createFixedScroll($scope,$timeout){const debounce=createDebounceProviderTimeout($timeout);return function(el){const $el=typeof el.css==="function"?el:external_kbnSharedDeps_Jquery_default()(el);let $window=external_kbnSharedDeps_Jquery_default()(window);let $scroller=external_kbnSharedDeps_Jquery_default()('<div class="dscTableFixedScroll__scroller">').height(SCROLLER_HEIGHT);let unlisten=external_kbnSharedDeps_Lodash_default.a.noop;function listen(){if(unlisten!==external_kbnSharedDeps_Lodash_default.a.noop){throw new Error("fixedScroll listeners were not cleaned up properly before re-listening!")}let blockTo;function bind($from,$to){function handler(){if(blockTo===$to)return blockTo=null;$to.scrollLeft((blockTo=$from).scrollLeft())}$from.on("scroll",handler);return function(){$from.off("scroll",handler)}}unlisten=external_kbnSharedDeps_Lodash_default.a.flow(bind($el,$scroller),bind($scroller,$el),(function(){unlisten=external_kbnSharedDeps_Lodash_default.a.noop}))}function cleanUp(){unlisten();$scroller.detach();$el.css("padding-bottom",0)}function setup(){cleanUp();const containerWidth=$el.width();const contentWidth=$el.prop("scrollWidth");const containerHorizOverflow=contentWidth-containerWidth;const elTop=$el.offset().top-$window.scrollTop();const elBottom=elTop+$el.height();const windowVertOverflow=elBottom-$window.height();const requireScroller=containerHorizOverflow>0&&windowVertOverflow>0;if(!requireScroller)return;$el.css("padding-bottom",SCROLLER_HEIGHT);$scroller.width(containerWidth).html(external_kbnSharedDeps_Jquery_default()("<div>").css({width:contentWidth,height:SCROLLER_HEIGHT})).insertAfter($el);listen()}let width;let scrollWidth;function checkWidth(){const newScrollWidth=$el.prop("scrollWidth");const newWidth=$el.width();if(scrollWidth!==newScrollWidth||width!==newWidth){$scope.$apply(setup);scrollWidth=newScrollWidth;width=newWidth}}const debouncedCheckWidth=debounce(checkWidth,100,{invokeApply:false});$scope.$watch(debouncedCheckWidth);function destroy(){cleanUp();debouncedCheckWidth.cancel();$scroller=$window=null}return destroy}}var actions_columns=__webpack_require__(54);var discover_legacy='<discover-app>\n  <discover-legacy\n    add-column="addColumn"\n    fetch="fetch"\n    fetch-counter="fetchCounter"\n    fetch-error="fetchError"\n    field-counts="fieldCounts"\n    histogram-data="histogramData"\n    hits="hits"\n    index-pattern="indexPattern"\n    minimum-visible-rows="minimumVisibleRows"\n    on-add-filter="filterQuery"\n    on-move-column="moveColumn"\n    on-change-interval="changeInterval"\n    on-remove-column="removeColumn"\n    on-set-columns="setColumns"\n    on-skip-bottom-button-click="onSkipBottomButtonClick"\n    on-sort="setSortOrder"\n    opts="opts"\n    reset-query="resetQuery"\n    result-state="resultState"\n    rows="rows"\n    saved-search="savedSearch"\n    search-source="searchSource"\n    set-index-pattern="setIndexPattern"\n    show-save-query="showSaveQuery"\n    state="state"\n    time-filter-update-handler="timefilterUpdateHandler"\n    time-range="timeRange"\n    top-nav-menu="topNavMenu"\n    update-query="handleRefresh"\n    update-saved-query-id="updateSavedQueryId"\n  >\n  </discover-legacy>\n</discover-app>\n';var kibana_services=__webpack_require__(3);const help_menu_util_getServices=Object(kibana_services["h"])(),docLinks=help_menu_util_getServices.docLinks;function addHelpMenuToAppChrome(chrome){chrome.setHelpExtension({appName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.helpMenu.appName",{defaultMessage:"Discover"}),links:[{linkType:"documentation",href:"".concat(docLinks.ELASTIC_WEBSITE_URL,"guide/en/kibana/").concat(docLinks.DOC_LINK_VERSION,"/discover.html")}]})}const buildPointSeriesData=(table,dimensions)=>{const x=dimensions.x,y=dimensions.y;const xAccessor=table.columns[x.accessor].id;const yAccessor=table.columns[y.accessor].id;const chart={};chart.xAxisOrderedValues=Object(external_kbnSharedDeps_Lodash_["uniq"])(table.rows.map(r=>r[xAccessor]));chart.xAxisFormat=x.format;chart.xAxisLabel=table.columns[x.accessor].name;const _x$params=x.params,intervalESUnit=_x$params.intervalESUnit,intervalESValue=_x$params.intervalESValue,interval=_x$params.interval,bounds=_x$params.bounds;chart.ordered={date:true,interval:interval,intervalESUnit:intervalESUnit,intervalESValue:intervalESValue,min:bounds.min,max:bounds.max};chart.yAxisLabel=table.columns[y.accessor].name;chart.values=table.rows.filter(row=>row&&row[yAccessor]!=="NaN").map(row=>({x:row[xAccessor],y:row[yAccessor]}));return chart};function tableResponseHandler(table,dimensions){const converted={tables:[]};const split=dimensions.splitColumn||dimensions.splitRow;if(split){converted.direction=dimensions.splitRow?"row":"column";const splitColumnIndex=split[0].accessor;const splitColumnFormatter=Object(kibana_services["h"])().data.fieldFormats.deserialize(split[0].format);const splitColumn=table.columns[splitColumnIndex];const splitMap={};let splitIndex=0;table.rows.forEach((row,rowIndex)=>{const splitValue=row[splitColumn.id];if(!splitMap.hasOwnProperty(splitValue)){splitMap[splitValue]=splitIndex++;const tableGroup={$parent:converted,title:"".concat(splitColumnFormatter.convert(splitValue),": ").concat(splitColumn.name),name:splitColumn.name,key:splitValue,column:splitColumnIndex,row:rowIndex,table:table,tables:[]};tableGroup.tables.push({$parent:tableGroup,columns:table.columns,rows:[]});converted.tables.push(tableGroup)}const tableIndex=splitMap[splitValue];converted.tables[tableIndex].tables[0].rows.push(row)})}else{converted.tables.push({columns:table.columns,rows:table.rows})}return converted}function convertTableGroup(tableGroup,convertTable){const tables=tableGroup.tables;if(!tables.length)return;const firstChild=tables[0];if(firstChild.columns){const chart=convertTable(firstChild);if(tableGroup.$parent){chart.label=tableGroup.title}return chart}const out={};let outList;tables.forEach((function(table){if(!outList){const direction=tableGroup.direction==="row"?"rows":"columns";outList=out[direction]=[]}let output;if(output=convertTableGroup(table,convertTable)){outList.push(output)}}));return out}const discoverResponseHandler=(response,dimensions)=>{const tableGroup=tableResponseHandler(response,dimensions);let converted=convertTableGroup(tableGroup,table=>buildPointSeriesData(table,dimensions));if(!converted){converted={rows:[]}}converted.hits=response.rows.length;return converted};function getRootBreadcrumbs(){return[{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.rootBreadcrumb",{defaultMessage:"Discover"}),href:"#/"}]}function getSavedSearchBreadcrumbs($route){return[...getRootBreadcrumbs(),{text:$route.current.locals.savedObjects.savedSearch.id}]}function setBreadcrumbsTitle(savedSearch,chrome){const discoverBreadcrumbsTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.discoverBreadcrumbTitle",{defaultMessage:"Discover"});if(savedSearch.id&&savedSearch.title){chrome.setBreadcrumbs([{text:discoverBreadcrumbsTitle,href:"#/"},{text:savedSearch.title}])}else{chrome.setBreadcrumbs([{text:discoverBreadcrumbsTitle}])}}function validateTimeRange({from:from,to:to},toastNotifications){const fromMoment=elastic_datemath_default.a.parse(from);const toMoment=elastic_datemath_default.a.parse(to);if(!fromMoment||!toMoment||!fromMoment.isValid()||!toMoment.isValid()){toastNotifications.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.notifications.invalidTimeRangeTitle",{defaultMessage:"Invalid time range"}),text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.notifications.invalidTimeRangeText",{defaultMessage:"The provided time range is invalid. (from: '{from}', to: '{to}')",values:{from:from,to:to}})});return false}return true}var popularize_field=__webpack_require__(59);function getSwitchIndexPatternAppState(currentIndexPattern,nextIndexPattern,currentColumns,currentSort,modifyColumns=true){const nextColumns=modifyColumns?currentColumns.filter(column=>nextIndexPattern.fields.getByName(column)||!currentIndexPattern.fields.getByName(column)):currentColumns;const nextSort=Object(doc_table["b"])(currentSort,nextIndexPattern);return{index:nextIndexPattern.id,columns:nextColumns.length?nextColumns:["_source"],sort:nextSort}}var kibanaLegacy_public_=__webpack_require__(7);var web=__webpack_require__(64);var url_generator=__webpack_require__(10);var common=__webpack_require__(47);function resolve_index_pattern_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function resolve_index_pattern_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){resolve_index_pattern_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){resolve_index_pattern_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function findIndexPatternById(indexPatterns,id){if(!Array.isArray(indexPatterns)||!id){return}return indexPatterns.find(o=>o.id===id)}function getFallbackIndexPatternId(indexPatterns,defaultIndex=""){var _indexPatterns$;if(defaultIndex&&findIndexPatternById(indexPatterns,defaultIndex)){return defaultIndex}return indexPatterns&&((_indexPatterns$=indexPatterns[0])===null||_indexPatterns$===void 0?void 0:_indexPatterns$.id)?indexPatterns[0].id:""}function getIndexPatternId(id="",indexPatterns=[],defaultIndex=""){if(!id||!findIndexPatternById(indexPatterns,id)){return getFallbackIndexPatternId(indexPatterns,defaultIndex)}return id}function loadIndexPattern(_x,_x2,_x3){return _loadIndexPattern.apply(this,arguments)}function _loadIndexPattern(){_loadIndexPattern=resolve_index_pattern_asyncToGenerator(regeneratorRuntime.mark((function _callee(id,indexPatterns,config){var indexPatternList,actualId;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return indexPatterns.getCache();case 2:indexPatternList=_context.sent;actualId=getIndexPatternId(id,indexPatternList,config.get("defaultIndex"));_context.t0=indexPatternList||[];_context.next=7;return indexPatterns.get(actualId);case 7:_context.t1=_context.sent;_context.t2=id;_context.t3=!!id&&actualId===id;return _context.abrupt("return",{list:_context.t0,loaded:_context.t1,stateVal:_context.t2,stateValFound:_context.t3});case 11:case"end":return _context.stop()}}),_callee)})));return _loadIndexPattern.apply(this,arguments)}function resolveIndexPattern(ip,searchSource,toastNotifications){const loadedIndexPattern=ip.loaded,stateVal=ip.stateVal,stateValFound=ip.stateValFound;const ownIndexPattern=searchSource.getOwnField("index");if(ownIndexPattern&&!stateVal){return ownIndexPattern}if(stateVal&&!stateValFound){const warningTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.valueIsNotConfiguredIndexPatternIDWarningTitle",{defaultMessage:"{stateVal} is not a configured index pattern ID",values:{stateVal:'"'.concat(stateVal,'"')}});if(ownIndexPattern){toastNotifications.addWarning({title:warningTitle,text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.showingSavedIndexPatternWarningDescription",{defaultMessage:'Showing the saved index pattern: "{ownIndexPatternTitle}" ({ownIndexPatternId})',values:{ownIndexPatternTitle:ownIndexPattern.title,ownIndexPatternId:ownIndexPattern.id}})});return ownIndexPattern}toastNotifications.addWarning({title:warningTitle,text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.showingDefaultIndexPatternWarningDescription",{defaultMessage:'Showing the default index pattern: "{loadedIndexPatternTitle}" ({loadedIndexPatternId})',values:{loadedIndexPatternTitle:loadedIndexPattern.title,loadedIndexPatternId:loadedIndexPattern.id}})})}return loadedIndexPattern}var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(18);var external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_);var rison=__webpack_require__(60);var rison_default=__webpack_require__.n(rison);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(6);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var savedObjects_public_=__webpack_require__(20);const SEARCH_OBJECT_TYPE="search";function OpenSearchPanel(props){const _getServices=Object(kibana_services["h"])(),_getServices$core=_getServices.core,uiSettings=_getServices$core.uiSettings,savedObjects=_getServices$core.savedObjects,addBasePath=_getServices.addBasePath;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyout"],{ownFocus:true,onClose:props.onClose,"data-test-subj":"loadSearchForm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.topNav.openSearchPanel.openSearchTitle",defaultMessage:"Open search"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutBody"],null,external_kbnSharedDeps_React_default.a.createElement(savedObjects_public_["SavedObjectFinderUi"],{noItemsMessage:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.topNav.openSearchPanel.noSearchesFoundDescription",defaultMessage:"No matching searches found."}),savedObjectMetaData:[{type:SEARCH_OBJECT_TYPE,getIconForSavedObject:()=>"search",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.savedSearch.savedObjectName",{defaultMessage:"Saved search"})}],onChoose:id=>{window.location.assign(props.makeUrl(id));props.onClose()},uiSettings:uiSettings,savedObjects:savedObjects})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,onClick:props.onClose,href:addBasePath("/app/management/kibana/objects?_a=".concat(rison_default.a.encode({tab:SEARCH_OBJECT_TYPE})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.topNav.openSearchPanel.manageSearchesButtonLabel",defaultMessage:"Manage searches"}))))))}let isOpen=false;function showOpenSearchPanel({makeUrl:makeUrl,I18nContext:I18nContext}){if(isOpen){return}isOpen=true;const container=document.createElement("div");const onClose=()=>{external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(container);document.body.removeChild(container);isOpen=false};document.body.appendChild(container);const element=external_kbnSharedDeps_React_default.a.createElement(I18nContext,null,external_kbnSharedDeps_React_default.a.createElement(OpenSearchPanel,{onClose:onClose,makeUrl:makeUrl}));external_kbnSharedDeps_ReactDom_default.a.render(element,container)}function get_sharing_data_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function get_sharing_data_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){get_sharing_data_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){get_sharing_data_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const getSharingDataFields=function(){var _ref=get_sharing_data_asyncToGenerator(regeneratorRuntime.mark((function _callee(getFieldCounts,selectedFields,timeFieldName,hideTimeColumn){var fieldCounts,fields;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(selectedFields.length===1&&selectedFields[0]==="_source")){_context.next=5;break}_context.next=3;return getFieldCounts();case 3:fieldCounts=_context.sent;return _context.abrupt("return",{searchFields:undefined,selectFields:Object.keys(fieldCounts).sort()});case 5:fields=timeFieldName&&!hideTimeColumn?[timeFieldName,...selectedFields]:selectedFields;return _context.abrupt("return",{searchFields:fields,selectFields:fields});case 7:case"end":return _context.stop()}}),_callee)})));return function getSharingDataFields(_x,_x2,_x3,_x4){return _ref.apply(this,arguments)}}();function getSharingData(_x5,_x6,_x7,_x8){return _getSharingData.apply(this,arguments)}function _getSharingData(){_getSharingData=get_sharing_data_asyncToGenerator(regeneratorRuntime.mark((function _callee2(currentSearchSource,state,config,getFieldCounts){var searchSource,index,_yield$getSharingData,searchFields,selectFields,body;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:searchSource=currentSearchSource.createCopy();index=searchSource.getField("index");_context2.next=4;return getSharingDataFields(getFieldCounts,state.columns||[],index.timeFieldName||"",config.get(common["e"]));case 4:_yield$getSharingData=_context2.sent;searchFields=_yield$getSharingData.searchFields;selectFields=_yield$getSharingData.selectFields;searchSource.setField("fields",searchFields);searchSource.setField("sort",Object(doc_table["c"])(state.sort,index,config.get(common["j"])));searchSource.removeField("highlight");searchSource.removeField("highlightAll");searchSource.removeField("aggs");searchSource.removeField("size");_context2.next=15;return searchSource.getSearchRequestBody();case 15:body=_context2.sent;return _context2.abrupt("return",{searchRequest:{index:index.title,body:body},fields:selectFields,metaFields:index.metaFields,conflictedTypesFields:index.fields.filter(f=>f.type==="conflict").map(f=>f.name),indexPatternId:index.id});case 17:case"end":return _context2.stop()}}),_callee2)})));return _getSharingData.apply(this,arguments)}function updateSearchSource(searchSource,{indexPattern:indexPattern,services:services,sort:sort}){const uiSettings=services.uiSettings,data=services.data;const usedSort=Object(doc_table["c"])(sort,indexPattern,uiSettings.get(common["j"]));searchSource.setField("index",indexPattern).setField("size",uiSettings.get(common["h"])).setField("sort",usedSort).setField("query",data.query.queryString.getQuery()||null).setField("filter",data.query.filterManager.getFilters());return searchSource}function persist_saved_search_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function persist_saved_search_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){persist_saved_search_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){persist_saved_search_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function persistSavedSearch(_x,_x2){return _persistSavedSearch.apply(this,arguments)}function _persistSavedSearch(){_persistSavedSearch=persist_saved_search_asyncToGenerator(regeneratorRuntime.mark((function _callee(savedSearch,{indexPattern:indexPattern,onError:onError,onSuccess:onSuccess,services:services,saveOptions:saveOptions,state:state}){var id;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:updateSearchSource(savedSearch.searchSource,{indexPattern:indexPattern,services:services,sort:state.sort});savedSearch.columns=state.columns||[];savedSearch.sort=state.sort||[];_context.prev=3;_context.next=6;return savedSearch.save(saveOptions);case 6:id=_context.sent;onSuccess(id);return _context.abrupt("return",{id:id});case 11:_context.prev=11;_context.t0=_context["catch"](3);onError(_context.t0,savedSearch);return _context.abrupt("return",{error:_context.t0});case 15:case"end":return _context.stop()}}),_callee,null,[[3,11]])})));return _persistSavedSearch.apply(this,arguments)}function on_save_search_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function on_save_search_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){on_save_search_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){on_save_search_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function saveDataSource(_x){return _saveDataSource.apply(this,arguments)}function _saveDataSource(){_saveDataSource=on_save_search_asyncToGenerator(regeneratorRuntime.mark((function _callee({indexPattern:indexPattern,navigateTo:navigateTo,savedSearch:savedSearch,saveOptions:saveOptions,services:services,state:state}){var prevSavedSearchId,onSuccess,onError;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:onError=function _onError(error){services.toastNotifications.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.notifications.notSavedSearchTitle",{defaultMessage:"Search '{savedSearchTitle}' was not saved.",values:{savedSearchTitle:savedSearch.title}}),text:error.message})};onSuccess=function _onSuccess(id){if(id){services.toastNotifications.addSuccess({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.notifications.savedSearchTitle",{defaultMessage:"Search '{savedSearchTitle}' was saved",values:{savedSearchTitle:savedSearch.title}}),"data-test-subj":"saveSearchSuccess"});if(savedSearch.id!==prevSavedSearchId){navigateTo("/view/".concat(encodeURIComponent(savedSearch.id)))}else{state.resetAppState();services.chrome.docTitle.change(savedSearch.lastSavedTitle);setBreadcrumbsTitle(savedSearch,services.chrome)}}};prevSavedSearchId=savedSearch.id;return _context.abrupt("return",persistSavedSearch(savedSearch,{indexPattern:indexPattern,onError:onError,onSuccess:onSuccess,saveOptions:saveOptions,services:services,state:state.appStateContainer.getState()}));case 4:case"end":return _context.stop()}}),_callee)})));return _saveDataSource.apply(this,arguments)}function onSaveSearch(_x2){return _onSaveSearch.apply(this,arguments)}function _onSaveSearch(){_onSaveSearch=on_save_search_asyncToGenerator(regeneratorRuntime.mark((function _callee3({indexPattern:indexPattern,navigateTo:navigateTo,savedSearch:savedSearch,services:services,state:state}){var onSave,saveModal;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:onSave=function(){var _ref=on_save_search_asyncToGenerator(regeneratorRuntime.mark((function _callee2({newTitle:newTitle,newCopyOnSave:newCopyOnSave,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate}){var currentTitle,saveOptions,response;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:currentTitle=savedSearch.title;savedSearch.title=newTitle;savedSearch.copyOnSave=newCopyOnSave;saveOptions={confirmOverwrite:false,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate};_context2.next=6;return saveDataSource({indexPattern:indexPattern,saveOptions:saveOptions,services:services,navigateTo:navigateTo,savedSearch:savedSearch,state:state});case 6:response=_context2.sent;if(!response.id||response.error){savedSearch.title=currentTitle}else{state.resetInitialAppState()}return _context2.abrupt("return",response);case 9:case"end":return _context2.stop()}}),_callee2)})));return function onSave(_x3){return _ref.apply(this,arguments)}}();saveModal=external_kbnSharedDeps_React_default.a.createElement(savedObjects_public_["SavedObjectSaveModal"],{onSave:onSave,onClose:()=>{},title:savedSearch.title,showCopyOnSave:!!savedSearch.id,objectType:"search",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.saveSaveSearchDescription",{defaultMessage:"Save your Discover search so you can use it in visualizations and dashboards"}),showDescription:false});Object(savedObjects_public_["showSaveModal"])(saveModal,services.core.i18n.Context);case 3:case"end":return _context3.stop()}}),_callee3)})));return _onSaveSearch.apply(this,arguments)}function get_top_nav_links_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function get_top_nav_links_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){get_top_nav_links_ownKeys(Object(source),true).forEach((function(key){get_top_nav_links_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{get_top_nav_links_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function get_top_nav_links_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function get_top_nav_links_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function get_top_nav_links_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){get_top_nav_links_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){get_top_nav_links_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const getTopNavLinks=({getFieldCounts:getFieldCounts,indexPattern:indexPattern,inspectorAdapters:inspectorAdapters,navigateTo:navigateTo,savedSearch:savedSearch,services:services,state:state})=>{const newSearch={id:"new",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.localMenu.newSearchTitle",{defaultMessage:"New"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.newSearchDescription",{defaultMessage:"New Search"}),run:()=>navigateTo("/"),testId:"discoverNewButton"};const saveSearch={id:"save",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.saveTitle",{defaultMessage:"Save"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.saveSearchDescription",{defaultMessage:"Save Search"}),testId:"discoverSaveButton",run:()=>onSaveSearch({savedSearch:savedSearch,services:services,indexPattern:indexPattern,navigateTo:navigateTo,state:state})};const openSearch={id:"open",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.openTitle",{defaultMessage:"Open"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.openSavedSearchDescription",{defaultMessage:"Open Saved Search"}),testId:"discoverOpenButton",run:()=>showOpenSearchPanel({makeUrl:searchId=>"#/view/".concat(encodeURIComponent(searchId)),I18nContext:services.core.i18n.Context})};const shareSearch={id:"share",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.shareTitle",{defaultMessage:"Share"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.shareSearchDescription",{defaultMessage:"Share Search"}),testId:"shareTopNavButton",run:function(){var _run=get_top_nav_links_asyncToGenerator(regeneratorRuntime.mark((function _callee(anchorElement){var sharingData;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(services.share){_context.next=2;break}return _context.abrupt("return");case 2:_context.next=4;return getSharingData(savedSearch.searchSource,state.appStateContainer.getState(),services.uiSettings,getFieldCounts);case 4:sharingData=_context.sent;services.share.toggleShareContextMenu({anchorElement:anchorElement,allowEmbed:false,allowShortUrl:!!services.capabilities.discover.createShortUrl,shareableUrl:Object(public_["unhashUrl"])(window.location.href),objectId:savedSearch.id,objectType:"search",sharingData:get_top_nav_links_objectSpread(get_top_nav_links_objectSpread({},sharingData),{},{title:savedSearch.title}),isDirty:!savedSearch.id||state.isAppStateDirty()});case 6:case"end":return _context.stop()}}),_callee)})));function run(_x){return _run.apply(this,arguments)}return run}()};const inspectSearch={id:"inspect",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.inspectTitle",{defaultMessage:"Inspect"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.localMenu.openInspectorForSearchDescription",{defaultMessage:"Open Inspector for search"}),testId:"openInspectorButton",run:()=>{services.inspector.open(inspectorAdapters,{title:savedSearch.title})}};return[newSearch,...services.capabilities.discover.save?[saveSearch]:[],openSearch,shareSearch,inspectSearch]};function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function calcFieldCounts(counts={},rows,indexPattern){var _iterator=_createForOfIteratorHelper(rows),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){const hit=_step.value;const fields=Object.keys(indexPattern.flattenHit(hit));for(var _i=0,_fields=fields;_i<_fields.length;_i++){const fieldName=_fields[_i];counts[fieldName]=(counts[fieldName]||0)+1}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return counts}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||discover_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function discover_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return discover_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return discover_arrayLikeToArray(o,minLen)}function discover_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function discover_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function discover_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){discover_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){discover_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function discover_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function discover_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){discover_ownKeys(Object(source),true).forEach((function(key){discover_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{discover_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function discover_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const discover_services=Object(kibana_services["h"])();const core=discover_services.core,discover_chrome=discover_services.chrome,discover_data=discover_services.data,getHistory=discover_services.history,discover_indexPatterns=discover_services.indexPatterns,discover_filterManager=discover_services.filterManager,timefilter=discover_services.timefilter,discover_toastNotifications=discover_services.toastNotifications,discover_config=discover_services.uiSettings,trackUiMetric=discover_services.trackUiMetric;const fetchStatuses={UNINITIALIZED:"uninitialized",LOADING:"loading",COMPLETE:"complete",ERROR:"error"};const getSearchSessionIdFromURL=history=>Object(public_["getQueryParams"])(history.location)[url_generator["d"]];const app=Object(kibana_services["a"])();app.config($routeProvider=>{const defaults={requireDefaultIndex:true,requireUICapability:"discover.show",k7Breadcrumbs:($route,$injector)=>$injector.invoke($route.current.params.id?getSavedSearchBreadcrumbs:getRootBreadcrumbs),badge:uiCapabilities=>{if(uiCapabilities.discover.save){return undefined}return{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.badge.readOnly.tooltip",{defaultMessage:"Unable to save searches"}),iconType:"glasses"}}};const discoverRoute=discover_objectSpread(discover_objectSpread({},defaults),{},{template:discover_legacy,reloadOnSearch:false,resolve:{savedObjects:function savedObjects($route,Promise){const history=getHistory();const savedSearchId=$route.current.params.id;return discover_data.indexPatterns.ensureDefaultIndexPattern(history).then(()=>{const _getState=getState({history:history}),appStateContainer=_getState.appStateContainer;const _appStateContainer$ge=appStateContainer.getState(),index=_appStateContainer$ge.index;return Promise.props({ip:loadIndexPattern(index,discover_data.indexPatterns,discover_config),savedSearch:Object(kibana_services["h"])().getSavedSearchById(savedSearchId).then(savedSearch=>{if(savedSearchId){discover_chrome.recentlyAccessed.add(savedSearch.getFullPath(),savedSearch.title,savedSearchId)}return savedSearch}).catch(Object(kibana_services["k"])({history:history,navigateToApp:core.application.navigateToApp,mapping:{search:"/","index-pattern":{app:"management",path:"kibana/objects/savedSearches/".concat($route.current.params.id)}},toastNotifications:discover_toastNotifications,onBeforeRedirect(){Object(kibana_services["j"])().setTrackedUrl("/")}}))})})}}});$routeProvider.when("/view/:id?",discoverRoute);$routeProvider.when("/",discoverRoute)});app.directive("discoverApp",(function(){return{restrict:"E",controllerAs:"discoverApp",controller:discoverController}}));function discoverController($element,$route,$scope,$timeout,$window,Promise,uiCapabilities){const isDefaultType=data_public_["indexPatterns"].isDefault;const subscriptions=new external_kbnSharedDeps_Rxjs_["Subscription"];const refetch$=new external_kbnSharedDeps_Rxjs_["Subject"];let inspectorRequest;const savedSearch=$route.current.locals.savedObjects.savedSearch;$scope.searchSource=savedSearch.searchSource;$scope.indexPattern=resolveIndexPattern($route.current.locals.savedObjects.ip,$scope.searchSource,discover_toastNotifications);$scope.fetchCounter=0;const getTimeField=()=>isDefaultType($scope.indexPattern)?$scope.indexPattern.timeFieldName:undefined;const history=getHistory();let isInitialSearch=true;const state=getState({getStateDefaults:getStateDefaults,storeInSessionStorage:discover_config.get("state:storeInSessionStorage"),history:history,toasts:core.notifications.toasts});const appStateContainer=state.appStateContainer,startStateSync=state.startSync,stopStateSync=state.stopSync,setAppState=state.setAppState,replaceUrlAppState=state.replaceUrlAppState,kbnUrlStateStorage=state.kbnUrlStateStorage,getPreviousAppState=state.getPreviousAppState;if(appStateContainer.getState().index!==$scope.indexPattern.id){setAppState({index:$scope.indexPattern.id})}$scope.state=discover_objectSpread({},appStateContainer.getState());const _syncQueryStateWithUr=Object(data_public_["syncQueryStateWithUrl"])(discover_data.query,kbnUrlStateStorage),stopSyncingGlobalStateWithUrl=_syncQueryStateWithUr.stop;discover_filterManager.setAppFilters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(appStateContainer.getState().filters));discover_data.query.queryString.setQuery(appStateContainer.getState().query);const stopSyncingQueryAppStateWithStateContainer=Object(data_public_["connectToQueryState"])(discover_data.query,appStateContainer,{filters:data_public_["esFilters"].FilterStateStore.APP_STATE,query:true});const appStateUnsubscribe=appStateContainer.subscribe(function(){var _ref=discover_asyncToGenerator(regeneratorRuntime.mark((function _callee2(newState){var _splitState,newStatePartial,_splitState2,oldStatePartial;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_splitState=splitState(newState),newStatePartial=_splitState.state;_splitState2=splitState(getPreviousAppState()),oldStatePartial=_splitState2.state;if(!external_kbnSharedDeps_Lodash_default.a.isEqual(newStatePartial,oldStatePartial)){$scope.$evalAsync(discover_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var changes;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(oldStatePartial.index!==newStatePartial.index)){_context.next=2;break}return _context.abrupt("return");case 2:$scope.state=discover_objectSpread({},newState);changes=["interval","sort"].filter(prop=>!external_kbnSharedDeps_Lodash_default.a.isEqual(newStatePartial[prop],oldStatePartial[prop]));if(changes.length){refetch$.next()}case 5:case"end":return _context.stop()}}),_callee)}))))}case 3:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref.apply(this,arguments)}}());const unlistenHistoryBasePath=history.listen(({pathname:pathname,search:search,hash:hash})=>{if(!search&&!hash&&pathname==="/"){$route.reload()}});$scope.setIndexPattern=function(){var _ref3=discover_asyncToGenerator(regeneratorRuntime.mark((function _callee3(id){var nextIndexPattern,nextAppState;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return discover_indexPatterns.get(id);case 2:nextIndexPattern=_context3.sent;if(!nextIndexPattern){_context3.next=8;break}nextAppState=getSwitchIndexPatternAppState($scope.indexPattern,nextIndexPattern,$scope.state.columns,$scope.state.sort,discover_config.get(common["g"]));_context3.next=7;return replaceUrlAppState(nextAppState);case 7:$route.reload();case 8:case"end":return _context3.stop()}}),_callee3)})));return function(_x2){return _ref3.apply(this,arguments)}}();subscriptions.add(Object(kibana_services["s"])($scope,discover_filterManager.getUpdates$(),{next:()=>{$scope.state.filters=discover_filterManager.getAppFilters();$scope.updateDataSource()}},error=>Object(kibanaLegacy_public_["addFatalError"])(core.fatalErrors,error)));const inspectorAdapters={requests:new inspector_public_["RequestAdapter"]};$scope.timefilterUpdateHandler=ranges=>{timefilter.setTime({from:external_kbnSharedDeps_Moment_default()(ranges.from).toISOString(),to:external_kbnSharedDeps_Moment_default()(ranges.to).toISOString(),mode:"absolute"})};$scope.minimumVisibleRows=50;$scope.fetchStatus=fetchStatuses.UNINITIALIZED;$scope.showSaveQuery=uiCapabilities.discover.saveQuery;let abortController;$scope.$on("$destroy",()=>{if(abortController)abortController.abort();savedSearch.destroy();subscriptions.unsubscribe();discover_data.search.session.clear();appStateUnsubscribe();stopStateSync();stopSyncingGlobalStateWithUrl();stopSyncingQueryAppStateWithStateContainer();unlistenHistoryBasePath()});const getFieldCounts=function(){var _ref4=discover_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(!($scope.fetchStatus===fetchStatuses.COMPLETE)){_context4.next=2;break}return _context4.abrupt("return",$scope.fieldCounts);case 2:_context4.next=4;return new Promise(resolve=>{const unwatch=$scope.$watch("fetchStatus",newValue=>{if(newValue===fetchStatuses.COMPLETE){unwatch();resolve($scope.fieldCounts)}})});case 4:return _context4.abrupt("return",_context4.sent);case 5:case"end":return _context4.stop()}}),_callee4)})));return function getFieldCounts(){return _ref4.apply(this,arguments)}}();$scope.topNavMenu=getTopNavLinks({getFieldCounts:getFieldCounts,indexPattern:$scope.indexPattern,inspectorAdapters:inspectorAdapters,navigateTo:path=>{$scope.$evalAsync(()=>{history.push(path)})},savedSearch:savedSearch,services:discover_services,state:state});$scope.searchSource.setField("index",$scope.indexPattern).setField("highlightAll",true).setField("version",true);$scope.searchSource.setPreferredSearchStrategyId("default");const timeRangeSearchSource=savedSearch.searchSource.create();if(isDefaultType($scope.indexPattern)){timeRangeSearchSource.setField("filter",()=>timefilter.createFilter($scope.indexPattern))}$scope.searchSource.setParent(timeRangeSearchSource);const pageTitleSuffix=savedSearch.id&&savedSearch.title?": ".concat(savedSearch.title):"";discover_chrome.docTitle.change("Discover".concat(pageTitleSuffix));setBreadcrumbsTitle(savedSearch,discover_chrome);function getStateDefaults(){const query=$scope.searchSource.getField("query")||discover_data.query.queryString.getDefaultQuery();return{query:query,sort:Object(doc_table["b"])(savedSearch.sort,$scope.indexPattern),columns:savedSearch.columns.length>0?savedSearch.columns:discover_config.get(common["d"]).slice(),index:$scope.indexPattern.id,interval:"auto",filters:external_kbnSharedDeps_Lodash_default.a.cloneDeep($scope.searchSource.getOwnField("filter"))}}$scope.state.index=$scope.indexPattern.id;$scope.state.sort=Object(doc_table["b"])($scope.state.sort,$scope.indexPattern);$scope.opts={sampleSize:discover_config.get(common["h"]),timefield:getTimeField(),savedSearch:savedSearch,indexPatternList:$route.current.locals.savedObjects.ip.list,config:discover_config,fixedScroll:createFixedScroll($scope,$timeout),setHeaderActionMenu:Object(kibana_services["c"])(),data:discover_data};const shouldSearchOnPageLoad=()=>discover_config.get(common["i"])||savedSearch.id!==undefined||timefilter.getRefreshInterval().pause===false;const init=external_kbnSharedDeps_Lodash_default.a.once(()=>{$scope.updateDataSource().then(discover_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var fetch$;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:fetch$=Object(external_kbnSharedDeps_Rxjs_["merge"])(refetch$,discover_filterManager.getFetches$(),timefilter.getFetch$(),timefilter.getAutoRefreshFetch$(),discover_data.query.queryString.getUpdates$()).pipe(Object(external_kbnSharedDeps_RxjsOperators_["debounceTime"])(100));subscriptions.add(Object(kibana_services["s"])($scope,fetch$,{next:$scope.fetch},error=>Object(kibanaLegacy_public_["addFatalError"])(core.fatalErrors,error)));subscriptions.add(Object(kibana_services["s"])($scope,timefilter.getTimeUpdate$(),{next:()=>{$scope.updateTime()}},error=>Object(kibanaLegacy_public_["addFatalError"])(core.fatalErrors,error)));$scope.changeInterval=interval=>{if(interval){setAppState({interval:interval})}};$scope.$watchMulti(["rows","fetchStatus"],function updateResultState(){let prev={};const status={UNINITIALIZED:"uninitialized",LOADING:"loading",READY:"ready",NO_RESULTS:"none"};function pick(rows,oldRows,fetchStatus){if(!$scope.fetchError&&rows==null&&oldRows==null&&shouldSearchOnPageLoad()){return status.LOADING}if(fetchStatus===fetchStatuses.UNINITIALIZED){return status.UNINITIALIZED}const rowsEmpty=external_kbnSharedDeps_Lodash_default.a.isEmpty(rows);if(rowsEmpty&&fetchStatus===fetchStatuses.LOADING)return status.LOADING;else if(!rowsEmpty)return status.READY;else return status.NO_RESULTS}return function(){const current={rows:$scope.rows,fetchStatus:$scope.fetchStatus};$scope.resultState=pick(current.rows,prev.rows,current.fetchStatus,prev.fetchStatus);prev=current}}());if(getTimeField()){setupVisualization();$scope.updateTime()}init.complete=true;if(shouldSearchOnPageLoad()){refetch$.next()}case 8:case"end":return _context5.stop()}}),_callee5)}))))});$scope.opts.fetch=$scope.fetch=function(){if(!init.complete)return;$scope.fetchCounter++;$scope.fetchError=undefined;$scope.minimumVisibleRows=50;if(!validateTimeRange(timefilter.getTime(),discover_toastNotifications)){$scope.resultState="none";return}if(abortController)abortController.abort();abortController=new AbortController;const searchSessionId=(()=>{const searchSessionIdFromURL=getSearchSessionIdFromURL(history);if(searchSessionIdFromURL){if(isInitialSearch){discover_data.search.session.restore(searchSessionIdFromURL);isInitialSearch=false;return searchSessionIdFromURL}else{Object(public_["removeQueryParam"])(history,url_generator["d"])}}return discover_data.search.session.start()})();$scope.updateDataSource().then(setupVisualization).then((function(){$scope.fetchStatus=fetchStatuses.LOADING;logInspectorRequest({searchSessionId:searchSessionId});return $scope.searchSource.fetch({abortSignal:abortController.signal,sessionId:searchSessionId})})).then(onResults).catch(error=>{if(error instanceof Error&&error.name==="AbortError")return;$scope.fetchStatus=fetchStatuses.NO_RESULTS;$scope.fetchError=error;discover_data.search.showError(error)})};$scope.handleRefresh=function(_payload,isUpdate){if(isUpdate===false){refetch$.next()}};$scope.updateSavedQueryId=newSavedQueryId=>{if(newSavedQueryId){setAppState({savedQuery:newSavedQueryId})}else{const state=discover_objectSpread({},appStateContainer.getState());delete state.savedQuery;appStateContainer.set(state)}};function getDimensions(aggs,timeRange){const _aggs=_slicedToArray(aggs,2),metric=_aggs[0],agg=_aggs[1];agg.params.timeRange=timeRange;const bounds=agg.params.timeRange?timefilter.calculateBounds(agg.params.timeRange):null;agg.buckets.setBounds(bounds);const _agg$buckets$getInter=agg.buckets.getInterval(),esUnit=_agg$buckets$getInter.esUnit,esValue=_agg$buckets$getInter.esValue;return{x:{accessor:0,label:agg.makeLabel(),format:agg.toSerializedFieldFormat(),params:{date:true,interval:external_kbnSharedDeps_Moment_default.a.duration(esValue,esUnit),intervalESValue:esValue,intervalESUnit:esUnit,format:agg.buckets.getScaledDateFormat(),bounds:agg.buckets.getBounds()}},y:{accessor:1,format:metric.toSerializedFieldFormat(),label:metric.makeLabel()}}}function onResults(resp){inspectorRequest.stats(Object(kibana_services["f"])(resp,$scope.searchSource)).ok({json:resp});if(getTimeField()){const tabifiedData=Object(kibana_services["u"])($scope.opts.chartAggConfigs,resp);$scope.searchSource.rawResponse=resp;$scope.histogramData=discoverResponseHandler(tabifiedData,getDimensions($scope.opts.chartAggConfigs.aggs,$scope.timeRange));$scope.updateTime()}$scope.hits=resp.hits.total;$scope.rows=resp.hits.hits;$scope.fieldCounts=calcFieldCounts($scope.fieldCounts||{},resp.hits.hits,$scope.indexPattern);$scope.fetchStatus=fetchStatuses.COMPLETE}function logInspectorRequest({searchSessionId:searchSessionId=null}={searchSessionId:null}){inspectorAdapters.requests.reset();const title=external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.inspectorRequestDataTitle",{defaultMessage:"data"});const description=external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.inspectorRequestDescription",{defaultMessage:"This request queries Elasticsearch to fetch the data for the search."});inspectorRequest=inspectorAdapters.requests.start(title,{description:description,searchSessionId:searchSessionId});inspectorRequest.stats(Object(kibana_services["e"])($scope.searchSource));$scope.searchSource.getSearchRequestBody().then(body=>{inspectorRequest.json(body)})}$scope.updateTime=function(){const _timefilter$getTime=timefilter.getTime(),from=_timefilter$getTime.from,to=_timefilter$getTime.to;$scope.timeRange={from:elastic_datemath_default.a.parse(from),to:elastic_datemath_default.a.parse(to,{roundUp:true})}};$scope.resetQuery=function(){history.push($route.current.params.id?"/view/".concat(encodeURIComponent($route.current.params.id)):"/");$route.reload()};$scope.onSkipBottomButtonClick=function(){$scope.minimumVisibleRows=$scope.hits;const bottomMarker=$element.find("#discoverBottomMarker");$timeout(()=>{bottomMarker.focus();$timeout(()=>{bottomMarker.blur()},0)},0)};$scope.newQuery=function(){history.push("/")};$scope.updateDataSource=()=>{updateSearchSource($scope.searchSource,{indexPattern:$scope.indexPattern,services:discover_services,sort:$scope.state.sort});return Promise.resolve()};$scope.setSortOrder=function setSortOrder(sort){setAppState({sort:sort})};$scope.filterQuery=function(field,values,operation){const indexPattern=$scope.indexPattern;Object(popularize_field["a"])(indexPattern,field.name,discover_indexPatterns);const newFilters=data_public_["esFilters"].generateFilters(discover_filterManager,field,values,operation,$scope.indexPattern.id);if(trackUiMetric){trackUiMetric(web["a"].CLICK,"filter_added")}return discover_filterManager.addFilters(newFilters)};$scope.addColumn=function addColumn(columnName){if(uiCapabilities.discover.save){const indexPattern=$scope.indexPattern;Object(popularize_field["a"])(indexPattern,columnName,discover_indexPatterns)}const columns=actions_columns["a"]($scope.state.columns,columnName);setAppState({columns:columns})};$scope.removeColumn=function removeColumn(columnName){if(uiCapabilities.discover.save){const indexPattern=$scope.indexPattern;Object(popularize_field["a"])(indexPattern,columnName,discover_indexPatterns)}const columns=actions_columns["c"]($scope.state.columns,columnName);const sort=$scope.state.sort.length?$scope.state.sort.filter(subArr=>subArr[0]!==columnName):[];setAppState({columns:columns,sort:sort})};$scope.moveColumn=function moveColumn(columnName,newIndex){const columns=actions_columns["b"]($scope.state.columns,columnName,newIndex);setAppState({columns:columns})};function setupVisualization(){return _setupVisualization.apply(this,arguments)}function _setupVisualization(){_setupVisualization=discover_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){var histogramInterval,visStateAggs;return regeneratorRuntime.wrap((function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:if(getTimeField()){_context6.next=2;break}return _context6.abrupt("return");case 2:histogramInterval=$scope.state.interval;visStateAggs=[{type:"count",schema:"metric"},{type:"date_histogram",schema:"segment",params:{field:getTimeField(),interval:histogramInterval,timeRange:timefilter.getTime()}}];$scope.opts.chartAggConfigs=discover_data.search.aggs.createAggConfigs($scope.indexPattern,visStateAggs);$scope.searchSource.onRequestStart((searchSource,options)=>{if(!$scope.opts.chartAggConfigs)return;return $scope.opts.chartAggConfigs.onSearchRequestStart(searchSource,options)});$scope.searchSource.setField("aggs",(function(){if(!$scope.opts.chartAggConfigs)return;return $scope.opts.chartAggConfigs.toDsl()}));case 7:case"end":return _context6.stop()}}),_callee6)})));return _setupVisualization.apply(this,arguments)}addHelpMenuToAppChrome(discover_chrome);init();replaceUrlAppState().then(()=>startStateSync())}var doc='<div class="app-container">\n    <discover-doc\n      id="id"\n      index="index"\n      index-pattern-id="indexPatternId"\n      index-pattern-service="indexPatternService"\n    ></discover-doc>\n</div>\n';function use_es_doc_search_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_es_doc_search_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_es_doc_search_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_es_doc_search_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_es_doc_search_slicedToArray(arr,i){return use_es_doc_search_arrayWithHoles(arr)||use_es_doc_search_iterableToArrayLimit(arr,i)||use_es_doc_search_unsupportedIterableToArray(arr,i)||use_es_doc_search_nonIterableRest()}function use_es_doc_search_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_es_doc_search_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_es_doc_search_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_es_doc_search_arrayLikeToArray(o,minLen)}function use_es_doc_search_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function use_es_doc_search_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_es_doc_search_arrayWithHoles(arr){if(Array.isArray(arr))return arr}let ElasticRequestState;(function(ElasticRequestState){ElasticRequestState[ElasticRequestState["Loading"]=0]="Loading";ElasticRequestState[ElasticRequestState["NotFound"]=1]="NotFound";ElasticRequestState[ElasticRequestState["Found"]=2]="Found";ElasticRequestState[ElasticRequestState["Error"]=3]="Error";ElasticRequestState[ElasticRequestState["NotFoundIndexPattern"]=4]="NotFoundIndexPattern"})(ElasticRequestState||(ElasticRequestState={}));function buildSearchBody(id,indexPattern){const computedFields=indexPattern.getComputedFields();return{query:{ids:{values:[id]}},stored_fields:computedFields.storedFields,_source:true,script_fields:computedFields.scriptFields,docvalue_fields:computedFields.docvalueFields}}function useEsDocSearch({id:id,index:index,indexPatternId:indexPatternId,indexPatternService:indexPatternService}){const _useState=Object(external_kbnSharedDeps_React_["useState"])(null),_useState2=use_es_doc_search_slicedToArray(_useState,2),indexPattern=_useState2[0],setIndexPattern=_useState2[1];const _useState3=Object(external_kbnSharedDeps_React_["useState"])(ElasticRequestState.Loading),_useState4=use_es_doc_search_slicedToArray(_useState3,2),status=_useState4[0],setStatus=_useState4[1];const _useState5=Object(external_kbnSharedDeps_React_["useState"])(null),_useState6=use_es_doc_search_slicedToArray(_useState5,2),hit=_useState6[0],setHit=_useState6[1];Object(external_kbnSharedDeps_React_["useEffect"])(()=>{function requestData(){return _requestData.apply(this,arguments)}function _requestData(){_requestData=use_es_doc_search_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _hits$hits,indexPatternEntity,_yield$getServices$da,rawResponse,hits;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return indexPatternService.get(indexPatternId);case 3:indexPatternEntity=_context.sent;setIndexPattern(indexPatternEntity);_context.next=7;return Object(kibana_services["h"])().data.search.search({params:{index:index,body:buildSearchBody(id,indexPatternEntity)}}).toPromise();case 7:_yield$getServices$da=_context.sent;rawResponse=_yield$getServices$da.rawResponse;hits=rawResponse.hits;if(hits===null||hits===void 0?void 0:(_hits$hits=hits.hits)===null||_hits$hits===void 0?void 0:_hits$hits[0]){setStatus(ElasticRequestState.Found);setHit(hits.hits[0])}else{setStatus(ElasticRequestState.NotFound)}_context.next=16;break;case 13:_context.prev=13;_context.t0=_context["catch"](0);if(_context.t0.savedObjectId){setStatus(ElasticRequestState.NotFoundIndexPattern)}else if(_context.t0.status===404){setStatus(ElasticRequestState.NotFound)}else{setStatus(ElasticRequestState.Error)}case 16:case"end":return _context.stop()}}),_callee,null,[[0,13]])})));return _requestData.apply(this,arguments)}requestData()},[id,index,indexPatternId,indexPatternService]);return[status,hit,indexPattern]}var doc_viewer=__webpack_require__(65);function doc_slicedToArray(arr,i){return doc_arrayWithHoles(arr)||doc_iterableToArrayLimit(arr,i)||doc_unsupportedIterableToArray(arr,i)||doc_nonIterableRest()}function doc_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function doc_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return doc_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return doc_arrayLikeToArray(o,minLen)}function doc_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function doc_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function doc_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function Doc(props){const _useEsDocSearch=useEsDocSearch(props),_useEsDocSearch2=doc_slicedToArray(_useEsDocSearch,3),reqState=_useEsDocSearch2[0],hit=_useEsDocSearch2[1],indexPattern=_useEsDocSearch2[2];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,reqState===ElasticRequestState.NotFoundIndexPattern&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger","data-test-subj":"doc-msg-notFoundIndexPattern",iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.failedToLocateIndexPattern",defaultMessage:"No index pattern matches ID {indexPatternId}",values:{indexPatternId:props.indexPatternId}})}),reqState===ElasticRequestState.NotFound&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger","data-test-subj":"doc-msg-notFound",iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.failedToLocateDocumentDescription",defaultMessage:"Cannot find document"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.couldNotFindDocumentsDescription",defaultMessage:"No documents match that ID."})),reqState===ElasticRequestState.Error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger","data-test-subj":"doc-msg-error",iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.failedToExecuteQueryDescription",defaultMessage:"Cannot run search"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.somethingWentWrongDescription",defaultMessage:"{indexName} is missing.",values:{indexName:props.index}})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://www.elastic.co/guide/en/elasticsearch/reference/".concat(Object(kibana_services["h"])().metadata.branch,"/indices-exists.html"),target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.somethingWentWrongDescriptionAddon",defaultMessage:"Please ensure the index exists."}))),reqState===ElasticRequestState.Loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{"data-test-subj":"doc-msg-loading"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.loadingDescription",defaultMessage:"Loading…"})),reqState===ElasticRequestState.Found&&hit!==null&&indexPattern&&external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"doc-hit"},external_kbnSharedDeps_React_default.a.createElement(doc_viewer["a"],{hit:hit,indexPattern:indexPattern}))))}const doc_getServices=Object(kibana_services["h"])(),doc_timefilter=doc_getServices.timefilter;const doc_app=Object(kibana_services["a"])();doc_app.directive("discoverDoc",(function(reactDirective){return reactDirective(Doc,[["id",{watchDepth:"value"}],["index",{watchDepth:"value"}],["indexPatternId",{watchDepth:"reference"}],["indexPatternService",{watchDepth:"reference"}]],{restrict:"E"})}));doc_app.config($routeProvider=>{$routeProvider.when("/doc/:indexPattern/:index/:type",{redirectTo:"/doc/:indexPattern/:index"}).when("/doc/:indexPattern/:index",{controller:function controller($scope,$route){doc_timefilter.disableAutoRefreshSelector();doc_timefilter.disableTimeRangeSelector();$scope.id=$route.current.params.id;$scope.index=$route.current.params.index;$scope.indexPatternId=$route.current.params.indexPattern;$scope.indexPatternService=Object(kibana_services["h"])().indexPatterns},template:doc,k7Breadcrumbs:$route=>[...getRootBreadcrumbs(),{text:"".concat($route.current.params.index,"#").concat($route.current.params.id)}]})});var context_app='<kbn-top-nav\n  app-name="\'context\'"\n  show-search-bar="true"\n  show-filter-bar="true"\n  show-query-bar="false"\n  show-save-query="false"\n  show-date-picker="false"\n  index-patterns="[contextApp.indexPattern]"\n  use-default-behaviors="true"\n>\n</kbn-top-nav>\n\n\x3c!-- Context App Legacy --\x3e\n<context-app-legacy\n  filter="contextApp.actions.addFilter"\n  hits="contextApp.state.rows.all"\n  index-pattern="contextApp.indexPattern"\n  sorting="contextApp.state.queryParameters.sort"\n  columns="contextApp.state.queryParameters.columns"\n  minimum-visible-rows="contextApp.state.rows.all.length"\n  status="contextApp.state.loadingStatus.anchor.status"\n  reason="contextApp.state.loadingStatus.anchor.reason"\n  default-step-size="contextApp.state.queryParameters.defaultStepSize"\n  predecessor-count="contextApp.state.queryParameters.predecessorCount"\n  predecessor-available="contextApp.state.rows.predecessors.length"\n  predecessor-status="contextApp.state.loadingStatus.predecessors.status"\n  on-change-predecessor-count="contextApp.actions.fetchGivenPredecessorRows"\n  successor-count="contextApp.state.queryParameters.successorCount"\n  successor-available="contextApp.state.rows.successors.length"\n  successor-status="contextApp.state.loadingStatus.successors.status"\n  on-change-successor-count="contextApp.actions.fetchGivenSuccessorRows"\n></context-app-legacy>\n';var action_bar=__webpack_require__(67);Object(kibana_services["a"])().directive("contextActionBar",(function(reactDirective){return reactDirective(action_bar["a"])}));var sorting=__webpack_require__(58);var query_parameters=__webpack_require__(68);var context_query=__webpack_require__(63);function callAfterBindingsWorkaround(constructor){return function InitAfterBindingsWrapper($injector,$attrs,$element,$scope,$transclude){this.$onInit=()=>{$injector.invoke(constructor,this,{$attrs:$attrs,$element:$element,$scope:$scope,$transclude:$transclude})}}}function context_app_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function context_app_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){context_app_ownKeys(Object(source),true).forEach((function(key){context_app_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{context_app_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function context_app_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}Object(kibana_services["a"])().directive("contextApp",(function ContextApp(){return{bindToController:true,controller:callAfterBindingsWorkaround(ContextAppController),controllerAs:"contextApp",restrict:"E",scope:{anchorId:"=",columns:"=",indexPattern:"=",filters:"=",predecessorCount:"=",successorCount:"=",sort:"="},template:context_app}}));function ContextAppController($scope,Private){const _getServices=Object(kibana_services["h"])(),filterManager=_getServices.filterManager,indexPatterns=_getServices.indexPatterns,uiSettings=_getServices.uiSettings;const queryParameterActions=Object(query_parameters["c"])(filterManager,indexPatterns);const queryActions=Private(context_query["c"]);this.state=createInitialState(parseInt(uiSettings.get(common["b"]),10),Object(sorting["a"])(this.indexPattern,uiSettings.get(common["c"])));this.actions=external_kbnSharedDeps_Lodash_default.a.mapValues(context_app_objectSpread(context_app_objectSpread({},queryParameterActions),queryActions),action=>(...args)=>action(this.state)(...args));this.constants={FAILURE_REASONS:context_query["a"],LOADING_STATUS:context_query["b"]};$scope.$watchGroup([()=>this.state.rows.predecessors,()=>this.state.rows.anchor,()=>this.state.rows.successors],newValues=>this.actions.setAllRows(...newValues));$scope.$watchCollection(()=>context_app_objectSpread(context_app_objectSpread({},external_kbnSharedDeps_Lodash_default.a.pick(this,query_parameters["a"])),{},{indexPatternId:this.indexPattern.id}),newQueryParameters=>{const queryParameters=this.state.queryParameters;if(newQueryParameters.indexPatternId!==queryParameters.indexPatternId||newQueryParameters.anchorId!==queryParameters.anchorId||!external_kbnSharedDeps_Lodash_default.a.isEqual(newQueryParameters.sort,queryParameters.sort)){this.actions.fetchAllRowsWithNewQueryParameters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(newQueryParameters))}else if(newQueryParameters.predecessorCount!==queryParameters.predecessorCount||newQueryParameters.successorCount!==queryParameters.successorCount||!external_kbnSharedDeps_Lodash_default.a.isEqual(newQueryParameters.filters,queryParameters.filters)){this.actions.fetchContextRowsWithNewQueryParameters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(newQueryParameters))}});$scope.$watchCollection(()=>({predecessorCount:this.state.queryParameters.predecessorCount,successorCount:this.state.queryParameters.successorCount}),newParameters=>{external_kbnSharedDeps_Lodash_default.a.assign(this,newParameters)})}function createInitialState(defaultStepSize,tieBreakerField){return{queryParameters:Object(query_parameters["b"])(defaultStepSize,tieBreakerField),rows:{all:[],anchor:null,predecessors:[],successors:[]},loadingStatus:Object(context_query["d"])()}}function context_state_objectWithoutProperties(source,excluded){if(source==null)return{};var target=context_state_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function context_state_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function context_state_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function context_state_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){context_state_ownKeys(Object(source),true).forEach((function(key){context_state_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{context_state_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function context_state_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const GLOBAL_STATE_URL_KEY="_g";const context_state_APP_STATE_URL_KEY="_a";function context_state_getState({defaultStepSize:defaultStepSize,timeFieldName:timeFieldName,storeInSessionStorage:storeInSessionStorage=false,history:history,toasts:toasts}){const stateStorage=Object(public_["createKbnUrlStateStorage"])(context_state_objectSpread({useHash:storeInSessionStorage,history:history},toasts&&Object(public_["withNotifyOnErrors"])(toasts)));const globalStateInitial=stateStorage.get(GLOBAL_STATE_URL_KEY);const globalStateContainer=Object(public_["createStateContainer"])(globalStateInitial);const appStateFromUrl=stateStorage.get(context_state_APP_STATE_URL_KEY);const appStateInitial=createInitialAppState(defaultStepSize,timeFieldName,appStateFromUrl);const appStateContainer=Object(public_["createStateContainer"])(appStateInitial);const _syncStates=Object(public_["syncStates"])([{storageKey:GLOBAL_STATE_URL_KEY,stateContainer:context_state_objectSpread(context_state_objectSpread({},globalStateContainer),{set:value=>{if(value){globalStateContainer.set(value)}}}),stateStorage:stateStorage},{storageKey:context_state_APP_STATE_URL_KEY,stateContainer:context_state_objectSpread(context_state_objectSpread({},appStateContainer),{set:value=>{if(value){appStateContainer.set(value)}}}),stateStorage:stateStorage}]),start=_syncStates.start,stop=_syncStates.stop;return{globalState:globalStateContainer,appState:appStateContainer,startSync:start,stopSync:stop,setAppState:newState=>{const oldState=appStateContainer.getState();const mergedState=context_state_objectSpread(context_state_objectSpread({},oldState),newState);if(!context_state_isEqualState(oldState,mergedState)){appStateContainer.set(mergedState)}},getFilters:()=>[..._getFilters(globalStateContainer.getState()),..._getFilters(appStateContainer.getState())],setFilters:filterManager=>{const globalFilters=filterManager.getGlobalFilters();const globalFilterChanged=!context_state_isEqualFilters(globalFilters,_getFilters(globalStateContainer.getState()));if(globalFilterChanged){globalStateContainer.set({filters:globalFilters})}const appFilters=filterManager.getAppFilters();const appFilterChanged=!context_state_isEqualFilters(appFilters,_getFilters(appStateContainer.getState()));if(appFilterChanged){appStateContainer.set(context_state_objectSpread(context_state_objectSpread({},appStateContainer.getState()),{filters:appFilters}))}},flushToUrl:replace=>stateStorage.flush({replace:replace})}}function context_state_isEqualFilters(filtersA,filtersB){if(!filtersA&&!filtersB){return true}else if(!filtersA||!filtersB){return false}return data_public_["esFilters"].compareFilters(filtersA,filtersB,data_public_["esFilters"].COMPARE_ALL_OPTIONS)}function context_state_isEqualState(stateA,stateB){if(!stateA&&!stateB){return true}else if(!stateA||!stateB){return false}const _stateA$filters=stateA.filters,stateAFilters=_stateA$filters===void 0?[]:_stateA$filters,stateAPartial=context_state_objectWithoutProperties(stateA,["filters"]);const _stateB$filters=stateB.filters,stateBFilters=_stateB$filters===void 0?[]:_stateB$filters,stateBPartial=context_state_objectWithoutProperties(stateB,["filters"]);return external_kbnSharedDeps_Lodash_default.a.isEqual(stateAPartial,stateBPartial)&&data_public_["esFilters"].compareFilters(stateAFilters,stateBFilters,data_public_["esFilters"].COMPARE_ALL_OPTIONS)}function _getFilters(state){if(!state||!Array.isArray(state.filters)){return[]}return state.filters}function createInitialAppState(defaultSize,timeFieldName,urlState){const defaultState={columns:["_source"],filters:[],predecessorCount:parseInt(defaultSize,10),sort:[timeFieldName,"desc"],successorCount:parseInt(defaultSize,10)};if(typeof urlState!=="object"){return defaultState}return context_state_objectSpread(context_state_objectSpread({},defaultState),urlState)}var context='<context-app\n  anchor-id="contextAppRoute.anchorId"\n  columns="contextAppRoute.state.columns"\n  index-pattern="contextAppRoute.indexPattern"\n  filters="contextAppRoute.filters"\n  predecessor-count="contextAppRoute.state.predecessorCount"\n  successor-count="contextAppRoute.state.successorCount"\n  sort="contextAppRoute.state.sort"\n></context-app>\n';function context_slicedToArray(arr,i){return context_arrayWithHoles(arr)||context_iterableToArrayLimit(arr,i)||context_unsupportedIterableToArray(arr,i)||context_nonIterableRest()}function context_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function context_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return context_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return context_arrayLikeToArray(o,minLen)}function context_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function context_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function context_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function context_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function context_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){context_ownKeys(Object(source),true).forEach((function(key){context_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{context_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function context_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const k7Breadcrumbs=$route=>{const indexPattern=$route.current.locals.indexPattern;const id=$route.current.params.id;return[...getRootBreadcrumbs(),{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.context.breadcrumb",{defaultMessage:"Context of {indexPatternTitle}#{docId}",values:{indexPatternTitle:indexPattern.title,docId:id}})}]};Object(kibana_services["a"])().config($routeProvider=>{$routeProvider.when("/context/:indexPatternId/:id*",{controller:ContextAppRouteController,k7Breadcrumbs:k7Breadcrumbs,controllerAs:"contextAppRoute",resolve:{indexPattern:($route,Promise)=>{const indexPattern=Object(kibana_services["h"])().indexPatterns.get($route.current.params.indexPatternId);return Promise.props({ip:indexPattern})}},template:context})});function ContextAppRouteController($routeParams,$scope,$route){const filterManager=Object(kibana_services["h"])().filterManager;const indexPattern=$route.current.locals.indexPattern.ip;const _getState=context_state_getState({defaultStepSize:Object(kibana_services["h"])().uiSettings.get(common["a"]),timeFieldName:indexPattern.timeFieldName,storeInSessionStorage:Object(kibana_services["h"])().uiSettings.get("state:storeInSessionStorage"),history:Object(kibana_services["h"])().history(),toasts:Object(kibana_services["h"])().core.notifications.toasts}),startStateSync=_getState.startSync,stopStateSync=_getState.stopSync,appState=_getState.appState,getFilters=_getState.getFilters,setFilters=_getState.setFilters,setAppState=_getState.setAppState,flushToUrl=_getState.flushToUrl;this.state=context_objectSpread({},appState.getState());this.anchorId=$routeParams.id;this.indexPattern=indexPattern;filterManager.setFilters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(getFilters()));startStateSync();$scope.$watchGroup(["contextAppRoute.state.columns","contextAppRoute.state.predecessorCount","contextAppRoute.state.successorCount"],newValues=>{const _newValues=context_slicedToArray(newValues,3),columns=_newValues[0],predecessorCount=_newValues[1],successorCount=_newValues[2];if(Array.isArray(columns)&&predecessorCount>=0&&successorCount>=0){setAppState({columns:columns,predecessorCount:predecessorCount,successorCount:successorCount});flushToUrl(true)}});const filterObservable=filterManager.getUpdates$().subscribe(()=>{setFilters(filterManager);$route.reload()});$scope.$on("$destroy",()=>{stopStateSync();filterObservable.unsubscribe()})}var angular_doc_viewer=__webpack_require__(53);Object(kibana_services["a"])().config($routeProvider=>{$routeProvider.otherwise({resolveRedirectTo:$rootScope=>{const path=window.location.hash.substr(1);Object(kibana_services["j"])().restorePreviousUrl();$rootScope.$applyAsync(()=>{const _getServices=Object(kibana_services["h"])(),urlForwarding=_getServices.urlForwarding;const _urlForwarding$naviga=urlForwarding.navigateToLegacyKibanaUrl(path),navigated=_urlForwarding$naviga.navigated;if(!navigated){urlForwarding.navigateToDefaultApp()}});return new Promise(()=>{})}})});var directives=__webpack_require__(66)},54:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return addColumn}));__webpack_require__.d(__webpack_exports__,"c",(function(){return removeColumn}));__webpack_require__.d(__webpack_exports__,"b",(function(){return moveColumn}));function buildColumns(columns){if(columns.length>1&&columns.indexOf("_source")!==-1){return columns.filter(col=>col!=="_source")}else if(columns.length!==0){return columns}return["_source"]}function addColumn(columns,columnName){if(columns.includes(columnName)){return columns}return buildColumns([...columns,columnName])}function removeColumn(columns,columnName){if(!columns.includes(columnName)){return columns}return buildColumns(columns.filter(col=>col!==columnName))}function moveColumn(columns,columnName,newIndex){if(newIndex<0||newIndex>=columns.length||!columns.includes(columnName)){return columns}const modifiedColumns=[...columns];modifiedColumns.splice(modifiedColumns.indexOf(columnName),1);modifiedColumns.splice(newIndex,0,columnName);return modifiedColumns}},62:function(module,exports,__webpack_require__){const moment=__webpack_require__(35);const unitsMap={ms:{weight:1,type:"fixed",base:1},s:{weight:2,type:"fixed",base:1e3},m:{weight:3,type:"mixed",base:1e3*60},h:{weight:4,type:"mixed",base:1e3*60*60},d:{weight:5,type:"mixed",base:1e3*60*60*24},w:{weight:6,type:"calendar",base:NaN},M:{weight:7,type:"calendar",base:NaN},y:{weight:9,type:"calendar",base:NaN}};const units=Object.keys(unitsMap).sort((a,b)=>unitsMap[b].weight-unitsMap[a].weight);const unitsDesc=[...units];const unitsAsc=[...units].reverse();const isDate=d=>Object.prototype.toString.call(d)==="[object Date]";const isValidDate=d=>isDate(d)&&!isNaN(d.valueOf());function parse(text,{roundUp:roundUp=false,momentInstance:momentInstance=moment,forceNow:forceNow}={}){if(!text)return undefined;if(momentInstance.isMoment(text))return text;if(isDate(text))return momentInstance(text);if(forceNow!==undefined&&!isValidDate(forceNow)){throw new Error("forceNow must be a valid Date")}let time;let mathString="";let index;let parseString;if(text.substring(0,3)==="now"){time=momentInstance(forceNow);mathString=text.substring("now".length)}else{index=text.indexOf("||");if(index===-1){parseString=text;mathString=""}else{parseString=text.substring(0,index);mathString=text.substring(index+2)}time=momentInstance(parseString)}if(!mathString.length){return time}return parseDateMath(mathString,time,roundUp)}function parseDateMath(mathString,time,roundUp){const dateTime=time;const len=mathString.length;let i=0;while(i<len){const c=mathString.charAt(i++);let type;let num;let unit;if(c==="/"){type=0}else if(c==="+"){type=1}else if(c==="-"){type=2}else{return}if(isNaN(mathString.charAt(i))){num=1}else if(mathString.length===2){num=mathString.charAt(i)}else{const numFrom=i;while(!isNaN(mathString.charAt(i))){i++;if(i>=len)return}num=parseInt(mathString.substring(numFrom,i),10)}if(type===0){if(num!==1){return}}unit=mathString.charAt(i++);for(let j=i;j<len;j++){const unitChar=mathString.charAt(i);if(/[a-z]/i.test(unitChar)){unit+=unitChar;i++}else{break}}if(units.indexOf(unit)===-1){return}else{if(type===0){if(roundUp)dateTime.endOf(unit);else dateTime.startOf(unit)}else if(type===1){dateTime.add(num,unit)}else if(type===2){dateTime.subtract(num,unit)}}}return dateTime}module.exports={parse:parse,unitsMap:Object.freeze(unitsMap),units:Object.freeze(units),unitsAsc:Object.freeze(unitsAsc),unitsDesc:Object.freeze(unitsDesc)}}}]);